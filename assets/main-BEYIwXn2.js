var Vs=Object.defineProperty;var Hs=(n,e,t)=>e in n?Vs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var je=(n,e,t)=>Hs(n,typeof e!="symbol"?e+"":e,t);import{l as loadSlim,t as tsParticles}from"./index-Bnb69vRo.js";function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inheritsLoose(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults$1={duration:.5,overwrite:!1,delay:0},_suppressOverwrites$1,_reverting$1,_context$2,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString$1=function(e){return typeof e=="string"},_isFunction$1=function(e){return typeof e=="function"},_isNumber$1=function(e){return typeof e=="number"},_isUndefined=function(e){return typeof e>"u"},_isObject$1=function(e){return typeof e=="object"},_isNotFalse=function(e){return e!==!1},_windowExists$2=function(){return typeof window<"u"},_isFuncOrString=function(e){return _isFunction$1(e)||_isString$1(e)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$3,_coreInitted$2,_doc$3,_globals={},_installScope={},_coreReady,_install=function(e){return(_installScope=_merge(e,_globals))&&gsap$3},_missingPlugin=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},_warn=function(e,t){return!t&&console.warn(e)},_addGlobal=function(e,t){return e&&(_globals[e]=t)&&_installScope&&(_installScope[e]=t)||_globals},_emptyFunc=function(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function(e){var t=e[0],i,r;if(_isObject$1(t)||_isFunction$1(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=_harnessPlugins.length;r--&&!_harnessPlugins[r].targetTest(t););i=_harnessPlugins[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new GSCache(e[r],i)))||e.splice(r,1);return e},_getCache=function(e){return e._gsap||_harness(toArray(e))[0]._gsap},_getProperty=function(e,t,i){return(i=e[t])&&_isFunction$1(i)?e[t]():_isUndefined(i)&&e.getAttribute&&e.getAttribute(t)||i},_forEachName=function(e,t){return(e=e.split(",")).forEach(t)||e},_round$1=function(e){return Math.round(e*1e5)/1e5||0},_roundPrecise=function(e){return Math.round(e*1e7)/1e7||0},_parseRelative=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+r:i==="-"?e-r:i==="*"?e*r:e/r},_arrayContainsAny=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},_lazyRender=function(){var e=_lazyTweens.length,t=_lazyTweens.slice(0),i,r;for(_lazyLookup={},_lazyTweens.length=0,i=0;i<e;i++)r=t[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},_isRevertWorthy=function(e){return!!(e._initted||e._startAt||e.add)},_lazySafeRender=function(e,t,i,r){_lazyTweens.length&&!_reverting$1&&_lazyRender(),e.render(t,i,!!(_reverting$1&&t<0&&_isRevertWorthy(e))),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(_delimitedValueExp).length<2?t:_isString$1(e)?e.trim():e},_passThrough$1=function(e){return e},_setDefaults$1=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_setKeyframeDefaults=function(e){return function(t,i){for(var r in i)r in t||r==="duration"&&e||r==="ease"||(t[r]=i[r])}},_merge=function(e,t){for(var i in t)e[i]=t[i];return e},_mergeDeep=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=_isObject$1(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},_copyExcluding=function(e,t){var i={},r;for(r in e)r in t||(i[r]=e[r]);return i},_inheritDefaults=function(e){var t=e.parent||_globalTimeline,i=e.keyframes?_setKeyframeDefaults(_isArray(e.keyframes)):_setDefaults$1;if(_isNotFalse(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},_arraysMatch=function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0},_addLinkedListItem=function(e,t,i,r,s){var o=e[r],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},_removeLinkedListItem=function(e,t,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},_removeFromParent=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},_uncache=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},_recacheAncestors=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},_rewindStartAt=function(e,t,i,r){return e._startAt&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},_hasNoPausedAncestors=function n(e){return!e||e._ts&&n(e.parent)},_elapsedCycleDuration=function(e){return e._repeat?_animationCycle(e._tTime,e=e.duration()+e._rDelay)*e:0},_animationCycle=function(e,t){var i=Math.floor(e=_roundPrecise(e/t));return e&&i===e?i-1:i},_parentToChildTotalTime=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},_setEnd=function(e){return e._end=_roundPrecise(e._start+(e._tDur/Math.abs(e._ts||e._rts||_tinyNum)||0))},_alignPlayhead=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=_roundPrecise(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),_setEnd(e),i._dirty||_uncache(i,e)),e},_postAddChecks=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=_parentToChildTotalTime(e.rawTime(),t),(!t._dur||_clamp$1(0,t.totalDuration(),i)-t._tTime>_tinyNum)&&t.render(i,!0)),_uncache(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-_tinyNum}},_addToTimeline=function(e,t,i,r){return t.parent&&_removeFromParent(t),t._start=_roundPrecise((_isNumber$1(i)?i:i||e!==_globalTimeline?_parsePosition$1(e,i,t):e._time)+t._delay),t._end=_roundPrecise(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),_addLinkedListItem(e,t,"_first","_last",e._sort?"_start":0),_isFromOrFromStart(t)||(e._recent=t),r||_postAddChecks(e,t),e._ts<0&&_alignPlayhead(e,e._tTime),e},_scrollTrigger=function(e,t){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",t))&&_globals.ScrollTrigger.create(t,e)},_attemptInitTween=function(e,t,i,r,s){if(_initTween(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!_reverting$1&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(e),e._lazy=[s,r],1},_parentPlayheadIsBeforeStart=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},_isFromOrFromStart=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},_renderZeroDurationTween=function(e,t,i,r){var s=e.ratio,o=t<0||!t&&(!e._start&&_parentPlayheadIsBeforeStart(e)&&!(!e._initted&&_isFromOrFromStart(e))||(e._ts<0||e._dp._ts<0)&&!_isFromOrFromStart(e))?0:1,a=e._rDelay,h=0,d,u,m;if(a&&e._repeat&&(h=_clamp$1(0,e._tDur,t),u=_animationCycle(h,a),e._yoyo&&u&1&&(o=1-o),u!==_animationCycle(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||_reverting$1||r||e._zTime===_tinyNum||!t&&e._zTime){if(!e._initted&&_attemptInitTween(e,t,r,i,h))return;for(m=e._zTime,e._zTime=t||(i?_tinyNum:0),i||(i=t&&!m),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=h,d=e._pt;d;)d.r(o,d.d),d=d._next;t<0&&_rewindStartAt(e,t,i,!0),e._onUpdate&&!i&&_callback$1(e,"onUpdate"),h&&e._repeat&&!i&&e.parent&&_callback$1(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&_removeFromParent(e,1),!i&&!_reverting$1&&(_callback$1(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},_findNextPauseTween=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},_setDuration=function(e,t,i,r){var s=e._repeat,o=_roundPrecise(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:_roundPrecise(o*(s+1)+e._rDelay*s):o,a>0&&!r&&_alignPlayhead(e,e._tTime=e._tDur*a),e.parent&&_setEnd(e),i||_uncache(e.parent,e),e},_onUpdateTotalDuration=function(e){return e instanceof Timeline?_uncache(e):_setDuration(e,e._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition$1=function n(e,t,i){var r=e.labels,s=e._recent||_zeroPosition,o=e.duration()>=_bigNum$1?s.endTime(!1):e._dur,a,h,d;return _isString$1(t)&&(isNaN(t)||t in r)?(h=t.charAt(0),d=t.substr(-1)==="%",a=t.indexOf("="),h==="<"||h===">"?(a>=0&&(t=t.replace(/=/,"")),(h==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(d?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(h=parseFloat(t.charAt(a-1)+t.substr(a+1)),d&&i&&(h=h/100*(_isArray(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+h:o+h)):t==null?o:+t},_createTweenType=function(e,t,i){var r=_isNumber$1(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s],a,h;if(r&&(o.duration=t[1]),o.parent=i,e){for(a=o,h=i;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=_isNotFalse(h.vars.inherit)&&h.parent;o.immediateRender=_isNotFalse(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new Tween(t[0],o,t[s+1])},_conditionalReturn=function(e,t){return e||e===0?t(e):t},_clamp$1=function(e,t,i){return i<e?e:i>t?t:i},getUnit=function(e,t){return!_isString$1(e)||!(t=_unitExp.exec(e))?"":t[1]},clamp=function(e,t,i){return _conditionalReturn(i,function(r){return _clamp$1(e,t,r)})},_slice=[].slice,_isArrayLike=function(e,t){return e&&_isObject$1(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&_isObject$1(e[0]))&&!e.nodeType&&e!==_win$3},_flatten=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(r){var s;return _isString$1(r)&&!t||_isArrayLike(r,1)?(s=i).push.apply(s,toArray(r)):i.push(r)})||i},toArray=function(e,t,i){return _context$2&&!t&&_context$2.selector?_context$2.selector(e):_isString$1(e)&&!i&&(_coreInitted$2||!_wake())?_slice.call((t||_doc$3).querySelectorAll(e),0):_isArray(e)?_flatten(e,i):_isArrayLike(e)?_slice.call(e,0):e?[e]:[]},selector=function(e){return e=toArray(e)[0]||_warn("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return toArray(t,i.querySelectorAll?i:i===e?_warn("Invalid scope")||_doc$3.createElement("div"):e)}},shuffle=function(e){return e.sort(function(){return .5-Math.random()})},distribute=function(e){if(_isFunction$1(e))return e;var t=_isObject$1(e)?e:{each:e},i=_parseEase(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,d=t.axis,u=r,m=r;return _isString$1(r)?u=m={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(u=r[0],m=r[1]),function(v,_,D){var f=(D||t).length,l=o[f],c,p,b,E,C,g,x,y,w;if(!l){if(w=t.grid==="auto"?0:(t.grid||[1,_bigNum$1])[1],!w){for(x=-_bigNum$1;x<(x=D[w++].getBoundingClientRect().left)&&w<f;);w<f&&w--}for(l=o[f]=[],c=h?Math.min(w,f)*u-.5:r%w,p=w===_bigNum$1?0:h?f*m/w-.5:r/w|0,x=0,y=_bigNum$1,g=0;g<f;g++)b=g%w-c,E=p-(g/w|0),l[g]=C=d?Math.abs(d==="y"?E:b):_sqrt(b*b+E*E),C>x&&(x=C),C<y&&(y=C);r==="random"&&shuffle(l),l.max=x-y,l.min=y,l.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(w>f?f-1:d?d==="y"?f/w:w:Math.max(w,f/w))||0)*(r==="edges"?-1:1),l.b=f<0?s-f:s,l.u=getUnit(t.amount||t.each)||0,i=i&&f<0?_invertEase(i):i}return f=(l[v]-l.min)/l.max||0,_roundPrecise(l.b+(i?i(f):f)*l.v)+l.u}},_roundModifier=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=_roundPrecise(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(_isNumber$1(i)?0:getUnit(i))}},snap=function(e,t){var i=_isArray(e),r,s;return!i&&_isObject$1(e)&&(r=i=e.radius||_bigNum$1,e.values?(e=toArray(e.values),(s=!_isNumber$1(e[0]))&&(r*=r)):e=_roundModifier(e.increment)),_conditionalReturn(t,i?_isFunction$1(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),h=parseFloat(s?o.y:0),d=_bigNum$1,u=0,m=e.length,v,_;m--;)s?(v=e[m].x-a,_=e[m].y-h,v=v*v+_*_):v=Math.abs(e[m]-a),v<d&&(d=v,u=m);return u=!r||d<=r?e[u]:o,s||u===o||_isNumber$1(o)?u:u+getUnit(o)}:_roundModifier(e))},random=function(e,t,i,r){return _conditionalReturn(_isArray(e)?!t:i===!0?!!(i=0):!r,function(){return _isArray(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*r)/r})},pipe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize=function(e,t){return function(i){return e(parseFloat(i))+(t||getUnit(i))}},normalize=function(e,t,i){return mapRange(e,t,0,1,i)},_wrapArray=function(e,t,i){return _conditionalReturn(i,function(r){return e[~~t(r)]})},wrap=function n(e,t,i){var r=t-e;return _isArray(e)?_wrapArray(e,n(0,e.length),t):_conditionalReturn(i,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo=function n(e,t,i){var r=t-e,s=r*2;return _isArray(e)?_wrapArray(e,n(0,e.length-1),t):_conditionalReturn(i,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},_replaceRandom=function(e){for(var t=0,i="",r,s,o,a;~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(a?_delimitedValueExp:_strictNumExp),i+=e.substr(t,r-t)+random(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},mapRange=function(e,t,i,r,s){var o=t-e,a=r-i;return _conditionalReturn(s,function(h){return i+((h-e)/o*a||0)})},interpolate$2=function n(e,t,i,r){var s=isNaN(e+t)?0:function(_){return(1-_)*e+_*t};if(!s){var o=_isString$1(e),a={},h,d,u,m,v;if(i===!0&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(_isArray(e)&&!_isArray(t)){for(u=[],m=e.length,v=m-2,d=1;d<m;d++)u.push(n(e[d-1],e[d]));m--,s=function(D){D*=m;var f=Math.min(v,~~D);return u[f](D-f)},i=t}else r||(e=_merge(_isArray(e)?[]:{},e));if(!u){for(h in t)_addPropTween.call(a,e,h,"get",t[h]);s=function(D){return _renderPropTweens(D,a)||(o?e.p:e)}}}return _conditionalReturn(i,s)},_getLabelInDirection=function(e,t,i){var r=e.labels,s=_bigNum$1,o,a,h;for(o in r)a=r[o]-t,a<0==!!i&&a&&s>(a=Math.abs(a))&&(h=o,s=a);return h},_callback$1=function(e,t,i){var r=e.vars,s=r[t],o=_context$2,a=e._ctx,h,d,u;if(s)return h=r[t+"Params"],d=r.callbackScope||e,i&&_lazyTweens.length&&_lazyRender(),a&&(_context$2=a),u=h?s.apply(d,h):s.call(d),_context$2=o,u},_interrupt=function(e){return _removeFromParent(e),e.scrollTrigger&&e.scrollTrigger.kill(!!_reverting$1),e.progress()<1&&_callback$1(e,"onInterrupt"),e},_quickTween,_registerPluginQueue=[],_createPlugin=function(e){if(e)if(e=!e.name&&e.default||e,_windowExists$2()||e.headless){var t=e.name,i=_isFunction$1(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},o={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),e!==r){if(_plugins[t])return;_setDefaults$1(r,_setDefaults$1(_copyExcluding(e,s),o)),_merge(r.prototype,_merge(s,_copyExcluding(e,o))),_plugins[r.prop=t]=r,e.targetTest&&(_harnessPlugins.push(r),_reservedProps[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}_addGlobal(t,r),e.register&&e.register(gsap$3,r,PropTween)}else _registerPluginQueue.push(e)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*_255+.5|0},splitColor=function(e,t,i){var r=e?_isNumber$1(e)?[e>>16,e>>8&_255,e&_255]:0:_colorLookup.black,s,o,a,h,d,u,m,v,_,D;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),_colorLookup[e])r=_colorLookup[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&_255,r&_255,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&_255,e&_255]}else if(e.substr(0,3)==="hsl"){if(r=D=e.match(_strictNumExp),!t)h=+r[0]%360/360,d=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(d+1):u+d-u*d,s=u*2-o,r.length>3&&(r[3]*=1),r[0]=_hue(h+1/3,s,o),r[1]=_hue(h,s,o),r[2]=_hue(h-1/3,s,o);else if(~e.indexOf("="))return r=e.match(_numExp),i&&r.length<4&&(r[3]=1),r}else r=e.match(_strictNumExp)||_colorLookup.transparent;r=r.map(Number)}return t&&!D&&(s=r[0]/_255,o=r[1]/_255,a=r[2]/_255,m=Math.max(s,o,a),v=Math.min(s,o,a),u=(m+v)/2,m===v?h=d=0:(_=m-v,d=u>.5?_/(2-m-v):_/(m+v),h=m===s?(o-a)/_+(o<a?6:0):m===o?(a-s)/_+2:(s-o)/_+4,h*=60),r[0]=~~(h+.5),r[1]=~~(d*100+.5),r[2]=~~(u*100+.5)),i&&r.length<4&&(r[3]=1),r},_colorOrderData=function(e){var t=[],i=[],r=-1;return e.split(_colorExp).forEach(function(s){var o=s.match(_numWithUnitExp)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},_formatColors=function(e,t,i){var r="",s=(e+r).match(_colorExp),o=t?"hsla(":"rgba(",a=0,h,d,u,m;if(!s)return e;if(s=s.map(function(v){return(v=splitColor(v,t,1))&&o+(t?v[0]+","+v[1]+"%,"+v[2]+"%,"+v[3]:v.join(","))+")"}),i&&(u=_colorOrderData(e),h=i.c,h.join(r)!==u.c.join(r)))for(d=e.replace(_colorExp,"1").split(_numWithUnitExp),m=d.length-1;a<m;a++)r+=d[a]+(~h.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!d)for(d=e.split(_colorExp),m=d.length-1;a<m;a++)r+=d[a]+s[a];return r+d[m]},_colorExp=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in _colorLookup)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function(e){var t=e.join(" "),i;if(_colorExp.lastIndex=0,_colorExp.test(t))return i=_hslExp.test(t),e[1]=_formatColors(e[1],i),e[0]=_formatColors(e[0],i,_colorOrderData(e[1])),!0},_tickerActive,_ticker=function(){var n=Date.now,e=500,t=33,i=n(),r=i,s=1e3/240,o=s,a=[],h,d,u,m,v,_,D=function f(l){var c=n()-r,p=l===!0,b,E,C,g;if((c>e||c<0)&&(i+=c-t),r+=c,C=r-i,b=C-o,(b>0||p)&&(g=++m.frame,v=C-m.time*1e3,m.time=C=C/1e3,o+=b+(b>=s?4:s-b),E=1),p||(h=d(f)),E)for(_=0;_<a.length;_++)a[_](C,v,g,l)};return m={time:0,frame:0,tick:function(){D(!0)},deltaRatio:function(l){return v/(1e3/(l||60))},wake:function(){_coreReady&&(!_coreInitted$2&&_windowExists$2()&&(_win$3=_coreInitted$2=window,_doc$3=_win$3.document||{},_globals.gsap=gsap$3,(_win$3.gsapVersions||(_win$3.gsapVersions=[])).push(gsap$3.version),_install(_installScope||_win$3.GreenSockGlobals||!_win$3.gsap&&_win$3||{}),_registerPluginQueue.forEach(_createPlugin)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&m.sleep(),d=u||function(l){return setTimeout(l,o-m.time*1e3+1|0)},_tickerActive=1,D(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(h),_tickerActive=0,d=_emptyFunc},lagSmoothing:function(l,c){e=l||1/0,t=Math.min(c||33,e)},fps:function(l){s=1e3/(l||240),o=m.time*1e3+s},add:function(l,c,p){var b=c?function(E,C,g,x){l(E,C,g,x),m.remove(b)}:l;return m.remove(l),a[p?"unshift":"push"](b),_wake(),b},remove:function(l,c){~(c=a.indexOf(l))&&a.splice(c,1)&&_>=c&&_--},_listeners:a},m}(),_wake=function(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length,a,h,d;s<o;s++)h=i[s],a=s!==o-1?h.lastIndexOf(","):h.length,d=h.substr(0,a),t[r]=isNaN(d)?d.replace(_quotesExp,"").trim():+d,r=h.substr(a+1).trim();return t},_valueInParentheses=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)},_configEaseFromString=function(e){var t=(e+"").split("("),i=_easeMap[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[_parseObjectInString(t[1])]:_valueInParentheses(e).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(e)?_easeMap._CE("",e):i},_invertEase=function(e){return function(t){return 1-e(1-t)}},_propagateYoyoEase=function n(e,t){for(var i=e._first,r;i;)i instanceof Timeline?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},_parseEase=function(e,t){return e&&(_isFunction$1(e)?e:_easeMap[e]||_configEaseFromString(e))||t},_insertEase=function(e,t,i,r){i===void 0&&(i=function(h){return 1-t(1-h)}),r===void 0&&(r=function(h){return h<.5?t(h*2)/2:1-t((1-h)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:r},o;return _forEachName(e,function(a){_easeMap[a]=_globals[a]=s,_easeMap[o=a.toLowerCase()]=i;for(var h in s)_easeMap[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=_easeMap[a+"."+h]=s[h]}),s},_easeInOutFromOut=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},_configElastic=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/_2PI*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*_sin((u-o)*s)+1},h=e==="out"?a:e==="in"?function(d){return 1-a(1-d)}:_easeInOutFromOut(a);return s=_2PI/s,h.config=function(d,u){return n(e,d,u)},h},_configBack=function n(e,t){t===void 0&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:_easeInOutFromOut(i);return r.config=function(s){return n(e,s)},r};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;_insertEase(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(n,e){var t=1/e,i=2*t,r=2.5*t,s=function(a){return a<t?n*a*a:a<i?n*Math.pow(a-1.5/e,2)+.75:a<r?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};_insertEase("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);_insertEase("Expo",function(n){return Math.pow(2,10*(n-1))*n+n*n*n*n*n*n*(1-n)});_insertEase("Circ",function(n){return-(_sqrt(1-n*n)-1)});_insertEase("Sine",function(n){return n===1?1:-_cos(n*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0,o=1-_tinyNum;return function(a){return((r*_clamp$1(0,o,a)|0)+s)*i}}};_defaults$1.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return _callbackNames+=n+","+n+"Params,"});var GSCache=function(e,t){this.id=_gsID++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:_getProperty,this.set=t?t.getSetter:_getSetter},Animation$1=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,_setDuration(this,+t.duration,1,1),this.data=t.data,_context$2&&(this._ctx=_context$2,_context$2.data.push(this)),_tickerActive||_ticker.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(_wake(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(_alignPlayhead(this,i),!s._dp||s.parent||_postAddChecks(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===_tinyNum||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),_lazySafeRender(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+_elapsedCycleDuration(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?_animationCycle(this._tTime,s)+1:1},e.timeScale=function(i,r){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-_tinyNum?0:this._rts,this.totalTime(_clamp$1(-Math.abs(this._delay),this.totalDuration(),s),r!==!1),_setEnd(this),_recacheAncestors(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&_addToTimeline(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(_isNotFalse(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=_revertConfig);var r=_reverting$1;return _reverting$1=i,_isRevertWorthy(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),_reverting$1=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,_onUpdateTotalDuration(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(_parsePosition$1(this,i),_isNotFalse(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,_isNotFalse(r)),this._dur||(this._zTime=-_tinyNum),this},e.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-_tinyNum:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},e.isActive=function(){var i=this.parent||this._dp,r=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-_tinyNum)},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=_isFunction$1(i)?i:_passThrough$1,a=function(){var d=r.then;r.then=null,_isFunction$1(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=d),s(o),r.then=d};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){_interrupt(this)},n}();_setDefaults$1(Animation$1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(n){_inheritsLoose(e,n);function e(i,r){var s;return i===void 0&&(i={}),s=n.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=_isNotFalse(i.sortChildren),_globalTimeline&&_addToTimeline(i.parent||_globalTimeline,_assertThisInitialized(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&_scrollTrigger(_assertThisInitialized(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,o){return _createTweenType(0,arguments,this),this},t.from=function(r,s,o){return _createTweenType(1,arguments,this),this},t.fromTo=function(r,s,o,a){return _createTweenType(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,_inheritDefaults(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Tween(r,s,_parsePosition$1(this,o),1),this},t.call=function(r,s,o){return _addToTimeline(this,Tween.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,h,d,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=d,o.onCompleteParams=u,o.parent=this,new Tween(r,o,_parsePosition$1(this,h)),this},t.staggerFrom=function(r,s,o,a,h,d,u){return o.runBackwards=1,_inheritDefaults(o).immediateRender=_isNotFalse(o.immediateRender),this.staggerTo(r,s,o,a,h,d,u)},t.staggerFromTo=function(r,s,o,a,h,d,u,m){return a.startAt=o,_inheritDefaults(a).immediateRender=_isNotFalse(a.immediateRender),this.staggerTo(r,s,a,h,d,u,m)},t.render=function(r,s,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,d=this._dur,u=r<=0?0:_roundPrecise(r),m=this._zTime<0!=r<0&&(this._initted||!d),v,_,D,f,l,c,p,b,E,C,g,x;if(this!==_globalTimeline&&u>h&&r>=0&&(u=h),u!==this._tTime||o||m){if(a!==this._time&&d&&(u+=this._time-a,r+=this._time-a),v=u,E=this._start,b=this._ts,c=!b,m&&(d||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(g=this._yoyo,l=d+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(l*100+r,s,o);if(v=_roundPrecise(u%l),u===h?(f=this._repeat,v=d):(C=_roundPrecise(u/l),f=~~C,f&&f===C&&(v=d,f--),v>d&&(v=d)),C=_animationCycle(this._tTime,l),!a&&this._tTime&&C!==f&&this._tTime-C*l-this._dur<=0&&(C=f),g&&f&1&&(v=d-v,x=1),f!==C&&!this._lock){var y=g&&C&1,w=y===(g&&f&1);if(f<C&&(y=!y),a=y?0:u%d?d:u,this._lock=1,this.render(a||(x?0:_roundPrecise(f*l)),s,!d)._lock=0,this._tTime=u,!s&&this.parent&&_callback$1(this,"onRepeat"),this.vars.repeatRefresh&&!x&&(this.invalidate()._lock=1),a&&a!==this._time||c!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(d=this._dur,h=this._tDur,w&&(this._lock=2,a=y?d:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!x&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;_propagateYoyoEase(this,x)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(p=_findNextPauseTween(this,_roundPrecise(a),_roundPrecise(v)),p&&(u-=v-(v=p._start))),this._tTime=u,this._time=v,this._act=!b,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&u&&!s&&!C&&(_callback$1(this,"onStart"),this._tTime!==u))return this;if(v>=a&&r>=0)for(_=this._first;_;){if(D=_._next,(_._act||v>=_._start)&&_._ts&&p!==_){if(_.parent!==this)return this.render(r,s,o);if(_.render(_._ts>0?(v-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(v-_._start)*_._ts,s,o),v!==this._time||!this._ts&&!c){p=0,D&&(u+=this._zTime=-_tinyNum);break}}_=D}else{_=this._last;for(var M=r<0?r:v;_;){if(D=_._prev,(_._act||M<=_._end)&&_._ts&&p!==_){if(_.parent!==this)return this.render(r,s,o);if(_.render(_._ts>0?(M-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(M-_._start)*_._ts,s,o||_reverting$1&&_isRevertWorthy(_)),v!==this._time||!this._ts&&!c){p=0,D&&(u+=this._zTime=M?-_tinyNum:_tinyNum);break}}_=D}}if(p&&!s&&(this.pause(),p.render(v>=a?0:-_tinyNum)._zTime=v>=a?1:-1,this._ts))return this._start=E,_setEnd(this),this.render(r,s,o);this._onUpdate&&!s&&_callback$1(this,"onUpdate",!0),(u===h&&this._tTime>=this.totalDuration()||!u&&a)&&(E===this._start||Math.abs(b)!==Math.abs(this._ts))&&(this._lock||((r||!d)&&(u===h&&this._ts>0||!u&&this._ts<0)&&_removeFromParent(this,1),!s&&!(r<0&&!a)&&(u||a||!h)&&(_callback$1(this,u===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(_isNumber$1(s)||(s=_parsePosition$1(this,s,r)),!(r instanceof Animation$1)){if(_isArray(r))return r.forEach(function(a){return o.add(a,s)}),this;if(_isString$1(r))return this.addLabel(r,s);if(_isFunction$1(r))r=Tween.delayedCall(0,r);else return this}return this!==r?_addToTimeline(this,r,s):this},t.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-_bigNum$1);for(var h=[],d=this._first;d;)d._start>=a&&(d instanceof Tween?s&&h.push(d):(o&&h.push(d),r&&h.push.apply(h,d.getChildren(!0,s,o)))),d=d._next;return h},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return _isString$1(r)?this.removeLabel(r):_isFunction$1(r)?this.killTweensOf(r):(r.parent===this&&_removeLinkedListItem(this,r),r===this._recent&&(this._recent=this._last),_uncache(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=_parsePosition$1(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=Tween.delayedCall(0,s||_emptyFunc,o);return a.data="isPause",this._hasPause=1,_addToTimeline(this,a,_parsePosition$1(this,r))},t.removePause=function(r){var s=this._first;for(r=_parsePosition$1(this,r);s;)s._start===r&&s.data==="isPause"&&_removeFromParent(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)_overwritingTween!==a[h]&&a[h].kill(r,s);return this},t.getTweensOf=function(r,s){for(var o=[],a=toArray(r),h=this._first,d=_isNumber$1(s),u;h;)h instanceof Tween?_arrayContainsAny(h._targets,a)&&(d?(!_overwritingTween||h._initted&&h._ts)&&h.globalTime(0)<=s&&h.globalTime(h.totalDuration())>s:!s||h.isActive())&&o.push(h):(u=h.getTweensOf(a,s)).length&&o.push.apply(o,u),h=h._next;return o},t.tweenTo=function(r,s){s=s||{};var o=this,a=_parsePosition$1(o,r),h=s,d=h.startAt,u=h.onStart,m=h.onStartParams,v=h.immediateRender,_,D=Tween.to(o,_setDefaults$1({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(d&&"time"in d?d.time:o._time))/o.timeScale())||_tinyNum,onStart:function(){if(o.pause(),!_){var l=s.duration||Math.abs((a-(d&&"time"in d?d.time:o._time))/o.timeScale());D._dur!==l&&_setDuration(D,l,0,1).render(D._time,!0,!0),_=1}u&&u.apply(D,m||[])}},s));return v?D.render(0):D},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,_setDefaults$1({startAt:{time:_parsePosition$1(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition$1(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition$1(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+_tinyNum)},t.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,d;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(d in h)h[d]>=o&&(h[d]+=r);return _uncache(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),_uncache(this)},t.totalDuration=function(r){var s=0,o=this,a=o._last,h=_bigNum$1,d,u,m;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(m=o.parent;a;)d=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,_addToTimeline(o,a,u-a._delay,1)._lock=0):h=u,u<0&&a._ts&&(s-=u,(!m&&!o._dp||m&&m.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),h=0),a._end>s&&a._ts&&(s=a._end),a=d;_setDuration(o,o===_globalTimeline&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(r,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var s=_globalTimeline._first;if((!s||!s._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||_ticker.sleep()}}},e}(Animation$1);_setDefaults$1(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function(e,t,i,r,s,o,a){var h=new PropTween(this._pt,e,t,0,1,_renderComplexString,null,s),d=0,u=0,m,v,_,D,f,l,c,p;for(h.b=i,h.e=r,i+="",r+="",(c=~r.indexOf("random("))&&(r=_replaceRandom(r)),o&&(p=[i,r],o(p,e,t),i=p[0],r=p[1]),v=i.match(_complexStringNumExp)||[];m=_complexStringNumExp.exec(r);)D=m[0],f=r.substring(d,m.index),_?_=(_+1)%5:f.substr(-5)==="rgba("&&(_=1),D!==v[u++]&&(l=parseFloat(v[u-1])||0,h._pt={_next:h._pt,p:f||u===1?f:",",s:l,c:D.charAt(1)==="="?_parseRelative(l,D)-l:parseFloat(D)-l,m:_&&_<4?Math.round:0},d=_complexStringNumExp.lastIndex);return h.c=d<r.length?r.substring(d,r.length):"",h.fp=a,(_relExp.test(r)||c)&&(h.e=0),this._pt=h,h},_addPropTween=function(e,t,i,r,s,o,a,h,d,u){_isFunction$1(r)&&(r=r(s||0,e,o));var m=e[t],v=i!=="get"?i:_isFunction$1(m)?d?e[t.indexOf("set")||!_isFunction$1(e["get"+t.substr(3)])?t:"get"+t.substr(3)](d):e[t]():m,_=_isFunction$1(m)?d?_setterFuncWithParam:_setterFunc:_setterPlain,D;if(_isString$1(r)&&(~r.indexOf("random(")&&(r=_replaceRandom(r)),r.charAt(1)==="="&&(D=_parseRelative(v,r)+(getUnit(v)||0),(D||D===0)&&(r=D))),!u||v!==r||_forceAllPropTweens)return!isNaN(v*r)&&r!==""?(D=new PropTween(this._pt,e,t,+v||0,r-(v||0),typeof m=="boolean"?_renderBoolean:_renderPlain,0,_),d&&(D.fp=d),a&&D.modifier(a,this,e),this._pt=D):(!m&&!(t in e)&&_missingPlugin(t,r),_addComplexStringPropTween.call(this,e,t,v,r,_,h||_config.stringFilter,d))},_processVars=function(e,t,i,r,s){if(_isFunction$1(e)&&(e=_parseFuncOrString(e,s,t,i,r)),!_isObject$1(e)||e.style&&e.nodeType||_isArray(e)||_isTypedArray(e))return _isString$1(e)?_parseFuncOrString(e,s,t,i,r):e;var o={},a;for(a in e)o[a]=_parseFuncOrString(e[a],s,t,i,r);return o},_checkPlugin=function(e,t,i,r,s,o){var a,h,d,u;if(_plugins[e]&&(a=new _plugins[e]).init(s,a.rawVars?t[e]:_processVars(t[e],r,s,o,i),i,r,o)!==!1&&(i._pt=h=new PropTween(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==_quickTween))for(d=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)d[a._props[u]]=h;return a},_overwritingTween,_forceAllPropTweens,_initTween=function n(e,t,i){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,d=r.onUpdate,u=r.runBackwards,m=r.yoyoEase,v=r.keyframes,_=r.autoRevert,D=e._dur,f=e._startAt,l=e._targets,c=e.parent,p=c&&c.data==="nested"?c.vars.targets:l,b=e._overwrite==="auto"&&!_suppressOverwrites$1,E=e.timeline,C,g,x,y,w,M,S,O,P,I,F,k,B;if(E&&(!v||!s)&&(s="none"),e._ease=_parseEase(s,_defaults$1.ease),e._yEase=m?_invertEase(_parseEase(m===!0?s:m,_defaults$1.ease)):0,m&&e._yoyo&&!e._repeat&&(m=e._yEase,e._yEase=e._ease,e._ease=m),e._from=!E&&!!r.runBackwards,!E||v&&!r.stagger){if(O=l[0]?_getCache(l[0]).harness:0,k=O&&r[O.prop],C=_copyExcluding(r,_reservedProps),f&&(f._zTime<0&&f.progress(1),t<0&&u&&a&&!_?f.render(-1,!0):f.revert(u&&D?_revertConfigNoKill:_startAtRevertConfig),f._lazy=0),o){if(_removeFromParent(e._startAt=Tween.set(l,_setDefaults$1({data:"isStart",overwrite:!1,parent:c,immediateRender:!0,lazy:!f&&_isNotFalse(h),startAt:null,delay:0,onUpdate:d&&function(){return _callback$1(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1||!a&&!_)&&e._startAt.revert(_revertConfigNoKill),a&&D&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(u&&D&&!f){if(t&&(a=!1),x=_setDefaults$1({overwrite:!1,data:"isFromStart",lazy:a&&!f&&_isNotFalse(h),immediateRender:a,stagger:0,parent:c},C),k&&(x[O.prop]=k),_removeFromParent(e._startAt=Tween.set(l,x)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e._startAt.render(-1,!0)),e._zTime=t,!a)n(e._startAt,_tinyNum,_tinyNum);else if(!t)return}for(e._pt=e._ptCache=0,h=D&&_isNotFalse(h)||h&&!D,g=0;g<l.length;g++){if(w=l[g],S=w._gsap||_harness(l)[g]._gsap,e._ptLookup[g]=I={},_lazyLookup[S.id]&&_lazyTweens.length&&_lazyRender(),F=p===l?g:p.indexOf(w),O&&(P=new O).init(w,k||C,e,F,p)!==!1&&(e._pt=y=new PropTween(e._pt,w,P.name,0,1,P.render,P,0,P.priority),P._props.forEach(function(U){I[U]=y}),P.priority&&(M=1)),!O||k)for(x in C)_plugins[x]&&(P=_checkPlugin(x,C,e,F,w,p))?P.priority&&(M=1):I[x]=y=_addPropTween.call(e,w,x,"get",C[x],F,p,0,r.stringFilter);e._op&&e._op[g]&&e.kill(w,e._op[g]),b&&e._pt&&(_overwritingTween=e,_globalTimeline.killTweensOf(w,I,e.globalTime(t)),B=!e.parent,_overwritingTween=0),e._pt&&h&&(_lazyLookup[S.id]=1)}M&&_sortPropTweensByPriority(e),e._onInit&&e._onInit(e)}e._onUpdate=d,e._initted=(!e._op||e._pt)&&!B,v&&t<=0&&E.render(_bigNum$1,!0,!0)},_updatePropTweens=function(e,t,i,r,s,o,a,h){var d=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,m,v,_;if(!d)for(d=e._ptCache[t]=[],v=e._ptLookup,_=e._targets.length;_--;){if(u=v[_][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return _forceAllPropTweens=1,e.vars[t]="+=0",_initTween(e,a),_forceAllPropTweens=0,h?_warn(t+" not eligible for reset"):1;d.push(u)}for(_=d.length;_--;)m=d[_],u=m._pt||m,u.s=(r||r===0)&&!s?r:u.s+(r||0)+o*u.c,u.c=i-u.s,m.e&&(m.e=_round$1(i)+getUnit(m.e)),m.b&&(m.b=u.s+getUnit(m.b))},_addAliasesToVars=function(e,t){var i=e[0]?_getCache(e[0]).harness:0,r=i&&i.aliases,s,o,a,h;if(!r)return t;s=_merge({},t);for(o in r)if(o in s)for(h=r[o].split(","),a=h.length;a--;)s[h[a]]=s[o];return s},_parseKeyframe=function(e,t,i,r){var s=t.ease||r||"power1.inOut",o,a;if(_isArray(t))a=i[e]||(i[e]=[]),t.forEach(function(h,d){return a.push({t:d/(t.length-1)*100,v:h,e:s})});else for(o in t)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},_parseFuncOrString=function(e,t,i,r,s){return _isFunction$1(e)?e.call(t,i,r,s):_isString$1(e)&&~e.indexOf("random(")?_replaceRandom(e):e},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return _staggerPropsToSkip[n]=1});var Tween=function(n){_inheritsLoose(e,n);function e(i,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=n.call(this,o?r:_inheritDefaults(r))||this;var h=a.vars,d=h.duration,u=h.delay,m=h.immediateRender,v=h.stagger,_=h.overwrite,D=h.keyframes,f=h.defaults,l=h.scrollTrigger,c=h.yoyoEase,p=r.parent||_globalTimeline,b=(_isArray(i)||_isTypedArray(i)?_isNumber$1(i[0]):"length"in r)?[i]:toArray(i),E,C,g,x,y,w,M,S;if(a._targets=b.length?_harness(b):_warn("GSAP target "+i+" not found. https://gsap.com",!_config.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=_,D||v||_isFuncOrString(d)||_isFuncOrString(u)){if(r=a.vars,E=a.timeline=new Timeline({data:"nested",defaults:f||{},targets:p&&p.data==="nested"?p.vars.targets:b}),E.kill(),E.parent=E._dp=_assertThisInitialized(a),E._start=0,v||_isFuncOrString(d)||_isFuncOrString(u)){if(x=b.length,M=v&&distribute(v),_isObject$1(v))for(y in v)~_staggerTweenProps.indexOf(y)&&(S||(S={}),S[y]=v[y]);for(C=0;C<x;C++)g=_copyExcluding(r,_staggerPropsToSkip),g.stagger=0,c&&(g.yoyoEase=c),S&&_merge(g,S),w=b[C],g.duration=+_parseFuncOrString(d,_assertThisInitialized(a),C,w,b),g.delay=(+_parseFuncOrString(u,_assertThisInitialized(a),C,w,b)||0)-a._delay,!v&&x===1&&g.delay&&(a._delay=u=g.delay,a._start+=u,g.delay=0),E.to(w,g,M?M(C,w,b):0),E._ease=_easeMap.none;E.duration()?d=u=0:a.timeline=0}else if(D){_inheritDefaults(_setDefaults$1(E.vars.defaults,{ease:"none"})),E._ease=_parseEase(D.ease||r.ease||"none");var O=0,P,I,F;if(_isArray(D))D.forEach(function(k){return E.to(b,k,">")}),E.duration();else{g={};for(y in D)y==="ease"||y==="easeEach"||_parseKeyframe(y,D[y],g,D.easeEach);for(y in g)for(P=g[y].sort(function(k,B){return k.t-B.t}),O=0,C=0;C<P.length;C++)I=P[C],F={ease:I.e,duration:(I.t-(C?P[C-1].t:0))/100*d},F[y]=I.v,E.to(b,F,O),O+=F.duration;E.duration()<d&&E.to({},{duration:d-E.duration()})}}d||a.duration(d=E.duration())}else a.timeline=0;return _===!0&&!_suppressOverwrites$1&&(_overwritingTween=_assertThisInitialized(a),_globalTimeline.killTweensOf(b),_overwritingTween=0),_addToTimeline(p,_assertThisInitialized(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(m||!d&&!D&&a._start===_roundPrecise(p._time)&&_isNotFalse(m)&&_hasNoPausedAncestors(_assertThisInitialized(a))&&p.data!=="nested")&&(a._tTime=-_tinyNum,a.render(Math.max(0,-u)||0)),l&&_scrollTrigger(_assertThisInitialized(a),l),a}var t=e.prototype;return t.render=function(r,s,o){var a=this._time,h=this._tDur,d=this._dur,u=r<0,m=r>h-_tinyNum&&!u?h:r<_tinyNum?0:r,v,_,D,f,l,c,p,b,E;if(!d)_renderZeroDurationTween(this,r,s,o);else if(m!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u||this._lazy){if(v=m,b=this.timeline,this._repeat){if(f=d+this._rDelay,this._repeat<-1&&u)return this.totalTime(f*100+r,s,o);if(v=_roundPrecise(m%f),m===h?(D=this._repeat,v=d):(l=_roundPrecise(m/f),D=~~l,D&&D===l?(v=d,D--):v>d&&(v=d)),c=this._yoyo&&D&1,c&&(E=this._yEase,v=d-v),l=_animationCycle(this._tTime,f),v===a&&!o&&this._initted&&D===l)return this._tTime=m,this;D!==l&&(b&&this._yEase&&_propagateYoyoEase(b,c),this.vars.repeatRefresh&&!c&&!this._lock&&v!==f&&this._initted&&(this._lock=o=1,this.render(_roundPrecise(f*D),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,u?r:v,o,s,m))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&D!==l))return this;if(d!==this._dur)return this.render(r,s,o)}if(this._tTime=m,this._time=v,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=p=(E||this._ease)(v/d),this._from&&(this.ratio=p=1-p),!a&&m&&!s&&!l&&(_callback$1(this,"onStart"),this._tTime!==m))return this;for(_=this._pt;_;)_.r(p,_.d),_=_._next;b&&b.render(r<0?r:b._dur*b._ease(v/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&_rewindStartAt(this,r,s,o),_callback$1(this,"onUpdate")),this._repeat&&D!==l&&this.vars.onRepeat&&!s&&this.parent&&_callback$1(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(u&&!this._onUpdate&&_rewindStartAt(this,r,!0,!0),(r||!d)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&_removeFromParent(this,1),!s&&!(u&&!a)&&(m||a||c)&&(_callback$1(this,m===h?"onComplete":"onReverseComplete",!0),this._prom&&!(m<h&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a,h){_tickerActive||_ticker.wake(),this._ts||this.play();var d=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||_initTween(this,d),u=this._ease(d/this._dur),_updatePropTweens(this,r,s,o,a,u,d,h)?this.resetTo(r,s,o,a,1):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!_reverting$1),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&o!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?toArray(r):a,d=this._ptLookup,u=this._pt,m,v,_,D,f,l,c;if((!s||s==="all")&&_arraysMatch(a,h))return s==="all"&&(this._pt=0),_interrupt(this);for(m=this._op=this._op||[],s!=="all"&&(_isString$1(s)&&(f={},_forEachName(s,function(p){return f[p]=1}),s=f),s=_addAliasesToVars(a,s)),c=a.length;c--;)if(~h.indexOf(a[c])){v=d[c],s==="all"?(m[c]=s,D=v,_={}):(_=m[c]=m[c]||{},D=s);for(f in D)l=v&&v[f],l&&((!("kill"in l.d)||l.d.kill(f)===!0)&&_removeLinkedListItem(this,l,"_pt"),delete v[f]),_!=="all"&&(_[f]=1)}return this._initted&&!this._pt&&u&&_interrupt(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return _createTweenType(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return _createTweenType(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return _globalTimeline.killTweensOf(r,s,o)},e}(Animation$1);_setDefaults$1(Tween.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(n){Tween[n]=function(){var e=new Timeline,t=_slice.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var _setterPlain=function(e,t,i){return e[t]=i},_setterFunc=function(e,t,i){return e[t](i)},_setterFuncWithParam=function(e,t,i,r){return e[t](r.fp,i)},_setterAttribute=function(e,t,i){return e.setAttribute(t,i)},_getSetter=function(e,t){return _isFunction$1(e[t])?_setterFunc:_isUndefined(e[t])&&e.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},_renderBoolean=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},_renderComplexString=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},_renderPropTweens=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},_addPluginModifier=function(e,t,i,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},_killPropTweensOf=function(e){for(var t=this._pt,i,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?_removeLinkedListItem(this,t,"_pt"):t.dep||(i=1),t=r;return!i},_setterWithModifier=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},_sortPropTweensByPriority=function(e){for(var t=e._pt,i,r,s,o;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},PropTween=function(){function n(t,i,r,s,o,a,h,d,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||_renderPlain,this.d=h||this,this.set=d||_setterPlain,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=i,this.mt=s,this.tween=r},n}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return _reservedProps[n]=1});_globals.TweenMax=_globals.TweenLite=Tween;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults$1,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners$1={},_emptyArray$1=[],_lastMediaTime=0,_contextID=0,_dispatch$1=function(e){return(_listeners$1[e]||_emptyArray$1).map(function(t){return t()})},_onMediaChange=function(){var e=Date.now(),t=[];e-_lastMediaTime>2&&(_dispatch$1("matchMediaInit"),_media.forEach(function(i){var r=i.queries,s=i.conditions,o,a,h,d;for(a in r)o=_win$3.matchMedia(r[a]).matches,o&&(h=1),o!==s[a]&&(s[a]=o,d=1);d&&(i.revert(),h&&t.push(i))}),_dispatch$1("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),_lastMediaTime=e,_dispatch$1("matchMedia"))},Context=function(){function n(t,i){this.selector=i&&selector(i),this.data=[],this._r=[],this.isReverted=!1,this.id=_contextID++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){_isFunction$1(i)&&(s=r,r=i,i=_isFunction$1);var o=this,a=function(){var d=_context$2,u=o.selector,m;return d&&d!==o&&d.data.push(o),s&&(o.selector=selector(s)),_context$2=o,m=r.apply(o,arguments),_isFunction$1(m)&&o._r.push(m),_context$2=d,o.selector=u,o.isReverted=!1,m};return o.last=a,i===_isFunction$1?a(o,function(h){return o.add(null,h)}):i?o[i]=a:a},e.ignore=function(i){var r=_context$2;_context$2=null,i(this),_context$2=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof Tween&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i?function(){for(var a=s.getTweens(),h=s.data.length,d;h--;)d=s.data[h],d.data==="isFlip"&&(d.revert(),d.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,m){return m.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),h=s.data.length;h--;)d=s.data[h],d instanceof Timeline?d.data!=="nested"&&(d.scrollTrigger&&d.scrollTrigger.revert(),d.kill()):!(d instanceof Tween)&&d.revert&&d.revert(i);s._r.forEach(function(u){return u(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),r)for(var o=_media.length;o--;)_media[o].id===this.id&&_media.splice(o,1)},e.revert=function(i){this.kill(i||{})},n}(),MatchMedia=function(){function n(t){this.contexts=[],this.scope=t,_context$2&&_context$2.data.push(this)}var e=n.prototype;return e.add=function(i,r,s){_isObject$1(i)||(i={matches:i});var o=new Context(0,s||this.scope),a=o.conditions={},h,d,u;_context$2&&!o.selector&&(o.selector=_context$2.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i;for(d in i)d==="all"?u=1:(h=_win$3.matchMedia(i[d]),h&&(_media.indexOf(o)<0&&_media.push(o),(a[d]=h.matches)&&(u=1),h.addListener?h.addListener(_onMediaChange):h.addEventListener("change",_onMediaChange)));return u&&r(o,function(m){return o.add(null,m)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),_gsap={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return _createPlugin(r)})},timeline:function(e){return new Timeline(e)},getTweensOf:function(e,t){return _globalTimeline.getTweensOf(e,t)},getProperty:function(e,t,i,r){_isString$1(e)&&(e=toArray(e)[0]);var s=_getCache(e||{}).get,o=i?_passThrough$1:_numericIfPossible;return i==="native"&&(i=""),e&&(t?o((_plugins[t]&&_plugins[t].get||s)(e,t,i,r)):function(a,h,d){return o((_plugins[a]&&_plugins[a].get||s)(e,a,h,d))})},quickSetter:function(e,t,i){if(e=toArray(e),e.length>1){var r=e.map(function(u){return gsap$3.quickSetter(u,t,i)}),s=r.length;return function(u){for(var m=s;m--;)r[m](u)}}e=e[0]||{};var o=_plugins[t],a=_getCache(e),h=a.harness&&(a.harness.aliases||{})[t]||t,d=o?function(u){var m=new o;_quickTween._pt=0,m.init(e,i?u+i:u,_quickTween,0,[e]),m.render(1,m),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:a.set(e,h);return o?d:function(u){return d(e,h,i?u+i:u,a,1)}},quickTo:function(e,t,i){var r,s=gsap$3.to(e,_setDefaults$1((r={},r[t]="+=0.1",r.paused=!0,r.stagger=0,r),i||{})),o=function(h,d,u){return s.resetTo(t,h,d,u)};return o.tween=s,o},isTweening:function(e){return _globalTimeline.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=_parseEase(e.ease,_defaults$1.ease)),_mergeDeep(_defaults$1,e||{})},config:function(e){return _mergeDeep(_config,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!_plugins[a]&&!_globals[a]&&_warn(t+" effect requires "+a+" plugin.")}),_effects[t]=function(a,h,d){return i(toArray(a),_setDefaults$1(h||{},s),d)},o&&(Timeline.prototype[t]=function(a,h,d){return this.add(_effects[t](a,_isObject$1(h)?h:(d=h)&&{},this),d)})},registerEase:function(e,t){_easeMap[e]=_parseEase(t)},parseEase:function(e,t){return arguments.length?_parseEase(e,t):_easeMap},getById:function(e){return _globalTimeline.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Timeline(e),r,s;for(i.smoothChildTiming=_isNotFalse(e.smoothChildTiming),_globalTimeline.remove(i),i._dp=0,i._time=i._tTime=_globalTimeline._time,r=_globalTimeline._first;r;)s=r._next,(t||!(!r._dur&&r instanceof Tween&&r.vars.onComplete===r._targets[0]))&&_addToTimeline(i,r,r._start-r._delay),r=s;return _addToTimeline(_globalTimeline,i,0),i},context:function(e,t){return e?new Context(e,t):_context$2},matchMedia:function(e){return new MatchMedia(e)},matchMediaRefresh:function(){return _media.forEach(function(e){var t=e.conditions,i,r;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||_onMediaChange()},addEventListener:function(e,t){var i=_listeners$1[e]||(_listeners$1[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=_listeners$1[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate:interpolate$2,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween,Timeline,Animation:Animation$1,getCache:_getCache,_removeLinkedListItem,reverting:function(){return _reverting$1},context:function(e){return e&&_context$2&&(_context$2.data.push(e),e._ctx=_context$2),_context$2},suppressOverwrites:function(e){return _suppressOverwrites$1=e}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return _gsap[n]=Tween[n]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},_addModifiers=function(e,t){var i=e._targets,r,s,o;for(r in t)for(s=i.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=_getPluginPropTween(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))},_buildModifierPlugin=function(e,t){return{name:e,headless:1,rawVars:1,init:function(r,s,o){o._onInit=function(a){var h,d;if(_isString$1(s)&&(h={},_forEachName(s,function(u){return h[u]=1}),s=h),t){h={};for(d in s)h[d]=t(s[d]);s=h}_addModifiers(a,s)}}}},gsap$3=_gsap.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,a,h;this.tween=i;for(o in t)h=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(h||0)+"",t[o],r,s,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)_reverting$1?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween.version=Timeline.version=gsap$3.version="3.13.0";_coreReady=1;_windowExists$2()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _win$2,_doc$2,_docElement,_pluginInitted,_tempDiv$1,_recentSetterPlugin,_reverting,_windowExists$1=function(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp$1=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderPropWithEnd=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderCSSPropWithBeginning=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},_renderRoundedCSSProp=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},_renderNonTweeningValue=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},_renderNonTweeningValueOnlyAtEnd=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},_setterCSSStyle=function(e,t,i){return e.style[t]=i},_setterCSSProp=function(e,t,i){return e.style.setProperty(t,i)},_setterTransform=function(e,t,i){return e._gsap[t]=i},_setterScale=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},_setterScaleWithRender=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},_setterTransformWithRender=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},_transformProp$1="transform",_transformOriginProp=_transformProp$1+"Origin",_saveStyle=function n(e,t){var i=this,r=this.target,s=r.style,o=r._gsap;if(e in _transformProps&&s){if(this.tfm=this.tfm||{},e!=="transform")e=_propertyAliases[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=_get(r,a)}):this.tfm[e]=o.x?o[e]:_get(r,e),e===_transformOriginProp&&(this.tfm.zOrigin=o.zOrigin);else return _propertyAliases.transform.split(",").forEach(function(a){return n.call(i,a,t)});if(this.props.indexOf(_transformProp$1)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,t,"")),e=_transformProp$1}(s||t)&&this.props.push(e,t,s[e])},_removeIndependentTransforms=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},_revertStyle=function(){var e=this.props,t=this.target,i=t.style,r=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(_capsExp$1,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=_reverting(),(!s||!s.isStart)&&!i[_transformProp$1]&&(_removeIndependentTransforms(i),r.zOrigin&&i[_transformOriginProp]&&(i[_transformOriginProp]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},_getStyleSaver=function(e,t){var i={target:e,props:[],revert:_revertStyle,save:_saveStyle};return e._gsap||gsap$3.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(r){return i.save(r)}),i},_supports3D,_createElement=function(e,t){var i=_doc$2.createElementNS?_doc$2.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):_doc$2.createElement(e);return i&&i.style?i:_doc$2.createElement(e)},_getComputedProperty=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(_capsExp$1,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,_checkPropPrefix(t)||t,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function(e,t,i){var r=t||_tempDiv$1,s=r.style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(_prefixes[o]+e in s););return o<0?null:(o===3?"ms":o>=0?_prefixes[o]:"")+e},_initCore$1=function(){_windowExists$1()&&window.document&&(_win$2=window,_doc$2=_win$2.document,_docElement=_doc$2.documentElement,_tempDiv$1=_createElement("div")||{style:{}},_createElement("div"),_transformProp$1=_checkPropPrefix(_transformProp$1),_transformOriginProp=_transformProp$1+"Origin",_tempDiv$1.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap$3.core.reverting,_pluginInitted=1)},_getReparentedCloneBBox=function(e){var t=e.ownerSVGElement,i=_createElement("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=e.cloneNode(!0),s;r.style.display="block",i.appendChild(r),_docElement.appendChild(i);try{s=r.getBBox()}catch{}return i.removeChild(r),_docElement.removeChild(i),s},_getAttributeFallbacks=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},_getBBox=function(e){var t,i;try{t=e.getBBox()}catch{t=_getReparentedCloneBBox(e),i=1}return t&&(t.width||t.height)||i||(t=_getReparentedCloneBBox(e)),t&&!t.width&&!t.x&&!t.y?{x:+_getAttributeFallbacks(e,["x","cx","x1"])||0,y:+_getAttributeFallbacks(e,["y","cy","y1"])||0,width:0,height:0}:t},_isSVG=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&_getBBox(e))},_removeProperty=function(e,t){if(t){var i=e.style,r;t in _transformProps&&t!==_transformOriginProp&&(t=_transformProp$1),i.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(r==="--"?t:t.replace(_capsExp$1,"-$1").toLowerCase())):i.removeAttribute(t)}},_addNonTweeningPT=function(e,t,i,r,s,o){var a=new PropTween(e._pt,t,i,0,1,o?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return e._pt=a,a.b=r,a.e=s,e._props.push(i),a},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function n(e,t,i,r){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=_tempDiv$1.style,h=_horizontalExp.test(t),d=e.tagName.toLowerCase()==="svg",u=(d?"client":"offset")+(h?"Width":"Height"),m=100,v=r==="px",_=r==="%",D,f,l,c;if(r===o||!s||_nonConvertibleUnits[r]||_nonConvertibleUnits[o])return s;if(o!=="px"&&!v&&(s=n(e,t,i,"px")),c=e.getCTM&&_isSVG(e),(_||o==="%")&&(_transformProps[t]||~t.indexOf("adius")))return D=c?e.getBBox()[h?"width":"height"]:e[u],_round$1(_?s/D*m:s/100*D);if(a[h?"width":"height"]=m+(v?o:r),f=r!=="rem"&&~t.indexOf("adius")||r==="em"&&e.appendChild&&!d?e:e.parentNode,c&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===_doc$2||!f.appendChild)&&(f=_doc$2.body),l=f._gsap,l&&_&&l.width&&h&&l.time===_ticker.time&&!l.uncache)return _round$1(s/l.width*m);if(_&&(t==="height"||t==="width")){var p=e.style[t];e.style[t]=m+r,D=e[u],p?e.style[t]=p:_removeProperty(e,t)}else(_||o==="%")&&!_nonStandardLayouts[_getComputedProperty(f,"display")]&&(a.position=_getComputedProperty(e,"position")),f===e&&(a.position="static"),f.appendChild(_tempDiv$1),D=_tempDiv$1[u],f.removeChild(_tempDiv$1),a.position="absolute";return h&&_&&(l=_getCache(f),l.time=_ticker.time,l.width=f[u]),_round$1(v?D*s/m:D&&s?m/D*s:0)},_get=function(e,t,i,r){var s;return _pluginInitted||_initCore$1(),t in _propertyAliases&&t!=="transform"&&(t=_propertyAliases[t],~t.indexOf(",")&&(t=t.split(",")[0])),_transformProps[t]&&t!=="transform"?(s=_parseTransform(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:_firstTwoOnly(_getComputedProperty(e,_transformOriginProp))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=_specialProps[t]&&_specialProps[t](e,t,i)||_getComputedProperty(e,t)||_getProperty(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?_convertToUnit(e,t,s,i)+i:s},_tweenComplexCSSString=function(e,t,i,r){if(!i||i==="none"){var s=_checkPropPrefix(t,e,1),o=s&&_getComputedProperty(e,s,1);o&&o!==i?(t=s,i=o):t==="borderColor"&&(i=_getComputedProperty(e,"borderTopColor"))}var a=new PropTween(this._pt,e.style,t,0,1,_renderComplexString),h=0,d=0,u,m,v,_,D,f,l,c,p,b,E,C;if(a.b=i,a.e=r,i+="",r+="",r.substring(0,6)==="var(--"&&(r=_getComputedProperty(e,r.substring(4,r.indexOf(")")))),r==="auto"&&(f=e.style[t],e.style[t]=r,r=_getComputedProperty(e,t)||r,f?e.style[t]=f:_removeProperty(e,t)),u=[i,r],_colorStringFilter(u),i=u[0],r=u[1],v=i.match(_numWithUnitExp)||[],C=r.match(_numWithUnitExp)||[],C.length){for(;m=_numWithUnitExp.exec(r);)l=m[0],p=r.substring(h,m.index),D?D=(D+1)%5:(p.substr(-5)==="rgba("||p.substr(-5)==="hsla(")&&(D=1),l!==(f=v[d++]||"")&&(_=parseFloat(f)||0,E=f.substr((_+"").length),l.charAt(1)==="="&&(l=_parseRelative(_,l)+E),c=parseFloat(l),b=l.substr((c+"").length),h=_numWithUnitExp.lastIndex-b.length,b||(b=b||_config.units[t]||E,h===r.length&&(r+=b,a.e+=b)),E!==b&&(_=_convertToUnit(e,t,f,b)||0),a._pt={_next:a._pt,p:p||d===1?p:",",s:_,c:c-_,m:D&&D<4||t==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=t==="display"&&r==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(r)&&(a.e=0),this._pt=a,a},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(e=i,i=r,r=e),t[0]=_keywordToPercent[i]||i,t[1]=_keywordToPercent[r]||r,t.join(" ")},_renderClearProps=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,r=i.style,s=t.u,o=i._gsap,a,h,d;if(s==="all"||s===!0)r.cssText="",h=1;else for(s=s.split(","),d=s.length;--d>-1;)a=s[d],_transformProps[a]&&(h=1,a=a==="transformOrigin"?_transformOriginProp:_transformProp$1),_removeProperty(i,a);h&&(_removeProperty(i,_transformProp$1),o&&(o.svg&&i.removeAttribute("transform"),r.scale=r.rotate=r.translate="none",_parseTransform(i,1),o.uncache=1,_removeIndependentTransforms(r)))}},_specialProps={clearProps:function(e,t,i,r,s){if(s.data!=="isFromStart"){var o=e._pt=new PropTween(e._pt,t,i,0,0,_renderClearProps);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},_getComputedTransformMatrixAsArray=function(e){var t=_getComputedProperty(e,_transformProp$1);return _isNullTransform(t)?_identity2DMatrix:t.substr(7).match(_numExp).map(_round$1)},_getMatrix=function(e,t){var i=e._gsap||_getCache(e),r=e.style,s=_getComputedTransformMatrixAsArray(e),o,a,h,d;return i.svg&&e.getAttribute("transform")?(h=e.transform.baseVal.consolidate().matrix,s=[h.a,h.b,h.c,h.d,h.e,h.f],s.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:s):(s===_identity2DMatrix&&!e.offsetParent&&e!==_docElement&&!i.svg&&(h=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent&&!e.getBoundingClientRect().width)&&(d=1,a=e.nextElementSibling,_docElement.appendChild(e)),s=_getComputedTransformMatrixAsArray(e),h?r.display=h:_removeProperty(e,"display"),d&&(a?o.insertBefore(e,a):o?o.appendChild(e):_docElement.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},_applySVGOrigin=function(e,t,i,r,s,o){var a=e._gsap,h=s||_getMatrix(e,!0),d=a.xOrigin||0,u=a.yOrigin||0,m=a.xOffset||0,v=a.yOffset||0,_=h[0],D=h[1],f=h[2],l=h[3],c=h[4],p=h[5],b=t.split(" "),E=parseFloat(b[0])||0,C=parseFloat(b[1])||0,g,x,y,w;i?h!==_identity2DMatrix&&(x=_*l-D*f)&&(y=E*(l/x)+C*(-f/x)+(f*p-l*c)/x,w=E*(-D/x)+C*(_/x)-(_*p-D*c)/x,E=y,C=w):(g=_getBBox(e),E=g.x+(~b[0].indexOf("%")?E/100*g.width:E),C=g.y+(~(b[1]||b[0]).indexOf("%")?C/100*g.height:C)),r||r!==!1&&a.smooth?(c=E-d,p=C-u,a.xOffset=m+(c*_+p*f)-c,a.yOffset=v+(c*D+p*l)-p):a.xOffset=a.yOffset=0,a.xOrigin=E,a.yOrigin=C,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!i,e.style[_transformOriginProp]="0px 0px",o&&(_addNonTweeningPT(o,a,"xOrigin",d,E),_addNonTweeningPT(o,a,"yOrigin",u,C),_addNonTweeningPT(o,a,"xOffset",m,a.xOffset),_addNonTweeningPT(o,a,"yOffset",v,a.yOffset)),e.setAttribute("data-svg-origin",E+" "+C)},_parseTransform=function(e,t){var i=e._gsap||new GSCache(e);if("x"in i&&!t&&!i.uncache)return i;var r=e.style,s=i.scaleX<0,o="px",a="deg",h=getComputedStyle(e),d=_getComputedProperty(e,_transformOriginProp)||"0",u,m,v,_,D,f,l,c,p,b,E,C,g,x,y,w,M,S,O,P,I,F,k,B,U,W,R,z,G,q,Q,ne;return u=m=v=f=l=c=p=b=E=0,_=D=1,i.svg=!!(e.getCTM&&_isSVG(e)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[_transformProp$1]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[_transformProp$1]!=="none"?h[_transformProp$1]:"")),r.scale=r.rotate=r.translate="none"),x=_getMatrix(e,i.svg),i.svg&&(i.uncache?(U=e.getBBox(),d=i.xOrigin-U.x+"px "+(i.yOrigin-U.y)+"px",B=""):B=!t&&e.getAttribute("data-svg-origin"),_applySVGOrigin(e,B||d,!!B||i.originIsAbsolute,i.smooth!==!1,x)),C=i.xOrigin||0,g=i.yOrigin||0,x!==_identity2DMatrix&&(S=x[0],O=x[1],P=x[2],I=x[3],u=F=x[4],m=k=x[5],x.length===6?(_=Math.sqrt(S*S+O*O),D=Math.sqrt(I*I+P*P),f=S||O?_atan2(O,S)*_RAD2DEG:0,p=P||I?_atan2(P,I)*_RAD2DEG+f:0,p&&(D*=Math.abs(Math.cos(p*_DEG2RAD))),i.svg&&(u-=C-(C*S+g*P),m-=g-(C*O+g*I))):(ne=x[6],q=x[7],R=x[8],z=x[9],G=x[10],Q=x[11],u=x[12],m=x[13],v=x[14],y=_atan2(ne,G),l=y*_RAD2DEG,y&&(w=Math.cos(-y),M=Math.sin(-y),B=F*w+R*M,U=k*w+z*M,W=ne*w+G*M,R=F*-M+R*w,z=k*-M+z*w,G=ne*-M+G*w,Q=q*-M+Q*w,F=B,k=U,ne=W),y=_atan2(-P,G),c=y*_RAD2DEG,y&&(w=Math.cos(-y),M=Math.sin(-y),B=S*w-R*M,U=O*w-z*M,W=P*w-G*M,Q=I*M+Q*w,S=B,O=U,P=W),y=_atan2(O,S),f=y*_RAD2DEG,y&&(w=Math.cos(y),M=Math.sin(y),B=S*w+O*M,U=F*w+k*M,O=O*w-S*M,k=k*w-F*M,S=B,F=U),l&&Math.abs(l)+Math.abs(f)>359.9&&(l=f=0,c=180-c),_=_round$1(Math.sqrt(S*S+O*O+P*P)),D=_round$1(Math.sqrt(k*k+ne*ne)),y=_atan2(F,k),p=Math.abs(y)>2e-4?y*_RAD2DEG:0,E=Q?1/(Q<0?-Q:Q):0),i.svg&&(B=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(e,_transformProp$1)),B&&e.setAttribute("transform",B))),Math.abs(p)>90&&Math.abs(p)<270&&(s?(_*=-1,p+=f<=0?180:-180,f+=f<=0?180:-180):(D*=-1,p+=p<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=m-((i.yPercent=m&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-m)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=v+o,i.scaleX=_round$1(_),i.scaleY=_round$1(D),i.rotation=_round$1(f)+a,i.rotationX=_round$1(l)+a,i.rotationY=_round$1(c)+a,i.skewX=p+a,i.skewY=b+a,i.transformPerspective=E+o,(i.zOrigin=parseFloat(d.split(" ")[2])||!t&&i.zOrigin||0)&&(r[_transformOriginProp]=_firstTwoOnly(d)),i.xOffset=i.yOffset=0,i.force3D=_config.force3D,i.renderTransform=i.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,i.uncache=0,i},_firstTwoOnly=function(e){return(e=e.split(" "))[0]+" "+e[1]},_addPxTranslate=function(e,t,i){var r=getUnit(t);return _round$1(parseFloat(t)+parseFloat(_convertToUnit(e,"x",i+"px",r)))+r},_renderNon3DTransforms=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,_renderCSSTransforms(e,t)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,h=i.z,d=i.rotation,u=i.rotationY,m=i.rotationX,v=i.skewX,_=i.skewY,D=i.scaleX,f=i.scaleY,l=i.transformPerspective,c=i.force3D,p=i.target,b=i.zOrigin,E="",C=c==="auto"&&e&&e!==1||c===!0;if(b&&(m!==_zeroDeg||u!==_zeroDeg)){var g=parseFloat(u)*_DEG2RAD,x=Math.sin(g),y=Math.cos(g),w;g=parseFloat(m)*_DEG2RAD,w=Math.cos(g),o=_addPxTranslate(p,o,x*w*-b),a=_addPxTranslate(p,a,-Math.sin(g)*-b),h=_addPxTranslate(p,h,y*w*-b+b)}l!==_zeroPx&&(E+="perspective("+l+_endParenthesis),(r||s)&&(E+="translate("+r+"%, "+s+"%) "),(C||o!==_zeroPx||a!==_zeroPx||h!==_zeroPx)&&(E+=h!==_zeroPx||C?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+_endParenthesis),d!==_zeroDeg&&(E+="rotate("+d+_endParenthesis),u!==_zeroDeg&&(E+="rotateY("+u+_endParenthesis),m!==_zeroDeg&&(E+="rotateX("+m+_endParenthesis),(v!==_zeroDeg||_!==_zeroDeg)&&(E+="skew("+v+", "+_+_endParenthesis),(D!==1||f!==1)&&(E+="scale("+D+", "+f+_endParenthesis),p.style[_transformProp$1]=E||"translate(0, 0)"},_renderSVGTransforms=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,h=i.rotation,d=i.skewX,u=i.skewY,m=i.scaleX,v=i.scaleY,_=i.target,D=i.xOrigin,f=i.yOrigin,l=i.xOffset,c=i.yOffset,p=i.forceCSS,b=parseFloat(o),E=parseFloat(a),C,g,x,y,w;h=parseFloat(h),d=parseFloat(d),u=parseFloat(u),u&&(u=parseFloat(u),d+=u,h+=u),h||d?(h*=_DEG2RAD,d*=_DEG2RAD,C=Math.cos(h)*m,g=Math.sin(h)*m,x=Math.sin(h-d)*-v,y=Math.cos(h-d)*v,d&&(u*=_DEG2RAD,w=Math.tan(d-u),w=Math.sqrt(1+w*w),x*=w,y*=w,u&&(w=Math.tan(u),w=Math.sqrt(1+w*w),C*=w,g*=w)),C=_round$1(C),g=_round$1(g),x=_round$1(x),y=_round$1(y)):(C=m,y=v,g=x=0),(b&&!~(o+"").indexOf("px")||E&&!~(a+"").indexOf("px"))&&(b=_convertToUnit(_,"x",o,"px"),E=_convertToUnit(_,"y",a,"px")),(D||f||l||c)&&(b=_round$1(b+D-(D*C+f*x)+l),E=_round$1(E+f-(D*g+f*y)+c)),(r||s)&&(w=_.getBBox(),b=_round$1(b+r/100*w.width),E=_round$1(E+s/100*w.height)),w="matrix("+C+","+g+","+x+","+y+","+b+","+E+")",_.setAttribute("transform",w),p&&(_.style[_transformProp$1]=w)},_addRotationalPropTween=function(e,t,i,r,s){var o=360,a=_isString$1(s),h=parseFloat(s)*(a&&~s.indexOf("rad")?_RAD2DEG:1),d=h-r,u=r+d+"deg",m,v;return a&&(m=s.split("_")[1],m==="short"&&(d%=o,d!==d%(o/2)&&(d+=d<0?o:-o)),m==="cw"&&d<0?d=(d+o*_bigNum)%o-~~(d/o)*o:m==="ccw"&&d>0&&(d=(d-o*_bigNum)%o-~~(d/o)*o)),e._pt=v=new PropTween(e._pt,t,i,r,d,_renderPropWithEnd),v.e=u,v.u="deg",e._props.push(i),v},_assign=function(e,t){for(var i in t)e[i]=t[i];return e},_addRawTransformPTs=function(e,t,i){var r=_assign({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,h,d,u,m,v,_,D;r.svg?(d=i.getAttribute("transform"),i.setAttribute("transform",""),o[_transformProp$1]=t,a=_parseTransform(i,1),_removeProperty(i,_transformProp$1),i.setAttribute("transform",d)):(d=getComputedStyle(i)[_transformProp$1],o[_transformProp$1]=t,a=_parseTransform(i,1),o[_transformProp$1]=d);for(h in _transformProps)d=r[h],u=a[h],d!==u&&s.indexOf(h)<0&&(_=getUnit(d),D=getUnit(u),m=_!==D?_convertToUnit(i,h,d,D):parseFloat(d),v=parseFloat(u),e._pt=new PropTween(e._pt,a,h,m,v-m,_renderCSSProp),e._pt.u=D||0,e._props.push(h));_assign(a,r)};_forEachName("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});_specialProps[e>1?"border"+n:n]=function(a,h,d,u,m){var v,_;if(arguments.length<4)return v=o.map(function(D){return _get(a,D,d)}),_=v.join(" "),_.split(v[0]).length===5?v[0]:_;v=(u+"").split(" "),_={},o.forEach(function(D,f){return _[D]=v[f]=v[f]||v[(f-1)/2|0]}),a.init(h,_,m)}});var CSSPlugin={name:"css",register:_initCore$1,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var o=this._props,a=e.style,h=i.vars.startAt,d,u,m,v,_,D,f,l,c,p,b,E,C,g,x,y;_pluginInitted||_initCore$1(),this.styles=this.styles||_getStyleSaver(e),y=this.styles.props,this.tween=i;for(f in t)if(f!=="autoRound"&&(u=t[f],!(_plugins[f]&&_checkPlugin(f,t,i,r,e,s)))){if(_=typeof u,D=_specialProps[f],_==="function"&&(u=u.call(i,r,e,s),_=typeof u),_==="string"&&~u.indexOf("random(")&&(u=_replaceRandom(u)),D)D(this,e,f,u,i)&&(x=1);else if(f.substr(0,2)==="--")d=(getComputedStyle(e).getPropertyValue(f)+"").trim(),u+="",_colorExp.lastIndex=0,_colorExp.test(d)||(l=getUnit(d),c=getUnit(u)),c?l!==c&&(d=_convertToUnit(e,f,d,c)+c):l&&(u+=l),this.add(a,"setProperty",d,u,r,s,0,0,f),o.push(f),y.push(f,0,a[f]);else if(_!=="undefined"){if(h&&f in h?(d=typeof h[f]=="function"?h[f].call(i,r,e,s):h[f],_isString$1(d)&&~d.indexOf("random(")&&(d=_replaceRandom(d)),getUnit(d+"")||d==="auto"||(d+=_config.units[f]||getUnit(_get(e,f))||""),(d+"").charAt(1)==="="&&(d=_get(e,f))):d=_get(e,f),v=parseFloat(d),p=_==="string"&&u.charAt(1)==="="&&u.substr(0,2),p&&(u=u.substr(2)),m=parseFloat(u),f in _propertyAliases&&(f==="autoAlpha"&&(v===1&&_get(e,"visibility")==="hidden"&&m&&(v=0),y.push("visibility",0,a.visibility),_addNonTweeningPT(this,a,"visibility",v?"inherit":"hidden",m?"inherit":"hidden",!m)),f!=="scale"&&f!=="transform"&&(f=_propertyAliases[f],~f.indexOf(",")&&(f=f.split(",")[0]))),b=f in _transformProps,b){if(this.styles.save(f),_==="string"&&u.substring(0,6)==="var(--"&&(u=_getComputedProperty(e,u.substring(4,u.indexOf(")"))),m=parseFloat(u)),E||(C=e._gsap,C.renderTransform&&!t.parseTransform||_parseTransform(e,t.parseTransform),g=t.smoothOrigin!==!1&&C.smooth,E=this._pt=new PropTween(this._pt,a,_transformProp$1,0,1,C.renderTransform,C,0,-1),E.dep=1),f==="scale")this._pt=new PropTween(this._pt,C,"scaleY",C.scaleY,(p?_parseRelative(C.scaleY,p+m):m)-C.scaleY||0,_renderCSSProp),this._pt.u=0,o.push("scaleY",f),f+="X";else if(f==="transformOrigin"){y.push(_transformOriginProp,0,a[_transformOriginProp]),u=_convertKeywordsToPercentages(u),C.svg?_applySVGOrigin(e,u,0,g,0,this):(c=parseFloat(u.split(" ")[2])||0,c!==C.zOrigin&&_addNonTweeningPT(this,C,"zOrigin",C.zOrigin,c),_addNonTweeningPT(this,a,f,_firstTwoOnly(d),_firstTwoOnly(u)));continue}else if(f==="svgOrigin"){_applySVGOrigin(e,u,1,g,0,this);continue}else if(f in _rotationalProperties){_addRotationalPropTween(this,C,f,v,p?_parseRelative(v,p+u):u);continue}else if(f==="smoothOrigin"){_addNonTweeningPT(this,C,"smooth",C.smooth,u);continue}else if(f==="force3D"){C[f]=u;continue}else if(f==="transform"){_addRawTransformPTs(this,u,e);continue}}else f in a||(f=_checkPropPrefix(f)||f);if(b||(m||m===0)&&(v||v===0)&&!_complexExp.test(u)&&f in a)l=(d+"").substr((v+"").length),m||(m=0),c=getUnit(u)||(f in _config.units?_config.units[f]:l),l!==c&&(v=_convertToUnit(e,f,d,c)),this._pt=new PropTween(this._pt,b?C:a,f,v,(p?_parseRelative(v,p+m):m)-v,!b&&(c==="px"||f==="zIndex")&&t.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=c||0,l!==c&&c!=="%"&&(this._pt.b=d,this._pt.r=_renderCSSPropWithBeginning);else if(f in a)_tweenComplexCSSString.call(this,e,f,d,p?p+u:u);else if(f in e)this.add(e,f,d||e[f],p?p+u:u,r,s);else if(f!=="parseTransform"){_missingPlugin(f,u);continue}b||(f in a?y.push(f,0,a[f]):typeof e[f]=="function"?y.push(f,2,e[f]()):y.push(f,1,d||e[f])),o.push(f)}}x&&_sortPropTweensByPriority(this)},render:function(e,t){if(t.tween._time||!_reverting())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function(e,t,i){var r=_propertyAliases[t];return r&&r.indexOf(",")<0&&(t=r),t in _transformProps&&t!==_transformOriginProp&&(e._gsap.x||_get(e,"x"))?i&&_recentSetterPlugin===i?t==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=i||{})&&(t==="scale"?_setterScaleWithRender:_setterTransformWithRender):e.style&&!_isUndefined(e.style[t])?_setterCSSStyle:~t.indexOf("-")?_setterCSSProp:_getSetter(e,t)},core:{_removeProperty,_getMatrix}};gsap$3.utils.checkPrefix=_checkPropPrefix;gsap$3.core.getStyleSaver=_getStyleSaver;(function(n,e,t,i){var r=_forEachName(n+","+e+","+t,function(s){_transformProps[s]=1});_forEachName(e,function(s){_config.units[s]="deg",_rotationalProperties[s]=1}),_propertyAliases[r[13]]=n+","+e,_forEachName(i,function(s){var o=s.split(":");_propertyAliases[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){_config.units[n]="px"});gsap$3.registerPlugin(CSSPlugin);var gsapWithCSS=gsap$3.registerPlugin(CSSPlugin)||gsap$3;gsapWithCSS.core.Tween;function _defineProperties(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _createClass(n,e,t){return e&&_defineProperties(n.prototype,e),n}/*!
 * Observer 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$2,_coreInitted$1,_win$1,_doc$1,_docEl$1,_body$1,_isTouch,_pointerType,ScrollTrigger$1,_root$1,_normalizer$1,_eventTypes,_context$1,_getGSAP$2=function(){return gsap$2||typeof window<"u"&&(gsap$2=window.gsap)&&gsap$2.registerPlugin&&gsap$2},_startup$1=1,_observers=[],_scrollers=[],_proxies=[],_getTime$1=Date.now,_bridge=function(e,t){return t},_integrate=function(){var e=ScrollTrigger$1.core,t=e.bridge||{},i=e._scrollers,r=e._proxies;i.push.apply(i,_scrollers),r.push.apply(r,_proxies),_scrollers=i,_proxies=r,_bridge=function(o,a){return t[o](a)}},_getProxyProp=function(e,t){return~_proxies.indexOf(e)&&_proxies[_proxies.indexOf(e)+1][t]},_isViewport$1=function(e){return!!~_root$1.indexOf(e)},_addListener$1=function(e,t,i,r,s){return e.addEventListener(t,i,{passive:r!==!1,capture:!!s})},_removeListener$1=function(e,t,i,r){return e.removeEventListener(t,i,!!r)},_scrollLeft="scrollLeft",_scrollTop="scrollTop",_onScroll$1=function(){return _normalizer$1&&_normalizer$1.isPressed||_scrollers.cache++},_scrollCacheFunc=function(e,t){var i=function r(s){if(s||s===0){_startup$1&&(_win$1.history.scrollRestoration="manual");var o=_normalizer$1&&_normalizer$1.isPressed;s=r.v=Math.round(s)||(_normalizer$1&&_normalizer$1.iOS?1:0),e(s),r.cacheID=_scrollers.cache,o&&_bridge("ss",s)}else(t||_scrollers.cache!==r.cacheID||_bridge("ref"))&&(r.cacheID=_scrollers.cache,r.v=e());return r.v+r.offset};return i.offset=0,e&&i},_horizontal={s:_scrollLeft,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:_scrollCacheFunc(function(n){return arguments.length?_win$1.scrollTo(n,_vertical.sc()):_win$1.pageXOffset||_doc$1[_scrollLeft]||_docEl$1[_scrollLeft]||_body$1[_scrollLeft]||0})},_vertical={s:_scrollTop,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:_horizontal,sc:_scrollCacheFunc(function(n){return arguments.length?_win$1.scrollTo(_horizontal.sc(),n):_win$1.pageYOffset||_doc$1[_scrollTop]||_docEl$1[_scrollTop]||_body$1[_scrollTop]||0})},_getTarget$1=function(e,t){return(t&&t._ctx&&t._ctx.selector||gsap$2.utils.toArray)(e)[0]||(typeof e=="string"&&gsap$2.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},_isWithin=function(e,t){for(var i=t.length;i--;)if(t[i]===e||t[i].contains(e))return!0;return!1},_getScrollFunc=function(e,t){var i=t.s,r=t.sc;_isViewport$1(e)&&(e=_doc$1.scrollingElement||_docEl$1);var s=_scrollers.indexOf(e),o=r===_vertical.sc?1:2;!~s&&(s=_scrollers.push(e)-1),_scrollers[s+o]||_addListener$1(e,"scroll",_onScroll$1);var a=_scrollers[s+o],h=a||(_scrollers[s+o]=_scrollCacheFunc(_getProxyProp(e,i),!0)||(_isViewport$1(e)?r:_scrollCacheFunc(function(d){return arguments.length?e[i]=d:e[i]})));return h.target=e,a||(h.smooth=gsap$2.getProperty(e,"scrollBehavior")==="smooth"),h},_getVelocityProp=function(e,t,i){var r=e,s=e,o=_getTime$1(),a=o,h=t||50,d=Math.max(500,h*3),u=function(D,f){var l=_getTime$1();f||l-o>h?(s=r,r=D,a=o,o=l):i?r+=D:r=s+(D-s)/(l-a)*(o-a)},m=function(){s=r=i?0:r,a=o=0},v=function(D){var f=a,l=s,c=_getTime$1();return(D||D===0)&&D!==r&&u(D),o===a||c-a>d?0:(r+(i?l:-l))/((i?c:o)-f)*1e3};return{update:u,reset:m,getVelocity:v}},_getEvent=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},_getAbsoluteMax=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},_setScrollTrigger=function(){ScrollTrigger$1=gsap$2.core.globals().ScrollTrigger,ScrollTrigger$1&&ScrollTrigger$1.core&&_integrate()},_initCore=function(e){return gsap$2=e||_getGSAP$2(),!_coreInitted$1&&gsap$2&&typeof document<"u"&&document.body&&(_win$1=window,_doc$1=document,_docEl$1=_doc$1.documentElement,_body$1=_doc$1.body,_root$1=[_win$1,_doc$1,_docEl$1,_body$1],gsap$2.utils.clamp,_context$1=gsap$2.core.context||function(){},_pointerType="onpointerenter"in _body$1?"pointer":"mouse",_isTouch=Observer.isTouch=_win$1.matchMedia&&_win$1.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in _win$1||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,_eventTypes=Observer.eventTypes=("ontouchstart"in _docEl$1?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in _docEl$1?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return _startup$1=0},500),_setScrollTrigger(),_coreInitted$1=1),_coreInitted$1};_horizontal.op=_vertical;_scrollers.cache=0;var Observer=function(){function n(t){this.init(t)}var e=n.prototype;return e.init=function(i){_coreInitted$1||_initCore(gsap$2)||console.warn("Please gsap.registerPlugin(Observer)"),ScrollTrigger$1||_setScrollTrigger();var r=i.tolerance,s=i.dragMinimum,o=i.type,a=i.target,h=i.lineHeight,d=i.debounce,u=i.preventDefault,m=i.onStop,v=i.onStopDelay,_=i.ignore,D=i.wheelSpeed,f=i.event,l=i.onDragStart,c=i.onDragEnd,p=i.onDrag,b=i.onPress,E=i.onRelease,C=i.onRight,g=i.onLeft,x=i.onUp,y=i.onDown,w=i.onChangeX,M=i.onChangeY,S=i.onChange,O=i.onToggleX,P=i.onToggleY,I=i.onHover,F=i.onHoverEnd,k=i.onMove,B=i.ignoreCheck,U=i.isNormalizer,W=i.onGestureStart,R=i.onGestureEnd,z=i.onWheel,G=i.onEnable,q=i.onDisable,Q=i.onClick,ne=i.scrollSpeed,te=i.capture,oe=i.allowClicks,re=i.lockAxis,le=i.onLockAxis;this.target=a=_getTarget$1(a)||_docEl$1,this.vars=i,_&&(_=gsap$2.utils.toArray(_)),r=r||1e-9,s=s||0,D=D||1,ne=ne||1,o=o||"wheel,touch,pointer",d=d!==!1,h||(h=parseFloat(_win$1.getComputedStyle(_body$1).lineHeight)||22);var Ce,De,Oe,_e,Z,xe,we,ie=this,Ne=0,Ge=0,Ue=i.passive||!u&&i.passive!==!1,Ie=_getScrollFunc(a,_horizontal),ze=_getScrollFunc(a,_vertical),Re=Ie(),Le=ze(),We=~o.indexOf("touch")&&!~o.indexOf("pointer")&&_eventTypes[0]==="pointerdown",He=_isViewport$1(a),H=a.ownerDocument||_doc$1,K=[0,0,0],X=[0,0,0],pe=0,ue=function(){return pe=_getTime$1()},ye=function(Fe,ke){return(ie.event=Fe)&&_&&_isWithin(Fe.target,_)||ke&&We&&Fe.pointerType!=="touch"||B&&B(Fe,ke)},Se=function(){ie._vx.reset(),ie._vy.reset(),De.pause(),m&&m(ie)},V=function(){var Fe=ie.deltaX=_getAbsoluteMax(K),ke=ie.deltaY=_getAbsoluteMax(X),Ee=Math.abs(Fe)>=r,$e=Math.abs(ke)>=r;S&&(Ee||$e)&&S(ie,Fe,ke,K,X),Ee&&(C&&ie.deltaX>0&&C(ie),g&&ie.deltaX<0&&g(ie),w&&w(ie),O&&ie.deltaX<0!=Ne<0&&O(ie),Ne=ie.deltaX,K[0]=K[1]=K[2]=0),$e&&(y&&ie.deltaY>0&&y(ie),x&&ie.deltaY<0&&x(ie),M&&M(ie),P&&ie.deltaY<0!=Ge<0&&P(ie),Ge=ie.deltaY,X[0]=X[1]=X[2]=0),(_e||Oe)&&(k&&k(ie),Oe&&(l&&Oe===1&&l(ie),p&&p(ie),Oe=0),_e=!1),xe&&!(xe=!1)&&le&&le(ie),Z&&(z(ie),Z=!1),Ce=0},he=function(Fe,ke,Ee){K[Ee]+=Fe,X[Ee]+=ke,ie._vx.update(Fe),ie._vy.update(ke),d?Ce||(Ce=requestAnimationFrame(V)):V()},ve=function(Fe,ke){re&&!we&&(ie.axis=we=Math.abs(Fe)>Math.abs(ke)?"x":"y",xe=!0),we!=="y"&&(K[2]+=Fe,ie._vx.update(Fe,!0)),we!=="x"&&(X[2]+=ke,ie._vy.update(ke,!0)),d?Ce||(Ce=requestAnimationFrame(V)):V()},Pe=function(Fe){if(!ye(Fe,1)){Fe=_getEvent(Fe,u);var ke=Fe.clientX,Ee=Fe.clientY,$e=ke-ie.x,Xe=Ee-ie.y,Ke=ie.isDragging;ie.x=ke,ie.y=Ee,(Ke||($e||Xe)&&(Math.abs(ie.startX-ke)>=s||Math.abs(ie.startY-Ee)>=s))&&(Oe=Ke?2:1,Ke||(ie.isDragging=!0),ve($e,Xe))}},ae=ie.onPress=function(ce){ye(ce,1)||ce&&ce.button||(ie.axis=we=null,De.pause(),ie.isPressed=!0,ce=_getEvent(ce),Ne=Ge=0,ie.startX=ie.x=ce.clientX,ie.startY=ie.y=ce.clientY,ie._vx.reset(),ie._vy.reset(),_addListener$1(U?a:H,_eventTypes[1],Pe,Ue,!0),ie.deltaX=ie.deltaY=0,b&&b(ie))},me=ie.onRelease=function(ce){if(!ye(ce,1)){_removeListener$1(U?a:H,_eventTypes[1],Pe,!0);var Fe=!isNaN(ie.y-ie.startY),ke=ie.isDragging,Ee=ke&&(Math.abs(ie.x-ie.startX)>3||Math.abs(ie.y-ie.startY)>3),$e=_getEvent(ce);!Ee&&Fe&&(ie._vx.reset(),ie._vy.reset(),u&&oe&&gsap$2.delayedCall(.08,function(){if(_getTime$1()-pe>300&&!ce.defaultPrevented){if(ce.target.click)ce.target.click();else if(H.createEvent){var Xe=H.createEvent("MouseEvents");Xe.initMouseEvent("click",!0,!0,_win$1,1,$e.screenX,$e.screenY,$e.clientX,$e.clientY,!1,!1,!1,!1,0,null),ce.target.dispatchEvent(Xe)}}})),ie.isDragging=ie.isGesturing=ie.isPressed=!1,m&&ke&&!U&&De.restart(!0),Oe&&V(),c&&ke&&c(ie),E&&E(ie,Ee)}},j=function(Fe){return Fe.touches&&Fe.touches.length>1&&(ie.isGesturing=!0)&&W(Fe,ie.isDragging)},Te=function(){return(ie.isGesturing=!1)||R(ie)},Be=function(Fe){if(!ye(Fe)){var ke=Ie(),Ee=ze();he((ke-Re)*ne,(Ee-Le)*ne,1),Re=ke,Le=Ee,m&&De.restart(!0)}},L=function(Fe){if(!ye(Fe)){Fe=_getEvent(Fe,u),z&&(Z=!0);var ke=(Fe.deltaMode===1?h:Fe.deltaMode===2?_win$1.innerHeight:1)*D;he(Fe.deltaX*ke,Fe.deltaY*ke,0),m&&!U&&De.restart(!0)}},ge=function(Fe){if(!ye(Fe)){var ke=Fe.clientX,Ee=Fe.clientY,$e=ke-ie.x,Xe=Ee-ie.y;ie.x=ke,ie.y=Ee,_e=!0,m&&De.restart(!0),($e||Xe)&&ve($e,Xe)}},de=function(Fe){ie.event=Fe,I(ie)},$=function(Fe){ie.event=Fe,F(ie)},se=function(Fe){return ye(Fe)||_getEvent(Fe,u)&&Q(ie)};De=ie._dc=gsap$2.delayedCall(v||.25,Se).pause(),ie.deltaX=ie.deltaY=0,ie._vx=_getVelocityProp(0,50,!0),ie._vy=_getVelocityProp(0,50,!0),ie.scrollX=Ie,ie.scrollY=ze,ie.isDragging=ie.isGesturing=ie.isPressed=!1,_context$1(this),ie.enable=function(ce){return ie.isEnabled||(_addListener$1(He?H:a,"scroll",_onScroll$1),o.indexOf("scroll")>=0&&_addListener$1(He?H:a,"scroll",Be,Ue,te),o.indexOf("wheel")>=0&&_addListener$1(a,"wheel",L,Ue,te),(o.indexOf("touch")>=0&&_isTouch||o.indexOf("pointer")>=0)&&(_addListener$1(a,_eventTypes[0],ae,Ue,te),_addListener$1(H,_eventTypes[2],me),_addListener$1(H,_eventTypes[3],me),oe&&_addListener$1(a,"click",ue,!0,!0),Q&&_addListener$1(a,"click",se),W&&_addListener$1(H,"gesturestart",j),R&&_addListener$1(H,"gestureend",Te),I&&_addListener$1(a,_pointerType+"enter",de),F&&_addListener$1(a,_pointerType+"leave",$),k&&_addListener$1(a,_pointerType+"move",ge)),ie.isEnabled=!0,ie.isDragging=ie.isGesturing=ie.isPressed=_e=Oe=!1,ie._vx.reset(),ie._vy.reset(),Re=Ie(),Le=ze(),ce&&ce.type&&ae(ce),G&&G(ie)),ie},ie.disable=function(){ie.isEnabled&&(_observers.filter(function(ce){return ce!==ie&&_isViewport$1(ce.target)}).length||_removeListener$1(He?H:a,"scroll",_onScroll$1),ie.isPressed&&(ie._vx.reset(),ie._vy.reset(),_removeListener$1(U?a:H,_eventTypes[1],Pe,!0)),_removeListener$1(He?H:a,"scroll",Be,te),_removeListener$1(a,"wheel",L,te),_removeListener$1(a,_eventTypes[0],ae,te),_removeListener$1(H,_eventTypes[2],me),_removeListener$1(H,_eventTypes[3],me),_removeListener$1(a,"click",ue,!0),_removeListener$1(a,"click",se),_removeListener$1(H,"gesturestart",j),_removeListener$1(H,"gestureend",Te),_removeListener$1(a,_pointerType+"enter",de),_removeListener$1(a,_pointerType+"leave",$),_removeListener$1(a,_pointerType+"move",ge),ie.isEnabled=ie.isPressed=ie.isDragging=!1,q&&q(ie))},ie.kill=ie.revert=function(){ie.disable();var ce=_observers.indexOf(ie);ce>=0&&_observers.splice(ce,1),_normalizer$1===ie&&(_normalizer$1=0)},_observers.push(ie),U&&_isViewport$1(a)&&(_normalizer$1=ie),ie.enable(f)},_createClass(n,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),n}();Observer.version="3.13.0";Observer.create=function(n){return new Observer(n)};Observer.register=_initCore;Observer.getAll=function(){return _observers.slice()};Observer.getById=function(n){return _observers.filter(function(e){return e.vars.id===n})[0]};_getGSAP$2()&&gsap$2.registerPlugin(Observer);/*!
 * ScrollTrigger 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$1,_coreInitted,_win,_doc,_docEl,_body,_root,_resizeDelay,_toArray,_clamp,_time2,_syncInterval,_refreshing,_pointerIsDown,_transformProp,_i,_prevWidth,_prevHeight,_autoRefresh,_sort,_suppressOverwrites,_ignoreResize,_normalizer,_ignoreMobileResize,_baseScreenHeight,_baseScreenWidth,_fixIOSBug,_context,_scrollRestoration,_div100vh,_100vh,_isReverted,_clampingMax,_limitCallbacks,_startup=1,_getTime=Date.now,_time1=_getTime(),_lastScrollTime=0,_enabled=0,_parseClamp=function(e,t,i){var r=_isString(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return i["_"+t+"Clamp"]=r,r?e.substr(6,e.length-7):e},_keepClamp=function(e,t){return t&&(!_isString(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},_rafBugFix=function n(){return _enabled&&requestAnimationFrame(n)},_pointerDownHandler=function(){return _pointerIsDown=1},_pointerUpHandler=function(){return _pointerIsDown=0},_passThrough=function(e){return e},_round=function(e){return Math.round(e*1e5)/1e5||0},_windowExists=function(){return typeof window<"u"},_getGSAP$1=function(){return gsap$1||_windowExists()&&(gsap$1=window.gsap)&&gsap$1.registerPlugin&&gsap$1},_isViewport=function(e){return!!~_root.indexOf(e)},_getViewportDimension=function(e){return(e==="Height"?_100vh:_win["inner"+e])||_docEl["client"+e]||_body["client"+e]},_getBoundsFunc=function(e){return _getProxyProp(e,"getBoundingClientRect")||(_isViewport(e)?function(){return _winOffsets.width=_win.innerWidth,_winOffsets.height=_100vh,_winOffsets}:function(){return _getBounds$1(e)})},_getSizeFunc=function(e,t,i){var r=i.d,s=i.d2,o=i.a;return(o=_getProxyProp(e,"getBoundingClientRect"))?function(){return o()[r]}:function(){return(t?_getViewportDimension(s):e["client"+s])||0}},_getOffsetsFunc=function(e,t){return!t||~_proxies.indexOf(e)?_getBoundsFunc(e):function(){return _winOffsets}},_maxScroll=function(e,t){var i=t.s,r=t.d2,s=t.d,o=t.a;return Math.max(0,(i="scroll"+r)&&(o=_getProxyProp(e,i))?o()-_getBoundsFunc(e)()[s]:_isViewport(e)?(_docEl[i]||_body[i])-_getViewportDimension(r):e[i]-e["offset"+r])},_iterateAutoRefresh=function(e,t){for(var i=0;i<_autoRefresh.length;i+=3)(!t||~t.indexOf(_autoRefresh[i+1]))&&e(_autoRefresh[i],_autoRefresh[i+1],_autoRefresh[i+2])},_isString=function(e){return typeof e=="string"},_isFunction=function(e){return typeof e=="function"},_isNumber=function(e){return typeof e=="number"},_isObject=function(e){return typeof e=="object"},_endAnimation=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},_callback=function(e,t){if(e.enabled){var i=e._ctx?e._ctx.add(function(){return t(e)}):t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},_abs=Math.abs,_left="left",_top="top",_right="right",_bottom="bottom",_width="width",_height="height",_Right="Right",_Left="Left",_Top="Top",_Bottom="Bottom",_padding="padding",_margin="margin",_Width="Width",_Height="Height",_px="px",_getComputedStyle=function(e){return _win.getComputedStyle(e)},_makePositionable=function(e){var t=_getComputedStyle(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},_setDefaults=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_getBounds$1=function(e,t){var i=t&&_getComputedStyle(e)[_transformProp]!=="matrix(1, 0, 0, 1, 0, 0)"&&gsap$1.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),r=e.getBoundingClientRect();return i&&i.progress(0).kill(),r},_getSize=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},_getLabelRatioArray=function(e){var t=[],i=e.labels,r=e.duration(),s;for(s in i)t.push(i[s]/r);return t},_getClosestLabel=function(e){return function(t){return gsap$1.utils.snap(_getLabelRatioArray(e),t)}},_snapDirectional=function(e){var t=gsap$1.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort(function(r,s){return r-s});return i?function(r,s,o){o===void 0&&(o=.001);var a;if(!s)return t(r);if(s>0){for(r-=o,a=0;a<i.length;a++)if(i[a]>=r)return i[a];return i[a-1]}else for(a=i.length,r+=o;a--;)if(i[a]<=r)return i[a];return i[0]}:function(r,s,o){o===void 0&&(o=.001);var a=t(r);return!s||Math.abs(a-r)<o||a-r<0==s<0?a:t(s<0?r-e:r+e)}},_getLabelAtDirection=function(e){return function(t,i){return _snapDirectional(_getLabelRatioArray(e))(t,i.direction)}},_multiListener=function(e,t,i,r){return i.split(",").forEach(function(s){return e(t,s,r)})},_addListener=function(e,t,i,r,s){return e.addEventListener(t,i,{passive:!r,capture:!!s})},_removeListener=function(e,t,i,r){return e.removeEventListener(t,i,!!r)},_wheelListener=function(e,t,i){i=i&&i.wheelHandler,i&&(e(t,"wheel",i),e(t,"touchmove",i))},_markerDefaults={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},_defaults={toggleActions:"play",anticipatePin:0},_keywords={top:0,left:0,center:.5,bottom:1,right:1},_offsetToPx=function(e,t){if(_isString(e)){var i=e.indexOf("="),r=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(r*=t/100),e=e.substr(0,i-1)),e=r+(e in _keywords?_keywords[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},_createMarker=function(e,t,i,r,s,o,a,h){var d=s.startColor,u=s.endColor,m=s.fontSize,v=s.indent,_=s.fontWeight,D=_doc.createElement("div"),f=_isViewport(i)||_getProxyProp(i,"pinType")==="fixed",l=e.indexOf("scroller")!==-1,c=f?_body:i,p=e.indexOf("start")!==-1,b=p?d:u,E="border-color:"+b+";font-size:"+m+";color:"+b+";font-weight:"+_+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return E+="position:"+((l||h)&&f?"fixed;":"absolute;"),(l||h||!f)&&(E+=(r===_vertical?_right:_bottom)+":"+(o+parseFloat(v))+"px;"),a&&(E+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),D._isStart=p,D.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),D.style.cssText=E,D.innerText=t||t===0?e+"-"+t:e,c.children[0]?c.insertBefore(D,c.children[0]):c.appendChild(D),D._offset=D["offset"+r.op.d2],_positionMarker(D,0,r,p),D},_positionMarker=function(e,t,i,r){var s={display:"block"},o=i[r?"os2":"p2"],a=i[r?"p2":"os2"];e._isFlipped=r,s[i.a+"Percent"]=r?-100:0,s[i.a]=r?"1px":0,s["border"+o+_Width]=1,s["border"+a+_Width]=0,s[i.p]=t+"px",gsap$1.set(e,s)},_triggers=[],_ids={},_rafID,_sync=function(){return _getTime()-_lastScrollTime>34&&(_rafID||(_rafID=requestAnimationFrame(_updateAll)))},_onScroll=function(){(!_normalizer||!_normalizer.isPressed||_normalizer.startX>_body.clientWidth)&&(_scrollers.cache++,_normalizer?_rafID||(_rafID=requestAnimationFrame(_updateAll)):_updateAll(),_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime())},_setBaseDimensions=function(){_baseScreenWidth=_win.innerWidth,_baseScreenHeight=_win.innerHeight},_onResize=function(e){_scrollers.cache++,(e===!0||!_refreshing&&!_ignoreResize&&!_doc.fullscreenElement&&!_doc.webkitFullscreenElement&&(!_ignoreMobileResize||_baseScreenWidth!==_win.innerWidth||Math.abs(_win.innerHeight-_baseScreenHeight)>_win.innerHeight*.25))&&_resizeDelay.restart(!0)},_listeners={},_emptyArray=[],_softRefresh=function n(){return _removeListener(ScrollTrigger,"scrollEnd",n)||_refreshAll(!0)},_dispatch=function(e){return _listeners[e]&&_listeners[e].map(function(t){return t()})||_emptyArray},_savedStyles=[],_revertRecorded=function(e){for(var t=0;t<_savedStyles.length;t+=5)(!e||_savedStyles[t+4]&&_savedStyles[t+4].query===e)&&(_savedStyles[t].style.cssText=_savedStyles[t+1],_savedStyles[t].getBBox&&_savedStyles[t].setAttribute("transform",_savedStyles[t+2]||""),_savedStyles[t+3].uncache=1)},_revertAll=function(e,t){var i;for(_i=0;_i<_triggers.length;_i++)i=_triggers[_i],i&&(!t||i._ctx===t)&&(e?i.kill(1):i.revert(!0,!0));_isReverted=!0,t&&_revertRecorded(t),t||_dispatch("revert")},_clearScrollMemory=function(e,t){_scrollers.cache++,(t||!_refreshingAll)&&_scrollers.forEach(function(i){return _isFunction(i)&&i.cacheID++&&(i.rec=0)}),_isString(e)&&(_win.history.scrollRestoration=_scrollRestoration=e)},_refreshingAll,_refreshID=0,_queueRefreshID,_queueRefreshAll=function(){if(_queueRefreshID!==_refreshID){var e=_queueRefreshID=_refreshID;requestAnimationFrame(function(){return e===_refreshID&&_refreshAll(!0)})}},_refresh100vh=function(){_body.appendChild(_div100vh),_100vh=!_normalizer&&_div100vh.offsetHeight||_win.innerHeight,_body.removeChild(_div100vh)},_hideAllMarkers=function(e){return _toArray(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},_refreshAll=function(e,t){if(_docEl=_doc.documentElement,_body=_doc.body,_root=[_win,_doc,_docEl,_body],_lastScrollTime&&!e&&!_isReverted){_addListener(ScrollTrigger,"scrollEnd",_softRefresh);return}_refresh100vh(),_refreshingAll=ScrollTrigger.isRefreshing=!0,_scrollers.forEach(function(r){return _isFunction(r)&&++r.cacheID&&(r.rec=r())});var i=_dispatch("refreshInit");_sort&&ScrollTrigger.sort(),t||_revertAll(),_scrollers.forEach(function(r){_isFunction(r)&&(r.smooth&&(r.target.style.scrollBehavior="auto"),r(0))}),_triggers.slice(0).forEach(function(r){return r.refresh()}),_isReverted=!1,_triggers.forEach(function(r){if(r._subPinOffset&&r.pin){var s=r.vars.horizontal?"offsetWidth":"offsetHeight",o=r.pin[s];r.revert(!0,1),r.adjustPinSpacing(r.pin[s]-o),r.refresh()}}),_clampingMax=1,_hideAllMarkers(!0),_triggers.forEach(function(r){var s=_maxScroll(r.scroller,r._dir),o=r.vars.end==="max"||r._endClamp&&r.end>s,a=r._startClamp&&r.start>=s;(o||a)&&r.setPositions(a?s-1:r.start,o?Math.max(a?s:r.start+1,s):r.end,!0)}),_hideAllMarkers(!1),_clampingMax=0,i.forEach(function(r){return r&&r.render&&r.render(-1)}),_scrollers.forEach(function(r){_isFunction(r)&&(r.smooth&&requestAnimationFrame(function(){return r.target.style.scrollBehavior="smooth"}),r.rec&&r(r.rec))}),_clearScrollMemory(_scrollRestoration,1),_resizeDelay.pause(),_refreshID++,_refreshingAll=2,_updateAll(2),_triggers.forEach(function(r){return _isFunction(r.vars.onRefresh)&&r.vars.onRefresh(r)}),_refreshingAll=ScrollTrigger.isRefreshing=!1,_dispatch("refresh")},_lastScroll=0,_direction=1,_primary,_updateAll=function(e){if(e===2||!_refreshingAll&&!_isReverted){ScrollTrigger.isUpdating=!0,_primary&&_primary.update(0);var t=_triggers.length,i=_getTime(),r=i-_time1>=50,s=t&&_triggers[0].scroll();if(_direction=_lastScroll>s?-1:1,_refreshingAll||(_lastScroll=s),r&&(_lastScrollTime&&!_pointerIsDown&&i-_lastScrollTime>200&&(_lastScrollTime=0,_dispatch("scrollEnd")),_time2=_time1,_time1=i),_direction<0){for(_i=t;_i-- >0;)_triggers[_i]&&_triggers[_i].update(0,r);_direction=1}else for(_i=0;_i<t;_i++)_triggers[_i]&&_triggers[_i].update(0,r);ScrollTrigger.isUpdating=!1}_rafID=0},_propNamesToCopy=[_left,_top,_bottom,_right,_margin+_Bottom,_margin+_Right,_margin+_Top,_margin+_Left,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],_stateProps=_propNamesToCopy.concat([_width,_height,"boxSizing","max"+_Width,"max"+_Height,"position",_margin,_padding,_padding+_Top,_padding+_Right,_padding+_Bottom,_padding+_Left]),_swapPinOut=function(e,t,i){_setState(i);var r=e._gsap;if(r.spacerIsNative)_setState(r.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},_swapPinIn=function(e,t,i,r){if(!e._gsap.swappedIn){for(var s=_propNamesToCopy.length,o=t.style,a=e.style,h;s--;)h=_propNamesToCopy[s],o[h]=i[h];o.position=i.position==="absolute"?"absolute":"relative",i.display==="inline"&&(o.display="inline-block"),a[_bottom]=a[_right]="auto",o.flexBasis=i.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[_width]=_getSize(e,_horizontal)+_px,o[_height]=_getSize(e,_vertical)+_px,o[_padding]=a[_margin]=a[_top]=a[_left]="0",_setState(r),a[_width]=a["max"+_Width]=i[_width],a[_height]=a["max"+_Height]=i[_height],a[_padding]=i[_padding],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},_capsExp=/([A-Z])/g,_setState=function(e){if(e){var t=e.t.style,i=e.length,r=0,s,o;for((e.t._gsap||gsap$1.core.getCache(e.t)).uncache=1;r<i;r+=2)o=e[r+1],s=e[r],o?t[s]=o:t[s]&&t.removeProperty(s.replace(_capsExp,"-$1").toLowerCase())}},_getState=function(e){for(var t=_stateProps.length,i=e.style,r=[],s=0;s<t;s++)r.push(_stateProps[s],i[_stateProps[s]]);return r.t=e,r},_copyState=function(e,t,i){for(var r=[],s=e.length,o=i?8:0,a;o<s;o+=2)a=e[o],r.push(a,a in t?t[a]:e[o+1]);return r.t=e.t,r},_winOffsets={left:0,top:0},_parsePosition=function(e,t,i,r,s,o,a,h,d,u,m,v,_,D){_isFunction(e)&&(e=e(h)),_isString(e)&&e.substr(0,3)==="max"&&(e=v+(e.charAt(4)==="="?_offsetToPx("0"+e.substr(3),i):0));var f=_?_.time():0,l,c,p;if(_&&_.seek(0),isNaN(e)||(e=+e),_isNumber(e))_&&(e=gsap$1.utils.mapRange(_.scrollTrigger.start,_.scrollTrigger.end,0,v,e)),a&&_positionMarker(a,i,r,!0);else{_isFunction(t)&&(t=t(h));var b=(e||"0").split(" "),E,C,g,x;p=_getTarget$1(t,h)||_body,E=_getBounds$1(p)||{},(!E||!E.left&&!E.top)&&_getComputedStyle(p).display==="none"&&(x=p.style.display,p.style.display="block",E=_getBounds$1(p),x?p.style.display=x:p.style.removeProperty("display")),C=_offsetToPx(b[0],E[r.d]),g=_offsetToPx(b[1]||"0",i),e=E[r.p]-d[r.p]-u+C+s-g,a&&_positionMarker(a,g,r,i-g<20||a._isStart&&g>20),i-=i-g}if(D&&(h[D]=e||-.001,e<0&&(e=0)),o){var y=e+i,w=o._isStart;l="scroll"+r.d2,_positionMarker(o,y,r,w&&y>20||!w&&(m?Math.max(_body[l],_docEl[l]):o.parentNode[l])<=y+1),m&&(d=_getBounds$1(a),m&&(o.style[r.op.p]=d[r.op.p]-r.op.m-o._offset+_px))}return _&&p&&(l=_getBounds$1(p),_.seek(v),c=_getBounds$1(p),_._caScrollDist=l[r.p]-c[r.p],e=e/_._caScrollDist*v),_&&_.seek(f),_?e:Math.round(e)},_prefixExp=/(webkit|moz|length|cssText|inset)/i,_reparent=function(e,t,i,r){if(e.parentNode!==t){var s=e.style,o,a;if(t===_body){e._stOrig=s.cssText,a=_getComputedStyle(e);for(o in a)!+o&&!_prefixExp.test(o)&&a[o]&&typeof s[o]=="string"&&o!=="0"&&(s[o]=a[o]);s.top=i,s.left=r}else s.cssText=e._stOrig;gsap$1.core.getCache(e).uncache=1,t.appendChild(e)}},_interruptionTracker=function(e,t,i){var r=t,s=r;return function(o){var a=Math.round(e());return a!==r&&a!==s&&Math.abs(a-r)>3&&Math.abs(a-s)>3&&(o=a,i&&i()),s=r,r=Math.round(o),r}},_shiftMarker=function(e,t,i){var r={};r[t.p]="+="+i,gsap$1.set(e,r)},_getTweenCreator=function(e,t){var i=_getScrollFunc(e,t),r="_scroll"+t.p2,s=function o(a,h,d,u,m){var v=o.tween,_=h.onComplete,D={};d=d||i();var f=_interruptionTracker(i,d,function(){v.kill(),o.tween=0});return m=u&&m||0,u=u||a-d,v&&v.kill(),h[r]=a,h.inherit=!1,h.modifiers=D,D[r]=function(){return f(d+u*v.ratio+m*v.ratio*v.ratio)},h.onUpdate=function(){_scrollers.cache++,o.tween&&_updateAll()},h.onComplete=function(){o.tween=0,_&&_.call(v)},v=o.tween=gsap$1.to(e,h),v};return e[r]=i,i.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},_addListener(e,"wheel",i.wheelHandler),ScrollTrigger.isTouch&&_addListener(e,"touchmove",i.wheelHandler),s},ScrollTrigger=function(){function n(t,i){_coreInitted||n.register(gsap$1)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),_context(this),this.init(t,i)}var e=n.prototype;return e.init=function(i,r){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!_enabled){this.update=this.refresh=this.kill=_passThrough;return}i=_setDefaults(_isString(i)||_isNumber(i)||i.nodeType?{trigger:i}:i,_defaults);var s=i,o=s.onUpdate,a=s.toggleClass,h=s.id,d=s.onToggle,u=s.onRefresh,m=s.scrub,v=s.trigger,_=s.pin,D=s.pinSpacing,f=s.invalidateOnRefresh,l=s.anticipatePin,c=s.onScrubComplete,p=s.onSnapComplete,b=s.once,E=s.snap,C=s.pinReparent,g=s.pinSpacer,x=s.containerAnimation,y=s.fastScrollEnd,w=s.preventOverlaps,M=i.horizontal||i.containerAnimation&&i.horizontal!==!1?_horizontal:_vertical,S=!m&&m!==0,O=_getTarget$1(i.scroller||_win),P=gsap$1.core.getCache(O),I=_isViewport(O),F=("pinType"in i?i.pinType:_getProxyProp(O,"pinType")||I&&"fixed")==="fixed",k=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],B=S&&i.toggleActions.split(" "),U="markers"in i?i.markers:_defaults.markers,W=I?0:parseFloat(_getComputedStyle(O)["border"+M.p2+_Width])||0,R=this,z=i.onRefreshInit&&function(){return i.onRefreshInit(R)},G=_getSizeFunc(O,I,M),q=_getOffsetsFunc(O,I),Q=0,ne=0,te=0,oe=_getScrollFunc(O,M),re,le,Ce,De,Oe,_e,Z,xe,we,ie,Ne,Ge,Ue,Ie,ze,Re,Le,We,He,H,K,X,pe,ue,ye,Se,V,he,ve,Pe,ae,me,j,Te,Be,L,ge,de,$;if(R._startClamp=R._endClamp=!1,R._dir=M,l*=45,R.scroller=O,R.scroll=x?x.time.bind(x):oe,De=oe(),R.vars=i,r=r||i.animation,"refreshPriority"in i&&(_sort=1,i.refreshPriority===-9999&&(_primary=R)),P.tweenScroll=P.tweenScroll||{top:_getTweenCreator(O,_vertical),left:_getTweenCreator(O,_horizontal)},R.tweenTo=re=P.tweenScroll[M.p],R.scrubDuration=function(Ee){j=_isNumber(Ee)&&Ee,j?me?me.duration(Ee):me=gsap$1.to(r,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:j,paused:!0,onComplete:function(){return c&&c(R)}}):(me&&me.progress(1).kill(),me=0)},r&&(r.vars.lazy=!1,r._initted&&!R.isReverted||r.vars.immediateRender!==!1&&i.immediateRender!==!1&&r.duration()&&r.render(0,!0,!0),R.animation=r.pause(),r.scrollTrigger=R,R.scrubDuration(m),Pe=0,h||(h=r.vars.id)),E&&((!_isObject(E)||E.push)&&(E={snapTo:E}),"scrollBehavior"in _body.style&&gsap$1.set(I?[_body,_docEl]:O,{scrollBehavior:"auto"}),_scrollers.forEach(function(Ee){return _isFunction(Ee)&&Ee.target===(I?_doc.scrollingElement||_docEl:O)&&(Ee.smooth=!1)}),Ce=_isFunction(E.snapTo)?E.snapTo:E.snapTo==="labels"?_getClosestLabel(r):E.snapTo==="labelsDirectional"?_getLabelAtDirection(r):E.directional!==!1?function(Ee,$e){return _snapDirectional(E.snapTo)(Ee,_getTime()-ne<500?0:$e.direction)}:gsap$1.utils.snap(E.snapTo),Te=E.duration||{min:.1,max:2},Te=_isObject(Te)?_clamp(Te.min,Te.max):_clamp(Te,Te),Be=gsap$1.delayedCall(E.delay||j/2||.1,function(){var Ee=oe(),$e=_getTime()-ne<500,Xe=re.tween;if(($e||Math.abs(R.getVelocity())<10)&&!Xe&&!_pointerIsDown&&Q!==Ee){var Ke=(Ee-_e)/Ie,Je=r&&!S?r.totalProgress():Ke,Ye=$e?0:(Je-ae)/(_getTime()-_time2)*1e3||0,nt=gsap$1.utils.clamp(-Ke,1-Ke,_abs(Ye/2)*Ye/.185),st=Ke+(E.inertia===!1?0:nt),_t,ut,et=E,ht=et.onStart,tt=et.onInterrupt,bt=et.onComplete;if(_t=Ce(st,R),_isNumber(_t)||(_t=st),ut=Math.max(0,Math.round(_e+_t*Ie)),Ee<=Z&&Ee>=_e&&ut!==Ee){if(Xe&&!Xe._initted&&Xe.data<=_abs(ut-Ee))return;E.inertia===!1&&(nt=_t-Ke),re(ut,{duration:Te(_abs(Math.max(_abs(st-Je),_abs(_t-Je))*.185/Ye/.05||0)),ease:E.ease||"power3",data:_abs(ut-Ee),onInterrupt:function(){return Be.restart(!0)&&tt&&tt(R)},onComplete:function(){R.update(),Q=oe(),r&&!S&&(me?me.resetTo("totalProgress",_t,r._tTime/r._tDur):r.progress(_t)),Pe=ae=r&&!S?r.totalProgress():R.progress,p&&p(R),bt&&bt(R)}},Ee,nt*Ie,ut-Ee-nt*Ie),ht&&ht(R,re.tween)}}else R.isActive&&Q!==Ee&&Be.restart(!0)}).pause()),h&&(_ids[h]=R),v=R.trigger=_getTarget$1(v||_!==!0&&_),$=v&&v._gsap&&v._gsap.stRevert,$&&($=$(R)),_=_===!0?v:_getTarget$1(_),_isString(a)&&(a={targets:v,className:a}),_&&(D===!1||D===_margin||(D=!D&&_.parentNode&&_.parentNode.style&&_getComputedStyle(_.parentNode).display==="flex"?!1:_padding),R.pin=_,le=gsap$1.core.getCache(_),le.spacer?ze=le.pinState:(g&&(g=_getTarget$1(g),g&&!g.nodeType&&(g=g.current||g.nativeElement),le.spacerIsNative=!!g,g&&(le.spacerState=_getState(g))),le.spacer=We=g||_doc.createElement("div"),We.classList.add("pin-spacer"),h&&We.classList.add("pin-spacer-"+h),le.pinState=ze=_getState(_)),i.force3D!==!1&&gsap$1.set(_,{force3D:!0}),R.spacer=We=le.spacer,ve=_getComputedStyle(_),ue=ve[D+M.os2],H=gsap$1.getProperty(_),K=gsap$1.quickSetter(_,M.a,_px),_swapPinIn(_,We,ve),Le=_getState(_)),U){Ge=_isObject(U)?_setDefaults(U,_markerDefaults):_markerDefaults,ie=_createMarker("scroller-start",h,O,M,Ge,0),Ne=_createMarker("scroller-end",h,O,M,Ge,0,ie),He=ie["offset"+M.op.d2];var se=_getTarget$1(_getProxyProp(O,"content")||O);xe=this.markerStart=_createMarker("start",h,se,M,Ge,He,0,x),we=this.markerEnd=_createMarker("end",h,se,M,Ge,He,0,x),x&&(de=gsap$1.quickSetter([xe,we],M.a,_px)),!F&&!(_proxies.length&&_getProxyProp(O,"fixedMarkers")===!0)&&(_makePositionable(I?_body:O),gsap$1.set([ie,Ne],{force3D:!0}),Se=gsap$1.quickSetter(ie,M.a,_px),he=gsap$1.quickSetter(Ne,M.a,_px))}if(x){var ce=x.vars.onUpdate,Fe=x.vars.onUpdateParams;x.eventCallback("onUpdate",function(){R.update(0,0,1),ce&&ce.apply(x,Fe||[])})}if(R.previous=function(){return _triggers[_triggers.indexOf(R)-1]},R.next=function(){return _triggers[_triggers.indexOf(R)+1]},R.revert=function(Ee,$e){if(!$e)return R.kill(!0);var Xe=Ee!==!1||!R.enabled,Ke=_refreshing;Xe!==R.isReverted&&(Xe&&(L=Math.max(oe(),R.scroll.rec||0),te=R.progress,ge=r&&r.progress()),xe&&[xe,we,ie,Ne].forEach(function(Je){return Je.style.display=Xe?"none":"block"}),Xe&&(_refreshing=R,R.update(Xe)),_&&(!C||!R.isActive)&&(Xe?_swapPinOut(_,We,ze):_swapPinIn(_,We,_getComputedStyle(_),ye)),Xe||R.update(Xe),_refreshing=Ke,R.isReverted=Xe)},R.refresh=function(Ee,$e,Xe,Ke){if(!((_refreshing||!R.enabled)&&!$e)){if(_&&Ee&&_lastScrollTime){_addListener(n,"scrollEnd",_softRefresh);return}!_refreshingAll&&z&&z(R),_refreshing=R,re.tween&&!Xe&&(re.tween.kill(),re.tween=0),me&&me.pause(),f&&r&&(r.revert({kill:!1}).invalidate(),r.getChildren&&r.getChildren(!0,!0,!1).forEach(function(Pt){return Pt.vars.immediateRender&&Pt.render(0,!0,!0)})),R.isReverted||R.revert(!0,!0),R._subPinOffset=!1;var Je=G(),Ye=q(),nt=x?x.duration():_maxScroll(O,M),st=Ie<=.01||!Ie,_t=0,ut=Ke||0,et=_isObject(Xe)?Xe.end:i.end,ht=i.endTrigger||v,tt=_isObject(Xe)?Xe.start:i.start||(i.start===0||!v?0:_?"0 0":"0 100%"),bt=R.pinnedContainer=i.pinnedContainer&&_getTarget$1(i.pinnedContainer,R),Dt=v&&Math.max(0,_triggers.indexOf(R))||0,Et=Dt,St,Ct,zt,Nt,Tt,wt,Lt,$t,xi,Kt,Bt,Yt,ot;for(U&&_isObject(Xe)&&(Yt=gsap$1.getProperty(ie,M.p),ot=gsap$1.getProperty(Ne,M.p));Et-- >0;)wt=_triggers[Et],wt.end||wt.refresh(0,1)||(_refreshing=R),Lt=wt.pin,Lt&&(Lt===v||Lt===_||Lt===bt)&&!wt.isReverted&&(Kt||(Kt=[]),Kt.unshift(wt),wt.revert(!0,!0)),wt!==_triggers[Et]&&(Dt--,Et--);for(_isFunction(tt)&&(tt=tt(R)),tt=_parseClamp(tt,"start",R),_e=_parsePosition(tt,v,Je,M,oe(),xe,ie,R,Ye,W,F,nt,x,R._startClamp&&"_startClamp")||(_?-.001:0),_isFunction(et)&&(et=et(R)),_isString(et)&&!et.indexOf("+=")&&(~et.indexOf(" ")?et=(_isString(tt)?tt.split(" ")[0]:"")+et:(_t=_offsetToPx(et.substr(2),Je),et=_isString(tt)?tt:(x?gsap$1.utils.mapRange(0,x.duration(),x.scrollTrigger.start,x.scrollTrigger.end,_e):_e)+_t,ht=v)),et=_parseClamp(et,"end",R),Z=Math.max(_e,_parsePosition(et||(ht?"100% 0":nt),ht,Je,M,oe()+_t,we,Ne,R,Ye,W,F,nt,x,R._endClamp&&"_endClamp"))||-.001,_t=0,Et=Dt;Et--;)wt=_triggers[Et],Lt=wt.pin,Lt&&wt.start-wt._pinPush<=_e&&!x&&wt.end>0&&(St=wt.end-(R._startClamp?Math.max(0,wt.start):wt.start),(Lt===v&&wt.start-wt._pinPush<_e||Lt===bt)&&isNaN(tt)&&(_t+=St*(1-wt.progress)),Lt===_&&(ut+=St));if(_e+=_t,Z+=_t,R._startClamp&&(R._startClamp+=_t),R._endClamp&&!_refreshingAll&&(R._endClamp=Z||-.001,Z=Math.min(Z,_maxScroll(O,M))),Ie=Z-_e||(_e-=.01)&&.001,st&&(te=gsap$1.utils.clamp(0,1,gsap$1.utils.normalize(_e,Z,L))),R._pinPush=ut,xe&&_t&&(St={},St[M.a]="+="+_t,bt&&(St[M.p]="-="+oe()),gsap$1.set([xe,we],St)),_&&!(_clampingMax&&R.end>=_maxScroll(O,M)))St=_getComputedStyle(_),Nt=M===_vertical,zt=oe(),X=parseFloat(H(M.a))+ut,!nt&&Z>1&&(Bt=(I?_doc.scrollingElement||_docEl:O).style,Bt={style:Bt,value:Bt["overflow"+M.a.toUpperCase()]},I&&_getComputedStyle(_body)["overflow"+M.a.toUpperCase()]!=="scroll"&&(Bt.style["overflow"+M.a.toUpperCase()]="scroll")),_swapPinIn(_,We,St),Le=_getState(_),Ct=_getBounds$1(_,!0),$t=F&&_getScrollFunc(O,Nt?_horizontal:_vertical)(),D?(ye=[D+M.os2,Ie+ut+_px],ye.t=We,Et=D===_padding?_getSize(_,M)+Ie+ut:0,Et&&(ye.push(M.d,Et+_px),We.style.flexBasis!=="auto"&&(We.style.flexBasis=Et+_px)),_setState(ye),bt&&_triggers.forEach(function(Pt){Pt.pin===bt&&Pt.vars.pinSpacing!==!1&&(Pt._subPinOffset=!0)}),F&&oe(L)):(Et=_getSize(_,M),Et&&We.style.flexBasis!=="auto"&&(We.style.flexBasis=Et+_px)),F&&(Tt={top:Ct.top+(Nt?zt-_e:$t)+_px,left:Ct.left+(Nt?$t:zt-_e)+_px,boxSizing:"border-box",position:"fixed"},Tt[_width]=Tt["max"+_Width]=Math.ceil(Ct.width)+_px,Tt[_height]=Tt["max"+_Height]=Math.ceil(Ct.height)+_px,Tt[_margin]=Tt[_margin+_Top]=Tt[_margin+_Right]=Tt[_margin+_Bottom]=Tt[_margin+_Left]="0",Tt[_padding]=St[_padding],Tt[_padding+_Top]=St[_padding+_Top],Tt[_padding+_Right]=St[_padding+_Right],Tt[_padding+_Bottom]=St[_padding+_Bottom],Tt[_padding+_Left]=St[_padding+_Left],Re=_copyState(ze,Tt,C),_refreshingAll&&oe(0)),r?(xi=r._initted,_suppressOverwrites(1),r.render(r.duration(),!0,!0),pe=H(M.a)-X+Ie+ut,V=Math.abs(Ie-pe)>1,F&&V&&Re.splice(Re.length-2,2),r.render(0,!0,!0),xi||r.invalidate(!0),r.parent||r.totalTime(r.totalTime()),_suppressOverwrites(0)):pe=Ie,Bt&&(Bt.value?Bt.style["overflow"+M.a.toUpperCase()]=Bt.value:Bt.style.removeProperty("overflow-"+M.a));else if(v&&oe()&&!x)for(Ct=v.parentNode;Ct&&Ct!==_body;)Ct._pinOffset&&(_e-=Ct._pinOffset,Z-=Ct._pinOffset),Ct=Ct.parentNode;Kt&&Kt.forEach(function(Pt){return Pt.revert(!1,!0)}),R.start=_e,R.end=Z,De=Oe=_refreshingAll?L:oe(),!x&&!_refreshingAll&&(De<L&&oe(L),R.scroll.rec=0),R.revert(!1,!0),ne=_getTime(),Be&&(Q=-1,Be.restart(!0)),_refreshing=0,r&&S&&(r._initted||ge)&&r.progress()!==ge&&r.progress(ge||0,!0).render(r.time(),!0,!0),(st||te!==R.progress||x||f||r&&!r._initted)&&(r&&!S&&(r._initted||te||r.vars.immediateRender!==!1)&&r.totalProgress(x&&_e<-.001&&!te?gsap$1.utils.normalize(_e,Z,0):te,!0),R.progress=st||(De-_e)/Ie===te?0:te),_&&D&&(We._pinOffset=Math.round(R.progress*pe)),me&&me.invalidate(),isNaN(Yt)||(Yt-=gsap$1.getProperty(ie,M.p),ot-=gsap$1.getProperty(Ne,M.p),_shiftMarker(ie,M,Yt),_shiftMarker(xe,M,Yt-(Ke||0)),_shiftMarker(Ne,M,ot),_shiftMarker(we,M,ot-(Ke||0))),st&&!_refreshingAll&&R.update(),u&&!_refreshingAll&&!Ue&&(Ue=!0,u(R),Ue=!1)}},R.getVelocity=function(){return(oe()-Oe)/(_getTime()-_time2)*1e3||0},R.endAnimation=function(){_endAnimation(R.callbackAnimation),r&&(me?me.progress(1):r.paused()?S||_endAnimation(r,R.direction<0,1):_endAnimation(r,r.reversed()))},R.labelToScroll=function(Ee){return r&&r.labels&&(_e||R.refresh()||_e)+r.labels[Ee]/r.duration()*Ie||0},R.getTrailing=function(Ee){var $e=_triggers.indexOf(R),Xe=R.direction>0?_triggers.slice(0,$e).reverse():_triggers.slice($e+1);return(_isString(Ee)?Xe.filter(function(Ke){return Ke.vars.preventOverlaps===Ee}):Xe).filter(function(Ke){return R.direction>0?Ke.end<=_e:Ke.start>=Z})},R.update=function(Ee,$e,Xe){if(!(x&&!Xe&&!Ee)){var Ke=_refreshingAll===!0?L:R.scroll(),Je=Ee?0:(Ke-_e)/Ie,Ye=Je<0?0:Je>1?1:Je||0,nt=R.progress,st,_t,ut,et,ht,tt,bt,Dt;if($e&&(Oe=De,De=x?oe():Ke,E&&(ae=Pe,Pe=r&&!S?r.totalProgress():Ye)),l&&_&&!_refreshing&&!_startup&&_lastScrollTime&&(!Ye&&_e<Ke+(Ke-Oe)/(_getTime()-_time2)*l?Ye=1e-4:Ye===1&&Z>Ke+(Ke-Oe)/(_getTime()-_time2)*l&&(Ye=.9999)),Ye!==nt&&R.enabled){if(st=R.isActive=!!Ye&&Ye<1,_t=!!nt&&nt<1,tt=st!==_t,ht=tt||!!Ye!=!!nt,R.direction=Ye>nt?1:-1,R.progress=Ye,ht&&!_refreshing&&(ut=Ye&&!nt?0:Ye===1?1:nt===1?2:3,S&&(et=!tt&&B[ut+1]!=="none"&&B[ut+1]||B[ut],Dt=r&&(et==="complete"||et==="reset"||et in r))),w&&(tt||Dt)&&(Dt||m||!r)&&(_isFunction(w)?w(R):R.getTrailing(w).forEach(function(zt){return zt.endAnimation()})),S||(me&&!_refreshing&&!_startup?(me._dp._time-me._start!==me._time&&me.render(me._dp._time-me._start),me.resetTo?me.resetTo("totalProgress",Ye,r._tTime/r._tDur):(me.vars.totalProgress=Ye,me.invalidate().restart())):r&&r.totalProgress(Ye,!!(_refreshing&&(ne||Ee)))),_){if(Ee&&D&&(We.style[D+M.os2]=ue),!F)K(_round(X+pe*Ye));else if(ht){if(bt=!Ee&&Ye>nt&&Z+1>Ke&&Ke+1>=_maxScroll(O,M),C)if(!Ee&&(st||bt)){var Et=_getBounds$1(_,!0),St=Ke-_e;_reparent(_,_body,Et.top+(M===_vertical?St:0)+_px,Et.left+(M===_vertical?0:St)+_px)}else _reparent(_,We);_setState(st||bt?Re:Le),V&&Ye<1&&st||K(X+(Ye===1&&!bt?pe:0))}}E&&!re.tween&&!_refreshing&&!_startup&&Be.restart(!0),a&&(tt||b&&Ye&&(Ye<1||!_limitCallbacks))&&_toArray(a.targets).forEach(function(zt){return zt.classList[st||b?"add":"remove"](a.className)}),o&&!S&&!Ee&&o(R),ht&&!_refreshing?(S&&(Dt&&(et==="complete"?r.pause().totalProgress(1):et==="reset"?r.restart(!0).pause():et==="restart"?r.restart(!0):r[et]()),o&&o(R)),(tt||!_limitCallbacks)&&(d&&tt&&_callback(R,d),k[ut]&&_callback(R,k[ut]),b&&(Ye===1?R.kill(!1,1):k[ut]=0),tt||(ut=Ye===1?1:3,k[ut]&&_callback(R,k[ut]))),y&&!st&&Math.abs(R.getVelocity())>(_isNumber(y)?y:2500)&&(_endAnimation(R.callbackAnimation),me?me.progress(1):_endAnimation(r,et==="reverse"?1:!Ye,1))):S&&o&&!_refreshing&&o(R)}if(he){var Ct=x?Ke/x.duration()*(x._caScrollDist||0):Ke;Se(Ct+(ie._isFlipped?1:0)),he(Ct)}de&&de(-Ke/x.duration()*(x._caScrollDist||0))}},R.enable=function(Ee,$e){R.enabled||(R.enabled=!0,_addListener(O,"resize",_onResize),I||_addListener(O,"scroll",_onScroll),z&&_addListener(n,"refreshInit",z),Ee!==!1&&(R.progress=te=0,De=Oe=Q=oe()),$e!==!1&&R.refresh())},R.getTween=function(Ee){return Ee&&re?re.tween:me},R.setPositions=function(Ee,$e,Xe,Ke){if(x){var Je=x.scrollTrigger,Ye=x.duration(),nt=Je.end-Je.start;Ee=Je.start+nt*Ee/Ye,$e=Je.start+nt*$e/Ye}R.refresh(!1,!1,{start:_keepClamp(Ee,Xe&&!!R._startClamp),end:_keepClamp($e,Xe&&!!R._endClamp)},Ke),R.update()},R.adjustPinSpacing=function(Ee){if(ye&&Ee){var $e=ye.indexOf(M.d)+1;ye[$e]=parseFloat(ye[$e])+Ee+_px,ye[1]=parseFloat(ye[1])+Ee+_px,_setState(ye)}},R.disable=function(Ee,$e){if(R.enabled&&(Ee!==!1&&R.revert(!0,!0),R.enabled=R.isActive=!1,$e||me&&me.pause(),L=0,le&&(le.uncache=1),z&&_removeListener(n,"refreshInit",z),Be&&(Be.pause(),re.tween&&re.tween.kill()&&(re.tween=0)),!I)){for(var Xe=_triggers.length;Xe--;)if(_triggers[Xe].scroller===O&&_triggers[Xe]!==R)return;_removeListener(O,"resize",_onResize),I||_removeListener(O,"scroll",_onScroll)}},R.kill=function(Ee,$e){R.disable(Ee,$e),me&&!$e&&me.kill(),h&&delete _ids[h];var Xe=_triggers.indexOf(R);Xe>=0&&_triggers.splice(Xe,1),Xe===_i&&_direction>0&&_i--,Xe=0,_triggers.forEach(function(Ke){return Ke.scroller===R.scroller&&(Xe=1)}),Xe||_refreshingAll||(R.scroll.rec=0),r&&(r.scrollTrigger=null,Ee&&r.revert({kill:!1}),$e||r.kill()),xe&&[xe,we,ie,Ne].forEach(function(Ke){return Ke.parentNode&&Ke.parentNode.removeChild(Ke)}),_primary===R&&(_primary=0),_&&(le&&(le.uncache=1),Xe=0,_triggers.forEach(function(Ke){return Ke.pin===_&&Xe++}),Xe||(le.spacer=0)),i.onKill&&i.onKill(R)},_triggers.push(R),R.enable(!1,!1),$&&$(R),r&&r.add&&!Ie){var ke=R.update;R.update=function(){R.update=ke,_scrollers.cache++,_e||Z||R.refresh()},gsap$1.delayedCall(.01,R.update),Ie=.01,_e=Z=0}else R.refresh();_&&_queueRefreshAll()},n.register=function(i){return _coreInitted||(gsap$1=i||_getGSAP$1(),_windowExists()&&window.document&&n.enable(),_coreInitted=_enabled),_coreInitted},n.defaults=function(i){if(i)for(var r in i)_defaults[r]=i[r];return _defaults},n.disable=function(i,r){_enabled=0,_triggers.forEach(function(o){return o[r?"kill":"disable"](i)}),_removeListener(_win,"wheel",_onScroll),_removeListener(_doc,"scroll",_onScroll),clearInterval(_syncInterval),_removeListener(_doc,"touchcancel",_passThrough),_removeListener(_body,"touchstart",_passThrough),_multiListener(_removeListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_removeListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_resizeDelay.kill(),_iterateAutoRefresh(_removeListener);for(var s=0;s<_scrollers.length;s+=3)_wheelListener(_removeListener,_scrollers[s],_scrollers[s+1]),_wheelListener(_removeListener,_scrollers[s],_scrollers[s+2])},n.enable=function(){if(_win=window,_doc=document,_docEl=_doc.documentElement,_body=_doc.body,gsap$1&&(_toArray=gsap$1.utils.toArray,_clamp=gsap$1.utils.clamp,_context=gsap$1.core.context||_passThrough,_suppressOverwrites=gsap$1.core.suppressOverwrites||_passThrough,_scrollRestoration=_win.history.scrollRestoration||"auto",_lastScroll=_win.pageYOffset||0,gsap$1.core.globals("ScrollTrigger",n),_body)){_enabled=1,_div100vh=document.createElement("div"),_div100vh.style.height="100vh",_div100vh.style.position="absolute",_refresh100vh(),_rafBugFix(),Observer.register(gsap$1),n.isTouch=Observer.isTouch,_fixIOSBug=Observer.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),_ignoreMobileResize=Observer.isTouch===1,_addListener(_win,"wheel",_onScroll),_root=[_win,_doc,_docEl,_body],gsap$1.matchMedia?(n.matchMedia=function(d){var u=gsap$1.matchMedia(),m;for(m in d)u.add(m,d[m]);return u},gsap$1.addEventListener("matchMediaInit",function(){return _revertAll()}),gsap$1.addEventListener("matchMediaRevert",function(){return _revertRecorded()}),gsap$1.addEventListener("matchMedia",function(){_refreshAll(0,1),_dispatch("matchMedia")}),gsap$1.matchMedia().add("(orientation: portrait)",function(){return _setBaseDimensions(),_setBaseDimensions})):console.warn("Requires GSAP 3.11.0 or later"),_setBaseDimensions(),_addListener(_doc,"scroll",_onScroll);var i=_body.hasAttribute("style"),r=_body.style,s=r.borderTopStyle,o=gsap$1.core.Animation.prototype,a,h;for(o.revert||Object.defineProperty(o,"revert",{value:function(){return this.time(-.01,!0)}}),r.borderTopStyle="solid",a=_getBounds$1(_body),_vertical.m=Math.round(a.top+_vertical.sc())||0,_horizontal.m=Math.round(a.left+_horizontal.sc())||0,s?r.borderTopStyle=s:r.removeProperty("border-top-style"),i||(_body.setAttribute("style",""),_body.removeAttribute("style")),_syncInterval=setInterval(_sync,250),gsap$1.delayedCall(.5,function(){return _startup=0}),_addListener(_doc,"touchcancel",_passThrough),_addListener(_body,"touchstart",_passThrough),_multiListener(_addListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_addListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_transformProp=gsap$1.utils.checkPrefix("transform"),_stateProps.push(_transformProp),_coreInitted=_getTime(),_resizeDelay=gsap$1.delayedCall(.2,_refreshAll).pause(),_autoRefresh=[_doc,"visibilitychange",function(){var d=_win.innerWidth,u=_win.innerHeight;_doc.hidden?(_prevWidth=d,_prevHeight=u):(_prevWidth!==d||_prevHeight!==u)&&_onResize()},_doc,"DOMContentLoaded",_refreshAll,_win,"load",_refreshAll,_win,"resize",_onResize],_iterateAutoRefresh(_addListener),_triggers.forEach(function(d){return d.enable(0,1)}),h=0;h<_scrollers.length;h+=3)_wheelListener(_removeListener,_scrollers[h],_scrollers[h+1]),_wheelListener(_removeListener,_scrollers[h],_scrollers[h+2])}},n.config=function(i){"limitCallbacks"in i&&(_limitCallbacks=!!i.limitCallbacks);var r=i.syncInterval;r&&clearInterval(_syncInterval)||(_syncInterval=r)&&setInterval(_sync,r),"ignoreMobileResize"in i&&(_ignoreMobileResize=n.isTouch===1&&i.ignoreMobileResize),"autoRefreshEvents"in i&&(_iterateAutoRefresh(_removeListener)||_iterateAutoRefresh(_addListener,i.autoRefreshEvents||"none"),_ignoreResize=(i.autoRefreshEvents+"").indexOf("resize")===-1)},n.scrollerProxy=function(i,r){var s=_getTarget$1(i),o=_scrollers.indexOf(s),a=_isViewport(s);~o&&_scrollers.splice(o,a?6:2),r&&(a?_proxies.unshift(_win,r,_body,r,_docEl,r):_proxies.unshift(s,r))},n.clearMatchMedia=function(i){_triggers.forEach(function(r){return r._ctx&&r._ctx.query===i&&r._ctx.kill(!0,!0)})},n.isInViewport=function(i,r,s){var o=(_isString(i)?_getTarget$1(i):i).getBoundingClientRect(),a=o[s?_width:_height]*r||0;return s?o.right-a>0&&o.left+a<_win.innerWidth:o.bottom-a>0&&o.top+a<_win.innerHeight},n.positionInViewport=function(i,r,s){_isString(i)&&(i=_getTarget$1(i));var o=i.getBoundingClientRect(),a=o[s?_width:_height],h=r==null?a/2:r in _keywords?_keywords[r]*a:~r.indexOf("%")?parseFloat(r)*a/100:parseFloat(r)||0;return s?(o.left+h)/_win.innerWidth:(o.top+h)/_win.innerHeight},n.killAll=function(i){if(_triggers.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),i!==!0){var r=_listeners.killAll||[];_listeners={},r.forEach(function(s){return s()})}},n}();ScrollTrigger.version="3.13.0";ScrollTrigger.saveStyles=function(n){return n?_toArray(n).forEach(function(e){if(e&&e.style){var t=_savedStyles.indexOf(e);t>=0&&_savedStyles.splice(t,5),_savedStyles.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),gsap$1.core.getCache(e),_context())}}):_savedStyles};ScrollTrigger.revert=function(n,e){return _revertAll(!n,e)};ScrollTrigger.create=function(n,e){return new ScrollTrigger(n,e)};ScrollTrigger.refresh=function(n){return n?_onResize(!0):(_coreInitted||ScrollTrigger.register())&&_refreshAll(!0)};ScrollTrigger.update=function(n){return++_scrollers.cache&&_updateAll(n===!0?2:0)};ScrollTrigger.clearScrollMemory=_clearScrollMemory;ScrollTrigger.maxScroll=function(n,e){return _maxScroll(n,e?_horizontal:_vertical)};ScrollTrigger.getScrollFunc=function(n,e){return _getScrollFunc(_getTarget$1(n),e?_horizontal:_vertical)};ScrollTrigger.getById=function(n){return _ids[n]};ScrollTrigger.getAll=function(){return _triggers.filter(function(n){return n.vars.id!=="ScrollSmoother"})};ScrollTrigger.isScrolling=function(){return!!_lastScrollTime};ScrollTrigger.snapDirectional=_snapDirectional;ScrollTrigger.addEventListener=function(n,e){var t=_listeners[n]||(_listeners[n]=[]);~t.indexOf(e)||t.push(e)};ScrollTrigger.removeEventListener=function(n,e){var t=_listeners[n],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};ScrollTrigger.batch=function(n,e){var t=[],i={},r=e.interval||.016,s=e.batchMax||1e9,o=function(d,u){var m=[],v=[],_=gsap$1.delayedCall(r,function(){u(m,v),m=[],v=[]}).pause();return function(D){m.length||_.restart(!0),m.push(D.trigger),v.push(D),s<=m.length&&_.progress(1)}},a;for(a in e)i[a]=a.substr(0,2)==="on"&&_isFunction(e[a])&&a!=="onRefreshInit"?o(a,e[a]):e[a];return _isFunction(s)&&(s=s(),_addListener(ScrollTrigger,"refresh",function(){return s=e.batchMax()})),_toArray(n).forEach(function(h){var d={};for(a in i)d[a]=i[a];d.trigger=h,t.push(ScrollTrigger.create(d))}),t};var _clampScrollAndGetDurationMultiplier=function(e,t,i,r){return t>r?e(r):t<0&&e(0),i>r?(r-t)/(i-t):i<0?t/(t-i):1},_allowNativePanning=function n(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Observer.isTouch?" pinch-zoom":""):"none",e===_docEl&&n(_body,t)},_overflow={auto:1,scroll:1},_nestedScroll=function(e){var t=e.event,i=e.target,r=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,o=s._gsap||gsap$1.core.getCache(s),a=_getTime(),h;if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s!==_body&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(_overflow[(h=_getComputedStyle(s)).overflowY]||_overflow[h.overflowX]));)s=s.parentNode;o._isScroll=s&&s!==i&&!_isViewport(s)&&(_overflow[(h=_getComputedStyle(s)).overflowY]||_overflow[h.overflowX]),o._isScrollT=a}(o._isScroll||r==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},_inputObserver=function(e,t,i,r){return Observer.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:r=r&&_nestedScroll,onPress:r,onDrag:r,onScroll:r,onEnable:function(){return i&&_addListener(_doc,Observer.eventTypes[0],_captureInputs,!1,!0)},onDisable:function(){return _removeListener(_doc,Observer.eventTypes[0],_captureInputs,!0)}})},_inputExp=/(input|label|select|textarea)/i,_inputIsFocused,_captureInputs=function(e){var t=_inputExp.test(e.target.tagName);(t||_inputIsFocused)&&(e._gsapAllow=!0,_inputIsFocused=t)},_getScrollNormalizer=function(e){_isObject(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,i=t.normalizeScrollX,r=t.momentum,s=t.allowNestedScroll,o=t.onRelease,a,h,d=_getTarget$1(e.target)||_docEl,u=gsap$1.core.globals().ScrollSmoother,m=u&&u.get(),v=_fixIOSBug&&(e.content&&_getTarget$1(e.content)||m&&e.content!==!1&&!m.smooth()&&m.content()),_=_getScrollFunc(d,_vertical),D=_getScrollFunc(d,_horizontal),f=1,l=(Observer.isTouch&&_win.visualViewport?_win.visualViewport.scale*_win.visualViewport.width:_win.outerWidth)/_win.innerWidth,c=0,p=_isFunction(r)?function(){return r(a)}:function(){return r||2.8},b,E,C=_inputObserver(d,e.type,!0,s),g=function(){return E=!1},x=_passThrough,y=_passThrough,w=function(){h=_maxScroll(d,_vertical),y=_clamp(_fixIOSBug?1:0,h),i&&(x=_clamp(0,_maxScroll(d,_horizontal))),b=_refreshID},M=function(){v._gsap.y=_round(parseFloat(v._gsap.y)+_.offset)+"px",v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(v._gsap.y)+", 0, 1)",_.offset=_.cacheID=0},S=function(){if(E){requestAnimationFrame(g);var U=_round(a.deltaY/2),W=y(_.v-U);if(v&&W!==_.v+_.offset){_.offset=W-_.v;var R=_round((parseFloat(v&&v._gsap.y)||0)-_.offset);v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+R+", 0, 1)",v._gsap.y=R+"px",_.cacheID=_scrollers.cache,_updateAll()}return!0}_.offset&&M(),E=!0},O,P,I,F,k=function(){w(),O.isActive()&&O.vars.scrollY>h&&(_()>h?O.progress(1)&&_(h):O.resetTo("scrollY",h))};return v&&gsap$1.set(v,{y:"+=0"}),e.ignoreCheck=function(B){return _fixIOSBug&&B.type==="touchmove"&&S()||f>1.05&&B.type!=="touchstart"||a.isGesturing||B.touches&&B.touches.length>1},e.onPress=function(){E=!1;var B=f;f=_round((_win.visualViewport&&_win.visualViewport.scale||1)/l),O.pause(),B!==f&&_allowNativePanning(d,f>1.01?!0:i?!1:"x"),P=D(),I=_(),w(),b=_refreshID},e.onRelease=e.onGestureStart=function(B,U){if(_.offset&&M(),!U)F.restart(!0);else{_scrollers.cache++;var W=p(),R,z;i&&(R=D(),z=R+W*.05*-B.velocityX/.227,W*=_clampScrollAndGetDurationMultiplier(D,R,z,_maxScroll(d,_horizontal)),O.vars.scrollX=x(z)),R=_(),z=R+W*.05*-B.velocityY/.227,W*=_clampScrollAndGetDurationMultiplier(_,R,z,_maxScroll(d,_vertical)),O.vars.scrollY=y(z),O.invalidate().duration(W).play(.01),(_fixIOSBug&&O.vars.scrollY>=h||R>=h-1)&&gsap$1.to({},{onUpdate:k,duration:W})}o&&o(B)},e.onWheel=function(){O._ts&&O.pause(),_getTime()-c>1e3&&(b=0,c=_getTime())},e.onChange=function(B,U,W,R,z){if(_refreshID!==b&&w(),U&&i&&D(x(R[2]===U?P+(B.startX-B.x):D()+U-R[1])),W){_.offset&&M();var G=z[2]===W,q=G?I+B.startY-B.y:_()+W-z[1],Q=y(q);G&&q!==Q&&(I+=Q-q),_(Q)}(W||U)&&_updateAll()},e.onEnable=function(){_allowNativePanning(d,i?!1:"x"),ScrollTrigger.addEventListener("refresh",k),_addListener(_win,"resize",k),_.smooth&&(_.target.style.scrollBehavior="auto",_.smooth=D.smooth=!1),C.enable()},e.onDisable=function(){_allowNativePanning(d,!0),_removeListener(_win,"resize",k),ScrollTrigger.removeEventListener("refresh",k),C.kill()},e.lockAxis=e.lockAxis!==!1,a=new Observer(e),a.iOS=_fixIOSBug,_fixIOSBug&&!_()&&_(1),_fixIOSBug&&gsap$1.ticker.add(_passThrough),F=a._dc,O=gsap$1.to(a,{ease:"power4",paused:!0,inherit:!1,scrollX:i?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:_interruptionTracker(_,_(),function(){return O.pause()})},onUpdate:_updateAll,onComplete:F.vars.onComplete}),a};ScrollTrigger.sort=function(n){if(_isFunction(n))return _triggers.sort(n);var e=_win.pageYOffset||0;return ScrollTrigger.getAll().forEach(function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+_win.innerHeight}),_triggers.sort(n||function(t,i){return(t.vars.refreshPriority||0)*-1e6+(t.vars.containerAnimation?1e6:t._sortY)-((i.vars.containerAnimation?1e6:i._sortY)+(i.vars.refreshPriority||0)*-1e6)})};ScrollTrigger.observe=function(n){return new Observer(n)};ScrollTrigger.normalizeScroll=function(n){if(typeof n>"u")return _normalizer;if(n===!0&&_normalizer)return _normalizer.enable();if(n===!1){_normalizer&&_normalizer.kill(),_normalizer=n;return}var e=n instanceof Observer?n:_getScrollNormalizer(n);return _normalizer&&_normalizer.target===e.target&&_normalizer.kill(),_isViewport(e.target)&&(_normalizer=e),e};ScrollTrigger.core={_getVelocityProp,_inputObserver,_scrollers,_proxies,bridge:{ss:function(){_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime()},ref:function(){return _refreshing}}};_getGSAP$1()&&gsap$1.registerPlugin(ScrollTrigger);/*!
 * strings: 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _trimExp=/(?:^\s+|\s+$)/g,emojiExp=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2642\u2640]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDD27\uDCBC\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCC\uDFCB]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;function getText(n){var e=n.nodeType,t="";if(e===1||e===9||e===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)t+=getText(n)}else if(e===3||e===4)return n.nodeValue;return t}function splitInnerHTML(n,e,t,i,r){for(var s=n.firstChild,o=[],a;s;)s.nodeType===3?(a=(s.nodeValue+"").replace(/^\n+/g,""),i||(a=a.replace(/\s+/g," ")),o.push.apply(o,emojiSafeSplit(a,e,t,i,r))):(s.nodeName+"").toLowerCase()==="br"?o[o.length-1]+="<br>":o.push(s.outerHTML),s=s.nextSibling;if(!r)for(a=o.length;a--;)o[a]==="&"&&o.splice(a,1,"&amp;");return o}function emojiSafeSplit(n,e,t,i,r){if(n+="",t&&(n=n.trim?n.trim():n.replace(_trimExp,"")),e&&e!=="")return n.replace(/>/g,"&gt;").replace(/</g,"&lt;").split(e);for(var s=[],o=n.length,a=0,h,d;a<o;a++)d=n.charAt(a),(d.charCodeAt(0)>=55296&&d.charCodeAt(0)<=56319||n.charCodeAt(a+1)>=65024&&n.charCodeAt(a+1)<=65039)&&(h=((n.substr(a,12).split(emojiExp)||[])[1]||"").length||2,d=n.substr(a,h),s.emoji=1,a+=h-1),s.push(r?d:d===">"?"&gt;":d==="<"?"&lt;":i&&d===" "&&(n.charAt(a-1)===" "||n.charAt(a+1)===" ")?"&nbsp;":d);return s}/*!
 * TextPlugin 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap,_tempDiv,_getGSAP=function(){return gsap||typeof window<"u"&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap},TextPlugin={version:"3.13.0",name:"text",init:function(e,t,i){typeof t!="object"&&(t={value:t});var r=e.nodeName.toUpperCase(),s=this,o=t,a=o.newClass,h=o.oldClass,d=o.preserveSpaces,u=o.rtl,m=s.delimiter=t.delimiter||"",v=s.fillChar=t.fillChar||(t.padSpace?"&nbsp;":""),_,D,f,l,c,p,b,E;if(s.svg=e.getBBox&&(r==="TEXT"||r==="TSPAN"),!("innerHTML"in e)&&!s.svg)return!1;if(s.target=e,!("value"in t)){s.text=s.original=[""];return}for(f=splitInnerHTML(e,m,!1,d,s.svg),_tempDiv||(_tempDiv=document.createElement("div")),_tempDiv.innerHTML=t.value,D=splitInnerHTML(_tempDiv,m,!1,d,s.svg),s.from=i._from,(s.from||u)&&!(u&&s.from)&&(r=f,f=D,D=r),s.hasClass=!!(a||h),s.newClass=u?h:a,s.oldClass=u?a:h,r=f.length-D.length,_=r<0?f:D,r<0&&(r=-r);--r>-1;)_.push(v);if(t.type==="diff"){for(l=0,c=[],p=[],b="",r=0;r<D.length;r++)E=D[r],E===f[r]?b+=E:(c[l]=b+E,p[l++]=b+f[r],b="");D=c,f=p,b&&(D.push(b),f.push(b))}t.speed&&i.duration(Math.min(.05/t.speed*_.length,t.maxDuration||9999)),s.rtl=u,s.original=f,s.text=D,s._props.push("text")},render:function(e,t){e>1?e=1:e<0&&(e=0),t.from&&(e=1-e);var i=t.text,r=t.hasClass,s=t.newClass,o=t.oldClass,a=t.delimiter,h=t.target,d=t.fillChar,u=t.original,m=t.rtl,v=i.length,_=(m?1-e:e)*v+.5|0,D,f,l;r&&e?(D=s&&_,f=o&&_!==v,l=(D?"<span class='"+s+"'>":"")+i.slice(0,_).join(a)+(D?"</span>":"")+(f?"<span class='"+o+"'>":"")+a+u.slice(_).join(a)+(f?"</span>":"")):l=i.slice(0,_).join(a)+a+u.slice(_).join(a),t.svg?h.textContent=l:h.innerHTML=d==="&nbsp;"&&~l.indexOf("  ")?l.split("  ").join("&nbsp;&nbsp;"):l}};TextPlugin.splitInnerHTML=splitInnerHTML;TextPlugin.emojiSafeSplit=emojiSafeSplit;TextPlugin.getText=getText;_getGSAP()&&gsap.registerPlugin(TextPlugin);var _3Dmol$1={exports:{}};/*!
 * 3dmol v2.5.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */var _3Dmol=_3Dmol$1.exports,hasRequired_3Dmol;function require_3Dmol(){return hasRequired_3Dmol||(hasRequired_3Dmol=1,function(module,exports){(function(e,t){module.exports=t()})(_3Dmol,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":(n,e,t)=>{t.r(e),t.d(e,{IOBuffer:()=>a});var i=t("./node_modules/iobuffer/lib-esm/text.js");const r=1024*8,s=(()=>{const h=new Uint8Array(4),d=new Uint32Array(h.buffer);return!((d[0]=1)&h[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(d=r,u={}){je(this,"buffer");je(this,"byteLength");je(this,"byteOffset");je(this,"length");je(this,"offset");je(this,"lastWrittenByte");je(this,"littleEndian");je(this,"_data");je(this,"_mark");je(this,"_marks");let m=!1;typeof d=="number"?d=new ArrayBuffer(d):(m=!0,this.lastWrittenByte=d.byteLength);const v=u.offset?u.offset>>>0:0,_=d.byteLength-v;let D=v;(ArrayBuffer.isView(d)||d instanceof a)&&(d.byteLength!==d.buffer.byteLength&&(D=d.byteOffset+v),d=d.buffer),m?this.lastWrittenByte=_:this.lastWrittenByte=0,this.buffer=d,this.length=_,this.byteLength=_,this.byteOffset=D,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,D,_),this._mark=0,this._marks=[]}available(d=1){return this.offset+d<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(d=1){return this.offset+=d,this}back(d=1){return this.offset-=d,this}seek(d){return this.offset=d,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const d=this._marks.pop();if(d===void 0)throw new Error("Mark stack empty");return this.seek(d),this}rewind(){return this.offset=0,this}ensureAvailable(d=1){if(!this.available(d)){const m=(this.offset+d)*2,v=new Uint8Array(m);v.set(new Uint8Array(this.buffer)),this.buffer=v.buffer,this.length=m,this.byteLength=m,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(d=1){return this.readArray(d,"uint8")}readArray(d,u){const m=o[u].BYTES_PER_ELEMENT*d,v=this.byteOffset+this.offset,_=this.buffer.slice(v,v+m);if(this.littleEndian===s&&u!=="uint8"&&u!=="int8"){const f=new Uint8Array(this.buffer.slice(v,v+m));f.reverse();const l=new o[u](f.buffer);return this.offset+=m,l.reverse(),l}const D=new o[u](_);return this.offset+=m,D}readInt16(){const d=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,d}readUint16(){const d=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,d}readInt32(){const d=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,d}readUint32(){const d=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,d}readFloat32(){const d=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,d}readFloat64(){const d=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,d}readBigInt64(){const d=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,d}readBigUint64(){const d=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,d}readChar(){return String.fromCharCode(this.readInt8())}readChars(d=1){let u="";for(let m=0;m<d;m++)u+=this.readChar();return u}readUtf8(d=1){return(0,i.decode)(this.readBytes(d))}decodeText(d=1,u="utf8"){return(0,i.decode)(this.readBytes(d),u)}writeBoolean(d){return this.writeUint8(d?255:0),this}writeInt8(d){return this.ensureAvailable(1),this._data.setInt8(this.offset++,d),this._updateLastWrittenByte(),this}writeUint8(d){return this.ensureAvailable(1),this._data.setUint8(this.offset++,d),this._updateLastWrittenByte(),this}writeByte(d){return this.writeUint8(d)}writeBytes(d){this.ensureAvailable(d.length);for(let u=0;u<d.length;u++)this._data.setUint8(this.offset++,d[u]);return this._updateLastWrittenByte(),this}writeInt16(d){return this.ensureAvailable(2),this._data.setInt16(this.offset,d,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(d){return this.ensureAvailable(2),this._data.setUint16(this.offset,d,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(d){return this.ensureAvailable(4),this._data.setInt32(this.offset,d,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(d){return this.ensureAvailable(4),this._data.setUint32(this.offset,d,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(d){return this.ensureAvailable(4),this._data.setFloat32(this.offset,d,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(d){return this.ensureAvailable(8),this._data.setFloat64(this.offset,d,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(d){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,d,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(d){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,d,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(d){return this.writeUint8(d.charCodeAt(0))}writeChars(d){for(let u=0;u<d.length;u++)this.writeUint8(d.charCodeAt(u));return this}writeUtf8(d){return this.writeBytes((0,i.encode)(d))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},"./node_modules/iobuffer/lib-esm/text.js":(n,e,t)=>{t.r(e),t.d(e,{decode:()=>i,encode:()=>s});function i(o,a="utf8"){return new TextDecoder(a).decode(o)}const r=new TextEncoder;function s(o){return r.encode(o)}},"./node_modules/netcdfjs/lib-esm/data.js":(n,e,t)=>{t.r(e),t.d(e,{nonRecord:()=>r,record:()=>s});var i=t("./node_modules/netcdfjs/lib-esm/types.js");function r(o,a){const h=(0,i.str2num)(a.type),d=a.size/(0,i.num2bytes)(h),u=new Array(d);for(let m=0;m<d;m++)u[m]=(0,i.readType)(o,h,1);return u}function s(o,a,h){const d=(0,i.str2num)(a.type),u=a.size?a.size/(0,i.num2bytes)(d):1,m=h.length,v=new Array(m),_=h.recordStep;if(_)for(let D=0;D<m;D++){const f=o.offset;v[D]=(0,i.readType)(o,d,u),o.seek(f+_)}else throw new Error("recordDimension.recordStep is undefined");return v}},"./node_modules/netcdfjs/lib-esm/header.js":(n,e,t)=>{t.r(e),t.d(e,{header:()=>u});var i=t("./node_modules/netcdfjs/lib-esm/types.js"),r=t("./node_modules/netcdfjs/lib-esm/utils.js");const s=0,o=10,a=11,h=12,d=0;function u(D,f){const l={version:f},c={length:D.readUint32()},p=m(D);Array.isArray(p)||(c.id=p.recordId,c.name=p.recordName,l.dimensions=p.dimensions),l.globalAttributes=v(D);const b=_(D,c==null?void 0:c.id,f);return Array.isArray(b)||(l.variables=b.variables,c.recordStep=b.recordStep),l.recordDimension=c,l}function m(D){const f={};let l,c;const p=D.readUint32();let b;if(p===s)return(0,r.notNetcdf)(D.readUint32()!==s,"wrong empty tag for list of dimensions"),[];{(0,r.notNetcdf)(p!==o,"wrong tag for list of dimensions");const E=D.readUint32();b=new Array(E);for(let C=0;C<E;C++){const g=(0,r.readName)(D),x=D.readUint32();x===d&&(l=C,c=g),b[C]={name:g,size:x}}}return l!==void 0&&(f.recordId=l),c!==void 0&&(f.recordName=c),f.dimensions=b,f}function v(D){const f=D.readUint32();let l;if(f===s)return(0,r.notNetcdf)(D.readUint32()!==s,"wrong empty tag for list of attributes"),[];{(0,r.notNetcdf)(f!==h,"wrong tag for list of attributes");const c=D.readUint32();l=new Array(c);for(let p=0;p<c;p++){const b=(0,r.readName)(D),E=D.readUint32();(0,r.notNetcdf)(E<1||E>6,`non valid type ${E}`);const C=D.readUint32(),g=(0,i.readType)(D,E,C);(0,r.padding)(D),l[p]={name:b,type:(0,i.num2str)(E),value:g}}}return l}function _(D,f,l){const c=D.readUint32();let p=0,b;if(c===s)return(0,r.notNetcdf)(D.readUint32()!==s,"wrong empty tag for list of variables"),[];{(0,r.notNetcdf)(c!==a,"wrong tag for list of variables");const E=D.readUint32();b=new Array(E);for(let C=0;C<E;C++){const g=(0,r.readName)(D),x=D.readUint32(),y=new Array(x);for(let I=0;I<x;I++)y[I]=D.readUint32();const w=v(D),M=D.readUint32();(0,r.notNetcdf)(M<1&&M>6,`non valid type ${M}`);const S=D.readUint32();let O=D.readUint32();l===2&&((0,r.notNetcdf)(O>0,"offsets larger than 4GB not supported"),O=D.readUint32());let P=!1;typeof f<"u"&&y[0]===f&&(p+=S,P=!0),b[C]={name:g,dimensions:y,attributes:w,type:(0,i.num2str)(M),size:S,offset:O,record:P}}}return{variables:b,recordStep:p}}},"./node_modules/netcdfjs/lib-esm/index.js":(n,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>i.NetCDFReader});var i=t("./node_modules/netcdfjs/lib-esm/parser.js")},"./node_modules/netcdfjs/lib-esm/parser.js":(n,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>h});var i=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),r=t("./node_modules/netcdfjs/lib-esm/data.js"),s=t("./node_modules/netcdfjs/lib-esm/header.js"),o=t("./node_modules/netcdfjs/lib-esm/toString.js"),a=t("./node_modules/netcdfjs/lib-esm/utils.js");class h{constructor(u){this.toString=o.toString;const m=new i.IOBuffer(u);m.setBigEndian(),(0,a.notNetcdf)(m.readChars(3)!=="CDF","should start with CDF");const v=m.readByte();(0,a.notNetcdf)(v>2,"unknown version"),this.header=(0,s.header)(m,v),this.buffer=m}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(u){const m=this.globalAttributes.find(v=>v.name===u);return m?m.value:null}getDataVariableAsString(u){const m=this.getDataVariable(u);return m?m.join(""):null}get variables(){return this.header.variables}getDataVariable(u){let m;if(typeof u=="string"?m=this.header.variables.find(v=>v.name===u):m=u,m===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(m.offset),m.record?(0,r.record)(this.buffer,m,this.header.recordDimension):(0,r.nonRecord)(this.buffer,m)}dataVariableExists(u){return this.header.variables.find(v=>v.name===u)!==void 0}attributeExists(u){return this.globalAttributes.find(v=>v.name===u)!==void 0}}},"./node_modules/netcdfjs/lib-esm/toString.js":(n,e,t)=>{t.r(e),t.d(e,{toString:()=>i});function i(){const r=[];r.push("DIMENSIONS");for(const o of this.dimensions)r.push(`  ${o.name.padEnd(30)} = size: ${o.size}`);r.push(""),r.push("GLOBAL ATTRIBUTES");for(const o of this.globalAttributes)r.push(`  ${o.name.padEnd(30)} = ${o.value}`);const s=JSON.parse(JSON.stringify(this.variables));r.push(""),r.push("VARIABLES:");for(const o of s){o.value=this.getDataVariable(o);let a=JSON.stringify(o.value);a.length>50&&(a=a.substring(0,50)),isNaN(o.value.length)||(a+=` (length: ${o.value.length})`),r.push(`  ${o.name.padEnd(30)} = ${a}`)}return r.join(`
`)}},"./node_modules/netcdfjs/lib-esm/types.js":(n,e,t)=>{t.r(e),t.d(e,{num2bytes:()=>s,num2str:()=>r,readType:()=>h,str2num:()=>o});const i={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function r(u){switch(Number(u)){case i.BYTE:return"byte";case i.CHAR:return"char";case i.SHORT:return"short";case i.INT:return"int";case i.FLOAT:return"float";case i.DOUBLE:return"double";default:return"undefined"}}function s(u){switch(Number(u)){case i.BYTE:return 1;case i.CHAR:return 1;case i.SHORT:return 2;case i.INT:return 4;case i.FLOAT:return 4;case i.DOUBLE:return 8;default:return-1}}function o(u){switch(String(u)){case"byte":return i.BYTE;case"char":return i.CHAR;case"short":return i.SHORT;case"int":return i.INT;case"float":return i.FLOAT;case"double":return i.DOUBLE;default:return-1}}function a(u,m){if(u!==1){const v=new Array(u);for(let _=0;_<u;_++)v[_]=m();return v}else return m()}function h(u,m,v){switch(m){case i.BYTE:return Array.from(u.readBytes(v));case i.CHAR:return d(u.readChars(v));case i.SHORT:return a(v,u.readInt16.bind(u));case i.INT:return a(v,u.readInt32.bind(u));case i.FLOAT:return a(v,u.readFloat32.bind(u));case i.DOUBLE:return a(v,u.readFloat64.bind(u));default:throw new Error(`non valid type ${m}`)}}function d(u){return u.charCodeAt(u.length-1)===0?u.substring(0,u.length-1):u}},"./node_modules/netcdfjs/lib-esm/utils.js":(n,e,t)=>{t.r(e),t.d(e,{notNetcdf:()=>i,padding:()=>r,readName:()=>s});function i(o,a){if(o)throw new TypeError(`Not a valid NetCDF v3.x file: ${a}`)}function r(o){o.offset%4!==0&&o.skip(4-o.offset%4)}function s(o){const a=o.readUint32(),h=o.readChars(a);return r(o),h}},"./node_modules/pako/dist/pako.esm.mjs":(n,e,t)=>{t.r(e),t.d(e,{Deflate:()=>Hr,Inflate:()=>Yr,constants:()=>Jr,default:()=>Gs,deflate:()=>jr,deflateRaw:()=>$r,gzip:()=>Kr,inflate:()=>Xr,inflateRaw:()=>Zr,ungzip:()=>Qr});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const i=4,r=0,s=1,o=2;function a(A){let N=A.length;for(;--N>=0;)A[N]=0}const h=0,d=1,u=2,m=3,v=258,_=29,D=256,f=D+1+_,l=30,c=19,p=2*f+1,b=15,E=16,C=7,g=256,x=16,y=17,w=18,M=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),S=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),O=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),I=512,F=new Array((f+2)*2);a(F);const k=new Array(l*2);a(k);const B=new Array(I);a(B);const U=new Array(v-m+1);a(U);const W=new Array(_);a(W);const R=new Array(l);a(R);function z(A,N,T,Y,ee){this.static_tree=A,this.extra_bits=N,this.extra_base=T,this.elems=Y,this.max_length=ee,this.has_stree=A&&A.length}let G,q,Q;function ne(A,N){this.dyn_tree=A,this.max_code=0,this.stat_desc=N}const te=A=>A<256?B[A]:B[256+(A>>>7)],oe=(A,N)=>{A.pending_buf[A.pending++]=N&255,A.pending_buf[A.pending++]=N>>>8&255},re=(A,N,T)=>{A.bi_valid>E-T?(A.bi_buf|=N<<A.bi_valid&65535,oe(A,A.bi_buf),A.bi_buf=N>>E-A.bi_valid,A.bi_valid+=T-E):(A.bi_buf|=N<<A.bi_valid&65535,A.bi_valid+=T)},le=(A,N,T)=>{re(A,T[N*2],T[N*2+1])},Ce=(A,N)=>{let T=0;do T|=A&1,A>>>=1,T<<=1;while(--N>0);return T>>>1},De=A=>{A.bi_valid===16?(oe(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):A.bi_valid>=8&&(A.pending_buf[A.pending++]=A.bi_buf&255,A.bi_buf>>=8,A.bi_valid-=8)},Oe=(A,N)=>{const T=N.dyn_tree,Y=N.max_code,ee=N.stat_desc.static_tree,J=N.stat_desc.has_stree,Ae=N.stat_desc.extra_bits,be=N.stat_desc.extra_base,qe=N.stat_desc.max_length;let fe,Me,pt,Qe,Ve,it,Mt=0;for(Qe=0;Qe<=b;Qe++)A.bl_count[Qe]=0;for(T[A.heap[A.heap_max]*2+1]=0,fe=A.heap_max+1;fe<p;fe++)Me=A.heap[fe],Qe=T[T[Me*2+1]*2+1]+1,Qe>qe&&(Qe=qe,Mt++),T[Me*2+1]=Qe,!(Me>Y)&&(A.bl_count[Qe]++,Ve=0,Me>=be&&(Ve=Ae[Me-be]),it=T[Me*2],A.opt_len+=it*(Qe+Ve),J&&(A.static_len+=it*(ee[Me*2+1]+Ve)));if(Mt!==0){do{for(Qe=qe-1;A.bl_count[Qe]===0;)Qe--;A.bl_count[Qe]--,A.bl_count[Qe+1]+=2,A.bl_count[qe]--,Mt-=2}while(Mt>0);for(Qe=qe;Qe!==0;Qe--)for(Me=A.bl_count[Qe];Me!==0;)pt=A.heap[--fe],!(pt>Y)&&(T[pt*2+1]!==Qe&&(A.opt_len+=(Qe-T[pt*2+1])*T[pt*2],T[pt*2+1]=Qe),Me--)}},_e=(A,N,T)=>{const Y=new Array(b+1);let ee=0,J,Ae;for(J=1;J<=b;J++)ee=ee+T[J-1]<<1,Y[J]=ee;for(Ae=0;Ae<=N;Ae++){let be=A[Ae*2+1];be!==0&&(A[Ae*2]=Ce(Y[be]++,be))}},Z=()=>{let A,N,T,Y,ee;const J=new Array(b+1);for(T=0,Y=0;Y<_-1;Y++)for(W[Y]=T,A=0;A<1<<M[Y];A++)U[T++]=Y;for(U[T-1]=Y,ee=0,Y=0;Y<16;Y++)for(R[Y]=ee,A=0;A<1<<S[Y];A++)B[ee++]=Y;for(ee>>=7;Y<l;Y++)for(R[Y]=ee<<7,A=0;A<1<<S[Y]-7;A++)B[256+ee++]=Y;for(N=0;N<=b;N++)J[N]=0;for(A=0;A<=143;)F[A*2+1]=8,A++,J[8]++;for(;A<=255;)F[A*2+1]=9,A++,J[9]++;for(;A<=279;)F[A*2+1]=7,A++,J[7]++;for(;A<=287;)F[A*2+1]=8,A++,J[8]++;for(_e(F,f+1,J),A=0;A<l;A++)k[A*2+1]=5,k[A*2]=Ce(A,5);G=new z(F,M,D+1,f,b),q=new z(k,S,0,l,b),Q=new z(new Array(0),O,0,c,C)},xe=A=>{let N;for(N=0;N<f;N++)A.dyn_ltree[N*2]=0;for(N=0;N<l;N++)A.dyn_dtree[N*2]=0;for(N=0;N<c;N++)A.bl_tree[N*2]=0;A.dyn_ltree[g*2]=1,A.opt_len=A.static_len=0,A.sym_next=A.matches=0},we=A=>{A.bi_valid>8?oe(A,A.bi_buf):A.bi_valid>0&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0},ie=(A,N,T,Y)=>{const ee=N*2,J=T*2;return A[ee]<A[J]||A[ee]===A[J]&&Y[N]<=Y[T]},Ne=(A,N,T)=>{const Y=A.heap[T];let ee=T<<1;for(;ee<=A.heap_len&&(ee<A.heap_len&&ie(N,A.heap[ee+1],A.heap[ee],A.depth)&&ee++,!ie(N,Y,A.heap[ee],A.depth));)A.heap[T]=A.heap[ee],T=ee,ee<<=1;A.heap[T]=Y},Ge=(A,N,T)=>{let Y,ee,J=0,Ae,be;if(A.sym_next!==0)do Y=A.pending_buf[A.sym_buf+J++]&255,Y+=(A.pending_buf[A.sym_buf+J++]&255)<<8,ee=A.pending_buf[A.sym_buf+J++],Y===0?le(A,ee,N):(Ae=U[ee],le(A,Ae+D+1,N),be=M[Ae],be!==0&&(ee-=W[Ae],re(A,ee,be)),Y--,Ae=te(Y),le(A,Ae,T),be=S[Ae],be!==0&&(Y-=R[Ae],re(A,Y,be)));while(J<A.sym_next);le(A,g,N)},Ue=(A,N)=>{const T=N.dyn_tree,Y=N.stat_desc.static_tree,ee=N.stat_desc.has_stree,J=N.stat_desc.elems;let Ae,be,qe=-1,fe;for(A.heap_len=0,A.heap_max=p,Ae=0;Ae<J;Ae++)T[Ae*2]!==0?(A.heap[++A.heap_len]=qe=Ae,A.depth[Ae]=0):T[Ae*2+1]=0;for(;A.heap_len<2;)fe=A.heap[++A.heap_len]=qe<2?++qe:0,T[fe*2]=1,A.depth[fe]=0,A.opt_len--,ee&&(A.static_len-=Y[fe*2+1]);for(N.max_code=qe,Ae=A.heap_len>>1;Ae>=1;Ae--)Ne(A,T,Ae);fe=J;do Ae=A.heap[1],A.heap[1]=A.heap[A.heap_len--],Ne(A,T,1),be=A.heap[1],A.heap[--A.heap_max]=Ae,A.heap[--A.heap_max]=be,T[fe*2]=T[Ae*2]+T[be*2],A.depth[fe]=(A.depth[Ae]>=A.depth[be]?A.depth[Ae]:A.depth[be])+1,T[Ae*2+1]=T[be*2+1]=fe,A.heap[1]=fe++,Ne(A,T,1);while(A.heap_len>=2);A.heap[--A.heap_max]=A.heap[1],Oe(A,N),_e(T,qe,A.bl_count)},Ie=(A,N,T)=>{let Y,ee=-1,J,Ae=N[0*2+1],be=0,qe=7,fe=4;for(Ae===0&&(qe=138,fe=3),N[(T+1)*2+1]=65535,Y=0;Y<=T;Y++)J=Ae,Ae=N[(Y+1)*2+1],!(++be<qe&&J===Ae)&&(be<fe?A.bl_tree[J*2]+=be:J!==0?(J!==ee&&A.bl_tree[J*2]++,A.bl_tree[x*2]++):be<=10?A.bl_tree[y*2]++:A.bl_tree[w*2]++,be=0,ee=J,Ae===0?(qe=138,fe=3):J===Ae?(qe=6,fe=3):(qe=7,fe=4))},ze=(A,N,T)=>{let Y,ee=-1,J,Ae=N[0*2+1],be=0,qe=7,fe=4;for(Ae===0&&(qe=138,fe=3),Y=0;Y<=T;Y++)if(J=Ae,Ae=N[(Y+1)*2+1],!(++be<qe&&J===Ae)){if(be<fe)do le(A,J,A.bl_tree);while(--be!==0);else J!==0?(J!==ee&&(le(A,J,A.bl_tree),be--),le(A,x,A.bl_tree),re(A,be-3,2)):be<=10?(le(A,y,A.bl_tree),re(A,be-3,3)):(le(A,w,A.bl_tree),re(A,be-11,7));be=0,ee=J,Ae===0?(qe=138,fe=3):J===Ae?(qe=6,fe=3):(qe=7,fe=4)}},Re=A=>{let N;for(Ie(A,A.dyn_ltree,A.l_desc.max_code),Ie(A,A.dyn_dtree,A.d_desc.max_code),Ue(A,A.bl_desc),N=c-1;N>=3&&A.bl_tree[P[N]*2+1]===0;N--);return A.opt_len+=3*(N+1)+5+5+4,N},Le=(A,N,T,Y)=>{let ee;for(re(A,N-257,5),re(A,T-1,5),re(A,Y-4,4),ee=0;ee<Y;ee++)re(A,A.bl_tree[P[ee]*2+1],3);ze(A,A.dyn_ltree,N-1),ze(A,A.dyn_dtree,T-1)},We=A=>{let N=4093624447,T;for(T=0;T<=31;T++,N>>>=1)if(N&1&&A.dyn_ltree[T*2]!==0)return r;if(A.dyn_ltree[9*2]!==0||A.dyn_ltree[10*2]!==0||A.dyn_ltree[13*2]!==0)return s;for(T=32;T<D;T++)if(A.dyn_ltree[T*2]!==0)return s;return r};let He=!1;const H=A=>{He||(Z(),He=!0),A.l_desc=new ne(A.dyn_ltree,G),A.d_desc=new ne(A.dyn_dtree,q),A.bl_desc=new ne(A.bl_tree,Q),A.bi_buf=0,A.bi_valid=0,xe(A)},K=(A,N,T,Y)=>{re(A,(h<<1)+(Y?1:0),3),we(A),oe(A,T),oe(A,~T),T&&A.pending_buf.set(A.window.subarray(N,N+T),A.pending),A.pending+=T},X=A=>{re(A,d<<1,3),le(A,g,F),De(A)},pe=(A,N,T,Y)=>{let ee,J,Ae=0;A.level>0?(A.strm.data_type===o&&(A.strm.data_type=We(A)),Ue(A,A.l_desc),Ue(A,A.d_desc),Ae=Re(A),ee=A.opt_len+3+7>>>3,J=A.static_len+3+7>>>3,J<=ee&&(ee=J)):ee=J=T+5,T+4<=ee&&N!==-1?K(A,N,T,Y):A.strategy===i||J===ee?(re(A,(d<<1)+(Y?1:0),3),Ge(A,F,k)):(re(A,(u<<1)+(Y?1:0),3),Le(A,A.l_desc.max_code+1,A.d_desc.max_code+1,Ae+1),Ge(A,A.dyn_ltree,A.dyn_dtree)),xe(A),Y&&we(A)},ue=(A,N,T)=>(A.pending_buf[A.sym_buf+A.sym_next++]=N,A.pending_buf[A.sym_buf+A.sym_next++]=N>>8,A.pending_buf[A.sym_buf+A.sym_next++]=T,N===0?A.dyn_ltree[T*2]++:(A.matches++,N--,A.dyn_ltree[(U[T]+D+1)*2]++,A.dyn_dtree[te(N)*2]++),A.sym_next===A.sym_end);var ye=H,Se=K,V=pe,he=ue,ve=X,Pe={_tr_init:ye,_tr_stored_block:Se,_tr_flush_block:V,_tr_tally:he,_tr_align:ve},me=(A,N,T,Y)=>{let ee=A&65535|0,J=A>>>16&65535|0,Ae=0;for(;T!==0;){Ae=T>2e3?2e3:T,T-=Ae;do ee=ee+N[Y++]|0,J=J+ee|0;while(--Ae);ee%=65521,J%=65521}return ee|J<<16|0};const j=()=>{let A,N=[];for(var T=0;T<256;T++){A=T;for(var Y=0;Y<8;Y++)A=A&1?3988292384^A>>>1:A>>>1;N[T]=A}return N},Te=new Uint32Array(j());var L=(A,N,T,Y)=>{const ee=Te,J=Y+T;A^=-1;for(let Ae=Y;Ae<J;Ae++)A=A>>>8^ee[(A^N[Ae])&255];return A^-1},ge={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},de={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$,_tr_stored_block:se,_tr_flush_block:ce,_tr_tally:Fe,_tr_align:ke}=Pe,{Z_NO_FLUSH:Ee,Z_PARTIAL_FLUSH:$e,Z_FULL_FLUSH:Xe,Z_FINISH:Ke,Z_BLOCK:Je,Z_OK:Ye,Z_STREAM_END:nt,Z_STREAM_ERROR:st,Z_DATA_ERROR:_t,Z_BUF_ERROR:ut,Z_DEFAULT_COMPRESSION:et,Z_FILTERED:ht,Z_HUFFMAN_ONLY:tt,Z_RLE:bt,Z_FIXED:Dt,Z_DEFAULT_STRATEGY:Et,Z_UNKNOWN:St,Z_DEFLATED:Ct}=de,zt=9,Nt=15,Tt=8,$t=256+1+29,xi=30,Kt=19,Bt=2*$t+1,Yt=15,ot=3,Pt=258,Ut=Pt+ot+1,en=32,ti=42,Oi=57,Pi=69,Li=73,Ri=91,Fi=103,Xt=113,oi=666,Rt=1,ii=2,Zt=3,ri=4,tn=3,Qt=(A,N)=>(A.msg=ge[N],N),Ki=A=>A*2-(A>4?9:0),Ht=A=>{let N=A.length;for(;--N>=0;)A[N]=0},rn=A=>{let N,T,Y,ee=A.w_size;N=A.hash_size,Y=N;do T=A.head[--Y],A.head[Y]=T>=ee?T-ee:0;while(--N);N=ee,Y=N;do T=A.prev[--Y],A.prev[Y]=T>=ee?T-ee:0;while(--N)};let jt=(A,N,T)=>(N<<A.hash_shift^T)&A.hash_mask;const Ft=A=>{const N=A.state;let T=N.pending;T>A.avail_out&&(T=A.avail_out),T!==0&&(A.output.set(N.pending_buf.subarray(N.pending_out,N.pending_out+T),A.next_out),A.next_out+=T,N.pending_out+=T,A.total_out+=T,A.avail_out-=T,N.pending-=T,N.pending===0&&(N.pending_out=0))},It=(A,N)=>{ce(A,A.block_start>=0?A.block_start:-1,A.strstart-A.block_start,N),A.block_start=A.strstart,Ft(A.strm)},mt=(A,N)=>{A.pending_buf[A.pending++]=N},li=(A,N)=>{A.pending_buf[A.pending++]=N>>>8&255,A.pending_buf[A.pending++]=N&255},Ii=(A,N,T,Y)=>{let ee=A.avail_in;return ee>Y&&(ee=Y),ee===0?0:(A.avail_in-=ee,N.set(A.input.subarray(A.next_in,A.next_in+ee),T),A.state.wrap===1?A.adler=me(A.adler,N,ee,T):A.state.wrap===2&&(A.adler=L(A.adler,N,ee,T)),A.next_in+=ee,A.total_in+=ee,ee)},Yi=(A,N)=>{let T=A.max_chain_length,Y=A.strstart,ee,J,Ae=A.prev_length,be=A.nice_match;const qe=A.strstart>A.w_size-Ut?A.strstart-(A.w_size-Ut):0,fe=A.window,Me=A.w_mask,pt=A.prev,Qe=A.strstart+Pt;let Ve=fe[Y+Ae-1],it=fe[Y+Ae];A.prev_length>=A.good_match&&(T>>=2),be>A.lookahead&&(be=A.lookahead);do if(ee=N,!(fe[ee+Ae]!==it||fe[ee+Ae-1]!==Ve||fe[ee]!==fe[Y]||fe[++ee]!==fe[Y+1])){Y+=2,ee++;do;while(fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&Y<Qe);if(J=Pt-(Qe-Y),Y=Qe-Pt,J>Ae){if(A.match_start=N,Ae=J,J>=be)break;Ve=fe[Y+Ae-1],it=fe[Y+Ae]}}while((N=pt[N&Me])>qe&&--T!==0);return Ae<=A.lookahead?Ae:A.lookahead},ni=A=>{const N=A.w_size;let T,Y,ee;do{if(Y=A.window_size-A.lookahead-A.strstart,A.strstart>=N+(N-Ut)&&(A.window.set(A.window.subarray(N,N+N-Y),0),A.match_start-=N,A.strstart-=N,A.block_start-=N,A.insert>A.strstart&&(A.insert=A.strstart),rn(A),Y+=N),A.strm.avail_in===0)break;if(T=Ii(A.strm,A.window,A.strstart+A.lookahead,Y),A.lookahead+=T,A.lookahead+A.insert>=ot)for(ee=A.strstart-A.insert,A.ins_h=A.window[ee],A.ins_h=jt(A,A.ins_h,A.window[ee+1]);A.insert&&(A.ins_h=jt(A,A.ins_h,A.window[ee+ot-1]),A.prev[ee&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=ee,ee++,A.insert--,!(A.lookahead+A.insert<ot)););}while(A.lookahead<Ut&&A.strm.avail_in!==0)},Xi=(A,N)=>{let T=A.pending_buf_size-5>A.w_size?A.w_size:A.pending_buf_size-5,Y,ee,J,Ae=0,be=A.strm.avail_in;do{if(Y=65535,J=A.bi_valid+42>>3,A.strm.avail_out<J||(J=A.strm.avail_out-J,ee=A.strstart-A.block_start,Y>ee+A.strm.avail_in&&(Y=ee+A.strm.avail_in),Y>J&&(Y=J),Y<T&&(Y===0&&N!==Ke||N===Ee||Y!==ee+A.strm.avail_in)))break;Ae=N===Ke&&Y===ee+A.strm.avail_in?1:0,se(A,0,0,Ae),A.pending_buf[A.pending-4]=Y,A.pending_buf[A.pending-3]=Y>>8,A.pending_buf[A.pending-2]=~Y,A.pending_buf[A.pending-1]=~Y>>8,Ft(A.strm),ee&&(ee>Y&&(ee=Y),A.strm.output.set(A.window.subarray(A.block_start,A.block_start+ee),A.strm.next_out),A.strm.next_out+=ee,A.strm.avail_out-=ee,A.strm.total_out+=ee,A.block_start+=ee,Y-=ee),Y&&(Ii(A.strm,A.strm.output,A.strm.next_out,Y),A.strm.next_out+=Y,A.strm.avail_out-=Y,A.strm.total_out+=Y)}while(Ae===0);return be-=A.strm.avail_in,be&&(be>=A.w_size?(A.matches=2,A.window.set(A.strm.input.subarray(A.strm.next_in-A.w_size,A.strm.next_in),0),A.strstart=A.w_size,A.insert=A.strstart):(A.window_size-A.strstart<=be&&(A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,A.insert>A.strstart&&(A.insert=A.strstart)),A.window.set(A.strm.input.subarray(A.strm.next_in-be,A.strm.next_in),A.strstart),A.strstart+=be,A.insert+=be>A.w_size-A.insert?A.w_size-A.insert:be),A.block_start=A.strstart),A.high_water<A.strstart&&(A.high_water=A.strstart),Ae?ri:N!==Ee&&N!==Ke&&A.strm.avail_in===0&&A.strstart===A.block_start?ii:(J=A.window_size-A.strstart,A.strm.avail_in>J&&A.block_start>=A.w_size&&(A.block_start-=A.w_size,A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,J+=A.w_size,A.insert>A.strstart&&(A.insert=A.strstart)),J>A.strm.avail_in&&(J=A.strm.avail_in),J&&(Ii(A.strm,A.window,A.strstart,J),A.strstart+=J,A.insert+=J>A.w_size-A.insert?A.w_size-A.insert:J),A.high_water<A.strstart&&(A.high_water=A.strstart),J=A.bi_valid+42>>3,J=A.pending_buf_size-J>65535?65535:A.pending_buf_size-J,T=J>A.w_size?A.w_size:J,ee=A.strstart-A.block_start,(ee>=T||(ee||N===Ke)&&N!==Ee&&A.strm.avail_in===0&&ee<=J)&&(Y=ee>J?J:ee,Ae=N===Ke&&A.strm.avail_in===0&&Y===ee?1:0,se(A,A.block_start,Y,Ae),A.block_start+=Y,Ft(A.strm)),Ae?Zt:Rt)},zi=(A,N)=>{let T,Y;for(;;){if(A.lookahead<Ut){if(ni(A),A.lookahead<Ut&&N===Ee)return Rt;if(A.lookahead===0)break}if(T=0,A.lookahead>=ot&&(A.ins_h=jt(A,A.ins_h,A.window[A.strstart+ot-1]),T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),T!==0&&A.strstart-T<=A.w_size-Ut&&(A.match_length=Yi(A,T)),A.match_length>=ot)if(Y=Fe(A,A.strstart-A.match_start,A.match_length-ot),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=ot){A.match_length--;do A.strstart++,A.ins_h=jt(A,A.ins_h,A.window[A.strstart+ot-1]),T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart;while(--A.match_length!==0);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=jt(A,A.ins_h,A.window[A.strstart+1]);else Y=Fe(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(Y&&(It(A,!1),A.strm.avail_out===0))return Rt}return A.insert=A.strstart<ot-1?A.strstart:ot-1,N===Ke?(It(A,!0),A.strm.avail_out===0?Zt:ri):A.sym_next&&(It(A,!1),A.strm.avail_out===0)?Rt:ii},si=(A,N)=>{let T,Y,ee;for(;;){if(A.lookahead<Ut){if(ni(A),A.lookahead<Ut&&N===Ee)return Rt;if(A.lookahead===0)break}if(T=0,A.lookahead>=ot&&(A.ins_h=jt(A,A.ins_h,A.window[A.strstart+ot-1]),T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=ot-1,T!==0&&A.prev_length<A.max_lazy_match&&A.strstart-T<=A.w_size-Ut&&(A.match_length=Yi(A,T),A.match_length<=5&&(A.strategy===ht||A.match_length===ot&&A.strstart-A.match_start>4096)&&(A.match_length=ot-1)),A.prev_length>=ot&&A.match_length<=A.prev_length){ee=A.strstart+A.lookahead-ot,Y=Fe(A,A.strstart-1-A.prev_match,A.prev_length-ot),A.lookahead-=A.prev_length-1,A.prev_length-=2;do++A.strstart<=ee&&(A.ins_h=jt(A,A.ins_h,A.window[A.strstart+ot-1]),T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart);while(--A.prev_length!==0);if(A.match_available=0,A.match_length=ot-1,A.strstart++,Y&&(It(A,!1),A.strm.avail_out===0))return Rt}else if(A.match_available){if(Y=Fe(A,0,A.window[A.strstart-1]),Y&&It(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return Rt}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(Y=Fe(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<ot-1?A.strstart:ot-1,N===Ke?(It(A,!0),A.strm.avail_out===0?Zt:ri):A.sym_next&&(It(A,!1),A.strm.avail_out===0)?Rt:ii},nn=(A,N)=>{let T,Y,ee,J;const Ae=A.window;for(;;){if(A.lookahead<=Pt){if(ni(A),A.lookahead<=Pt&&N===Ee)return Rt;if(A.lookahead===0)break}if(A.match_length=0,A.lookahead>=ot&&A.strstart>0&&(ee=A.strstart-1,Y=Ae[ee],Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee])){J=A.strstart+Pt;do;while(Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&Y===Ae[++ee]&&ee<J);A.match_length=Pt-(J-ee),A.match_length>A.lookahead&&(A.match_length=A.lookahead)}if(A.match_length>=ot?(T=Fe(A,1,A.match_length-ot),A.lookahead-=A.match_length,A.strstart+=A.match_length,A.match_length=0):(T=Fe(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++),T&&(It(A,!1),A.strm.avail_out===0))return Rt}return A.insert=0,N===Ke?(It(A,!0),A.strm.avail_out===0?Zt:ri):A.sym_next&&(It(A,!1),A.strm.avail_out===0)?Rt:ii},sn=(A,N)=>{let T;for(;;){if(A.lookahead===0&&(ni(A),A.lookahead===0)){if(N===Ee)return Rt;break}if(A.match_length=0,T=Fe(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++,T&&(It(A,!1),A.strm.avail_out===0))return Rt}return A.insert=0,N===Ke?(It(A,!0),A.strm.avail_out===0?Zt:ri):A.sym_next&&(It(A,!1),A.strm.avail_out===0)?Rt:ii};function Wt(A,N,T,Y,ee){this.good_length=A,this.max_lazy=N,this.nice_length=T,this.max_chain=Y,this.func=ee}const hi=[new Wt(0,0,0,0,Xi),new Wt(4,4,8,4,zi),new Wt(4,5,16,8,zi),new Wt(4,6,32,32,zi),new Wt(4,4,16,16,si),new Wt(8,16,32,32,si),new Wt(8,16,128,128,si),new Wt(8,32,128,256,si),new Wt(32,128,258,1024,si),new Wt(32,258,258,4096,si)],an=A=>{A.window_size=2*A.w_size,Ht(A.head),A.max_lazy_match=hi[A.level].max_lazy,A.good_match=hi[A.level].good_length,A.nice_match=hi[A.level].nice_length,A.max_chain_length=hi[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=ot-1,A.match_available=0,A.ins_h=0};function on(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ct,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Bt*2),this.dyn_dtree=new Uint16Array((2*xi+1)*2),this.bl_tree=new Uint16Array((2*Kt+1)*2),Ht(this.dyn_ltree),Ht(this.dyn_dtree),Ht(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Yt+1),this.heap=new Uint16Array(2*$t+1),Ht(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*$t+1),Ht(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ci=A=>{if(!A)return 1;const N=A.state;return!N||N.strm!==A||N.status!==ti&&N.status!==Oi&&N.status!==Pi&&N.status!==Li&&N.status!==Ri&&N.status!==Fi&&N.status!==Xt&&N.status!==oi?1:0},Zi=A=>{if(ci(A))return Qt(A,st);A.total_in=A.total_out=0,A.data_type=St;const N=A.state;return N.pending=0,N.pending_out=0,N.wrap<0&&(N.wrap=-N.wrap),N.status=N.wrap===2?Oi:N.wrap?ti:Xt,A.adler=N.wrap===2?0:1,N.last_flush=-2,$(N),Ye},Qi=A=>{const N=Zi(A);return N===Ye&&an(A.state),N},ln=(A,N)=>ci(A)||A.state.wrap!==2?st:(A.state.gzhead=N,Ye),Ji=(A,N,T,Y,ee,J)=>{if(!A)return st;let Ae=1;if(N===et&&(N=6),Y<0?(Ae=0,Y=-Y):Y>15&&(Ae=2,Y-=16),ee<1||ee>zt||T!==Ct||Y<8||Y>15||N<0||N>9||J<0||J>Dt||Y===8&&Ae!==1)return Qt(A,st);Y===8&&(Y=9);const be=new on;return A.state=be,be.strm=A,be.status=ti,be.wrap=Ae,be.gzhead=null,be.w_bits=Y,be.w_size=1<<be.w_bits,be.w_mask=be.w_size-1,be.hash_bits=ee+7,be.hash_size=1<<be.hash_bits,be.hash_mask=be.hash_size-1,be.hash_shift=~~((be.hash_bits+ot-1)/ot),be.window=new Uint8Array(be.w_size*2),be.head=new Uint16Array(be.hash_size),be.prev=new Uint16Array(be.w_size),be.lit_bufsize=1<<ee+6,be.pending_buf_size=be.lit_bufsize*4,be.pending_buf=new Uint8Array(be.pending_buf_size),be.sym_buf=be.lit_bufsize,be.sym_end=(be.lit_bufsize-1)*3,be.level=N,be.strategy=J,be.method=T,Qi(A)},hn=(A,N)=>Ji(A,N,Ct,Nt,Tt,Et),cn=(A,N)=>{if(ci(A)||N>Je||N<0)return A?Qt(A,st):st;const T=A.state;if(!A.output||A.avail_in!==0&&!A.input||T.status===oi&&N!==Ke)return Qt(A,A.avail_out===0?ut:st);const Y=T.last_flush;if(T.last_flush=N,T.pending!==0){if(Ft(A),A.avail_out===0)return T.last_flush=-1,Ye}else if(A.avail_in===0&&Ki(N)<=Ki(Y)&&N!==Ke)return Qt(A,ut);if(T.status===oi&&A.avail_in!==0)return Qt(A,ut);if(T.status===ti&&T.wrap===0&&(T.status=Xt),T.status===ti){let ee=Ct+(T.w_bits-8<<4)<<8,J=-1;if(T.strategy>=tt||T.level<2?J=0:T.level<6?J=1:T.level===6?J=2:J=3,ee|=J<<6,T.strstart!==0&&(ee|=en),ee+=31-ee%31,li(T,ee),T.strstart!==0&&(li(T,A.adler>>>16),li(T,A.adler&65535)),A.adler=1,T.status=Xt,Ft(A),T.pending!==0)return T.last_flush=-1,Ye}if(T.status===Oi){if(A.adler=0,mt(T,31),mt(T,139),mt(T,8),T.gzhead)mt(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),mt(T,T.gzhead.time&255),mt(T,T.gzhead.time>>8&255),mt(T,T.gzhead.time>>16&255),mt(T,T.gzhead.time>>24&255),mt(T,T.level===9?2:T.strategy>=tt||T.level<2?4:0),mt(T,T.gzhead.os&255),T.gzhead.extra&&T.gzhead.extra.length&&(mt(T,T.gzhead.extra.length&255),mt(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(A.adler=L(A.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=Pi;else if(mt(T,0),mt(T,0),mt(T,0),mt(T,0),mt(T,0),mt(T,T.level===9?2:T.strategy>=tt||T.level<2?4:0),mt(T,tn),T.status=Xt,Ft(A),T.pending!==0)return T.last_flush=-1,Ye}if(T.status===Pi){if(T.gzhead.extra){let ee=T.pending,J=(T.gzhead.extra.length&65535)-T.gzindex;for(;T.pending+J>T.pending_buf_size;){let be=T.pending_buf_size-T.pending;if(T.pending_buf.set(T.gzhead.extra.subarray(T.gzindex,T.gzindex+be),T.pending),T.pending=T.pending_buf_size,T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex+=be,Ft(A),T.pending!==0)return T.last_flush=-1,Ye;ee=0,J-=be}let Ae=new Uint8Array(T.gzhead.extra);T.pending_buf.set(Ae.subarray(T.gzindex,T.gzindex+J),T.pending),T.pending+=J,T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex=0}T.status=Li}if(T.status===Li){if(T.gzhead.name){let ee=T.pending,J;do{if(T.pending===T.pending_buf_size){if(T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee)),Ft(A),T.pending!==0)return T.last_flush=-1,Ye;ee=0}T.gzindex<T.gzhead.name.length?J=T.gzhead.name.charCodeAt(T.gzindex++)&255:J=0,mt(T,J)}while(J!==0);T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex=0}T.status=Ri}if(T.status===Ri){if(T.gzhead.comment){let ee=T.pending,J;do{if(T.pending===T.pending_buf_size){if(T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee)),Ft(A),T.pending!==0)return T.last_flush=-1,Ye;ee=0}T.gzindex<T.gzhead.comment.length?J=T.gzhead.comment.charCodeAt(T.gzindex++)&255:J=0,mt(T,J)}while(J!==0);T.gzhead.hcrc&&T.pending>ee&&(A.adler=L(A.adler,T.pending_buf,T.pending-ee,ee))}T.status=Fi}if(T.status===Fi){if(T.gzhead.hcrc){if(T.pending+2>T.pending_buf_size&&(Ft(A),T.pending!==0))return T.last_flush=-1,Ye;mt(T,A.adler&255),mt(T,A.adler>>8&255),A.adler=0}if(T.status=Xt,Ft(A),T.pending!==0)return T.last_flush=-1,Ye}if(A.avail_in!==0||T.lookahead!==0||N!==Ee&&T.status!==oi){let ee=T.level===0?Xi(T,N):T.strategy===tt?sn(T,N):T.strategy===bt?nn(T,N):hi[T.level].func(T,N);if((ee===Zt||ee===ri)&&(T.status=oi),ee===Rt||ee===Zt)return A.avail_out===0&&(T.last_flush=-1),Ye;if(ee===ii&&(N===$e?ke(T):N!==Je&&(se(T,0,0,!1),N===Xe&&(Ht(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),Ft(A),A.avail_out===0))return T.last_flush=-1,Ye}return N!==Ke?Ye:T.wrap<=0?nt:(T.wrap===2?(mt(T,A.adler&255),mt(T,A.adler>>8&255),mt(T,A.adler>>16&255),mt(T,A.adler>>24&255),mt(T,A.total_in&255),mt(T,A.total_in>>8&255),mt(T,A.total_in>>16&255),mt(T,A.total_in>>24&255)):(li(T,A.adler>>>16),li(T,A.adler&65535)),Ft(A),T.wrap>0&&(T.wrap=-T.wrap),T.pending!==0?Ye:nt)},un=A=>{if(ci(A))return st;const N=A.state.status;return A.state=null,N===Xt?Qt(A,_t):Ye},fn=(A,N)=>{let T=N.length;if(ci(A))return st;const Y=A.state,ee=Y.wrap;if(ee===2||ee===1&&Y.status!==ti||Y.lookahead)return st;if(ee===1&&(A.adler=me(A.adler,N,T,0)),Y.wrap=0,T>=Y.w_size){ee===0&&(Ht(Y.head),Y.strstart=0,Y.block_start=0,Y.insert=0);let qe=new Uint8Array(Y.w_size);qe.set(N.subarray(T-Y.w_size,T),0),N=qe,T=Y.w_size}const J=A.avail_in,Ae=A.next_in,be=A.input;for(A.avail_in=T,A.next_in=0,A.input=N,ni(Y);Y.lookahead>=ot;){let qe=Y.strstart,fe=Y.lookahead-(ot-1);do Y.ins_h=jt(Y,Y.ins_h,Y.window[qe+ot-1]),Y.prev[qe&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=qe,qe++;while(--fe);Y.strstart=qe,Y.lookahead=ot-1,ni(Y)}return Y.strstart+=Y.lookahead,Y.block_start=Y.strstart,Y.insert=Y.lookahead,Y.lookahead=0,Y.match_length=Y.prev_length=ot-1,Y.match_available=0,A.next_in=Ae,A.input=be,A.avail_in=J,Y.wrap=ee,Ye};var dn=hn,gn=Ji,_n=Qi,pn=Zi,mn=ln,vn=cn,xn=un,bn=fn,yn="pako deflate (from Nodeca project)",ui={deflateInit:dn,deflateInit2:gn,deflateReset:_n,deflateResetKeep:pn,deflateSetHeader:mn,deflate:vn,deflateEnd:xn,deflateSetDictionary:bn,deflateInfo:yn};const Dn=(A,N)=>Object.prototype.hasOwnProperty.call(A,N);var En=function(A){const N=Array.prototype.slice.call(arguments,1);for(;N.length;){const T=N.shift();if(T){if(typeof T!="object")throw new TypeError(T+"must be non-object");for(const Y in T)Dn(T,Y)&&(A[Y]=T[Y])}}return A},Cn=A=>{let N=0;for(let Y=0,ee=A.length;Y<ee;Y++)N+=A[Y].length;const T=new Uint8Array(N);for(let Y=0,ee=0,J=A.length;Y<J;Y++){let Ae=A[Y];T.set(Ae,ee),ee+=Ae.length}return T},bi={assign:En,flattenChunks:Cn};let qi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{qi=!1}const fi=new Uint8Array(256);for(let A=0;A<256;A++)fi[A]=A>=252?6:A>=248?5:A>=240?4:A>=224?3:A>=192?2:1;fi[254]=fi[254]=1;var wn=A=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(A);let N,T,Y,ee,J,Ae=A.length,be=0;for(ee=0;ee<Ae;ee++)T=A.charCodeAt(ee),(T&64512)===55296&&ee+1<Ae&&(Y=A.charCodeAt(ee+1),(Y&64512)===56320&&(T=65536+(T-55296<<10)+(Y-56320),ee++)),be+=T<128?1:T<2048?2:T<65536?3:4;for(N=new Uint8Array(be),J=0,ee=0;J<be;ee++)T=A.charCodeAt(ee),(T&64512)===55296&&ee+1<Ae&&(Y=A.charCodeAt(ee+1),(Y&64512)===56320&&(T=65536+(T-55296<<10)+(Y-56320),ee++)),T<128?N[J++]=T:T<2048?(N[J++]=192|T>>>6,N[J++]=128|T&63):T<65536?(N[J++]=224|T>>>12,N[J++]=128|T>>>6&63,N[J++]=128|T&63):(N[J++]=240|T>>>18,N[J++]=128|T>>>12&63,N[J++]=128|T>>>6&63,N[J++]=128|T&63);return N};const An=(A,N)=>{if(N<65534&&A.subarray&&qi)return String.fromCharCode.apply(null,A.length===N?A:A.subarray(0,N));let T="";for(let Y=0;Y<N;Y++)T+=String.fromCharCode(A[Y]);return T};var Mn=(A,N)=>{const T=N||A.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(A.subarray(0,N));let Y,ee;const J=new Array(T*2);for(ee=0,Y=0;Y<T;){let Ae=A[Y++];if(Ae<128){J[ee++]=Ae;continue}let be=fi[Ae];if(be>4){J[ee++]=65533,Y+=be-1;continue}for(Ae&=be===2?31:be===3?15:7;be>1&&Y<T;)Ae=Ae<<6|A[Y++]&63,be--;if(be>1){J[ee++]=65533;continue}Ae<65536?J[ee++]=Ae:(Ae-=65536,J[ee++]=55296|Ae>>10&1023,J[ee++]=56320|Ae&1023)}return An(J,ee)},Sn=(A,N)=>{N=N||A.length,N>A.length&&(N=A.length);let T=N-1;for(;T>=0&&(A[T]&192)===128;)T--;return T<0||T===0?N:T+fi[A[T]]>N?T:N},di={string2buf:wn,buf2string:Mn,utf8border:Sn};function Tn(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var er=Tn;const tr=Object.prototype.toString,{Z_NO_FLUSH:On,Z_SYNC_FLUSH:Pn,Z_FULL_FLUSH:Ln,Z_FINISH:Rn,Z_OK:yi,Z_STREAM_END:Fn,Z_DEFAULT_COMPRESSION:In,Z_DEFAULT_STRATEGY:zn,Z_DEFLATED:Bn}=de;function gi(A){this.options=bi.assign({level:In,method:Bn,chunkSize:16384,windowBits:15,memLevel:8,strategy:zn},A||{});let N=this.options;N.raw&&N.windowBits>0?N.windowBits=-N.windowBits:N.gzip&&N.windowBits>0&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new er,this.strm.avail_out=0;let T=ui.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(T!==yi)throw new Error(ge[T]);if(N.header&&ui.deflateSetHeader(this.strm,N.header),N.dictionary){let Y;if(typeof N.dictionary=="string"?Y=di.string2buf(N.dictionary):tr.call(N.dictionary)==="[object ArrayBuffer]"?Y=new Uint8Array(N.dictionary):Y=N.dictionary,T=ui.deflateSetDictionary(this.strm,Y),T!==yi)throw new Error(ge[T]);this._dict_set=!0}}gi.prototype.push=function(A,N){const T=this.strm,Y=this.options.chunkSize;let ee,J;if(this.ended)return!1;for(N===~~N?J=N:J=N===!0?Rn:On,typeof A=="string"?T.input=di.string2buf(A):tr.call(A)==="[object ArrayBuffer]"?T.input=new Uint8Array(A):T.input=A,T.next_in=0,T.avail_in=T.input.length;;){if(T.avail_out===0&&(T.output=new Uint8Array(Y),T.next_out=0,T.avail_out=Y),(J===Pn||J===Ln)&&T.avail_out<=6){this.onData(T.output.subarray(0,T.next_out)),T.avail_out=0;continue}if(ee=ui.deflate(T,J),ee===Fn)return T.next_out>0&&this.onData(T.output.subarray(0,T.next_out)),ee=ui.deflateEnd(this.strm),this.onEnd(ee),this.ended=!0,ee===yi;if(T.avail_out===0){this.onData(T.output);continue}if(J>0&&T.next_out>0){this.onData(T.output.subarray(0,T.next_out)),T.avail_out=0;continue}if(T.avail_in===0)break}return!0},gi.prototype.onData=function(A){this.chunks.push(A)},gi.prototype.onEnd=function(A){A===yi&&(this.result=bi.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function Bi(A,N){const T=new gi(N);if(T.push(A,!0),T.err)throw T.msg||ge[T.err];return T.result}function kn(A,N){return N=N||{},N.raw=!0,Bi(A,N)}function Un(A,N){return N=N||{},N.gzip=!0,Bi(A,N)}var Wn=gi,Nn=Bi,Gn=kn,Vn=Un,Hn={Deflate:Wn,deflate:Nn,deflateRaw:Gn,gzip:Vn};const Di=16209,jn=16191;var $n=function(N,T){let Y,ee,J,Ae,be,qe,fe,Me,pt,Qe,Ve,it,Mt,dt,lt,xt,ct,Ze,vt,Ot,rt,yt,gt,at;const ft=N.state;Y=N.next_in,gt=N.input,ee=Y+(N.avail_in-5),J=N.next_out,at=N.output,Ae=J-(T-N.avail_out),be=J+(N.avail_out-257),qe=ft.dmax,fe=ft.wsize,Me=ft.whave,pt=ft.wnext,Qe=ft.window,Ve=ft.hold,it=ft.bits,Mt=ft.lencode,dt=ft.distcode,lt=(1<<ft.lenbits)-1,xt=(1<<ft.distbits)-1;e:do{it<15&&(Ve+=gt[Y++]<<it,it+=8,Ve+=gt[Y++]<<it,it+=8),ct=Mt[Ve&lt];t:for(;;){if(Ze=ct>>>24,Ve>>>=Ze,it-=Ze,Ze=ct>>>16&255,Ze===0)at[J++]=ct&65535;else if(Ze&16){vt=ct&65535,Ze&=15,Ze&&(it<Ze&&(Ve+=gt[Y++]<<it,it+=8),vt+=Ve&(1<<Ze)-1,Ve>>>=Ze,it-=Ze),it<15&&(Ve+=gt[Y++]<<it,it+=8,Ve+=gt[Y++]<<it,it+=8),ct=dt[Ve&xt];i:for(;;){if(Ze=ct>>>24,Ve>>>=Ze,it-=Ze,Ze=ct>>>16&255,Ze&16){if(Ot=ct&65535,Ze&=15,it<Ze&&(Ve+=gt[Y++]<<it,it+=8,it<Ze&&(Ve+=gt[Y++]<<it,it+=8)),Ot+=Ve&(1<<Ze)-1,Ot>qe){N.msg="invalid distance too far back",ft.mode=Di;break e}if(Ve>>>=Ze,it-=Ze,Ze=J-Ae,Ot>Ze){if(Ze=Ot-Ze,Ze>Me&&ft.sane){N.msg="invalid distance too far back",ft.mode=Di;break e}if(rt=0,yt=Qe,pt===0){if(rt+=fe-Ze,Ze<vt){vt-=Ze;do at[J++]=Qe[rt++];while(--Ze);rt=J-Ot,yt=at}}else if(pt<Ze){if(rt+=fe+pt-Ze,Ze-=pt,Ze<vt){vt-=Ze;do at[J++]=Qe[rt++];while(--Ze);if(rt=0,pt<vt){Ze=pt,vt-=Ze;do at[J++]=Qe[rt++];while(--Ze);rt=J-Ot,yt=at}}}else if(rt+=pt-Ze,Ze<vt){vt-=Ze;do at[J++]=Qe[rt++];while(--Ze);rt=J-Ot,yt=at}for(;vt>2;)at[J++]=yt[rt++],at[J++]=yt[rt++],at[J++]=yt[rt++],vt-=3;vt&&(at[J++]=yt[rt++],vt>1&&(at[J++]=yt[rt++]))}else{rt=J-Ot;do at[J++]=at[rt++],at[J++]=at[rt++],at[J++]=at[rt++],vt-=3;while(vt>2);vt&&(at[J++]=at[rt++],vt>1&&(at[J++]=at[rt++]))}}else if((Ze&64)===0){ct=dt[(ct&65535)+(Ve&(1<<Ze)-1)];continue i}else{N.msg="invalid distance code",ft.mode=Di;break e}break}}else if((Ze&64)===0){ct=Mt[(ct&65535)+(Ve&(1<<Ze)-1)];continue t}else if(Ze&32){ft.mode=jn;break e}else{N.msg="invalid literal/length code",ft.mode=Di;break e}break}}while(Y<ee&&J<be);vt=it>>3,Y-=vt,it-=vt<<3,Ve&=(1<<it)-1,N.next_in=Y,N.next_out=J,N.avail_in=Y<ee?5+(ee-Y):5-(Y-ee),N.avail_out=J<be?257+(be-J):257-(J-be),ft.hold=Ve,ft.bits=it};const ai=15,ir=852,rr=592,nr=0,ki=1,sr=2,Kn=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Yn=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Xn=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Zn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var pi=(A,N,T,Y,ee,J,Ae,be)=>{const qe=be.bits;let fe=0,Me=0,pt=0,Qe=0,Ve=0,it=0,Mt=0,dt=0,lt=0,xt=0,ct,Ze,vt,Ot,rt,yt=null,gt;const at=new Uint16Array(ai+1),ft=new Uint16Array(ai+1);let ei=null,qr,Si,Ti;for(fe=0;fe<=ai;fe++)at[fe]=0;for(Me=0;Me<Y;Me++)at[N[T+Me]]++;for(Ve=qe,Qe=ai;Qe>=1&&at[Qe]===0;Qe--);if(Ve>Qe&&(Ve=Qe),Qe===0)return ee[J++]=1<<24|64<<16|0,ee[J++]=1<<24|64<<16|0,be.bits=1,0;for(pt=1;pt<Qe&&at[pt]===0;pt++);for(Ve<pt&&(Ve=pt),dt=1,fe=1;fe<=ai;fe++)if(dt<<=1,dt-=at[fe],dt<0)return-1;if(dt>0&&(A===nr||Qe!==1))return-1;for(ft[1]=0,fe=1;fe<ai;fe++)ft[fe+1]=ft[fe]+at[fe];for(Me=0;Me<Y;Me++)N[T+Me]!==0&&(Ae[ft[N[T+Me]]++]=Me);if(A===nr?(yt=ei=Ae,gt=20):A===ki?(yt=Kn,ei=Yn,gt=257):(yt=Xn,ei=Zn,gt=0),xt=0,Me=0,fe=pt,rt=J,it=Ve,Mt=0,vt=-1,lt=1<<Ve,Ot=lt-1,A===ki&&lt>ir||A===sr&&lt>rr)return 1;for(;;){qr=fe-Mt,Ae[Me]+1<gt?(Si=0,Ti=Ae[Me]):Ae[Me]>=gt?(Si=ei[Ae[Me]-gt],Ti=yt[Ae[Me]-gt]):(Si=96,Ti=0),ct=1<<fe-Mt,Ze=1<<it,pt=Ze;do Ze-=ct,ee[rt+(xt>>Mt)+Ze]=qr<<24|Si<<16|Ti|0;while(Ze!==0);for(ct=1<<fe-1;xt&ct;)ct>>=1;if(ct!==0?(xt&=ct-1,xt+=ct):xt=0,Me++,--at[fe]===0){if(fe===Qe)break;fe=N[T+Ae[Me]]}if(fe>Ve&&(xt&Ot)!==vt){for(Mt===0&&(Mt=Ve),rt+=pt,it=fe-Mt,dt=1<<it;it+Mt<Qe&&(dt-=at[it+Mt],!(dt<=0));)it++,dt<<=1;if(lt+=1<<it,A===ki&&lt>ir||A===sr&&lt>rr)return 1;vt=xt&Ot,ee[vt]=Ve<<24|it<<16|rt-J|0}}return xt!==0&&(ee[rt+xt]=fe-Mt<<24|64<<16|0),be.bits=Ve,0};const Qn=0,ar=1,or=2,{Z_FINISH:lr,Z_BLOCK:Jn,Z_TREES:Ei,Z_OK:Jt,Z_STREAM_END:qn,Z_NEED_DICT:es,Z_STREAM_ERROR:kt,Z_DATA_ERROR:hr,Z_MEM_ERROR:cr,Z_BUF_ERROR:ts,Z_DEFLATED:ur}=de,Ci=16180,fr=16181,dr=16182,gr=16183,_r=16184,pr=16185,mr=16186,vr=16187,xr=16188,br=16189,wi=16190,Gt=16191,Ui=16192,yr=16193,Wi=16194,Dr=16195,Er=16196,Cr=16197,wr=16198,Ai=16199,Mi=16200,Ar=16201,Mr=16202,Sr=16203,Tr=16204,Or=16205,Ni=16206,Pr=16207,Lr=16208,At=16209,Rr=16210,Fr=16211,is=852,rs=592,ns=15,Ir=A=>(A>>>24&255)+(A>>>8&65280)+((A&65280)<<8)+((A&255)<<24);function ss(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qt=A=>{if(!A)return 1;const N=A.state;return!N||N.strm!==A||N.mode<Ci||N.mode>Fr?1:0},zr=A=>{if(qt(A))return kt;const N=A.state;return A.total_in=A.total_out=N.total=0,A.msg="",N.wrap&&(A.adler=N.wrap&1),N.mode=Ci,N.last=0,N.havedict=0,N.flags=-1,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new Int32Array(is),N.distcode=N.distdyn=new Int32Array(rs),N.sane=1,N.back=-1,Jt},Br=A=>{if(qt(A))return kt;const N=A.state;return N.wsize=0,N.whave=0,N.wnext=0,zr(A)},kr=(A,N)=>{let T;if(qt(A))return kt;const Y=A.state;return N<0?(T=0,N=-N):(T=(N>>4)+5,N<48&&(N&=15)),N&&(N<8||N>15)?kt:(Y.window!==null&&Y.wbits!==N&&(Y.window=null),Y.wrap=T,Y.wbits=N,Br(A))},Ur=(A,N)=>{if(!A)return kt;const T=new ss;A.state=T,T.strm=A,T.window=null,T.mode=Ci;const Y=kr(A,N);return Y!==Jt&&(A.state=null),Y},as=A=>Ur(A,ns);let Wr=!0,Gi,Vi;const os=A=>{if(Wr){Gi=new Int32Array(512),Vi=new Int32Array(32);let N=0;for(;N<144;)A.lens[N++]=8;for(;N<256;)A.lens[N++]=9;for(;N<280;)A.lens[N++]=7;for(;N<288;)A.lens[N++]=8;for(pi(ar,A.lens,0,288,Gi,0,A.work,{bits:9}),N=0;N<32;)A.lens[N++]=5;pi(or,A.lens,0,32,Vi,0,A.work,{bits:5}),Wr=!1}A.lencode=Gi,A.lenbits=9,A.distcode=Vi,A.distbits=5},Nr=(A,N,T,Y)=>{let ee;const J=A.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new Uint8Array(J.wsize)),Y>=J.wsize?(J.window.set(N.subarray(T-J.wsize,T),0),J.wnext=0,J.whave=J.wsize):(ee=J.wsize-J.wnext,ee>Y&&(ee=Y),J.window.set(N.subarray(T-Y,T-Y+ee),J.wnext),Y-=ee,Y?(J.window.set(N.subarray(T-Y,T),0),J.wnext=Y,J.whave=J.wsize):(J.wnext+=ee,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=ee))),0},ls=(A,N)=>{let T,Y,ee,J,Ae,be,qe,fe,Me,pt,Qe,Ve,it,Mt,dt=0,lt,xt,ct,Ze,vt,Ot,rt,yt;const gt=new Uint8Array(4);let at,ft;const ei=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qt(A)||!A.output||!A.input&&A.avail_in!==0)return kt;T=A.state,T.mode===Gt&&(T.mode=Ui),Ae=A.next_out,ee=A.output,qe=A.avail_out,J=A.next_in,Y=A.input,be=A.avail_in,fe=T.hold,Me=T.bits,pt=be,Qe=qe,yt=Jt;e:for(;;)switch(T.mode){case Ci:if(T.wrap===0){T.mode=Ui;break}for(;Me<16;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(T.wrap&2&&fe===35615){T.wbits===0&&(T.wbits=15),T.check=0,gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0),fe=0,Me=0,T.mode=fr;break}if(T.head&&(T.head.done=!1),!(T.wrap&1)||(((fe&255)<<8)+(fe>>8))%31){A.msg="incorrect header check",T.mode=At;break}if((fe&15)!==ur){A.msg="unknown compression method",T.mode=At;break}if(fe>>>=4,Me-=4,rt=(fe&15)+8,T.wbits===0&&(T.wbits=rt),rt>15||rt>T.wbits){A.msg="invalid window size",T.mode=At;break}T.dmax=1<<T.wbits,T.flags=0,A.adler=T.check=1,T.mode=fe&512?br:Gt,fe=0,Me=0;break;case fr:for(;Me<16;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(T.flags=fe,(T.flags&255)!==ur){A.msg="unknown compression method",T.mode=At;break}if(T.flags&57344){A.msg="unknown header flags set",T.mode=At;break}T.head&&(T.head.text=fe>>8&1),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Me=0,T.mode=dr;case dr:for(;Me<32;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.head&&(T.head.time=fe),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,gt[2]=fe>>>16&255,gt[3]=fe>>>24&255,T.check=L(T.check,gt,4,0)),fe=0,Me=0,T.mode=gr;case gr:for(;Me<16;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.head&&(T.head.xflags=fe&255,T.head.os=fe>>8),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Me=0,T.mode=_r;case _r:if(T.flags&1024){for(;Me<16;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.length=fe,T.head&&(T.head.extra_len=fe),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Me=0}else T.head&&(T.head.extra=null);T.mode=pr;case pr:if(T.flags&1024&&(Ve=T.length,Ve>be&&(Ve=be),Ve&&(T.head&&(rt=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Uint8Array(T.head.extra_len)),T.head.extra.set(Y.subarray(J,J+Ve),rt)),T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ve,J)),be-=Ve,J+=Ve,T.length-=Ve),T.length))break e;T.length=0,T.mode=mr;case mr:if(T.flags&2048){if(be===0)break e;Ve=0;do rt=Y[J+Ve++],T.head&&rt&&T.length<65536&&(T.head.name+=String.fromCharCode(rt));while(rt&&Ve<be);if(T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ve,J)),be-=Ve,J+=Ve,rt)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=vr;case vr:if(T.flags&4096){if(be===0)break e;Ve=0;do rt=Y[J+Ve++],T.head&&rt&&T.length<65536&&(T.head.comment+=String.fromCharCode(rt));while(rt&&Ve<be);if(T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ve,J)),be-=Ve,J+=Ve,rt)break e}else T.head&&(T.head.comment=null);T.mode=xr;case xr:if(T.flags&512){for(;Me<16;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(T.wrap&4&&fe!==(T.check&65535)){A.msg="header crc mismatch",T.mode=At;break}fe=0,Me=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),A.adler=T.check=0,T.mode=Gt;break;case br:for(;Me<32;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}A.adler=T.check=Ir(fe),fe=0,Me=0,T.mode=wi;case wi:if(T.havedict===0)return A.next_out=Ae,A.avail_out=qe,A.next_in=J,A.avail_in=be,T.hold=fe,T.bits=Me,es;A.adler=T.check=1,T.mode=Gt;case Gt:if(N===Jn||N===Ei)break e;case Ui:if(T.last){fe>>>=Me&7,Me-=Me&7,T.mode=Ni;break}for(;Me<3;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}switch(T.last=fe&1,fe>>>=1,Me-=1,fe&3){case 0:T.mode=yr;break;case 1:if(os(T),T.mode=Ai,N===Ei){fe>>>=2,Me-=2;break e}break;case 2:T.mode=Er;break;case 3:A.msg="invalid block type",T.mode=At}fe>>>=2,Me-=2;break;case yr:for(fe>>>=Me&7,Me-=Me&7;Me<32;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if((fe&65535)!==(fe>>>16^65535)){A.msg="invalid stored block lengths",T.mode=At;break}if(T.length=fe&65535,fe=0,Me=0,T.mode=Wi,N===Ei)break e;case Wi:T.mode=Dr;case Dr:if(Ve=T.length,Ve){if(Ve>be&&(Ve=be),Ve>qe&&(Ve=qe),Ve===0)break e;ee.set(Y.subarray(J,J+Ve),Ae),be-=Ve,J+=Ve,qe-=Ve,Ae+=Ve,T.length-=Ve;break}T.mode=Gt;break;case Er:for(;Me<14;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(T.nlen=(fe&31)+257,fe>>>=5,Me-=5,T.ndist=(fe&31)+1,fe>>>=5,Me-=5,T.ncode=(fe&15)+4,fe>>>=4,Me-=4,T.nlen>286||T.ndist>30){A.msg="too many length or distance symbols",T.mode=At;break}T.have=0,T.mode=Cr;case Cr:for(;T.have<T.ncode;){for(;Me<3;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.lens[ei[T.have++]]=fe&7,fe>>>=3,Me-=3}for(;T.have<19;)T.lens[ei[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,at={bits:T.lenbits},yt=pi(Qn,T.lens,0,19,T.lencode,0,T.work,at),T.lenbits=at.bits,yt){A.msg="invalid code lengths set",T.mode=At;break}T.have=0,T.mode=wr;case wr:for(;T.have<T.nlen+T.ndist;){for(;dt=T.lencode[fe&(1<<T.lenbits)-1],lt=dt>>>24,xt=dt>>>16&255,ct=dt&65535,!(lt<=Me);){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(ct<16)fe>>>=lt,Me-=lt,T.lens[T.have++]=ct;else{if(ct===16){for(ft=lt+2;Me<ft;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(fe>>>=lt,Me-=lt,T.have===0){A.msg="invalid bit length repeat",T.mode=At;break}rt=T.lens[T.have-1],Ve=3+(fe&3),fe>>>=2,Me-=2}else if(ct===17){for(ft=lt+3;Me<ft;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}fe>>>=lt,Me-=lt,rt=0,Ve=3+(fe&7),fe>>>=3,Me-=3}else{for(ft=lt+7;Me<ft;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}fe>>>=lt,Me-=lt,rt=0,Ve=11+(fe&127),fe>>>=7,Me-=7}if(T.have+Ve>T.nlen+T.ndist){A.msg="invalid bit length repeat",T.mode=At;break}for(;Ve--;)T.lens[T.have++]=rt}}if(T.mode===At)break;if(T.lens[256]===0){A.msg="invalid code -- missing end-of-block",T.mode=At;break}if(T.lenbits=9,at={bits:T.lenbits},yt=pi(ar,T.lens,0,T.nlen,T.lencode,0,T.work,at),T.lenbits=at.bits,yt){A.msg="invalid literal/lengths set",T.mode=At;break}if(T.distbits=6,T.distcode=T.distdyn,at={bits:T.distbits},yt=pi(or,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,at),T.distbits=at.bits,yt){A.msg="invalid distances set",T.mode=At;break}if(T.mode=Ai,N===Ei)break e;case Ai:T.mode=Mi;case Mi:if(be>=6&&qe>=258){A.next_out=Ae,A.avail_out=qe,A.next_in=J,A.avail_in=be,T.hold=fe,T.bits=Me,$n(A,Qe),Ae=A.next_out,ee=A.output,qe=A.avail_out,J=A.next_in,Y=A.input,be=A.avail_in,fe=T.hold,Me=T.bits,T.mode===Gt&&(T.back=-1);break}for(T.back=0;dt=T.lencode[fe&(1<<T.lenbits)-1],lt=dt>>>24,xt=dt>>>16&255,ct=dt&65535,!(lt<=Me);){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(xt&&(xt&240)===0){for(Ze=lt,vt=xt,Ot=ct;dt=T.lencode[Ot+((fe&(1<<Ze+vt)-1)>>Ze)],lt=dt>>>24,xt=dt>>>16&255,ct=dt&65535,!(Ze+lt<=Me);){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}fe>>>=Ze,Me-=Ze,T.back+=Ze}if(fe>>>=lt,Me-=lt,T.back+=lt,T.length=ct,xt===0){T.mode=Or;break}if(xt&32){T.back=-1,T.mode=Gt;break}if(xt&64){A.msg="invalid literal/length code",T.mode=At;break}T.extra=xt&15,T.mode=Ar;case Ar:if(T.extra){for(ft=T.extra;Me<ft;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.length+=fe&(1<<T.extra)-1,fe>>>=T.extra,Me-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=Mr;case Mr:for(;dt=T.distcode[fe&(1<<T.distbits)-1],lt=dt>>>24,xt=dt>>>16&255,ct=dt&65535,!(lt<=Me);){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if((xt&240)===0){for(Ze=lt,vt=xt,Ot=ct;dt=T.distcode[Ot+((fe&(1<<Ze+vt)-1)>>Ze)],lt=dt>>>24,xt=dt>>>16&255,ct=dt&65535,!(Ze+lt<=Me);){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}fe>>>=Ze,Me-=Ze,T.back+=Ze}if(fe>>>=lt,Me-=lt,T.back+=lt,xt&64){A.msg="invalid distance code",T.mode=At;break}T.offset=ct,T.extra=xt&15,T.mode=Sr;case Sr:if(T.extra){for(ft=T.extra;Me<ft;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}T.offset+=fe&(1<<T.extra)-1,fe>>>=T.extra,Me-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){A.msg="invalid distance too far back",T.mode=At;break}T.mode=Tr;case Tr:if(qe===0)break e;if(Ve=Qe-qe,T.offset>Ve){if(Ve=T.offset-Ve,Ve>T.whave&&T.sane){A.msg="invalid distance too far back",T.mode=At;break}Ve>T.wnext?(Ve-=T.wnext,it=T.wsize-Ve):it=T.wnext-Ve,Ve>T.length&&(Ve=T.length),Mt=T.window}else Mt=ee,it=Ae-T.offset,Ve=T.length;Ve>qe&&(Ve=qe),qe-=Ve,T.length-=Ve;do ee[Ae++]=Mt[it++];while(--Ve);T.length===0&&(T.mode=Mi);break;case Or:if(qe===0)break e;ee[Ae++]=T.length,qe--,T.mode=Mi;break;case Ni:if(T.wrap){for(;Me<32;){if(be===0)break e;be--,fe|=Y[J++]<<Me,Me+=8}if(Qe-=qe,A.total_out+=Qe,T.total+=Qe,T.wrap&4&&Qe&&(A.adler=T.check=T.flags?L(T.check,ee,Qe,Ae-Qe):me(T.check,ee,Qe,Ae-Qe)),Qe=qe,T.wrap&4&&(T.flags?fe:Ir(fe))!==T.check){A.msg="incorrect data check",T.mode=At;break}fe=0,Me=0}T.mode=Pr;case Pr:if(T.wrap&&T.flags){for(;Me<32;){if(be===0)break e;be--,fe+=Y[J++]<<Me,Me+=8}if(T.wrap&4&&fe!==(T.total&4294967295)){A.msg="incorrect length check",T.mode=At;break}fe=0,Me=0}T.mode=Lr;case Lr:yt=qn;break e;case At:yt=hr;break e;case Rr:return cr;case Fr:default:return kt}return A.next_out=Ae,A.avail_out=qe,A.next_in=J,A.avail_in=be,T.hold=fe,T.bits=Me,(T.wsize||Qe!==A.avail_out&&T.mode<At&&(T.mode<Ni||N!==lr))&&Nr(A,A.output,A.next_out,Qe-A.avail_out),pt-=A.avail_in,Qe-=A.avail_out,A.total_in+=pt,A.total_out+=Qe,T.total+=Qe,T.wrap&4&&Qe&&(A.adler=T.check=T.flags?L(T.check,ee,Qe,A.next_out-Qe):me(T.check,ee,Qe,A.next_out-Qe)),A.data_type=T.bits+(T.last?64:0)+(T.mode===Gt?128:0)+(T.mode===Ai||T.mode===Wi?256:0),(pt===0&&Qe===0||N===lr)&&yt===Jt&&(yt=ts),yt},hs=A=>{if(qt(A))return kt;let N=A.state;return N.window&&(N.window=null),A.state=null,Jt},cs=(A,N)=>{if(qt(A))return kt;const T=A.state;return(T.wrap&2)===0?kt:(T.head=N,N.done=!1,Jt)},us=(A,N)=>{const T=N.length;let Y,ee,J;return qt(A)||(Y=A.state,Y.wrap!==0&&Y.mode!==wi)?kt:Y.mode===wi&&(ee=1,ee=me(ee,N,T,0),ee!==Y.check)?hr:(J=Nr(A,N,T,T),J?(Y.mode=Rr,cr):(Y.havedict=1,Jt))};var fs=Br,ds=kr,gs=zr,_s=as,ps=Ur,ms=ls,vs=hs,xs=cs,bs=us,ys="pako inflate (from Nodeca project)",Vt={inflateReset:fs,inflateReset2:ds,inflateResetKeep:gs,inflateInit:_s,inflateInit2:ps,inflate:ms,inflateEnd:vs,inflateGetHeader:xs,inflateSetDictionary:bs,inflateInfo:ys};function Ds(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Es=Ds;const Gr=Object.prototype.toString,{Z_NO_FLUSH:Cs,Z_FINISH:ws,Z_OK:mi,Z_STREAM_END:Hi,Z_NEED_DICT:ji,Z_STREAM_ERROR:As,Z_DATA_ERROR:Vr,Z_MEM_ERROR:Ms}=de;function vi(A){this.options=bi.assign({chunkSize:65536,windowBits:15,to:""},A||{});const N=this.options;N.raw&&N.windowBits>=0&&N.windowBits<16&&(N.windowBits=-N.windowBits,N.windowBits===0&&(N.windowBits=-15)),N.windowBits>=0&&N.windowBits<16&&!(A&&A.windowBits)&&(N.windowBits+=32),N.windowBits>15&&N.windowBits<48&&(N.windowBits&15)===0&&(N.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new er,this.strm.avail_out=0;let T=Vt.inflateInit2(this.strm,N.windowBits);if(T!==mi)throw new Error(ge[T]);if(this.header=new Es,Vt.inflateGetHeader(this.strm,this.header),N.dictionary&&(typeof N.dictionary=="string"?N.dictionary=di.string2buf(N.dictionary):Gr.call(N.dictionary)==="[object ArrayBuffer]"&&(N.dictionary=new Uint8Array(N.dictionary)),N.raw&&(T=Vt.inflateSetDictionary(this.strm,N.dictionary),T!==mi)))throw new Error(ge[T])}vi.prototype.push=function(A,N){const T=this.strm,Y=this.options.chunkSize,ee=this.options.dictionary;let J,Ae,be;if(this.ended)return!1;for(N===~~N?Ae=N:Ae=N===!0?ws:Cs,Gr.call(A)==="[object ArrayBuffer]"?T.input=new Uint8Array(A):T.input=A,T.next_in=0,T.avail_in=T.input.length;;){for(T.avail_out===0&&(T.output=new Uint8Array(Y),T.next_out=0,T.avail_out=Y),J=Vt.inflate(T,Ae),J===ji&&ee&&(J=Vt.inflateSetDictionary(T,ee),J===mi?J=Vt.inflate(T,Ae):J===Vr&&(J=ji));T.avail_in>0&&J===Hi&&T.state.wrap>0&&A[T.next_in]!==0;)Vt.inflateReset(T),J=Vt.inflate(T,Ae);switch(J){case As:case Vr:case ji:case Ms:return this.onEnd(J),this.ended=!0,!1}if(be=T.avail_out,T.next_out&&(T.avail_out===0||J===Hi))if(this.options.to==="string"){let qe=di.utf8border(T.output,T.next_out),fe=T.next_out-qe,Me=di.buf2string(T.output,qe);T.next_out=fe,T.avail_out=Y-fe,fe&&T.output.set(T.output.subarray(qe,qe+fe),0),this.onData(Me)}else this.onData(T.output.length===T.next_out?T.output:T.output.subarray(0,T.next_out));if(!(J===mi&&be===0)){if(J===Hi)return J=Vt.inflateEnd(this.strm),this.onEnd(J),this.ended=!0,!0;if(T.avail_in===0)break}}return!0},vi.prototype.onData=function(A){this.chunks.push(A)},vi.prototype.onEnd=function(A){A===mi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=bi.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function $i(A,N){const T=new vi(N);if(T.push(A),T.err)throw T.msg||ge[T.err];return T.result}function Ss(A,N){return N=N||{},N.raw=!0,$i(A,N)}var Ts=vi,Os=$i,Ps=Ss,Ls=$i,Rs={Inflate:Ts,inflate:Os,inflateRaw:Ps,ungzip:Ls};const{Deflate:Fs,deflate:Is,deflateRaw:zs,gzip:Bs}=Hn,{Inflate:ks,inflate:Us,inflateRaw:Ws,ungzip:Ns}=Rs;var Hr=Fs,jr=Is,$r=zs,Kr=Bs,Yr=ks,Xr=Us,Zr=Ws,Qr=Ns,Jr=de,Gs={Deflate:Hr,deflate:jr,deflateRaw:$r,gzip:Kr,Inflate:Yr,inflate:Xr,inflateRaw:Zr,ungzip:Qr,constants:Jr}},"./node_modules/upng-js/UPNG.js":(n,e,t)=>{(function(){var i={},r;n.exports=i,r=t("./node_modules/upng-js/node_modules/pako/index.js"),function(s,o){s.toRGBA8=function(a){var h=a.width,d=a.height;if(a.tabs.acTL==null)return[s.toRGBA8.decodeImage(a.data,h,d,a).buffer];var u=[];a.frames[0].data==null&&(a.frames[0].data=a.data);for(var m,v=new Uint8Array(h*d*4),_=0;_<a.frames.length;_++){var D=a.frames[_],f=D.rect.x,l=D.rect.y,c=D.rect.width,p=D.rect.height,b=s.toRGBA8.decodeImage(D.data,c,p,a);if(_==0?m=b:D.blend==0?s._copyTile(b,c,p,m,h,d,f,l,0):D.blend==1&&s._copyTile(b,c,p,m,h,d,f,l,1),u.push(m.buffer),m=m.slice(0),D.dispose!=0){if(D.dispose==1)s._copyTile(v,c,p,m,h,d,f,l,0);else if(D.dispose==2){for(var E=_-1;a.frames[E].dispose==2;)E--;m=new Uint8Array(u[E]).slice(0)}}}return u},s.toRGBA8.decodeImage=function(a,h,d,u){var m=h*d,v=s.decode._getBPP(u),_=Math.ceil(h*v/8),D=new Uint8Array(m*4),f=new Uint32Array(D.buffer),l=u.ctype,c=u.depth,p=s._bin.readUshort;if(l==6){var b=m<<2;if(c==8)for(var E=0;E<b;E++)D[E]=a[E];if(c==16)for(var E=0;E<b;E++)D[E]=a[E<<1]}else if(l==2){var C=u.tabs.tRNS,g=-1,x=-1,y=-1;if(C&&(g=C[0],x=C[1],y=C[2]),c==8)for(var E=0;E<m;E++){var w=E<<2,M=E*3;D[w]=a[M],D[w+1]=a[M+1],D[w+2]=a[M+2],D[w+3]=255,g!=-1&&a[M]==g&&a[M+1]==x&&a[M+2]==y&&(D[w+3]=0)}if(c==16)for(var E=0;E<m;E++){var w=E<<2,M=E*6;D[w]=a[M],D[w+1]=a[M+2],D[w+2]=a[M+4],D[w+3]=255,g!=-1&&p(a,M)==g&&p(a,M+2)==x&&p(a,M+4)==y&&(D[w+3]=0)}}else if(l==3){var S=u.tabs.PLTE,O=u.tabs.tRNS,P=O?O.length:0;if(c==1)for(var I=0;I<d;I++)for(var F=I*_,k=I*h,E=0;E<h;E++){var w=k+E<<2,B=a[F+(E>>3)]>>7-((E&7)<<0)&1,U=3*B;D[w]=S[U],D[w+1]=S[U+1],D[w+2]=S[U+2],D[w+3]=B<P?O[B]:255}if(c==2)for(var I=0;I<d;I++)for(var F=I*_,k=I*h,E=0;E<h;E++){var w=k+E<<2,B=a[F+(E>>2)]>>6-((E&3)<<1)&3,U=3*B;D[w]=S[U],D[w+1]=S[U+1],D[w+2]=S[U+2],D[w+3]=B<P?O[B]:255}if(c==4)for(var I=0;I<d;I++)for(var F=I*_,k=I*h,E=0;E<h;E++){var w=k+E<<2,B=a[F+(E>>1)]>>4-((E&1)<<2)&15,U=3*B;D[w]=S[U],D[w+1]=S[U+1],D[w+2]=S[U+2],D[w+3]=B<P?O[B]:255}if(c==8)for(var E=0;E<m;E++){var w=E<<2,B=a[E],U=3*B;D[w]=S[U],D[w+1]=S[U+1],D[w+2]=S[U+2],D[w+3]=B<P?O[B]:255}}else if(l==4){if(c==8)for(var E=0;E<m;E++){var w=E<<2,W=E<<1,R=a[W];D[w]=R,D[w+1]=R,D[w+2]=R,D[w+3]=a[W+1]}if(c==16)for(var E=0;E<m;E++){var w=E<<2,W=E<<2,R=a[W];D[w]=R,D[w+1]=R,D[w+2]=R,D[w+3]=a[W+2]}}else if(l==0){var g=u.tabs.tRNS?u.tabs.tRNS:-1;if(c==1)for(var E=0;E<m;E++){var R=255*(a[E>>3]>>7-(E&7)&1),z=R==g*255?0:255;f[E]=z<<24|R<<16|R<<8|R}if(c==2)for(var E=0;E<m;E++){var R=85*(a[E>>2]>>6-((E&3)<<1)&3),z=R==g*85?0:255;f[E]=z<<24|R<<16|R<<8|R}if(c==4)for(var E=0;E<m;E++){var R=17*(a[E>>1]>>4-((E&1)<<2)&15),z=R==g*17?0:255;f[E]=z<<24|R<<16|R<<8|R}if(c==8)for(var E=0;E<m;E++){var R=a[E],z=R==g?0:255;f[E]=z<<24|R<<16|R<<8|R}if(c==16)for(var E=0;E<m;E++){var R=a[E<<1],z=p(a,E<<1)==g?0:255;f[E]=z<<24|R<<16|R<<8|R}}return D},s.decode=function(a){for(var h=new Uint8Array(a),d=8,u=s._bin,m=u.readUshort,v=u.readUint,_={tabs:{},frames:[]},D=new Uint8Array(h.length),f=0,l,c=0,p=[137,80,78,71,13,10,26,10],b=0;b<8;b++)if(h[b]!=p[b])throw"The input is not a PNG file!";for(;d<h.length;){var E=u.readUint(h,d);d+=4;var C=u.readASCII(h,d,4);if(d+=4,C=="IHDR")s.decode._IHDR(h,d,_);else if(C=="IDAT"){for(var b=0;b<E;b++)D[f+b]=h[d+b];f+=E}else if(C=="acTL")_.tabs[C]={num_frames:v(h,d),num_plays:v(h,d+4)},l=new Uint8Array(h.length);else if(C=="fcTL"){if(c!=0){var g=_.frames[_.frames.length-1];g.data=s.decode._decompress(_,l.slice(0,c),g.rect.width,g.rect.height),c=0}var x={x:v(h,d+12),y:v(h,d+16),width:v(h,d+4),height:v(h,d+8)},y=m(h,d+22);y=m(h,d+20)/(y==0?100:y);var w={rect:x,delay:Math.round(y*1e3),dispose:h[d+24],blend:h[d+25]};_.frames.push(w)}else if(C=="fdAT"){for(var b=0;b<E-4;b++)l[c+b]=h[d+b+4];c+=E-4}else if(C=="pHYs")_.tabs[C]=[u.readUint(h,d),u.readUint(h,d+4),h[d+8]];else if(C=="cHRM"){_.tabs[C]=[];for(var b=0;b<8;b++)_.tabs[C].push(u.readUint(h,d+b*4))}else if(C=="tEXt"){_.tabs[C]==null&&(_.tabs[C]={});var M=u.nextZero(h,d),S=u.readASCII(h,d,M-d),O=u.readASCII(h,M+1,d+E-M-1);_.tabs[C][S]=O}else if(C=="iTXt"){_.tabs[C]==null&&(_.tabs[C]={});var M=0,P=d;M=u.nextZero(h,P);var S=u.readASCII(h,P,M-P);P=M+1,h[P],h[P+1],P+=2,M=u.nextZero(h,P),u.readASCII(h,P,M-P),P=M+1,M=u.nextZero(h,P),u.readUTF8(h,P,M-P),P=M+1;var O=u.readUTF8(h,P,E-(P-d));_.tabs[C][S]=O}else if(C=="PLTE")_.tabs[C]=u.readBytes(h,d,E);else if(C=="hIST"){var I=_.tabs.PLTE.length/3;_.tabs[C]=[];for(var b=0;b<I;b++)_.tabs[C].push(m(h,d+b*2))}else if(C=="tRNS")_.ctype==3?_.tabs[C]=u.readBytes(h,d,E):_.ctype==0?_.tabs[C]=m(h,d):_.ctype==2&&(_.tabs[C]=[m(h,d),m(h,d+2),m(h,d+4)]);else if(C=="gAMA")_.tabs[C]=u.readUint(h,d)/1e5;else if(C=="sRGB")_.tabs[C]=h[d];else if(C=="bKGD")_.ctype==0||_.ctype==4?_.tabs[C]=[m(h,d)]:_.ctype==2||_.ctype==6?_.tabs[C]=[m(h,d),m(h,d+2),m(h,d+4)]:_.ctype==3&&(_.tabs[C]=h[d]);else if(C=="IEND"){if(c!=0){var g=_.frames[_.frames.length-1];g.data=s.decode._decompress(_,l.slice(0,c),g.rect.width,g.rect.height),c=0}_.data=s.decode._decompress(_,D,_.width,_.height);break}d+=E,u.readUint(h,d),d+=4}return delete _.compress,delete _.interlace,delete _.filter,_},s.decode._decompress=function(a,h,d,u){return a.compress==0&&(h=s.decode._inflate(h)),a.interlace==0?h=s.decode._filterZero(h,a,0,d,u):a.interlace==1&&(h=s.decode._readInterlace(h,a)),h},s.decode._inflate=function(a){return o.inflate(a)},s.decode._readInterlace=function(a,h){for(var d=h.width,u=h.height,m=s.decode._getBPP(h),v=m>>3,_=Math.ceil(d*m/8),D=new Uint8Array(u*_),f=0,l=[0,0,4,0,2,0,1],c=[0,4,0,2,0,1,0],p=[8,8,8,4,4,2,2],b=[8,8,4,4,2,2,1],E=0;E<7;){for(var C=p[E],g=b[E],x=0,y=0,w=l[E];w<u;)w+=C,y++;for(var M=c[E];M<d;)M+=g,x++;var S=Math.ceil(x*m/8);s.decode._filterZero(a,h,f,x,y);for(var O=0,P=l[E];P<u;){for(var I=c[E],F=f+O*S<<3;I<d;){if(m==1){var k=a[F>>3];k=k>>7-(F&7)&1,D[P*_+(I>>3)]|=k<<7-((I&3)<<0)}if(m==2){var k=a[F>>3];k=k>>6-(F&7)&3,D[P*_+(I>>2)]|=k<<6-((I&3)<<1)}if(m==4){var k=a[F>>3];k=k>>4-(F&7)&15,D[P*_+(I>>1)]|=k<<4-((I&1)<<2)}if(m>=8)for(var B=P*_+I*v,U=0;U<v;U++)D[B+U]=a[(F>>3)+U];F+=m,I+=g}O++,P+=C}x*y!=0&&(f+=y*(1+S)),E=E+1}return D},s.decode._getBPP=function(a){var h=[1,null,3,1,2,null,4][a.ctype];return h*a.depth},s.decode._filterZero=function(a,h,d,u,m){var v=s.decode._getBPP(h),_=Math.ceil(u*v/8),D=s.decode._paeth;v=Math.ceil(v/8);for(var f=0;f<m;f++){var l=d+f*_,c=l+f+1,p=a[c-1];if(p==0)for(var b=0;b<_;b++)a[l+b]=a[c+b];else if(p==1){for(var b=0;b<v;b++)a[l+b]=a[c+b];for(var b=v;b<_;b++)a[l+b]=a[c+b]+a[l+b-v]&255}else if(f==0){for(var b=0;b<v;b++)a[l+b]=a[c+b];if(p==2)for(var b=v;b<_;b++)a[l+b]=a[c+b]&255;if(p==3)for(var b=v;b<_;b++)a[l+b]=a[c+b]+(a[l+b-v]>>1)&255;if(p==4)for(var b=v;b<_;b++)a[l+b]=a[c+b]+D(a[l+b-v],0,0)&255}else{if(p==2)for(var b=0;b<_;b++)a[l+b]=a[c+b]+a[l+b-_]&255;if(p==3){for(var b=0;b<v;b++)a[l+b]=a[c+b]+(a[l+b-_]>>1)&255;for(var b=v;b<_;b++)a[l+b]=a[c+b]+(a[l+b-_]+a[l+b-v]>>1)&255}if(p==4){for(var b=0;b<v;b++)a[l+b]=a[c+b]+D(0,a[l+b-_],0)&255;for(var b=v;b<_;b++)a[l+b]=a[c+b]+D(a[l+b-v],a[l+b-_],a[l+b-v-_])&255}}}return a},s.decode._paeth=function(a,h,d){var u=a+h-d,m=Math.abs(u-a),v=Math.abs(u-h),_=Math.abs(u-d);return m<=v&&m<=_?a:v<=_?h:d},s.decode._IHDR=function(a,h,d){var u=s._bin;d.width=u.readUint(a,h),h+=4,d.height=u.readUint(a,h),h+=4,d.depth=a[h],h++,d.ctype=a[h],h++,d.compress=a[h],h++,d.filter=a[h],h++,d.interlace=a[h],h++},s._bin={nextZero:function(a,h){for(;a[h]!=0;)h++;return h},readUshort:function(a,h){return a[h]<<8|a[h+1]},writeUshort:function(a,h,d){a[h]=d>>8&255,a[h+1]=d&255},readUint:function(a,h){return a[h]*16777216+(a[h+1]<<16|a[h+2]<<8|a[h+3])},writeUint:function(a,h,d){a[h]=d>>24&255,a[h+1]=d>>16&255,a[h+2]=d>>8&255,a[h+3]=d&255},readASCII:function(a,h,d){for(var u="",m=0;m<d;m++)u+=String.fromCharCode(a[h+m]);return u},writeASCII:function(a,h,d){for(var u=0;u<d.length;u++)a[h+u]=d.charCodeAt(u)},readBytes:function(a,h,d){for(var u=[],m=0;m<d;m++)u.push(a[h+m]);return u},pad:function(a){return a.length<2?"0"+a:a},readUTF8:function(a,h,d){for(var u="",m,v=0;v<d;v++)u+="%"+s._bin.pad(a[h+v].toString(16));try{m=decodeURIComponent(u)}catch{return s._bin.readASCII(a,h,d)}return m}},s._copyTile=function(a,h,d,u,m,v,_,D,f){for(var l=Math.min(h,m),c=Math.min(d,v),p=0,b=0,E=0;E<c;E++)for(var C=0;C<l;C++)if(_>=0&&D>=0?(p=E*h+C<<2,b=(D+E)*m+_+C<<2):(p=(-D+E)*h-_+C<<2,b=E*m+C<<2),f==0)u[b]=a[p],u[b+1]=a[p+1],u[b+2]=a[p+2],u[b+3]=a[p+3];else if(f==1){var g=a[p+3]*.00392156862745098,x=a[p]*g,y=a[p+1]*g,w=a[p+2]*g,M=u[b+3]*(1/255),S=u[b]*M,O=u[b+1]*M,P=u[b+2]*M,I=1-g,F=g+M*I,k=F==0?0:1/F;u[b+3]=255*F,u[b+0]=(x+S*I)*k,u[b+1]=(y+O*I)*k,u[b+2]=(w+P*I)*k}else if(f==2){var g=a[p+3],x=a[p],y=a[p+1],w=a[p+2],M=u[b+3],S=u[b],O=u[b+1],P=u[b+2];g==M&&x==S&&y==O&&w==P?(u[b]=0,u[b+1]=0,u[b+2]=0,u[b+3]=0):(u[b]=x,u[b+1]=y,u[b+2]=w,u[b+3]=g)}else if(f==3){var g=a[p+3],x=a[p],y=a[p+1],w=a[p+2],M=u[b+3],S=u[b],O=u[b+1],P=u[b+2];if(g==M&&x==S&&y==O&&w==P)continue;if(g<220&&M>20)return!1}return!0},s.encode=function(a,h,d,u,m,v){u==null&&(u=0),v==null&&(v=!1);for(var _=new Uint8Array(a[0].byteLength*a.length+100),D=[137,80,78,71,13,10,26,10],f=0;f<8;f++)_[f]=D[f];var l=8,c=s._bin,p=s.crc.crc,b=c.writeUint,E=c.writeUshort,C=c.writeASCII,g=s.encode.compressPNG(a,h,d,u,v);b(_,l,13),l+=4,C(_,l,"IHDR"),l+=4,b(_,l,h),l+=4,b(_,l,d),l+=4,_[l]=g.depth,l++,_[l]=g.ctype,l++,_[l]=0,l++,_[l]=0,l++,_[l]=0,l++,b(_,l,p(_,l-17,17)),l+=4,b(_,l,1),l+=4,C(_,l,"sRGB"),l+=4,_[l]=1,l++,b(_,l,p(_,l-5,5)),l+=4;var x=a.length>1;if(x&&(b(_,l,8),l+=4,C(_,l,"acTL"),l+=4,b(_,l,a.length),l+=4,b(_,l,0),l+=4,b(_,l,p(_,l-12,12)),l+=4),g.ctype==3){var y=g.plte.length;b(_,l,y*3),l+=4,C(_,l,"PLTE"),l+=4;for(var f=0;f<y;f++){var w=f*3,M=g.plte[f],S=M&255,O=M>>8&255,P=M>>16&255;_[l+w+0]=S,_[l+w+1]=O,_[l+w+2]=P}if(l+=y*3,b(_,l,p(_,l-y*3-4,y*3+4)),l+=4,g.gotAlpha){b(_,l,y),l+=4,C(_,l,"tRNS"),l+=4;for(var f=0;f<y;f++)_[l+f]=g.plte[f]>>24&255;l+=y,b(_,l,p(_,l-y-4,y+4)),l+=4}}for(var I=0,F=0;F<g.frames.length;F++){var k=g.frames[F];x&&(b(_,l,26),l+=4,C(_,l,"fcTL"),l+=4,b(_,l,I++),l+=4,b(_,l,k.rect.width),l+=4,b(_,l,k.rect.height),l+=4,b(_,l,k.rect.x),l+=4,b(_,l,k.rect.y),l+=4,E(_,l,m[F]),l+=2,E(_,l,1e3),l+=2,_[l]=k.dispose,l++,_[l]=k.blend,l++,b(_,l,p(_,l-30,30)),l+=4);var B=k.cimg,y=B.length;b(_,l,y+(F==0?0:4)),l+=4;var U=l;C(_,l,F==0?"IDAT":"fdAT"),l+=4,F!=0&&(b(_,l,I++),l+=4);for(var f=0;f<y;f++)_[l+f]=B[f];l+=y,b(_,l,p(_,U,l-U)),l+=4}return b(_,l,0),l+=4,C(_,l,"IEND"),l+=4,b(_,l,p(_,l-4,4)),l+=4,_.buffer.slice(0,l)},s.encode.compressPNG=function(a,h,d,u,m){for(var v=s.encode.compress(a,h,d,u,!1,m),_=0;_<a.length;_++){var D=v.frames[_];D.rect.width;var f=D.rect.height,l=D.bpl,c=D.bpp,p=new Uint8Array(f*l+f);D.cimg=s.encode._filterZero(D.img,f,c,l,p)}return v},s.encode.compress=function(a,h,d,u,m,v){v==null&&(v=!1);for(var _=6,D=8,f=4,l=255,c=0;c<a.length;c++)for(var p=new Uint8Array(a[c]),b=p.length,E=0;E<b;E+=4)l&=p[E+3];var C=l!=255,g={},x=[];if(a.length!=0&&(g[0]=0,x.push(0),u!=0&&u--),u!=0){var y=s.quantize(a,u,m);a=y.bufs;for(var E=0;E<y.plte.length;E++){var w=y.plte[E].est.rgba;g[w]==null&&(g[w]=x.length,x.push(w))}}else for(var c=0;c<a.length;c++)for(var M=new Uint32Array(a[c]),b=M.length,E=0;E<b;E++){var w=M[E];if((E<h||w!=M[E-1]&&w!=M[E-h])&&g[w]==null&&(g[w]=x.length,x.push(w),x.length>=300))break}var S=C?m:!1,O=x.length;O<=256&&v==!1&&(O<=2?D=1:O<=4?D=2:O<=16?D=4:D=8,m&&(D=8),C=!0);for(var P=[],c=0;c<a.length;c++){var I=new Uint8Array(a[c]),F=new Uint32Array(I.buffer),k=0,B=0,U=h,W=d,R=0;if(c!=0&&!S){for(var z=m||c==1||P[P.length-2].dispose==2?1:2,G=0,q=1e9,Q=0;Q<z;Q++){for(var _e=new Uint8Array(a[c-1-Q]),ne=new Uint32Array(a[c-1-Q]),te=h,oe=d,re=-1,le=-1,Ce=0;Ce<d;Ce++)for(var De=0;De<h;De++){var E=Ce*h+De;F[E]!=ne[E]&&(De<te&&(te=De),De>re&&(re=De),Ce<oe&&(oe=Ce),Ce>le&&(le=Ce))}var Oe=re==-1?1:(re-te+1)*(le-oe+1);Oe<q&&(q=Oe,G=Q,re==-1?(k=B=0,U=W=1):(k=te,B=oe,U=re-te+1,W=le-oe+1))}var _e=new Uint8Array(a[c-1-G]);G==1&&(P[P.length-1].dispose=2);var Z=new Uint8Array(U*W*4);new Uint32Array(Z.buffer),s._copyTile(_e,h,d,Z,U,W,-k,-B,0),s._copyTile(I,h,d,Z,U,W,-k,-B,3)?(s._copyTile(I,h,d,Z,U,W,-k,-B,2),R=1):(s._copyTile(I,h,d,Z,U,W,-k,-B,0),R=0),I=Z,F=new Uint32Array(I.buffer)}var xe=4*U;if(O<=256&&v==!1){xe=Math.ceil(D*U/8);for(var Z=new Uint8Array(xe*W),Ce=0;Ce<W;Ce++){var E=Ce*xe,we=Ce*U;if(D==8)for(var De=0;De<U;De++)Z[E+De]=g[F[we+De]];else if(D==4)for(var De=0;De<U;De++)Z[E+(De>>1)]|=g[F[we+De]]<<4-(De&1)*4;else if(D==2)for(var De=0;De<U;De++)Z[E+(De>>2)]|=g[F[we+De]]<<6-(De&3)*2;else if(D==1)for(var De=0;De<U;De++)Z[E+(De>>3)]|=g[F[we+De]]<<7-(De&7)*1}I=Z,_=3,f=1}else if(C==!1&&a.length==1){for(var Z=new Uint8Array(U*W*3),ie=U*W,E=0;E<ie;E++){var Ne=E*3,Ge=E*4;Z[Ne]=I[Ge],Z[Ne+1]=I[Ge+1],Z[Ne+2]=I[Ge+2]}I=Z,_=2,f=3,xe=3*U}P.push({rect:{x:k,y:B,width:U,height:W},img:I,bpl:xe,bpp:f,blend:R,dispose:S?1:0})}return{ctype:_,depth:D,plte:x,gotAlpha:C,frames:P}},s.encode._filterZero=function(a,h,d,u,m){for(var v=[],_=0;_<5;_++)if(!(h*u>5e5&&(_==2||_==3||_==4))){for(var D=0;D<h;D++)s.encode._filterLine(m,a,D,u,d,_);if(v.push(o.deflate(m)),d==1)break}for(var f,l=1e9,c=0;c<v.length;c++)v[c].length<l&&(f=c,l=v[c].length);return v[f]},s.encode._filterLine=function(a,h,d,u,m,v){var _=d*u,D=_+d,f=s.decode._paeth;if(a[D]=v,D++,v==0)for(var l=0;l<u;l++)a[D+l]=h[_+l];else if(v==1){for(var l=0;l<m;l++)a[D+l]=h[_+l];for(var l=m;l<u;l++)a[D+l]=h[_+l]-h[_+l-m]+256&255}else if(d==0){for(var l=0;l<m;l++)a[D+l]=h[_+l];if(v==2)for(var l=m;l<u;l++)a[D+l]=h[_+l];if(v==3)for(var l=m;l<u;l++)a[D+l]=h[_+l]-(h[_+l-m]>>1)+256&255;if(v==4)for(var l=m;l<u;l++)a[D+l]=h[_+l]-f(h[_+l-m],0,0)+256&255}else{if(v==2)for(var l=0;l<u;l++)a[D+l]=h[_+l]+256-h[_+l-u]&255;if(v==3){for(var l=0;l<m;l++)a[D+l]=h[_+l]+256-(h[_+l-u]>>1)&255;for(var l=m;l<u;l++)a[D+l]=h[_+l]+256-(h[_+l-u]+h[_+l-m]>>1)&255}if(v==4){for(var l=0;l<m;l++)a[D+l]=h[_+l]+256-f(0,h[_+l-u],0)&255;for(var l=m;l<u;l++)a[D+l]=h[_+l]+256-f(h[_+l-m],h[_+l-u],h[_+l-m-u])&255}}},s.crc={table:function(){for(var a=new Uint32Array(256),h=0;h<256;h++){for(var d=h,u=0;u<8;u++)d&1?d=3988292384^d>>>1:d=d>>>1;a[h]=d}return a}(),update:function(a,h,d,u){for(var m=0;m<u;m++)a=s.crc.table[(a^h[d+m])&255]^a>>>8;return a},crc:function(a,h,d){return s.crc.update(4294967295,a,h,d)^4294967295}},s.quantize=function(a,h,d){for(var u=[],m=0,v=0;v<a.length;v++)u.push(s.encode.alphaMul(new Uint8Array(a[v]),d)),m+=a[v].byteLength;for(var _=new Uint8Array(m),D=new Uint32Array(_.buffer),f=0,v=0;v<u.length;v++){for(var l=u[v],c=l.length,p=0;p<c;p++)_[f+p]=l[p];f+=c}var b={i0:0,i1:_.length,bst:null,est:null,tdst:0,left:null,right:null};b.bst=s.quantize.stats(_,b.i0,b.i1),b.est=s.quantize.estats(b.bst);for(var E=[b];E.length<h;){for(var C=0,g=0,v=0;v<E.length;v++)E[v].est.L>C&&(C=E[v].est.L,g=v);if(C<.001)break;var x=E[g],y=s.quantize.splitPixels(_,D,x.i0,x.i1,x.est.e,x.est.eMq255),w={i0:x.i0,i1:y,bst:null,est:null,tdst:0,left:null,right:null};w.bst=s.quantize.stats(_,w.i0,w.i1),w.est=s.quantize.estats(w.bst);var M={i0:y,i1:x.i1,bst:null,est:null,tdst:0,left:null,right:null};M.bst={R:[],m:[],N:x.bst.N-w.bst.N};for(var v=0;v<16;v++)M.bst.R[v]=x.bst.R[v]-w.bst.R[v];for(var v=0;v<4;v++)M.bst.m[v]=x.bst.m[v]-w.bst.m[v];M.est=s.quantize.estats(M.bst),x.left=w,x.right=M,E[g]=w,E.push(M)}E.sort(function(z,G){return G.bst.N-z.bst.N});for(var S=0;S<u.length;S++){for(var O=s.quantize.planeDst,P=new Uint8Array(u[S].buffer),I=new Uint32Array(u[S].buffer),F=P.length,v=0;v<F;v+=4){for(var k=P[v]*.00392156862745098,B=P[v+1]*(1/255),U=P[v+2]*(1/255),W=P[v+3]*(1/255),R=b;R.left;)R=O(R.est,k,B,U,W)<=0?R.left:R.right;I[v>>2]=R.est.rgba}u[S]=I.buffer}return{bufs:u,plte:E}},s.quantize.getNearest=function(a,h,d,u,m){if(a.left==null)return a.tdst=s.quantize.dist(a.est.q,h,d,u,m),a;var v=s.quantize.planeDst(a.est,h,d,u,m),_=a.left,D=a.right;v>0&&(_=a.right,D=a.left);var f=s.quantize.getNearest(_,h,d,u,m);if(f.tdst<=v*v)return f;var l=s.quantize.getNearest(D,h,d,u,m);return l.tdst<f.tdst?l:f},s.quantize.planeDst=function(a,h,d,u,m){var v=a.e;return v[0]*h+v[1]*d+v[2]*u+v[3]*m-a.eMq},s.quantize.dist=function(a,h,d,u,m){var v=h-a[0],_=d-a[1],D=u-a[2],f=m-a[3];return v*v+_*_+D*D+f*f},s.quantize.splitPixels=function(a,h,d,u,m,v){var _=s.quantize.vecDot;for(u-=4;d<u;){for(;_(a,d,m)<=v;)d+=4;for(;_(a,u,m)>v;)u-=4;if(d>=u)break;var D=h[d>>2];h[d>>2]=h[u>>2],h[u>>2]=D,d+=4,u-=4}for(;_(a,d,m)>v;)d-=4;return d+4},s.quantize.vecDot=function(a,h,d){return a[h]*d[0]+a[h+1]*d[1]+a[h+2]*d[2]+a[h+3]*d[3]},s.quantize.stats=function(a,h,d){for(var u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0],v=d-h>>2,_=h;_<d;_+=4){var D=a[_]*.00392156862745098,f=a[_+1]*(1/255),l=a[_+2]*(1/255),c=a[_+3]*(1/255);m[0]+=D,m[1]+=f,m[2]+=l,m[3]+=c,u[0]+=D*D,u[1]+=D*f,u[2]+=D*l,u[3]+=D*c,u[5]+=f*f,u[6]+=f*l,u[7]+=f*c,u[10]+=l*l,u[11]+=l*c,u[15]+=c*c}return u[4]=u[1],u[8]=u[2],u[12]=u[3],u[9]=u[6],u[13]=u[7],u[14]=u[11],{R:u,m,N:v}},s.quantize.estats=function(a){var h=a.R,d=a.m,u=a.N,m=d[0],v=d[1],_=d[2],D=d[3],f=u==0?0:1/u,l=[h[0]-m*m*f,h[1]-m*v*f,h[2]-m*_*f,h[3]-m*D*f,h[4]-v*m*f,h[5]-v*v*f,h[6]-v*_*f,h[7]-v*D*f,h[8]-_*m*f,h[9]-_*v*f,h[10]-_*_*f,h[11]-_*D*f,h[12]-D*m*f,h[13]-D*v*f,h[14]-D*_*f,h[15]-D*D*f],c=l,p=s.M4,b=[.5,.5,.5,.5],E=0,C=0;if(u!=0)for(var g=0;g<10&&(b=p.multVec(c,b),C=Math.sqrt(p.dot(b,b)),b=p.sml(1/C,b),!(Math.abs(C-E)<1e-9));g++)E=C;var x=[m*f,v*f,_*f,D*f],y=p.dot(p.sml(255,x),b),w=x[3]<.001?0:1/x[3];return{Cov:l,q:x,e:b,L:E,eMq255:y,eMq:p.dot(b,x),rgba:(Math.round(255*x[3])<<24|Math.round(255*x[2]*w)<<16|Math.round(255*x[1]*w)<<8|Math.round(255*x[0]*w)<<0)>>>0}},s.M4={multVec:function(a,h){return[a[0]*h[0]+a[1]*h[1]+a[2]*h[2]+a[3]*h[3],a[4]*h[0]+a[5]*h[1]+a[6]*h[2]+a[7]*h[3],a[8]*h[0]+a[9]*h[1]+a[10]*h[2]+a[11]*h[3],a[12]*h[0]+a[13]*h[1]+a[14]*h[2]+a[15]*h[3]]},dot:function(a,h){return a[0]*h[0]+a[1]*h[1]+a[2]*h[2]+a[3]*h[3]},sml:function(a,h){return[a*h[0],a*h[1],a*h[2],a*h[3]]}},s.encode.alphaMul=function(a,h){for(var d=new Uint8Array(a.length),u=a.length>>2,m=0;m<u;m++){var v=m<<2,_=a[v+3];h&&(_=_<128?0:255);var D=_*(1/255);d[v+0]=a[v+0]*D,d[v+1]=a[v+1]*D,d[v+2]=a[v+2]*D,d[v+3]=_}return d}}(i,r)})()},"./node_modules/upng-js/node_modules/pako/index.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,r=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),a={};i(a,r,s,o),n.exports=a},"./node_modules/upng-js/node_modules/pako/lib/deflate.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),r=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),h=Object.prototype.toString,d=0,u=4,m=0,v=1,_=2,D=-1,f=0,l=8;function c(C){if(!(this instanceof c))return new c(C);this.options=r.assign({level:D,method:l,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},C||{});var g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var x=i.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(x!==m)throw new Error(o[x]);if(g.header&&i.deflateSetHeader(this.strm,g.header),g.dictionary){var y;if(typeof g.dictionary=="string"?y=s.string2buf(g.dictionary):h.call(g.dictionary)==="[object ArrayBuffer]"?y=new Uint8Array(g.dictionary):y=g.dictionary,x=i.deflateSetDictionary(this.strm,y),x!==m)throw new Error(o[x]);this._dict_set=!0}}c.prototype.push=function(C,g){var x=this.strm,y=this.options.chunkSize,w,M;if(this.ended)return!1;M=g===~~g?g:g===!0?u:d,typeof C=="string"?x.input=s.string2buf(C):h.call(C)==="[object ArrayBuffer]"?x.input=new Uint8Array(C):x.input=C,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new r.Buf8(y),x.next_out=0,x.avail_out=y),w=i.deflate(x,M),w!==v&&w!==m)return this.onEnd(w),this.ended=!0,!1;(x.avail_out===0||x.avail_in===0&&(M===u||M===_))&&(this.options.to==="string"?this.onData(s.buf2binstring(r.shrinkBuf(x.output,x.next_out))):this.onData(r.shrinkBuf(x.output,x.next_out)))}while((x.avail_in>0||x.avail_out===0)&&w!==v);return M===u?(w=i.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===m):(M===_&&(this.onEnd(m),x.avail_out=0),!0)},c.prototype.onData=function(C){this.chunks.push(C)},c.prototype.onEnd=function(C){C===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg};function p(C,g){var x=new c(g);if(x.push(C,!0),x.err)throw x.msg||o[x.err];return x.result}function b(C,g){return g=g||{},g.raw=!0,p(C,g)}function E(C,g){return g=g||{},g.gzip=!0,p(C,g)}e.Deflate=c,e.deflate=p,e.deflateRaw=b,e.gzip=E},"./node_modules/upng-js/node_modules/pako/lib/inflate.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),r=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),d=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),u=Object.prototype.toString;function m(D){if(!(this instanceof m))return new m(D);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},D||{});var f=this.options;f.raw&&f.windowBits>=0&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),f.windowBits>=0&&f.windowBits<16&&!(D&&D.windowBits)&&(f.windowBits+=32),f.windowBits>15&&f.windowBits<48&&(f.windowBits&15)===0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var l=i.inflateInit2(this.strm,f.windowBits);if(l!==o.Z_OK)throw new Error(a[l]);if(this.header=new d,i.inflateGetHeader(this.strm,this.header),f.dictionary&&(typeof f.dictionary=="string"?f.dictionary=s.string2buf(f.dictionary):u.call(f.dictionary)==="[object ArrayBuffer]"&&(f.dictionary=new Uint8Array(f.dictionary)),f.raw&&(l=i.inflateSetDictionary(this.strm,f.dictionary),l!==o.Z_OK)))throw new Error(a[l])}m.prototype.push=function(D,f){var l=this.strm,c=this.options.chunkSize,p=this.options.dictionary,b,E,C,g,x,y=!1;if(this.ended)return!1;E=f===~~f?f:f===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof D=="string"?l.input=s.binstring2buf(D):u.call(D)==="[object ArrayBuffer]"?l.input=new Uint8Array(D):l.input=D,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new r.Buf8(c),l.next_out=0,l.avail_out=c),b=i.inflate(l,o.Z_NO_FLUSH),b===o.Z_NEED_DICT&&p&&(b=i.inflateSetDictionary(this.strm,p)),b===o.Z_BUF_ERROR&&y===!0&&(b=o.Z_OK,y=!1),b!==o.Z_STREAM_END&&b!==o.Z_OK)return this.onEnd(b),this.ended=!0,!1;l.next_out&&(l.avail_out===0||b===o.Z_STREAM_END||l.avail_in===0&&(E===o.Z_FINISH||E===o.Z_SYNC_FLUSH))&&(this.options.to==="string"?(C=s.utf8border(l.output,l.next_out),g=l.next_out-C,x=s.buf2string(l.output,C),l.next_out=g,l.avail_out=c-g,g&&r.arraySet(l.output,l.output,C,g,0),this.onData(x)):this.onData(r.shrinkBuf(l.output,l.next_out))),l.avail_in===0&&l.avail_out===0&&(y=!0)}while((l.avail_in>0||l.avail_out===0)&&b!==o.Z_STREAM_END);return b===o.Z_STREAM_END&&(E=o.Z_FINISH),E===o.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===o.Z_OK):(E===o.Z_SYNC_FLUSH&&(this.onEnd(o.Z_OK),l.avail_out=0),!0)},m.prototype.onData=function(D){this.chunks.push(D)},m.prototype.onEnd=function(D){D===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=D,this.msg=this.strm.msg};function v(D,f){var l=new m(f);if(l.push(D,!0),l.err)throw l.msg||a[l.err];return l.result}function _(D,f){return f=f||{},f.raw=!0,v(D,f)}e.Inflate=m,e.inflate=v,e.inflateRaw=_,e.ungzip=v},"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":(n,e)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function i(o,a){return Object.prototype.hasOwnProperty.call(o,a)}e.assign=function(o){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var h=a.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var d in h)i(h,d)&&(o[d]=h[d])}}return o},e.shrinkBuf=function(o,a){return o.length===a?o:o.subarray?o.subarray(0,a):(o.length=a,o)};var r={arraySet:function(o,a,h,d,u){if(a.subarray&&o.subarray){o.set(a.subarray(h,h+d),u);return}for(var m=0;m<d;m++)o[u+m]=a[h+m]},flattenChunks:function(o){var a,h,d,u,m,v;for(d=0,a=0,h=o.length;a<h;a++)d+=o[a].length;for(v=new Uint8Array(d),u=0,a=0,h=o.length;a<h;a++)m=o[a],v.set(m,u),u+=m.length;return v}},s={arraySet:function(o,a,h,d,u){for(var m=0;m<d;m++)o[u+m]=a[h+m]},flattenChunks:function(o){return[].concat.apply([],o)}};e.setTyped=function(o){o?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)},"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1,e.string2buf=function(d){var u,m,v,_,D,f=d.length,l=0;for(_=0;_<f;_++)m=d.charCodeAt(_),(m&64512)===55296&&_+1<f&&(v=d.charCodeAt(_+1),(v&64512)===56320&&(m=65536+(m-55296<<10)+(v-56320),_++)),l+=m<128?1:m<2048?2:m<65536?3:4;for(u=new i.Buf8(l),D=0,_=0;D<l;_++)m=d.charCodeAt(_),(m&64512)===55296&&_+1<f&&(v=d.charCodeAt(_+1),(v&64512)===56320&&(m=65536+(m-55296<<10)+(v-56320),_++)),m<128?u[D++]=m:m<2048?(u[D++]=192|m>>>6,u[D++]=128|m&63):m<65536?(u[D++]=224|m>>>12,u[D++]=128|m>>>6&63,u[D++]=128|m&63):(u[D++]=240|m>>>18,u[D++]=128|m>>>12&63,u[D++]=128|m>>>6&63,u[D++]=128|m&63);return u};function h(d,u){if(u<65534&&(d.subarray&&s||!d.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(d,u));for(var m="",v=0;v<u;v++)m+=String.fromCharCode(d[v]);return m}e.buf2binstring=function(d){return h(d,d.length)},e.binstring2buf=function(d){for(var u=new i.Buf8(d.length),m=0,v=u.length;m<v;m++)u[m]=d.charCodeAt(m);return u},e.buf2string=function(d,u){var m,v,_,D,f=u||d.length,l=new Array(f*2);for(v=0,m=0;m<f;){if(_=d[m++],_<128){l[v++]=_;continue}if(D=o[_],D>4){l[v++]=65533,m+=D-1;continue}for(_&=D===2?31:D===3?15:7;D>1&&m<f;)_=_<<6|d[m++]&63,D--;if(D>1){l[v++]=65533;continue}_<65536?l[v++]=_:(_-=65536,l[v++]=55296|_>>10&1023,l[v++]=56320|_&1023)}return h(l,v)},e.utf8border=function(d,u){var m;for(u=u||d.length,u>d.length&&(u=d.length),m=u-1;m>=0&&(d[m]&192)===128;)m--;return m<0||m===0?u:m+o[d[m]]>u?m:u}},"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":n=>{function e(t,i,r,s){for(var o=t&65535|0,a=t>>>16&65535|0,h=0;r!==0;){h=r>2e3?2e3:r,r-=h;do o=o+i[s++]|0,a=a+o|0;while(--h);o%=65521,a%=65521}return o|a<<16|0}n.exports=e},"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":n=>{n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":n=>{function e(){for(var r,s=[],o=0;o<256;o++){r=o;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[o]=r}return s}var t=e();function i(r,s,o,a){var h=t,d=a+o;r^=-1;for(var u=a;u<d;u++)r=r>>>8^h[(r^s[u])&255];return r^-1}n.exports=i},"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),r=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),h=0,d=1,u=3,m=4,v=5,_=0,D=1,f=-2,l=-3,c=-5,p=-1,b=1,E=2,C=3,g=4,x=0,y=2,w=8,M=9,S=15,O=8,P=29,I=256,F=I+1+P,k=30,B=19,U=2*F+1,W=15,R=3,z=258,G=z+R+1,q=32,Q=42,ne=69,te=73,oe=91,re=103,le=113,Ce=666,De=1,Oe=2,_e=3,Z=4,xe=3;function we(L,ge){return L.msg=a[ge],ge}function ie(L){return(L<<1)-(L>4?9:0)}function Ne(L){for(var ge=L.length;--ge>=0;)L[ge]=0}function Ge(L){var ge=L.state,de=ge.pending;de>L.avail_out&&(de=L.avail_out),de!==0&&(i.arraySet(L.output,ge.pending_buf,ge.pending_out,de,L.next_out),L.next_out+=de,ge.pending_out+=de,L.total_out+=de,L.avail_out-=de,ge.pending-=de,ge.pending===0&&(ge.pending_out=0))}function Ue(L,ge){r._tr_flush_block(L,L.block_start>=0?L.block_start:-1,L.strstart-L.block_start,ge),L.block_start=L.strstart,Ge(L.strm)}function Ie(L,ge){L.pending_buf[L.pending++]=ge}function ze(L,ge){L.pending_buf[L.pending++]=ge>>>8&255,L.pending_buf[L.pending++]=ge&255}function Re(L,ge,de,$){var se=L.avail_in;return se>$&&(se=$),se===0?0:(L.avail_in-=se,i.arraySet(ge,L.input,L.next_in,se,de),L.state.wrap===1?L.adler=s(L.adler,ge,se,de):L.state.wrap===2&&(L.adler=o(L.adler,ge,se,de)),L.next_in+=se,L.total_in+=se,se)}function Le(L,ge){var de=L.max_chain_length,$=L.strstart,se,ce,Fe=L.prev_length,ke=L.nice_match,Ee=L.strstart>L.w_size-G?L.strstart-(L.w_size-G):0,$e=L.window,Xe=L.w_mask,Ke=L.prev,Je=L.strstart+z,Ye=$e[$+Fe-1],nt=$e[$+Fe];L.prev_length>=L.good_match&&(de>>=2),ke>L.lookahead&&(ke=L.lookahead);do if(se=ge,!($e[se+Fe]!==nt||$e[se+Fe-1]!==Ye||$e[se]!==$e[$]||$e[++se]!==$e[$+1])){$+=2,se++;do;while($e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$e[++$]===$e[++se]&&$<Je);if(ce=z-(Je-$),$=Je-z,ce>Fe){if(L.match_start=ge,Fe=ce,ce>=ke)break;Ye=$e[$+Fe-1],nt=$e[$+Fe]}}while((ge=Ke[ge&Xe])>Ee&&--de!==0);return Fe<=L.lookahead?Fe:L.lookahead}function We(L){var ge=L.w_size,de,$,se,ce,Fe;do{if(ce=L.window_size-L.lookahead-L.strstart,L.strstart>=ge+(ge-G)){i.arraySet(L.window,L.window,ge,ge,0),L.match_start-=ge,L.strstart-=ge,L.block_start-=ge,$=L.hash_size,de=$;do se=L.head[--de],L.head[de]=se>=ge?se-ge:0;while(--$);$=ge,de=$;do se=L.prev[--de],L.prev[de]=se>=ge?se-ge:0;while(--$);ce+=ge}if(L.strm.avail_in===0)break;if($=Re(L.strm,L.window,L.strstart+L.lookahead,ce),L.lookahead+=$,L.lookahead+L.insert>=R)for(Fe=L.strstart-L.insert,L.ins_h=L.window[Fe],L.ins_h=(L.ins_h<<L.hash_shift^L.window[Fe+1])&L.hash_mask;L.insert&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[Fe+R-1])&L.hash_mask,L.prev[Fe&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=Fe,Fe++,L.insert--,!(L.lookahead+L.insert<R)););}while(L.lookahead<G&&L.strm.avail_in!==0)}function He(L,ge){var de=65535;for(de>L.pending_buf_size-5&&(de=L.pending_buf_size-5);;){if(L.lookahead<=1){if(We(L),L.lookahead===0&&ge===h)return De;if(L.lookahead===0)break}L.strstart+=L.lookahead,L.lookahead=0;var $=L.block_start+de;if((L.strstart===0||L.strstart>=$)&&(L.lookahead=L.strstart-$,L.strstart=$,Ue(L,!1),L.strm.avail_out===0)||L.strstart-L.block_start>=L.w_size-G&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===m?(Ue(L,!0),L.strm.avail_out===0?_e:Z):(L.strstart>L.block_start&&(Ue(L,!1),L.strm.avail_out===0),De)}function H(L,ge){for(var de,$;;){if(L.lookahead<G){if(We(L),L.lookahead<G&&ge===h)return De;if(L.lookahead===0)break}if(de=0,L.lookahead>=R&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),de!==0&&L.strstart-de<=L.w_size-G&&(L.match_length=Le(L,de)),L.match_length>=R)if($=r._tr_tally(L,L.strstart-L.match_start,L.match_length-R),L.lookahead-=L.match_length,L.match_length<=L.max_lazy_match&&L.lookahead>=R){L.match_length--;do L.strstart++,L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart;while(--L.match_length!==0);L.strstart++}else L.strstart+=L.match_length,L.match_length=0,L.ins_h=L.window[L.strstart],L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+1])&L.hash_mask;else $=r._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++;if($&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=L.strstart<R-1?L.strstart:R-1,ge===m?(Ue(L,!0),L.strm.avail_out===0?_e:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Oe}function K(L,ge){for(var de,$,se;;){if(L.lookahead<G){if(We(L),L.lookahead<G&&ge===h)return De;if(L.lookahead===0)break}if(de=0,L.lookahead>=R&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),L.prev_length=L.match_length,L.prev_match=L.match_start,L.match_length=R-1,de!==0&&L.prev_length<L.max_lazy_match&&L.strstart-de<=L.w_size-G&&(L.match_length=Le(L,de),L.match_length<=5&&(L.strategy===b||L.match_length===R&&L.strstart-L.match_start>4096)&&(L.match_length=R-1)),L.prev_length>=R&&L.match_length<=L.prev_length){se=L.strstart+L.lookahead-R,$=r._tr_tally(L,L.strstart-1-L.prev_match,L.prev_length-R),L.lookahead-=L.prev_length-1,L.prev_length-=2;do++L.strstart<=se&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart);while(--L.prev_length!==0);if(L.match_available=0,L.match_length=R-1,L.strstart++,$&&(Ue(L,!1),L.strm.avail_out===0))return De}else if(L.match_available){if($=r._tr_tally(L,0,L.window[L.strstart-1]),$&&Ue(L,!1),L.strstart++,L.lookahead--,L.strm.avail_out===0)return De}else L.match_available=1,L.strstart++,L.lookahead--}return L.match_available&&($=r._tr_tally(L,0,L.window[L.strstart-1]),L.match_available=0),L.insert=L.strstart<R-1?L.strstart:R-1,ge===m?(Ue(L,!0),L.strm.avail_out===0?_e:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Oe}function X(L,ge){for(var de,$,se,ce,Fe=L.window;;){if(L.lookahead<=z){if(We(L),L.lookahead<=z&&ge===h)return De;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=R&&L.strstart>0&&(se=L.strstart-1,$=Fe[se],$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se])){ce=L.strstart+z;do;while($===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&$===Fe[++se]&&se<ce);L.match_length=z-(ce-se),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=R?(de=r._tr_tally(L,1,L.match_length-R),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(de=r._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),de&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===m?(Ue(L,!0),L.strm.avail_out===0?_e:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Oe}function pe(L,ge){for(var de;;){if(L.lookahead===0&&(We(L),L.lookahead===0)){if(ge===h)return De;break}if(L.match_length=0,de=r._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,de&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===m?(Ue(L,!0),L.strm.avail_out===0?_e:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Oe}function ue(L,ge,de,$,se){this.good_length=L,this.max_lazy=ge,this.nice_length=de,this.max_chain=$,this.func=se}var ye;ye=[new ue(0,0,0,0,He),new ue(4,4,8,4,H),new ue(4,5,16,8,H),new ue(4,6,32,32,H),new ue(4,4,16,16,K),new ue(8,16,32,32,K),new ue(8,16,128,128,K),new ue(8,32,128,256,K),new ue(32,128,258,1024,K),new ue(32,258,258,4096,K)];function Se(L){L.window_size=2*L.w_size,Ne(L.head),L.max_lazy_match=ye[L.level].max_lazy,L.good_match=ye[L.level].good_length,L.nice_match=ye[L.level].nice_length,L.max_chain_length=ye[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=R-1,L.match_available=0,L.ins_h=0}function V(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(U*2),this.dyn_dtree=new i.Buf16((2*k+1)*2),this.bl_tree=new i.Buf16((2*B+1)*2),Ne(this.dyn_ltree),Ne(this.dyn_dtree),Ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(W+1),this.heap=new i.Buf16(2*F+1),Ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*F+1),Ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(L){var ge;return!L||!L.state?we(L,f):(L.total_in=L.total_out=0,L.data_type=y,ge=L.state,ge.pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?Q:le,L.adler=ge.wrap===2?0:1,ge.last_flush=h,r._tr_init(ge),_)}function ve(L){var ge=he(L);return ge===_&&Se(L.state),ge}function Pe(L,ge){return!L||!L.state||L.state.wrap!==2?f:(L.state.gzhead=ge,_)}function ae(L,ge,de,$,se,ce){if(!L)return f;var Fe=1;if(ge===p&&(ge=6),$<0?(Fe=0,$=-$):$>15&&(Fe=2,$-=16),se<1||se>M||de!==w||$<8||$>15||ge<0||ge>9||ce<0||ce>g)return we(L,f);$===8&&($=9);var ke=new V;return L.state=ke,ke.strm=L,ke.wrap=Fe,ke.gzhead=null,ke.w_bits=$,ke.w_size=1<<ke.w_bits,ke.w_mask=ke.w_size-1,ke.hash_bits=se+7,ke.hash_size=1<<ke.hash_bits,ke.hash_mask=ke.hash_size-1,ke.hash_shift=~~((ke.hash_bits+R-1)/R),ke.window=new i.Buf8(ke.w_size*2),ke.head=new i.Buf16(ke.hash_size),ke.prev=new i.Buf16(ke.w_size),ke.lit_bufsize=1<<se+6,ke.pending_buf_size=ke.lit_bufsize*4,ke.pending_buf=new i.Buf8(ke.pending_buf_size),ke.d_buf=1*ke.lit_bufsize,ke.l_buf=3*ke.lit_bufsize,ke.level=ge,ke.strategy=ce,ke.method=de,ve(L)}function me(L,ge){return ae(L,ge,w,S,O,x)}function j(L,ge){var de,$,se,ce;if(!L||!L.state||ge>v||ge<0)return L?we(L,f):f;if($=L.state,!L.output||!L.input&&L.avail_in!==0||$.status===Ce&&ge!==m)return we(L,L.avail_out===0?c:f);if($.strm=L,de=$.last_flush,$.last_flush=ge,$.status===Q)if($.wrap===2)L.adler=0,Ie($,31),Ie($,139),Ie($,8),$.gzhead?(Ie($,($.gzhead.text?1:0)+($.gzhead.hcrc?2:0)+($.gzhead.extra?4:0)+($.gzhead.name?8:0)+($.gzhead.comment?16:0)),Ie($,$.gzhead.time&255),Ie($,$.gzhead.time>>8&255),Ie($,$.gzhead.time>>16&255),Ie($,$.gzhead.time>>24&255),Ie($,$.level===9?2:$.strategy>=E||$.level<2?4:0),Ie($,$.gzhead.os&255),$.gzhead.extra&&$.gzhead.extra.length&&(Ie($,$.gzhead.extra.length&255),Ie($,$.gzhead.extra.length>>8&255)),$.gzhead.hcrc&&(L.adler=o(L.adler,$.pending_buf,$.pending,0)),$.gzindex=0,$.status=ne):(Ie($,0),Ie($,0),Ie($,0),Ie($,0),Ie($,0),Ie($,$.level===9?2:$.strategy>=E||$.level<2?4:0),Ie($,xe),$.status=le);else{var Fe=w+($.w_bits-8<<4)<<8,ke=-1;$.strategy>=E||$.level<2?ke=0:$.level<6?ke=1:$.level===6?ke=2:ke=3,Fe|=ke<<6,$.strstart!==0&&(Fe|=q),Fe+=31-Fe%31,$.status=le,ze($,Fe),$.strstart!==0&&(ze($,L.adler>>>16),ze($,L.adler&65535)),L.adler=1}if($.status===ne)if($.gzhead.extra){for(se=$.pending;$.gzindex<($.gzhead.extra.length&65535)&&!($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),Ge(L),se=$.pending,$.pending===$.pending_buf_size));)Ie($,$.gzhead.extra[$.gzindex]&255),$.gzindex++;$.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),$.gzindex===$.gzhead.extra.length&&($.gzindex=0,$.status=te)}else $.status=te;if($.status===te)if($.gzhead.name){se=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),Ge(L),se=$.pending,$.pending===$.pending_buf_size)){ce=1;break}$.gzindex<$.gzhead.name.length?ce=$.gzhead.name.charCodeAt($.gzindex++)&255:ce=0,Ie($,ce)}while(ce!==0);$.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),ce===0&&($.gzindex=0,$.status=oe)}else $.status=oe;if($.status===oe)if($.gzhead.comment){se=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),Ge(L),se=$.pending,$.pending===$.pending_buf_size)){ce=1;break}$.gzindex<$.gzhead.comment.length?ce=$.gzhead.comment.charCodeAt($.gzindex++)&255:ce=0,Ie($,ce)}while(ce!==0);$.gzhead.hcrc&&$.pending>se&&(L.adler=o(L.adler,$.pending_buf,$.pending-se,se)),ce===0&&($.status=re)}else $.status=re;if($.status===re&&($.gzhead.hcrc?($.pending+2>$.pending_buf_size&&Ge(L),$.pending+2<=$.pending_buf_size&&(Ie($,L.adler&255),Ie($,L.adler>>8&255),L.adler=0,$.status=le)):$.status=le),$.pending!==0){if(Ge(L),L.avail_out===0)return $.last_flush=-1,_}else if(L.avail_in===0&&ie(ge)<=ie(de)&&ge!==m)return we(L,c);if($.status===Ce&&L.avail_in!==0)return we(L,c);if(L.avail_in!==0||$.lookahead!==0||ge!==h&&$.status!==Ce){var Ee=$.strategy===E?pe($,ge):$.strategy===C?X($,ge):ye[$.level].func($,ge);if((Ee===_e||Ee===Z)&&($.status=Ce),Ee===De||Ee===_e)return L.avail_out===0&&($.last_flush=-1),_;if(Ee===Oe&&(ge===d?r._tr_align($):ge!==v&&(r._tr_stored_block($,0,0,!1),ge===u&&(Ne($.head),$.lookahead===0&&($.strstart=0,$.block_start=0,$.insert=0))),Ge(L),L.avail_out===0))return $.last_flush=-1,_}return ge!==m?_:$.wrap<=0?D:($.wrap===2?(Ie($,L.adler&255),Ie($,L.adler>>8&255),Ie($,L.adler>>16&255),Ie($,L.adler>>24&255),Ie($,L.total_in&255),Ie($,L.total_in>>8&255),Ie($,L.total_in>>16&255),Ie($,L.total_in>>24&255)):(ze($,L.adler>>>16),ze($,L.adler&65535)),Ge(L),$.wrap>0&&($.wrap=-$.wrap),$.pending!==0?_:D)}function Te(L){var ge;return!L||!L.state?f:(ge=L.state.status,ge!==Q&&ge!==ne&&ge!==te&&ge!==oe&&ge!==re&&ge!==le&&ge!==Ce?we(L,f):(L.state=null,ge===le?we(L,l):_))}function Be(L,ge){var de=ge.length,$,se,ce,Fe,ke,Ee,$e,Xe;if(!L||!L.state||($=L.state,Fe=$.wrap,Fe===2||Fe===1&&$.status!==Q||$.lookahead))return f;for(Fe===1&&(L.adler=s(L.adler,ge,de,0)),$.wrap=0,de>=$.w_size&&(Fe===0&&(Ne($.head),$.strstart=0,$.block_start=0,$.insert=0),Xe=new i.Buf8($.w_size),i.arraySet(Xe,ge,de-$.w_size,$.w_size,0),ge=Xe,de=$.w_size),ke=L.avail_in,Ee=L.next_in,$e=L.input,L.avail_in=de,L.next_in=0,L.input=ge,We($);$.lookahead>=R;){se=$.strstart,ce=$.lookahead-(R-1);do $.ins_h=($.ins_h<<$.hash_shift^$.window[se+R-1])&$.hash_mask,$.prev[se&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=se,se++;while(--ce);$.strstart=se,$.lookahead=R-1,We($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=R-1,$.match_available=0,L.next_in=Ee,L.input=$e,L.avail_in=ke,$.wrap=Fe,_}e.deflateInit=me,e.deflateInit2=ae,e.deflateReset=ve,e.deflateResetKeep=he,e.deflateSetHeader=Pe,e.deflate=j,e.deflateEnd=Te,e.deflateSetDictionary=Be,e.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":n=>{function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}n.exports=e},"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":n=>{var e=30,t=12;n.exports=function(r,s){var o,a,h,d,u,m,v,_,D,f,l,c,p,b,E,C,g,x,y,w,M,S,O,P,I;o=r.state,a=r.next_in,P=r.input,h=a+(r.avail_in-5),d=r.next_out,I=r.output,u=d-(s-r.avail_out),m=d+(r.avail_out-257),v=o.dmax,_=o.wsize,D=o.whave,f=o.wnext,l=o.window,c=o.hold,p=o.bits,b=o.lencode,E=o.distcode,C=(1<<o.lenbits)-1,g=(1<<o.distbits)-1;e:do{p<15&&(c+=P[a++]<<p,p+=8,c+=P[a++]<<p,p+=8),x=b[c&C];t:for(;;){if(y=x>>>24,c>>>=y,p-=y,y=x>>>16&255,y===0)I[d++]=x&65535;else if(y&16){w=x&65535,y&=15,y&&(p<y&&(c+=P[a++]<<p,p+=8),w+=c&(1<<y)-1,c>>>=y,p-=y),p<15&&(c+=P[a++]<<p,p+=8,c+=P[a++]<<p,p+=8),x=E[c&g];i:for(;;){if(y=x>>>24,c>>>=y,p-=y,y=x>>>16&255,y&16){if(M=x&65535,y&=15,p<y&&(c+=P[a++]<<p,p+=8,p<y&&(c+=P[a++]<<p,p+=8)),M+=c&(1<<y)-1,M>v){r.msg="invalid distance too far back",o.mode=e;break e}if(c>>>=y,p-=y,y=d-u,M>y){if(y=M-y,y>D&&o.sane){r.msg="invalid distance too far back",o.mode=e;break e}if(S=0,O=l,f===0){if(S+=_-y,y<w){w-=y;do I[d++]=l[S++];while(--y);S=d-M,O=I}}else if(f<y){if(S+=_+f-y,y-=f,y<w){w-=y;do I[d++]=l[S++];while(--y);if(S=0,f<w){y=f,w-=y;do I[d++]=l[S++];while(--y);S=d-M,O=I}}}else if(S+=f-y,y<w){w-=y;do I[d++]=l[S++];while(--y);S=d-M,O=I}for(;w>2;)I[d++]=O[S++],I[d++]=O[S++],I[d++]=O[S++],w-=3;w&&(I[d++]=O[S++],w>1&&(I[d++]=O[S++]))}else{S=d-M;do I[d++]=I[S++],I[d++]=I[S++],I[d++]=I[S++],w-=3;while(w>2);w&&(I[d++]=I[S++],w>1&&(I[d++]=I[S++]))}}else if((y&64)===0){x=E[(x&65535)+(c&(1<<y)-1)];continue i}else{r.msg="invalid distance code",o.mode=e;break e}break}}else if((y&64)===0){x=b[(x&65535)+(c&(1<<y)-1)];continue t}else if(y&32){o.mode=t;break e}else{r.msg="invalid literal/length code",o.mode=e;break e}break}}while(a<h&&d<m);w=p>>3,a-=w,p-=w<<3,c&=(1<<p)-1,r.next_in=a,r.next_out=d,r.avail_in=a<h?5+(h-a):5-(a-h),r.avail_out=d<m?257+(m-d):257-(d-m),o.hold=c,o.bits=p}},"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),r=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),h=0,d=1,u=2,m=4,v=5,_=6,D=0,f=1,l=2,c=-2,p=-3,b=-4,E=-5,C=8,g=1,x=2,y=3,w=4,M=5,S=6,O=7,P=8,I=9,F=10,k=11,B=12,U=13,W=14,R=15,z=16,G=17,q=18,Q=19,ne=20,te=21,oe=22,re=23,le=24,Ce=25,De=26,Oe=27,_e=28,Z=29,xe=30,we=31,ie=32,Ne=852,Ge=592,Ue=15,Ie=Ue;function ze(ae){return(ae>>>24&255)+(ae>>>8&65280)+((ae&65280)<<8)+((ae&255)<<24)}function Re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Le(ae){var me;return!ae||!ae.state?c:(me=ae.state,ae.total_in=ae.total_out=me.total=0,ae.msg="",me.wrap&&(ae.adler=me.wrap&1),me.mode=g,me.last=0,me.havedict=0,me.dmax=32768,me.head=null,me.hold=0,me.bits=0,me.lencode=me.lendyn=new i.Buf32(Ne),me.distcode=me.distdyn=new i.Buf32(Ge),me.sane=1,me.back=-1,D)}function We(ae){var me;return!ae||!ae.state?c:(me=ae.state,me.wsize=0,me.whave=0,me.wnext=0,Le(ae))}function He(ae,me){var j,Te;return!ae||!ae.state||(Te=ae.state,me<0?(j=0,me=-me):(j=(me>>4)+1,me<48&&(me&=15)),me&&(me<8||me>15))?c:(Te.window!==null&&Te.wbits!==me&&(Te.window=null),Te.wrap=j,Te.wbits=me,We(ae))}function H(ae,me){var j,Te;return ae?(Te=new Re,ae.state=Te,Te.window=null,j=He(ae,me),j!==D&&(ae.state=null),j):c}function K(ae){return H(ae,Ie)}var X=!0,pe,ue;function ye(ae){if(X){var me;for(pe=new i.Buf32(512),ue=new i.Buf32(32),me=0;me<144;)ae.lens[me++]=8;for(;me<256;)ae.lens[me++]=9;for(;me<280;)ae.lens[me++]=7;for(;me<288;)ae.lens[me++]=8;for(a(d,ae.lens,0,288,pe,0,ae.work,{bits:9}),me=0;me<32;)ae.lens[me++]=5;a(u,ae.lens,0,32,ue,0,ae.work,{bits:5}),X=!1}ae.lencode=pe,ae.lenbits=9,ae.distcode=ue,ae.distbits=5}function Se(ae,me,j,Te){var Be,L=ae.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new i.Buf8(L.wsize)),Te>=L.wsize?(i.arraySet(L.window,me,j-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(Be=L.wsize-L.wnext,Be>Te&&(Be=Te),i.arraySet(L.window,me,j-Te,Be,L.wnext),Te-=Be,Te?(i.arraySet(L.window,me,j-Te,Te,0),L.wnext=Te,L.whave=L.wsize):(L.wnext+=Be,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=Be))),0}function V(ae,me){var j,Te,Be,L,ge,de,$,se,ce,Fe,ke,Ee,$e,Xe,Ke=0,Je,Ye,nt,st,_t,ut,et,ht,tt=new i.Buf8(4),bt,Dt,Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ae||!ae.state||!ae.output||!ae.input&&ae.avail_in!==0)return c;j=ae.state,j.mode===B&&(j.mode=U),ge=ae.next_out,Be=ae.output,$=ae.avail_out,L=ae.next_in,Te=ae.input,de=ae.avail_in,se=j.hold,ce=j.bits,Fe=de,ke=$,ht=D;e:for(;;)switch(j.mode){case g:if(j.wrap===0){j.mode=U;break}for(;ce<16;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(j.wrap&2&&se===35615){j.check=0,tt[0]=se&255,tt[1]=se>>>8&255,j.check=s(j.check,tt,2,0),se=0,ce=0,j.mode=x;break}if(j.flags=0,j.head&&(j.head.done=!1),!(j.wrap&1)||(((se&255)<<8)+(se>>8))%31){ae.msg="incorrect header check",j.mode=xe;break}if((se&15)!==C){ae.msg="unknown compression method",j.mode=xe;break}if(se>>>=4,ce-=4,et=(se&15)+8,j.wbits===0)j.wbits=et;else if(et>j.wbits){ae.msg="invalid window size",j.mode=xe;break}j.dmax=1<<et,ae.adler=j.check=1,j.mode=se&512?F:B,se=0,ce=0;break;case x:for(;ce<16;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(j.flags=se,(j.flags&255)!==C){ae.msg="unknown compression method",j.mode=xe;break}if(j.flags&57344){ae.msg="unknown header flags set",j.mode=xe;break}j.head&&(j.head.text=se>>8&1),j.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,j.check=s(j.check,tt,2,0)),se=0,ce=0,j.mode=y;case y:for(;ce<32;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.head&&(j.head.time=se),j.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,tt[2]=se>>>16&255,tt[3]=se>>>24&255,j.check=s(j.check,tt,4,0)),se=0,ce=0,j.mode=w;case w:for(;ce<16;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.head&&(j.head.xflags=se&255,j.head.os=se>>8),j.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,j.check=s(j.check,tt,2,0)),se=0,ce=0,j.mode=M;case M:if(j.flags&1024){for(;ce<16;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.length=se,j.head&&(j.head.extra_len=se),j.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,j.check=s(j.check,tt,2,0)),se=0,ce=0}else j.head&&(j.head.extra=null);j.mode=S;case S:if(j.flags&1024&&(Ee=j.length,Ee>de&&(Ee=de),Ee&&(j.head&&(et=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),i.arraySet(j.head.extra,Te,L,Ee,et)),j.flags&512&&(j.check=s(j.check,Te,Ee,L)),de-=Ee,L+=Ee,j.length-=Ee),j.length))break e;j.length=0,j.mode=O;case O:if(j.flags&2048){if(de===0)break e;Ee=0;do et=Te[L+Ee++],j.head&&et&&j.length<65536&&(j.head.name+=String.fromCharCode(et));while(et&&Ee<de);if(j.flags&512&&(j.check=s(j.check,Te,Ee,L)),de-=Ee,L+=Ee,et)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=P;case P:if(j.flags&4096){if(de===0)break e;Ee=0;do et=Te[L+Ee++],j.head&&et&&j.length<65536&&(j.head.comment+=String.fromCharCode(et));while(et&&Ee<de);if(j.flags&512&&(j.check=s(j.check,Te,Ee,L)),de-=Ee,L+=Ee,et)break e}else j.head&&(j.head.comment=null);j.mode=I;case I:if(j.flags&512){for(;ce<16;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(se!==(j.check&65535)){ae.msg="header crc mismatch",j.mode=xe;break}se=0,ce=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),ae.adler=j.check=0,j.mode=B;break;case F:for(;ce<32;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}ae.adler=j.check=ze(se),se=0,ce=0,j.mode=k;case k:if(j.havedict===0)return ae.next_out=ge,ae.avail_out=$,ae.next_in=L,ae.avail_in=de,j.hold=se,j.bits=ce,l;ae.adler=j.check=1,j.mode=B;case B:if(me===v||me===_)break e;case U:if(j.last){se>>>=ce&7,ce-=ce&7,j.mode=Oe;break}for(;ce<3;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}switch(j.last=se&1,se>>>=1,ce-=1,se&3){case 0:j.mode=W;break;case 1:if(ye(j),j.mode=ne,me===_){se>>>=2,ce-=2;break e}break;case 2:j.mode=G;break;case 3:ae.msg="invalid block type",j.mode=xe}se>>>=2,ce-=2;break;case W:for(se>>>=ce&7,ce-=ce&7;ce<32;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if((se&65535)!==(se>>>16^65535)){ae.msg="invalid stored block lengths",j.mode=xe;break}if(j.length=se&65535,se=0,ce=0,j.mode=R,me===_)break e;case R:j.mode=z;case z:if(Ee=j.length,Ee){if(Ee>de&&(Ee=de),Ee>$&&(Ee=$),Ee===0)break e;i.arraySet(Be,Te,L,Ee,ge),de-=Ee,L+=Ee,$-=Ee,ge+=Ee,j.length-=Ee;break}j.mode=B;break;case G:for(;ce<14;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(j.nlen=(se&31)+257,se>>>=5,ce-=5,j.ndist=(se&31)+1,se>>>=5,ce-=5,j.ncode=(se&15)+4,se>>>=4,ce-=4,j.nlen>286||j.ndist>30){ae.msg="too many length or distance symbols",j.mode=xe;break}j.have=0,j.mode=q;case q:for(;j.have<j.ncode;){for(;ce<3;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.lens[Et[j.have++]]=se&7,se>>>=3,ce-=3}for(;j.have<19;)j.lens[Et[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,bt={bits:j.lenbits},ht=a(h,j.lens,0,19,j.lencode,0,j.work,bt),j.lenbits=bt.bits,ht){ae.msg="invalid code lengths set",j.mode=xe;break}j.have=0,j.mode=Q;case Q:for(;j.have<j.nlen+j.ndist;){for(;Ke=j.lencode[se&(1<<j.lenbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,nt=Ke&65535,!(Je<=ce);){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(nt<16)se>>>=Je,ce-=Je,j.lens[j.have++]=nt;else{if(nt===16){for(Dt=Je+2;ce<Dt;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(se>>>=Je,ce-=Je,j.have===0){ae.msg="invalid bit length repeat",j.mode=xe;break}et=j.lens[j.have-1],Ee=3+(se&3),se>>>=2,ce-=2}else if(nt===17){for(Dt=Je+3;ce<Dt;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}se>>>=Je,ce-=Je,et=0,Ee=3+(se&7),se>>>=3,ce-=3}else{for(Dt=Je+7;ce<Dt;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}se>>>=Je,ce-=Je,et=0,Ee=11+(se&127),se>>>=7,ce-=7}if(j.have+Ee>j.nlen+j.ndist){ae.msg="invalid bit length repeat",j.mode=xe;break}for(;Ee--;)j.lens[j.have++]=et}}if(j.mode===xe)break;if(j.lens[256]===0){ae.msg="invalid code -- missing end-of-block",j.mode=xe;break}if(j.lenbits=9,bt={bits:j.lenbits},ht=a(d,j.lens,0,j.nlen,j.lencode,0,j.work,bt),j.lenbits=bt.bits,ht){ae.msg="invalid literal/lengths set",j.mode=xe;break}if(j.distbits=6,j.distcode=j.distdyn,bt={bits:j.distbits},ht=a(u,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,bt),j.distbits=bt.bits,ht){ae.msg="invalid distances set",j.mode=xe;break}if(j.mode=ne,me===_)break e;case ne:j.mode=te;case te:if(de>=6&&$>=258){ae.next_out=ge,ae.avail_out=$,ae.next_in=L,ae.avail_in=de,j.hold=se,j.bits=ce,o(ae,ke),ge=ae.next_out,Be=ae.output,$=ae.avail_out,L=ae.next_in,Te=ae.input,de=ae.avail_in,se=j.hold,ce=j.bits,j.mode===B&&(j.back=-1);break}for(j.back=0;Ke=j.lencode[se&(1<<j.lenbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,nt=Ke&65535,!(Je<=ce);){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(Ye&&(Ye&240)===0){for(st=Je,_t=Ye,ut=nt;Ke=j.lencode[ut+((se&(1<<st+_t)-1)>>st)],Je=Ke>>>24,Ye=Ke>>>16&255,nt=Ke&65535,!(st+Je<=ce);){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}se>>>=st,ce-=st,j.back+=st}if(se>>>=Je,ce-=Je,j.back+=Je,j.length=nt,Ye===0){j.mode=De;break}if(Ye&32){j.back=-1,j.mode=B;break}if(Ye&64){ae.msg="invalid literal/length code",j.mode=xe;break}j.extra=Ye&15,j.mode=oe;case oe:if(j.extra){for(Dt=j.extra;ce<Dt;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.length+=se&(1<<j.extra)-1,se>>>=j.extra,ce-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=re;case re:for(;Ke=j.distcode[se&(1<<j.distbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,nt=Ke&65535,!(Je<=ce);){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if((Ye&240)===0){for(st=Je,_t=Ye,ut=nt;Ke=j.distcode[ut+((se&(1<<st+_t)-1)>>st)],Je=Ke>>>24,Ye=Ke>>>16&255,nt=Ke&65535,!(st+Je<=ce);){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}se>>>=st,ce-=st,j.back+=st}if(se>>>=Je,ce-=Je,j.back+=Je,Ye&64){ae.msg="invalid distance code",j.mode=xe;break}j.offset=nt,j.extra=Ye&15,j.mode=le;case le:if(j.extra){for(Dt=j.extra;ce<Dt;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}j.offset+=se&(1<<j.extra)-1,se>>>=j.extra,ce-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){ae.msg="invalid distance too far back",j.mode=xe;break}j.mode=Ce;case Ce:if($===0)break e;if(Ee=ke-$,j.offset>Ee){if(Ee=j.offset-Ee,Ee>j.whave&&j.sane){ae.msg="invalid distance too far back",j.mode=xe;break}Ee>j.wnext?(Ee-=j.wnext,$e=j.wsize-Ee):$e=j.wnext-Ee,Ee>j.length&&(Ee=j.length),Xe=j.window}else Xe=Be,$e=ge-j.offset,Ee=j.length;Ee>$&&(Ee=$),$-=Ee,j.length-=Ee;do Be[ge++]=Xe[$e++];while(--Ee);j.length===0&&(j.mode=te);break;case De:if($===0)break e;Be[ge++]=j.length,$--,j.mode=te;break;case Oe:if(j.wrap){for(;ce<32;){if(de===0)break e;de--,se|=Te[L++]<<ce,ce+=8}if(ke-=$,ae.total_out+=ke,j.total+=ke,ke&&(ae.adler=j.check=j.flags?s(j.check,Be,ke,ge-ke):r(j.check,Be,ke,ge-ke)),ke=$,(j.flags?se:ze(se))!==j.check){ae.msg="incorrect data check",j.mode=xe;break}se=0,ce=0}j.mode=_e;case _e:if(j.wrap&&j.flags){for(;ce<32;){if(de===0)break e;de--,se+=Te[L++]<<ce,ce+=8}if(se!==(j.total&4294967295)){ae.msg="incorrect length check",j.mode=xe;break}se=0,ce=0}j.mode=Z;case Z:ht=f;break e;case xe:ht=p;break e;case we:return b;case ie:default:return c}return ae.next_out=ge,ae.avail_out=$,ae.next_in=L,ae.avail_in=de,j.hold=se,j.bits=ce,(j.wsize||ke!==ae.avail_out&&j.mode<xe&&(j.mode<Oe||me!==m))&&Se(ae,ae.output,ae.next_out,ke-ae.avail_out),Fe-=ae.avail_in,ke-=ae.avail_out,ae.total_in+=Fe,ae.total_out+=ke,j.total+=ke,j.wrap&&ke&&(ae.adler=j.check=j.flags?s(j.check,Be,ke,ae.next_out-ke):r(j.check,Be,ke,ae.next_out-ke)),ae.data_type=j.bits+(j.last?64:0)+(j.mode===B?128:0)+(j.mode===ne||j.mode===R?256:0),(Fe===0&&ke===0||me===m)&&ht===D&&(ht=E),ht}function he(ae){if(!ae||!ae.state)return c;var me=ae.state;return me.window&&(me.window=null),ae.state=null,D}function ve(ae,me){var j;return!ae||!ae.state||(j=ae.state,(j.wrap&2)===0)?c:(j.head=me,me.done=!1,D)}function Pe(ae,me){var j=me.length,Te,Be,L;return!ae||!ae.state||(Te=ae.state,Te.wrap!==0&&Te.mode!==k)?c:Te.mode===k&&(Be=1,Be=r(Be,me,j,0),Be!==Te.check)?p:(L=Se(ae,me,j,j),L?(Te.mode=we,b):(Te.havedict=1,D))}e.inflateReset=We,e.inflateReset2=He,e.inflateResetKeep=Le,e.inflateInit=K,e.inflateInit2=H,e.inflate=V,e.inflateEnd=he,e.inflateGetHeader=ve,e.inflateSetDictionary=Pe,e.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),r=15,s=852,o=592,a=0,h=1,d=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(f,l,c,p,b,E,C,g){var x=g.bits,y=0,w=0,M=0,S=0,O=0,P=0,I=0,F=0,k=0,B=0,U,W,R,z,G,q=null,Q=0,ne,te=new i.Buf16(r+1),oe=new i.Buf16(r+1),re=null,le=0,Ce,De,Oe;for(y=0;y<=r;y++)te[y]=0;for(w=0;w<p;w++)te[l[c+w]]++;for(O=x,S=r;S>=1&&te[S]===0;S--);if(O>S&&(O=S),S===0)return b[E++]=20971520,b[E++]=20971520,g.bits=1,0;for(M=1;M<S&&te[M]===0;M++);for(O<M&&(O=M),F=1,y=1;y<=r;y++)if(F<<=1,F-=te[y],F<0)return-1;if(F>0&&(f===a||S!==1))return-1;for(oe[1]=0,y=1;y<r;y++)oe[y+1]=oe[y]+te[y];for(w=0;w<p;w++)l[c+w]!==0&&(C[oe[l[c+w]]++]=w);if(f===a?(q=re=C,ne=19):f===h?(q=u,Q-=257,re=m,le-=257,ne=256):(q=v,re=_,ne=-1),B=0,w=0,y=M,G=E,P=O,I=0,R=-1,k=1<<O,z=k-1,f===h&&k>s||f===d&&k>o)return 1;for(;;){Ce=y-I,C[w]<ne?(De=0,Oe=C[w]):C[w]>ne?(De=re[le+C[w]],Oe=q[Q+C[w]]):(De=96,Oe=0),U=1<<y-I,W=1<<P,M=W;do W-=U,b[G+(B>>I)+W]=Ce<<24|De<<16|Oe|0;while(W!==0);for(U=1<<y-1;B&U;)U>>=1;if(U!==0?(B&=U-1,B+=U):B=0,w++,--te[y]===0){if(y===S)break;y=l[c+C[w]]}if(y>O&&(B&z)!==R){for(I===0&&(I=O),G+=M,P=y-I,F=1<<P;P+I<S&&(F-=te[P+I],!(F<=0));)P++,F<<=1;if(k+=1<<P,f===h&&k>s||f===d&&k>o)return 1;R=B&z,b[R]=O<<24|P<<16|G-E|0}}return B!==0&&(b[G+B]=y-I<<24|4194304|0),g.bits=O,0}},"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":n=>{n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":(n,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),r=4,s=0,o=1,a=2;function h(V){for(var he=V.length;--he>=0;)V[he]=0}var d=0,u=1,m=2,v=3,_=258,D=29,f=256,l=f+1+D,c=30,p=19,b=2*l+1,E=15,C=16,g=7,x=256,y=16,w=17,M=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=512,k=new Array((l+2)*2);h(k);var B=new Array(c*2);h(B);var U=new Array(F);h(U);var W=new Array(_-v+1);h(W);var R=new Array(D);h(R);var z=new Array(c);h(z);function G(V,he,ve,Pe,ae){this.static_tree=V,this.extra_bits=he,this.extra_base=ve,this.elems=Pe,this.max_length=ae,this.has_stree=V&&V.length}var q,Q,ne;function te(V,he){this.dyn_tree=V,this.max_code=0,this.stat_desc=he}function oe(V){return V<256?U[V]:U[256+(V>>>7)]}function re(V,he){V.pending_buf[V.pending++]=he&255,V.pending_buf[V.pending++]=he>>>8&255}function le(V,he,ve){V.bi_valid>C-ve?(V.bi_buf|=he<<V.bi_valid&65535,re(V,V.bi_buf),V.bi_buf=he>>C-V.bi_valid,V.bi_valid+=ve-C):(V.bi_buf|=he<<V.bi_valid&65535,V.bi_valid+=ve)}function Ce(V,he,ve){le(V,ve[he*2],ve[he*2+1])}function De(V,he){var ve=0;do ve|=V&1,V>>>=1,ve<<=1;while(--he>0);return ve>>>1}function Oe(V){V.bi_valid===16?(re(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):V.bi_valid>=8&&(V.pending_buf[V.pending++]=V.bi_buf&255,V.bi_buf>>=8,V.bi_valid-=8)}function _e(V,he){var ve=he.dyn_tree,Pe=he.max_code,ae=he.stat_desc.static_tree,me=he.stat_desc.has_stree,j=he.stat_desc.extra_bits,Te=he.stat_desc.extra_base,Be=he.stat_desc.max_length,L,ge,de,$,se,ce,Fe=0;for($=0;$<=E;$++)V.bl_count[$]=0;for(ve[V.heap[V.heap_max]*2+1]=0,L=V.heap_max+1;L<b;L++)ge=V.heap[L],$=ve[ve[ge*2+1]*2+1]+1,$>Be&&($=Be,Fe++),ve[ge*2+1]=$,!(ge>Pe)&&(V.bl_count[$]++,se=0,ge>=Te&&(se=j[ge-Te]),ce=ve[ge*2],V.opt_len+=ce*($+se),me&&(V.static_len+=ce*(ae[ge*2+1]+se)));if(Fe!==0){do{for($=Be-1;V.bl_count[$]===0;)$--;V.bl_count[$]--,V.bl_count[$+1]+=2,V.bl_count[Be]--,Fe-=2}while(Fe>0);for($=Be;$!==0;$--)for(ge=V.bl_count[$];ge!==0;)de=V.heap[--L],!(de>Pe)&&(ve[de*2+1]!==$&&(V.opt_len+=($-ve[de*2+1])*ve[de*2],ve[de*2+1]=$),ge--)}}function Z(V,he,ve){var Pe=new Array(E+1),ae=0,me,j;for(me=1;me<=E;me++)Pe[me]=ae=ae+ve[me-1]<<1;for(j=0;j<=he;j++){var Te=V[j*2+1];Te!==0&&(V[j*2]=De(Pe[Te]++,Te))}}function xe(){var V,he,ve,Pe,ae,me=new Array(E+1);for(ve=0,Pe=0;Pe<D-1;Pe++)for(R[Pe]=ve,V=0;V<1<<S[Pe];V++)W[ve++]=Pe;for(W[ve-1]=Pe,ae=0,Pe=0;Pe<16;Pe++)for(z[Pe]=ae,V=0;V<1<<O[Pe];V++)U[ae++]=Pe;for(ae>>=7;Pe<c;Pe++)for(z[Pe]=ae<<7,V=0;V<1<<O[Pe]-7;V++)U[256+ae++]=Pe;for(he=0;he<=E;he++)me[he]=0;for(V=0;V<=143;)k[V*2+1]=8,V++,me[8]++;for(;V<=255;)k[V*2+1]=9,V++,me[9]++;for(;V<=279;)k[V*2+1]=7,V++,me[7]++;for(;V<=287;)k[V*2+1]=8,V++,me[8]++;for(Z(k,l+1,me),V=0;V<c;V++)B[V*2+1]=5,B[V*2]=De(V,5);q=new G(k,S,f+1,l,E),Q=new G(B,O,0,c,E),ne=new G(new Array(0),P,0,p,g)}function we(V){var he;for(he=0;he<l;he++)V.dyn_ltree[he*2]=0;for(he=0;he<c;he++)V.dyn_dtree[he*2]=0;for(he=0;he<p;he++)V.bl_tree[he*2]=0;V.dyn_ltree[x*2]=1,V.opt_len=V.static_len=0,V.last_lit=V.matches=0}function ie(V){V.bi_valid>8?re(V,V.bi_buf):V.bi_valid>0&&(V.pending_buf[V.pending++]=V.bi_buf),V.bi_buf=0,V.bi_valid=0}function Ne(V,he,ve,Pe){ie(V),re(V,ve),re(V,~ve),i.arraySet(V.pending_buf,V.window,he,ve,V.pending),V.pending+=ve}function Ge(V,he,ve,Pe){var ae=he*2,me=ve*2;return V[ae]<V[me]||V[ae]===V[me]&&Pe[he]<=Pe[ve]}function Ue(V,he,ve){for(var Pe=V.heap[ve],ae=ve<<1;ae<=V.heap_len&&(ae<V.heap_len&&Ge(he,V.heap[ae+1],V.heap[ae],V.depth)&&ae++,!Ge(he,Pe,V.heap[ae],V.depth));)V.heap[ve]=V.heap[ae],ve=ae,ae<<=1;V.heap[ve]=Pe}function Ie(V,he,ve){var Pe,ae,me=0,j,Te;if(V.last_lit!==0)do Pe=V.pending_buf[V.d_buf+me*2]<<8|V.pending_buf[V.d_buf+me*2+1],ae=V.pending_buf[V.l_buf+me],me++,Pe===0?Ce(V,ae,he):(j=W[ae],Ce(V,j+f+1,he),Te=S[j],Te!==0&&(ae-=R[j],le(V,ae,Te)),Pe--,j=oe(Pe),Ce(V,j,ve),Te=O[j],Te!==0&&(Pe-=z[j],le(V,Pe,Te)));while(me<V.last_lit);Ce(V,x,he)}function ze(V,he){var ve=he.dyn_tree,Pe=he.stat_desc.static_tree,ae=he.stat_desc.has_stree,me=he.stat_desc.elems,j,Te,Be=-1,L;for(V.heap_len=0,V.heap_max=b,j=0;j<me;j++)ve[j*2]!==0?(V.heap[++V.heap_len]=Be=j,V.depth[j]=0):ve[j*2+1]=0;for(;V.heap_len<2;)L=V.heap[++V.heap_len]=Be<2?++Be:0,ve[L*2]=1,V.depth[L]=0,V.opt_len--,ae&&(V.static_len-=Pe[L*2+1]);for(he.max_code=Be,j=V.heap_len>>1;j>=1;j--)Ue(V,ve,j);L=me;do j=V.heap[1],V.heap[1]=V.heap[V.heap_len--],Ue(V,ve,1),Te=V.heap[1],V.heap[--V.heap_max]=j,V.heap[--V.heap_max]=Te,ve[L*2]=ve[j*2]+ve[Te*2],V.depth[L]=(V.depth[j]>=V.depth[Te]?V.depth[j]:V.depth[Te])+1,ve[j*2+1]=ve[Te*2+1]=L,V.heap[1]=L++,Ue(V,ve,1);while(V.heap_len>=2);V.heap[--V.heap_max]=V.heap[1],_e(V,he),Z(ve,Be,V.bl_count)}function Re(V,he,ve){var Pe,ae=-1,me,j=he[0*2+1],Te=0,Be=7,L=4;for(j===0&&(Be=138,L=3),he[(ve+1)*2+1]=65535,Pe=0;Pe<=ve;Pe++)me=j,j=he[(Pe+1)*2+1],!(++Te<Be&&me===j)&&(Te<L?V.bl_tree[me*2]+=Te:me!==0?(me!==ae&&V.bl_tree[me*2]++,V.bl_tree[y*2]++):Te<=10?V.bl_tree[w*2]++:V.bl_tree[M*2]++,Te=0,ae=me,j===0?(Be=138,L=3):me===j?(Be=6,L=3):(Be=7,L=4))}function Le(V,he,ve){var Pe,ae=-1,me,j=he[0*2+1],Te=0,Be=7,L=4;for(j===0&&(Be=138,L=3),Pe=0;Pe<=ve;Pe++)if(me=j,j=he[(Pe+1)*2+1],!(++Te<Be&&me===j)){if(Te<L)do Ce(V,me,V.bl_tree);while(--Te!==0);else me!==0?(me!==ae&&(Ce(V,me,V.bl_tree),Te--),Ce(V,y,V.bl_tree),le(V,Te-3,2)):Te<=10?(Ce(V,w,V.bl_tree),le(V,Te-3,3)):(Ce(V,M,V.bl_tree),le(V,Te-11,7));Te=0,ae=me,j===0?(Be=138,L=3):me===j?(Be=6,L=3):(Be=7,L=4)}}function We(V){var he;for(Re(V,V.dyn_ltree,V.l_desc.max_code),Re(V,V.dyn_dtree,V.d_desc.max_code),ze(V,V.bl_desc),he=p-1;he>=3&&V.bl_tree[I[he]*2+1]===0;he--);return V.opt_len+=3*(he+1)+5+5+4,he}function He(V,he,ve,Pe){var ae;for(le(V,he-257,5),le(V,ve-1,5),le(V,Pe-4,4),ae=0;ae<Pe;ae++)le(V,V.bl_tree[I[ae]*2+1],3);Le(V,V.dyn_ltree,he-1),Le(V,V.dyn_dtree,ve-1)}function H(V){var he=4093624447,ve;for(ve=0;ve<=31;ve++,he>>>=1)if(he&1&&V.dyn_ltree[ve*2]!==0)return s;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return o;for(ve=32;ve<f;ve++)if(V.dyn_ltree[ve*2]!==0)return o;return s}var K=!1;function X(V){K||(xe(),K=!0),V.l_desc=new te(V.dyn_ltree,q),V.d_desc=new te(V.dyn_dtree,Q),V.bl_desc=new te(V.bl_tree,ne),V.bi_buf=0,V.bi_valid=0,we(V)}function pe(V,he,ve,Pe){le(V,(d<<1)+(Pe?1:0),3),Ne(V,he,ve)}function ue(V){le(V,u<<1,3),Ce(V,x,k),Oe(V)}function ye(V,he,ve,Pe){var ae,me,j=0;V.level>0?(V.strm.data_type===a&&(V.strm.data_type=H(V)),ze(V,V.l_desc),ze(V,V.d_desc),j=We(V),ae=V.opt_len+3+7>>>3,me=V.static_len+3+7>>>3,me<=ae&&(ae=me)):ae=me=ve+5,ve+4<=ae&&he!==-1?pe(V,he,ve,Pe):V.strategy===r||me===ae?(le(V,(u<<1)+(Pe?1:0),3),Ie(V,k,B)):(le(V,(m<<1)+(Pe?1:0),3),He(V,V.l_desc.max_code+1,V.d_desc.max_code+1,j+1),Ie(V,V.dyn_ltree,V.dyn_dtree)),we(V),Pe&&ie(V)}function Se(V,he,ve){return V.pending_buf[V.d_buf+V.last_lit*2]=he>>>8&255,V.pending_buf[V.d_buf+V.last_lit*2+1]=he&255,V.pending_buf[V.l_buf+V.last_lit]=ve&255,V.last_lit++,he===0?V.dyn_ltree[ve*2]++:(V.matches++,he--,V.dyn_ltree[(W[ve]+f+1)*2]++,V.dyn_dtree[oe(he)*2]++),V.last_lit===V.lit_bufsize-1}e._tr_init=X,e._tr_stored_block=pe,e._tr_flush_block=ye,e._tr_tally=Se,e._tr_align=ue},"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":n=>{function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}n.exports=e},"./src/3Dmol.ts":(n,e,t)=>{t.r(e),t.d(e,{CAP:()=>o.CAP,CC:()=>r.CC,CONTEXTS_PER_VIEWPORT:()=>d.CONTEXTS_PER_VIEWPORT,Color:()=>r.Color,CustomLinear:()=>u.CustomLinear,Cylinder:()=>b.Cylinder,GLDraw:()=>o.GLDraw,GLModel:()=>a.GLModel,GLShape:()=>h.GLShape,GLViewer:()=>d.GLViewer,GLVolumetricRender:()=>c.GLVolumetricRender,Gradient:()=>u.Gradient,GradientType:()=>u.GradientType,Label:()=>m.Label,LabelCount:()=>m.LabelCount,MarchingCube:()=>D.MarchingCube,MarchingCubeInitializer:()=>D.MarchingCubeInitializer,Matrix3:()=>p.Matrix3,Matrix4:()=>p.Matrix4,Parsers:()=>v.Parsers,PausableTimer:()=>f.PausableTimer,PointGrid:()=>D.PointGrid,ProteinSurface:()=>D.ProteinSurface,Quaternion:()=>p.Quaternion,ROYGB:()=>u.ROYGB,RWB:()=>u.RWB,Ray:()=>p.Ray,Sinebow:()=>u.Sinebow,Sphere:()=>b.Sphere,SurfaceType:()=>D.SurfaceType,Triangle:()=>b.Triangle,Vector2:()=>p.Vector2,Vector3:()=>p.Vector3,VolumeData:()=>l.VolumeData,adjustVolumeStyle:()=>f.adjustVolumeStyle,applyPartialCharges:()=>_.applyPartialCharges,autoinit:()=>i.autoinit,autoload:()=>i.autoload,base64ToArray:()=>f.base64ToArray,bondLength:()=>v.bondLength,builtinColorSchemes:()=>r.builtinColorSchemes,builtinGradients:()=>u.builtinGradients,chains:()=>r.chains,clamp:()=>p.clamp,conversionMatrix3:()=>p.conversionMatrix3,createStereoViewer:()=>d.createStereoViewer,createViewer:()=>d.createViewer,createViewerGrid:()=>d.createViewerGrid,deepCopy:()=>f.deepCopy,degToRad:()=>p.degToRad,download:()=>f.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>r.elementColors,extend:()=>f.extend,get:()=>f.get,getAtomProperty:()=>f.getAtomProperty,getColorFromStyle:()=>f.getColorFromStyle,getElement:()=>f.getElement,getExtent:()=>f.getExtent,getGradient:()=>u.getGradient,getPropertyRange:()=>f.getPropertyRange,getbin:()=>f.getbin,htmlColors:()=>r.htmlColors,inflateString:()=>f.inflateString,isEmptyObject:()=>f.isEmptyObject,isNumeric:()=>f.isNumeric,makeFunction:()=>f.makeFunction,mergeGeos:()=>f.mergeGeos,normalizeValue:()=>u.normalizeValue,partialCharges:()=>_.partialCharges,processing_autoinit:()=>i.processing_autoinit,residues:()=>r.residues,setBondLength:()=>v.setBondLength,setSyncSurface:()=>D.setSyncSurface,specStringToObject:()=>f.specStringToObject,splitMesh:()=>h.splitMesh,ssColors:()=>r.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>D.syncSurface,viewers:()=>i.viewers});var i=t("./src/autoload.ts"),r=t("./src/colors.ts"),s=t("./src/glcartoon.ts"),o=t("./src/GLDraw.ts"),a=t("./src/GLModel.ts"),h=t("./src/GLShape.ts"),d=t("./src/GLViewer.ts"),u=t("./src/Gradient.ts"),m=t("./src/Label.ts"),v=t("./src/parsers/index.ts"),_=t("./src/partialCharges.ts"),D=t("./src/ProteinSurface4.ts");t("./src/specs.ts");var f=t("./src/utilities.ts"),l=t("./src/VolumeData.ts"),c=t("./src/VolumetricRender.ts"),p=t("./src/WebGL/math/index.ts"),b=t("./src/WebGL/shapes/index.ts")},"./src/GLDraw.ts":(n,e,t)=>{t.r(e),t.d(e,{CAP:()=>r,GLDraw:()=>s});var i=t("./src/WebGL/math/index.ts"),r;(function(o){o[o.NONE=0]="NONE",o[o.FLAT=1]="FLAT",o[o.ROUND=2]="ROUND"})(r||(r={}));var s;(function(o){function a(f,l,c){var p=Math.hypot(f,l),b,E,C,g,x;p<1e-4?(E=0,C=1):(E=-f/p,C=l/p),l=-E*f+C*l,b=Math.hypot(l,c),b<1e-4?(g=0,x=1):(g=c/b,x=l/b);var y=new Float32Array(9);return y[0]=C,y[1]=E,y[2]=0,y[3]=-E*x,y[4]=C*x,y[5]=g,y[6]=E*g,y[7]=-C*g,y[8]=x,y}class h{constructor(){this.cache={};let l=[],c=4,p=Math.pow(2,c),b=2,E=Math.pow(2,b),C=p/E,g;for(l[0]=new i.Vector3(-1,0,0),l[C]=new i.Vector3(0,0,1),l[C*2]=new i.Vector3(1,0,0),l[C*3]=new i.Vector3(0,0,-1),b=3;b<=c;b++){for(E=Math.pow(2,b-1),C=p/E,g=0;g<E-1;g++)l[C/2+g*C]=l[g*C].clone().add(l[(g+1)*C]).normalize();g=E-1,l[C/2+g*C]=l[g*C].clone().add(l[0]).normalize()}this.basisVectors=l}getVerticesForRadius(l,c,p){if(typeof this.cache<"u"&&this.cache[l]!==void 0&&this.cache[l][c+p]!==void 0)return this.cache[l][c+p];for(var b=this.basisVectors.length,E=[],C=[],g,x=0;x<b;x++)E.push(this.basisVectors[x].clone().multiplyScalar(l)),E.push(this.basisVectors[x].clone().multiplyScalar(l)),g=this.basisVectors[x].clone().normalize(),C.push(g),C.push(g);var y=[],w=10,M=b,S=0,O=Math.PI*2,P=0,I=Math.PI,F,k,B=!1,U=!1;for(k=0;k<=w;k++){B=k===0||k===w,U=k===w/2;var W=[],R=[];for(F=0;F<=M;F++){if(U){var z=F<M?2*F:0;R.push(z+1),W.push(z);continue}var G=F/M,q=k/w;if(!B||F===0)if(F<M){var Q=new i.Vector3;Q.x=-l*Math.cos(S+G*O)*Math.sin(P+q*I),c==1?Q.y=0:Q.y=l*Math.cos(P+q*I),Q.z=l*Math.sin(S+G*O)*Math.sin(P+q*I),Math.abs(Q.x)<1e-5&&(Q.x=0),Math.abs(Q.y)<1e-5&&(Q.y=0),Math.abs(Q.z)<1e-5&&(Q.z=0),c==r.FLAT?(g=new i.Vector3(0,Math.cos(P+q*I),0),g.normalize()):(g=new i.Vector3(Q.x,Q.y,Q.z),g.normalize()),E.push(Q),C.push(g),W.push(E.length-1)}else W.push(E.length-M);else B&&W.push(E.length-1)}U&&y.push(R),y.push(W)}var ne={vertices:E,normals:C,verticesRows:y,w:M,h:w};return l in this.cache||(this.cache[l]={}),this.cache[l][c+p]=ne,ne}}var d=new h;function u(f,l,c,p,b,E=0,C=0){if(!l||!c)return;let g=function(ce){if(typeof ce=="string"){let Fe=ce;return Fe.toLowerCase()=="flat"?r.FLAT:Fe.toLowerCase()=="round"?r.ROUND:r.NONE}else return ce};E=g(E),C=g(C);var x=C||E;b=b||{r:0,g:0,b:0};var y=a(c.x-l.x,c.y-l.y,c.z-l.z),w=d.getVerticesForRadius(p,C,"to"),M=w.w,S=w.h,O=x?S*M+2:2*M,P=f.updateGeoGroup(O),I=w.vertices,F=w.normals,k=w.verticesRows,B=k[S/2],U=k[S/2+1],W=P.vertices,R,z,G,q,Q,ne,te=P.vertexArray,oe=P.normalArray,re=P.colorArray,le=P.faceArray;for(G=0;G<M;++G){var Ce=2*G;q=y[0]*I[Ce].x+y[3]*I[Ce].y+y[6]*I[Ce].z,Q=y[1]*I[Ce].x+y[4]*I[Ce].y+y[7]*I[Ce].z,ne=y[5]*I[Ce].y+y[8]*I[Ce].z,R=3*(W+Ce),z=P.faceidx,te[R]=q+l.x,te[R+1]=Q+l.y,te[R+2]=ne+l.z,te[R+3]=q+c.x,te[R+4]=Q+c.y,te[R+5]=ne+c.z,oe[R]=q,oe[R+3]=q,oe[R+1]=Q,oe[R+4]=Q,oe[R+2]=ne,oe[R+5]=ne,re[R]=b.r,re[R+3]=b.r,re[R+1]=b.g,re[R+4]=b.g,re[R+2]=b.b,re[R+5]=b.b,le[z]=U[G]+W,le[z+1]=U[G+1]+W,le[z+2]=B[G]+W,le[z+3]=B[G]+W,le[z+4]=U[G+1]+W,le[z+5]=B[G+1]+W,P.faceidx+=6}if(x){var De=C?0:S/2,Oe=E?S+1:S/2+1,_e,Z,xe,we,ie,Ne,Ge,Ue,Ie,ze,Re,Le,We,He,H,K,X,pe,ue,ye,Se,V,he,ve,Pe,ae,me,j,Te,Be,L,ge;for(Q=De;Q<Oe;Q++)if(Q!==S/2){var de=Q<=S/2?c:l,$=d.getVerticesForRadius(p,C,"to"),se=d.getVerticesForRadius(p,E,"from");for(de===c?(I=$.vertices,F=$.normals,k=$.verticesRows):de==l&&(I=se.vertices,F=se.normals,k=se.verticesRows),q=0;q<M;q++)z=P.faceidx,_e=k[Q][q+1],Te=(_e+W)*3,Z=k[Q][q],Be=(Z+W)*3,xe=k[Q+1][q],L=(xe+W)*3,we=k[Q+1][q+1],ge=(we+W)*3,ie=y[0]*I[_e].x+y[3]*I[_e].y+y[6]*I[_e].z,Ne=y[0]*I[Z].x+y[3]*I[Z].y+y[6]*I[Z].z,Ge=y[0]*I[xe].x+y[3]*I[xe].y+y[6]*I[xe].z,Ue=y[0]*I[we].x+y[3]*I[we].y+y[6]*I[we].z,Ie=y[1]*I[_e].x+y[4]*I[_e].y+y[7]*I[_e].z,ze=y[1]*I[Z].x+y[4]*I[Z].y+y[7]*I[Z].z,Re=y[1]*I[xe].x+y[4]*I[xe].y+y[7]*I[xe].z,Le=y[1]*I[we].x+y[4]*I[we].y+y[7]*I[we].z,We=y[5]*I[_e].y+y[8]*I[_e].z,He=y[5]*I[Z].y+y[8]*I[Z].z,H=y[5]*I[xe].y+y[8]*I[xe].z,K=y[5]*I[we].y+y[8]*I[we].z,te[Te]=ie+de.x,te[Be]=Ne+de.x,te[L]=Ge+de.x,te[ge]=Ue+de.x,te[Te+1]=Ie+de.y,te[Be+1]=ze+de.y,te[L+1]=Re+de.y,te[ge+1]=Le+de.y,te[Te+2]=We+de.z,te[Be+2]=He+de.z,te[L+2]=H+de.z,te[ge+2]=K+de.z,re[Te]=b.r,re[Be]=b.r,re[L]=b.r,re[ge]=b.r,re[Te+1]=b.g,re[Be+1]=b.g,re[L+1]=b.g,re[ge+1]=b.g,re[Te+2]=b.b,re[Be+2]=b.b,re[L+2]=b.b,re[ge+2]=b.b,X=y[0]*F[_e].x+y[3]*F[_e].y+y[6]*F[_e].z,pe=y[0]*F[Z].x+y[3]*F[Z].y+y[6]*F[Z].z,ue=y[0]*F[xe].x+y[3]*F[xe].y+y[6]*F[xe].z,ye=y[0]*F[we].x+y[3]*F[we].y+y[6]*F[we].z,Se=y[1]*F[_e].x+y[4]*F[_e].y+y[7]*F[_e].z,V=y[1]*F[Z].x+y[4]*F[Z].y+y[7]*F[Z].z,he=y[1]*F[xe].x+y[4]*F[xe].y+y[7]*F[xe].z,ve=y[1]*F[we].x+y[4]*F[we].y+y[7]*F[we].z,Pe=y[5]*F[_e].y+y[8]*F[_e].z,ae=y[5]*F[Z].y+y[8]*F[Z].z,me=y[5]*F[xe].y+y[8]*F[xe].z,j=y[5]*F[we].y+y[8]*F[we].z,Q===0?(oe[Te]=X,oe[L]=ue,oe[ge]=ye,oe[Te+1]=Se,oe[L+1]=he,oe[ge+1]=ve,oe[Te+2]=Pe,oe[L+2]=me,oe[ge+2]=j,le[z]=_e+W,le[z+1]=xe+W,le[z+2]=we+W,P.faceidx+=3):Q===Oe-1?(oe[Te]=X,oe[Be]=pe,oe[L]=ue,oe[Te+1]=Se,oe[Be+1]=V,oe[L+1]=he,oe[Te+2]=Pe,oe[Be+2]=ae,oe[L+2]=me,le[z]=_e+W,le[z+1]=Z+W,le[z+2]=xe+W,P.faceidx+=3):(oe[Te]=X,oe[Be]=pe,oe[ge]=ye,oe[Te+1]=Se,oe[Be+1]=V,oe[ge+1]=ve,oe[Te+2]=Pe,oe[Be+2]=ae,oe[ge+2]=j,oe[Be]=pe,oe[L]=ue,oe[ge]=ye,oe[Be+1]=V,oe[L+1]=he,oe[ge+1]=ve,oe[Be+2]=ae,oe[L+2]=me,oe[ge+2]=j,le[z]=_e+W,le[z+1]=Z+W,le[z+2]=we+W,le[z+3]=Z+W,le[z+4]=xe+W,le[z+5]=we+W,P.faceidx+=6)}}P.vertices+=O}o.drawCylinder=u;function m(f,l,c,p,b){if(!l||!c)return;b=b||{r:0,g:0,b:0};let E=new i.Vector3(c.x-l.x,c.y-l.y,c.z-l.z);var C=a(E.x,E.y,E.z);E=E.normalize();var g=d.basisVectors.length,x=d.basisVectors,y=g+2,w=f.updateGeoGroup(y),M=w.vertices,S,O,P,I,F,k,B=w.vertexArray,U=w.normalArray,W=w.colorArray,R=w.faceArray;for(S=M*3,B[S]=l.x,B[S+1]=l.y,B[S+2]=l.z,U[S]=-E.x,U[S+1]=-E.y,U[S+2]=-E.z,W[S]=b.r,W[S+1]=b.g,W[S+2]=b.b,B[S+3]=c.x,B[S+4]=c.y,B[S+5]=c.z,U[S+3]=E.x,U[S+4]=E.y,U[S+5]=E.z,W[S+3]=b.r,W[S+4]=b.g,W[S+5]=b.b,S+=6,P=0;P<g;++P){var z=x[P].clone();z.multiplyScalar(p),I=C[0]*z.x+C[3]*z.y+C[6]*z.z,F=C[1]*z.x+C[4]*z.y+C[7]*z.z,k=C[5]*z.y+C[8]*z.z,B[S]=I+l.x,B[S+1]=F+l.y,B[S+2]=k+l.z,U[S]=I,U[S+1]=F,U[S+2]=k,W[S]=b.r,W[S+1]=b.g,W[S+2]=b.b,S+=3}for(w.vertices+=g+2,O=w.faceidx,P=0;P<g;P++){var G=M+2+P,q=M+2+(P+1)%g;R[O]=G,R[O+1]=q,R[O+2]=M,O+=3,R[O]=G,R[O+1]=q,R[O+2]=M+1,O+=3}w.faceidx+=6*g}o.drawCone=m;class v{constructor(){this.cache=new Map}getVerticesForRadius(l,c){c=c||2,this.cache.has(c)||this.cache.set(c,new Map);let p=this.cache.get(c);if(p.has(l))return p.get(l);var b={vertices:[],verticesRows:[],normals:[]},E=16*c,C=10*c;l<1&&(E=10*c,C=8*c);var g=0,x=Math.PI*2,y=0,w=Math.PI,M,S;for(S=0;S<=C;S++){let P=[];for(M=0;M<=E;M++){let I=M/E,F=S/C,k=-l*Math.cos(g+I*x)*Math.sin(y+F*w),B=l*Math.cos(y+F*w),U=l*Math.sin(g+I*x)*Math.sin(y+F*w);var O=new i.Vector3(k,B,U);O.normalize(),b.vertices.push({x:k,y:B,z:U}),b.normals.push(O),P.push(b.vertices.length-1)}b.verticesRows.push(P)}return p.set(l,b),b}}var _=new v;function D(f,l,c,p,b){var E=_.getVerticesForRadius(c,b),C=E.vertices,g=E.normals,x=f.updateGeoGroup(C.length),y=x.vertices,w=x.vertexArray,M=x.colorArray,S=x.faceArray,O=x.lineArray,P=x.normalArray;for(let k=0,B=C.length;k<B;++k){let U=3*(y+k),W=C[k];w[U]=W.x+l.x,w[U+1]=W.y+l.y,w[U+2]=W.z+l.z,M[U]=p.r,M[U+1]=p.g,M[U+2]=p.b}x.vertices+=C.length;let I=E.verticesRows,F=I.length-1;for(let k=0;k<F;k++){let B=I[k].length-1;for(let U=0;U<B;U++){let W=x.faceidx,R=x.lineidx,z=I[k][U+1]+y,G=z*3,q=I[k][U]+y,Q=q*3,ne=I[k+1][U]+y,te=ne*3,oe=I[k+1][U+1]+y,re=oe*3,le=g[z-y],Ce=g[q-y],De=g[ne-y],Oe=g[oe-y];Math.abs(C[z-y].y)===c?(P[G]=le.x,P[te]=De.x,P[re]=Oe.x,P[G+1]=le.y,P[te+1]=De.y,P[re+1]=Oe.y,P[G+2]=le.z,P[te+2]=De.z,P[re+2]=Oe.z,S[W]=z,S[W+1]=ne,S[W+2]=oe,O[R]=z,O[R+1]=ne,O[R+2]=z,O[R+3]=oe,O[R+4]=ne,O[R+5]=oe,x.faceidx+=3,x.lineidx+=6):Math.abs(C[ne-y].y)===c?(P[G]=le.x,P[Q]=Ce.x,P[te]=De.x,P[G+1]=le.y,P[Q+1]=Ce.y,P[te+1]=De.y,P[G+2]=le.z,P[Q+2]=Ce.z,P[te+2]=De.z,S[W]=z,S[W+1]=q,S[W+2]=ne,O[R]=z,O[R+1]=q,O[R+2]=z,O[R+3]=ne,O[R+4]=q,O[R+5]=ne,x.faceidx+=3,x.lineidx+=6):(P[G]=le.x,P[Q]=Ce.x,P[re]=Oe.x,P[G+1]=le.y,P[Q+1]=Ce.y,P[re+1]=Oe.y,P[G+2]=le.z,P[Q+2]=Ce.z,P[re+2]=Oe.z,P[Q]=Ce.x,P[te]=De.x,P[re]=Oe.x,P[Q+1]=Ce.y,P[te+1]=De.y,P[re+1]=Oe.y,P[Q+2]=Ce.z,P[te+2]=De.z,P[re+2]=Oe.z,S[W]=z,S[W+1]=q,S[W+2]=oe,S[W+3]=q,S[W+4]=ne,S[W+5]=oe,O[R]=z,O[R+1]=q,O[R+2]=z,O[R+3]=oe,O[R+4]=q,O[R+5]=ne,O[R+6]=ne,O[R+7]=oe,x.faceidx+=6,x.lineidx+=8)}}}o.drawSphere=D})(s||(s={}))},"./src/GLModel.ts":(n,e,t)=>{t.r(e),t.d(e,{GLModel:()=>D});var i=t("./src/WebGL/index.ts"),r=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts"),a=t("./src/GLDraw.ts"),h=t("./src/glcartoon.ts"),d=t("./src/utilities.ts"),u=t("./src/Gradient.ts"),m=t("./src/parsers/index.ts"),v=t("./node_modules/netcdfjs/lib-esm/index.js"),_=t("./src/parsers/utils/assignBonds.ts");class D{static sameObj(l,c){return l&&c?JSON.stringify(l)==JSON.stringify(c):l==c}constructor(l,c,p){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new s.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=o.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=c||{},this.viewer=p,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:o.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=l}getRadiusFromStyle(l,c){var p=this.defaultSphereRadius;if(typeof c.radius<"u")p=c.radius;else if(D.vdwRadii[l.elem])p=D.vdwRadii[l.elem];else if(l.elem.length>1){let b=l.elem;b=b[0].toUpperCase()+b[1].toLowerCase(),D.vdwRadii[b]&&(p=D.vdwRadii[b])}return typeof c.scale<"u"&&(p*=c.scale),p}drawAtomCross(l,c){if(l.style.cross){var p=l.style.cross;if(!p.hidden){var b=p.linewidth||D.defaultlineWidth;c[b]||(c[b]=new i.Geometry);var E=c[b].updateGeoGroup(6),C=this.getRadiusFromStyle(l,p),g=[[C,0,0],[-C,0,0],[0,C,0],[0,-C,0],[0,0,C],[0,0,-C]],x=l.clickable||l.hoverable;x&&l.intersectionShape===void 0&&(l.intersectionShape={sphere:[],cylinder:[],line:[]});for(var y=(0,d.getColorFromStyle)(l,p),w=E.vertexArray,M=E.colorArray,S=0;S<6;S++){var O=E.vertices*3;if(E.vertices++,w[O]=l.x+g[S][0],w[O+1]=l.y+g[S][1],w[O+2]=l.z+g[S][2],M[O]=y.r,M[O+1]=y.g,M[O+2]=y.b,x){var P=new s.Vector3(g[S][0],g[S][1],g[S][2]);P.multiplyScalar(.1),P.set(P.x+l.x,P.y+l.y,P.z+l.z),l.intersectionShape.line.push(P)}}}}}getGoodCross(l,c,p,b){for(var E=null,C=-1,g=0,x=l.bonds.length;g<x;g++)if(l.bonds[g]!=c.index){let w=l.bonds[g],M=this.atoms[w],O=new s.Vector3(M.x,M.y,M.z).clone();O.sub(p);let P=O.clone();P.cross(b);var y=P.lengthSq();if(y>C&&(C=y,E=P,C>.1))return E}return E}getSideBondV(l,c,p){var b,E,C,g,x,y=new s.Vector3(l.x,l.y,l.z),w=new s.Vector3(c.x,c.y,c.z),M=w.clone(),S=null;if(M.sub(y),l.bonds.length===1)c.bonds.length===1?(S=M.clone(),Math.abs(S.x)>1e-4?S.y+=1:S.x+=1):(b=(p+1)%c.bonds.length,E=c.bonds[b],C=this.atoms[E],C.index==l.index&&(b=(b+1)%c.bonds.length,E=c.bonds[b],C=this.atoms[E]),g=new s.Vector3(C.x,C.y,C.z),x=g.clone(),x.sub(y),S=x.clone(),S.cross(M));else if(S=this.getGoodCross(l,c,y,M),S.lengthSq()<.01){var O=this.getGoodCross(c,l,y,M);O!=null&&(S=O)}return S.lengthSq()<.01&&(S=M.clone(),Math.abs(S.x)>1e-4?S.y+=1:S.x+=1),S.cross(M),S.normalize(),S}addLine(l,c,p,b,E,C){l[p]=b.x,l[p+1]=b.y,l[p+2]=b.z,c[p]=C.r,c[p+1]=C.g,c[p+2]=C.b,l[p+3]=E.x,l[p+4]=E.y,l[p+5]=E.z,c[p+3]=C.r,c[p+4]=C.g,c[p+5]=C.b}drawBondLines(l,c,p){if(l.style.line){var b=l.style.line;if(!b.hidden){var E,C,g,x,y=b.linewidth||D.defaultlineWidth;p[y]||(p[y]=new i.Geometry);for(var w=p[y].updateGeoGroup(6*l.bonds.length),M=w.vertexArray,S=w.colorArray,O=0;O<l.bonds.length;O++){var P=l.bonds[O],I=c[P];if(I.style.line&&!(l.index>=I.index)){var F=new s.Vector3(l.x,l.y,l.z),k=new s.Vector3(I.x,I.y,I.z),B=F.clone().add(k).multiplyScalar(.5),U=!1,W=l.clickable||l.hoverable,R=I.clickable||I.hoverable;(W||R)&&(W&&(l.intersectionShape===void 0&&(l.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),l.intersectionShape.line.push(F),l.intersectionShape.line.push(B)),R&&(I.intersectionShape===void 0&&(I.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),I.intersectionShape.line.push(B),I.intersectionShape.line.push(k)));var z=(0,d.getColorFromStyle)(l,l.style.line),G=(0,d.getColorFromStyle)(I,I.style.line);if(l.bondStyles&&l.bondStyles[O]){var q=l.bondStyles[O];if(!q.iswire)continue;q.singleBond&&(U=!0),typeof q.color1<"u"&&(z=o.CC.color(q.color1)),typeof q.color2<"u"&&(G=o.CC.color(q.color2))}var Q=w.vertices*3,ne,te;if(l.bondOrder[O]>1&&l.bondOrder[O]<4&&!U){var oe=this.getSideBondV(l,I,O),re=k.clone();re.sub(F),l.bondOrder[O]==2?(oe.multiplyScalar(.1),E=F.clone(),E.add(oe),C=F.clone(),C.sub(oe),g=E.clone(),g.add(re),x=C.clone(),x.add(re),z==G?(w.vertices+=4,this.addLine(M,S,Q,E,g,z),this.addLine(M,S,Q+6,C,x,z)):(w.vertices+=8,re.multiplyScalar(.5),ne=E.clone(),ne.add(re),te=C.clone(),te.add(re),this.addLine(M,S,Q,E,ne,z),this.addLine(M,S,Q+6,ne,g,G),this.addLine(M,S,Q+12,C,te,z),this.addLine(M,S,Q+18,te,x,G))):l.bondOrder[O]==3&&(oe.multiplyScalar(.1),E=F.clone(),E.add(oe),C=F.clone(),C.sub(oe),g=E.clone(),g.add(re),x=C.clone(),x.add(re),z==G?(w.vertices+=6,this.addLine(M,S,Q,F,k,z),this.addLine(M,S,Q+6,E,g,z),this.addLine(M,S,Q+12,C,x,z)):(w.vertices+=12,re.multiplyScalar(.5),ne=E.clone(),ne.add(re),te=C.clone(),te.add(re),this.addLine(M,S,Q,F,B,z),this.addLine(M,S,Q+6,B,k,G),this.addLine(M,S,Q+12,E,ne,z),this.addLine(M,S,Q+18,ne,g,G),this.addLine(M,S,Q+24,C,te,z),this.addLine(M,S,Q+30,te,x,G)))}else z==G?(w.vertices+=2,this.addLine(M,S,Q,F,k,z)):(w.vertices+=4,this.addLine(M,S,Q,F,B,z),this.addLine(M,S,Q+6,B,k,G))}}}}}drawAtomSphere(l,c){if(l.style.sphere){var p=l.style.sphere;if(!p.hidden){var b=(0,d.getColorFromStyle)(l,p),E=this.getRadiusFromStyle(l,p);if((l.clickable===!0||l.hoverable)&&l.intersectionShape!==void 0){var C=new s.Vector3(l.x,l.y,l.z);l.intersectionShape.sphere.push(new r.Sphere(C,E))}a.GLDraw.drawSphere(c,l,E,b)}}}drawAtomClickSphere(l){if(l.style.clicksphere){var c=l.style.clicksphere;if(!c.hidden){var p=this.getRadiusFromStyle(l,c);if((l.clickable===!0||l.hoverable)&&l.intersectionShape!==void 0){var b=new s.Vector3(l.x,l.y,l.z);l.intersectionShape.sphere.push(new r.Sphere(b,p))}}}}drawAtomInstanced(l,c){if(l.style.sphere){var p=l.style.sphere;if(!p.hidden){var b=this.getRadiusFromStyle(l,p),E=(0,d.getColorFromStyle)(l,p),C=c.updateGeoGroup(1),g=C.vertices,x=g*3,y=C.vertexArray,w=C.colorArray,M=C.radiusArray;if(y[x]=l.x,y[x+1]=l.y,y[x+2]=l.z,w[x]=E.r,w[x+1]=E.g,w[x+2]=E.b,M[g]=b,(l.clickable===!0||l.hoverable)&&l.intersectionShape!==void 0){var S=new s.Vector3(l.x,l.y,l.z);l.intersectionShape.sphere.push(new r.Sphere(S,b))}C.vertices+=1}}}drawSphereImposter(l,c,p,b){var E=l.updateGeoGroup(4),C,g=E.vertices,x=g*3,y=E.vertexArray,w=E.colorArray;for(C=0;C<4;C++)y[x+3*C]=c.x,y[x+3*C+1]=c.y,y[x+3*C+2]=c.z;var M=E.normalArray;for(C=0;C<4;C++)w[x+3*C]=b.r,w[x+3*C+1]=b.g,w[x+3*C+2]=b.b;M[x+0]=-p,M[x+1]=p,M[x+2]=0,M[x+3]=-p,M[x+4]=-p,M[x+5]=0,M[x+6]=p,M[x+7]=-p,M[x+8]=0,M[x+9]=p,M[x+10]=p,M[x+11]=0,E.vertices+=4;var S=E.faceArray,O=E.faceidx;S[O+0]=g,S[O+1]=g+1,S[O+2]=g+2,S[O+3]=g+2,S[O+4]=g+3,S[O+5]=g,E.faceidx+=6}drawAtomImposter(l,c){if(l.style.sphere){var p=l.style.sphere;if(!p.hidden){var b=this.getRadiusFromStyle(l,p),E=(0,d.getColorFromStyle)(l,p);if((l.clickable===!0||l.hoverable)&&l.intersectionShape!==void 0){var C=new s.Vector3(l.x,l.y,l.z);l.intersectionShape.sphere.push(new r.Sphere(C,b))}this.drawSphereImposter(c,l,b,E)}}}calculateDashes(l,c,p,b,E){var C=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2)+Math.pow(l.z-c.z,2));p=Math.max(p,0),E=Math.max(E,0)+2*p,b=Math.max(b,.001),b+E>C&&(b=C,E=0);var g=Math.floor((C-b)/(b+E))+1,x=g*b;E=(C-x)/g;for(var y,w=new s.Vector3(l.x,l.y,l.z),M=new s.Vector3((c.x-l.x)/(C/E),(c.y-l.y)/(C/E),(c.z-l.z)/(C/E)),S=new s.Vector3((c.x-l.x)/(C/b),(c.y-l.y)/(C/b),(c.z-l.z)/(C/b)),O=[],P=0;P<g;P++)y=new s.Vector3(w.x+S.x,w.y+S.y,w.z+S.z),O.push({from:w,to:y}),w=new s.Vector3(y.x+M.x,y.y+M.y,y.z+M.z);return O}static drawStickImposter(l,c,p,b,E,C=0,g=0){for(var x=l.updateGeoGroup(4),y=x.vertices,w=y*3,M=x.vertexArray,S=x.colorArray,O=x.radiusArray,P=x.normalArray,I=E.r,F=E.g,k=E.b,B=function(G){var q=-G;return q==0&&(q=-1e-4),q},U=w,W=0;W<4;W++)M[U]=c.x,P[U]=p.x,S[U]=I,U++,M[U]=c.y,P[U]=p.y,S[U]=F,U++,M[U]=c.z,P[U]=p.z,W<2?S[U]=k:S[U]=B(k),U++;x.vertices+=4,O[y]=-b,O[y+1]=b,O[y+2]=-b,O[y+3]=b;var R=x.faceArray,z=x.faceidx;R[z+0]=y,R[z+1]=y+1,R[z+2]=y+2,R[z+3]=y+2,R[z+4]=y+3,R[z+5]=y,x.faceidx+=6}drawBondSticks(l,c,p){var b,E;if(l.style.stick){var C=l.style.stick;if(!C.hidden){var g=C.radius||this.defaultStickRadius,x=C.doubleBondScaling||.4,y=C.tripleBondScaling||.25,w=((b=C.dashedBondConfig)===null||b===void 0?void 0:b.dashLength)||.1,M=((E=C.dashedBondConfig)===null||E===void 0?void 0:E.gapLength)||.25,S=g,O=C.singleBonds||!1,P=C.dashedBonds||!1,I=0,F=0,k,B,U,W,R,z,G,q,Q,ne,te,oe=(0,d.getColorFromStyle)(l,C),re,le,Ce;!l.capDrawn&&l.bonds.length<4&&(I=2);var De=he=>{var ve=p.imposter?D.drawStickImposter:a.GLDraw.drawCylinder;return!P&&he>=1?ve:(Pe,ae,me,j,Te,Be=0,L=0,ge=.1,de=.25)=>{var $=this.calculateDashes(ae,me,j,ge,de);$.forEach(se=>{ve(Pe,se.from,se.to,j,Te,Be,L)})}};for(U=0;U<l.bonds.length;U++){var Oe=De(l.bondOrder[U]),_e=l.bonds[U],Z=c[_e];if(re=le=Ce=null,l.index<Z.index){var xe=Z.style;if(!xe.stick||xe.stick.hidden)continue;var we=(0,d.getColorFromStyle)(Z,xe.stick);if(S=g,W=O,l.bondStyles&&l.bondStyles[U]){if(R=l.bondStyles[U],R.iswire)continue;R.radius&&(S=R.radius),R.singleBond&&(W=!0),typeof R.color1<"u"&&(oe=o.CC.color(R.color1)),typeof R.color2<"u"&&(we=o.CC.color(R.color2))}var ie=new s.Vector3(l.x,l.y,l.z),Ne=new s.Vector3(Z.x,Z.y,Z.z);if(l.bondOrder[U]<=1||W||l.bondOrder[U]>3){if(l.bondOrder[U]<1&&(S*=l.bondOrder[U]),!Z.capDrawn&&Z.bonds.length<4&&(F=2),oe!=we?(re=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5),Oe(p,ie,re,S,oe,I,0,w,M),Oe(p,re,Ne,S,we,0,F,w,M)):Oe(p,ie,Ne,S,oe,I,F,w,M),k=l.clickable||l.hoverable,B=Z.clickable||Z.hoverable,k||B){if(re||(re=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5)),k){var Ge=new r.Cylinder(ie,re,S),Ue=new r.Sphere(ie,S);l.intersectionShape.cylinder.push(Ge),l.intersectionShape.sphere.push(Ue)}if(B){var Ie=new r.Cylinder(Ne,re,S),ze=new r.Sphere(Ne,S);Z.intersectionShape.cylinder.push(Ie),Z.intersectionShape.sphere.push(ze)}}}else if(l.bondOrder[U]>1){var Re=0,Le=0;S!=g&&(Re=2,Le=2);var We=Ne.clone(),He=null;We.sub(ie);var H,K,X,pe,ue;He=this.getSideBondV(l,Z,U),l.bondOrder[U]==2?(H=S*x,He.multiplyScalar(H*1.5),K=ie.clone(),K.add(He),X=ie.clone(),X.sub(He),pe=K.clone(),pe.add(We),ue=X.clone(),ue.add(We),oe!=we?(re=new s.Vector3().addVectors(K,pe).multiplyScalar(.5),le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5),Oe(p,K,re,H,oe,Re,0),Oe(p,re,pe,H,we,0,Le),Oe(p,X,le,H,oe,Re,0),Oe(p,le,ue,H,we,0,Le)):(Oe(p,K,pe,H,oe,Re,Le),Oe(p,X,ue,H,oe,Re,Le)),k=l.clickable||l.hoverable,B=Z.clickable||Z.hoverable,(k||B)&&(re||(re=new s.Vector3().addVectors(K,pe).multiplyScalar(.5)),le||(le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5)),k&&(z=new r.Cylinder(K,re,H),G=new r.Cylinder(X,le,H),l.intersectionShape.cylinder.push(z),l.intersectionShape.cylinder.push(G)),B&&(Q=new r.Cylinder(pe,re,H),ne=new r.Cylinder(ue,le,H),Z.intersectionShape.cylinder.push(Q),Z.intersectionShape.cylinder.push(ne)))):l.bondOrder[U]==3&&(H=S*y,He.cross(We),He.normalize(),He.multiplyScalar(H*3),K=ie.clone(),K.add(He),X=ie.clone(),X.sub(He),pe=K.clone(),pe.add(We),ue=X.clone(),ue.add(We),oe!=we?(re=new s.Vector3().addVectors(K,pe).multiplyScalar(.5),le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5),Ce=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5),Oe(p,K,re,H,oe,Re,0),Oe(p,re,pe,H,we,0,Le),Oe(p,ie,Ce,H,oe,I,0),Oe(p,Ce,Ne,H,we,0,F),Oe(p,X,le,H,oe,Re,0),Oe(p,le,ue,H,we,0,Le)):(Oe(p,K,pe,H,oe,Re,Le),Oe(p,ie,Ne,H,oe,I,F),Oe(p,X,ue,H,oe,Re,Le)),k=l.clickable||l.hoverable,B=Z.clickable||Z.hoverable,(k||B)&&(re||(re=new s.Vector3().addVectors(K,pe).multiplyScalar(.5)),le||(le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5)),Ce||(Ce=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5)),k&&(z=new r.Cylinder(K.clone(),re.clone(),H),G=new r.Cylinder(X.clone(),le.clone(),H),q=new r.Cylinder(ie.clone(),Ce.clone(),H),l.intersectionShape.cylinder.push(z),l.intersectionShape.cylinder.push(G),l.intersectionShape.cylinder.push(q)),B&&(Q=new r.Cylinder(pe.clone(),re.clone(),H),ne=new r.Cylinder(ue.clone(),le.clone(),H),te=new r.Cylinder(Ne.clone(),Ce.clone(),H),Z.intersectionShape.cylinder.push(Q),Z.intersectionShape.cylinder.push(ne),Z.intersectionShape.cylinder.push(te))))}}}var ye=!1,Se=0,V=!1;for(U=0;U<l.bonds.length;U++)W=O,l.bondStyles&&l.bondStyles[U]&&(R=l.bondStyles[U],R.singleBond&&(W=!0),R.radius&&R.radius!=g&&(V=!0)),(W||l.bondOrder[U]==1)&&Se++;V?Se>0&&(ye=!0):Se==0&&(l.bonds.length>0||C.showNonBonded)&&(ye=!0),ye&&(S=g,p.imposter?this.drawSphereImposter(p.sphereGeometry,l,S,oe):a.GLDraw.drawSphere(p,l,S,oe))}}}createMolObj(l,c){c=c||{};var p=new i.Object3D,b=[],E={},C={},g=this.drawAtomSphere,x=null,y=null;c.supportsImposters?(g=this.drawAtomImposter,x=new i.Geometry(!0),x.imposter=!0,y=new i.Geometry(!0,!0),y.imposter=!0,y.sphereGeometry=new i.Geometry(!0),y.sphereGeometry.imposter=!0,y.drawnCaps={}):c.supportsAIA?(g=this.drawAtomInstanced,x=new i.Geometry(!1,!0,!0),x.instanced=!0,y=new i.Geometry(!0)):(x=new i.Geometry(!0),y=new i.Geometry(!0));var w,M,S,O,P={},I=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(w=0,S=l.length;w<S;w++){var F=l[w];if(F&&F.style){(F.clickable||F.hoverable)&&F.intersectionShape===void 0&&(F.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),O={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(M in O)F.style[M]?F.style[M].opacity?O[M]=parseFloat(F.style[M].opacity):O[M]=1:O[M]=void 0,P[M]?O[M]!=null&&P[M]!=O[M]&&(console.log("Warning: "+M+" opacity is ambiguous"),P[M]=1):P[M]=O[M];g.call(this,F,x),this.drawAtomClickSphere(F),this.drawAtomCross(F,C),this.drawBondLines(F,l,E),this.drawBondSticks(F,l,y),typeof F.style.cartoon<"u"&&!F.style.cartoon.hidden&&(F.style.cartoon.color==="spectrum"&&typeof F.resi=="number"&&!F.hetflag&&(F.resi<I[0]&&(I[0]=F.resi),F.resi>I[1]&&(I[1]=F.resi)),b.push(F))}}if(b.length>0&&(0,h.drawCartoon)(p,b,I,this.defaultCartoonQuality),x&&x.vertices>0){x.initTypedArrays();var k=null,B=null;x.imposter?k=new i.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):x.instanced?(B=new i.Geometry(!0),a.GLDraw.drawSphere(B,{x:0,y:0,z:0},1,new o.Color(.5,.5,.5)),B.initTypedArrays(),k=new i.InstancedMaterial({sphereMaterial:new i.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:B})):k=new i.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),P.sphere<1&&P.sphere>=0&&(k.transparent=!0,k.opacity=P.sphere),B=new i.Mesh(x,k),p.add(B)}if(y.vertices>0){var U=null,W=null,R=y.sphereGeometry;(!R||typeof R.vertices>"u"||R.vertices==0)&&(R=null),y.initTypedArrays(),R&&R.initTypedArrays();var z={ambient:0,vertexColors:!0,reflectivity:0};y.imposter?(U=new i.StickImposterMaterial(z),W=new i.SphereImposterMaterial(z)):(U=new i.MeshLambertMaterial(z),W=new i.MeshLambertMaterial(z),U.wireframe&&(y.setUpWireframe(),R&&R.setUpWireframe())),P.stick<1&&P.stick>=0&&(U.transparent=!0,U.opacity=P.stick,W.transparent=!0,W.opacity=P.stick);var G=new i.Mesh(y,U);if(p.add(G),R){var q=new i.Mesh(R,W);p.add(q)}}var Q;for(w in E)if(E.hasOwnProperty(w)){Q=w;var ne=new i.LineBasicMaterial({linewidth:Q,vertexColors:!0});P.line<1&&P.line>=0&&(ne.transparent=!0,ne.opacity=P.line),E[w].initTypedArrays();var te=new i.Line(E[w],ne,i.LineStyle.LinePieces);p.add(te)}for(w in C)if(C.hasOwnProperty(w)){Q=w;var oe=new i.LineBasicMaterial({linewidth:Q,vertexColors:!0});P.cross<1&&P.cross>=0&&(oe.transparent=!0,oe.opacity=P.cross),C[w].initTypedArrays();var re=new i.Line(C[w],oe,i.LineStyle.LinePieces);p.add(re)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var le=new i.Object3D,Ce;for(Ce=0;Ce<this.modelData.symmetries.length;Ce++){var De=new i.Object3D;De=p.clone(),De.matrix.copy(this.modelData.symmetries[Ce]),De.matrixAutoUpdate=!1,le.add(De)}return le}return p}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(l){this.atoms=l.atoms,this.frames=l.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const l=this.modelData.cryst;this.modelData.cryst.matrix=(0,s.conversionMatrix3)(l.a,l.b,l.c,l.alpha,l.beta,l.gamma)}return this.modelData.cryst}else return null}setCrystData(l,c,p,b,E,C){l=l||1,c=c||1,p=p||1,b=b||90,E=E||90,C=C||90;const g=(0,s.conversionMatrix3)(l,c,p,b,E,C);this.modelData.cryst={a:l,b:c,c:p,alpha:b,beta:E,gamma:C,matrix:g}}setCrystMatrix(l){l=l||new s.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:l}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(l){typeof l>"u"?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=l,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(l,c,p,b){var E=c-l;return E<-p?c+b:E>p?c-b:c}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var l=this.box[0],c=this.box[1],p=this.box[2],b=l*.9,E=c*.9,C=p*.9,g=0;g<this.atomdfs.length;g++)for(var x=this.atomdfs[g],y=1;y<x.length;y++){var w=this.atoms[x[y][0]],M=this.atoms[x[y][1]];w.x=this.adjustCoord(M.x,w.x,b,l),w.y=this.adjustCoord(M.y,w.y,E,c),w.z=this.adjustCoord(M.z,w.z,C,p)}}setFrame(l){var c=this.getNumFrames();let p=this,b=this.viewer;return new Promise(function(E,C){if(c==0&&E(),(l<0||l>=c)&&(l=c-1),p.frames.url!=null){var g=p.frames.url;(0,d.getbin)(g+"/traj/frame/"+l+"/"+p.frames.path,void 0,"POST",void 0).then(function(x){for(var y=new Float32Array(x,44),w=0,M=0;M<p.atoms.length;M++)p.atoms[M].x=y[w++],p.atoms[M].y=y[w++],p.atoms[M].z=y[w++];p.box&&p.atomdfs&&p.adjustCoordinatesToBox(),E()}).catch(C)}else p.atoms=p.frames[l],E();p.molObj=null,p.modelDatas&&l<p.modelDatas.length&&(p.modelData=p.modelDatas[l],p.unitCellObjects&&b&&(b.removeUnitCell(p),b.addUnitCell(p)))})}addFrame(l){this.frames.push(l)}vibrate(l=10,c=1,p=!1,b){var E=0,C=l;let g=this.viewer;p&&(E=-l,C=l),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),E<C&&(this.frames=[]),p&&(this.frames.origIndex=l);for(var x=E;x<C;x++){var y=[],w=this.frames.length;if(x==0&&!b){this.frames.push(this.atoms);continue}for(var M=0;M<this.atoms.length;M++){var S=(0,d.getAtomProperty)(this.atoms[M],"dx"),O=(0,d.getAtomProperty)(this.atoms[M],"dy"),P=(0,d.getAtomProperty)(this.atoms[M],"dz"),I=new s.Vector3(S,O,P),F=new s.Vector3(this.atoms[M].x,this.atoms[M].y,this.atoms[M].z),k=x*c/l;I.multiplyScalar(k),F.add(I);var B={};for(var U in this.atoms[M])B[U]=this.atoms[M][U];if(B.x=F.x,B.y=F.y,B.z=F.z,y.push(B),g&&b){var W=(0,d.extend)({},b),R=new s.Vector3(S,O,P);if(R.multiplyScalar(c),R.add(F),W.start=F,W.end=R,W.frame=w,!W.color){var z=B.style.sphere;z||(z=B.style.stick),z||(z=B.style.line),W.color=(0,d.getColorFromStyle)(B,z)}g.addArrow(W)}}this.frames.push(y)}}setAtomDefaults(l){for(let c=0;c<l.length;c++){let p=l[c];p&&(p.style=p.style||(0,d.deepCopy)(D.defaultAtomStyle),p.color=p.color||this.ElementColors[p.elem]||this.defaultColor,p.model=this.id,(p.clickable||p.hoverable)&&(p.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(l,c,p={}){var b=D.parseMolData(l,c,p);this.dontDuplicateAtoms=!p.duplicateAssemblyAtoms;var E=b.modelData;if(E&&(Array.isArray(E)?(this.modelData=E[0],p.frames&&(this.modelDatas=E)):this.modelData=E),b.box?this.box=b.box:this.box=null,this.frames.length==0){for(let g=0;g<b.length;g++)b[g].length!=0&&this.frames.push(b[g]);this.frames[0]&&(this.atoms=this.frames[0])}else if(p.frames)for(let g=0;g<b.length;g++)this.frames.push(b[g]);else for(var C=0;C<b.length;C++)this.addAtoms(b[C]);for(let g=0;g<this.frames.length;g++)this.setAtomDefaults(this.frames[g]);p.vibrate&&p.vibrate.frames&&p.vibrate.amplitude&&this.vibrate(p.vibrate.frames,p.vibrate.amplitude),p.style&&this.setStyle({},p.style)}setDontDuplicateAtoms(l){this.dontDuplicateAtoms=l}setModelData(l){this.modelData=l}propertyMatches(l,c){if(l==c)return!0;if(typeof c=="string"&&typeof l=="number"){var p=c.match(/(-?\d+)\s*-\s*(-?\d+)/);if(p){var b=parseInt(p[1]),E=parseInt(p[2]);if(p&&l>=b&&l<=E)return!0}}return!1}static deepCopyAndCache(l,c){if(typeof l!="object"||l==null||l.__cache_created)return l;const p={};for(const b in l){const E=l[b];if(Array.isArray(E)){p[b]=[];for(let C=0;C<E.length;C++)p[b].push(D.deepCopyAndCache(E[C],c))}else typeof E=="object"&&b!="properties"&&b!="model"?p[b]=D.deepCopyAndCache(E,c):p[b]=E;if(b=="and"||b=="or"){const C=[];for(const g of p[b]){const x=new Set;for(const y of c.selectedAtoms(g))x.add(y.index);C.push(x)}if(b=="and"){const g=function(y,w){const M=new Set;for(const S of w)y.has(S)&&M.add(S);return M};let x=new Set(C[0]);for(const y of C.splice(1))x=g(x,y);p[b].__cached_results=x}else if(b=="or"){const g=new Set;for(const x of C)for(const y of x)g.add(y);p[b].__cached_results=g}}}return p.__cache_created=!0,p}atomIsSelected(l,c){if(typeof c>"u")return!0;var p=!!c.invert,b=!0;for(var E in c)if(E=="and"||E=="or"||E=="not"){if(E=="not"){if(this.atomIsSelected(l,c[E])){b=!1;break}}else if(c[E].__cached_results===void 0&&(c=D.deepCopyAndCache(c,this)),b=c[E].__cached_results.has(l.index),!b)break}else if(E==="predicate"){if(!c.predicate(l)){b=!1;break}}else if(E=="properties"&&l[E]){for(var C in c.properties)if(!C.startsWith("__cache")){if(typeof l.properties[C]>"u"){b=!1;break}if(l.properties[C]!=c.properties[C]){b=!1;break}}}else if(E=="model"){let w=c.model;if(typeof w=="number"&&w<0&&(w=this.viewer.getNextModelId()+w),Array.isArray(w)){let M=!1;for(let S=0;S<w.length;S++)if(w[S]==this||w[S]==this.id){M=!0;break}if(!M){b=!1;break}}else if(w!=this&&w!=this.id){b=!1;break}}else if(c.hasOwnProperty(E)&&!D.ignoredKeys.has(E)&&!E.startsWith("__cache")){if(typeof l[E]>"u"){b=!1;break}let w=!1;if(E==="bonds"){var g=c[E];if(g!=l.bonds.length){b=!1;break}}else if(Array.isArray(c[E])){var x=c[E],y=l[E];for(let M=0;M<x.length;M++)if(this.propertyMatches(y,x[M])){w=!0;break}if(!w){b=!1;break}}else{let M=c[E];if(!this.propertyMatches(l[E],M)){b=!1;break}}}return p?!b:b}static squaredDistance(l,c){var p=c.x-l.x,b=c.y-l.y,E=c.z-l.z;return p*p+b*b+E*E}expandAtomList(l,c){if(c<=0)return l;for(var p=(0,d.getExtent)(l,void 0),b=[[],[],[]],E=0;E<3;E++)b[0][E]=p[0][E]-c,b[1][E]=p[1][E]+c,b[2][E]=p[2][E];var C=[];for(let w=0;w<this.atoms.length;w++){var g=this.atoms[w].x,x=this.atoms[w].y,y=this.atoms[w].z;g>=b[0][0]&&g<=b[1][0]&&x>=b[0][1]&&x<=b[1][1]&&y>=b[0][2]&&y<=b[1][2]&&(g>=p[0][0]&&g<=p[1][0]&&x>=p[0][1]&&x<=p[1][1]&&y>=p[0][2]&&y<=p[1][2]||C.push(this.atoms[w]))}return C}static getFloat(l){return typeof l=="number"?l:parseFloat(l)}selectedAtoms(l,c){var p=[];l=D.deepCopyAndCache(l||{},this),c||(c=this.atoms);for(var b=c.length,E=0;E<b;E++){var C=c[E];C&&this.atomIsSelected(C,l)&&p.push(C)}if(l.hasOwnProperty("expand")){const B=D.getFloat(l.expand);let U=this.expandAtomList(p,B),W=p.length;const R=B*B;for(let z=0;z<U.length;z++)for(let G=0;G<W;G++){var g=D.squaredDistance(U[z],p[G]);g<R&&g>0&&p.push(U[z])}}if(l.hasOwnProperty("within")&&l.within.hasOwnProperty("sel")&&l.within.hasOwnProperty("distance")){var x=this.selectedAtoms(l.within.sel,this.atoms),y={};const B=D.getFloat(l.within.distance),U=B*B;for(let W=0;W<x.length;W++)for(let R=0;R<p.length;R++){let z=D.squaredDistance(x[W],p[R]);z<U&&z>0&&(y[R]=1)}var w=[];if(l.within.invert)for(let W=0;W<p.length;W++)y[W]||w.push(p[W]);else for(let W in y)w.push(p[W]);p=w}if(l.hasOwnProperty("byres")){var M={},S=[],O=[];for(let B=0;B<p.length;B++){let U=p[B];var P=U.chain,I=U.resi;if(M[P]===void 0&&(M[P]={}),U.hasOwnProperty("resi")&&M[P][I]===void 0){for(M[P][I]=!0,O.push(U);O.length>0;)if(U=O.pop(),P=U.chain,I=U.resi,S[U.index]===void 0){S[U.index]=!0;for(var F=0;F<U.bonds.length;F++){var k=this.atoms[U.bonds[F]];S[k.index]===void 0&&k.hasOwnProperty("resi")&&k.chain==P&&k.resi==I&&(O.push(k),p.push(k))}}}}}return p}addAtoms(l){this.molObj=null;var c=this.atoms.length,p=[],b;for(b=0;b<l.length;b++)typeof l[b].index>"u"&&(l[b].index=b),typeof l[b].serial>"u"&&(l[b].serial=b),p[l[b].index]=c+b;for(b=0;b<l.length;b++){var E=l[b],C=p[E.index],g=(0,d.extend)({},E);g.index=C,g.bonds=[],g.bondOrder=[],g.model=this.id,g.style=g.style||(0,d.deepCopy)(D.defaultAtomStyle),typeof g.color>"u"&&(g.color=this.ElementColors[g.elem]||this.defaultColor);for(var x=E.bonds?E.bonds.length:0,y=0;y<x;y++){var w=p[E.bonds[y]];typeof w<"u"&&(g.bonds.push(w),g.bondOrder.push(E.bondOrder?E.bondOrder[y]:1))}this.atoms.push(g)}}assignBonds(){(0,_.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(l){this.molObj=null;var c=[],p;for(p=0;p<l.length;p++)c[l[p].index]=!0;var b=[];for(p=0;p<this.atoms.length;p++){var E=this.atoms[p];c[E.index]||b.push(E)}this.atoms=[],this.addAtoms(b)}setStyle(l,c,p){typeof c>"u"&&typeof p>"u"&&(c=l,l={}),l=l,typeof c=="string"&&(c=(0,d.specStringToObject)(c));var b=!1,E=this,C=function(x){var y=E.selectedAtoms(l,x);for(let w=0;w<x.length;w++)x[w]&&(x[w].capDrawn=!1);for(let w=0;w<y.length;w++){b=!0,(y[w].clickable||y[w].hoverable)&&(y[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),p||(y[w].style={});for(let M in c)c.hasOwnProperty(M)&&(y[w].style[M]=y[w].style[M]||{},Object.assign(y[w].style[M],c[M]))}};if(l.frame!==void 0&&l.frame<this.frames.length){let x=l.frame;x<0&&(x=this.frames.length+x),C(this.frames[x])}else{C(this.atoms);for(var g=0;g<this.frames.length;g++)this.frames[g]!==this.atoms&&C(this.frames[g])}b&&(this.molObj=null)}setClickable(l,c,p){if(c=!!c,p=(0,d.makeFunction)(p),p===null){console.log("Callback is not a function");return}var b=this.selectedAtoms(l,this.atoms),E=b.length;for(let C=0;C<E;C++)b[C].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},b[C].clickable=c,p&&(b[C].callback=p);E>0&&(this.molObj=null)}setHoverable(l,c,p,b){if(c=!!c,p=(0,d.makeFunction)(p),b=(0,d.makeFunction)(b),p===null){console.log("Hover_callback is not a function");return}if(b===null){console.log("Unhover_callback is not a function");return}var E=this.selectedAtoms(l,this.atoms),C=E.length;for(let g=0;g<C;g++)E[g].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[g].hoverable=c,p&&(E[g].hover_callback=p),b&&(E[g].unhover_callback=b);C>0&&(this.molObj=null)}enableContextMenu(l,c){c=!!c;var p,b=this.selectedAtoms(l,this.atoms),E=b.length;for(p=0;p<E;p++)b[p].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},b[p].contextMenuEnabled=c;E>0&&(this.molObj=null)}setColorByElement(l,c){if(!(this.molObj!==null&&D.sameObj(c,this.lastColors))){this.lastColors=c;var p=this.selectedAtoms(l,p);p.length>0&&(this.molObj=null);for(var b=0;b<p.length;b++){var E=p[b];typeof c[E.elem]<"u"&&(E.color=c[E.elem])}}}setColorByProperty(l,c,p,b){var E,C,g=this.selectedAtoms(l,g);for(this.lastColors=null,g.length>0&&(this.molObj=null),typeof p=="string"&&typeof u.Gradient.builtinGradients[p]<"u"&&(p=new u.Gradient.builtinGradients[p]),p=p,b||(b=p.range()),b||(b=(0,d.getPropertyRange)(g,c)),E=0;E<g.length;E++){C=g[E];var x=(0,d.getAtomProperty)(C,c);x!=null&&(C.color=p.valueToHex(parseFloat(C.properties[c]),b))}}setColorByFunction(l,c){var p=this.selectedAtoms(l,p);if(typeof c=="function"){this.lastColors=null,p.length>0&&(this.molObj=null);for(let b=0;b<p.length;b++){let E=p[b];E.color=c(E)}}}toCDObject(l=!1){var c={a:[],b:[]};l&&(c.s=[]);for(let b=0;b<this.atoms.length;b++){let E={},C=this.atoms[b];if(E.x=C.x,E.y=C.y,E.z=C.z,C.elem!="C"&&(E.l=C.elem),l){for(var p=0;p<c.s.length&&JSON.stringify(C.style)!==JSON.stringify(c.s[p]);)p++;p===c.s.length&&c.s.push(C.style),p!==0&&(E.s=p)}c.a.push(E);for(let g=0;g<C.bonds.length;g++){let x=b,y=C.bonds[g];if(x>=y)continue;let w={b:x,e:y},M=C.bondOrder[g];M!=1&&(w.o=M),c.b.push(w)}}return c}globj(l,c){(this.molObj===null||c.regen)&&(this.molObj=this.createMolObj(this.atoms,c),this.renderedMolObj&&(l.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),l.add(this.renderedMolObj))}exportVRML(){var l=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return l.vrml()}removegl(l){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),l.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(l,c,p){let b=this.selectedAtoms(c),E=this.viewer,C=(0,d.deepCopy)(p);for(let x=0;x<b.length;x++){let y=b[x];var g=null;typeof y[l]<"u"?g=String(y[l]):typeof y.properties[l]<"u"&&(g=String(y.properties[l])),g!=null&&(C.position=y,E.addLabel(g,C))}}addResLabels(l,c,p=!1){let b=this.viewer;var E=[],C=function(x,y){for(var w=x.selectedAtoms(l,w),M={},S=0;S<w.length;S++){var O=w[S],P=O.chain,I=O.resn,F=O.resi,k=I+""+F;M[P]||(M[P]={}),M[P][k]||(M[P][k]=[]),M[P][k].push(O)}var B=(0,d.deepCopy)(c);for(let W in M)if(M.hasOwnProperty(W)){var U=M[W];for(let R in U)if(U.hasOwnProperty(R)){let z=U[R],G=new s.Vector3(0,0,0);for(let Q=0;Q<z.length;Q++){let ne=z[Q];G.x+=ne.x,G.y+=ne.y,G.z+=ne.z}G.divideScalar(z.length),B.position=G,B.frame=y;let q=b.addLabel(R,B,void 0,!0);E.push(q)}}};if(p){var g=this.getNumFrames();let x=this.atoms;for(let y=0;y<g;y++)this.frames[y]&&(this.atoms=this.frames[y],C(this,y));this.atoms=x}else C(this);return E}setupDFS(){this.atomdfs=[];var l=this,c=new Int8Array(this.atoms.length);c.fill(0);for(var p=function(g,x,y){y.push([g,x]);var w=l.atoms[g];c[g]=1;for(var M=0;M<w.bonds.length;M++){var S=w.bonds[M];l.atoms[S]&&!c[S]&&p(S,g,y)}},b=0;b<this.atoms.length;b++){var E=this.atoms[b];if(E&&!c[b]){var C=[];p(b,-1,C),this.atomdfs.push(C)}}}setCoordinatesFromURL(l,c){this.frames=[];var p=this;return this.box&&this.setupDFS(),l.startsWith("http")||(l="http://"+l),(0,d.get)(l+"/traj/numframes/"+c,function(b){if(!isNaN(parseInt(b)))return p.frames.push(p.atoms),p.frames.numFrames=b,p.frames.url=l,p.frames.path=c,p.setFrame(0)})}setCoordinates(l,c){if(c=c||"",!l)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{l=(0,d.inflateString)(l)}catch(M){console.log(M)}}var p={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(p.hasOwnProperty(c)){this.frames=[];for(var b=this.atoms.length,E=D.parseCrd(l,c),C=0;C<E.length;){for(var g=[],x=0;x<b;x++){var y={};for(var w in this.atoms[x])y[w]=this.atoms[x][w];g[x]=y,g[x].x=E[C++],g[x].y=E[C++],g[x].z=E[C++]}this.frames.push(g)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(l){}static parseCrd(l,c){var p=[],b=0;if(c=="pdb")for(var E=l.indexOf(`
ATOM`);E!=-1;){for(;l.slice(E,E+5)==`
ATOM`||l.slice(E,E+7)==`
HETATM`;)p[b++]=parseFloat(l.slice(E+31,E+39)),p[b++]=parseFloat(l.slice(E+39,E+47)),p[b++]=parseFloat(l.slice(E+47,E+55)),E=l.indexOf(`
`,E+54),l.slice(E,E+4)==`
TER`&&(E=l.indexOf(`
`,E+5));E=l.indexOf(`
ATOM`,E)}else if(c=="netcdf"){var C=new v.NetCDFReader(l);p=[].concat.apply([],C.getDataVariable("coordinates"))}else{if(c=="array"||Array.isArray(l))return l.flat(2);{let g=l.indexOf(`
`);c=="inpcrd"&&(g=l.indexOf(`
`,g+1)),l=l.slice(g+1),p=l.match(/\S+/g).map(parseFloat)}}return p}static parseMolData(l,c="",p){if(!l)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{c.match(/bcif/i)?l=(0,d.inflateString)(l,!1):l=(0,d.inflateString)(l)}catch(C){console.log(C)}}typeof m.Parsers[c]>"u"&&(c=c.split(".").pop(),typeof m.Parsers[c]>"u"&&(console.log("Unknown format: "+c),l instanceof Uint8Array?c="bcif":l.match(/^@<TRIPOS>MOLECULE/gm)?c="mol2":l.match(/^data_/gm)&&l.match(/^loop_/gm)?c="cif":l.match(/^HETATM/gm)||l.match(/^ATOM/gm)?c="pdb":l.match(/ITEM: TIMESTEP/gm)?c="lammpstrj":l.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?c="sdf":l.match(/^%VERSION\s+VERSION_STAMP/gm)?c="prmtop":c="xyz",console.log("Best guess: "+c)));var b=m.Parsers[c],E=b(l,p);return E}}D.defaultAtomStyle={line:{}},D.defaultlineWidth=1,D.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},D.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])},"./src/GLShape.ts":(n,e,t)=>{t.r(e),t.d(e,{GLShape:()=>v,splitMesh:()=>_});var i=t("./src/WebGL/index.ts"),r=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts"),a=t("./src/ProteinSurface4.ts"),h=t("./src/VolumeData.ts"),d=t("./src/GLDraw.ts"),u=t("./src/glcartoon.ts"),m=t("./src/utilities.ts");class v{static finalizeGeo(f){var l=f.updateGeoGroup(0);l.vertices>0&&l.truncateArrayBuffers(!0,!0)}static updateColor(f,l){l=l||o.CC.color(l),f.colorsNeedUpdate=!0;var c,p,b;l.constructor!==Array&&(c=l.r,p=l.g,b=l.b);for(let E in f.geometryGroups){let C=f.geometryGroups[E],g=C.colorArray;for(let x=0,y=C.vertices;x<y;++x){if(l.constructor===Array){let w=l[x];c=w.r,p=w.g,b=w.b}g[x*3]=c,g[x*3+1]=p,g[x*3+2]=b}}}static drawArrow(f,l,c){var p=c.start,b=c.end,E=c.radius,C=c.radiusRatio,g=c.mid,x=c.midpos;if(!(p&&b))return;var y=l.updateGeoGroup(51),w=new s.Vector3(b.x,b.y,b.z).sub(p);if(x){let ae=w.length();x>0?g=x/ae:g=(ae+x)/ae}w.multiplyScalar(g);var M=new s.Vector3(p.x,p.y,p.z).add(w),S=w.clone().negate();let O=new s.Vector3(p.x,p.y,p.z);f.intersectionShape.cylinder.push(new r.Cylinder(O,M.clone(),E)),f.intersectionShape.sphere.push(new r.Sphere(O,E));var P=[];P[0]=w.clone(),Math.abs(P[0].x)>1e-4?P[0].y+=1:P[0].x+=1,P[0].cross(w),P[0].normalize(),P[4]=P[0].clone(),P[4].crossVectors(P[0],w),P[4].normalize(),P[8]=P[0].clone().negate(),P[12]=P[4].clone().negate(),P[2]=P[0].clone().add(P[4]).normalize(),P[6]=P[4].clone().add(P[8]).normalize(),P[10]=P[8].clone().add(P[12]).normalize(),P[14]=P[12].clone().add(P[0]).normalize(),P[1]=P[0].clone().add(P[2]).normalize(),P[3]=P[2].clone().add(P[4]).normalize(),P[5]=P[4].clone().add(P[6]).normalize(),P[7]=P[6].clone().add(P[8]).normalize(),P[9]=P[8].clone().add(P[10]).normalize(),P[11]=P[10].clone().add(P[12]).normalize(),P[13]=P[12].clone().add(P[14]).normalize(),P[15]=P[14].clone().add(P[0]).normalize();var I=y.vertices,F=y.vertexArray,k=y.faceArray,B=y.normalArray,U=y.lineArray,W,R,z;for(R=0,z=P.length;R<z;++R){W=3*(I+3*R);var G=P[R].clone().multiplyScalar(E).add(p),q=P[R].clone().multiplyScalar(E).add(M),Q=P[R].clone().multiplyScalar(E*C).add(M);if(F[W]=G.x,F[W+1]=G.y,F[W+2]=G.z,F[W+3]=q.x,F[W+4]=q.y,F[W+5]=q.z,F[W+6]=Q.x,F[W+7]=Q.y,F[W+8]=Q.z,R>0){var ne=F[W-3],te=F[W-2],oe=F[W-1],re=new s.Vector3(ne,te,oe),le=new s.Vector3(b.x,b.y,b.z),Ce=M.clone(),De=new s.Vector3(Q.x,Q.y,Q.z);f.intersectionShape.triangle.push(new r.Triangle(De,le,re)),f.intersectionShape.triangle.push(new r.Triangle(re.clone(),Ce,De.clone()))}}y.vertices+=48,W=y.vertices*3,F[W]=p.x,F[W+1]=p.y,F[W+2]=p.z,F[W+3]=M.x,F[W+4]=M.y,F[W+5]=M.z,F[W+6]=b.x,F[W+7]=b.y,F[W+8]=b.z,y.vertices+=3;var Oe,_e,Z,xe,we,ie,Ne,Ge,Ue,Ie,ze,Re,Le,We,He,H,K,X,pe,ue=y.vertices-3,ye=y.vertices-2,Se=y.vertices-1,V=ue*3,he=ye*3,ve=Se*3;for(R=0,z=P.length-1;R<z;++R){var Pe=I+3*R;W=Pe*3,_e=y.faceidx,Z=y.lineidx,xe=Pe,Ie=xe*3,we=Pe+1,ze=we*3,ie=Pe+2,Re=ie*3,Ne=Pe+4,Le=Ne*3,Ge=Pe+5,We=Ge*3,Ue=Pe+3,He=Ue*3,H=K=P[R],X=pe=P[R+1],B[Ie]=H.x,B[ze]=K.x,B[He]=pe.x,B[Ie+1]=H.y,B[ze+1]=K.y,B[He+1]=pe.y,B[Ie+2]=H.z,B[ze+2]=K.z,B[He+2]=pe.z,B[ze]=K.x,B[Le]=X.x,B[He]=pe.x,B[ze+1]=K.y,B[Le+1]=X.y,B[He+1]=pe.y,B[ze+2]=K.z,B[Le+2]=X.z,B[He+2]=pe.z,B[Re]=K.x,B[We]=X.x,B[Re+1]=K.y,B[We+1]=X.y,B[Re+2]=K.z,B[We+2]=X.z,k[_e]=xe,k[_e+1]=we,k[_e+2]=Ue,k[_e+3]=we,k[_e+4]=Ne,k[_e+5]=Ue,k[_e+6]=xe,k[_e+7]=Ue,k[_e+8]=ue,k[_e+9]=ie,k[_e+10]=ye,k[_e+11]=Ge,k[_e+12]=ie,k[_e+13]=Se,k[_e+14]=Ge,U[Z]=xe,U[Z+1]=we,U[Z+2]=xe,U[Z+3]=Ue,U[Z+4]=Ne,U[Z+5]=Ue,U[Z+6]=xe,U[Z+7]=Ue,U[Z+8]=ie,U[Z+9]=we,U[Z+10]=ie,U[Z+11]=Ge,U[Z+12]=Ne,U[Z+13]=Ge,U[Z+14]=ie,U[Z+15]=Se,U[Z+16]=ie,U[Z+17]=Ge,U[Z+18]=Se,U[Z+19]=Ge,y.faceidx+=15,y.lineidx+=20}Oe=[I+45,I+46,I+1,I,I+47,I+2],_e=y.faceidx,Z=y.lineidx,xe=Oe[0],Ie=xe*3,we=Oe[1],ze=we*3,ie=Oe[4],Re=ie*3,Ne=Oe[2],Le=Ne*3,Ge=Oe[5],We=Ge*3,Ue=Oe[3],He=Ue*3,H=K=P[15],X=pe=P[0],B[Ie]=H.x,B[ze]=K.x,B[He]=pe.x,B[Ie+1]=H.y,B[ze+1]=K.y,B[He+1]=pe.y,B[Ie+2]=H.z,B[ze+2]=K.z,B[He+2]=pe.z,B[ze]=K.x,B[Le]=X.x,B[He]=pe.x,B[ze+1]=K.y,B[Le+1]=X.y,B[He+1]=pe.y,B[ze+2]=K.z,B[Le+2]=X.z,B[He+2]=pe.z,B[Re]=K.x,B[We]=X.x,B[Re+1]=K.y,B[We+1]=X.y,B[Re+2]=K.z,B[We+2]=X.z,w.normalize(),S.normalize(),B[V]=S.x,B[he]=B[ve]=w.x,B[V+1]=S.y,B[he+1]=B[ve+1]=w.y,B[V+2]=S.z,B[he+2]=B[ve+2]=w.z,k[_e]=xe,k[_e+1]=we,k[_e+2]=Ue,k[_e+3]=we,k[_e+4]=Ne,k[_e+5]=Ue,k[_e+6]=xe,k[_e+7]=Ue,k[_e+8]=ue,k[_e+9]=ie,k[_e+10]=ye,k[_e+11]=Ge,k[_e+12]=ie,k[_e+13]=Se,k[_e+14]=Ge,U[Z]=xe,U[Z+1]=we,U[Z+2]=xe,U[Z+3]=Ue,U[Z+4]=Ne,U[Z+5]=Ue,U[Z+6]=xe,U[Z+7]=Ue,U[Z+8]=ie,U[Z+9]=we,U[Z+10]=ie,U[Z+11]=Ge,U[Z+12]=Ne,U[Z+13]=Ge,U[Z+14]=ie,U[Z+15]=Se,U[Z+16]=ie,U[Z+17]=Ge,U[Z+18]=Se,U[Z+19]=Ge,y.faceidx+=15,y.lineidx+=20}static updateBoundingFromPoints(f,l,c,p){f.center.set(0,0,0);let b=1/0,E=1/0,C=1/0,g=-1/0,x=-1/0,y=-1/0;f.box&&(b=f.box.min.x,g=f.box.max.x,E=f.box.min.y,x=f.box.max.y,C=f.box.min.z,y=f.box.max.z);for(let O=0,P=p;O<P;O++){var w=c[O*3],M=c[O*3+1],S=c[O*3+2];w<b&&(b=w),M<E&&(E=M),S<C&&(C=S),w>g&&(g=w),M>x&&(x=M),S>y&&(y=S)}f.center.set((g+b)/2,(x+E)/2,(y+C)/2),f.radius=f.center.distanceTo({x:g,y:x,z:y}),f.box={min:{x:b,y:E,z:C},max:{x:g,y:x,z:y}}}static addCustomGeo(f,l,c,p,b){var E=l.addGeoGroup(),C=c.vertexArr,g=c.normalArr,x=c.faceArr;E.vertices=C.length,E.faceidx=x.length;var y,w,M,S,O,P,I,F,k,B=E.vertexArray,U=E.colorArray;for(p.constructor!==Array&&(F=p.r,k=p.g,S=p.b),P=0,I=E.vertices;P<I;++P)y=P*3,w=C[P],B[y]=w.x,B[y+1]=w.y,B[y+2]=w.z,p.constructor===Array&&(O=p[P],F=O.r,k=O.g,S=O.b),U[y]=F,U[y+1]=k,U[y+2]=S;if(b)for(P=0,I=E.faceidx/3;P<I;++P){y=P*3,M=x[y],S=x[y+1],O=x[y+2];var W=new s.Vector3,R=new s.Vector3,z=new s.Vector3;f.intersectionShape.triangle.push(new r.Triangle(W.copy(C[M]),R.copy(C[S]),z.copy(C[O])))}if(b){var G=new s.Vector3(0,0,0),q=0;for(let te=0;te<l.geometryGroups.length;te++)G.add(l.geometryGroups[te].getCentroid()),q++;G.divideScalar(q),v.updateBoundingFromPoints(f.boundingSphere,{centroid:G},B,E.vertices)}if(E.faceArray=new Uint16Array(x),E.truncateArrayBuffers(!0,!0),g.length<E.vertices)E.setNormals();else{var Q=E.normalArray=new Float32Array(E.vertices*3),ne;for(P=0,I=E.vertices;P<I;++P)y=P*3,ne=g[P],Q[y]=ne.x,Q[y+1]=ne.y,Q[y+2]=ne.z}E.setLineIndices(),E.lineidx=E.lineArray.length}static updateFromStyle(f,l){typeof l.color<"u"?(f.color=l.color||new o.Color,l.color instanceof o.Color||(f.color=o.CC.color(l.color))):f.color=o.CC.color(0),f.wireframe=!!l.wireframe,f.opacity=l.alpha?(0,s.clamp)(l.alpha,0,1):1,typeof l.opacity<"u"&&(f.opacity=(0,s.clamp)(l.opacity,0,1)),f.side=l.side!==void 0?l.side:i.DoubleSide,f.linewidth=typeof l.linewidth>"u"?1:l.linewidth,f.clickable=!!l.clickable,f.callback=(0,m.makeFunction)(l.callback),f.hoverable=!!l.hoverable,f.hover_callback=(0,m.makeFunction)(l.hover_callback),f.unhover_callback=(0,m.makeFunction)(l.unhover_callback),f.contextMenuEnabled=!!l.contextMenuEnabled,f.hidden=l.hidden,f.frame=l.frame}constructor(f){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=i.DoubleSide,this.stylespec=f||{},this.boundingSphere=new r.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},v.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new i.Geometry(!0),this.linegeo=new i.Geometry(!0)}updateStyle(f){for(var l in f)this.stylespec[l]=f[l];if(v.updateFromStyle(this,this.stylespec),f.voldata&&f.volscheme){(0,m.adjustVolumeStyle)(f);const c=f.volscheme,p=f.voldata,b=o.CC,E=c.range()||[-1,1];this.geo.setColors(function(C,g,x){let y=p.getVal(C,g,x);return b.color(c.valueToHex(y,E))}),delete this.color}}addCustom(f){f.vertexArr=f.vertexArr||[],f.faceArr=f.faceArr||[],f.normalArr=f.normalArr||[],v.drawCustom(this,this.geo,f)}addSphere(f){f.center||(f.center=new s.Vector3(0,0,0)),f.radius=f.radius?(0,s.clamp)(f.radius,0,1/0):1.5,f.color=o.CC.color(f.color),this.intersectionShape.sphere.push(new r.Sphere(f.center,f.radius)),d.GLDraw.drawSphere(this.geo,f.center,f.radius,f.color,f.quality),this.components.push({centroid:new s.Vector3(f.center.x,f.center.y,f.center.z)});var l=this.geo.updateGeoGroup(0);v.updateBoundingFromPoints(this.boundingSphere,this.components,l.vertexArray,l.vertices)}addBox(f){var l=f.dimensions||{w:1,h:1,d:1},c;typeof l.w=="number"?c={x:l.w,y:0,z:0}:c=l.w;var p;typeof l.h=="number"?p={x:0,y:l.h,z:0}:p=l.h;var b;typeof l.d=="number"?b={x:0,y:0,z:l.d}:b=l.d;var E=f.corner;E==null&&(f.center!==void 0?E={x:f.center.x-.5*(c.x+p.x+b.x),y:f.center.y-.5*(c.y+p.y+b.y),z:f.center.z-.5*(c.z+p.z+b.z)}:E={x:0,y:0,z:0});var C=[{x:E.x,y:E.y,z:E.z},{x:E.x+c.x,y:E.y+c.y,z:E.z+c.z},{x:E.x+p.x,y:E.y+p.y,z:E.z+p.z},{x:E.x+c.x+p.x,y:E.y+c.y+p.y,z:E.z+c.z+p.z},{x:E.x+b.x,y:E.y+b.y,z:E.z+b.z},{x:E.x+c.x+b.x,y:E.y+c.y+b.y,z:E.z+c.z+b.z},{x:E.x+p.x+b.x,y:E.y+p.y+b.y,z:E.z+p.z+b.z},{x:E.x+c.x+p.x+b.x,y:E.y+c.y+p.y+b.y,z:E.z+c.z+p.z+b.z}],g=[],x=[];g.splice(g.length,0,C[0],C[1],C[2],C[3]),x.splice(x.length,0,0,2,1,1,2,3);var y=4;g.splice(g.length,0,C[2],C[3],C[6],C[7]),x.splice(x.length,0,y+0,y+2,y+1,y+1,y+2,y+3),y+=4,g.splice(g.length,0,C[4],C[5],C[0],C[1]),x.splice(x.length,0,y+0,y+2,y+1,y+1,y+2,y+3),y+=4,g.splice(g.length,0,C[6],C[7],C[4],C[5]),x.splice(x.length,0,y+0,y+2,y+1,y+1,y+2,y+3),y+=4,g.splice(g.length,0,C[3],C[1],C[7],C[5]),x.splice(x.length,0,y+0,y+2,y+1,y+1,y+2,y+3),y+=4,g.splice(g.length,0,C[2],C[6],C[0],C[4]),x.splice(x.length,0,y+0,y+2,y+1,y+1,y+2,y+3),y+=4;var w=(0,m.extend)({},f);w.vertexArr=g,w.faceArr=x,w.normalArr=[],v.drawCustom(this,this.geo,w);var M=new s.Vector3;this.components.push({centroid:M.addVectors(C[0],C[7]).multiplyScalar(.5)});var S=this.geo.updateGeoGroup(0);v.updateBoundingFromPoints(this.boundingSphere,this.components,S.vertexArray,S.vertices)}addCylinder(f){var l,c;f.start?l=new s.Vector3(f.start.x||0,f.start.y||0,f.start.z||0):l=new s.Vector3(0,0,0),f.end?(c=new s.Vector3(f.end.x,f.end.y||0,f.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new s.Vector3(0,0,0);var p=f.radius||.1,b=o.CC.color(f.color);this.intersectionShape.cylinder.push(new r.Cylinder(l,c,p)),d.GLDraw.drawCylinder(this.geo,l,c,p,b,f.fromCap,f.toCap);var E=new s.Vector3;this.components.push({centroid:E.addVectors(l,c).multiplyScalar(.5)});var C=this.geo.updateGeoGroup(0);v.updateBoundingFromPoints(this.boundingSphere,this.components,C.vertexArray,C.vertices)}addDashedCylinder(f){f.dashLength=f.dashLength||.25,f.gapLength=f.gapLength||.25;var l;f.start?l=new s.Vector3(f.start.x||0,f.start.y||0,f.start.z||0):l=new s.Vector3(0,0,0);var c;f.end?(c=new s.Vector3(f.end.x,f.end.y||0,f.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new s.Vector3(3,0,0);for(var p=f.radius||.1,b=o.CC.color(f.color),E=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2)+Math.pow(l.z-c.z,2)),C=E/(f.gapLength+f.dashLength),g=new s.Vector3(f.start.x||0,f.start.y||0,f.start.z||0),x=new s.Vector3(f.end.x,f.end.y||0,f.end.z||0),y=new s.Vector3((c.x-l.x)/(E/f.gapLength),(c.y-l.y)/(E/f.gapLength),(c.z-l.z)/(E/f.gapLength)),w=new s.Vector3((c.x-l.x)/(E/f.dashLength),(c.y-l.y)/(E/f.dashLength),(c.z-l.z)/(E/f.dashLength)),M=0;M<C;M++)x=new s.Vector3(g.x+w.x,g.y+w.y,g.z+w.z),this.intersectionShape.cylinder.push(new r.Cylinder(g,x,p)),d.GLDraw.drawCylinder(this.geo,g,x,p,b,f.fromCap,f.toCap),g=new s.Vector3(x.x+y.x,x.y+y.y,x.z+y.z);var S=new s.Vector3;this.components.push({centroid:S.addVectors(l,c).multiplyScalar(.5)});var O=this.geo.updateGeoGroup(0);v.updateBoundingFromPoints(this.boundingSphere,this.components,O.vertexArray,O.vertices)}addCurve(f){f.points=f.points||[],f.smooth=f.smooth||10,typeof f.fromCap>"u"&&(f.fromCap=2),typeof f.toCap>"u"&&(f.toCap=2);var l=(0,u.subdivide_spline)(f.points,f.smooth);if(l.length<3){console.log("Too few points in addCurve");return}var c=f.radius||.1,p=o.CC.color(f.color),b=0,E=l.length-1,C=l[0].distanceTo(l[1]),g=Math.ceil(2*c/C);if(f.toArrow){E-=g;let M={start:l[E],end:l[l.length-1],radius:c,color:p,mid:1e-4};this.addArrow(M)}if(f.fromArrow){b+=g;let M={start:l[b],end:l[0],radius:c,color:p,mid:1e-4};this.addArrow(M)}for(var x=Math.ceil(l.length/2),y={radius:c,color:p,fromCap:2,toCap:2},w=b;w<E;w++)y.start=l[w],y.end=l[w+1],y.fromCap=2,y.toCap=2,w<x?(y.fromCap=2,y.toCap=0):w>x?(y.fromCap=0,y.toCap=2):(y.fromCap=2,y.toCap=2),this.addCylinder(y)}addLine(f){var l,c;f.start?l=new s.Vector3(f.start.x||0,f.start.y||0,f.start.z||0):l=new s.Vector3(0,0,0),f.end?(c=new s.Vector3(f.end.x,f.end.y||0,f.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new s.Vector3(3,0,0);var p=this.geo.updateGeoGroup(2),b=p.vertices,E=b*3,C=p.vertexArray;C[E]=l.x,C[E+1]=l.y,C[E+2]=l.z,C[E+3]=c.x,C[E+4]=c.y,C[E+5]=c.z,p.vertices+=2;var g=p.lineArray,x=p.lineidx;g[x]=b,g[x+1]=b+1,p.lineidx+=2;var y=new s.Vector3;this.components.push({centroid:y.addVectors(l,c).multiplyScalar(.5)}),p=this.geo.updateGeoGroup(0),v.updateBoundingFromPoints(this.boundingSphere,this.components,p.vertexArray,p.vertices)}addArrow(f){if(f.start?f.start=new s.Vector3(f.start.x||0,f.start.y||0,f.start.z||0):f.start=new s.Vector3(0,0,0),f.dir instanceof s.Vector3&&typeof f.length=="number"){var l=f.dir.clone().multiplyScalar(f.length).add(f.start);f.end=l}else f.end?(f.end=new s.Vector3(f.end.x,f.end.y||0,f.end.z||0),typeof f.end.x>"u"&&(f.end.x=3)):f.end=new s.Vector3(3,0,0);f.radius=f.radius||.1,f.radiusRatio=f.radiusRatio||1.618034,f.mid=0<f.mid&&f.mid<1?f.mid:.618034,v.drawArrow(this,this.geo,f);var c=new s.Vector3;this.components.push({centroid:c.addVectors(f.start,f.end).multiplyScalar(.5)});var p=this.geo.updateGeoGroup(0);v.updateBoundingFromPoints(this.boundingSphere,this.components,p.vertexArray,p.vertices)}static distance_from(f,l){return Math.sqrt(Math.pow(f.x-l.x,2)+Math.pow(f.y-l.y,2)+Math.pow(f.z-l.z,2))}static inSelectedRegion(f,l,c){for(var p=0;p<l.length;p++)if(v.distance_from(l[p],f)<=c)return!0;return!1}addIsosurface(f,l,c,p){var b=l.isoval!==void 0&&typeof l.isoval=="number"?l.isoval:0,E=!!l.voxel,C=l.smoothness===void 0?1:l.smoothness,g=f.size.x,x=f.size.y,y=f.size.z,w=new Int16Array(g*x*y),M=f.data,S,O;for(S=0,O=w.length;S<O;++S)w[S]=-1;var P=new Uint8Array(g*x*y);for(S=0,O=M.length;S<O;++S){var I=b>=0?M[S]-b:b-M[S];I>0&&(P[S]|=v.ISDONE)}var F=[],k=[];a.MarchingCube.march(P,F,k,{fulltable:!0,voxel:E,unitCube:f.unit,origin:f.origin,matrix:f.matrix,nX:g,nY:x,nZ:y}),!E&&C>0&&a.MarchingCube.laplacianSmooth(C,F,k);var B=[],U=[],W=[];if(l.selectedRegion&&l.coords===void 0&&(l.coords=l.selectedRegion),l.coords===void 0&&l.selection!==void 0&&(p?l.coords=p.selectedAtoms(l.selection):console.log("addIsosurface needs viewer is selection provided.")),l.coords!==void 0){var R=l.coords[0].x,z=l.coords[0].y,G=l.coords[0].z,q=l.coords[0].x,Q=l.coords[0].y,ne=l.coords[0].z;for(let Z=0;Z<l.coords.length;Z++)l.coords[Z].x>R?R=l.coords[Z].x:l.coords[Z].x<q&&(q=l.coords[Z].x),l.coords[Z].y>z?z=l.coords[Z].y:l.coords[Z].y<Q&&(Q=l.coords[Z].y),l.coords[Z].z>G?G=l.coords[Z].z:l.coords[Z].z<ne&&(ne=l.coords[Z].z);var te=2;l.radius!==void 0&&(te=l.radius),l.selectedOffset!==void 0&&(te=l.selectedOffset),l.seldist!==void 0&&(te=l.seldist),q-=te,R+=te,Q-=te,z+=te,ne-=te,G+=te;for(let Z=0;Z<F.length;Z++)F[Z].x>q&&F[Z].x<R&&F[Z].y>Q&&F[Z].y<z&&F[Z].z>ne&&F[Z].z<G&&v.inSelectedRegion(F[Z],l.coords,te)?(B.push(U.length),U.push(F[Z])):B.push(-1);for(let Z=0;Z+2<k.length;Z+=3)B[k[Z]]!==-1&&B[k[Z+1]]!==-1&&B[k[Z+2]]!==-1&&(W.push(k[Z]-(k[Z]-B[k[Z]])),W.push(k[Z+1]-(k[Z+1]-B[k[Z+1]])),W.push(k[Z+2]-(k[Z+2]-B[k[Z+2]])));F=U,k=W}v.drawCustom(this,this.geo,{vertexArr:F,faceArr:k,normalArr:[],clickable:l.clickable,hoverable:l.hoverable}),this.updateStyle(l);var oe=new s.Vector3(f.origin.x,f.origin.y,f.origin.z),re=new s.Vector3(f.size.x*f.unit.x,f.size.y*f.unit.y,f.size.z*f.unit.z),le=new s.Vector3(0,0,0),Ce=oe.clone(),De=oe.clone().add(re);for(let Z=0;Z<F.length;Z++)le.add(F[Z]),Ce.max(F[Z]),De.min(F[Z]);le.divideScalar(F.length);var Oe=le.distanceTo(De),_e=le.distanceTo(Ce);this.boundingSphere.center=le,this.boundingSphere.radius=Math.max(Oe,_e),typeof c=="function"&&c()}addVolumetricData(f,l,c){f=new h.VolumeData(f,l),this.addIsosurface(f,c)}finalize(){return v.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(f){if(this.renderedShapeObj&&(f.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){v.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&v.updateColor(this.geo,this.color),this.shapeObj=new i.Object3D;var l=null;this.side==i.DoubleSide?l=new i.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:i.Coloring.VertexColors}):l=new i.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:i.Coloring.VertexColors});var c=new i.Mesh(this.geo,l);if(this.shapeObj.add(c),this.linegeo&&this.linegeo.vertices>0){var p=new i.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),b=new i.Line(this.linegeo,p,i.LineStyle.LinePieces);this.shapeObj.add(b)}this.renderedShapeObj=this.shapeObj.clone(),f.add(this.renderedShapeObj)}}removegl(f){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),f.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}v.ISDONE=2,v.drawCustom=function(D,f,l){var c=l,p=c.vertexArr,b=c.faceArr;(p.length===0||b.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var E=l.color;typeof E>"u"&&(E=D.color),E=o.CC.color(E);for(var C=_(c),g=0,x=C.length;g<x;g++)v.addCustomGeo(D,f,C[g],C[g].colorArr?C[g].colorArr:E,l.clickable)};function _(D){var f=64e3;if(D.vertexArr.length<f)return[D];var l=[{vertexArr:[],normalArr:[],faceArr:[]}];D.colorArr&&(l.colorArr=[]);var c=[],p=[],b=0,E=D.faceArr;for(let g=0,x=E.length;g<x;g+=3){let y=l[b];for(let w=0;w<3;w++){var C=E[g+w];c[C]!==b&&(c[C]=b,p[C]=y.vertexArr.length,y.vertexArr.push(D.vertexArr[C]),D.normalArr&&D.normalArr[C]&&y.normalArr.push(D.normalArr[C]),D.colorArr&&D.colorArr[C]&&y.colorArr.push(D.colorArr[C])),y.faceArr.push(p[C])}y.vertexArr.length>=f&&(l.push({vertexArr:[],normalArr:[],faceArr:[]}),D.colorArr&&(l.colorArr=[]),b++)}return l}},"./src/GLViewer.ts":(n,e,t)=>{t.r(e),t.d(e,{CONTEXTS_PER_VIEWPORT:()=>f,GLViewer:()=>c,createStereoViewer:()=>E,createViewer:()=>p,createViewerGrid:()=>b});var i=t("./node_modules/upng-js/UPNG.js"),r=t("./src/GLModel.ts"),s=t("./src/GLShape.ts"),o=t("./src/Gradient.ts"),a=t("./src/Label.ts"),h=t("./src/ProteinSurface4.ts"),d=t("./src/VolumeData.ts"),u=t("./src/VolumetricRender.ts"),m=t("./src/WebGL/index.ts"),v=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts"),D=t("./src/utilities.ts");const f=16;class l extends Array{constructor(g){super(...g)}getSymmetries(){if(this.length==0)return[];let g=this[0];return typeof g.symmetries>"u"&&this.setSymmetries([new v.Matrix4]),g.symmetries}setSymmetries(g){typeof g>"u"&&(g=[new v.Matrix4]);for(let x of this)x.symmetries=g,x.finished=!1}}class c{getWidth(){let g=this.container,x=g.offsetWidth;if(x==0&&g.style.display==="none"){let y=g.style.position,w=g.style.visibility;g.style.display="block",g.style.visibility="hidden",g.style.position="absolute",x=g.offsetWidth,g.style.display="none",g.style.visibility=w,g.style.position=y}return x}getHeight(){let g=this.container,x=g.offsetHeight;if(x==0&&g.style.display==="none"){let y=g.style.position,w=g.style.visibility;g.style.display="block",g.style.visibility="hidden",g.style.position="absolute",x=g.offsetHeight,g.style.display="none",g.style.visibility=w,g.style.position=y}return x}setupRenderer(){let g=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new m.Renderer(g),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new m.Scene,this.scene.fog=new m.Fog(this.bgColor,100,200),this.modelGroup=new m.Object3D,this.rotationGroup=new m.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new v.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var g=new m.Light(16777215);g.position=new v.Vector3(.2,.2,1).normalize(),g.intensity=1,this.scene.add(g)}_handleLostContext(g){const x=function(y){const w=y.getBoundingClientRect();return!(w.right<0||w.bottom<0||w.top>(window.innerHeight||document.documentElement.clientHeight)||w.left>(window.innerWidth||document.documentElement.clientWidth))};if(x(this.container)){let y=0;for(let w of document.getElementsByTagName("canvas"))if(x(w)&&w._3dmol_viewer!=null&&(w._3dmol_viewer.resize(),y+=1,y>=f))break}}initContainer(g){this.container=g,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var g=0;for(let y in this.surfaces)if(this.surfaces.hasOwnProperty(y)){var x=parseInt(y);isNaN(x)||x>g&&(g=x)}return g+1}setSlabAndFog(){let g=this.camera.position.z-this.rotationGroup.position.z;g<1&&(g=1),this.camera.near=g+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=g+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=g*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(g){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!g&&this.linkedViewers.length>0))for(var x=this._viewer.getView(),y=0;y<this.linkedViewers.length;y++){var w=this.linkedViewers[y];w.setView(x,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let g=0,x=this.models.length;g<x;g++){let y=this.models[g];if(y){let w=y.selectedAtoms({clickable:!0}),M=y.selectedAtoms({hoverable:!0}),S=y.selectedAtoms({contextMenuEnabled:!0});for(let O=0;O<M.length;O++)this.hoverables.push(M[O]);for(let O=0;O<w.length;O++)this.clickables.push(w[O]);for(let O=0;O<S.length;O++)this.contextMenuEnabledObjects.push(S[O])}}for(let g=0,x=this.shapes.length;g<x;g++){let y=this.shapes[g];y&&y.clickable&&this.clickables.push(y),y&&y.hoverable&&this.hoverables.push(y),y&&y.contextMenuEnabled&&this.contextMenuEnabledObjects.push(y)}}handleClickSelection(g,x,y){let w=this.targetedObjects(g,x,this.clickables);if(w.length){var M=w[0].clickable;M.callback!==void 0&&(typeof M.callback!="function"&&(M.callback=(0,D.makeFunction)(M.callback)),typeof M.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(M)&&this.userContextMenuHandler||M.callback(M,this._viewer,y,this.container,w)))}}canvasOffset(){let g=this.glDOM,x=g.getBoundingClientRect(),y=g.ownerDocument,w=y.documentElement,M=y.defaultView;return{top:x.top+M.pageYOffset-w.clientTop,left:x.left+M.pageXOffset-w.clientLeft}}setHover(g,x,y){this.current_hover!=g&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,D.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,x,this.container,y)),this.current_hover=g,g&&g.hover_callback!==void 0&&(typeof g.hover_callback!="function"&&(g.hover_callback=(0,D.makeFunction)(g.hover_callback)),typeof g.hover_callback=="function"&&g.hover_callback(g,this._viewer,x,this.container,y)))}handleHoverSelection(g,x,y){if(this.hoverables.length==0)return;let w=this.targetedObjects(g,x,this.hoverables);if(w.length){var M=w[0].clickable;this.setHover(M,y,w),this.current_hover=M}else this.setHover(null)}handleHoverContinue(g,x){let y=this.targetedObjects(g,x,this.hoverables);(y.length==0||y[0]===void 0)&&this.setHover(null),y[0]!==void 0&&y[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(g,{allowTolerance:x=g.targetTouches,tolerance:y=5}={}){const w=this.getX(g),M=this.getY(g);if(x){const S=Math.abs(w-this.mouseStartX),O=Math.abs(M-this.mouseStartY);return S<=y&&O<=y}else return w===this.mouseStartX&&M===this.mouseStartY}calcTouchDistance(g){var x=g.targetTouches[0].pageX-g.targetTouches[1].pageX,y=g.targetTouches[0].pageY-g.targetTouches[1].pageY;return Math.hypot(x,y)}getX(g){var x=g.pageX;return x==null&&(x=g.pageX),g.targetTouches&&g.targetTouches[0]?x=g.targetTouches[0].pageX:g.changedTouches&&g.changedTouches[0]&&(x=g.changedTouches[0].pageX),x}getY(g){var x=g.pageY;return x==null&&(x=g.pageY),g.targetTouches&&g.targetTouches[0]?x=g.targetTouches[0].pageY:g.changedTouches&&g.changedTouches[0]&&(x=g.changedTouches[0].pageY),x}isInViewer(g,x){if(this.viewers!=null){var y=this.WIDTH/this.cols,w=this.HEIGHT/this.rows,M=this.canvasOffset(),S=g-M.left,O=x-M.top,P=this.rows-Math.floor(O/w)-1,I=Math.floor(S/y);if(P!=this.row||I!=this.col)return!1}return!0}adjustZoomToLimits(g){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let x=this.CAMERA_Z-this.config.lowerZoomLimit;g>x&&(g=x)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let x=this.CAMERA_Z-this.config.upperZoomLimit;g<x&&(g=x)}return g>this.CAMERA_Z-1&&(g=this.CAMERA_Z-1),g}static slerp(g,x,y){if(y==1)return x.clone();if(y==0)return g.clone();let w=g.x*x.x+g.y*x.y+g.z*x.z+g.w*x.w;if(w>.9995){let k=new v.Quaternion(g.x+y*(x.x-g.x),g.y+y*(x.y-g.y),g.z+y*(x.z-g.z),g.w+y*(x.w-g.w));return k.normalize(),k}w<0&&(x=x.clone().multiplyScalar(-1),w=-w),w>1?w=1:w<-1&&(w=-1);var M=Math.acos(w),S=M*y,O=x.clone();O.sub(g.clone().multiplyScalar(w)),O.normalize();var P=Math.cos(S),I=Math.sin(S),F=new v.Quaternion(g.x*P+O.x*I,g.y*P+O.y*I,g.z*P+O.z*I,g.w*P+O.w*I);return F.normalize(),F}constructor(g,x={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new v.Quaternion(0,0,0,1),this.dq=new v.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=x,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=_.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=_.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=g,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new m.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new v.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new v.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new m.Raycaster(new v.Vector3(0,0,0),new v.Vector3(0,0,0)),this.projector=new m.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=_.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let y=(w,M)=>{w.forEach(S=>{S.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(y),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(y){console.log("error with glviewer callback: "+y)}}targetedObjects(g,x,y){var w={x:g,y:x,z:-1};return Array.isArray(y)||(y=this.selectedAtoms(y)),y.length==0?[]:(this.raycaster.setFromCamera(w,this.camera),this.raycaster.intersectObjects(this.modelGroup,y))}modelToScreen(g){let x=!1;Array.isArray(g)||(g=[g],x=!0);let y=this.renderer.getXRatio(),w=this.renderer.getYRatio(),M=this.col,S=this.row,O=M*(this.WIDTH/y),P=(w-S-1)*(this.HEIGHT/w),I=[],F=this.canvasOffset();return g.forEach(k=>{let B=new v.Vector3(k.x,k.y,k.z);B.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(B,this.camera);let U=this.WIDTH/y*(B.x+1)/2+F.left+O,W=-(this.HEIGHT/w)*(B.y-1)/2+F.top+P;I.push({x:U,y:W})}),x&&(I=I[0]),I}screenOffsetToModel(g,x,y){var w=g/this.WIDTH,M=x/this.HEIGHT,S=y===void 0?this.rotationGroup.position.z:y,O=this.rotationGroup.quaternion,P=new v.Vector3(0,0,S);return this.projector.projectVector(P,this.camera),P.x+=w*2,P.y-=M*2,this.projector.unprojectVector(P,this.camera),P.z=0,P.applyQuaternion(O),P}screenToModelDistance(g,x){let y=this.canvasOffset(),w=new v.Vector3(x.x,x.y,x.z);w.applyMatrix4(this.modelGroup.matrixWorld);let M=w.clone();this.projector.projectVector(w,this.camera);let S=new v.Vector3((g.x-y.left)*2/this.WIDTH-1,(g.y-y.top)*2/-this.HEIGHT+1,w.z);return this.projector.unprojectVector(S,this.camera),S.distanceTo(M)}setViewChangeCallback(g){(typeof g=="function"||g==null)&&(this.viewChangeCallback=g)}setStateChangeCallback(g){(typeof g=="function"||g==null)&&(this.stateChangeCallback=g)}getConfig(){return this.config}setConfig(g){this.config=g,g.ambientOcclusion&&this.renderer.enableAmbientOcclusion(g.ambientOcclusion)}getInternalState(){var g={models:[],surfaces:[],shapes:[],labels:[]};for(let x=0;x<this.models.length;x++)this.models[x]&&(g.models[x]=this.models[x].getInternalState());return g}setInternalState(g){this.clear();var x=g.models;for(let y=0;y<x.length;y++)x[y]&&(this.models[y]=new r.GLModel(y,void 0,this),this.models[y].setInternalState(x[y]));this.render()}setZoomLimits(g,x){typeof g<"u"&&(this.config.lowerZoomLimit=g),x&&(this.config.upperZoomLimit=x),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(g){g.fov!==void 0&&(this.fov=g.fov,this.camera.fov=this.fov),g.z!==void 0&&(this.CAMERA_Z=g.z,this.camera.z=this.CAMERA_Z),g.orthographic!==void 0&&(this.camera.ortho=g.orthographic),this.setSlabAndFog()}_handleMouseDown(g){if(g.preventDefault(),!this.scene)return;var x=this.getX(g),y=this.getY(g);if(x===void 0)return;this.isDragging=!0,this.mouseButton=g.which,this.mouseStartX=x,this.mouseStartY=y,this.touchHold=!0,this.touchDistanceStart=0,g.targetTouches&&g.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(g)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let w=this;g.targetTouches&&g.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(w.touchHold==!0){w.glDOM=w.renderer.domElement;const M=g.targetTouches[0],S=new PointerEvent("contextmenu",Object.assign(Object.assign({},g),{pageX:M.pageX,pageY:M.pageY,screenX:M.screenX,screenY:M.screenY,clientX:M.clientX,clientY:M.clientY}));w.glDOM.dispatchEvent(S)}},this.longTouchDuration))}_handleMouseUp(g){if(this.touchHold=!1,this.isDragging&&this.scene){var x=this.getX(g),y=this.getY(g);if(this.closeEnoughForClick(g)&&this.isInViewer(x,y)){let w=this.mouseXY(x,y);this.handleClickSelection(w.x,w.y,g)}}this.isDragging=!1}_handleMouseScroll(g){if(g.preventDefault(),!!this.scene){var x=this.getX(g),y=this.getY(g);if(x!==void 0&&!(!this.control_all&&!this.isInViewer(x,y))){var w=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,M=1;if(g.ctrlKey&&(M=-1),g.detail)this.rotationGroup.position.z+=M*w*g.detail/10;else if(g.wheelDelta){let S=g.wheelDelta*600/(g.wheelDelta+600);this.rotationGroup.position.z-=M*w*S/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(g){let x=this;return g=g||1,new Promise(function(y){let w=0,M=x.viewChangeCallback,S=[],O=[],P=Date.now();x.viewChangeCallback=function(){O.push(Date.now()-P),P=Date.now(),S.push(new Promise(I=>{x.getCanvas().toBlob(function(F){F.arrayBuffer().then(I)},"image/png")})),w+=1,w==g&&(x.viewChangeCallback=M,Promise.all(S).then(I=>{let F=[];for(let z=0;z<I.length;z++){let G=(0,i.decode)(I[z]);F.push((0,i.toRGBA8)(G)[0])}let k=x.getCanvas().width,B=x.getCanvas().height,U=(0,i.encode)(F,k,B,0,O),W=new Blob([U],{type:"image/png"}),R=new FileReader;R.onload=function(z){y(z.target.result)},R.readAsDataURL(W)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(g){this.hoverDuration=g}mouseXY(g,x){let y=this.canvasOffset(),w=this.renderer.getXRatio(),M=this.renderer.getYRatio(),S=this.col,O=this.row,P=S*(this.WIDTH/w),I=(M-O-1)*(this.HEIGHT/M),F=(g-y.left-P)/(this.WIDTH/w)*2-1,k=-((x-y.top-I)/(this.HEIGHT/M))*2+1;return{x:F,y:k}}_handleMouseMove(g){clearTimeout(this.hoverTimeout),g.preventDefault();let x=this.getX(g),y=this.getY(g);if(x===void 0)return;let w=this.renderer.getXRatio(),M=this.renderer.getYRatio(),S=this.mouseXY(x,y),O=this;this.current_hover!==null&&this.handleHoverContinue(S.x,S.y);var P=0;if(!(!this.control_all&&!this.isInViewer(x,y))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){O.handleHoverSelection(S.x,S.y,g)},this.hoverDuration)),!!this.isDragging)){g.targetTouches&&(g.targetTouches.length>1||g.targetTouches.length===1&&!this.closeEnoughForClick(g))&&clearTimeout(this.longTouchTimeout);var I=(x-this.mouseStartX)/this.WIDTH,F=(y-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&g.targetTouches&&g.targetTouches.length==2){var k=this.calcTouchDistance(g);P=2,F=(k-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else g.targetTouches&&g.targetTouches.length==3&&(P=1);I*=w,F*=M;var B=Math.hypot(I,F),U;if(P==3||this.mouseButton==3&&g.ctrlKey)this.slabNear=this.cslabNear+I*100,this.slabFar=this.cslabFar-F*100;else if(P==2||this.mouseButton==3||g.shiftKey)U=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,U<80&&(U=80),this.rotationGroup.position.z=this.cz+F*U,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(P==1||this.mouseButton==2||g.ctrlKey){var W=this.screenOffsetToModel(w*(x-this.mouseStartX),M*(y-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,W)}else if((P===0||this.mouseButton==1)&&B!==0){var R=Math.sin(B*Math.PI)/B;this.dq.x=Math.cos(B*Math.PI),this.dq.y=0,this.dq.z=R*I,this.dq.w=-R*F,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(g){if(g.preventDefault(),this.closeEnoughForClick(g)){var w=this.mouseStartX,M=this.mouseStartY,y=this.canvasOffset();let S=this.mouseXY(w,M),O=S.x,P=S.y,I=this.targetedObjects(O,P,this.contextMenuEnabledObjects);var x=null;I.length&&(x=I[0].clickable);var y=this.canvasOffset(),w=this.mouseStartX-y.left,M=this.mouseStartY-y.top;this.userContextMenuHandler&&(this.userContextMenuHandler(x,w,M,I,g),this.isDragging=!1)}}setContainer(g){let x=(0,D.getElement)(g)||this.container;return this.initContainer(x),this}setBackgroundColor(g,x){(typeof x>"u"||x<0||x>1)&&(x=1);var y=_.CC.color(g);return this.scene.fog.color=y,this.bgColor=y.getHex(),this.renderer.setClearColorHex(y.getHex(),x),this.show(),this}setProjection(g){this.camera.ortho=g==="orthographic",this.setSlabAndFog()}setViewStyle(g){if(g=g||{},g.style=g.style||"",g.style.includes("outline")?this.renderer.enableOutline(g):this.renderer.disableOutline(),g.style.includes("ambientOcclusion")){var x={};g.strength&&(x.strength=g.strength),g.radius&&(x.radius=g.radius),this.renderer.enableAmbientOcclusion(x)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(g){return this.WIDTH=g||this.WIDTH,this.updateSize(),this}setHeight(g){return this.HEIGHT=g||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let g=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let x=!1,y=this.container.querySelector("canvas");y&&y!=this.renderer.getCanvas()?this.config.canvas=y:(y.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,x=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),g=!0,x&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),g){let x=this.renderer.supportedExtensions();if(x.regen=!0,this.viewers)for(let y=0,w=this.viewers.length;y<w;y++)for(let M=0,S=this.viewers[y].length;M<S;M++)this.viewers[y][M].render(null,x);this._viewer.render(null,x)}else this.show();return this}getModel(g){return g===void 0?this.models.length==0?null:this.models[this.models.length-1]:g instanceof r.GLModel?g:g in this.models?this.models[g]:this.models.length==0?null:this.models[this.models.length-1]}spin(g,x=1,y=!1){if(clearInterval(this.spinInterval),typeof g>"u"&&(g="y"),typeof g=="boolean")if(g)g="y";else return;Array.isArray(g)&&(g={x:g[0],y:g[1],z:g[2]});var w=this;this.spinInterval=setInterval(function(){!w.getCanvas().isConnected&&w.renderer.isLost()&&clearInterval(w.spinInterval),(!y||w.container.checkVisibility&&w.container.checkVisibility())&&w.rotate(1*x,g)},25)}animateMotion(g,x,y,w,M,S){var O=20,P=Math.ceil(g/O);P<1&&(P=1),this.incAnim();var I={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(x){let B=new Array(P);for(let z=0;z<P;z++){let G=(z+1)/P,q={mpos:I.mpos,rz:I.rz,rot:I.rot};q.mpos=y.clone().sub(I.mpos).multiplyScalar(G).add(I.mpos),q.rz=I.rz+G*(w-I.rz),q.rot=c.slerp(I.rot,M,G),q.cam=S.clone().sub(I.cam).multiplyScalar(G).add(I.cam),B[z]=q}let U=0,W=this,R=function(){var z=B[U];U+=1,W.modelGroup.position=z.mpos,W.rotationGroup.position.z=z.rz,W.rotationGroup.quaternion=z.rot,W.camera.lookAt(z.cam),U<B.length?setTimeout(R,O):W.decAnim(),W.show()};setTimeout(R,O)}else{var F={};let B=1/P;if(y&&(F.mpos=y.clone().sub(I.mpos).multiplyScalar(B)),typeof w<"u"&&w!=null&&(F.rz=B*(w-I.rz)),M){var k=c.slerp(I.rot,M,B);F.rot=I.rot.clone().inverse().multiply(k)}S&&(F.cam=S.clone().sub(I.cam).multiplyScalar(B));let U=0,W=this,R=function(){U+=1,F.mpos&&W.modelGroup.position.add(F.mpos),F.rz&&(W.rotationGroup.position.z+=F.rz),F.rot&&W.rotationGroup.quaternion.multiply(F.rot),F.cam&&(W.lookingAt.add(F.cam),W.camera.lookAt(W.lookingAt)),U<P?setTimeout(R,O):W.decAnim(),W.show()};setTimeout(R,O)}}rotate(g,x="y",y=0,w=!1){if(x=="x"?x={x:1,y:0,z:0}:x=="y"?x={x:0,y:1,z:0}:x=="z"&&(x={x:0,y:0,z:1}),x=="vx"?x={vx:1,vy:0,vz:0}:x=="vy"?x={vx:0,vy:1,vz:0}:x=="vz"&&(x={vx:0,vy:0,vz:1}),typeof x.vx<"u"){var M=new v.Vector3(x.vx,x.vy,x.vz);M.applyQuaternion(this.rotationGroup.quaternion),x={x:M.x,y:M.y,z:M.z}}var S=function(F){var k=Math.sin(F/2),B=Math.cos(F/2),U=0,W=0,R=0;return U=x.x*k,W=x.y*k,R=x.z*k,new v.Quaternion(U,W,R,B).normalize()},O=Math.PI*g/180,P=S(O);if(y){var I=new v.Quaternion().copy(this.rotationGroup.quaternion).multiply(P);this.animateMotion(y,w,this.modelGroup.position,this.rotationGroup.position.z,I,this.lookingAt)}else this.rotationGroup.quaternion.multiply(P),this.show();return this}surfacesFinished(){for(var g in this.surfaces)if(!this.surfaces[g][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var g=this.modelGroup.position,x=this.rotationGroup.quaternion;return[g.x,g.y,g.z,this.rotationGroup.position.z,x.x,x.y,x.z,x.w]}setView(g,x){return g===void 0||!(g instanceof Array||g.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=g[0],this.modelGroup.position.y=g[1],this.modelGroup.position.z=g[2],this.rotationGroup.position.z=g[3],this.rotationGroup.quaternion.x=g[4],this.rotationGroup.quaternion.y=g[5],this.rotationGroup.quaternion.z=g[6],this.rotationGroup.quaternion.w=g[7],typeof g[8]<"u"&&(this.rotationGroup.position.x=g[8],this.rotationGroup.position.y=g[9]),this.show(x),this)}render(g,x){this.renderer.setViewport(),this.updateClickables();var y=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var w,M;for(x||(x=this.renderer.supportedExtensions()),w=0;w<this.models.length;w++)this.models[w]&&this.models[w].globj(this.modelGroup,x);for(w=0;w<this.shapes.length;w++)this.shapes[w]&&(typeof this.shapes[w].frame>"u"||this.viewer_frame<0||this.shapes[w].frame<0||this.shapes[w].frame==this.viewer_frame?this.shapes[w].globj(this.modelGroup,x):this.shapes[w].removegl(this.modelGroup));for(w=0;w<this.labels.length;w++)x.regen&&(this.labels[w].dispose(),this.modelGroup.remove(this.labels[w].sprite),this.labels[w].setContext(),this.modelGroup.add(this.labels[w].sprite)),this.labels[w]&&typeof this.labels[w].frame<"u"&&this.labels[w].frame>=0&&(this.modelGroup.remove(this.labels[w].sprite),(this.viewer_frame<0||this.labels[w].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[w].sprite));for(w in this.surfaces)if(this.surfaces.hasOwnProperty(w)){var S=this.surfaces[w];for(M=0;M<S.length;M++)if(S.hasOwnProperty(M)){var O=S[M].geo;if(!S[M].finished||x.regen){O.verticesNeedUpdate=!0,O.elementsNeedUpdate=!0,O.normalsNeedUpdate=!0,O.colorsNeedUpdate=!0,O.buffersNeedUpdate=!0,S[M].mat.needsUpdate=!0,S[M].done&&(S[M].finished=!0),S[M].lastGL&&this.modelGroup.remove(S[M].lastGL);var P=null;if(S[M].mat instanceof m.LineBasicMaterial?P=new m.Line(O,S[M].mat):("wireframe"in S.style&&S.style.wireframe&&O.setUpWireframe(),P=new m.Mesh(O,S[M].mat)),S[M].mat.transparent&&S[M].mat.opacity==0?P.visible=!1:P.visible=!0,S[M].symmetries.length>1||S[M].symmetries.length==1&&!S[M].symmetries[0].isIdentity()){var I,F=new m.Object3D;for(I=0;I<S[M].symmetries.length;I++){var k=P.clone();k.matrix=S[M].symmetries[I],k.matrixAutoUpdate=!1,F.add(k)}S[M].lastGL=F,this.modelGroup.add(F)}else S[M].lastGL=P,this.modelGroup.add(P)}}}return this.setView(y),typeof g=="function"&&g(this),this}getModelList(g){let x=[];if(typeof g>"u"||typeof g.model>"u")for(let w=0;w<this.models.length;w++)this.models[w]&&x.push(this.models[w]);else{let w=g.model;Array.isArray(w)||(w=[w]);for(let M=0;M<w.length;M++)if(typeof w[M]=="number"){var y=w[M];y<0&&(y+=this.models.length),x.push(this.models[y])}else x.push(w[M])}return x}getAtomsFromSel(g){var x=[];typeof g>"u"&&(g={});var y=this.getModelList(g);for(let w=0;w<y.length;w++)x=x.concat(y[w].selectedAtoms(g));return x}atomIsSelected(g,x){typeof x>"u"&&(x={});for(var y=this.getModelList(x),w=0;w<y.length;w++)if(y[w].atomIsSelected(g,x))return!0;return!1}selectedAtoms(g){return this.getAtomsFromSel(g)}getUniqueValues(g,x){typeof x>"u"&&(x={});var y=this.getAtomsFromSel(x),w={};for(var M in y)if(y[M].hasOwnProperty(g)){var S=y[M][g];w[S]=!0}return Object.keys(w)}pdbData(g){for(var x=this.getAtomsFromSel(g),y="",w=0,M=x.length;w<M;++w)y+=x[w].pdbline+`
`;return y}zoom(g=2,x=0,y=!1){var w=(this.CAMERA_Z-this.rotationGroup.position.z)/g,M=this.CAMERA_Z-w;return x>0?this.animateMotion(x,y,this.modelGroup.position,this.adjustZoomToLimits(M),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(M),this.show()),this}translate(g,x,y=0,w=!1){var M=g/this.WIDTH,S=x/this.HEIGHT,O=new v.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(O,this.camera),O.x-=M,O.y-=S,this.projector.unprojectVector(O,this.camera),O.z=0;var P=this.lookingAt.clone().add(O);return y>0?this.animateMotion(y,w,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,P):(this.lookingAt=P,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(g,x,y=0,w=!1){var M=this.screenOffsetToModel(g,x),S=this.modelGroup.position.clone().add(M);return y>0?this.animateMotion(y,w,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=S,this.show()),this}fitSlab(g){g=g||{};var x=this.getAtomsFromSel(g),y=(0,D.getExtent)(x),w=y[1][0]-y[0][0],M=y[1][1]-y[0][1],S=y[1][2]-y[0][2],O=Math.hypot(w,M,S);return O<5&&(O=5),this.slabNear=-O/1.9,this.slabFar=O/2,this}center(g={},x=0,y=!1){var w,M,S=this.getAtomsFromSel(g),O=(0,D.getExtent)(S);(0,D.isEmptyObject)(g)?(this.shapes.forEach(G=>{if(G&&G.boundingSphere&&G.boundingSphere.center){var q=G.boundingSphere.center,Q=G.boundingSphere.radius;Q>0?(S.push(new v.Vector3(q.x+Q,q.y,q.z)),S.push(new v.Vector3(q.x-Q,q.y,q.z)),S.push(new v.Vector3(q.x,q.y+Q,q.z)),S.push(new v.Vector3(q.x,q.y-Q,q.z)),S.push(new v.Vector3(q.x,q.y,q.z+Q)),S.push(new v.Vector3(q.x,q.y,q.z-Q))):S.push(q)}}),O=(0,D.getExtent)(S),w=S,M=O):(w=this.getAtomsFromSel({}),M=(0,D.getExtent)(w));var P=new v.Vector3(O[2][0],O[2][1],O[2][2]),I=M[1][0]-M[0][0],F=M[1][1]-M[0][1],k=M[1][2]-M[0][2],B=Math.hypot(I,F,k);B<5&&(B=5),this.slabNear=-B/1.9,this.slabFar=B/2,I=O[1][0]-O[0][0],F=O[1][1]-O[0][1],k=O[1][2]-O[0][2],B=Math.hypot(I,F,k),B<5&&(B=5);for(var U=25,W=0;W<S.length;W++)if(S[W]){var R=P.distanceToSquared(S[W]);R>U&&(U=R)}B=Math.sqrt(U)*2;var z=P.clone().multiplyScalar(-1);return x>0?this.animateMotion(x,y,z,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=z,this.show()),this}zoomTo(g={},x=0,y=!1){let w=this.getAtomsFromSel(g),M=(0,D.getExtent)(w),S=M;if((0,D.isEmptyObject)(g)){let q=w&&w.length;if(this.shapes.forEach(Q=>{if(Q&&Q.boundingSphere){if(Q.boundingSphere.box){let oe=Q.boundingSphere.box;w.push(new v.Vector3(oe.min.x,oe.min.y,oe.min.z)),w.push(new v.Vector3(oe.max.x,oe.max.y,oe.max.z))}else if(Q.boundingSphere.center){var ne=Q.boundingSphere.center,te=Q.boundingSphere.radius;te>0?(w.push(new v.Vector3(ne.x+te,ne.y,ne.z)),w.push(new v.Vector3(ne.x-te,ne.y,ne.z)),w.push(new v.Vector3(ne.x,ne.y+te,ne.z)),w.push(new v.Vector3(ne.x,ne.y-te,ne.z)),w.push(new v.Vector3(ne.x,ne.y,ne.z+te)),w.push(new v.Vector3(ne.x,ne.y,ne.z-te))):w.push(ne)}}}),S=(0,D.getExtent)(w),!q)for(let Q=0;Q<3;Q++)M[2][Q]=(S[0][Q]+S[1][Q])/2}else{let q=this.getAtomsFromSel({});S=(0,D.getExtent)(q)}var O=new v.Vector3(M[2][0],M[2][1],M[2][2]),P=S[1][0]-S[0][0],I=S[1][1]-S[0][1],F=S[1][2]-S[0][2],k=Math.hypot(P,I,F);k<5&&(k=5),this.slabNear=-k/1.9,this.slabFar=k/2,Object.keys(g).length===0&&(this.slabNear=Math.min(-k*2,-50),this.slabFar=Math.max(k*2,50));var B=this.config.minimumZoomToDistance||5;P=M[1][0]-M[0][0],I=M[1][1]-M[0][1],F=M[1][2]-M[0][2],k=Math.hypot(P,I,F),k<B&&(k=B);for(var U=B*B,W=0;W<w.length;W++)if(w[W]){var R=O.distanceToSquared(w[W]);R>U&&(U=R)}k=Math.sqrt(U)*2;var z=O.clone().multiplyScalar(-1),G=-(k*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return G=this.adjustZoomToLimits(G),x>0?this.animateMotion(x,y,z,G,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=z,this.rotationGroup.position.z=G,this.show()),this}setSlab(g,x){this.slabNear=g,this.slabFar=x}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(g,x={},y,w=!1){if(y){var M=(0,D.getExtent)(this.getAtomsFromSel(y));x.position={x:M[2][0],y:M[2][1],z:M[2][2]}}var S=new a.Label(g,x);return S.setContext(),this.modelGroup.add(S.sprite),this.labels.push(S),w||this.show(),S}addResLabels(g,x,y=!1){let w=this.labels.length;return this.applyToModels("addResLabels",g,x,y),this.show(),this.labels.slice(w)}addPropertyLabels(g,x,y){return this.applyToModels("addPropertyLabels",g,x,y),this.show(),this}removeLabel(g){for(var x=0;x<this.labels.length;x++)if(this.labels[x]==g){this.labels.splice(x,1),g.dispose(),this.modelGroup.remove(g.sprite);break}return this.show(),this}removeAllLabels(){for(var g=0;g<this.labels.length;g++)this.labels[g]&&this.labels[g].sprite&&this.modelGroup.remove(this.labels[g].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var g=0;g<this.labels.length;g++)this.labels[g]&&this.labels[g].hide();return this.show(),this}showAllLabels(){for(var g=0;g<this.labels.length;g++)this.labels[g]&&this.labels[g].show();return this.show(),this}setLabelStyle(g,x){return this.modelGroup.remove(g.sprite),g.dispose(),g.stylespec=x,g.setContext(),this.modelGroup.add(g.sprite),this.show(),g}setLabelText(g,x){return this.modelGroup.remove(g.sprite),g.dispose(),g.text=x,g.setContext(),this.modelGroup.add(g.sprite),this.show(),g}addShape(g){g=g||{};var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,this.shapes.push(x),x}removeShape(g){if(!g)return this;for(g.removegl(this.modelGroup),delete this.shapes[g.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var g=0;g<this.shapes.length;g++){var x=this.shapes[g];x&&x.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(g){if(g.hasOwnProperty("x")&&g.hasOwnProperty("y")&&g.hasOwnProperty("z"))return g;var x=this.getAtomsFromSel(g);if(x.length==0)return{x:0,y:0,z:0};var y=(0,D.getExtent)(x);return{x:y[0][0]+(y[1][0]-y[0][0])/2,y:y[0][1]+(y[1][1]-y[0][1])/2,z:y[0][2]+(y[1][2]-y[0][2])/2}}addSphere(g){g=g||{},g.center=this.getSelectionCenter(g.center);var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,x.addSphere(g),this.shapes.push(x),x.finalize(),x}addBox(g={}){g.corner!=null&&(g.corner=this.getSelectionCenter(g.corner)),g.center!=null&&(g.center=this.getSelectionCenter(g.center));var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,x.addBox(g),this.shapes.push(x),x.finalize(),x}addArrow(g={}){g.start=this.getSelectionCenter(g.start),g.end=this.getSelectionCenter(g.end);var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,x.addArrow(g),this.shapes.push(x),x.finalize(),x}addCylinder(g={}){g.start=this.getSelectionCenter(g.start),g.end=this.getSelectionCenter(g.end);var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,g.dashed?x.addDashedCylinder(g):x.addCylinder(g),this.shapes.push(x),x.finalize(),x}addCurve(g={}){var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,x.addCurve(g),this.shapes.push(x),x.finalize(),x}addLine(g={}){g.start=this.getSelectionCenter(g.start),g.end=this.getSelectionCenter(g.end),g.wireframe=!0;var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,g.dashed?x=this.addLineDashed(g,x):x.addLine(g),this.shapes.push(x),x.finalize(),x}addUnitCell(g,x){g=this.getModel(g),x=x||{alabel:"a",blabel:"b",clabel:"c"},x.box=x.box||{},x.astyle=x.astyle||{color:"red",radius:.1,midpos:-1},x.bstyle=x.bstyle||{color:"green",radius:.1,midpos:-1},x.cstyle=x.cstyle||{color:"blue",radius:.1,midpos:-1},x.alabelstyle=x.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},x.blabelstyle=x.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},x.clabelstyle=x.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},g.unitCellObjects&&this.removeUnitCell(g),g.unitCellObjects={shapes:[],labels:[]};var y=g.getCrystData(),w=null;if(y){if(y.matrix)w=y.matrix;else{var M=y.a,S=y.b,O=y.c,P=y.alpha,I=y.beta,F=y.gamma;P=P*Math.PI/180,I=I*Math.PI/180,F=F*Math.PI/180;var k,B,U;k=Math.cos(I),B=(Math.cos(P)-Math.cos(I)*Math.cos(F))/Math.sin(F),U=Math.sqrt(Math.max(0,1-k*k-B*B)),w=new v.Matrix3(M,S*Math.cos(F),O*k,0,S*Math.sin(F),O*B,0,0,O*U)}var W=[new v.Vector3(0,0,0),new v.Vector3(1,0,0),new v.Vector3(0,1,0),new v.Vector3(0,0,1),new v.Vector3(1,1,0),new v.Vector3(0,1,1),new v.Vector3(1,0,1),new v.Vector3(1,1,1)];if(y.matrix4)for(let z=0;z<W.length;z++)y.size&&W[z].multiplyVectors(W[z],y.size),W[z]=W[z].applyMatrix4(y.matrix4);else for(let z=0;z<W.length;z++)W[z]=W[z].applyMatrix3(w);if(x.box&&!x.box.hidden){x.box.wireframe=!0;var R=new s.GLShape(x.box);R.shapePosition=this.shapes.length,R.addLine({start:W[0],end:W[1]}),R.addLine({start:W[0],end:W[2]}),R.addLine({start:W[1],end:W[4]}),R.addLine({start:W[2],end:W[4]}),R.addLine({start:W[0],end:W[3]}),R.addLine({start:W[3],end:W[5]}),R.addLine({start:W[2],end:W[5]}),R.addLine({start:W[1],end:W[6]}),R.addLine({start:W[4],end:W[7]}),R.addLine({start:W[6],end:W[7]}),R.addLine({start:W[3],end:W[6]}),R.addLine({start:W[5],end:W[7]}),this.shapes.push(R),g.unitCellObjects.shapes.push(R),R.finalize()}if(!x.astyle.hidden){x.astyle.start=W[0],x.astyle.end=W[1];let z=this.addArrow(x.astyle);g.unitCellObjects.shapes.push(z)}if(!x.bstyle.hidden){x.bstyle.start=W[0],x.bstyle.end=W[2];let z=this.addArrow(x.bstyle);g.unitCellObjects.shapes.push(z)}if(!x.cstyle.hidden){x.cstyle.start=W[0],x.cstyle.end=W[3];let z=this.addArrow(x.cstyle);g.unitCellObjects.shapes.push(z)}if(x.alabel){x.alabelstyle.position=W[1];let z=this.addLabel(x.alabel,x.alabelstyle);g.unitCellObjects.labels.push(z)}if(x.blabel){x.blabelstyle.position=W[2];let z=this.addLabel(x.blabel,x.blabelstyle);g.unitCellObjects.labels.push(z)}if(x.clabel){x.clabelstyle.position=W[3];let z=this.addLabel(x.clabel,x.clabelstyle);g.unitCellObjects.labels.push(z)}}}removeUnitCell(g){if(g=this.getModel(g),g.unitCellObjects){let x=this;g.unitCellObjects.shapes.forEach(function(y){x.removeShape(y)}),g.unitCellObjects.labels.forEach(function(y){x.removeLabel(y)})}delete g.unitCellObjects}replicateUnitCell(g=3,x=g,y=x,w,M,S){w=this.getModel(w);let O=w.getCrystData();if(O){const P=w.selectedAtoms({}),I=O.matrix;let F=function(B){return B%2==0?-B/2:Math.ceil(B/2)};g<=1&&x<=1&&y<=1&&(S=!0,g=x=y=3);let k=function(B,U,W){return!1};if(S){const B=new v.Matrix3().getInverse3(I);k=function(U,W,R){let z=new v.Vector3(U,W,R).applyMatrix3(B);return!(z.x>-1e-4&&z.x<1.0001&&z.y>-1e-4&&z.y<1.0001&&z.z>-1e-4&&z.z<1.0001)}}for(let B=0;B<g;B++)for(let U=0;U<x;U++)for(let W=0;W<y;W++){if(B==0&&U==0&&W==0)continue;let R=new v.Vector3(F(B),F(U),F(W));R.applyMatrix3(I);let z=[];for(let G=0;G<P.length;G++){let q=P[G].x+R.x,Q=P[G].y+R.y,ne=P[G].z+R.z;if(k(q,Q,ne))continue;let te={};for(let oe in P[G])te[oe]=P[G][oe];te.x=q,te.y=Q,te.z=ne,z.push(te)}w.addAtoms(z)}M&&w.assignBonds()}}addLineDashed(g,x){g.dashLength=g.dashLength||.5,g.gapLength=g.gapLength||.5;var y;g.start?y=new v.Vector3(g.start.x||0,g.start.y||0,g.start.z||0):y=new v.Vector3(0,0,0);var w;g.end?w=new v.Vector3(g.end.x,g.end.y||0,g.end.z||0):w=new v.Vector3(0,0,0);var M=new v.Vector3,S=new v.Vector3,O=new v.Vector3,P,I,F,k=y.clone(),B=0;for(M.subVectors(w,y),P=M.length(),M.normalize(),S=M.clone(),O=M.clone(),S.multiplyScalar(g.dashLength),O.multiplyScalar(g.gapLength),I=S.length(),F=O.length();B<P;){if(B+I>P){g.start=y,g.end=w,x.addLine(g);break}k.addVectors(y,S),g.start=y,g.end=k,x.addLine(g),y=k.clone(),B+=I,k.addVectors(y,O),y=k.clone(),B+=F}return x.finalize(),x}addCustom(g){g=g||{};var x=new s.GLShape(g);return x.shapePosition=this.shapes.length,x.addCustom(g),this.shapes.push(x),x.finalize(),x}addVolumetricData(g,x,y={}){var w=new d.VolumeData(g,x);return y.hasOwnProperty("transferfn")?this.addVolumetricRender(w,y):this.addIsosurface(w,y)}addIsosurface(g,x={},y){var w=new s.GLShape(x);return w.shapePosition=this.shapes.length,w.addIsosurface(g,x,y,this),this.shapes.push(w),w}addVolumetricRender(g,x){x=x||{};var y=new u.GLVolumetricRender(g,x,this);return y.shapePosition=this.shapes.length,this.shapes.push(y),y}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(g){if(g){this.scene.fog=new m.Fog(this.bgColor,100,200),this.config.disableFog=!1;const x=g;x.fogStart==null?this.fogStart=.4:this.fogStart=x.fogStart,x.fogEnd==null?this.fogEnd=1:this.fogEnd=x.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(g){this.viewer_frame=g;let x=this;return new Promise(function(y){var w=x.models.map(function(M){return M.setFrame(g)});Promise.all(w).then(function(){y()})})}getFrame(){return this.viewer_frame}getNumFrames(){var g=0;for(let x=0;x<this.models.length;x++)this.models[x].getNumFrames()>g&&(g=this.models[x].getNumFrames());for(let x=0;x<this.shapes.length;x++)this.shapes[x].frame&&this.shapes[x].frame>=g&&(g=this.shapes[x].frame+1);for(let x=0;x<this.labels.length;x++)this.labels[x].frame&&this.labels[x].frame>=g&&(g=this.labels[x].frame+1);return g}getNextModelId(){return this.models.length}animate(g){this.incAnim();var x=100,y="forward",w=1/0;g=g||{},g.interval&&(x=g.interval),g.loop&&(y=g.loop),g.reps&&(w=g.reps);var M=this.getNumFrames(),S=this,O=0;g.startFrame&&(O=g.startFrame%M);var P=1;g.step&&(P=g.step,w/=P);var I=0,F=M*w,k=new Date,B,U,W=function(R){k=new Date,R=="forward"?S.setFrame(O).then(function(){O=(O+P)%M,B()}):R=="backward"?S.setFrame(M-1-O).then(function(){O=(O+P)%M,B()}):S.setFrame(O).then(function(){O+=P,P*=O%(M-1)==0?-1:1,B()})};return B=function(){if(S.render(),!S.getCanvas().isConnected)S.stopAnimate();else if(++I>=F||!S.isAnimated())U.cancel(),S.animationTimers.delete(U),S.decAnim();else{var R=x-(new Date().getTime()-k.getTime());R=R>0?R:0,S.animationTimers.delete(U),U=new D.PausableTimer(W,R,y),S.animationTimers.add(U)}},U=new D.PausableTimer(W,0,y),this.animationTimers.add(U),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(g){g.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(g){g.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(g){g.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(g){return g&&!g.defaultcolors?(g.defaultcolors=this.defaultcolors,g.cartoonQuality=g.cartoonQuality||this.config.cartoonQuality):typeof g>"u"&&(g={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),g}addModel(g,x="",y){y=this.getModelOpt(y);var w=new r.GLModel(this.models.length,y,this);return w.addMolData(g,x,y),this.models.push(w),w}addModels(g,x,y){y=this.getModelOpt(y),y.multimodel=!0,y.frames=!0;for(var w=r.GLModel.parseMolData(g,x,y),M=0;M<w.length;M++){var S=new r.GLModel(this.models.length,y,this);S.setAtomDefaults(w[M]),S.addFrame(w[M]),S.setFrame(0),w.modelData&&S.setModelData(w.modelData[M]),S.setDontDuplicateAtoms(!y.duplicateAssemblyAtoms),this.models.push(S)}return this.models}addModelsAsFrames(g,x,y){y=this.getModelOpt(y),y.multimodel=!0,y.frames=!0;var w=new r.GLModel(this.models.length,y,this);return w.addMolData(g,x,y),this.models.push(w),w}addAsOneMolecule(g,x,y){y=this.getModelOpt(y),y.multimodel=!0,y.onemol=!0;var w=new r.GLModel(this.models.length,y,this);return w.addMolData(g,x,y),this.models.push(w),w}removeModel(g){if(g=this.getModel(g),!!g){for(g.removegl(this.modelGroup),delete this.models[g.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var g=0;g<this.models.length;g++){var x=this.models[g];x&&x.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(g,x){var y={};return x===void 0?y.m=this.models.map(function(w){return w.toCDObject(g)}):y.m=[this.models[x].toCDObject()],JSON.stringify(y)}exportVRML(){var g=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new m.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var x=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=g,x}createModelFrom(g,x=!1){for(var y=new r.GLModel(this.models.length,this.defaultcolors,this),w=0;w<this.models.length;w++)if(this.models[w]){var M=this.models[w].selectedAtoms(g);y.addAtoms(M),x&&this.models[w].removeAtoms(M)}return this.models.push(y),y}applyToModels(g,x,y,w,M,S,O){for(var P=this.getModelList(x),I=0;I<P.length;I++)P[I][g](x,y,w,M,S,O)}setStyle(g,x){return typeof x>"u"&&(x=g,g={}),this.applyToModels("setStyle",g,x,!1),this}addStyle(g,x){return typeof x>"u"&&(x=g,g={}),this.applyToModels("setStyle",g,x,!0),this}setClickable(g,x,y){return this.applyToModels("setClickable",g,x,y),this}setHoverable(g,x,y,w){return this.applyToModels("setHoverable",g,x,y,w),this}enableContextMenu(g,x){return this.applyToModels("enableContextMenu",g,x),this}vibrate(g,x,y,w){return this.applyToModels("vibrate",g,x,y,w),this}setColorByProperty(g,x,y,w){return this.applyToModels("setColorByProperty",g,x,y,w),this}setColorByElement(g,x){return this.applyToModels("setColorByElement",g,x),this}static getAtomsWithin(g,x){var y=[];for(let M=0;M<g.length;M++){var w=g[M];typeof w>"u"||w.x<x[0][0]||w.x>x[1][0]||w.y<x[0][1]||w.y>x[1][1]||w.z<x[0][2]||w.z>x[1][2]||y.push(w)}return y}static volume(g){var x=g[1][0]-g[0][0],y=g[1][1]-g[0][1],w=g[1][2]-g[0][2];return x*y*w}carveUpExtent(g,x,y){let w=[],M={};for(let k=0,B=x.length;k<B;k++)M[x[k].index]=k;let S=function(k){let B=[];for(let U=0,W=k.length;U<W;U++)k[U].index in M&&B.push(M[k[U].index]);return B},O=function(k){let B=[];return B[0]=[k[0][0],k[0][1],k[0][2]],B[1]=[k[1][0],k[1][1],k[1][2]],B},P=function(k){if(c.volume(k)<c.maxVolume)return[k];var B=k[1][0]-k[0][0],U=k[1][1]-k[0][1],W=k[1][2]-k[0][2],R;B>U&&B>W?R=0:U>B&&U>W?R=1:R=2;var z=O(k),G=O(k),q=(k[1][R]-k[0][R])/2+k[0][R];z[1][R]=q,G[0][R]=q;var Q=P(z),ne=P(G);return Q.concat(ne)},I=P(g),F=6;for(let k=0,B=I.length;k<B;k++){let U=O(I[k]);U[0][0]-=F,U[0][1]-=F,U[0][2]-=F,U[1][0]+=F,U[1][1]+=F,U[1][2]+=F;let W=c.getAtomsWithin(x,U),R=c.getAtomsWithin(y,I[k]);w.push({extent:I[k],atoms:S(W),toshow:S(R)})}return w}static generateSurfaceMesh(g,x,y){var w=new m.Geometry(!0),M=w.updateGeoGroup(0),S=[];for(let Z=0,xe=g.length;Z<xe;Z++){var O=g[Z];O&&(typeof O.surfaceColor<"u"?S[Z]=O.surfaceColor:O.color&&(S[Z]=_.CC.color(O.color)))}var P=M.vertexArray,I=x.vertices;for(let Z=0,xe=I.length;Z<xe;Z++){let we=M.vertices*3;P[we]=I[Z].x,P[we+1]=I[Z].y,P[we+2]=I[Z].z,M.vertices++}var F=M.colorArray;let k=M.atomArray;if(y.voldata&&y.volscheme){var B=y.volscheme,U=y.voldata,W=B.range()||[-1,1];for(let Z=0,xe=I.length;Z<xe;Z++){let we=I[Z].atomid,ie=U.getVal(I[Z].x,I[Z].y,I[Z].z),Ne=_.CC.color(B.valueToHex(ie,W)),Ge=Z*3;F[Ge]=Ne.r,F[Ge+1]=Ne.g,F[Ge+2]=Ne.b,k[Z]=g[we]}}else if(S.length>0)for(let Z=0,xe=I.length;Z<xe;Z++){let we=I[Z].atomid,ie=Z*3;F[ie]=S[we].r,F[ie+1]=S[we].g,F[ie+2]=S[we].b,k[Z]=g[we]}var R=x.faces;M.faceidx=R.length,w.initTypedArrays();var z=M.vertexArray,G=M.normalArray,q,Q,ne,te;for(let Z=0,xe=R.length;Z<xe;Z+=3){var oe=R[Z],re=R[Z+1],le=R[Z+2],Ce=oe*3,De=re*3,Oe=le*3;q=new v.Vector3(z[Ce],z[Ce+1],z[Ce+2]),Q=new v.Vector3(z[De],z[De+1],z[De+2]),ne=new v.Vector3(z[Oe],z[Oe+1],z[Oe+2]),ne.subVectors(ne,Q),q.subVectors(q,Q),ne.cross(q),te=ne,te.normalize(),G[Ce]+=te.x,G[De]+=te.x,G[Oe]+=te.x,G[Ce+1]+=te.y,G[De+1]+=te.y,G[Oe+1]+=te.y,G[Ce+2]+=te.z,G[De+2]+=te.z,G[Oe+2]+=te.z}M.faceArray=new Uint16Array(R);var _e=new m.Mesh(w,y);return _e}static generateMeshSyncHelper(g,x,y,w,M,S){var O=new h.ProteinSurface;return O.initparm(x,g!==1,S),O.fillvoxels(M,y),O.buildboundary(),(g==h.SurfaceType.SES||g==h.SurfaceType.MS)&&(O.fastdistancemap(),O.boundingatom(!1),O.fillvoxelswaals(M,y)),O.marchingcube(g),O.getFacesAndVertices(w)}static getMatWithStyle(g){let x=null;g.onesided?x=new m.MeshLambertMaterial:x=new m.MeshDoubleLambertMaterial,x.vertexColors=m.Coloring.VertexColors;for(var y in g)y==="color"||y==="map"||g.hasOwnProperty(y)&&(x[y]=g[y]);return g.opacity!==void 0&&(g.opacity===1?x.transparent=!1:x.transparent=!0),g.wireframe!==void 0&&(x.wireframe=g.wireframe),x}addMesh(g){let x={geo:g.geometry,mat:g.material,done:!0,finished:!1};var y=this.nextSurfID();return this.surfaces[y]=new l([x]),y}static shallowCopy(g){var x=[];let y=g.length;for(let w=0;w<y;w++)x[w]=(0,D.extend)({},g[w]);return x}addSurface(g,x={},y={},w,M,S){let O=this.nextSurfID(),P=null,I=this,F=h.SurfaceType.VDW;typeof g=="string"?c.surfaceTypeMap[g.toUpperCase()]!==void 0?F=c.surfaceTypeMap[g]:console.log("Surface type : "+g+" is not recognized"):typeof g=="number"&&(F=g);var k=null,B=null,U=c.shallowCopy(this.getAtomsFromSel(y));w?k=c.shallowCopy(this.getAtomsFromSel(w)):k=U,(0,D.adjustVolumeStyle)(x);var W=!1,R;for(R=0;R<this.models.length;R++)if(this.models[R]){var z=this.models[R].getSymmetries();if(z.length>1||z.length==1&&!z[0].isIdentity()){W=!0;break}}var G=function(le,Ce,De){M?B=c.shallowCopy(I.getAtomsFromSel(M)):B=De;var Oe,_e=(0,D.getExtent)(De,!0);if(x.map&&x.map.prop){var Z=x.map.prop;let We=(0,o.getGradient)(x.map.scheme||x.map.gradient||new o.Gradient.RWB),He=We.range();He||(He=(0,D.getPropertyRange)(De,Z)),x.colorscheme={prop:Z,gradient:We}}for(let We=0,He=Ce.length;We<He;We++)Oe=Ce[We],Oe.surfaceColor=(0,D.getColorFromStyle)(Oe,x);var xe=c.volume(_e),we=I.carveUpExtent(_e,Ce,De);if(B&&B.length&&B.length>0){var ie=(0,D.getExtent)(B,!0),Ne=function(We,He){var H=function(pe,ue){var ye=pe.extent,Se=ye[1][0]-ye[0][0],V=ye[1][1]-ye[0][1],he=ye[1][2]-ye[0][2],ve=Se-ue[2][0];ve*=ve;var Pe=V-ue[2][1];Pe*=Pe;var ae=he-ue[2][2];return ae*=ae,ve+Pe+ae},K=H(We,ie),X=H(He,ie);return K-X};we.sort(Ne)}var Ge=[];for(let We=0,He=Ce.length;We<He;We++)Oe=Ce[We],Ge[We]={x:Oe.x,y:Oe.y,z:Oe.z,serial:We,elem:Oe.elem};var Ue=!!h.syncSurface;if((typeof $3Dmol>"u"||typeof $3Dmol.SurfaceWorker>"u")&&(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Ue=!0),Ue){var Ie=function(He){return new Promise(function(H){for(var K=c.generateMeshSyncHelper(F,we[He].extent,we[He].atoms,we[He].toshow,Ge,xe),X=(0,s.splitMesh)({vertexArr:K.vertices,faceArr:K.faces}),pe=0,ue=X.length;pe<ue;pe++){K={vertices:X[pe].vertexArr,faces:X[pe].faceArr};var ye=c.generateSurfaceMesh(Ce,K,P);(0,D.mergeGeos)(le.geo,ye)}I.render(),H()})},ze=[];for(let We=0;We<we.length;We++)ze.push(Ie(We));return Promise.all(ze).then(function(){return le.done=!0,I.render(),Promise.resolve(O)})}else{var Re=[];F<0&&(F=0);for(let We=0,He=c.numWorkers;We<He;We++){var Le=new Worker($3Dmol.SurfaceWorker);Re.push(Le),Le.postMessage({type:-1,atoms:Ge,volume:xe})}return new Promise(function(We,He){var H=0,K=function(){!Re||!Re.length||Re.forEach(function(ye){ye&&ye.terminate&&ye.terminate()})},X=function(ye){for(var Se=(0,s.splitMesh)({vertexArr:ye.data.vertices,faceArr:ye.data.faces}),V=0,he=Se.length;V<he;V++){var ve={vertices:Se[V].vertexArr,faces:Se[V].faceArr},Pe=c.generateSurfaceMesh(Ce,ve,P);(0,D.mergeGeos)(le.geo,Pe)}I.render(),H++,H==we.length&&(le.done=!0,K(),We(O))},pe=function(ye){K(),console.log(ye.message+" ("+ye.filename+":"+ye.lineno+")"),He(ye)};for(let ye=0;ye<we.length;ye++){var ue=Re[ye%Re.length];ue.onmessage=X,ue.onerror=pe,ue.postMessage({type:F,expandedExtent:we[ye].extent,extendedAtoms:we[ye].atoms,atomsToShow:we[ye].toshow})}})}};x=x||{},P=c.getMatWithStyle(x);let q=new l([]);q.style=x,q.atomsel=y,q.allsel=w,q.focus=M;var Q=null;if(W){var ne={},te={};for(R=0;R<this.models.length;R++)ne[R]=[],te[R]=[];for(R=0;R<k.length;R++)ne[k[R].model].push(k[R]);for(R=0;R<U.length;R++)te[U[R].model].push(U[R]);var oe=[];for(R=0;R<this.models.length;R++)te[R].length>0&&(q.push({geo:new m.Geometry(!0),mat:P,done:!1,finished:!1,symmetries:this.models[R].getSymmetries()}),oe.push(G(q[q.length-1],ne[R],te[R])));Q=Promise.all(oe)}else q.push({geo:new m.Geometry(!0),mat:P,done:!1,finished:!1,symmetries:[new v.Matrix4]}),Q=G(q[q.length-1],k,U);return this.surfaces[O]=q,Q.surfid=O,S&&typeof S=="function"?(Q.then(function(re){S(re)}),O):Q}setSurfaceMaterialStyle(g,x){if((0,D.adjustVolumeStyle)(x),this.surfaces[g]){var y=this.surfaces[g];for(let M=0;M<y.length;M++){var w=y[M].mat=c.getMatWithStyle(x);if(y[M].mat.side=m.FrontSide,x.wireframe&&y[M].geo.setUpWireframe(),x.color){y[M].mat.color=_.CC.color(x.color),y[M].geo.colorsNeedUpdate=!0;const S=_.CC.color(x.color);y[M].geo.setColor(S)}else if(w.voldata&&w.volscheme){const S=w.volscheme,O=w.voldata,P=_.CC,I=S.range()||[-1,1];y[M].geo.setColors(function(F,k,B){let U=O.getVal(F,k,B);return P.color(S.valueToHex(U,I))})}else{y[M].geo.colorsNeedUpdate=!0;for(let S of y[M].geo.geometryGroups)for(let O=0;O<S.vertices;O++){let P=(0,D.getColorFromStyle)(S.atomArray[O],x),I=3*O;S.colorArray[I]=P.r,S.colorArray[I+1]=P.g,S.colorArray[I+2]=P.b}}y[M].finished=!1}}return this}getSurface(g){return this.surfaces[g]}removeSurface(g){for(var x=this.surfaces[g],y=0;y<x.length;y++)x[y]&&x[y].lastGL&&(x[y].geo!==void 0&&x[y].geo.dispose(),x[y].mat!==void 0&&x[y].mat.dispose(),this.modelGroup.remove(x[y].lastGL));return delete this.surfaces[g],this.show(),this}removeAllSurfaces(){for(var g in this.surfaces)if(this.surfaces.hasOwnProperty(g)){for(var x=this.surfaces[g],y=0;y<x.length;y++)x[y]&&x[y].lastGL&&(x[y].geo!==void 0&&x[y].geo.dispose(),x[y].mat!==void 0&&x[y].mat.dispose(),this.modelGroup.remove(x[y].lastGL));delete this.surfaces[g]}return this.show(),this}jmolMoveTo(){var g=this.modelGroup.position,x="center { "+-g.x+" "+-g.y+" "+-g.z+" }; ",y=this.rotationGroup.quaternion;return x+="moveto .5 quaternion { "+y.x+" "+y.y+" "+y.z+" "+y.w+" };",x}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(g,x){x=x||{};var y=this.getAtomsFromSel(x);if(typeof g=="function")for(let S=0,O=y.length;S<O;S++){let P=y[S];g(P)}else for(let S=0,O=y.length;S<O;S++){var w=y[S];for(let P=0,I=g.length;P<I;P++){let F=g[P];if(F.props)for(var M in F.props)F.props.hasOwnProperty(M)&&this.atomIsSelected(w,F)&&(w.properties||(w.properties={}),w.properties[M]=F.props[M])}}return this}linkViewer(g){return this.linkedViewers.push(g),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(g){this.rotationGroup.position.z=this.CAMERA_Z-g}setAutoEyeSeparation(g,x){var y=this.getPerceivedDistance();return x||(x=5),g||this.camera.position.x>0?this.camera.position.x=y*Math.tan(Math.PI/180*x):this.camera.position.x=-y*Math.tan(Math.PI/180*x),this.camera.lookAt(new v.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(g){this.config.cartoonQuality=g}}c.numWorkers=4,c.maxVolume=64e3,c.surfaceTypeMap={VDW:h.SurfaceType.VDW,MS:h.SurfaceType.MS,SAS:h.SurfaceType.SAS,SES:h.SurfaceType.SES};function p(C,g){if(C=(0,D.getElement)(C),!!C){g=g||{};try{var x=new c(C,g);return x}catch(y){throw"error creating viewer: "+y}}}function b(C,g={},x={}){if(C=(0,D.getElement)(C),!!C){var y=[],w=document.createElement("canvas");x.rows=g.rows,x.cols=g.cols,x.control_all=g.control_all!=null?g.control_all:!1,C.appendChild(w);try{for(var M=0;M<g.rows;M++){for(var S=[],O=0;O<g.cols;O++){x.row=M,x.col=O,x.canvas=w,x.viewers=y,x.control_all=g.control_all;var P=p(C,(0,D.extend)({},x));S.push(P)}y.unshift(S)}}catch(I){throw"error creating viewer grid: "+I}return y}}function E(C){var g=this;if(C=(0,D.getElement)(C),!!C){var x=b(C,{rows:1,cols:2,control_all:!0});this.glviewer1=x[0][0],this.glviewer2=x[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var y=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(M){return typeof g.glviewer1[M]=="function"}),w=0;w<y.length;w++)this[y[w]]=function(M){return function(){var S=this.glviewer1[M].apply(this.glviewer1,arguments),O=this.glviewer2[M].apply(this.glviewer2,arguments);return[S,O]}}(y[w]);this.setCoordinates=function(M,S,O){for(var P=0;P<M.length;P++)M[P].setCoordinates(S,O)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(M){this.glviewer1.render(),this.glviewer2.render(),M&&M(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}},"./src/Gradient.ts":(n,e,t)=>{t.r(e),t.d(e,{CustomLinear:()=>u,Gradient:()=>v,GradientType:()=>r,ROYGB:()=>h,RWB:()=>a,Sinebow:()=>d,builtinGradients:()=>m,getGradient:()=>o,normalizeValue:()=>s});var i=t("./src/colors.ts");class r{}function s(_,D,f){return D>=_?(f<_&&(f=_),f>D&&(f=D),{lo:_,hi:D,val:f}):(f>_&&(f=_),f<D&&(f=D),f=_-f+D,{lo:D,hi:_,val:f})}function o(_){if(_ instanceof r)return _;if(_.gradient!==void 0&&m[_.gradient]){let D=_.min===void 0?-1:_.min,f=_.max===void 0?1:_.max;return _.mid===void 0?_.colors===void 0?new m[_.gradient](D,f):new m[_.gradient](D,f,_.colors):new m[_.gradient](D,f,_.mid)}else if(typeof _.gradient=="string"&&_.gradient.startsWith("linear_")){let D=_.gradient.split("_");D.shift();let f=_.min===void 0?-1:_.min,l=_.max===void 0?1:_.max;return new u(f,l,D)}return _}class a extends r{constructor(D,f,l){super(),this.gradient="RWB",this.mult=1,this.mid=l,this.min=D,this.max=f,typeof f>"u"&&Array.isArray(D)&&D.length>=2?(this.max=D[1],this.min=D[0]):D&&f&&!Array.isArray(D)&&(this.min=D,this.max=f)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(D,f){var l,c;if(D=this.mult*D,f?(l=f[0],c=f[1]):(l=this.min,c=this.max),D===void 0)return 16777215;var p=s(l,c,D);l=p.lo,c=p.hi,D=p.val;var b=(c+l)/2;f&&typeof f[2]<"u"?b=f[2]:typeof this.mid<"u"?b=this.mid:b=(l+c)/2;var E,C;return D<b?(E=Math.floor(255*Math.sqrt((D-l)/(b-l))),C=16711680+256*E+E,C):D>b?(E=Math.floor(255*Math.sqrt(1-(D-b)/(c-b))),C=65536*E+256*E+255,C):16777215}}class h extends r{constructor(D,f){super(),this.gradient="ROYGB",this.mult=1,this.min=D,this.max=f,typeof f>"u"&&Array.isArray(D)&&D.length>=2?(this.max=D[1],this.min=D[0]):D&&f&&!Array.isArray(D)&&(this.min=D,this.max=f)}valueToHex(D,f){var l,c;if(D=this.mult*D,f?(l=f[0],c=f[1]):(l=this.min,c=this.max),typeof D>"u")return 16777215;var p=s(l,c,D);l=p.lo,c=p.hi,D=p.val;var b=(l+c)/2,E=(l+b)/2,C=(b+c)/2,g,x;return D<E?(g=Math.floor(255*Math.sqrt((D-l)/(E-l))),x=16711680+256*g+0,x):D<b?(g=Math.floor(255*Math.sqrt(1-(D-E)/(b-E))),x=65536*g+65280+0,x):D<C?(g=Math.floor(255*Math.sqrt((D-b)/(C-b))),x=65280+1*g,x):(g=Math.floor(255*Math.sqrt(1-(D-C)/(c-C))),x=0+256*g+255,x)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class d extends r{constructor(D,f){super(),this.gradient="Sinebow",this.mult=1,this.min=D,this.max=f,typeof f>"u"&&Array.isArray(D)&&D.length>=2&&(this.max=D[1],this.min=D[0]),f<D&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(D,f){var l,c;if(D=this.mult*D,f?(l=f[0],c=f[1]):(l=this.min,c=this.max),typeof D>"u")return 16777215;var p=v.normalizeValue(l,c,D);l=p.lo,c=p.hi,D=p.val;var b=(D-l)/(c-l),E=5*b/6+.5,C=Math.sin(Math.PI*E);C*=C*255;var g=Math.sin(Math.PI*(E+1/3));g*=g*255;var x=Math.sin(Math.PI*(E+2/3));return x*=x*255,65536*Math.floor(C)+256*Math.floor(x)+1*Math.floor(g)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class u extends r{constructor(D,f,l){super(),this.gradient="linear",this.colors=new Array;var c;if(Array.isArray(D)&&D.length>=2?(this.max=D[1],this.min=D[0],c=f):(this.min=D,this.max=f,c=l),c)for(let p of c)this.colors.push(i.CC.color(p));else this.colors.push(i.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(D,f){var l,c;if(f?(l=f[0],c=f[1]):(l=this.min,c=this.max),D===void 0)return 16777215;var p=s(l,c,D);l=p.lo,c=p.hi,D=p.val;let b=this.colors.length,E=(c-l)/b,C=Math.min(Math.floor((D-l)/E),b-1),g=Math.min(C+1,b-1),x=(D-l-C*E)/E,y=this.colors[C],w=this.colors[g];return new i.Color(y.r+x*(w.r-y.r),y.g+x*(w.g-y.g),y.b+x*(w.b-y.b)).getHex()}}const m={rwb:a,RWB:a,roygb:h,ROYGB:h,sinebow:d,linear:u};class v extends r{valueToHex(D,f){return 0}range(){return null}}v.RWB=a,v.ROYGB=h,v.Sinebow=d,v.CustomLinear=u,v.builtinGradients=m,v.normalizeValue=s,v.getGradient=o},"./src/Label.ts":(n,e,t)=>{t.r(e),t.d(e,{Label:()=>d,LabelCount:()=>o});var i=t("./src/WebGL/index.ts"),r=t("./src/Gradient.ts"),s=t("./src/colors.ts");let o=0;function a(u,m,v,_,D,f,l){u.beginPath(),u.moveTo(m+f,v),u.lineTo(m+_-f,v),u.quadraticCurveTo(m+_,v,m+_,v+f),u.lineTo(m+_,v+D-f),u.quadraticCurveTo(m+_,v+D,m+_-f,v+D),u.lineTo(m+f,v+D),u.quadraticCurveTo(m,v+D,m,v+D-f),u.lineTo(m,v+f),u.quadraticCurveTo(m,v,m+f,v),u.closePath(),u.fill(),l&&u.stroke()}function h(u,m,v){var _=v;return typeof u<"u"&&(u instanceof s.Color?_=u.scaled():(_=s.CC.color(u),typeof _.scaled<"u"&&(_=_.scaled()))),typeof m<"u"&&(_.a=parseFloat(m)),_}class d{constructor(m,v){this.id=o++,this.stylespec=v||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new i.Sprite,this.text=m,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var m=this.stylespec,v=typeof m.useScreen>"u"?!1:m.useScreen,_=m.showBackground;(_==="0"||_==="false")&&(_=!1),typeof _>"u"&&(_=!0);var D=m.font?m.font:"sans-serif",f=parseInt(m.fontSize)?parseInt(m.fontSize):18,l=h(m.fontColor,m.fontOpacity,{r:255,g:255,b:255,a:1}),c=m.padding?m.padding:4,p=m.borderThickness?m.borderThickness:0,b=h(m.backgroundColor,m.backgroundOpacity,{r:0,g:0,b:0,a:1}),E=h(m.borderColor,m.borderOpacity,b),C=m.position?m.position:{x:-10,y:1,z:1},g=m.inFront!==void 0?m.inFront:!0;(g==="false"||g==="0")&&(g=!1);var x=m.alignment||i.SpriteAlignment.topLeft;typeof x=="string"&&x in i.SpriteAlignment&&(x=i.SpriteAlignment[x]);var y="";m.bold&&(y="bold "),this.context.font=y+f+"px  "+D;var w=this.context.measureText(this.text),M=w.width;_||(p=0);var S=M+2.5*p+2*c,O=f*1.25+2*p+2*c;if(m.backgroundImage){var P=m.backgroundImage,I=m.backgroundWidth?m.backgroundWidth:P.width,F=m.backgroundHeight?m.backgroundHeight:P.height;I>S&&(S=I),F>O&&(O=F)}if(this.canvas.width=S,this.canvas.height=O,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),y="",m.bold&&(y="bold "),this.context.font=y+f+"px  "+D,this.context.fillStyle="rgba("+b.r+","+b.g+","+b.b+","+b.a+")",this.context.strokeStyle="rgba("+E.r+","+E.g+","+E.b+","+E.a+")",m.backgroundGradient){let B=this.context.createLinearGradient(0,O/2,S,O/2),U=r.Gradient.getGradient(m.backgroundGradient),W=U.range(),R=-1,z=1;W&&(R=W[0],z=W[1]);let G=z-R;for(let q=0;q<1.01;q+=.1){let Q=h(U.valueToHex(R+G*q)),ne="rgba("+Q.r+","+Q.g+","+Q.b+","+Q.a+")";B.addColorStop(q,ne)}this.context.fillStyle=B}this.context.lineWidth=p,_&&a(this.context,p,p,S-2*p,O-2*p,6,p>0),m.backgroundImage&&this.context.drawImage(P,0,0,S,O),this.context.fillStyle="rgba("+l.r+","+l.g+","+l.b+","+l.a+")",this.context.fillText(this.text,p+c,f+p+c,M);var k=new i.Texture(this.canvas);k.needsUpdate=!0,this.sprite.material=new i.SpriteMaterial({map:k,useScreenCoordinates:v,alignment:x,depthTest:!g,screenOffset:m.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(C.x,C.y,C.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}},"./src/ProteinSurface4.ts":(n,e,t)=>{t.r(e),t.d(e,{MarchingCube:()=>h,MarchingCubeInitializer:()=>a,PointGrid:()=>d,ProteinSurface:()=>u,SurfaceType:()=>r,setSyncSurface:()=>o,syncSurface:()=>s});var i=t("./src/WebGL/math/index.ts"),r;(function(m){m[m.VDW=1]="VDW",m[m.MS=2]="MS",m[m.SAS=3]="SAS",m[m.SES=4]="SES"})(r||(r={}));var s=!1;function o(m){s=m}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(s=!0);class a{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(v,_,D,f){let l=!!f.fulltable,c=f.hasOwnProperty("origin")&&f.origin.hasOwnProperty("x")?f.origin:{x:0,y:0,z:0},p=!!f.voxel,b=f.matrix,E=f.nX||0,C=f.nY||0,g=f.nZ||0,x=f.scale||1,y=null;f.unitCube?y=f.unitCube:y={x,y:x,z:x};let w=new Int32Array(E*C*g),M,S;for(M=0,S=w.length;M<S;++M)w[M]=-1;let O=function(k,B,U,W,R,z){let G={x:0,y:0,z:0},q=!!(W&1<<R),Q=!!(W&1<<z),ne=R;if(!q&&Q&&(ne=z),ne&1&&U++,ne&2&&B++,ne&4&&k++,b){let oe=new i.Vector3(k,B,U);oe=oe.applyMatrix4(b),G={x:oe.x,y:oe.y,z:oe.z}}else G.x=c.x+y.x*k,G.y=c.y+y.y*B,G.z=c.z+y.z*U;let te=(C*k+B)*g+U;return p?(_.push(G),_.length-1):(w[te]<0&&(w[te]=_.length,_.push(G)),w[te])},P=new Int32Array(12),I=l?this.edgeTable2:this.edgeTable,F=l?this.triTable2:this.triTable;for(M=0;M<E-1;++M)for(let k=0;k<C-1;++k)for(let B=0;B<g-1;++B){let U=0;for(let z=0;z<8;++z){let G=(C*(M+((z&4)>>2))+k+((z&2)>>1))*g+B+(z&1),q=!!(v[G]&this.ISDONE);U|=q<<z}if(U===0||U===255)continue;let W=I[U];if(W===0)continue;let R=F[U];W&1&&(P[0]=O(M,k,B,U,0,1)),W&2&&(P[1]=O(M,k,B,U,1,3)),W&4&&(P[2]=O(M,k,B,U,3,2)),W&8&&(P[3]=O(M,k,B,U,2,0)),W&16&&(P[4]=O(M,k,B,U,4,5)),W&32&&(P[5]=O(M,k,B,U,5,7)),W&64&&(P[6]=O(M,k,B,U,7,6)),W&128&&(P[7]=O(M,k,B,U,6,4)),W&256&&(P[8]=O(M,k,B,U,0,4)),W&512&&(P[9]=O(M,k,B,U,1,5)),W&1024&&(P[10]=O(M,k,B,U,3,7)),W&2048&&(P[11]=O(M,k,B,U,2,6));for(let z=0;z<R.length;z+=3){let G=P[R[z]],q=P[R[z+1]],Q=P[R[z+2]];p&&z>=3&&(_.push(_[G]),G=_.length-1,_.push(_[q]),q=_.length-1,_.push(_[Q]),Q=_.length-1),D.push(G),D.push(q),D.push(Q)}}}laplacianSmooth(v,_,D){let f=new Array(_.length),l,c,p,b,E;for(l=0,c=_.length;l<c;l++)f[l]={x:0,y:0,z:0};let C=new Array(20),g;for(l=0;l<20;l++)C[l]=new Array(_.length);for(l=0,c=_.length;l<c;l++)C[0][l]=0;for(l=0,c=D.length/3;l<c;l++){let w=l*3,M=l*3+1,S=l*3+2;for(g=!0,p=0,b=C[0][D[w]];p<b;p++)if(D[M]==C[p+1][D[w]]){g=!1;break}for(g&&(C[0][D[w]]++,C[C[0][D[w]]][D[w]]=D[M]),g=!0,p=0,b=C[0][D[w]];p<b;p++)if(D[S]==C[p+1][D[w]]){g=!1;break}for(g&&(C[0][D[w]]++,C[C[0][D[w]]][D[w]]=D[S]),g=!0,p=0,b=C[0][D[M]];p<b;p++)if(D[w]==C[p+1][D[M]]){g=!1;break}for(g&&(C[0][D[M]]++,C[C[0][D[M]]][D[M]]=D[w]),g=!0,p=0,b=C[0][D[M]];p<b;p++)if(D[S]==C[p+1][D[M]]){g=!1;break}for(g&&(C[0][D[M]]++,C[C[0][D[M]]][D[M]]=D[S]),g=!0,p=0;p<C[0][D[S]];p++)if(D[w]==C[p+1][D[S]]){g=!1;break}for(g&&(C[0][D[S]]++,C[C[0][D[S]]][D[S]]=D[w]),g=!0,p=0,b=C[0][D[S]];p<b;p++)if(D[M]==C[p+1][D[S]]){g=!1;break}g&&(C[0][D[S]]++,C[C[0][D[S]]][D[S]]=D[M])}let x=1,y=.5;for(E=0;E<v;E++){for(l=0,c=_.length;l<c;l++)if(C[0][l]<3)f[l].x=_[l].x,f[l].y=_[l].y,f[l].z=_[l].z;else if(C[0][l]==3||C[0][l]==4){for(f[l].x=0,f[l].y=0,f[l].z=0,p=0,b=C[0][l];p<b;p++)f[l].x+=_[C[p+1][l]].x,f[l].y+=_[C[p+1][l]].y,f[l].z+=_[C[p+1][l]].z;f[l].x+=y*_[l].x,f[l].y+=y*_[l].y,f[l].z+=y*_[l].z,f[l].x/=y+C[0][l],f[l].y/=y+C[0][l],f[l].z/=y+C[0][l]}else{for(f[l].x=0,f[l].y=0,f[l].z=0,p=0,b=C[0][l];p<b;p++)f[l].x+=_[C[p+1][l]].x,f[l].y+=_[C[p+1][l]].y,f[l].z+=_[C[p+1][l]].z;f[l].x+=x*_[l].x,f[l].y+=x*_[l].y,f[l].z+=x*_[l].z,f[l].x/=x+C[0][l],f[l].y/=x+C[0][l],f[l].z/=x+C[0][l]}for(l=0,c=_.length;l<c;l++)_[l].x=f[l].x,_[l].y=f[l].y,_[l].z=f[l].z}}}let h=new a;class d{constructor(v,_,D){this.data=new Int32Array(v*_*D*3),this.width=_,this.height=D}set(v,_,D,f){let l=((v*this.width+_)*this.height+D)*3;this.data[l]=f.ix,this.data[l+1]=f.iy,this.data[l+2]=f.iz}get(v,_,D){let f=((v*this.width+_)*this.height+D)*3;return{ix:this.data[f],iy:this.data[f+1],iz:this.data[f+2]}}}class u{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],u.MarchingCube||(u.MarchingCube=new a)}getVDWIndex(v){return!v.elem||typeof this.vdwRadii[v.elem]>"u"?"X":v.elem}getFacesAndVertices(v){let _={};for(let l=0,c=v.length;l<c;l++)_[v[l]]=!0;let D=this.verts;for(let l=0,c=D.length;l<c;l++)D[l].x=D[l].x/this.scaleFactor-this.ptranx,D[l].y=D[l].y/this.scaleFactor-this.ptrany,D[l].z=D[l].z/this.scaleFactor-this.ptranz;let f=[];for(let l=0,c=this.faces.length;l<c;l+=3){let p=this.faces[l],b=this.faces[l+1],E=this.faces[l+2],C=D[p].atomid,g=D[b].atomid,x=D[E].atomid,y=C;g<y&&(y=g),x<y&&(y=x),_[y]&&p!==b&&b!==E&&p!==E&&(f.push(p),f.push(b),f.push(E))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:D,faces:f}}initparm(v,_,D){D>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let f=1/this.scaleFactor*5.5;this.pminx=v[0][0],this.pmaxx=v[1][0],this.pminy=v[0][1],this.pmaxy=v[1][1],this.pminz=v[0][2],this.pmaxz=v[1][2],_?(this.pminx-=this.probeRadius+f,this.pminy-=this.probeRadius+f,this.pminz-=this.probeRadius+f,this.pmaxx+=this.probeRadius+f,this.pmaxy+=this.probeRadius+f,this.pmaxz+=this.probeRadius+f):(this.pminx-=f,this.pminy-=f,this.pminz-=f,this.pmaxx+=f,this.pmaxy+=f,this.pmaxz+=f),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(_),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(v){let _={};for(const D in this.vdwRadii){let f=this.vdwRadii[D];v?_[D]=(f+this.probeRadius)*this.scaleFactor+.5:_[D]=f*this.scaleFactor+.5;let l=_[D]*_[D];this.widxz[D]=Math.floor(_[D])+1,this.depty[D]=new Int32Array(this.widxz[D]*this.widxz[D]);let c=0;for(let p=0;p<this.widxz[D];p++)for(let b=0;b<this.widxz[D];b++){let E=p*p+b*b;if(E>l)this.depty[D][c]=-1;else{let C=Math.sqrt(l-E);this.depty[D][c]=Math.floor(C)}c++}}}fillvoxels(v,_){for(let D=0,f=this.vpBits.length;D<f;D++)this.vpBits[D]=0,this.vpDistance[D]=-1,this.vpAtomID[D]=-1;for(let D in _){let f=v[_[D]];f!==void 0&&this.fillAtom(f,v)}for(let D=0,f=this.vpBits.length;D<f;D++)this.vpBits[D]&this.INOUT&&(this.vpBits[D]|=this.ISDONE)}fillAtom(v,_){let D=Math.floor(.5+this.scaleFactor*(v.x+this.ptranx)),f=Math.floor(.5+this.scaleFactor*(v.y+this.ptrany)),l=Math.floor(.5+this.scaleFactor*(v.z+this.ptranz)),c=this.getVDWIndex(v),p=0,b=this.pWidth*this.pHeight;for(let E=0,C=this.widxz[c];E<C;E++)for(let g=0;g<C;g++){if(this.depty[c][p]!=-1){for(let x=-1;x<2;x++)for(let y=-1;y<2;y++)for(let w=-1;w<2;w++)if(x!==0&&y!==0&&w!==0){let M=x*E,S=w*g;for(let O=0;O<=this.depty[c][p];O++){let P=O*y,I=D+M,F=f+P,k=l+S;if(I<0||F<0||k<0||I>=this.pLength||F>=this.pWidth||k>=this.pHeight)continue;let B=I*b+F*this.pHeight+k;if(!(this.vpBits[B]&this.INOUT))this.vpBits[B]|=this.INOUT,this.vpAtomID[B]=v.serial;else{let U=_[this.vpAtomID[B]];if(U.serial!=v.serial){let W=D+M-Math.floor(.5+this.scaleFactor*(U.x+this.ptranx)),R=f+P-Math.floor(.5+this.scaleFactor*(U.y+this.ptrany)),z=l+S-Math.floor(.5+this.scaleFactor*(U.z+this.ptranz));M*M+P*P+S*S<W*W+R*R+z*z&&(this.vpAtomID[B]=v.serial)}}}}}p++}}fillvoxelswaals(v,_){for(let D=0,f=this.vpBits.length;D<f;D++)this.vpBits[D]&=~this.ISDONE;for(let D in _){let f=v[_[D]];f!==void 0&&this.fillAtomWaals(f,v)}}fillAtomWaals(v,_){let D=0,f=Math.floor(.5+this.scaleFactor*(v.x+this.ptranx)),l=Math.floor(.5+this.scaleFactor*(v.y+this.ptrany)),c=Math.floor(.5+this.scaleFactor*(v.z+this.ptranz)),p=this.getVDWIndex(v),b=this.pWidth*this.pHeight;for(let E=0,C=this.widxz[p];E<C;E++)for(let g=0;g<C;g++){if(this.depty[p][D]!=-1){for(let x=-1;x<2;x++)for(let y=-1;y<2;y++)for(let w=-1;w<2;w++)if(x!==0&&y!==0&&w!==0){let M=x*E,S=w*g;for(let O=0;O<=this.depty[p][D];O++){let P=O*y,I=f+M,F=l+P,k=c+S;if(I<0||F<0||k<0||I>=this.pLength||F>=this.pWidth||k>=this.pHeight)continue;let B=I*b+F*this.pHeight+k;if(!(this.vpBits[B]&this.ISDONE))this.vpBits[B]|=this.ISDONE,this.vpAtomID[B]=v.serial;else{let U=_[this.vpAtomID[B]];if(U.serial!=v.serial){let W=f+M-Math.floor(.5+this.scaleFactor*(U.x+this.ptranx)),R=l+P-Math.floor(.5+this.scaleFactor*(U.y+this.ptrany)),z=c+S-Math.floor(.5+this.scaleFactor*(U.z+this.ptranz));M*M+P*P+S*S<W*W+R*R+z*z&&(this.vpAtomID[B]=v.serial)}}}}}D++}}buildboundary(){let v=this.pWidth*this.pHeight;for(let _=0;_<this.pLength;_++)for(let D=0;D<this.pHeight;D++)for(let f=0;f<this.pWidth;f++){let l=_*v+f*this.pHeight+D;if(this.vpBits[l]&this.INOUT){let c=0;for(;c<26;){let p=_+this.nb[c][0],b=D+this.nb[c][2],E=f+this.nb[c][1];if(p>-1&&p<this.pLength&&E>-1&&E<this.pWidth&&b>-1&&b<this.pHeight&&!(this.vpBits[p*v+E*this.pHeight+b]&this.INOUT)){this.vpBits[l]|=this.ISBOUND;break}else c++}}}}fastdistancemap(){let v=new d(this.pLength,this.pWidth,this.pHeight),_=this.pWidth*this.pHeight,D=this.cutRadius*this.cutRadius,f=[],l=[],c;for(let E=0;E<this.pLength;E++)for(let C=0;C<this.pWidth;C++)for(let g=0;g<this.pHeight;g++)if(c=E*_+C*this.pHeight+g,this.vpBits[c]&=~this.ISDONE,this.vpBits[c]&this.INOUT&&this.vpBits[c]&this.ISBOUND){let x={ix:E,iy:C,iz:g};v.set(E,C,g,x),f.push(x),this.vpDistance[c]=0,this.vpBits[c]|=this.ISDONE,this.vpBits[c]&=~this.ISBOUND}do{l=this.fastoneshell(f,v),f=[];for(let E=0,C=l.length;E<C;E++)c=_*l[E].ix+this.pHeight*l[E].iy+l[E].iz,this.vpBits[c]&=~this.ISBOUND,this.vpDistance[c]<=1.0404*D&&f.push({ix:l[E].ix,iy:l[E].iy,iz:l[E].iz})}while(f.length!==0);f=[],l=[],v=null;let p=this.scaleFactor-.5;p<0&&(p=0);let b=D-.5/(.1+p);for(let E=0;E<this.pLength;E++)for(let C=0;C<this.pWidth;C++)for(let g=0;g<this.pHeight;g++)c=E*_+C*this.pHeight+g,this.vpBits[c]&=~this.ISBOUND,this.vpBits[c]&this.INOUT&&(!(this.vpBits[c]&this.ISDONE)||this.vpBits[c]&this.ISDONE&&this.vpDistance[c]>=b)&&(this.vpBits[c]|=this.ISBOUND)}fastoneshell(v,_){let D,f,l,c,p,b,E,C,g,x=[];if(v.length===0)return x;let y={ix:-1,iy:-1,iz:-1},w=this.pWidth*this.pHeight;for(let M=0,S=v.length;M<S;M++){D=v[M].ix,f=v[M].iy,l=v[M].iz,C=_.get(D,f,l);for(let O=0;O<6;O++)y.ix=D+this.nb[O][0],y.iy=f+this.nb[O][1],y.iz=l+this.nb[O][2],y.ix<this.pLength&&y.ix>-1&&y.iy<this.pWidth&&y.iy>-1&&y.iz<this.pHeight&&y.iz>-1&&(g=y.ix*w+this.pHeight*y.iy+y.iz,this.vpBits[g]&this.INOUT&&!(this.vpBits[g]&this.ISDONE)?(_.set(y.ix,y.iy,l+this.nb[O][2],C),c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,this.vpDistance[g]=E,this.vpBits[g]|=this.ISDONE,this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})):this.vpBits[g]&this.INOUT&&this.vpBits[g]&this.ISDONE&&(c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,E<this.vpDistance[g]&&(_.set(y.ix,y.iy,y.iz,C),this.vpDistance[g]=E,this.vpBits[g]&this.ISBOUND||(this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})))))}for(let M=0,S=v.length;M<S;M++){D=v[M].ix,f=v[M].iy,l=v[M].iz,C=_.get(D,f,l);for(let O=6;O<18;O++)y.ix=D+this.nb[O][0],y.iy=f+this.nb[O][1],y.iz=l+this.nb[O][2],y.ix<this.pLength&&y.ix>-1&&y.iy<this.pWidth&&y.iy>-1&&y.iz<this.pHeight&&y.iz>-1&&(g=y.ix*w+this.pHeight*y.iy+y.iz,this.vpBits[g]&this.INOUT&&!(this.vpBits[g]&this.ISDONE)?(_.set(y.ix,y.iy,l+this.nb[O][2],C),c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,this.vpDistance[g]=E,this.vpBits[g]|=this.ISDONE,this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})):this.vpBits[g]&this.INOUT&&this.vpBits[g]&this.ISDONE&&(c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,E<this.vpDistance[g]&&(_.set(y.ix,y.iy,y.iz,C),this.vpDistance[g]=E,this.vpBits[g]&this.ISBOUND||(this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})))))}for(let M=0,S=v.length;M<S;M++){D=v[M].ix,f=v[M].iy,l=v[M].iz,C=_.get(D,f,l);for(let O=18;O<26;O++)y.ix=D+this.nb[O][0],y.iy=f+this.nb[O][1],y.iz=l+this.nb[O][2],y.ix<this.pLength&&y.ix>-1&&y.iy<this.pWidth&&y.iy>-1&&y.iz<this.pHeight&&y.iz>-1&&(g=y.ix*w+this.pHeight*y.iy+y.iz,this.vpBits[g]&this.INOUT&&!(this.vpBits[g]&this.ISDONE)?(_.set(y.ix,y.iy,l+this.nb[O][2],C),c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,this.vpDistance[g]=E,this.vpBits[g]|=this.ISDONE,this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})):this.vpBits[g]&this.INOUT&&this.vpBits[g]&this.ISDONE&&(c=y.ix-C.ix,p=y.iy-C.iy,b=y.iz-C.iz,E=c*c+p*p+b*b,E<this.vpDistance[g]&&(_.set(y.ix,y.iy,y.iz,C),this.vpDistance[g]=E,this.vpBits[g]&this.ISBOUND||(this.vpBits[g]|=this.ISBOUND,x.push({ix:y.ix,iy:y.iy,iz:y.iz})))))}return x}marchingcubeinit(v){for(let _=0,D=this.vpBits.length;_<D;_++)v==1?this.vpBits[_]&=~this.ISBOUND:v==4?(this.vpBits[_]&=~this.ISDONE,this.vpBits[_]&this.ISBOUND&&(this.vpBits[_]|=this.ISDONE),this.vpBits[_]&=~this.ISBOUND):v==2?this.vpBits[_]&this.ISBOUND&&this.vpBits[_]&this.ISDONE?this.vpBits[_]&=~this.ISBOUND:this.vpBits[_]&this.ISBOUND&&!(this.vpBits[_]&this.ISDONE)&&(this.vpBits[_]|=this.ISDONE):v==3&&(this.vpBits[_]&=~this.ISBOUND)}marchingcube(v){this.marchingcubeinit(v),this.verts=[],this.faces=[],u.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let _=this.pWidth*this.pHeight;for(let D=0,f=this.verts.length;D<f;D++)this.verts[D].atomid=this.vpAtomID[this.verts[D].x*_+this.pHeight*this.verts[D].y+this.verts[D].z];u.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}u.MarchingCube=new a},"./src/SurfaceWorker.js":()=>{$3Dmol.workerString=(function(){self.onmessage=function(n){var e=n.data,t=e.type;if(t<0)self.atomData=e.atoms,self.volume=e.volume,self.ps=new ProteinSurface;else{var i=self.ps;i.initparm(e.expandedExtent,t!=1,self.volume),i.fillvoxels(self.atomData,e.extendedAtoms),i.buildboundary(),(t===4||t===2)&&(i.fastdistancemap(),i.boundingatom(!1),i.fillvoxelswaals(self.atomData,e.extendedAtoms)),i.marchingcube(t);var r=i.getFacesAndVertices(e.atomsToShow);self.postMessage(r)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},"./src/VolumeData.ts":(n,e,t)=>{t.r(e),t.d(e,{VolumeData:()=>h});var i=t("./src/utilities.ts"),r=t("./src/WebGL/math/index.ts"),s=t("./src/parsers/VASP.ts"),o=t("./src/parsers/CUBE.ts"),a=t("./node_modules/pako/dist/pako.esm.mjs");class h{constructor(u,m,v){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(c){var p=c/(this.size.y*this.size.z),b=c%(this.size.y*this.size.z),E=c%this.size.z;return p*=this.unit.x,b*=this.unit.y,E*=this.unit.z,p+=this.origin.x,b+=this.origin.y,E+=this.origin.z,{x:p,y:b,z:E}},this.vasp=function(c){var p=c.replace(/^\s+/,"").split(/[\n\r]/),b=(0,s.VASP)(c)[0],E=b.length;if(E==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var C=1.889725992,g=.036749309,x=parseFloat(p[1]),y;y=p[2].replace(/^\s+/,"").split(/\s+/);var w=new r.Vector3(parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])).multiplyScalar(x*C);y=p[3].replace(/^\s+/,"").split(/\s+/);var M=new r.Vector3(parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])).multiplyScalar(x*C);y=p[4].replace(/^\s+/,"").split(/\s+/);var S=new r.Vector3(parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])).multiplyScalar(x*C),O=w.x*(M.y*S.z-S.y*M.z)-M.x*(w.y*S.z-S.y*w.z)+S.x*(w.y*M.z-M.y*w.z);O=Math.abs(O)/Math.pow(C,3);var P=1/O;p.splice(0,8+E+1);var I=p[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),F=Math.abs(parseFloat(I[0])),k=Math.abs(parseFloat(I[1])),B=Math.abs(parseFloat(I[2])),U=this.origin=new r.Vector3(0,0,0);this.size={x:F,y:k,z:B},this.unit=new r.Vector3(w.x,M.y,S.z),w=w.multiplyScalar(1/(C*F)),M=M.multiplyScalar(1/(C*k)),S=S.multiplyScalar(1/(C*B)),(w.y!=0||w.z!=0||M.x!=0||M.z!=0||S.x!=0||S.y!=0)&&(this.matrix=new r.Matrix4(w.x,M.x,S.x,0,w.y,M.y,S.y,0,w.z,M.z,S.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new r.Matrix4().makeTranslation(U.x,U.y,U.z)),this.origin=new r.Vector3(0,0,0),this.unit=new r.Vector3(1,1,1)),p.splice(0,1);var W=p.join(" ");W=W.replace(/^\s+/,"");var R=W.split(/[\s\r]+/);R.splice(F*k*B+1);for(var z=Float32Array.from(R,parseFloat),G=0;G<z.length;G++)z[G]=z[G]*P*g;this.data=z},this.dx=function(c){var p=c.split(/[\n\r]+/),b,E=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,C=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,g=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,x=/data follows/,y=0;for(y=0;y<p.length;y++){var w=p[y];if(b=E.exec(w)){var M=parseInt(b[1]),S=parseInt(b[2]),O=parseInt(b[3]);this.size={x:M,y:S,z:O}}else if(b=g.exec(w)){var P=parseFloat(b[1]);if((parseFloat(b[2])!=0||parseFloat(b[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),y+=1,w=p[y],b=g.exec(w),b==null){console.error("Parse error in dx delta matrix");return}var I=parseFloat(b[2]);if((parseFloat(b[1])!=0||parseFloat(b[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),y+=1,w=p[y],b=g.exec(w),b==null){console.error("Parse error in dx delta matrix");return}var F=parseFloat(b[3]);(parseFloat(b[1])!=0||parseFloat(b[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new r.Vector3(P,I,F)}else if(b=C.exec(w)){var k=parseFloat(b[1]),B=parseFloat(b[2]),U=parseFloat(b[3]);this.origin=new r.Vector3(k,B,U)}else if(b=x.exec(w))break}if(y+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var W=p.splice(y).join(" "),R=W.split(/[\s\r]+/);this.data=Float32Array.from(R,parseFloat)},m=m.toLowerCase(),/\.gz$/.test(m)){m=m.replace(/\.gz$/,"");try{this[m]&&this.isbinary.has(m)?(typeof u=="string"&&(u=(0,i.base64ToArray)(u)),u=(0,a.inflate)(u)):u=new TextDecoder("utf-8").decode((0,a.inflate)(u))}catch(c){console.error(c)}}if(this[m]&&(this.isbinary.has(m)&&typeof u=="string"&&(u=(0,i.base64ToArray)(u)),this[m](u)),v){if(v.negate)for(let c=0,p=this.data.length;c<p;c++)this.data[c]=-this.data[c];if(v.normalize){var _=0;for(let c=0,p=this.data.length;c<p;c++)_+=this.data[c];var D=_/this.data.length;_=0;for(let c=0,p=this.data.length;c<p;c++){var f=this.data[c]-D;_+=f*f}var l=_/this.data.length;for(let c=0,p=this.data.length;c<p;c++)this.data[c]=(this.data[c]-D)/l}}}getIndex(u,m,v){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new r.Matrix4().getInverse(this.matrix));var _=new r.Vector3(u,m,v);_=_.applyMatrix4(this.inversematrix),u=_.x,m=_.y,v=_.z}else u-=this.origin.x,m-=this.origin.y,v-=this.origin.z,u/=this.unit.x,m/=this.unit.y,v/=this.unit.z;return u=Math.round(u),m=Math.round(m),v=Math.round(v),u<0||u>=this.size.x||m<0||m>=this.size.y||v<0||v>=this.size.z?-1:u*this.size.y*this.size.z+m*this.size.z+v}getVal(u,m,v){let _=this.getIndex(u,m,v);return _<0?0:this.data[_]}cube(u){var m=u.split(/\r?\n/);if(!(m.length<6)){var v=(0,o.CUBE)(u,{}).modelData[0].cryst,_=m[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),D=parseFloat(_[0]),f=Math.abs(D);this.origin=v.origin,this.size=v.size,this.unit=v.unit,this.matrix=v.matrix4;var l=6;D<0&&l++;var c=m.splice(f+l).join(" ");c=c.replace(/^\s+/,"");var p=c.split(/[\s\r]+/);this.data=Float32Array.from(p,parseFloat)}}ccp4(u){var m={};u=new Int8Array(u);var v=new Int32Array(u.buffer,0,56),_=new Float32Array(u.buffer,0,56),D=new DataView(u.buffer);if(m.MAP=String.fromCharCode(D.getUint8(208),D.getUint8(209),D.getUint8(210),D.getUint8(211)),m.MACHST=[D.getUint8(212),D.getUint8(213)],m.MACHST[0]===17&&m.MACHST[1]===17)for(var f=u.byteLength,l=0;l<f;l+=4)D.setFloat32(l,D.getFloat32(l),!0);m.NX=v[0],m.NY=v[1],m.NZ=v[2],m.MODE=v[3],m.NXSTART=v[4],m.NYSTART=v[5],m.NZSTART=v[6],m.MX=v[7],m.MY=v[8],m.MZ=v[9],m.xlen=_[10],m.ylen=_[11],m.zlen=_[12],m.alpha=_[13],m.beta=_[14],m.gamma=_[15],m.MAPC=v[16],m.MAPR=v[17],m.MAPS=v[18],m.DMIN=_[19],m.DMAX=_[20],m.DMEAN=_[21],m.ISPG=v[22],m.NSYMBT=v[23],m.LSKFLG=v[24],m.originX=_[49],m.originY=_[50],m.originZ=_[51],m.ARMS=_[54];var c=m,p=[c.xlen,0,0],b=[c.ylen*Math.cos(Math.PI/180*c.gamma),c.ylen*Math.sin(Math.PI/180*c.gamma),0],E=[c.zlen*Math.cos(Math.PI/180*c.beta),c.zlen*(Math.cos(Math.PI/180*c.alpha)-Math.cos(Math.PI/180*c.gamma)*Math.cos(Math.PI/180*c.beta))/Math.sin(Math.PI/180*c.gamma),0];E[2]=Math.sqrt(c.zlen*c.zlen*Math.sin(Math.PI/180*c.beta)*Math.sin(Math.PI/180*c.beta)-E[1]*E[1]);var C=[0,p,b,E],g=[0,c.MX,c.MY,c.MZ],x=[0,c.MAPC,c.MAPR,c.MAPS];this.matrix=new r.Matrix4,this.matrix.set(C[x[1]][0]/g[x[1]],C[x[2]][0]/g[x[2]],C[x[3]][0]/g[x[3]],0,C[x[1]][1]/g[x[1]],C[x[2]][1]/g[x[2]],C[x[3]][1]/g[x[3]],0,C[x[1]][2]/g[x[1]],C[x[2]][2]/g[x[2]],C[x[3]][2]/g[x[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new r.Matrix4().makeTranslation(c.NXSTART+c.originX,c.NYSTART+c.originY,c.NZSTART+c.originZ)),this.origin=new r.Vector3(0,0,0),this.unit=new r.Vector3(1,1,1),this.size={x:m.NX,y:m.NY,z:m.NZ},this.dimensionorder=[m.MAPC,m.MAPR,m.MAPS];var y=new Float32Array(u.buffer,1024+m.NSYMBT),w=m.NX,M=m.NY,S=m.NZ;this.data=new Float32Array(w*M*S);for(let O=0;O<w;O++)for(let P=0;P<M;P++)for(let I=0;I<S;I++)this.data[(O*M+P)*S+I]=y[(I*M+P)*w+O]}}},"./src/VolumetricRender.ts":(n,e,t)=>{t.r(e),t.d(e,{GLVolumetricRender:()=>h});var i=t("./src/WebGL/shapes/index.ts"),r=t("./src/WebGL/math/index.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/colors.ts"),a=t("./src/GLShape.ts");class h{static interpolateArray(u,m){function v(E,C,g){return E+(C-E)*g}var _=[],D=(u.length-1)/(m-1);_[0]=u[0];for(var f=1;f<m-1;f++){var l=f*D,c=Math.floor(l),p=Math.ceil(l),b=l-c;_[f]=v(u[c],u[p],b)}return _[m-1]=u[u.length-1],_}constructor(u,m,v){this.hidden=!1,this.boundingSphere=new i.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,m=m||{};var _=Object.assign([],m.transferfn);this.subsamples=m.subsamples||5;let D=256;_.forEach(function(M){M.value=parseFloat(M.value)}),_.sort(function(M,S){return M.value-S.value}),this.min=_[0].value,_.length==0&&_.push(_[0]),this.max=_[_.length-1].value;var f,l,c,p,b,E,C,g,x,y;for(let M=0;M<_.length-1;M++)if(c=o.CC.color(_[M].color),p=o.CC.color(_[M+1].color),x=_[M].opacity,y=_[M+1].opacity,f=Math.floor((_[M].value-this.min)*D/(this.max-this.min)),l=Math.floor((_[M+1].value-this.min)*D/(this.max-this.min)),f!=l){b=h.interpolateArray([c.r*255,p.r*255],l-f),E=h.interpolateArray([c.g*255,p.g*255],l-f),C=h.interpolateArray([c.b*255,p.b*255],l-f),g=h.interpolateArray([x*255,y*255],l-f);for(let S=0;S<b.length;S++)this.transferfunctionbuffer.push(b[S]),this.transferfunctionbuffer.push(E[S]),this.transferfunctionbuffer.push(C[S]),this.transferfunctionbuffer.push(g[S])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),u.matrix){let M=new r.Vector3(0,0,0),S=new r.Vector3(u.size.x,u.size.y,u.size.z),O=new r.Vector3(1,1,1);M.applyMatrix4(u.matrix),S.applyMatrix4(u.matrix),O.applyMatrix4(u.matrix).sub(M),this.extent=[[M.x,M.y,M.z],[S.x,S.y,S.z]];for(let k=1;k<7;k++)S.x=k&1?u.size.x:0,S.y=k&2?u.size.y:0,S.z=k&4?u.size.z:0,S.applyMatrix4(u.matrix),this.extent[0][0]=Math.min(this.extent[0][0],S.x),this.extent[0][1]=Math.min(this.extent[0][1],S.y),this.extent[0][2]=Math.min(this.extent[0][2],S.z),this.extent[1][0]=Math.max(this.extent[1][0],S.x),this.extent[1][1]=Math.max(this.extent[1][1],S.y),this.extent[1][2]=Math.max(this.extent[1][2],S.z);let P=S.x-M.x,I=S.y-M.y,F=S.z-M.z;this.maxdepth=Math.sqrt(P*P+I*I+F*F),this.minunit=Math.min(Math.min(O.x,O.y),O.z),this.texmatrix=new r.Matrix4().identity().scale({x:u.size.x,y:u.size.y,z:u.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(u.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new r.Matrix4().identity();let M=u.unit.x*u.size.x,S=u.unit.y*u.size.y,O=u.unit.z*u.size.z;this.texmatrix.makeTranslation(-u.origin.x/M,-u.origin.y/S,-u.origin.z/O),this.texmatrix.scale({x:1/M,y:1/S,z:1/O}),this.minunit=Math.min(Math.min(u.unit.x,u.unit.y),u.unit.z),this.extent=[[u.origin.x,u.origin.y,u.origin.z],[u.origin.x+M,u.origin.y+S,u.origin.z+O]],this.maxdepth=Math.sqrt(M*M+S*S+O*O)}var w=new a.GLShape({});if(w.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=w.finalize(),this.boundingSphere.center=new r.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,m.coords===void 0&&m.selection!==void 0&&(v?m.coords=v.selectedAtoms(m.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),m.coords!==void 0&&m.seldist!==void 0){let M=new Uint8Array(u.data.length),S=m.seldist,O=S*S;for(let P=0,I=m.coords.length;P<I;P++){let F=m.coords[P],k=F.x-S,B=F.y-S,U=F.z-S,W=F.x+S,R=F.y+S,z=F.z+S;if(u.getIndex(k,B,U)>=0||u.getIndex(W,R,z)>=0)for(let G=k;G<W;G+=this.minunit)for(let q=B;q<R;q+=this.minunit)for(let Q=U;Q<z;Q+=this.minunit){let ne=u.getIndex(G,q,Q);ne>=0&&!M[ne]&&(G-F.x)*(G-F.x)+(q-F.y)*(q-F.y)+(Q-F.z)*(Q-F.z)<O&&(M[ne]=1)}}for(let P=0,I=u.data.length;P<I;P++)M[P]==0&&(u.data[P]=1/0)}this.data=u}globj(u){if(this.renderedShapeObj&&(u.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new s.Object3D;var m=null,v=new s.Texture(this.data,!0),_=new s.Texture(this.transferfunctionbuffer,!1);v.needsUpdate=!0,_.needsUpdate=!0,_.flipY=!1,m=new s.VolumetricMaterial({transferfn:_,transfermin:this.min,transfermax:this.max,map:v,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var D=new s.Mesh(this.geo,m);this.shapeObj.add(D),this.renderedShapeObj=this.shapeObj.clone(),u.add(this.renderedShapeObj)}}removegl(u){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),u.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}},"./src/WebGL/Camera.ts":(n,e,t)=>{t.r(e),t.d(e,{Camera:()=>s});var i=t("./src/WebGL/core/index.ts"),r=t("./src/WebGL/math/index.ts");class s extends i.Object3D{constructor(a=50,h=1,d=.1,u=2e3,m=!1){super(),this.projectionMatrix=new r.Matrix4,this.projectionMatrixInverse=new r.Matrix4,this.matrixWorldInverse=new r.Matrix4,this.fov=a,this.aspect=h,this.near=d,this.far=u;var v=this.position.z;this.right=v*Math.tan(Math.PI/180*a),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!m,this.updateProjectionMatrix()}lookAt(a){this.matrix.lookAt(this.position,a,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof r.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}},"./src/WebGL/Fog.ts":(n,e,t)=>{t.r(e),t.d(e,{Fog:()=>r});var i=t("./src/colors.ts");class r{constructor(o,a=1,h=1e3){this.name="",this.color=new i.Color(o),this.near=a,this.far=h}clone(){return new r(this.color.getHex(),this.near,this.far)}}},"./src/WebGL/Renderer.ts":(n,e,t)=>{t.r(e),t.d(e,{Renderer:()=>f});var i=t("./src/WebGL/Camera.ts"),r=t("./src/WebGL/constants/Sides.ts"),s=t("./src/WebGL/constants/TextureConstants.ts"),o=t("./src/WebGL/core/index.ts"),a=t("./src/colors.ts"),h=t("./src/WebGL/materials/index.ts"),d=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/objects/index.ts"),m=t("./src/WebGL/shaders/index.ts"),v=t("./src/WebGL/SpritePlugin.ts"),_=null,D=null;class f{constructor(c){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new d.Vector3,this._worldInverse=new d.Matrix4,this._projInverse=new d.Matrix4,this._textureMatrix=new d.Matrix4,this._fullProjModelMatrix=new d.Matrix4,this._fullProjModelMatrixInv=new d.Matrix4,this._direction=new d.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new v.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,c=c||{},this.row=c.row,this.col=c.col,this.rows=c.rows,this.cols=c.cols,this._canvas=c.canvas!==void 0?c.canvas:document.createElement("canvas"),this._precision=c.precision!==void 0?c.precision:"highp",this._alpha=c.alpha!==void 0?c.alpha:!0,this._premultipliedAlpha=c.premultipliedAlpha!==void 0?c.premultipliedAlpha:!0,this._antialias=c.antialias!==void 0?c.antialias:!1,this._upscale=c.upscale!==void 0?c.upscale:this._antialias,this._preserveDrawingBuffer=c.preserveDrawingBuffer!==void 0?c.preserveDrawingBuffer:!1,this._clearColor=c.clearColor!==void 0?new a.Color(c.clearColor):new a.Color(0),this._clearAlpha=c.clearAlpha!==void 0?c.clearAlpha:0,this._outlineMaterial=new h.MeshOutlineMaterial(c.outline),this._outlineSphereImposterMaterial=new h.SphereImposterOutlineMaterial(c.outline),this._outlineStickImposterMaterial=new h.StickImposterOutlineMaterial(c.outline),this._outlineEnabled=!!c.outline,this._AOEnabled=!!c.ambientOcclusion,c.ambientOcclusion&&typeof c.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(c.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),c.ambientOcclusion&&typeof c.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(c.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=c.id,!(c.containerWidth==0||c.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(c,p){this._clearColor.setHex(c),this._clearAlpha=p,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(c){this._outlineMaterial=new h.MeshOutlineMaterial(c),this._outlineSphereImposterMaterial=new h.SphereImposterOutlineMaterial(c),this._outlineStickImposterMaterial=new h.StickImposterOutlineMaterial(c),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(c){c&&(c.strength&&(this._AOstrength=c.strength),c.scale&&(this._AOradius=c.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var c=this._gl.drawingBufferWidth/this.cols,p=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=c,this._viewportHeight=p,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(c*this.col,p*this.row,c,p),this._gl.viewport(c*this.col,p*this.row,c,p))}}setSize(c,p){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=c*this.devicePixelRatio,this._canvas.height=p*this.devicePixelRatio,this._canvas.style.width=c+"px",this._canvas.style.height=p+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var b=c/this.cols,E=p/this.rows;this._viewportWidth=b*this.devicePixelRatio,this._viewportHeight=E*this.devicePixelRatio,this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows,this.setViewport()}else this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(c,p,b){var E=0;(c===void 0||c)&&(E|=this._gl.COLOR_BUFFER_BIT),(p===void 0||p)&&(E|=this._gl.DEPTH_BUFFER_BIT),(b===void 0||b)&&(E|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(E)}setMaterialFaces(c,p){var b=c.side===r.DoubleSide,E=c.side===r.BackSide;c.imposter||(E=p?!E:E),this._oldDoubleSided!==b&&(b?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=b),this._oldFlipSided!==E&&(E?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=E),this._gl.cullFace(this._gl.BACK)}setDepthTest(c){this._oldDepthTest!==c&&(c?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=c)}setDepthWrite(c){this._oldDepthWrite!==c&&(this._gl.depthMask(c),this._oldDepthWrite=c)}setBlending(c){c?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(c,p,b,E){c.addEventListener("dispose",this.onMaterialDispose.bind(this));var C,g;if(g=c.shaderID,g){var x=m.ShaderLib[g];c.vertexShader=x.vertexShader,c.fragmentShader=x.fragmentShader,c.uniforms=m.ShaderUtils.clone(x.uniforms),c.shaded&&c.makeShaded(this.SHADE_TEXTURE)}C={wireframe:c.wireframe,fragdepth:c.imposter,volumetric:c.volumetric,shaded:c.shaded},c.program=this.buildProgram(c.fragmentShader,c.vertexShader,c.uniforms,C)}renderBuffer(c,p,b,E,C,g){if(E.visible){var x,y;if(x=this.setProgram(c,p,b,E,g,this),!!x){y=x.attributes;var w=!1,M=E.wireframe?1:0,S=C.id*16777215+x.id*2+M;S!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=S,w=!0),w&&(this.disableAttributes(),y.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglVertexBuffer),this.enableAttribute(y.position),this._gl.vertexAttribPointer(y.position,3,this._gl.FLOAT,!1,0,0)),y.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglColorBuffer),this.enableAttribute(y.color),this._gl.vertexAttribPointer(y.color,3,this._gl.FLOAT,!1,0,0)),y.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglNormalBuffer),this.enableAttribute(y.normal),this._gl.vertexAttribPointer(y.normal,3,this._gl.FLOAT,!1,0,0)),y.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglOffsetBuffer),this.enableAttribute(y.offset),this._gl.vertexAttribPointer(y.offset,3,this._gl.FLOAT,!1,0,0)),y.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglRadiusBuffer),this.enableAttribute(y.radius),this._gl.vertexAttribPointer(y.radius,1,this._gl.FLOAT,!1,0,0)));var O,P;if(g instanceof u.Mesh){if(E.shaderID==="instanced"){var I=E.sphere.geometryGroups[0];w&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,I.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,I.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,C.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,I.faceArray,this._gl.STATIC_DRAW)),O=I.faceidx,this._extInstanced.vertexAttribDivisorANGLE(y.offset,1),this._extInstanced.vertexAttribDivisorANGLE(y.radius,1),this._extInstanced.vertexAttribDivisorANGLE(y.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,O,this._gl.UNSIGNED_SHORT,0,C.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(y.offset,0),this._extInstanced.vertexAttribDivisorANGLE(y.radius,0),this._extInstanced.vertexAttribDivisorANGLE(y.color,0)}else E.wireframe?(P=C.lineidx,this.setLineWidth(E.wireframeLinewidth),w&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,C.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,P,this._gl.UNSIGNED_SHORT,0)):(O=C.faceidx,w&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,C.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,O,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=O,this.info.render.faces+=O/3}else g instanceof u.Line&&(P=C.vertices,this.setLineWidth(E.linewidth),this._gl.drawArrays(this._gl.LINES,0,P),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(c,p,b){let E=c.__lights,C=c.fog,g=[];for(let w=0,M=c.__webglObjects.length;w<M;w++){let S=c.__webglObjects[w];S.render&&S[b]&&g.push(S)}if(g.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(c.__webglObjects,!0,b+"Depth",p,E,C,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let x=this._AOshader.uniforms;this._gl.uniform1f(x.total_strength,this._AOstrength),this._gl.uniform1f(x.radius,this._AOradius),this._fullProjModelMatrix=new d.Matrix4,this._fullProjModelMatrixInv=new d.Matrix4;let y=g[0].object;this._fullProjModelMatrix.multiplyMatrices(p.projectionMatrix,y._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(x.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(x.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(c,p){if(!(p instanceof i.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var b,E,C,g,x,y=c.__lights,w=c.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&c.updateMatrixWorld(),p.parent===void 0&&p.updateMatrixWorld(),p.matrixWorldInverse.getInverse(p.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(c),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),x=c.__webglObjects;let M=!1,S=this._AOEnabled;for(b=0,E=x.length;b<E;b++)C=x[b],g=C.object,C.render=!1,g.visible&&(this.setupMatrices(g,p),this.unrollBufferMaterial(C),C.render=!0,C.volumetric&&(M=!0),C.hasAO&&(S=!0));if(this.setBlending(!1),S&&this.setShading(c,p,"opaque"),this.renderObjects(c.__webglObjects,!0,"opaque",p,y,w,!1),S&&this.clearShading(),this.renderSprites(c,p,!1),this.renderObjects(c.__webglObjects,!0,"transparentDepth",p,y,w,!0),this.renderObjects(c.__webglObjects,!1,"transparent",p,y,w,!0),M&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(c.__webglObjects,!1,"volumetric",p,y,w,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(c,p,!0),this._bitmap){const O=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(O),O.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let c=this._viewportWidth,p=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,c,p),this._gl.viewport(0,0,c,p),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,c,p,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,c,p,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,c,p,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,c,p,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let c=this._viewportWidth,p=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,c,p),this._gl.viewport(0,0,c,p),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var b=this._antialias?m.ShaderLib.screenaa:m.ShaderLib.screen;this._screenshader=this.buildProgram(b.fragmentShader,b.vertexShader,b.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var E=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(E),this._gl.STATIC_DRAW);let C=m.ShaderLib.ssao;this._AOshader=this.buildProgram(C.fragmentShader,C.vertexShader,C.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let g=m.ShaderLib.blur;this._blurshader=this.buildProgram(g.fragmentShader,g.vertexShader,g.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(c){if(c.__webglObjects||(c.__webglObjects=[],c.__webglObjectsImmediate=[],c.__webglSprites=[],c.__webglFlares=[]),c.__objectsAdded.length){for(;c.__objectsAdded.length;)this.addObject(c.__objectsAdded[0],c),c.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;c.__objectsRemoved.length;)this.removeObject(c.__objectsRemoved[0],c),c.__objectsRemoved.splice(0,1);for(var p=0,b=c.__webglObjects.length;p<b;p++)this.updateObject(c.__webglObjects[p].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(c,p){(c==null||p==null)&&(c=this._canvas.width,p=this._canvas.height);var b=c/p;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var E=c/this.cols,C=p/this.rows;b=E/C}return b}setTexture(c,p,b){if(c.needsUpdate){c.__webglInit||(c.__webglInit=!0,c.addEventListener("dispose",this.onTextureDispose.bind(this)),c.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+p);var E=b?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(E,c.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,c.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,c.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,c.unpackAlignment);var C=this.paramToGL(c.format),g=this.paramToGL(c.type);if(b)this.setTextureParameters(this._gl.TEXTURE_3D,c),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,c.image.size.z,c.image.size.y,c.image.size.x,0,this._gl.RED,this._gl.FLOAT,c.image.data);else{var x=c.image,y=x.width,w=x.height;typeof y>"u"&&(y=x.length,C==this._gl.RGBA&&(y/=4),w=1),this.setTextureParameters(this._gl.TEXTURE_2D,c),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,C,C,g,c.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,C,y,w,0,C,g,c.image)}c.needsUpdate=!1,c.onUpdate&&c.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+p),b?this._gl.bindTexture(this._gl.TEXTURE_3D,c.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,c.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(c){this._enabledAttributes[c]||(this._gl.enableVertexAttribArray(c),this._enabledAttributes[c]=!0)}disableAttributes(){for(let c in this._enabledAttributes)this._enabledAttributes[c]&&(this._gl.disableVertexAttribArray(c),this._enabledAttributes[c]=!1)}setPolygonOffset(c,p,b){this._oldPolygonOffset!==c&&(c?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(c){c!==this._oldLineWidth&&(this._gl.lineWidth(c),this._oldLineWidth=c)}deallocateGeometry(c){if(c.__webglInit=void 0,c.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(c.__webglVertexBuffer),c.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(c.__webglColorBuffer),c.geometryGroups!==void 0)for(var p=0,b=c.groups;p<b;p++){var E=c.geometryGroups[p];E.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(E.__webglVertexBuffer),E.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(E.__webglColorBuffer),E.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(E.__webglNormalBuffer),E.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(E.__webglFaceBuffer),E.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(E.__webglLineBuffer)}}deallocateMaterial(c){var p=c.program;if(p!==void 0){c.program=void 0;var b,E,C,g=!1;for(b=0,E=this._programs.length;b<E;b++)if(C=this._programs[b],C.program===p){C.usedTimes--,C.usedTimes===0&&(g=!0);break}if(g===!0){var x=[];for(b=0,E=this._programs.length;b<E;b++)C=this._programs[b],C.program!==p&&x.push(C);this._programs=x,this._gl.deleteProgram(p),this.info.memory.programs--}}}deallocateTexture(c){if(c.image&&c.image.__webglTextureCube)this._gl.deleteTexture(c.image.__webglTextureCube);else{if(!c.__webglInit)return;c.__webglInit=!1,this._gl.deleteTexture(c.__webglTexture)}}onGeometryDispose(c){var p=c.target;p.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(p),this.info.memory.geometries--}onTextureDispose(c){var p=c.target;p.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(p),this.info.memory.textures--}onMaterialDispose(c){var p=c.target;p.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(p)}getShader(c,p){var b;return!this.isWebGL1()&&!p.startsWith("#version")&&(p=p.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),c=="fragment"?p=p.replace(/varying/g,"in"):p=p.replace(/varying/g,"out"),p=p.replace(/attribute/g,"in"),p=p.replace(/texture2D/g,"texture"),p=p.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),p=p.replace(/gl_FragColor/g,"glFragColor"),p=`#version 300 es
`+p),c==="fragment"?b=this._gl.createShader(this._gl.FRAGMENT_SHADER):c==="vertex"&&(b=this._gl.createShader(this._gl.VERTEX_SHADER)),b==null?null:(this._gl.shaderSource(b,p),this._gl.compileShader(b),this._gl.getShaderParameter(b,this._gl.COMPILE_STATUS)?b:(console.error(this._gl.getShaderInfoLog(b)),console.error("could not initialize shader"),null))}buildProgram(c,p,b,E){var C,g,x,y,w=[];w.push(c),w.push(p);for(C in E)w.push(C),w.push(E[C]);for(y=w.join(),C=0,g=this._programs.length;C<g;C++){var M=this._programs[C];if(M.code===y)return M.usedTimes++,M.program}if(this.isWebGL1()&&E.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(x=this._gl.createProgram(),x==null)return null;var S=this._precision,O="precision "+S+" float;",P=[E.volumetric?"#version 300 es":"",O].join(`
`),I=[E.volumetric?"#version 300 es":"",E.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",E.shaded?"#define SHADED 1":"",E.wireframe?"#define WIREFRAME 1":"",O].join(`
`),F=this.getShader("fragment",I+c),k=this.getShader("vertex",P+p);k!=null&&this._gl.attachShader(x,k),F!=null&&this._gl.attachShader(x,F),this._gl.linkProgram(x),this._gl.getProgramParameter(x,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),x.uniforms={},x.attributes={};var B,U,W;B=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"];for(U in b)B.push(U);for(W=0;W<B.length;W++){var R=B[W];x.uniforms[R]=this._gl.getUniformLocation(x,R)}for(B=["position","normal","color","lineDistance","offset","radius"],W=0;W<B.length;W++){var z=B[W];x.attributes[z]=this._gl.getAttribLocation(x,z)}return x.id=this._programs_counter++,this._programs.push({program:x,code:y,usedTimes:1}),this.info.memory.programs=this._programs.length,x}setProgram(c,p,b,E,C,g){if(E.needsUpdate&&(E.program&&this.deallocateMaterial(E),this.initMaterial(E,p,b,C),E.needsUpdate=!1),E.program==null)return null;var x=!1,y=E.program,w=y.uniforms,M=E.uniforms;if(y!=this._currentProgram&&(this._gl.useProgram(y),this._currentProgram=y,x=!0),E.id!=this._currentMaterialId&&(this._currentMaterialId=E.id,x=!0),c!=this._currentCamera&&(this._currentCamera=c,x=!0),w.projectionMatrix&&this._gl.uniformMatrix4fv(w.projectionMatrix,!1,c.projectionMatrix.elements),w.modelViewMatrix&&this._gl.uniformMatrix4fv(w.modelViewMatrix,!1,C._modelViewMatrix.elements),w.normalMatrix&&this._gl.uniformMatrix3fv(w.normalMatrix,!1,C._normalMatrix.elements),w.projinv&&(this._projInverse.getInverse(c.projectionMatrix),this._gl.uniformMatrix4fv(w.projinv,!1,this._projInverse.elements)),w.viewMatrix&&this._gl.uniformMatrix4fv(w.viewMatrix,!1,c.matrixWorldInverse.elements),w.vWidth&&this._gl.uniform1f(w.vWidth,this._viewportWidth),w.vHeight&&this._gl.uniform1f(w.vHeight,this._viewportHeight),x){if(M.fogColor.value=b.color,M.fogNear.value=b.near,M.fogFar.value=b.far,E.shaderID.startsWith("lambert")||E.shaderID==="instanced"||E.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(y,p),this._lightsNeedUpdate=!1),M.directionalLightColor.value=this._lights.directional.colors,M.directionalLightDirection.value=this._lights.directional.positions;else if(E.shaderID.endsWith("outline"))M.outlineColor.value=E.outlineColor,M.outlineWidth.value=E.outlineWidth,M.outlinePushback.value=E.outlinePushback,M.outlineMaxPixels.value=E.outlineMaxPixels*this.devicePixelRatio;else if(E.shaderID==="volumetric"){C._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(C._modelViewMatrix),this._projInverse.getInverse(c.projectionMatrix),this._textureMatrix.multiplyMatrices(C.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(w.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(w.projinv,!1,this._projInverse.elements);let S=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);M.step.value=C.material.unit*S,M.maxdepth.value=C.material.maxdepth*S,M.transfermax.value=C.material.transfermax,M.transfermin.value=C.material.transfermin,M.subsamples.value=C.material.subsamples,g.setTexture(C.material.transferfn,4,!1),g.setTexture(C.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}M.opacity.value=E.opacity,this.loadMaterialUniforms(w,M)}return M.shading&&(M.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),y}loadMaterialUniforms(c,p){var b,E,C,g;for(b in p)c[b]&&(E=p[b].type,C=p[b].value,g=c[b],E==="f"?this._gl.uniform1f(g,C):E==="i"?this._gl.uniform1i(g,C):E==="fv"?this._gl.uniform3fv(g,C):E==="c"?this._gl.uniform3f(g,C.r,C.g,C.b):E==="f4"&&this._gl.uniform4f(g,C[0],C[1],C[2],C[3]))}addObject(c,p){var b,E,C,g;if(!c.__webglInit&&(c.__webglInit=!0,c._modelViewMatrix=new d.Matrix4,c._normalMatrix=new d.Matrix3,c.geometry!==void 0&&c.geometry.__webglInit===void 0&&(c.geometry.__webglInit=!0,c.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),c instanceof u.Mesh||c instanceof u.Line))for(C=c.geometry,b=0,E=C.geometryGroups.length;b<E;b++)g=C.geometryGroups[b],g.id=this._geometryGroupCounter++,g.__webglVertexBuffer||(c instanceof u.Mesh?(this.createMeshBuffers(g),C.elementsNeedUpdate=!0,C.normalsNeedUpdate=!0):c instanceof u.Line&&this.createLineBuffers(g),C.verticesNeedUpdate=!0,C.colorsNeedUpdate=!0);if(!c.__webglActive){if(c instanceof u.Mesh||c instanceof u.Line)for(C=c.geometry,b=0,E=C.geometryGroups.length;b<E;b++)g=C.geometryGroups[b],this.addBuffer(p.__webglObjects,g,c);else c instanceof u.Sprite&&p.__webglSprites.push(c);c.__webglActive=!0}}updateObject(c){var p=c.geometry,b;if(c instanceof u.Mesh||c instanceof u.Line){for(var E=0,C=p.geometryGroups.length;E<C;E++)b=p.geometryGroups[E],(p.verticesNeedUpdate||p.elementsNeedUpdate||p.colorsNeedUpdate||p.normalsNeedUpdate)&&this.setBuffers(b,this._gl.STATIC_DRAW);p.verticesNeedUpdate=!1,p.elementsNeedUpdate=!1,p.normalsNeedUpdate=!1,p.colorsNeedUpdate=!1,p.buffersNeedUpdate=!1}}removeObject(c,p){c instanceof u.Mesh||c instanceof u.Line?this.removeInstances(p.__webglObjects,c):c instanceof u.Sprite&&this.removeInstancesDirect(p.__webglSprites,c),c.__webglActive=!1}removeInstances(c,p){for(var b=c.length-1;b>=0;--b)c[b].object===p&&c.splice(b,1)}removeInstancesDirect(c,p){for(var b=c.length-1;b>=0;--b)c[b]===p&&c.splice(b,1)}unrollBufferMaterial(c){var p=c.object,b=p.material;if(b.volumetric)c.opaque=null,c.transparent=null,c.volumetric=b;else if(b.transparent){if(c.opaque=null,c.volumetric=null,c.transparent=b,!b.wireframe){let E=b.clone();E.opacity=0,c.transparentDepth=E}}else{if(c.opaque=b,c.transparent=null,c.volumetric=null,!b.wireframe){let E=b.clone();E.opacity=0,c.opaqueDepth=E}b.hasAO&&(c.hasAO=!0),(this._AOEnabled||c.hasAO)&&(c.opaqueShaded=b.clone(),c.opaqueShaded.shaded=!0)}}setBuffers(c,p){var b=c.vertexArray,E=c.colorArray;if(c.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,c.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,b,p)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,c.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,b,p)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,c.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,E,p),c.normalArray&&c.__webglNormalBuffer!==void 0){var C=c.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,c.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,C,p)}if(c.radiusArray&&c.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,c.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,c.radiusArray,p)),c.faceArray&&c.__webglFaceBuffer!==void 0){var g=c.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,c.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,g,p)}if(c.lineArray&&c.__webglLineBuffer!==void 0){var x=c.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,c.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,x,p)}}createMeshBuffers(c){c.radiusArray&&(c.__webglRadiusBuffer=this._gl.createBuffer()),c.useOffset&&(c.__webglOffsetBuffer=this._gl.createBuffer()),c.__webglVertexBuffer=this._gl.createBuffer(),c.__webglNormalBuffer=this._gl.createBuffer(),c.__webglColorBuffer=this._gl.createBuffer(),c.__webglFaceBuffer=this._gl.createBuffer(),c.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(c){c.__webglVertexBuffer=this._gl.createBuffer(),c.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(c,p,b){c.push({buffer:p,object:b,opaque:null,transparent:null})}setupMatrices(c,p){c._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,c.matrixWorld),c._normalMatrix.getInverse(c._modelViewMatrix),c._normalMatrix.transpose()}filterFallback(c){return this._gl.LINEAR}setTextureParameters(c,p){c==this._gl.TEXTURE_2D?(this._gl.texParameteri(c,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(c,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(c,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(p.magFilter)),this._gl.texParameteri(c,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(p.minFilter))):(this._gl.texParameteri(c,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(c,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(c,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(c,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(c,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(c,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(c,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(c){return c===s.UnsignedByteType?this._gl.UNSIGNED_BYTE:c===s.RGBAFormat?this._gl.RGBA:c===s.NearestFilter?this._gl.NEAREST:0}setupLights(c,p){var b,E,C,g=0,x=0,y=0,w,M,S=this._lights,O=S.directional.colors,P=S.directional.positions,I=0,F=0;for(b=0,E=p.length;b<E;b++)if(C=p[b],w=C.color,M=C.intensity,C instanceof o.Light){if(this._direction.getPositionFromMatrix(C.matrixWorld),this._vector3.getPositionFromMatrix(C.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;P[F]=this._direction.x,P[F+1]=this._direction.y,P[F+2]=this._direction.z,O[F]=w.r*M,O[F+1]=w.g*M,O[F+2]=w.b*M,F+=3,I++}S.ambient[0]=g,S.ambient[1]=x,S.ambient[2]=y,S.directional.length=I}initGL(){try{if(OffscreenCanvas&&!(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null))(D==null||D.isContextLost())&&(_=new OffscreenCanvas(this._canvas.width,this._canvas.height),D=_.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=_,this._gl=D,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});else if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var c=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(c[6])}catch(p){console.error(p)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(c,p,b,E,C,g,x){var y,w,M,S,O,P,I;p?(O=c.length-1,P=-1,I=-1):(O=0,P=c.length,I=1);for(var F=O;F!==P;F+=I)if(y=c[F],y.render){if(w=y.object,M=y.buffer,S=y[b],(y.hasAO||this._AOEnabled)&&y[b+"Shaded"]&&(S=y[b+"Shaded"]),!S)continue;this.setBlending(x),this.setDepthTest(S.depthTest),this.setDepthWrite(S.depthWrite),this.setPolygonOffset(S.polygonOffset,S.polygonOffsetFactor,S.polygonOffsetUnits);var k=w._modelViewMatrix.isReflected();if(this.setMaterialFaces(S,k),this.renderBuffer(E,C,g,S,M,w),(this._outlineEnabled||S.outline)&&!S.wireframe&&S.shaderID!=="basic"&&S.opacity!==0){let B=this._outlineMaterial;S.shaderID=="sphereimposter"?B=this._outlineSphereImposterMaterial:S.shaderID=="stickimposter"&&(B=this._outlineStickImposterMaterial),this.renderBuffer(E,C,g,B,M,w)}}}renderSprites(c,p,b){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(c,p,this._currentWidth,this._currentHeight,b),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},"./src/WebGL/SpritePlugin.ts":(n,e,t)=>{t.r(e),t.d(e,{SpritePlugin:()=>r});var i=t("./src/WebGL/shaders/index.ts");class r{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(a){this.gl=a.context,this.renderer=a,this.precision=a.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var h=0;this.sprite.vertices[h++]=-1,this.sprite.vertices[h++]=-1,this.sprite.vertices[h++]=0,this.sprite.vertices[h++]=0,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=-1,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=0,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=-1,this.sprite.vertices[h++]=1,this.sprite.vertices[h++]=0,this.sprite.vertices[h++]=1,h=0,this.sprite.faces[h++]=0,this.sprite.faces[h++]=1,this.sprite.faces[h++]=2,this.sprite.faces[h++]=0,this.sprite.faces[h++]=2,this.sprite.faces[h++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(i.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const d={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),d.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),d.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),d.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),d.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),d.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),d.color=this.gl.getUniformLocation(this.sprite.program,"color"),d.map=this.gl.getUniformLocation(this.sprite.program,"map"),d.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),d.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),d.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),d.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),d.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),d.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),d.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),d.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),d.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=d}render(a,h,d,u,m){var v,_,D,f,l,c,p,b,E,C;if(!this.gl)throw new Error("WebGLRenderer not initialized");let g=[];(v=a==null?void 0:a.__webglSprites)===null||v===void 0||v.forEach(R=>{(m&&R.material.depthTest==!1||!m&&R.material.depthTest)&&g.push(R)});let x=g.length;if(!x)return;const y=this.sprite.attributes,w=this.sprite.uniforms;if(!w)throw new Error("Uniforms not defined");var M=d*.5,S=u*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(y.position),this.gl.enableVertexAttribArray(y.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(y.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(y.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(w.projectionMatrix,!1,h.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(w.map,0);var O=a.fog;O?(this.gl.uniform3f(w.fogColor,O.color.r,O.color.g,O.color.b),this.gl.uniform1f(w.fogNear,O.near),this.gl.uniform1f(w.fogFar,O.far)):(this.gl.uniform1f(w.fogNear,0),this.gl.uniform1f(w.fogFar,0));var P;let I,F,k,B=[];for(P=0;P<x;P++)I=g[P],F=I.material,F&&(F.depthTest==!1&&!m||!I.visible||F.opacity===0||(F.useScreenCoordinates?I.z=-I.position.z:(I._modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,I.matrixWorld),I.z=-I._modelViewMatrix.elements[14])));for(g.sort(s),P=0;P<x;P++)if(I=g[P],F=I.material,!!F&&!(!I.visible||F.opacity===0)&&F.map&&F.map.image&&F.map.image.width){this.gl.uniform1f((w==null?void 0:w.alphaTest)||null,F.alphaTest);var U=F.map.image.width,W=F.map.image.height;B[0]=U*this.renderer.devicePixelRatio/d,B[1]=W*this.renderer.devicePixelRatio/u,F.useScreenCoordinates===!0?(this.gl.uniform1i(w.useScreenCoordinates,1),this.gl.uniform3f(w.screenPosition,(I.position.x*this.renderer.devicePixelRatio-M)/M,(S-I.position.y*this.renderer.devicePixelRatio)/S,Math.max(0,Math.min(1,I.position.z)))):(this.gl.uniform1i(w.useScreenCoordinates,0),this.gl.uniformMatrix4fv(w.modelViewMatrix,!1,I._modelViewMatrix.elements)),k=1/(F.scaleByViewport?u:1),B[0]*=k*I.scale.x,B[1]*=k*I.scale.y;let R=(_=F==null?void 0:F.alignment)===null||_===void 0?void 0:_.x,z=(D=F==null?void 0:F.alignment)===null||D===void 0?void 0:D.y;F.screenOffset&&(R=(R||0)+2*F.screenOffset.x/U,z=(z||0)+2*F.screenOffset.y/W),this.gl.uniform2f(w.uvScale,((f=F==null?void 0:F.uvScale)===null||f===void 0?void 0:f.x)||1,((l=F==null?void 0:F.uvScale)===null||l===void 0?void 0:l.y)||1),this.gl.uniform2f(w.uvOffset,((c=F==null?void 0:F.uvOffset)===null||c===void 0?void 0:c.x)||0,((p=F==null?void 0:F.uvOffset)===null||p===void 0?void 0:p.y)||0),this.gl.uniform2f(w.alignment,R||0,z||0),this.gl.uniform1f(w.opacity,F.opacity),this.gl.uniform3f(w.color,((b=F==null?void 0:F.color)===null||b===void 0?void 0:b.r)||0,((E=F==null?void 0:F.color)===null||E===void 0?void 0:E.g)||0,((C=F==null?void 0:F.color)===null||C===void 0?void 0:C.b)||0),this.gl.uniform1f(w.rotation,I.rotation),this.gl.uniform2fv(w.scale,B),this.renderer.setDepthTest(F.depthTest),this.renderer.setDepthWrite(F.depthWrite),this.renderer.setTexture(F.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(a,h){if(!this.gl)throw new Error("WebGL Rendering context not found");var d=this.gl.createProgram();if(!d)throw new Error("Error creating webgl program");var u=this.gl.createShader(this.gl.FRAGMENT_SHADER),m=this.gl.createShader(this.gl.VERTEX_SHADER);if(!u)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!m)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var v="precision "+h+` float;
`;if(this.gl.shaderSource(u,v+a.fragmentShader),this.gl.shaderSource(m,v+a.vertexShader),this.gl.compileShader(u),this.gl.compileShader(m),!this.gl.getShaderParameter(u,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(m,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(u)} 
      ${this.gl.getShaderInfoLog(m)}`);return this.gl.attachShader(d,u),this.gl.attachShader(d,m),this.gl.linkProgram(d),this.gl.getProgramParameter(d,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),d}}function s(o,a){return o.z!==a.z?a.z-o.z:a.id-o.id}},"./src/WebGL/constants/Coloring.ts":(n,e,t)=>{t.r(e),t.d(e,{Coloring:()=>i});var i;(function(r){r[r.NoColors=0]="NoColors",r[r.FaceColors=1]="FaceColors",r[r.VertexColors=2]="VertexColors"})(i||(i={}))},"./src/WebGL/constants/Shading.ts":(n,e,t)=>{t.r(e),t.d(e,{Shading:()=>i});var i;(function(r){r[r.NoShading=0]="NoShading",r[r.FlatShading=1]="FlatShading",r[r.SmoothShading=2]="SmoothShading"})(i||(i={}))},"./src/WebGL/constants/Sides.ts":(n,e,t)=>{t.r(e),t.d(e,{BackSide:()=>r,DoubleSide:()=>s,FrontSide:()=>i});const i=0,r=1,s=2},"./src/WebGL/constants/SpriteAlignment.ts":(n,e,t)=>{t.r(e),t.d(e,{SpriteAlignment:()=>r});var i=t("./src/WebGL/math/index.ts");const r={topLeft:new i.Vector2(1,-1),topCenter:new i.Vector2(0,-1),topRight:new i.Vector2(-1,-1),centerLeft:new i.Vector2(1,0),center:new i.Vector2(0,0),centerRight:new i.Vector2(-1,0),bottomLeft:new i.Vector2(1,1),bottomCenter:new i.Vector2(0,1),bottomRight:new i.Vector2(-1,1)}},"./src/WebGL/constants/TextureConstants.ts":(n,e,t)=>{t.r(e),t.d(e,{ClampToEdgeWrapping:()=>i,FloatType:()=>h,LinearFilter:()=>r,LinearMipMapLinearFilter:()=>o,NearestFilter:()=>s,R32Format:()=>m,RFormat:()=>u,RGBAFormat:()=>d,UnsignedByteType:()=>a});const i=1001,r=1006,s=1007,o=1008,a=1009,h=1010,d=1021,u=1022,m=1023},"./src/WebGL/constants/TextureOperations.ts":(n,e,t)=>{t.r(e),t.d(e,{TextureOperations:()=>i});var i;(function(r){r[r.MultiplyOperation=0]="MultiplyOperation",r[r.MixOperation=1]="MixOperation",r[r.AddOperation=2]="AddOperation"})(i||(i={}))},"./src/WebGL/constants/index.ts":(n,e,t)=>{t.r(e),t.d(e,{BackSide:()=>r.BackSide,ClampToEdgeWrapping:()=>a.ClampToEdgeWrapping,Coloring:()=>i.Coloring,DoubleSide:()=>r.DoubleSide,FloatType:()=>a.FloatType,FrontSide:()=>r.FrontSide,LinearFilter:()=>a.LinearFilter,LinearMipMapLinearFilter:()=>a.LinearMipMapLinearFilter,NearestFilter:()=>a.NearestFilter,R32Format:()=>a.R32Format,RFormat:()=>a.RFormat,RGBAFormat:()=>a.RGBAFormat,Shading:()=>s.Shading,SpriteAlignment:()=>o.SpriteAlignment,TextureOperations:()=>h.TextureOperations,UnsignedByteType:()=>a.UnsignedByteType});var i=t("./src/WebGL/constants/Coloring.ts"),r=t("./src/WebGL/constants/Sides.ts"),s=t("./src/WebGL/constants/Shading.ts"),o=t("./src/WebGL/constants/SpriteAlignment.ts"),a=t("./src/WebGL/constants/TextureConstants.ts"),h=t("./src/WebGL/constants/TextureOperations.ts")},"./src/WebGL/core/EventDispatcher.ts":(n,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>i});class i{constructor(){this.listeners={}}dispatchEvent(s){var o=this.listeners[s.type];if(o!==void 0){s.target=this;for(var a=0,h=o.length;a<h;a++)o[a].call(this,s)}}removeEventListener(s,o){if(!o)this.listeners[s]=[];else{var a=this.listeners[s].indexOf(o);a!==-1&&this.listeners[s].splice(a,1)}}addEventListener(s,o){this.listeners[s]===void 0&&(this.listeners[s]=[]),this.listeners[s].indexOf(o)===-1&&this.listeners[s].push(o)}}},"./src/WebGL/core/Geometry.ts":(n,e,t)=>{t.r(e),t.d(e,{Geometry:()=>d,GeometryGroup:()=>h,GeometryIDCount:()=>u});var i=t("./src/WebGL/materials/LineBasicMaterial.ts"),r=t("./src/WebGL/core/EventDispatcher.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts");const a=65535;class h{constructor(v=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=v}setColor(v){var _=this.vertexArray,D=this.colorArray;if(!_)throw new Error("vertex array not initialized");if(!D)throw new Error("color array not initialized");let f=o.CC.color(v);for(var l=0;l<_.length;l+=3)D[l]=f.r,D[l+1]=f.g,D[l+2]=f.b}setColors(v){var _=this.vertexArray,D=this.colorArray;if(!_)throw new Error("vertex array not initialized");if(!D)throw new Error("color array not initialized");if(_.length!=D.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var f=0;f<_.length;f+=3){var l=v(_[f],_[f+1],_[f+2]);l instanceof o.Color||(l=o.CC.color(l)),D[f]=l.r,D[f+1]=l.g,D[f+2]=l.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var v=new s.Vector3,_,D,f,l,c=0;c<this.vertices;++c)_=c*3,D=this.vertexArray[_],f=this.vertexArray[_+1],l=this.vertexArray[_+2],v.x+=D,v.y+=f,v.z+=l;return v.divideScalar(this.vertices),v}setNormals(){var v=this.faceArray,_=this.vertexArray,D=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!v)throw new Error("face array not initialized");if(!_)throw new Error("vertex array not initialized");if(!D)throw new Error("normal array not initialized");for(var f,l,c,p,b,E,C,g=0;g<v.length/3;++g)f=v[g*3]*3,l=v[g*3+1]*3,c=v[g*3+2]*3,p=new s.Vector3(_[f],_[f+1],_[f+2]),b=new s.Vector3(_[l],_[l+1],_[l+2]),E=new s.Vector3(_[c],_[c+1],_[c+2]),p.subVectors(p,b),E.subVectors(E,b),E.cross(p),C=E,C.normalize(),D[f]+=C.x,D[l]+=C.x,D[c]+=C.x,D[f+1]+=C.y,D[l+1]+=C.y,D[c+1]+=C.y,D[f+2]+=C.z,D[l+2]+=C.z,D[c+2]+=C.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var v=this.faceArray,_=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!v)throw new Error("face array not initialized");for(var D=0;D<this.faceidx/3;++D){var f=D*3,l=f*2,c=v[f],p=v[f+1],b=v[f+2];_[l]=c,_[l+1]=p,_[l+2]=c,_[l+3]=b,_[l+4]=p,_[l+5]=b}}}vrml(v,_){var D,f,l,c,p,b,E,C,g,x,y,w,M,S,O,P,I,F,k="";if(k+=v+`Shape {
`+v+` appearance Appearance {
`+v+`  material Material {
`+v+"   diffuseColor "+((D=_==null?void 0:_.color)===null||D===void 0?void 0:D.r)+" "+((f=_==null?void 0:_.color)===null||f===void 0?void 0:f.g)+" "+((l=_==null?void 0:_.color)===null||l===void 0?void 0:l.b)+`
`,_.wireframe&&this.colorArray){let U=this.colorArray;k+=v+"    emissiveColor "+U[0]+" "+U[1]+" "+U[2]+`
`}_!=null&&_.transparent&&(k+=v+"   transparency "+(1-_.opacity)+`
`),k+=v+`  }
`,k+=v+` }
`;var B=v;if(v+=" ",_ instanceof i.LineBasicMaterial||_.wireframe){k+=v+`geometry IndexedLineSet {
`+v+` colorPerVertex TRUE
`+v+` coord Coordinate {
`+v+`  point [
`;let U,W,R;for(let z=0;z<this.vertices;++z){let G=z*3;U=(c=this.vertexArray)===null||c===void 0?void 0:c[G],W=(p=this.vertexArray)===null||p===void 0?void 0:p[G+1],R=(b=this.vertexArray)===null||b===void 0?void 0:b[G+2],k+=v+"   "+U+" "+W+" "+R+`,
`}if(k+=v+`  ]
`,k+=v+` }
`,this.colorArray&&!_.wireframe){k+=v+` color Color {
`+v+`  color [
`;for(let z=0;z<this.vertices;++z){let G=z*3;U=this.colorArray[G],W=this.colorArray[G+1],R=this.colorArray[G+2],k+=v+"   "+U+" "+W+" "+R+`,
`}k+=v+`  ]
`,k+=v+` }
`}if(k+=v+` coordIndex [
`,_.wireframe&&this.faceArray)for(let z=0;z<this.faceidx;z+=3)U=(E=this.faceArray)===null||E===void 0?void 0:E[z],W=(C=this.faceArray)===null||C===void 0?void 0:C[z+1],R=(g=this.faceArray)===null||g===void 0?void 0:g[z+2],k+=v+"  "+U+", "+W+", "+R+`, -1,
`;else for(let z=0;z<this.vertices-1;z+=2)k+=v+"  "+z+", "+(z+1)+`, -1,
`;k+=v+` ]
`,k+=v+`}
`}else{k+=v+`geometry IndexedFaceSet {
`+v+` colorPerVertex TRUE
`+v+` normalPerVertex TRUE
`+v+` solid FALSE
`,k+=v+` coord Coordinate {
`+v+`  point [
`;let U,W,R;for(let z=0;z<this.vertices;++z){let G=z*3;U=(x=this.vertexArray)===null||x===void 0?void 0:x[G],W=(y=this.vertexArray)===null||y===void 0?void 0:y[G+1],R=(w=this.vertexArray)===null||w===void 0?void 0:w[G+2],k+=v+"   "+U+" "+W+" "+R+`,
`}k+=v+`  ]
`,k+=v+` }
`,k+=v+` normal Normal {
`+v+`  vector [
`;for(let z=0;z<this.vertices;++z){let G=z*3;U=(M=this.normalArray)===null||M===void 0?void 0:M[G],W=(S=this.normalArray)===null||S===void 0?void 0:S[G+1],R=(O=this.normalArray)===null||O===void 0?void 0:O[G+2],k+=v+"   "+U+" "+W+" "+R+`,
`}if(k+=v+`  ]
`,k+=v+` }
`,this.colorArray){k+=v+` color Color {
`+v+`  color [
`;for(let z=0;z<this.vertices;++z){let G=z*3;U=this.colorArray[G],W=this.colorArray[G+1],R=this.colorArray[G+2],k+=v+"   "+U+" "+W+" "+R+`,
`}k+=v+`  ]
`,k+=v+` }
`}k+=v+` coordIndex [
`;for(let z=0;z<this.faceidx;z+=3)U=(P=this.faceArray)===null||P===void 0?void 0:P[z],W=(I=this.faceArray)===null||I===void 0?void 0:I[z+1],R=(F=this.faceArray)===null||F===void 0?void 0:F[z+2],k+=v+"  "+U+", "+W+", "+R+`, -1,
`;k+=v+` ]
`,k+=v+`}
`}return k+=B+"}",k}truncateArrayBuffers(v=!0,_=!1){var D=this.vertexArray,f=this.colorArray,l=this.normalArray,c=this.faceArray,p=this.lineArray,b=this.radiusArray;this.vertexArray=(D==null?void 0:D.subarray(0,this.vertices*3))||null,this.colorArray=(f==null?void 0:f.subarray(0,this.vertices*3))||null,v?(this.normalArray=(l==null?void 0:l.subarray(0,this.vertices*3))||null,this.faceArray=(c==null?void 0:c.subarray(0,this.faceidx))||null,this.lineidx>0?this.lineArray=(p==null?void 0:p.subarray(0,this.lineidx))||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),b&&(this.radiusArray=b.subarray(0,this.vertices)),_&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class d extends r.EventDispatcher{constructor(v=!1,_=!1,D=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=u++,this.mesh=v,this.radii=_,this.offset=D}updateGeoGroup(v=0){var _,D=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!D||D.vertices+v>(((_=D==null?void 0:D.vertexArray)===null||_===void 0?void 0:_.length)||0)/3)&&(D=this.addGeoGroup()),D}vrml(v,_){for(var D="",f=this.geometryGroups.length,l=0;l<f;l++){var c=this.geometryGroups[l];D+=c.vrml(v,_)+`,
`}return D}addGeoGroup(){var v=new h(this.geometryGroups.length);return this.geometryGroups.push(v),this.groups=this.geometryGroups.length,v.vertexArray=new Float32Array(a*3),v.colorArray=new Float32Array(a*3),this.mesh&&(v.normalArray=new Float32Array(a*3),v.faceArray=new Uint16Array(a*6),v.lineArray=new Uint16Array(a*6)),this.radii&&(v.radiusArray=new Float32Array(a)),v.useOffset=this.offset,v}setUpNormals(...v){for(var _=0;_<this.groups;_++){var D=this.geometryGroups[_];D.setNormals(...v)}}setColors(...v){for(var _=this.geometryGroups.length,D=0;D<_;D++){var f=this.geometryGroups[D];f.setColors(...v)}}setColor(...v){let _=this.geometryGroups.length;for(var D=0;D<_;D++){var f=this.geometryGroups[D];f.setColor(...v)}}setUpWireframe(...v){let _=this.geometryGroups.length;for(var D=0;D<_;D++){var f=this.geometryGroups[D];f.setLineIndices(...v)}}initTypedArrays(){for(var v=0;v<this.groups;v++){var _=this.geometryGroups[v];_.__inittedArrays!==!0&&_.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var v=0,_=0;_<this.groups;_++)v+=this.geometryGroups[_].vertices;return v}}let u=0},"./src/WebGL/core/Object3D.ts":(n,e,t)=>{t.r(e),t.d(e,{Light:()=>h,Object3D:()=>o,Object3DIDCount:()=>s,Scene:()=>a});var i=t("./src/WebGL/math/index.ts"),r=t("./src/colors.ts");let s=0;class o{constructor(){this.id=s++,this.name="",this.children=[],this.position=new i.Vector3,this.rotation=new i.Vector3,this.matrix=new i.Matrix4,this.matrixWorld=new i.Matrix4,this.quaternion=new i.Quaternion,this.eulerOrder="XYZ",this.up=new i.Vector3(0,1,0),this.scale=new i.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(u){this.matrix.lookAt(u,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof i.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(u){if(u===this){console.error("Can't add $3Dmol.Object3D to itself");return}u.parent=this,this.children.push(u);for(var m=this;m.parent!==void 0;)m=m.parent;m!==void 0&&m instanceof a&&m.__addObject(u)}remove(u){var m=this.children.indexOf(u);if(m!==-1){u.parent=void 0,this.children.splice(m,1);for(var v=this;v.parent!==void 0;)v=v.parent;v!==void 0&&v instanceof a&&v.__removeObject(u)}}vrml(u){u||(u=" ");var m=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),v=0,_=0,D=0;if(m!=0){let c=Math.sin(m/2);v=this.quaternion.x/c,_=this.quaternion.y/c,D=this.quaternion.z/c}var f=u+`Transform {
`+u+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+u+" rotation "+v+" "+_+" "+D+" "+m+`
`+u+` children [
`;this.geometry&&(f+=this.geometry.vrml(u,this.material));for(var l=0;l<this.children.length;l++)f+=this.children[l].vrml(u+" ")+`,
`;return f+=` ]
`,f+="}",f}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof i.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(u){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||u===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var m=0;m<this.children.length;m++)this.children[m].updateMatrixWorld(!0)}clone(u){u===void 0&&(u=new o),u.name=this.name,u.up.copy(this.up),u.position.copy(this.position),u.rotation instanceof i.Vector3&&this.rotation instanceof i.Vector3?u.rotation.copy(this.rotation):u.rotation=this.rotation,u.eulerOrder=this.eulerOrder,u.scale.copy(this.scale),u.rotationAutoUpdate=this.rotationAutoUpdate,u.matrix.copy(this.matrix),u.matrixWorld.copy(this.matrixWorld),u.quaternion.copy(this.quaternion),u.matrixAutoUpdate=this.matrixAutoUpdate,u.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,u.useQuaternion=this.useQuaternion,u.visible=this.visible;for(var m=0;m<this.children.length;m++){var v=this.children[m];u.add(v.clone())}return u}setVisible(u){this.visible=u;for(var m=0;m<this.children.length;m++){var v=this.children[m];v.setVisible(u)}}}class a extends o{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(u){if(u instanceof h)this.__lights.indexOf(u)===-1&&this.__lights.push(u),u.target&&u.target.parent===void 0&&this.add(u.target);else if(this.__objects.indexOf(u)===-1){this.__objects.push(u),this.__objectsAdded.push(u);var m=this.__objectsRemoved.indexOf(u);m!==-1&&this.__objectsRemoved.splice(m,1)}for(var v=0;v<u.children.length;v++)this.__addObject(u.children[v])}__removeObject(u){var m;if(u instanceof h)m=this.__lights.indexOf(u),m!==-1&&this.__lights.splice(m,1);else if(m=this.__objects.indexOf(u),m!==-1){this.__objects.splice(m,1),this.__objectsRemoved.push(u);var v=this.__objectsAdded.indexOf(u);v!==-1&&this.__objectsAdded.splice(m,1)}for(var _=0;_<u.children.length;_++)this.__removeObject(u.children[_])}}class h extends o{constructor(u,m=1){super(),this.position=new i.Vector3(0,1,0),this.target=new o,this.castShadow=!1,this.onlyShadow=!1,this.color=new r.Color(u),this.intensity=m}}},"./src/WebGL/core/Projector.ts":(n,e,t)=>{t.r(e),t.d(e,{Projector:()=>s});var i=t("./src/WebGL/math/index.ts");const r=new i.Matrix4;class s{static unprojectVector(a,h){return h.projectionMatrixInverse.getInverse(h.projectionMatrix),r.multiplyMatrices(h.matrixWorld,h.projectionMatrixInverse),a.applyProjection(r)}static projectVector(a,h){return h.matrixWorldInverse.getInverse(h.matrixWorld),r.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),a.applyProjection(r)}projectVector(a,h){return s.projectVector(a,h)}unprojectVector(a,h){return s.unprojectVector(a,h)}}},"./src/WebGL/core/Raycaster.ts":(n,e,t)=>{t.r(e),t.d(e,{Raycaster:()=>a,intersectObject:()=>c});var i=t("./src/WebGL/math/index.ts"),r=t("./src/WebGL/shapes/index.ts");const s=(p,b)=>p.distance-b.distance,o=new i.Matrix4;class a{constructor(b,E,C,g){this.precision=1e-4,this.linePrecision=.2,this.ray=new i.Ray(b,E),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=g||0,this.far=C||1/0}set(b,E){this.ray.set(b,E)}setFromCamera(b,E){E.ortho?(this.ray.origin.set(b.x,b.y,(E.near+E.far)/(E.near-E.far)).unproject(E),this.ray.direction.set(0,0,-1).transformDirection(E.matrixWorld)):(this.ray.origin.setFromMatrixPosition(E.matrixWorld),this.ray.direction.set(b.x,b.y,b.z),E.projectionMatrixInverse.getInverse(E.projectionMatrix),o.multiplyMatrices(E.matrixWorld,E.projectionMatrixInverse),this.ray.direction.applyProjection(o),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(b,E){for(var C=[],g=0,x=E.length;g<x;g++)c(b,E[g],this,C);return C.sort(s),C}}const h=p=>Math.min(Math.max(p,-1),1);var d=new r.Sphere,u=new r.Cylinder,m=new r.Triangle,v=new i.Vector3,_=new i.Vector3,D=new i.Vector3,f=new i.Vector3,l=new i.Vector3;function c(p,b,E,C){if(l.getPositionFromMatrix(p.matrixWorld),b.intersectionShape===void 0)return C;var g=b.intersectionShape,x=E.linePrecision;x*=p.matrixWorld.getMaxScaleOnAxis();var y=x*x;if(b.boundingSphere!==void 0&&b.boundingSphere instanceof r.Sphere&&(d.copy(b.boundingSphere),d.applyMatrix4(p.matrixWorld),!E.ray.isIntersectionSphere(d)))return C;var w,M,S,O,P,I,F,k,B,U,W,R,z,G;for(w=0,M=g.triangle.length;w<M;w++)if(g.triangle[w]instanceof r.Triangle){if(m.copy(g.triangle[w]),m.applyMatrix4(p.matrixWorld),S=m.getNormal(),O=E.ray.direction.dot(S),O>=0||(v.subVectors(m.a,E.ray.origin),F=S.dot(v)/O,F<0))continue;_.copy(E.ray.direction).multiplyScalar(F).add(E.ray.origin),_.sub(m.a),D.copy(m.b).sub(m.a),f.copy(m.c).sub(m.a);var q=D.dot(f),Q=D.lengthSq(),ne=f.lengthSq();if(R=(Q*_.dot(f)-q*_.dot(D))/(Q*ne-q*q),R<0||R>1||(W=(_.dot(D)-R*q)/Q,W<0||W>1||W+R>1))continue;C.push({clickable:b,distance:F})}for(w=0,M=g.cylinder.length;w<M;w++)if(g.cylinder[w]instanceof r.Cylinder){if(u.copy(g.cylinder[w]),u.applyMatrix4(p.matrixWorld),v.subVectors(u.c1,E.ray.origin),P=v.dot(u.direction),I=v.dot(E.ray.direction),O=h(E.ray.direction.dot(u.direction)),B=1-O*O,B===0)continue;z=(O*I-P)/B,G=(I-O*P)/B,_.copy(u.direction).multiplyScalar(z).add(u.c1),D.copy(E.ray.direction).multiplyScalar(G).add(E.ray.origin),k=f.subVectors(_,D).lengthSq();var te=u.radius*u.radius;if(k<=te){if(U=(O*P-I)*(O*P-I)-B*(v.lengthSq()-P*P-te),U<=0?R=F=Math.sqrt(k):R=F=(I-O*P-Math.sqrt(U))/B,W=O*R-P,W<0||W*W>u.lengthSq()||R<0)continue;C.push({clickable:b,distance:F})}}for(w=0,M=g.line.length;w<M;w+=2){_.copy(g.line[w]),_.applyMatrix4(p.matrixWorld),D.copy(g.line[w+1]),D.applyMatrix4(p.matrixWorld),f.subVectors(D,_);var oe=f.lengthSq();f.normalize(),v.subVectors(_,E.ray.origin);var re=v.dot(f);I=v.dot(E.ray.direction),O=h(E.ray.direction.dot(f)),B=1-O*O,B!==0&&(z=(O*I-re)/B,G=(I-O*re)/B,_.add(f.multiplyScalar(z)),D.copy(E.ray.direction).multiplyScalar(G).add(E.ray.origin),k=f.subVectors(D,_).lengthSq(),k<y&&z*z<oe&&C.push({clickable:b,distance:G}))}for(w=0,M=g.sphere.length;w<M;w++)if(g.sphere[w]instanceof r.Sphere&&(d.copy(g.sphere[w]),d.applyMatrix4(p.matrixWorld),E.ray.isIntersectionSphere(d))){_.subVectors(d.center,E.ray.origin);var le=_.dot(E.ray.direction);if(U=le*le-(_.lengthSq()-d.radius*d.radius),le<0)return C;U<=0?F=le:F=le-Math.sqrt(U),C.push({clickable:b,distance:F})}return C}},"./src/WebGL/core/Texture.ts":(n,e,t)=>{t.r(e),t.d(e,{Texture:()=>a,TextureIdCount:()=>h});var i=t("./src/WebGL/constants/TextureConstants.ts"),r=t("./src/WebGL/math/index.ts"),s=t("./src/WebGL/core/EventDispatcher.ts"),o=t("./src/WebGL/core/UVMapping.ts");class a extends s.EventDispatcher{constructor(u,m){super(),this.id=h++,this.name="",this.image=u,this.mapping=new o.UVMapping,this.wrapS=i.ClampToEdgeWrapping,this.wrapT=i.ClampToEdgeWrapping,this.anisotropy=1,m?(this.format=i.RFormat,this.type=i.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=i.NearestFilter,this.minFilter=i.NearestFilter):(this.format=i.RGBAFormat,this.type=i.UnsignedByteType,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=i.LinearFilter,this.minFilter=i.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(u=new a){return u.image=this.image,u.mapping=this.mapping,u.wrapS=this.wrapS,u.wrapT=this.wrapT,u.magFilter=this.magFilter,u.minFilter=this.minFilter,u.anisotropy=this.anisotropy,u.format=this.format,u.type=this.type,u.offset.copy(this.offset),u.repeat.copy(this.repeat),u.premultiplyAlpha=this.premultiplyAlpha,u.flipY=this.flipY,u.unpackAlignment=this.unpackAlignment,u}dispose(){this.dispatchEvent({type:"dispose"})}}let h=0},"./src/WebGL/core/UVMapping.ts":(n,e,t)=>{t.r(e),t.d(e,{UVMapping:()=>i});class i{}},"./src/WebGL/core/index.ts":(n,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>i.EventDispatcher,Geometry:()=>r.Geometry,GeometryGroup:()=>r.GeometryGroup,GeometryIDCount:()=>r.GeometryIDCount,Light:()=>s.Light,Object3D:()=>s.Object3D,Object3DIDCount:()=>s.Object3DIDCount,Projector:()=>o.Projector,Raycaster:()=>a.Raycaster,Scene:()=>s.Scene,Texture:()=>h.Texture,TextureIdCount:()=>h.TextureIdCount,UVMapping:()=>d.UVMapping,intersectObject:()=>a.intersectObject});var i=t("./src/WebGL/core/EventDispatcher.ts"),r=t("./src/WebGL/core/Geometry.ts"),s=t("./src/WebGL/core/Object3D.ts"),o=t("./src/WebGL/core/Projector.ts"),a=t("./src/WebGL/core/Raycaster.ts"),h=t("./src/WebGL/core/Texture.ts"),d=t("./src/WebGL/core/UVMapping.ts")},"./src/WebGL/index.ts":(n,e,t)=>{t.r(e),t.d(e,{BackSide:()=>i.BackSide,Camera:()=>u.Camera,ClampToEdgeWrapping:()=>i.ClampToEdgeWrapping,Coloring:()=>i.Coloring,Cylinder:()=>d.Cylinder,DoubleSide:()=>i.DoubleSide,EventDispatcher:()=>r.EventDispatcher,FloatType:()=>i.FloatType,Fog:()=>m.Fog,FrontSide:()=>i.FrontSide,Geometry:()=>r.Geometry,GeometryGroup:()=>r.GeometryGroup,GeometryIDCount:()=>r.GeometryIDCount,ImposterMaterial:()=>s.ImposterMaterial,InstancedMaterial:()=>s.InstancedMaterial,Light:()=>r.Light,Line:()=>a.Line,LineBasicMaterial:()=>s.LineBasicMaterial,LineStyle:()=>a.LineStyle,LinearFilter:()=>i.LinearFilter,LinearMipMapLinearFilter:()=>i.LinearMipMapLinearFilter,Material:()=>s.Material,MaterialIdCount:()=>s.MaterialIdCount,Matrix3:()=>o.Matrix3,Matrix4:()=>o.Matrix4,Mesh:()=>a.Mesh,MeshDoubleLambertMaterial:()=>s.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>s.MeshLambertMaterial,MeshOutlineMaterial:()=>s.MeshOutlineMaterial,NearestFilter:()=>i.NearestFilter,Object3D:()=>r.Object3D,Object3DIDCount:()=>r.Object3DIDCount,Projector:()=>r.Projector,Quaternion:()=>o.Quaternion,R32Format:()=>i.R32Format,RFormat:()=>i.RFormat,RGBAFormat:()=>i.RGBAFormat,Ray:()=>o.Ray,Raycaster:()=>r.Raycaster,Renderer:()=>v.Renderer,Scene:()=>r.Scene,ShaderLib:()=>h.ShaderLib,ShaderUtils:()=>h.ShaderUtils,Shading:()=>i.Shading,Sphere:()=>d.Sphere,SphereImposterMaterial:()=>s.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>s.SphereImposterOutlineMaterial,Sprite:()=>a.Sprite,SpriteAlignment:()=>i.SpriteAlignment,SpriteMaterial:()=>s.SpriteMaterial,SpritePlugin:()=>_.SpritePlugin,StickImposterMaterial:()=>s.StickImposterMaterial,StickImposterOutlineMaterial:()=>s.StickImposterOutlineMaterial,Texture:()=>r.Texture,TextureIdCount:()=>r.TextureIdCount,TextureOperations:()=>i.TextureOperations,Triangle:()=>d.Triangle,UVMapping:()=>r.UVMapping,UnsignedByteType:()=>i.UnsignedByteType,Vector2:()=>o.Vector2,Vector3:()=>o.Vector3,VolumetricMaterial:()=>s.VolumetricMaterial,basic:()=>h.basic,clamp:()=>o.clamp,clone:()=>h.clone,conversionMatrix3:()=>o.conversionMatrix3,degToRad:()=>o.degToRad,instanced:()=>h.instanced,intersectObject:()=>r.intersectObject,lambert:()=>h.lambert,lambertdouble:()=>h.lambertdouble,outline:()=>h.outline,screen:()=>h.screen,screenaa:()=>h.screenaa,sphereimposter:()=>h.sphereimposter,sphereimposteroutline:()=>h.sphereimposteroutline,sprite:()=>h.sprite,stickimposter:()=>h.stickimposter,stickimposteroutline:()=>h.stickimposteroutline,volumetric:()=>h.volumetric});var i=t("./src/WebGL/constants/index.ts"),r=t("./src/WebGL/core/index.ts"),s=t("./src/WebGL/materials/index.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/objects/index.ts"),h=t("./src/WebGL/shaders/index.ts"),d=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/Camera.ts"),m=t("./src/WebGL/Fog.ts"),v=t("./src/WebGL/Renderer.ts"),_=t("./src/WebGL/SpritePlugin.ts")},"./src/WebGL/materials/ImposterMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>h});var i=t("./src/WebGL/constants/Coloring.ts"),r=t("./src/WebGL/constants/Shading.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class h extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.ambient=new s.Color(1048575),this.emissive=new s.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new o.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=r.Shading.SmoothShading,this.shaderID=null,this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.setValues(u)}clone(u=new h){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u}}},"./src/WebGL/materials/InstancedMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{InstancedMaterial:()=>h});var i=t("./src/WebGL/constants/Coloring.ts"),r=t("./src/WebGL/constants/Shading.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class h extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.ambient=new s.Color(1048575),this.emissive=new s.Color(0),this.wrapAround=!1,this.wrapRGB=new o.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=r.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(u)}clone(u=new h){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u.sphere=this.sphere,u}}},"./src/WebGL/materials/LineBasicMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{LineBasicMaterial:()=>s});var i=t("./src/colors.ts"),r=t("./src/WebGL/materials/Material.ts");class s extends r.Material{constructor(a){super(),this.color=new i.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.color.copy(this.color),a}}},"./src/WebGL/materials/Material.ts":(n,e,t)=>{t.r(e),t.d(e,{Material:()=>a,MaterialIdCount:()=>h});var i=t("./src/WebGL/constants/Sides.ts"),r=t("./src/WebGL/core/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts");class a extends r.EventDispatcher{constructor(){super(...arguments),this.id=h++,this.name="",this.side=i.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(u={}){if(u!==void 0)for(var m in u){var v=u[m];if(v===void 0){console.warn("$3Dmol.Material: '"+m+"' parameter is undefined.");continue}if(m in this){var _=this[m];_ instanceof o.Color&&v instanceof o.Color?_.copy(v):_ instanceof o.Color?_.set(v):_ instanceof s.Vector3&&v instanceof s.Vector3?_.copy(v):this[m]=v}}}clone(u=new a){return u.name=this.name,u.side=this.side,u.opacity=this.opacity,u.transparent=this.transparent,u.depthTest=this.depthTest,u.depthWrite=this.depthWrite,u.polygonOffset=this.polygonOffset,u.polygonOffsetFactor=this.polygonOffsetFactor,u.polygonOffsetUnits=this.polygonOffsetUnits,u.alphaTest=this.alphaTest,u.overdraw=this.overdraw,u.visible=this.visible,u}makeShaded(u){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:u},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let h=0},"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{MeshDoubleLambertMaterial:()=>s});var i=t("./src/WebGL/constants/Sides.ts"),r=t("./src/WebGL/materials/MeshLambertMaterial.ts");class s extends r.MeshLambertMaterial{constructor(a){super(a),this.shaderID="lambertdouble",this.side=i.DoubleSide,this.outline=!1}clone(a=new s){return super.clone.call(this,a),a}}},"./src/WebGL/materials/MeshLambertMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{MeshLambertMaterial:()=>h});var i=t("./src/WebGL/constants/Coloring.ts"),r=t("./src/WebGL/constants/Shading.ts"),s=t("./src/WebGL/materials/Material.ts"),o=t("./src/colors.ts"),a=t("./src/WebGL/math/index.ts");class h extends s.Material{constructor(u){super(),this.color=new o.Color(16777215),this.ambient=new o.Color(1048575),this.emissive=new o.Color(0),this.wrapAround=!1,this.wrapRGB=new a.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=r.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.setValues(u)}clone(u=new h){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u}}},"./src/WebGL/materials/MeshOutlineMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{MeshOutlineMaterial:()=>s});var i=t("./src/colors.ts"),r=t("./src/WebGL/materials/Material.ts");class s extends r.Material{constructor(a){super(),a=a||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=i.CC.color(a.color||new i.Color(0,0,0)),this.outlineWidth=a.width||.1,this.outlinePushback=a.pushback||1,this.outlineMaxPixels=a.maxpixels||0}clone(a=new s){return super.clone.call(this,a),a.fog=this.fog,a.shaderID=this.shaderID,a.wireframe=this.wireframe,a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/SphereImposterMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{SphereImposterMaterial:()=>r});var i=t("./src/WebGL/materials/ImposterMaterial.ts");class r extends i.ImposterMaterial{constructor(o){super(o),this.shaderID="sphereimposter",this.setValues(o)}clone(o=new r){return super.clone.call(this,o),o}}},"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{SphereImposterOutlineMaterial:()=>s});var i=t("./src/colors.ts"),r=t("./src/WebGL/materials/ImposterMaterial.ts");class s extends r.ImposterMaterial{constructor(a){super(a),a=a||{},this.shaderID="sphereimposteroutline",this.outlineColor=i.CC.color(a.color||new i.Color(0,0,0)),this.outlineWidth=a.width||.1,this.outlinePushback=a.pushback||1,this.outlineMaxPixels=a.maxpixels||0,this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/SpriteMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{SpriteMaterial:()=>h});var i=t("./src/WebGL/constants/SpriteAlignment.ts"),r=t("./src/WebGL/core/Texture.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class h extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.map=new r.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new o.Vector2(0,0),this.uvScale=new o.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=i.SpriteAlignment.center.clone(),this.setValues(u),u=u||{},u.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),u.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),u.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(u=new h){return super.clone.call(this,u),u.color.copy(this.color),u.map=this.map,u.useScreenCoordinates=this.useScreenCoordinates,u.screenOffset=this.screenOffset,u.sizeAttenuation=this.sizeAttenuation,u.scaleByViewport=this.scaleByViewPort,u.alignment.copy(this.alignment),u.uvOffset.copy(this.uvOffset),u}}},"./src/WebGL/materials/StickImposterMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{StickImposterMaterial:()=>r});var i=t("./src/WebGL/materials/ImposterMaterial.ts");class r extends i.ImposterMaterial{constructor(o){super(o),this.shaderID="stickimposter",this.setValues(o)}clone(o=new r){return super.clone.call(this,o),o}}},"./src/WebGL/materials/StickImposterOutlineMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{StickImposterOutlineMaterial:()=>s});var i=t("./src/colors.ts"),r=t("./src/WebGL/materials/ImposterMaterial.ts");class s extends r.ImposterMaterial{constructor(a={}){super(a),this.shaderID="stickimposteroutline",this.outlineColor=new i.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,a.color&&(this.outlineColor=i.CC.color(a.color)),a.width&&(this.outlineWidth=a.width),a.pushback&&(this.outlinePushback=a.pushback),a.maxpixels&&(this.outlineMaxPixels=a.maxpixels),this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/VolumetricMaterial.ts":(n,e,t)=>{t.r(e),t.d(e,{VolumetricMaterial:()=>o});var i=t("./src/WebGL/constants/Sides.ts"),r=t("./src/colors.ts"),s=t("./src/WebGL/materials/Material.ts");class o extends s.Material{constructor(h){super(),this.transparent=!1,this.volumetric=!0,this.color=new r.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=i.FrontSide,this.setValues(h)}clone(h=new o){return super.clone.call(this,h),h.transparent=this.transparent,h.volumetric=this.volumetric,h.color=this.color,h.transferfn=this.transferfn,h.map=this.map,h.extent=this.extent,h.maxdepth=this.maxdepth,h.unit=this.unit,h.texmatrix=this.texmatrix,h.transfermin=this.transfermin,h.transfermax=this.transfermax,h.subsamples=this.subsamples,h.shaderID=this.shaderID,h.side=this.side,h}}},"./src/WebGL/materials/index.ts":(n,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>i.ImposterMaterial,InstancedMaterial:()=>r.InstancedMaterial,LineBasicMaterial:()=>s.LineBasicMaterial,Material:()=>o.Material,MaterialIdCount:()=>o.MaterialIdCount,MeshDoubleLambertMaterial:()=>a.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>h.MeshLambertMaterial,MeshOutlineMaterial:()=>d.MeshOutlineMaterial,SphereImposterMaterial:()=>u.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>m.SphereImposterOutlineMaterial,SpriteMaterial:()=>v.SpriteMaterial,StickImposterMaterial:()=>_.StickImposterMaterial,StickImposterOutlineMaterial:()=>D.StickImposterOutlineMaterial,VolumetricMaterial:()=>f.VolumetricMaterial});var i=t("./src/WebGL/materials/ImposterMaterial.ts"),r=t("./src/WebGL/materials/InstancedMaterial.ts"),s=t("./src/WebGL/materials/LineBasicMaterial.ts"),o=t("./src/WebGL/materials/Material.ts"),a=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),h=t("./src/WebGL/materials/MeshLambertMaterial.ts"),d=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),u=t("./src/WebGL/materials/SphereImposterMaterial.ts"),m=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),v=t("./src/WebGL/materials/SpriteMaterial.ts"),_=t("./src/WebGL/materials/StickImposterMaterial.ts"),D=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),f=t("./src/WebGL/materials/VolumetricMaterial.ts")},"./src/WebGL/math/Quaternion.ts":(n,e,t)=>{t.r(e),t.d(e,{Quaternion:()=>i});class i{constructor(s,o,a,h){this.x=s||0,this.y=o||0,this.z=a||0,this.w=h!==void 0?h:1}set(s,o,a,h){return this.x=s,this.y=o,this.z=a,this.w=h,this}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let s=this.length();return s===0?(this.x=0,this.y=0,this.z=0,this.w=1):(s=1/s,this.x*=s,this.y*=s,this.z*=s,this.w*=s),this}multiply(s){return this.multiplyQuaternions(this,s)}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}multiplyQuaternions(s,o){const a=s.x,h=s.y,d=s.z,u=s.w,m=o.x,v=o.y,_=o.z,D=o.w;return this.x=a*D+u*m+h*_-d*v,this.y=h*D+u*v+d*m-a*_,this.z=d*D+u*_+a*v-h*m,this.w=u*D-a*m-h*v-d*_,this}sub(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this.w-=s.w,this}clone(){return new i(this.x,this.y,this.z,this.w)}setFromEuler(s){const o=Math.cos(s.x/2),a=Math.cos(s.y/2),h=Math.cos(s.z/2),d=Math.sin(s.x/2),u=Math.sin(s.y/2),m=Math.sin(s.z/2);return this.x=d*a*h+o*u*m,this.y=o*u*h-d*a*m,this.z=o*a*m+d*u*h,this.w=o*a*h-d*u*m,this}}},"./src/WebGL/math/Vector2.ts":(n,e,t)=>{t.r(e),t.d(e,{Vector2:()=>i});class i{constructor(s,o){this.x=s||0,this.y=o||0}set(s,o){return this.x=s,this.y=o,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this}copy(s){return this.x=s.x,this.y=s.y,this}clone(){return new i(this.x,this.y)}}},"./src/WebGL/math/index.ts":(n,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>h.Matrix3,Matrix4:()=>h.Matrix4,Quaternion:()=>i.Quaternion,Ray:()=>h.Ray,Vector2:()=>r.Vector2,Vector3:()=>h.Vector3,clamp:()=>s.clamp,conversionMatrix3:()=>o.conversionMatrix3,degToRad:()=>a.degToRad});var i=t("./src/WebGL/math/Quaternion.ts"),r=t("./src/WebGL/math/Vector2.ts"),s=t("./src/WebGL/math/utils/clamp.ts"),o=t("./src/WebGL/math/utils/conversionMatrix3.ts"),a=t("./src/WebGL/math/utils/degToRad.ts"),h=t("./src/WebGL/math/math.ts")},"./src/WebGL/math/math.ts":(n,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>v,Matrix4:()=>u,Ray:()=>_,Vector3:()=>m});var i=t("./src/WebGL/math/utils/degToRad.ts"),r=t("./src/WebGL/math/utils/clamp.ts"),s,o,a,h,d;class u{constructor(f=1,l=0,c=0,p=0,b=0,E=1,C=0,g=0,x=0,y=0,w=1,M=0,S=0,O=0,P=0,I=1){typeof f<"u"&&typeof f!="number"?this.elements=new Float32Array(f):(this.elements=new Float32Array(16),this.elements[0]=f,this.elements[4]=l,this.elements[8]=c,this.elements[12]=p,this.elements[1]=b,this.elements[5]=E,this.elements[9]=C,this.elements[13]=g,this.elements[2]=x,this.elements[6]=y,this.elements[10]=w,this.elements[14]=M,this.elements[3]=S,this.elements[7]=O,this.elements[11]=P,this.elements[15]=I)}makeScale(f,l,c){throw new Error("Method not implemented.")}set(f,l,c,p,b,E,C,g,x,y,w,M,S,O,P,I){const F=this.elements;return F[0]=f,F[4]=l,F[8]=c,F[12]=p,F[1]=b,F[5]=E,F[9]=C,F[13]=g,F[2]=x,F[6]=y,F[10]=w,F[14]=M,F[3]=S,F[7]=O,F[11]=P,F[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(f){const l=f.elements;return this.set(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15]),this}matrix3FromTopLeft(){const f=this.elements;return new v(f[0],f[4],f[8],f[1],f[5],f[9],f[2],f[6],f[10])}setRotationFromEuler(f,l){const c=this.elements,{x:p,y:b,z:E}=f,C=Math.cos(p),g=Math.sin(p),x=Math.cos(b),y=Math.sin(b),w=Math.cos(E),M=Math.sin(E);if(l===void 0||l==="XYZ"){const S=C*w,O=C*M,P=g*w,I=g*M;c[0]=x*w,c[4]=-x*M,c[8]=y,c[1]=O+P*y,c[5]=S-I*y,c[9]=-g*x,c[2]=I-S*y,c[6]=P+O*y,c[10]=C*x}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${l}`);return this}setRotationFromQuaternion(f){const l=this.elements,{x:c,y:p,z:b,w:E}=f,C=c+c,g=p+p,x=b+b,y=c*C,w=c*g,M=c*x,S=p*g,O=p*x,P=b*x,I=E*C,F=E*g,k=E*x;return l[0]=1-(S+P),l[4]=w-k,l[8]=M+F,l[1]=w+k,l[5]=1-(y+P),l[9]=O-I,l[2]=M-F,l[6]=O+I,l[10]=1-(y+S),this}multiplyMatrices(f,l){const c=f.elements,p=l.elements,b=this.elements,E=c[0],C=c[4],g=c[8],x=c[12],y=c[1],w=c[5],M=c[9],S=c[13],O=c[2],P=c[6],I=c[10],F=c[14],k=c[3],B=c[7],U=c[11],W=c[15],R=p[0],z=p[4],G=p[8],q=p[12],Q=p[1],ne=p[5],te=p[9],oe=p[13],re=p[2],le=p[6],Ce=p[10],De=p[14],Oe=p[3],_e=p[7],Z=p[11],xe=p[15];return b[0]=E*R+C*Q+g*re+x*Oe,b[4]=E*z+C*ne+g*le+x*_e,b[8]=E*G+C*te+g*Ce+x*Z,b[12]=E*q+C*oe+g*De+x*xe,b[1]=y*R+w*Q+M*re+S*Oe,b[5]=y*z+w*ne+M*le+S*_e,b[9]=y*G+w*te+M*Ce+S*Z,b[13]=y*q+w*oe+M*De+S*xe,b[2]=O*R+P*Q+I*re+F*Oe,b[6]=O*z+P*ne+I*le+F*_e,b[10]=O*G+P*te+I*Ce+F*Z,b[14]=O*q+P*oe+I*De+F*xe,b[3]=k*R+B*Q+U*re+W*Oe,b[7]=k*z+B*ne+U*le+W*_e,b[11]=k*G+B*te+U*Ce+W*Z,b[15]=k*q+B*oe+U*De+W*xe,this}multiplyScalar(f){const l=this.elements;return l[0]*=f,l[4]*=f,l[8]*=f,l[12]*=f,l[1]*=f,l[5]*=f,l[9]*=f,l[13]*=f,l[2]*=f,l[6]*=f,l[10]*=f,l[14]*=f,l[3]*=f,l[7]*=f,l[11]*=f,l[15]*=f,this}makeTranslation(f,l,c){return this.set(1,0,0,f,0,1,0,l,0,0,1,c,0,0,0,1),this}snap(f){const l=Math.pow(10,4),c=this.elements;for(let p=0;p<16;p++){const b=Math.round(c[p]);b===Math.round(c[p]*l)/l&&(c[p]=b)}return this}transpose(){const f=this.elements;let l;return l=f[1],f[1]=f[4],f[4]=l,l=f[2],f[2]=f[8],f[8]=l,l=f[6],f[6]=f[9],f[9]=l,l=f[3],f[3]=f[12],f[12]=l,l=f[7],f[7]=f[13],f[13]=l,l=f[11],f[11]=f[14],f[14]=l,this}setPosition(f){const l=this.elements;return l[12]=f.x,l[13]=f.y,l[14]=f.z,this}translate(f){const l=this.elements;return l[12]+=f.x,l[13]+=f.y,l[14]+=f.z,this}getInverse(f,l){const c=this.elements,p=f.elements,b=p[0],E=p[4],C=p[8],g=p[12],x=p[1],y=p[5],w=p[9],M=p[13],S=p[2],O=p[6],P=p[10],I=p[14],F=p[3],k=p[7],B=p[11],U=p[15];c[0]=w*I*k-M*P*k+M*O*B-y*I*B-w*O*U+y*P*U,c[4]=g*P*k-C*I*k-g*O*B+E*I*B+C*O*U-E*P*U,c[8]=C*M*k-g*w*k+g*y*B-E*M*B-C*y*U+E*w*U,c[12]=g*w*O-C*M*O-g*y*P+E*M*P+C*y*I-E*w*I,c[1]=M*P*F-w*I*F-M*S*B+x*I*B+w*S*U-x*P*U,c[5]=C*I*F-g*P*F+g*S*B-b*I*B-C*S*U+b*P*U,c[9]=g*w*F-C*M*F-g*x*B+b*M*B+C*x*U-b*w*U,c[13]=C*M*S-g*w*S+g*x*P-b*M*P-C*x*I+b*w*I,c[2]=y*I*F-M*O*F+M*S*k-x*I*k-y*S*U+x*O*U,c[6]=g*O*F-E*I*F-g*S*k+b*I*k+E*S*U-b*O*U,c[10]=E*M*F-g*y*F+g*x*k-b*M*k-E*x*U+b*y*U,c[14]=g*y*S-E*M*S-g*x*O+b*M*O+E*x*I-b*y*I,c[3]=w*O*F-y*P*F-w*S*k+x*P*k+y*S*B-x*O*B,c[7]=E*P*F-C*O*F+C*S*k-b*P*k-E*S*B+b*O*B,c[11]=C*y*F-E*w*F-C*x*k+b*w*k+E*x*B-b*y*B,c[15]=E*w*S-C*y*S+C*x*O-b*w*O-E*x*P+b*y*P;const W=b*c[0]+x*c[4]+S*c[8]+F*c[12];if(W===0){const R="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(l)throw new Error(R);return console.warn(R),this.identity(),this}return this.multiplyScalar(1/W),this}isReflected(){const f=this.elements,l=f[0],c=f[4],p=f[8],b=f[1],E=f[5],C=f[9],g=f[2],x=f[6],y=f[10];return l*E*y+b*x*p+g*c*C-g*E*p-b*c*y-l*x*C<0}scale(f){const l=this.elements,{x:c}=f,{y:p}=f,{z:b}=f;return l[0]*=c,l[4]*=p,l[8]*=b,l[1]*=c,l[5]*=p,l[9]*=b,l[2]*=c,l[6]*=p,l[10]*=b,l[3]*=c,l[7]*=p,l[11]*=b,this}getMaxScaleOnAxis(){const f=this.elements,l=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],c=f[4]*f[4]+f[5]*f[5]+f[6]*f[6],p=f[8]*f[8]+f[9]*f[9]+f[10]*f[10];return Math.sqrt(Math.max(l,Math.max(c,p)))}makeFrustum(f,l,c,p,b,E){const C=this.elements,g=2*b/(l-f),x=2*b/(p-c),y=(l+f)/(l-f),w=(p+c)/(p-c),M=-(E+b)/(E-b),S=-2*E*b/(E-b);return C[0]=g,C[4]=0,C[8]=y,C[12]=0,C[1]=0,C[5]=x,C[9]=w,C[13]=0,C[2]=0,C[6]=0,C[10]=M,C[14]=S,C[3]=0,C[7]=0,C[11]=-1,C[15]=0,this}makePerspective(f,l,c,p){const b=c*Math.tan((0,i.degToRad)(f*.5)),E=-b,C=E*l,g=b*l;return this.makeFrustum(C,g,E,b,c,p)}makeOrthographic(f,l,c,p,b,E){const C=this.elements,g=1/(l-f),x=1/(c-p),y=1/(E-b),w=(l+f)*g,M=(c+p)*x,S=(E+b)*y;return C[0]=2*g,C[4]=0,C[8]=0,C[12]=-w,C[1]=0,C[5]=2*x,C[9]=0,C[13]=-M,C[2]=0,C[6]=0,C[10]=-2*y,C[14]=-S,C[3]=0,C[7]=0,C[11]=0,C[15]=1,this}isEqual(f){const l=f.elements,c=this.elements;return c[0]===l[0]&&c[4]===l[4]&&c[8]===l[8]&&c[12]===l[12]&&c[1]===l[1]&&c[5]===l[5]&&c[9]===l[9]&&c[13]===l[13]&&c[2]===l[2]&&c[6]===l[6]&&c[10]===l[10]&&c[14]===l[14]&&c[3]===l[3]&&c[7]===l[7]&&c[11]===l[11]&&c[15]===l[15]}clone(){const f=this.elements;return new u(f[0],f[4],f[8],f[12],f[1],f[5],f[9],f[13],f[2],f[6],f[10],f[14],f[3],f[7],f[11],f[15])}isIdentity(){const f=this.elements;return f[0]===1&&f[4]===0&&f[8]===0&&f[12]===0&&f[1]===0&&f[5]===1&&f[9]===0&&f[13]===0&&f[2]===0&&f[6]===0&&f[10]===1&&f[14]===0&&f[3]===0&&f[7]===0&&f[11]===0&&f[15]===1}isNearlyIdentity(f){return this.clone().snap(f).isIdentity()}getScale(f){const l=this.elements;return f=f||new m,a.set(l[0],l[1],l[2]),h.set(l[4],l[5],l[6]),d.set(l[8],l[9],l[10]),f.x=a.length(),f.y=h.length(),f.z=d.length(),f}lookAt(f,l,c){const p=this.elements;return d.subVectors(f,l).normalize(),d.length()===0&&(d.z=1),a.crossVectors(c,d).normalize(),a.length()===0&&(d.x+=1e-4,a.crossVectors(c,d).normalize()),h.crossVectors(d,a),p[0]=a.x,p[4]=h.x,p[8]=d.x,p[1]=a.y,p[5]=h.y,p[9]=d.y,p[2]=a.z,p[6]=h.z,p[10]=d.z,this}compose(f,l,c){const p=this.elements;return s.identity(),s.setRotationFromQuaternion(l),o.makeScale(c.x,c.y,c.z),this.multiplyMatrices(s,o),p[12]=f.x,p[13]=f.y,p[14]=f.z,this}}s=new u,o=new u;class m{constructor(f,l,c){this.x=f||0,this.y=l||0,this.z=c||0,this.atomid=void 0}set(f,l,c){return this.x=f,this.y=l,this.z=c,this}copy(f){return this.x=f.x,this.y=f.y,this.z=f.z,this}add(f){return this.x+=f.x,this.y+=f.y,this.z+=f.z,this}addVectors(f,l){return this.x=f.x+l.x,this.y=f.y+l.y,this.z=f.z+l.z,this}multiplyVectors(f,l){return this.x=f.x*l.x,this.y=f.y*l.y,this.z=f.z*l.z,this}sub(f){return this.x-=f.x,this.y-=f.y,this.z-=f.z,this}subVectors(f,l){return this.x=f.x-l.x,this.y=f.y-l.y,this.z=f.z-l.z,this}multiplyScalar(f){return this.x*=f,this.y*=f,this.z*=f,this}divideScalar(f){return f!==0?(this.x/=f,this.y/=f,this.z/=f):(this.x=0,this.y=0,this.z=0),this}max(f){return this.x=Math.max(this.x,f.x),this.y=Math.max(this.y,f.y),this.z=Math.max(this.z,f.z),this}min(f){return this.x=Math.min(this.x,f.x),this.y=Math.min(this.y,f.y),this.z=Math.min(this.z,f.z),this}distanceTo(f){return Math.sqrt(this.distanceToSquared(f))}distanceToSquared(f){const l=this.x-f.x,c=this.y-f.y,p=this.z-f.z;return l*l+c*c+p*p}applyMatrix3(f){const{x:l}=this,{y:c}=this,{z:p}=this,b=f.elements;return this.x=b[0]*l+b[3]*c+b[6]*p,this.y=b[1]*l+b[4]*c+b[7]*p,this.z=b[2]*l+b[5]*c+b[8]*p,this}applyMatrix4(f){const{x:l}=this,{y:c}=this,{z:p}=this,b=f.elements;return this.x=b[0]*l+b[4]*c+b[8]*p+b[12],this.y=b[1]*l+b[5]*c+b[9]*p+b[13],this.z=b[2]*l+b[6]*c+b[10]*p+b[14],this}applyProjection(f){const{x:l}=this,{y:c}=this,{z:p}=this,b=f.elements,E=b[3]*l+b[7]*c+b[11]*p+b[15];return this.x=(b[0]*l+b[4]*c+b[8]*p+b[12])/E,this.y=(b[1]*l+b[5]*c+b[9]*p+b[13])/E,this.z=(b[2]*l+b[6]*c+b[10]*p+b[14])/E,this}applyQuaternion(f){const{x:l}=this,{y:c}=this,{z:p}=this,b=f.x,E=f.y,C=f.z,g=f.w,x={};x.x=2*(c*C-p*E),x.y=2*(p*b-l*C),x.z=2*(l*E-c*b);const y={};return y.x=x.y*C-x.z*E,y.y=x.z*b-x.x*C,y.z=x.x*E-x.y*b,this.x=l+g*x.x+y.x,this.y=c+g*x.y+y.y,this.z=p+g*x.z+y.z,this}negate(){return this.multiplyScalar(-1)}dot(f){return this.x*f.x+this.y*f.y+this.z*f.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(f){const{x:l}=this,{y:c}=this,{z:p}=this;return this.x=c*f.z-p*f.y,this.y=p*f.x-l*f.z,this.z=l*f.y-c*f.x,this}crossVectors(f,l){return this.x=f.y*l.z-f.z*l.y,this.y=f.z*l.x-f.x*l.z,this.z=f.x*l.y-f.y*l.x,this}equals(f){return this.x==f.x&&this.y==f.y&&this.z==f.z}getPositionFromMatrix(f){return this.x=f.elements[12],this.y=f.elements[13],this.z=f.elements[14],this}setEulerFromRotationMatrix(f,l){const c=f.elements,p=c[0],b=c[4],E=c[8],C=c[5],g=c[9],x=c[6],y=c[10];return l===void 0||l==="XYZ"?(this.y=Math.asin((0,r.clamp)(E,-1,1)),Math.abs(E)<.99999?(this.x=Math.atan2(-g,y),this.z=Math.atan2(-b,p)):(this.x=Math.atan2(x,C),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${l}`),this}rotateAboutVector(f,l){f.normalize();const c=Math.cos(l),p=Math.sin(l),b=this.clone().multiplyScalar(c),E=f.clone().cross(this).multiplyScalar(p),C=f.clone().multiplyScalar(f.clone().dot(this)).multiplyScalar(1-c),g=b.add(E).add(C);return this.x=g.x,this.y=g.y,this.z=g.z,this}setFromMatrixPosition(f){const l=f.elements;return this.x=l[12],this.y=l[13],this.z=l[14],this}transformDirection(f){const{x:l}=this,{y:c}=this,{z:p}=this,b=f.elements;return this.x=b[0]*l+b[4]*c+b[8]*p,this.y=b[1]*l+b[5]*c+b[9]*p,this.z=b[2]*l+b[6]*c+b[10]*p,this.normalize()}clone(){return new m(this.x,this.y,this.z)}unproject(f){const l=s;return l.multiplyMatrices(f.matrixWorld,l.getInverse(f.projectionMatrix)),this.applyMatrix4(l)}}a=new m,h=new m,d=new m;class v{constructor(f=1,l=0,c=0,p=0,b=1,E=0,C=0,g=0,x=1){this.elements=new Float32Array(9),this.set(f,l,c,p,b,E,C,g,x)}set(f,l,c,p,b,E,C,g,x){const y=this.elements;return y[0]=f,y[3]=l,y[6]=c,y[1]=p,y[4]=b,y[7]=E,y[2]=C,y[5]=g,y[8]=x,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(f){const l=f.elements;this.set(l[0],l[3],l[6],l[1],l[4],l[7],l[2],l[5],l[8])}multiplyScalar(f){const l=this.elements;return l[0]*=f,l[3]*=f,l[6]*=f,l[1]*=f,l[4]*=f,l[7]*=f,l[2]*=f,l[5]*=f,l[8]*=f,this}getInverse3(f){const l=f.elements,c=this.elements;c[0]=l[4]*l[8]-l[5]*l[7],c[3]=l[6]*l[5]-l[3]*l[8],c[6]=l[3]*l[7]-l[6]*l[4],c[1]=l[7]*l[2]-l[1]*l[8],c[4]=l[0]*l[8]-l[6]*l[2],c[7]=l[1]*l[6]-l[0]*l[7],c[2]=l[1]*l[5]-l[2]*l[4],c[5]=l[2]*l[3]-l[0]*l[5],c[8]=l[0]*l[4]-l[1]*l[3];const p=l[0]*c[0]+l[3]*c[1]+l[6]*c[2];return this.multiplyScalar(1/p),this}getInverse(f,l){const c=f.elements,p=this.elements;p[0]=c[10]*c[5]-c[6]*c[9],p[1]=-c[10]*c[1]+c[2]*c[9],p[2]=c[6]*c[1]-c[2]*c[5],p[3]=-c[10]*c[4]+c[6]*c[8],p[4]=c[10]*c[0]-c[2]*c[8],p[5]=-c[6]*c[0]+c[2]*c[4],p[6]=c[9]*c[4]-c[5]*c[8],p[7]=-c[9]*c[0]+c[1]*c[8],p[8]=c[5]*c[0]-c[1]*c[4];const b=c[0]*p[0]+c[1]*p[3]+c[2]*p[6];if(b===0){const E="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(l)throw new Error(E);return console.warn(E),this.identity(),this}return this.multiplyScalar(1/b),this}getDeterminant(){const f=this.elements;return f[0]*f[4]*f[8]+f[1]*f[5]*f[6]+f[2]*f[3]*f[7]-f[2]*f[4]*f[6]-f[1]*f[3]*f[8]-f[0]*f[5]*f[7]}transpose(){let f;const l=this.elements;return f=l[1],l[1]=l[3],l[3]=f,f=l[2],l[2]=l[6],l[6]=f,f=l[5],l[5]=l[7],l[7]=f,this}clone(){const f=this.elements;return new v(f[0],f[3],f[6],f[1],f[4],f[7],f[2],f[5],f[8])}getMatrix4(){const f=this.elements;return new u(f[0],f[3],f[6],0,f[1],f[4],f[7],0,f[2],f[5],f[8],0)}}class _{constructor(f,l){this.origin=f!==void 0?f:new m,this.direction=l!==void 0?l:new m}set(f,l){return this.origin.copy(f),this.direction.copy(l),this}copy(f){return this.origin.copy(f.origin),this.direction.copy(f.direction),this}at(f,l){return(l||new m).copy(this.direction).multiplyScalar(f).add(this.origin)}recast(f){const l=a;return this.origin.copy(this.at(f,l)),this}closestPointToPoint(f,l){const c=l||new m;c.subVectors(f,this.origin);const p=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(p).add(this.origin)}distanceToPoint(f){const l=a,c=l.subVectors(f,this.origin).dot(this.direction);return l.copy(this.direction).multiplyScalar(c).add(this.origin),l.distanceTo(f)}isIntersectionCylinder(){}isIntersectionSphere(f){return this.distanceToPoint(f.center)<=f.radius}isIntersectionPlane(f){return f.normal.dot(this.direction)!==0||f.distanceToPoint(this.origin)===0}distanceToPlane(f){const l=f.normal.dot(this.direction);return l===0?f.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(f.normal)+f.constant)/l}intersectPlane(f,l){const c=this.distanceToPlane(f);if(c!==void 0)return this.at(c,l)}applyMatrix4(f){return this.direction.add(this.origin).applyMatrix4(f),this.origin.applyMatrix4(f),this.direction.sub(this.origin),this}clone(){return new _().copy(this)}}},"./src/WebGL/math/utils/clamp.ts":(n,e,t)=>{t.r(e),t.d(e,{clamp:()=>i});function i(r,s,o){return Math.min(Math.max(r,s),o)}},"./src/WebGL/math/utils/conversionMatrix3.ts":(n,e,t)=>{t.r(e),t.d(e,{conversionMatrix3:()=>r});var i=t("./src/WebGL/math/math.ts");function r(s,o,a,h,d,u){h=h*Math.PI/180,d=d*Math.PI/180,u=u*Math.PI/180;const m=c=>c*c,v=Math.cos(h),_=Math.cos(d),D=Math.cos(u),f=Math.sin(u);return new i.Matrix3(s,o*D,a*_,0,o*f,a*(v-_*D)/f,0,0,a*Math.sqrt(1-m(v)-m(_)-m(D)+2*v*_*D)/f)}},"./src/WebGL/math/utils/degToRad.ts":(n,e,t)=>{t.r(e),t.d(e,{degToRad:()=>r});const i=Math.PI/180;function r(s){return s*i}},"./src/WebGL/objects/Line.ts":(n,e,t)=>{t.r(e),t.d(e,{Line:()=>o,LineStyle:()=>s});var i=t("./src/WebGL/materials/index.ts"),r=t("./src/WebGL/core/index.ts"),s;(function(a){a[a.LineStrip=0]="LineStrip",a[a.LinePieces=1]="LinePieces"})(s||(s={}));class o extends r.Object3D{constructor(h,d=new i.LineBasicMaterial({color:Math.random()*16777215}),u=s.LineStrip){super(),this.geometry=h,this.material=d,this.type=u}clone(h=new o(this.geometry,this.material,this.type)){return super.clone.call(this,h),h}}},"./src/WebGL/objects/Mesh.ts":(n,e,t)=>{t.r(e),t.d(e,{Mesh:()=>r});var i=t("./src/WebGL/core/index.ts");class r extends i.Object3D{constructor(o,a){super(),this.geometry=o,this.material=a}clone(o){return o===void 0&&(o=new r(this.geometry,this.material)),super.clone.call(this,o),o}}},"./src/WebGL/objects/Sprite.ts":(n,e,t)=>{t.r(e),t.d(e,{Sprite:()=>s});var i=t("./src/WebGL/materials/index.ts"),r=t("./src/WebGL/core/index.ts");class s extends r.Object3D{constructor(a=new i.SpriteMaterial){super(),this.material=a,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(a=new s(this.material)){return r.Object3D.prototype.clone.call(this,a),a}}},"./src/WebGL/objects/index.ts":(n,e,t)=>{t.r(e),t.d(e,{Line:()=>i.Line,LineStyle:()=>i.LineStyle,Mesh:()=>r.Mesh,Sprite:()=>s.Sprite});var i=t("./src/WebGL/objects/Line.ts"),r=t("./src/WebGL/objects/Mesh.ts"),s=t("./src/WebGL/objects/Sprite.ts")},"./src/WebGL/shaders/ShaderType.ts":(n,e,t)=>{t.r(e)},"./src/WebGL/shaders/index.ts":(n,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>i.ShaderLib,ShaderUtils:()=>r.ShaderUtils,basic:()=>i.basic,clone:()=>r.clone,instanced:()=>i.instanced,lambert:()=>i.lambert,lambertdouble:()=>i.lambertdouble,outline:()=>i.outline,screen:()=>i.screen,screenaa:()=>i.screenaa,sphereimposter:()=>i.sphereimposter,sphereimposteroutline:()=>i.sphereimposteroutline,sprite:()=>i.sprite,stickimposter:()=>i.stickimposter,stickimposteroutline:()=>i.stickimposteroutline,volumetric:()=>i.volumetric});var i=t("./src/WebGL/shaders/lib/index.ts"),r=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")},"./src/WebGL/shaders/lib/basic/basic.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/basic/basic.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`},"./src/WebGL/shaders/lib/basic/index.ts":(n,e,t)=>{t.r(e),t.d(e,{basic:()=>o});var i=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),r=t("./src/WebGL/shaders/lib/basic/basic.frag"),s=t("./src/WebGL/shaders/lib/basic/basic.vert");const o={vertexShader:s.default.replace("#define GLSLIFY 1",""),fragmentShader:r.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/basic/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}},"./src/WebGL/shaders/lib/blur/blur.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`},"./src/WebGL/shaders/lib/blur/blur.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/blur/index.ts":(n,e,t)=>{t.r(e),t.d(e,{blur:()=>o});var i=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),r=t("./src/WebGL/shaders/lib/blur/blur.frag"),s=t("./src/WebGL/shaders/lib/blur/blur.vert");const o={fragmentShader:r.default,vertexShader:s.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/blur/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/index.ts":(n,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>p,basic:()=>i.basic,instanced:()=>r.instanced,lambert:()=>s.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>a.outline,screen:()=>h.screen,screenaa:()=>d.screenaa,sphereimposter:()=>u.sphereimposter,sphereimposteroutline:()=>m.sphereimposteroutline,sprite:()=>v.sprite,stickimposter:()=>_.stickimposter,stickimposteroutline:()=>D.stickimposteroutline,volumetric:()=>f.volumetric});var i=t("./src/WebGL/shaders/lib/basic/index.ts"),r=t("./src/WebGL/shaders/lib/instanced/index.ts"),s=t("./src/WebGL/shaders/lib/lambert/index.ts"),o=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),a=t("./src/WebGL/shaders/lib/outline/index.ts"),h=t("./src/WebGL/shaders/lib/screen/index.ts"),d=t("./src/WebGL/shaders/lib/screenaa/index.ts"),u=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),m=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),v=t("./src/WebGL/shaders/lib/sprite/index.ts"),_=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),D=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),f=t("./src/WebGL/shaders/lib/volumetric/index.ts"),l=t("./src/WebGL/shaders/lib/ssao/index.ts"),c=t("./src/WebGL/shaders/lib/blur/index.ts");const p={basic:i.basic,blur:c.blur,instanced:r.instanced,lambert:s.lambert,lambertdouble:o.lambertdouble,outline:a.outline,screen:h.screen,screenaa:d.screenaa,ssao:l.ssao,sphereimposter:u.sphereimposter,sphereimposteroutline:m.sphereimposteroutline,sprite:v.sprite,stickimposter:_.stickimposter,stickimposteroutline:D.stickimposteroutline,volumetric:f.volumetric}},"./src/WebGL/shaders/lib/instanced/index.ts":(n,e,t)=>{t.r(e),t.d(e,{instanced:()=>o});var i=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),r=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),s=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/instanced/instanced.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`},"./src/WebGL/shaders/lib/instanced/instanced.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/instanced/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambert/index.ts":(n,e,t)=>{t.r(e),t.d(e,{lambert:()=>o});var i=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),r=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),s=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/lambert/lambert.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`},"./src/WebGL/shaders/lib/lambert/lambert.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`},"./src/WebGL/shaders/lib/lambert/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambertdouble/index.ts":(n,e,t)=>{t.r(e),t.d(e,{lambertdouble:()=>o});var i=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),r=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),s=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/outline/index.ts":(n,e,t)=>{t.r(e),t.d(e,{outline:()=>o});var i=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),r=t("./src/WebGL/shaders/lib/outline/outline.frag"),s=t("./src/WebGL/shaders/lib/outline/outline.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/outline/outline.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/outline/outline.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`},"./src/WebGL/shaders/lib/outline/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new i.Color(0,0,0)},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/screen/index.ts":(n,e,t)=>{t.r(e),t.d(e,{screen:()=>o});var i=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),r=t("./src/WebGL/shaders/lib/screen/screen.frag"),s=t("./src/WebGL/shaders/lib/screen/screen.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/screen/screen.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `},"./src/WebGL/shaders/lib/screen/screen.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screen/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/screenaa/index.ts":(n,e,t)=>{t.r(e),t.d(e,{screenaa:()=>o});var i=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),r=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),s=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/screenaa/screenaa.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`},"./src/WebGL/shaders/lib/screenaa/screenaa.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screenaa/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/sphereimposter/index.ts":(n,e,t)=>{t.r(e),t.d(e,{sphereimposter:()=>o});var i=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),r=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),s=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const o={vertexShader:s.default.replace("#define GLSLIFY 1",""),fragmentShader:r.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`},"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":(n,e,t)=>{t.r(e),t.d(e,{sphereimposteroutline:()=>o});var i=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),r=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),s=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`},"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new i.Color(0,0,0)},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/sprite/index.ts":(n,e,t)=>{t.r(e),t.d(e,{sprite:()=>o});var i=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),r=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),s=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sprite/sprite.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`},"./src/WebGL/shaders/lib/sprite/sprite.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`},"./src/WebGL/shaders/lib/sprite/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/ssao/index.ts":(n,e,t)=>{t.r(e),t.d(e,{ssao:()=>o});var i=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),r=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),s=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const o={fragmentShader:r.default,vertexShader:s.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/ssao/ssao.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`},"./src/WebGL/shaders/lib/ssao/ssao.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/ssao/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/stickimposter/index.ts":(n,e,t)=>{t.r(e),t.d(e,{stickimposter:()=>h});var i=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),r=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),s=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),o=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const h={fragmentShader:[r.default,s.default].join(`
`),vertexShader:o.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`},"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`},"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":(n,e,t)=>{t.r(e),t.d(e,{stickimposteroutline:()=>h});var i=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),r=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),s=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"),o=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const h={fragmentShader:r.default+s.default,vertexShader:o.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`},"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new i.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/volumetric/index.ts":(n,e,t)=>{t.r(e),t.d(e,{volumetric:()=>o});var i=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),r=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),s=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const o={fragmentShader:r.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/volumetric/uniforms.ts":(n,e,t)=>{t.r(e),t.d(e,{uniforms:()=>r});var i=t("./src/colors.ts");const r={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}},"./src/WebGL/shaders/lib/volumetric/volumetric.frag":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `},"./src/WebGL/shaders/lib/volumetric/volumetric.vert":(n,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`},"./src/WebGL/shaders/utils/clone.ts":(n,e,t)=>{t.r(e),t.d(e,{clone:()=>r});var i=t("./src/colors.ts");function r(s){let o={};for(const h in s){o[h]={},o[h].type=s[h].type;var a=s[h].value;a instanceof i.Color?o[h].value=a.clone():typeof a=="number"?o[h].value=a:a instanceof Array?o[h].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return o}},"./src/WebGL/shaders/utils/index.ts":(n,e,t)=>{t.r(e),t.d(e,{ShaderUtils:()=>r,clone:()=>i.clone});var i=t("./src/WebGL/shaders/utils/clone.ts");const r={clone:i.clone}},"./src/WebGL/shapes/Cylinder.ts":(n,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>s});var i=t("./src/WebGL/math/index.ts");let r=new i.Vector3;class s{constructor(a=new i.Vector3,h=new i.Vector3,d=0){this.c1=a,this.c2=h,this.radius=d,this.direction=new i.Vector3().subVectors(this.c2,this.c1).normalize()}copy(a){return this.c1.copy(a.c1),this.c2.copy(a.c2),this.direction.copy(a.direction),this.radius=a.radius,this}lengthSq(){return r.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(a){return this.direction.add(this.c1).applyMatrix4(a),this.c1.applyMatrix4(a),this.c2.applyMatrix4(a),this.direction.sub(this.c1).normalize(),this.radius=this.radius*a.getMaxScaleOnAxis(),this}}},"./src/WebGL/shapes/Sphere.ts":(n,e,t)=>{t.r(e),t.d(e,{Sphere:()=>r});var i=t("./src/WebGL/math/index.ts");class r{constructor(o={x:0,y:0,z:0},a=0){this.center=new i.Vector3(o.x,o.y,o.z),this.radius=a}set(o,a){return this.center.copy(o),this.radius=a,this}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}clone(){return new r().copy(this)}}},"./src/WebGL/shapes/Triangle.ts":(n,e,t)=>{t.r(e),t.d(e,{Triangle:()=>s});var i=t("./src/WebGL/math/index.ts");const r=new i.Vector3;class s{constructor(a=new i.Vector3,h=new i.Vector3,d=new i.Vector3){this.a=a,this.b=h,this.c=d}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}applyMatrix4(a){return this.a.applyMatrix4(a),this.b.applyMatrix4(a),this.c.applyMatrix4(a),this}getNormal(){var a=this.a.clone();return a.sub(this.b),r.subVectors(this.c,this.b),a.cross(r),a.normalize(),a}}},"./src/WebGL/shapes/index.ts":(n,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>r.Cylinder,Sphere:()=>i.Sphere,Triangle:()=>s.Triangle});var i=t("./src/WebGL/shapes/Sphere.ts"),r=t("./src/WebGL/shapes/Cylinder.ts"),s=t("./src/WebGL/shapes/Triangle.ts")},"./src/autoload.ts":(n,e,t)=>{t.r(e),t.d(e,{autoinit:()=>a,autoload:()=>u,processing_autoinit:()=>h,viewers:()=>d});var i=t("./src/GLViewer.ts"),r=t("./src/ProteinSurface4.ts"),s=t("./src/utilities.ts"),o=t("./src/colors.ts"),a=!1,h=!1,d={};function u(m,v){var _,D,f;if(document.querySelector(".viewer_3Dmoljs")!=null&&(a=!0),a){h=!0,m=m??null;var l=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(c=>{var p=[],b=[],E="";c.style.position=="static"&&(c.style.position="relative");var C=null;if(f=null,c.dataset.pdb)p.push("https://files.rcsb.org/view/"+c.dataset.pdb+".pdb"),b.push("pdb");else if(c.dataset.cid)b.push("sdf"),p.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+c.dataset.cid+"/SDF?record_type=3d");else if(c.dataset.href||c.dataset.url){if(c.dataset.href?E=c.dataset.href:E=c.dataset.url,p.push(E),f=E.substring(E.lastIndexOf(".")+1),f=="gz"){let _e=E.substring(0,E.lastIndexOf(".")).lastIndexOf(".");f=E.substring(_e+1)}b.push(f);var g=E.substring(E.lastIndexOf("/")+1,E.lastIndexOf("."));g=="/"&&(g=E.substring(E.lastIndexOf("/")+1)),c.dataset[b[b.length-1]]=g}let x=c.dataset;for(_ in x)_.substring(0,3)==="pdb"&&_!=="pdb"?(p.push("https://files.rcsb.org/view/"+x[_]+".pdb"),b.push("pdb")):_.substring(0,4)==="href"&&_!=="href"?(E=x[_],p.push(E),b.push(E.substring(E.lastIndexOf(".")+1))):_.substring(0,3)==="cid"&&_!=="cid"&&(p.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+x[_]+"/SDF?record_type=3d"),b.push("sdf"));var y={};c.dataset.options&&(y=(0,s.specStringToObject)(c.dataset.options));var w=o.CC.color(c.dataset.backgroundcolor),M=c.dataset.backgroundalpha;M=M==null?1:parseFloat(M);var S={line:{}};c.dataset.style&&(S=(0,s.specStringToObject)(c.dataset.style));var O={};c.dataset.select&&(O=(0,s.specStringToObject)(c.dataset.select));var P=[],I=[],F=[],k={},B=null,U=c.dataset,W=/style(.+)/,R=/surface(.*)/,z=/labelres(.*)/,G=[];for(D in U)Object.prototype.hasOwnProperty.call(U,D)&&G.push(D);for(G.sort(),_=0;_<G.length;_++){D=G[_];var q=W.exec(D),Q,ne,te;q&&(Q="select"+q[1],ne=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[D]),P.push([ne,te])),q=R.exec(D),q&&(Q="select"+q[1],ne=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[D]),I.push([ne,te])),q=z.exec(D),q&&(Q="select"+q[1],ne=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[D]),F.push([ne,te])),D=="zoomto"&&(k=(0,s.specStringToObject)(U[D])),D=="spin"&&(B=(0,s.specStringToObject)(U[D]))}var oe=function(_e){for(_e.setStyle(O,S),C&&C.createSelectionAndStyle(O,S),_=0;_<P.length;_++){let Z=P[_][0]||{},xe=P[_][1]||{line:{}};_e.setStyle(Z,xe),C&&C.createSelectionAndStyle(O,S)}for(_=0;_<I.length;_++){let Z=I[_][0]||{},xe=I[_][1]||{};C?_e.addSurface(r.SurfaceType.VDW,xe,Z,Z).then(ie=>{C.loadSurface("VDW",Z,xe,ie)}):_e.addSurface(r.SurfaceType.VDW,xe,Z,Z)}for(_=0;_<F.length;_++){let Z=F[_][0]||{},xe=F[_][1]||{};_e.addResLabels(Z,xe)}_e.render(),_e.zoomTo(k),B&&_e.spin(B.axis,B.speed)};let re=m;try{var le=(0,s.specStringToObject)(c.dataset.config)||{};le.backgroundColor===void 0&&(le.backgroundColor=w),le.backgroundAlpha===void 0&&(le.backgroundAlpha=M),re==null?re=d[c.id||l++]=(0,i.createViewer)(c,le):(re.setBackgroundColor(w,M),re.setConfig(le),C&&C.initiateUI()),c.dataset.ui&&$3Dmol.StateManager&&(C=new $3Dmol.StateManager(re))}catch(_e){console.log(_e),c.textContent="WebGL appears to be disabled."}if(p.length!=0){let _e=0,Z=((xe,we)=>function(ie){E=p[_e];var Ne=xe.dataset.type||xe.dataset.datatype||b[_e];if(we.addModel(ie,Ne,y),C){var Ge=xe.dataset[b[_e]];C.setModelTitle(Ge)}_e+=1,_e<p.length?(0,s.get)(p[_e]).then(Z):(oe(we),xe.dataset.callback&&(0,s.makeFunction)(xe.dataset.callback)(we),h=!1,v&&v(we))})(c,re);f&&f.endsWith("gz")?(0,s.getbin)(p[0]).then(Z):(0,s.get)(p[0]).then(Z)}else{if(c.dataset.element){var Ce="#"+c.dataset.element,De=document.querySelector(Ce),Oe=De?De.textContent:"";f=c.dataset.type||c.dataset.datatype,re.addModel(Oe,f,y)}oe(re),c.dataset.callback&&(0,s.makeFunction)(c.dataset.callback)(re),h=!1,v&&v(re)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&u()}},"./src/colors.ts":(n,e,t)=>{t.r(e),t.d(e,{CC:()=>r,Color:()=>i,builtinColorSchemes:()=>m,chains:()=>u,elementColors:()=>h,htmlColors:()=>s,residues:()=>d,ssColors:()=>o});class i{constructor(_,D,f){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof _=="number"?(this.r=_||0,this.g=D||0,this.b=f||0,this):this.set(_||0)}set(_){return _ instanceof i?_.clone():(typeof _=="number"?this.setHex(_):typeof _=="object"&&(this.r=(_==null?void 0:_.r)||0,this.g=(_==null?void 0:_.g)||0,this.b=(_==null?void 0:_.b)||0),this)}setHex(_){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,this}getHex(){var _=Math.round(this.r*255),D=Math.round(this.g*255),f=Math.round(this.b*255);return _<<16|D<<8|f}clone(){return new i(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}scaled(){var _={};return _.r=Math.round(this.r*255),_.g=Math.round(this.g*255),_.b=Math.round(this.b*255),_.a=1,_}}class r{static color(_){if(!_)return r.cache[0];if(_ instanceof i)return _;if(typeof _=="number"&&typeof r.cache[_]<"u")return r.cache[_];if(_&&Array.isArray(_))return _.map(r.color);let D=r.getHex(_),f=new i(D);return r.cache[D]=f,f}static getHex(_){if(Array.isArray(_))return _.map(r.getHex);if(typeof _=="string"){let D=_;if(!isNaN(parseInt(D)))return parseInt(D);if(D=D.trim(),D.length==4&&D[0]=="#"&&(D="#"+D[1]+D[1]+D[2]+D[2]+D[3]+D[3]),D.length==7&&D[0]=="#")return parseInt(D.substring(1),16);let f=r.rgbRegEx.exec(D);if(f){f[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let c=0;for(let p=2;p<5;p++){c*=256;let b=f[p].endsWith("%")?255*parseFloat(f[p])/100:parseFloat(f[p]);c+=Math.round(b)}return c}let l=s[D.toLowerCase()];return l!==void 0?l:(console.error("color not found",_.toLowerCase(),s),0)}return _}}r.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,r.cache={0:new i(0)};const s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},o={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},a={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},h={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:a,defaultColors:Object.assign({},a),greenCarbon:Object.assign(Object.assign({},a),{C:65280}),cyanCarbon:Object.assign(Object.assign({},a),{C:65535}),magentaCarbon:Object.assign(Object.assign({},a),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},a),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},a),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},a),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},a),{C:8388736}),blueCarbon:Object.assign(Object.assign({},a),{C:255})},d={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},u={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},m={ssPyMol:{prop:"ss",map:o.pyMol},ssJmol:{prop:"ss",map:o.Jmol},Jmol:{prop:"elem",map:h.Jmol},amino:{prop:"resn",map:d.amino},shapely:{prop:"resn",map:d.shapely},nucleic:{prop:"resn",map:d.nucleic},chain:{prop:"chain",map:u.atom},rasmol:{prop:"elem",map:h.rasmol},default:{prop:"elem",map:h.defaultColors},greenCarbon:{prop:"elem",map:h.greenCarbon},chainHetatm:{prop:"chain",map:u.hetatm},cyanCarbon:{prop:"elem",map:h.cyanCarbon},magentaCarbon:{prop:"elem",map:h.magentaCarbon},purpleCarbon:{prop:"elem",map:h.purpleCarbon},whiteCarbon:{prop:"elem",map:h.whiteCarbon},orangeCarbon:{prop:"elem",map:h.orangeCarbon},yellowCarbon:{prop:"elem",map:h.yellowCarbon},blueCarbon:{prop:"elem",map:h.blueCarbon}}},"./src/exporter.js":n=>{typeof n.exports=="object"&&(n.exports=window.$3Dmol)},"./src/glcartoon.ts":(n,e,t)=>{t.r(e),t.d(e,{drawCartoon:()=>O,subdivide_spline:()=>u});var i=t("./src/WebGL/math/index.ts"),r=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/Gradient.ts"),a=t("./src/colors.ts"),h=t("./src/GLDraw.ts"),d=t("./src/utilities.ts");function u(P,I){var F=[],k=P;k=[],k.push(P[0]);var B,U,W,R,z,G,q,Q,ne;for(B=1,U=P.length-1;B<U;B++)if(z=P[B],G=P[B+1],z.smoothen){var te=new i.Vector3((z.x+G.x)/2,(z.y+G.y)/2,(z.z+G.z)/2);te.atom=z.atom,k.push(te)}else k.push(z);for(k.push(P[P.length-1]),B=-1,W=k.length;B<=W-3;B++)if(R=k[B===-1?0:B],z=k[B+1],G=k[B+2],q=k[B===W-3?W-1:B+3],Q=new i.Vector3().subVectors(G,R).multiplyScalar(.5),ne=new i.Vector3().subVectors(q,z).multiplyScalar(.5),!G.skip)for(var oe=0;oe<I;oe++){var re=1/I*oe,le=z.x+re*Q.x+re*re*(-3*z.x+3*G.x-2*Q.x-ne.x)+re*re*re*(2*z.x-2*G.x+Q.x+ne.x),Ce=z.y+re*Q.y+re*re*(-3*z.y+3*G.y-2*Q.y-ne.y)+re*re*re*(2*z.y-2*G.y+Q.y+ne.y),De=z.z+re*Q.z+re*re*(-3*z.z+3*G.z-2*Q.z-ne.z)+re*re*re*(2*z.z-2*G.z+Q.z+ne.z),Oe=new i.Vector3(le,Ce,De);oe<I/2?Oe.atom=z.atom:Oe.atom=G.atom,F.push(Oe)}return F.push(k[k.length-1]),F}const m=.5,v=1.3,_=.8,D=.4,f=.4;function l(P,I,F,k){for(var B,U,W,R,z=0,G=I.length;z<G;z++){R=Math.round(z*(k.length-1)/G),W=a.CC.color(k[R]);var q=P.updateGeoGroup(2),Q=q.vertexArray,ne=q.colorArray,te=q.faceArray;B=q.vertices,U=B*3,Q[U]=I[z].x,Q[U+1]=I[z].y,Q[U+2]=I[z].z,Q[U+3]=F[z].x,Q[U+4]=F[z].y,Q[U+5]=F[z].z;for(var oe=0;oe<6;++oe)ne[U+3*oe]=W.r,ne[U+1+3*oe]=W.g,ne[U+2+3*oe]=W.b;if(z>0){var re=[B,B+1,B-1,B-2],le=q.faceidx;te[le]=re[0],te[le+1]=re[1],te[le+2]=re[3],te[le+3]=re[1],te[le+4]=re[2],te[le+5]=re[3],q.faceidx+=6}q.vertices+=2}}function c(P,I,F,k,B,U,W){var R,z,G,q;if(G=I.length,G<2||I[0].length<2)return;for(R=0;R<G;R++)I[R]=u(I[R],k);if(q=I[0].length,!B)return l(P,I[0],I[G-1],F);var Q,ne,te,oe,re,le,Ce=[],De=[],Oe=[];for(z=0;z<G;z++)Ce.push(.25+1.5*Math.sqrt((G-1)*z-Math.pow(z,2))/(G-1)),De.push(.5),Oe.push(2*(Math.pow(z/G,2)-z/G)+.6);var _e=[];for(z=0;z<G*2-1;z++)_e[z]=[z,z+1,z+1-2*G,z-2*G];_e[G*2-1]=[z,z+1-2*G,z+1-4*G,z-2*G];var Z,xe,we,ie,Ne,Ge,Ue,Ie,ze,Re;let Le=P.updateGeoGroup();for(R=0;R<q;R++){let K=P.groups,X=!1;Le=P.updateGeoGroup(2*G),K!=P.groups&&R>0&&(R=R-1,X=!0),Ge=Math.round(R*(F.length-1)/q),Ne=a.CC.color(F[Ge]),re=te,le=oe,te=[],oe=[],Q=[],I[0][R].atom!==void 0&&(ie=I[0][R].atom,W==="oval"?ne=Ce:W==="rectangle"?ne=De:W==="parabola"&&(ne=Oe)),ne||(ne=De);var We,He;for(z=0;z<G;z++)R<q-1?We=I[z][R+1].clone().sub(I[z][R]):We=I[z][R-1].clone().sub(I[z][R]).negate(),z<G-1?He=I[z+1][R].clone().sub(I[z][R]):He=I[z-1][R].clone().sub(I[z][R]).negate(),Q[z]=He.cross(We).normalize().multiplyScalar(B*ne[z]);for(z=0;z<G;z++)te[z]=I[z][R].clone().add(Q[z].clone().negate());for(z=0;z<G;z++)oe[z]=I[z][R].clone().add(Q[z]);for(Ue=Le.vertexArray,Ie=Le.colorArray,ze=Le.faceArray,Z=Le.vertices,xe=Z*3,z=0;z<G;z++)Ue[xe+3*z+0]=te[z].x,Ue[xe+3*z+1]=te[z].y,Ue[xe+3*z+2]=te[z].z;for(z=0;z<G;z++)Ue[xe+3*z+0+3*G]=oe[G-1-z].x,Ue[xe+3*z+1+3*G]=oe[G-1-z].y,Ue[xe+3*z+2+3*G]=oe[G-1-z].z;for(z=0;z<2*G;++z)Ie[xe+3*z+0]=Ne.r,Ie[xe+3*z+1]=Ne.g,Ie[xe+3*z+2]=Ne.b;if(R>0&&!X){for(z=0;z<G*2;z++)Re=[Z+_e[z][0],Z+_e[z][1],Z+_e[z][2],Z+_e[z][3]],we=Le.faceidx,ze[we]=Re[0],ze[we+1]=Re[1],ze[we+2]=Re[3],ze[we+3]=Re[1],ze[we+4]=Re[2],ze[we+5]=Re[3],Le.faceidx+=6;if(ie.clickable||ie.hoverable){var H=[];H.push(new r.Triangle(re[0],te[0],te[G-1])),H.push(new r.Triangle(re[0],te[G-1],re[G-1])),H.push(new r.Triangle(re[G-1],te[G-1],oe[G-1])),H.push(new r.Triangle(re[G-1],oe[G-1],le[G-1])),H.push(new r.Triangle(oe[0],le[0],le[G-1])),H.push(new r.Triangle(oe[G-1],oe[0],le[G-1])),H.push(new r.Triangle(te[0],re[0],le[0])),H.push(new r.Triangle(oe[0],te[0],le[0]));for(z in H)ie.intersectionShape.triangle.push(H[z])}}Le.vertices+=2*G}for(Ue=Le.vertexArray,Ie=Le.colorArray,ze=Le.faceArray,Z=Le.vertices,xe=Z*3,we=Le.faceidx,R=0;R<G-1;R++)Re=[R,R+1,2*G-2-R,2*G-1-R],we=Le.faceidx,ze[we]=Re[0],ze[we+1]=Re[1],ze[we+2]=Re[3],ze[we+3]=Re[1],ze[we+4]=Re[2],ze[we+5]=Re[3],Le.faceidx+=6;for(R=0;R<G-1;R++)Re=[Z-1-R,Z-2-R,Z-2*G+R+1,Z-2*G+R],we=Le.faceidx,ze[we]=Re[0],ze[we+1]=Re[1],ze[we+2]=Re[3],ze[we+3]=Re[1],ze[we+4]=Re[2],ze[we+5]=Re[3],Le.faceidx+=6}function p(P,I,F,k,B,U){if(!(I.length<2)){var W,R;if(W=I[0],R=I[I.length-1],W=u(W,k),R=u(R,k),!B)return l(P,W,R,F);var z=[],G,q,Q,ne,te,oe=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],re,le,Ce,De,Oe,_e,Z,xe,we,ie,Ne,Ge,Ue,Ie,ze,Re,Le;for(xe=0,we=W.length;xe<we;xe++){if(Oe=Math.round(xe*(F.length-1)/we),De=a.CC.color(F[Oe]),z.push(q=W[xe]),z.push(q),z.push(Q=R[xe]),z.push(Q),xe<we-1){var We=W[xe+1].clone().sub(W[xe]),He=R[xe].clone().sub(W[xe]);G=He.cross(We).normalize().multiplyScalar(B)}for(z.push(ne=W[xe].clone().add(G)),z.push(ne),z.push(te=R[xe].clone().add(G)),z.push(te),q.atom!==void 0&&(_e=q.atom),Ie=P.updateGeoGroup(8),ze=Ie.vertexArray,Re=Ie.colorArray,Le=Ie.faceArray,re=Ie.vertices,le=re*3,ze[le]=q.x,ze[le+1]=q.y,ze[le+2]=q.z,ze[le+3]=q.x,ze[le+4]=q.y,ze[le+5]=q.z,ze[le+6]=Q.x,ze[le+7]=Q.y,ze[le+8]=Q.z,ze[le+9]=Q.x,ze[le+10]=Q.y,ze[le+11]=Q.z,ze[le+12]=ne.x,ze[le+13]=ne.y,ze[le+14]=ne.z,ze[le+15]=ne.x,ze[le+16]=ne.y,ze[le+17]=ne.z,ze[le+18]=te.x,ze[le+19]=te.y,ze[le+20]=te.z,ze[le+21]=te.x,ze[le+22]=te.y,ze[le+23]=te.z,ie=0;ie<8;++ie)Re[le+3*ie]=De.r,Re[le+1+3*ie]=De.g,Re[le+2+3*ie]=De.b;if(xe>0){var H=Z!==void 0&&_e!==void 0&&Z.serial!==_e.serial;for(ie=0;ie<4;ie++){var K=[re+oe[ie][0],re+oe[ie][1],re+oe[ie][2],re+oe[ie][3]];if(Ce=Ie.faceidx,Le[Ce]=K[0],Le[Ce+1]=K[1],Le[Ce+2]=K[3],Le[Ce+3]=K[1],Le[Ce+4]=K[2],Le[Ce+5]=K[3],Ie.faceidx+=6,_e.clickable||Z.clickable||_e.hoverable||Z.hoverable){var X=z[K[3]].clone(),pe=z[K[0]].clone(),ue=z[K[2]].clone(),ye=z[K[1]].clone();if(X.atom=z[K[3]].atom||null,ue.atom=z[K[2]].atom||null,pe.atom=z[K[0]].atom||null,ye.atom=z[K[1]].atom||null,H){var Se=X.clone().add(pe).multiplyScalar(.5),V=ue.clone().add(ye).multiplyScalar(.5),he=X.clone().add(ye).multiplyScalar(.5);ie%2===0?((Z.clickable||Z.hoverable)&&(Ne=new r.Triangle(Se,he,X),Ge=new r.Triangle(V,ue,he),Ue=new r.Triangle(he,ue,X),Z.intersectionShape.triangle.push(Ne),Z.intersectionShape.triangle.push(Ge),Z.intersectionShape.triangle.push(Ue)),(_e.clickable||_e.hoverable)&&(Ne=new r.Triangle(pe,ye,he),Ge=new r.Triangle(ye,V,he),Ue=new r.Triangle(pe,he,Se),_e.intersectionShape.triangle.push(Ne),_e.intersectionShape.triangle.push(Ge),_e.intersectionShape.triangle.push(Ue))):((_e.clickable||_e.hoverable)&&(Ne=new r.Triangle(Se,he,X),Ge=new r.Triangle(V,ue,he),Ue=new r.Triangle(he,ue,X),_e.intersectionShape.triangle.push(Ne),_e.intersectionShape.triangle.push(Ge),_e.intersectionShape.triangle.push(Ue)),(Z.clickable||Z.hoverable)&&(Ne=new r.Triangle(pe,ye,he),Ge=new r.Triangle(ye,V,he),Ue=new r.Triangle(pe,he,Se),Z.intersectionShape.triangle.push(Ne),Z.intersectionShape.triangle.push(Ge),Z.intersectionShape.triangle.push(Ue)))}else(_e.clickable||_e.hoverable)&&(Ne=new r.Triangle(pe,ye,X),Ge=new r.Triangle(ye,ue,X),_e.intersectionShape.triangle.push(Ne),_e.intersectionShape.triangle.push(Ge))}}}Ie.vertices+=8,Z=_e}var ve=z.length-8;for(Ie=P.updateGeoGroup(8),ze=Ie.vertexArray,Re=Ie.colorArray,Le=Ie.faceArray,re=Ie.vertices,le=re*3,Ce=Ie.faceidx,xe=0;xe<4;xe++){z.push(z[xe*2]),z.push(z[ve+xe*2]);var Pe=z[xe*2],ae=z[ve+xe*2];ze[le+6*xe]=Pe.x,ze[le+1+6*xe]=Pe.y,ze[le+2+6*xe]=Pe.z,ze[le+3+6*xe]=ae.x,ze[le+4+6*xe]=ae.y,ze[le+5+6*xe]=ae.z,Re[le+6*xe]=De.r,Re[le+1+6*xe]=De.g,Re[le+2+6*xe]=De.b,Re[le+3+6*xe]=De.r,Re[le+4+6*xe]=De.g,Re[le+5+6*xe]=De.b}ve+=8,Ne=[re,re+2,re+6,re+4],Ge=[re+1,re+5,re+7,re+3],Le[Ce]=Ne[0],Le[Ce+1]=Ne[1],Le[Ce+2]=Ne[3],Le[Ce+3]=Ne[1],Le[Ce+4]=Ne[2],Le[Ce+5]=Ne[3],Le[Ce+6]=Ge[0],Le[Ce+7]=Ge[1],Le[Ce+8]=Ge[3],Le[Ce+9]=Ge[1],Le[Ce+10]=Ge[2],Le[Ce+11]=Ge[3],Ie.faceidx+=12,Ie.vertices+=8}}function b(P,I,F,k,B,U,W){(!W||W==="default")&&(W="rectangle"),W==="edged"?p(P,I,F,k,B):(W==="rectangle"||W==="oval"||W==="parabola")&&c(P,I,F,k,B,U,W)}function E(P){return P&&P.elem==="C"&&P.atom==="CA"}function C(P,I){if(P&&I&&P.chain===I.chain){if(!P.hetflag&&!I.hetflag&&P.reschain===I.reschain&&(P.resi===I.resi||P.resi===I.resi-1))return!0;if(P.resi<I.resi){var F=P.x-I.x,k=P.y-I.y,B=P.z-I.z,U=F*F+k*k+B*B;if(P.atom=="CA"&&I.atom=="CA"&&U<16)return!0;if((P.atom=="P"||I.atom=="P")&&U<64)return!0}}return!1}function g(P,I,F,k,B){if(!(I==null||I.vertices==0)){B&&(I.initTypedArrays(),I.setUpNormals());var U=new s.MeshDoubleLambertMaterial;U.vertexColors=s.Coloring.FaceColors,typeof F=="number"&&F>=0&&F<1&&(U.transparent=!0,U.opacity=F),U.outline=k;var W=new s.Mesh(I,U);P.add(W)}}function x(P,I,F,k,B,U,W,R,z){var G,q,Q,ne,te,oe;if(!(!k||!B||!W)){var re=B.sub(k);re.normalize();var le=R[z];for(q=z+1;q<R.length&&(le=R[q],le.atom!=W.atom);q++);if(le=le?new i.Vector3(le.x,le.y,le.z):new i.Vector3(0,0,0),le.sub(k),W.ss==="arrow start"){var Ce=le.clone().multiplyScalar(.3).cross(B);k.add(Ce);var De=le.clone().cross(re).normalize();re.rotateAboutVector(De,.43)}for(W.style.cartoon.ribbon?G=W.style.cartoon.thickness||D:W.style.cartoon.width?G=W.style.cartoon.width:W.ss==="c"?W.atom==="P"?G=_:G=m:W.ss==="arrow start"?(G=v,te=!0):W.ss==="arrow end"||W.ss==="h"&&W.style.cartoon.tubes||W.ss==="tube start"?G=m:G=v,U!=null&&re.dot(U)<0&&re.negate(),re.multiplyScalar(G),q=0;q<I;q++)Q=-1+q*2/(I-1),ne=new i.Vector3(k.x+Q*re.x,k.y+Q*re.y,k.z+Q*re.z),ne.atom=W,W.ss==="s"&&(ne.smoothen=!0),P[q].push(ne);if(te)for(re.multiplyScalar(2),q=0;q<I;q++)Q=-1+q*2/(I-1),ne=new i.Vector3(k.x+Q*re.x,k.y+Q*re.y,k.z+Q*re.z),ne.atom=W,ne.smoothen=!1,ne.skip=!0,P[q].push(ne);return oe=W.style.cartoon.style||"default",P.style?P.style!=oe&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),P.style="default"):P.style=oe,(W.ss==="arrow start"||W.ss==="arrow end")&&(W.ss="s"),te}}const y={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},w={DA:!0,DG:!0,A:!0,G:!0},M={DT:!0,DC:!0,U:!0,C:!0,T:!0},S={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function O(P,I,F,k=10){let B=k,U=k;var W,R,z,G,q,Q,ne,te,oe,re,le,Ce,De,Oe,_e,Z,xe,we,ie=new s.Geometry(!0),Ne=new s.Geometry(!0),Ge=[],Ue=[],Ie=1,ze=!1,Re={};for(var Le in o.Gradient.builtinGradients)o.Gradient.builtinGradients.hasOwnProperty(Le)&&(Re[Le]=new o.Gradient.builtinGradients[Le](F[1],F[0]));var We=function(Be,L){return F&&L.color==="spectrum"?L.colorscheme in Re?Re[L.colorscheme].valueToHex(Be.resi):Re.sinebow.valueToHex(Be.resi):(0,d.getColorFromStyle)(Be,L).getHex()};for(te=0;te<B;te++)Ue[te]=[];var He=!1,H=!1,K=[];for(te in I){if(G=I[te],G.elem==="C"&&G.atom==="CA"){var X=C(z,G);X&&G.ss==="s"?He=!0:He&&(z&&R&&z.style.cartoon.arrows&&R.style.cartoon.arrows&&(z.ss="arrow end",R.ss="arrow start"),He=!1),X&&(z.ss==="h"||z.ss=="tube start")&&z.style.cartoon.tubes?!H&&z.ss!="tube start"&&G.style.cartoon.tubes&&(G.ss="tube start",H=!0):H&&(z.ss==="tube start"?z.ss="tube end":R&&R.style.cartoon.tubes&&(R.ss="tube end"),H=!1),R=z,z=G}G&&G.atom in y&&K.push(G)}H&&z.style.cartoon.tubes&&(z.ss="tube end",H=!1);var pe=function(Be){Ue[0].length>0&&b(Ne,Ue,Ge,U,ne,Ie,Ue.style);var L=[],ge=null;if(Be){for(te=0;te<B;te++)L[te]=Ue[te][Ue[te].length-1];ge=Ge[Ge.length-1]}for(Ue=[],te=0;te<B;te++)Ue[te]=[];if(Ge=[],Be){for(te=0;te<B;te++)Ue[te].push(L[te]);Ge.push(ge)}g(P,Ne,Ie,ze,!0),g(P,ie,Ie,ze,!1),Ne=new s.Geometry(!0),ie=new s.Geometry(!0)};z=void 0;let ue=[];for(var ye=0;ye<K.length;ye++){G=K[ye];var Se=G.resn.trim(),V=Se in S;if(Ie=1,W=G.style.cartoon,z&&z.style.cartoon&&(Ie=z.style.cartoon.opacity),z&&z.style.cartoon&&z.style.cartoon.outline&&(ze=z.style.cartoon.outline),z&&z.style.cartoon&&(!G.style.cartoon||z.style.cartoon.opacity!=G.style.cartoon.opacity)&&pe(z.chain==G.chain),z&&G&&!C(z,G)&&z.chain&&z.chain==G.chain&&!z.hetflag&&!G.hetflag&&z.reschain+1==G.reschain&&ue.push([z,G]),W.style==="trace"){if(!G.hetflag){if(G.elem==="C"&&G.atom==="CA"||V&&G.atom==="P"||G.atom==="BB"){if(Q=We(G,W),(0,d.isNumeric)(W.thickness)?ne=W.thickness:ne=D,C(z,G))if(Q==q){var he=a.CC.color(Q);h.GLDraw.drawCylinder(ie,z,G,ne,he,2,2)}else{var ve=new i.Vector3().addVectors(z,G).multiplyScalar(.5),Pe=a.CC.color(q),ae=a.CC.color(Q);h.GLDraw.drawCylinder(ie,z,ve,ne,Pe,2,0),h.GLDraw.drawCylinder(ie,ve,G,ne,ae,0,2)}if((G.clickable===!0||G.hoverable)&&G.intersectionShape!==void 0){var me=new i.Vector3(G.x,G.y,G.z);G.intersectionShape.sphere.push(new r.Sphere(me,ne))}z=G,q=Q}}}else{if(E(G)||V&&(G.atom==="P"||G.atom.indexOf("O5")==0)){if(we)if(G.ss==="tube end")we=!1,xe=new i.Vector3(G.x,G.y,G.z),h.GLDraw.drawCylinder(ie,Z,xe,2,a.CC.color(q),1,1),G.ss="h";else if(z.chain!=G.chain||z.ss==="tube end")we=!1,z.ss="h",xe=new i.Vector3(z.x,z.y,z.z),h.GLDraw.drawCylinder(ie,Z,xe,2,a.CC.color(q),1,1);else continue;if(z&&(!C(z,G)||z.ss==="tube start")){for(z.ss==="tube start"&&(we=!0,Z=new i.Vector3(z.x,z.y,z.z),z.ss="h"),_e&&(Ce?Oe=new i.Vector3().addVectors(z,Ce).multiplyScalar(.5):Oe=new i.Vector3(z.x,z.y,z.z),h.GLDraw.drawCylinder(ie,Oe,_e,f,a.CC.color(_e.color),0,2),x(Ue,B,!0,Ce,De,le,z,K,ye),Ge.push(Q),Oe=null,_e=null),Ue[0].length>0&&b(Ne,Ue,Ge,U,ne,Ie,Ue.style),Ue=[],te=0;te<B;te++)Ue[te]=[];Ge=[]}if(z===void 0||z.rescode!=G.rescode||z.resi!=G.resi){if(_e&&z!=null){Oe=new i.Vector3().addVectors(z,G).multiplyScalar(.5);var j=Oe.clone().sub(_e).multiplyScalar(.02);Oe.add(j),h.GLDraw.drawCylinder(ie,Oe,_e,f,a.CC.color(_e.color),0,2),Oe=null,_e=null}Q=We(G,W),Ge.push(Q),(0,d.isNumeric)(W.thickness)?ne=W.thickness:ne=D,z=G,oe=new i.Vector3(z.x,z.y,z.z),oe.resi=z.resi,q=Q}(G.clickable===!0||G.hoverable===!0)&&(G.intersectionShape===void 0||G.intersectionShape.triangle===void 0)&&(G.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else z!=null&&(E(z)&&G.atom==="O"||V&&z.atom==="P"&&(G.atom==="OP2"||G.atom==="O2P")||V&&z.atom.indexOf("O5")==0&&G.atom.indexOf("C5")==0)?(re=new i.Vector3(G.x,G.y,G.z),re.resi=G.resi,(G.atom==="OP2"||G.atom==="O2P")&&(De=new i.Vector3(G.x,G.y,G.z))):V&&G.atom.indexOf("O3")==0?Ce=new i.Vector3(G.x,G.y,G.z):(G.atom==="N1"&&Se in w||G.atom==="N3"&&Se in M)&&(_e=new i.Vector3(G.x,G.y,G.z),_e.color=(0,d.getColorFromStyle)(G,W).getHex());re&&oe&&re.resi===oe.resi&&(x(Ue,B,!0,oe,re,le,z,K,ye),le=re,oe=null,re=null,Ge.push(Q))}}_e&&(Ce?Oe=new i.Vector3().addVectors(z,Ce).multiplyScalar(.5):Oe=new i.Vector3(z.x,z.y,z.z),h.GLDraw.drawCylinder(ie,Oe,_e,f,a.CC.color(_e.color),0,2),x(Ue,B,!0,Ce,De,le,z,K,ye),Ge.push(Q)),pe(!1);var Te=function(Be,L){if(Be.style.cartoon.gapcutoff&&Be.style.cartoon.gapcutoff==L.style.cartoon.gapcutoff){let de=Be.style.cartoon.gapcutoff,$=L.resi-Be.resi;if($>0&&$<de){let se=.25,ce=L.x-Be.x,Fe=L.y-Be.y,ke=L.z-Be.z,Ee=Math.sqrt(ce*ce+Fe*Fe+ke*ke),$e=Ee/(2*$),Xe=new i.Vector3(Be.x,Be.y,Be.z),Ke=Ee/$e,Je=new i.Vector3((L.x-Be.x)/Ke,(L.y-Be.y)/Ke,(L.z-Be.z)/Ke);Xe.add({x:Je.x/2,y:Je.y/2,z:Je.z/2});let Ye=Xe.clone().add(Je);Je.multiplyScalar(2);let nt=(0,d.extend)({},Be);for(var ge=0;ge<$;ge++){nt.resi+=1;let st=We(nt,nt.style.cartoon);h.GLDraw.drawCylinder(ie,Xe,Ye,se,a.CC.color(st),h.CAP.FLAT,h.CAP.FLAT),Xe.add(Je),Ye.add(Je)}pe(!1)}}};for(let Be of ue)Te(Be[0],Be[1])}},"./src/index.ts":(n,e,t)=>{t.r(e),t.d(e,{CAP:()=>i.CAP,CC:()=>i.CC,CONTEXTS_PER_VIEWPORT:()=>i.CONTEXTS_PER_VIEWPORT,Color:()=>i.Color,CustomLinear:()=>i.CustomLinear,Cylinder:()=>i.Cylinder,GLDraw:()=>i.GLDraw,GLModel:()=>i.GLModel,GLShape:()=>i.GLShape,GLViewer:()=>i.GLViewer,GLVolumetricRender:()=>i.GLVolumetricRender,Gradient:()=>i.Gradient,GradientType:()=>i.GradientType,Label:()=>i.Label,LabelCount:()=>i.LabelCount,MarchingCube:()=>i.MarchingCube,MarchingCubeInitializer:()=>i.MarchingCubeInitializer,Matrix3:()=>i.Matrix3,Matrix4:()=>i.Matrix4,Parsers:()=>i.Parsers,PausableTimer:()=>i.PausableTimer,PointGrid:()=>i.PointGrid,ProteinSurface:()=>i.ProteinSurface,Quaternion:()=>i.Quaternion,ROYGB:()=>i.ROYGB,RWB:()=>i.RWB,Ray:()=>i.Ray,Sinebow:()=>i.Sinebow,Sphere:()=>i.Sphere,SurfaceType:()=>i.SurfaceType,Triangle:()=>i.Triangle,Vector2:()=>i.Vector2,Vector3:()=>i.Vector3,VolumeData:()=>i.VolumeData,adjustVolumeStyle:()=>i.adjustVolumeStyle,applyPartialCharges:()=>i.applyPartialCharges,autoinit:()=>i.autoinit,autoload:()=>i.autoload,base64ToArray:()=>i.base64ToArray,bondLength:()=>i.bondLength,builtinColorSchemes:()=>i.builtinColorSchemes,builtinGradients:()=>i.builtinGradients,chains:()=>i.chains,clamp:()=>i.clamp,conversionMatrix3:()=>i.conversionMatrix3,createStereoViewer:()=>i.createStereoViewer,createViewer:()=>i.createViewer,createViewerGrid:()=>i.createViewerGrid,deepCopy:()=>i.deepCopy,degToRad:()=>i.degToRad,download:()=>i.download,drawCartoon:()=>i.drawCartoon,elementColors:()=>i.elementColors,extend:()=>i.extend,get:()=>i.get,getAtomProperty:()=>i.getAtomProperty,getColorFromStyle:()=>i.getColorFromStyle,getElement:()=>i.getElement,getExtent:()=>i.getExtent,getGradient:()=>i.getGradient,getPropertyRange:()=>i.getPropertyRange,getbin:()=>i.getbin,htmlColors:()=>i.htmlColors,inflateString:()=>i.inflateString,isEmptyObject:()=>i.isEmptyObject,isNumeric:()=>i.isNumeric,makeFunction:()=>i.makeFunction,mergeGeos:()=>i.mergeGeos,normalizeValue:()=>i.normalizeValue,partialCharges:()=>i.partialCharges,processing_autoinit:()=>i.processing_autoinit,residues:()=>i.residues,setBondLength:()=>i.setBondLength,setSyncSurface:()=>i.setSyncSurface,specStringToObject:()=>i.specStringToObject,splitMesh:()=>i.splitMesh,ssColors:()=>i.ssColors,subdivide_spline:()=>i.subdivide_spline,syncSurface:()=>i.syncSurface,viewers:()=>i.viewers});var i=t("./src/3Dmol.ts");window&&(window.$3Dmol=e)},"./src/parsers/BCIF.ts":(n,e,t)=>{t.r(e),t.d(e,{BCIF:()=>D});var i=t("./src/utilities.ts"),r=t("./src/parsers/utils/computeSecondaryStructure.ts"),s=t("./src/parsers/utils/processSymmetries.ts"),o=t("./src/parsers/cifutils/category.ts"),a=t("./src/parsers/utils/assignPDBBonds.ts"),h=t("./src/WebGL/index.ts"),d=t("./src/parsers/utils/isEmpty.ts"),u=t("./src/vendor/mmtf.js");class m{constructor(l){if(this.C={},l){let c=l.getField("comp_id"),p=l.getField("atom_id_1"),b=l.getField("atom_id_2"),E=l.getField("value_order");for(let C=0;C<c.length;C++){let g=c[C],x=p[C],y=b[C],w=E[C],M=1;w=="doub"?M=2:w=="trip"&&(M=3),this.C[g]==null&&(this.C[g]={}),this.C[g][x]==null&&(this.C[g][x]={}),this.C[g][y]==null&&(this.C[g][y]={}),this.C[g][x][y]=M,this.C[g][y][x]=M}}}order(l,c,p){return this.C[l]!==void 0&&this.C[l][c]!==void 0&&this.C[l][c][p]!==void 0?this.C[l][c][p]:0}}class v{constructor(l){if(this.C=[],l){let c=l.getField("conn_type_id"),p=l.getField("ptnr1_label_asym_id"),b=l.getField("ptnr1_label_seq_id"),E=l.getField("ptnr1_label_comp_id"),C=l.getField("ptnr1_label_atom_id"),g=l.getField("ptnr2_label_asym_id"),x=l.getField("ptnr2_label_seq_id"),y=l.getField("ptnr2_label_comp_id"),w=l.getField("ptnr2_label_atom_id"),M=l.getField("pdbx_value_order");for(let S=0;S<c.length;S++)if(c[S]=="disulf"||c[S]=="covale"){let O=M?M[S]==""?1:parseInt(M[S]):1;this.C.push([[p[S],b[S],E[S],C[S]],[g[S],x[S],y[S],w[S]],O])}}}}class _{constructor(){this.R={}}add(l){this.R[l.lchain]==null&&(this.R[l.lchain]={}),this.R[l.lchain][l.lresi]==null&&(this.R[l.lchain][l.lresi]={}),this.R[l.lchain][l.lresi][l.lresn]==null&&(this.R[l.lchain][l.lresi][l.lresn]=[]),this.R[l.lchain][l.lresi][l.lresn].push(l),this.R[l.lchain][l.lresi][l.lresn][l.atom]=l}geta([l,c,p,b]){if(this.R[l]!==void 0&&this.R[l][c]!==void 0&&this.R[l][c][p]!==void 0)return this.R[l][c][p][b]}setBonds(l,c){for(let p in this.R)for(let b in this.R[p])for(let E in this.R[p][b]){let C=this.R[p][b][E];for(let g=0;g<C.length;g++)for(let x=g+1;x<C.length;x++){let y=C[g],w=C[x],M=l.order(E,y.atom,w.atom);y.altLoc!=w.altLoc&&y.altLoc!=""&&w.altLoc!=""&&(M=0),M>0&&(y.bonds.push(w.index),w.bonds.push(y.index),y.bondOrder.push(M),w.bondOrder.push(M))}}for(let p of c.C){let b=p[0],E=p[1],C=p[2],g=this.geta(b),x=this.geta(E);g!=null&&x!=null&&(g.bonds.push(x.index),x.bonds.push(g.index),g.bondOrder.push(C),x.bondOrder.push(C))}}}function D(f,l){var c=!l.keepH,p=l.altLoc?l.altLoc:"A",b=!l.noComputeSecondaryStructure;const E=!l.doAssembly,C=l.assignBonds===void 0?!0:l.assignBonds;if(typeof f=="string")try{f=(0,i.base64ToArray)(f)}catch{f=new TextEncoder().encode(f)}else f=new Uint8Array(f);var g=u.decodeMsgpack(f);g==31&&(f=(0,i.inflateString)(f,!1),g=u.decodeMsgpack(f));var x=[],y=x.modelData=[],w=g.dataBlocks.length;if(w==0)return x;l.multimodel||(w=1);for(let M=0;M<w;M++){let S=x.length;const O=[];y.push({symmetries:[]}),x.push([]);const P=g.dataBlocks[M],I=Object.create(null);for(const Re of P.categories)I[Re.name.substr(1)]=(0,o.Category)(Re);let F={},k=I.struct_conf;if(k){let Re=k.getField("conf_type_id"),Le=k.getField("beg_label_asym_id"),We=k.getField("beg_label_seq_id"),He=k.getField("end_label_seq_id");for(let H=0;H<Re.length;H++)if(Re[H].startsWith("H")){let K=Le[H],X=We[H],pe=He[H];K in F||(F[K]={}),F[K][X]="h1";for(let ue=X+1;ue<pe;ue++)F[K][ue]="h";F[K][pe]="h2"}}let B=I.struct_sheet_range;if(B){let Re=B.getField("id"),Le=B.getField("beg_label_asym_id"),We=B.getField("beg_label_seq_id"),He=B.getField("end_label_seq_id");for(let H=0;H<Re.length;H++){let K=Le[H],X=We[H],pe=He[H];K in F||(F[K]={}),F[K][X]="s1";for(let ue=X+1;ue<pe;ue++)F[K][ue]="s";F[K][pe]="s2"}}let U=I.pdbx_struct_oper_list,W=U.getField("id");if(W&&!E){let Re=U.getField("matrix[1][1]"),Le=U.getField("matrix[1][2]"),We=U.getField("matrix[1][3]"),He=U.getField("matrix[2][1]"),H=U.getField("matrix[2][2]"),K=U.getField("matrix[2][3]"),X=U.getField("matrix[3][1]"),pe=U.getField("matrix[3][2]"),ue=U.getField("matrix[3][3]"),ye=U.getField("vector[1]"),Se=U.getField("vector[2]"),V=U.getField("vector[3]");for(let he=0;he<W.length;he++){const ve=new h.Matrix4(Re[he],Le[he],We[he],ye[he],He[he],H[he],K[he],Se[he],X[he],pe[he],ue[he],V[he]);y[y.length-1].symmetries.push(ve)}}let R=new m(I.chem_comp_bond),z=new _,G=new v(I.struct_conn),q=I.atom_site,Q=q.rowCount,ne=q.getField("group_PDB"),te=q.getField("Cartn_x"),oe=q.getField("Cartn_y"),re=q.getField("Cartn_z"),le=q.getField("auth_asym_id"),Ce=q.getField("label_asym_id"),De=q.getField("auth_seq_id"),Oe=q.getField("label_seq_id"),_e=q.getField("auth_comp_id"),Z=q.getField("label_comp_id"),xe=q.getField("auth_atom_id"),we=q.getField("label_atom_id"),ie=q.getField("type_symbol"),Ne=q.getField("B_iso_or_equiv"),Ge=q.getField("id"),Ue=q.getField("label_alt_id"),Ie=q.getField("pdbx_PDB_model_num"),ze=Ie?Ie[0]:0;for(let Re=0;Re<Q;Re++){if(ne!==void 0&&ne[Re]==="TER")continue;if(Ie&&Ie[Re]!=ze)if(ze=Ie[Re],l.multimodel)l.onemol||(x.push([]),y.push(y[y.length-1]),ze=Ie[Re],z.setBonds(R,G),z=new _);else break;const Le={};Le.x=te[Re],Le.y=oe[Re],Le.z=re[Re],Le.chain=le?le[Re]:Ce?Ce[Re]:void 0,Le.lchain=Ce?Ce[Re]:void 0,Le.resi=De?De[Re]:Oe?Oe[Re]:void 0,Le.lresi=Oe?Oe[Re]:void 0,Le.resn=_e?_e[Re].trim():Z?Z[Re].trim():void 0,Le.lresn=Z?Z[Re].trim():void 0,Le.atom=xe?xe[Re].replace(/"/gm,""):we?we[Re].replace(/"/gm,""):void 0,Le.icode=Ue?Ue[Re]:void 0,Le.altLoc=Le.icode,Le.hetflag=!ne||ne[Re]==="HETA"||ne[Re]==="HETATM";let We="X";ie&&(We=ie[Re].replace(/\(?\+?\d+.*/,"")),Le.elem=We[0].toUpperCase()+We.substring(1,2).toLowerCase(),Ne&&(Le.b=Ne[Re]),!(c&&Le.elem=="H")&&(Le.altLoc!=""&&Le.altLoc!=p&&p!="*"||(Le.bonds=[],Le.ss="c",Le.serial=Ge[Re],Le.model=ze,Le.bondOrder=[],Le.properties={},Le.index=x[x.length-1].length,O[Le.serial]=[x.length,Le.index],x[x.length-1].push(Le),z.add(Le)))}if(z.setBonds(R,G),!(0,d.isEmpty)(F))for(let Re=S;Re<x.length;Re++){let Le=x[Re];for(let We=0;We<Le.length;We++){const He=Le[We];if(He!==void 0&&He.lchain in F&&He.lresi in F[He.lchain]){const H=F[He.lchain][He.lresi];He.ss=H[0],H.length>1&&(H[1]=="1"?He.ssbegin=!0:H[1]=="2"&&(He.ssend=!0))}}}l.multimodel&&M<w-1&&(l.onemol||(x.push([]),y.push({symmetries:[]})))}for(let M=0;M<x.length;M++)C&&!(l.duplicateAssemblyAtoms&&!l.dontConnectDuplicatedAtoms)&&(0,a.assignPDBBonds)(x[M],l),b&&(0,r.computeSecondaryStructure)(x[M],l.hbondCutoff),(0,s.processSymmetries)(y[M].symmetries,x[M],l,y[M].cryst),l.duplicateAssemblyAtoms&&!l.dontConnectDuplicatedAtoms&&C&&(0,a.assignPDBBonds)(x[M],l);return x}},"./src/parsers/CDJSON.ts":(n,e,t)=>{t.r(e),t.d(e,{CDJSON:()=>i});function i(r,s){var o=[[]];typeof r=="string"&&(r=JSON.parse(r));for(var a=r.m,h=a[0].a,d=a[0].b,u=a[0].s,m=s!==void 0&&s.parseStyle!==void 0?s.parseStyle:u!==void 0,v=o[o.length-1].length,_=0;_<h.length;_++){var D=h[_],f={};f.id=D.i,f.x=D.x,f.y=D.y,f.z=D.z||0,f.bonds=[],f.bondOrder=[];var l=D.l||"C";f.elem=l[0].toUpperCase()+l.substring(1).toLowerCase(),f.serial=o[o.length-1].length,m&&(f.style=u[D.s||0]),o[o.length-1].push(f)}for(let c=0;c<d.length;c++){let p=d[c],b=p.b+v,E=p.e+v,C=p.o||1,g=o[o.length-1][b],x=o[o.length-1][E];g.bonds.push(E),g.bondOrder.push(C),x.bonds.push(b),x.bondOrder.push(C)}return o}},"./src/parsers/CIF.ts":(n,e,t)=>{t.r(e),t.d(e,{CIF:()=>h});var i=t("./src/parsers/utils/computeSecondaryStructure.ts"),r=t("./src/parsers/utils/processSymmetries.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/parsers/utils/assignPDBBonds.ts");const a=function(d,u,m,v){return new s.Vector3(u,m,v).applyMatrix3(d)};function h(d,u={}){const m=[],v=!u.doAssembly,_=m.modelData=[],D=u.assignBonds===void 0?!0:u.assignBonds;function f(C,g){const x=[];let y=0,w=0;for(;w<C.length;){for(;C.substring(w,w+g.length)!==g&&w<C.length;)if(C[w]==="'"){for(w++;w<C.length&&C[w]!=="'";)w++;for(;C.substring(w,w+g.length)!==g&&w<C.length;)w++}else if(C[w]==='"'){for(w++;w<C.length&&C[w]!=='"';)w++;w++}else w++;x.push(C.substring(y,w)),y=w=w+g.length}return x}const l=d.split(/\r?\n|\r/),c=[];let p=!1;for(let C=0;C<l.length;C++){var b=l[C].split("#")[0];if(p?b[0]===";"&&(p=!1):b[0]===";"&&(p=!0),p||b!==""){if(!p&&(b=b.trim(),b[0]==="_")){const g=b.split(/\s/)[0].indexOf(".");if(g>-1){let x=b.split("");x[g]="_",b=x.join(""),b=b.substring(0,g)+"_"+b.substring(g+1)}}c.push(b)}}let E=0;for(;E<c.length;){for(;!c[E].startsWith("data_")||c[E]==="data_global";)E++;E++;const C={};for(;E<c.length&&!c[E].startsWith("data_");)if(c[E][0]===void 0)E++;else if(c[E][0]==="_"){const w=c[E].split(/\s/)[0].toLowerCase(),M=C[w]=C[w]||[],S=c[E].substring(c[E].indexOf(w)+w.length);if(S==="")if(E++,c[E][0]===";"){let O=c[E].substring(1);for(E++;c[E]!==";";)O=O+`
`+c[E],E++;M.push(O)}else M.push(c[E]);else M.push(S.trim());E++}else if(c[E].substring(0,5)==="loop_"){E++;const w=[];for(;c[E]===""||c[E][0]==="_";){if(c[E]!==""){let S=c[E].split(/\s/)[0].toLowerCase(),O=C[S]=C[S]||[];w.push(O)}E++}let M=0;for(;E<c.length&&c[E][0]!=="_"&&!c[E].startsWith("loop_")&&!c[E].startsWith("data_");){let S=f(c[E]," ");for(let O=0;O<S.length;O++)S[O]!==""&&(w[M].push(S[O]),M=(M+1)%w.length);E++}}else E++;_.push({symmetries:[]}),m.push([]);const g=C._atom_site_id!==void 0?C._atom_site_id.length:C._atom_site_label.length;let x;if(C._cell_length_a!==void 0){const w=parseFloat(C._cell_length_a),M=parseFloat(C._cell_length_b),S=parseFloat(C._cell_length_c),O=parseFloat(C._cell_angle_alpha)||90,P=parseFloat(C._cell_angle_beta)||90,I=parseFloat(C._cell_angle_gamma)||90;x=(0,s.conversionMatrix3)(w,M,S,O,P,I),_[_.length-1].cryst={a:w,b:M,c:S,alpha:O,beta:P,gamma:I}}for(let w=0;w<g;w++){if(C._atom_site_group_pdb!==void 0&&C._atom_site_group_pdb[w]==="TER")continue;const M={};if(C._atom_site_cartn_x!==void 0)M.x=parseFloat(C._atom_site_cartn_x[w]),M.y=parseFloat(C._atom_site_cartn_y[w]),M.z=parseFloat(C._atom_site_cartn_z[w]);else{const O=a(x,parseFloat(C._atom_site_fract_x[w]),parseFloat(C._atom_site_fract_y[w]),parseFloat(C._atom_site_fract_z[w]));M.x=O.x,M.y=O.y,M.z=O.z}M.chain=C._atom_site_auth_asym_id?C._atom_site_auth_asym_id[w]:C._atom_site_label_asym_id?C._atom_site_label_asym_id[w]:void 0,M.lchain=C._atom_site_label_asym_id?C._atom_site_label_asym_id[w]:void 0,M.resi=C._atom_site_auth_seq_id?parseInt(C._atom_site_auth_seq_id[w]):C._atom_site_label_seq_id?C._atom_site_label_seq_id[w]:void 0,M.resn=C._atom_site_auth_comp_id?C._atom_site_auth_comp_id[w].trim():C._atom_site_label_comp_id?C._atom_site_label_comp_id[w].trim():void 0,M.atom=C._atom_site_auth_atom_id?C._atom_site_auth_atom_id[w].replace(/"/gm,""):C._atom_site_label_atom_id?C._atom_site_label_atom_id[w].replace(/"/gm,""):void 0,M.hetflag=!C._atom_site_group_pdb||C._atom_site_group_pdb[w]==="HETA"||C._atom_site_group_pdb[w]==="HETATM",C._atom_site_b_iso_or_equiv&&(M.b=parseFloat(C._atom_site_b_iso_or_equiv[w]));let S="X";C._atom_site_type_symbol?S=C._atom_site_type_symbol[w].replace(/\(?\+?\d+.*/,""):C._atom_site_label&&(S=C._atom_site_label[w].split("_")[0].replace(/\(?\d+.*/,"")),M.elem=S[0].toUpperCase()+S.substring(1,2).toLowerCase(),M.bonds=[],M.ss="c",M.serial=w,M.bondOrder=[],M.properties={},m[m.length-1].push(M)}if(C._pdbx_struct_oper_list_id!==void 0&&!v)for(let w=0;w<C._pdbx_struct_oper_list_id.length;w++){const M=parseFloat(C["_pdbx_struct_oper_list_matrix[1][1]"][w]),S=parseFloat(C["_pdbx_struct_oper_list_matrix[1][2]"][w]),O=parseFloat(C["_pdbx_struct_oper_list_matrix[1][3]"][w]),P=parseFloat(C["_pdbx_struct_oper_list_vector[1]"][w]),I=parseFloat(C["_pdbx_struct_oper_list_matrix[2][1]"][w]),F=parseFloat(C["_pdbx_struct_oper_list_matrix[2][2]"][w]),k=parseFloat(C["_pdbx_struct_oper_list_matrix[2][3]"][w]),B=parseFloat(C["_pdbx_struct_oper_list_vector[2]"][w]),U=parseFloat(C["_pdbx_struct_oper_list_matrix[3][1]"][w]),W=parseFloat(C["_pdbx_struct_oper_list_matrix[3][2]"][w]),R=parseFloat(C["_pdbx_struct_oper_list_matrix[3][3]"][w]),z=parseFloat(C["_pdbx_struct_oper_list_vector[3]"][w]),G=new s.Matrix4(M,S,O,P,I,F,k,B,U,W,R,z);_[_.length-1].symmetries.push(G)}const y=function(w){const M=w.match("-");w=w.replace(/[-xyz]/g,"");const S=w.split("/");let O,P;return S[1]===void 0?P=1:P=parseInt(S[1]),S[0]===""?O=1:O=parseInt(S[0]),O/P*(M?-1:1)};if(C._symmetry_equiv_pos_as_xyz!==void 0&&!v)for(let w=0;w<C._symmetry_equiv_pos_as_xyz.length;w++){const S=C._symmetry_equiv_pos_as_xyz[w].replace(/["' ]/g,"").split(",").map(function(F){return F.replace(/-/g,"+-")});let O=new s.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let F=0;F<3;F++){const k=S[F].split("+");for(let B=0;B<k.length;B++){const U=k[B];if(U==="")continue;const W=y(U);U.match("x")?O.elements[F+0]=W:U.match("y")?O.elements[F+4]=W:U.match("z")?O.elements[F+8]=W:O.elements[F+12]=W}}const P=x.getMatrix4(),I=new s.Matrix4().getInverse(P,!0);O=new s.Matrix4().multiplyMatrices(O,I),O=new s.Matrix4().multiplyMatrices(P,O),_[_.length-1].symmetries.push(O)}}for(let C=0;C<m.length;C++)D&&!(u.duplicateAssemblyAtoms&&!u.dontConnectDuplicatedAtoms)&&(0,o.assignPDBBonds)(m[C],u),(0,i.computeSecondaryStructure)(m[C],u.hbondCutoff),(0,r.processSymmetries)(_[C].symmetries,m[C],u,_[C].cryst),u.duplicateAssemblyAtoms&&!u.dontConnectDuplicatedAtoms&&D&&(0,o.assignPDBBonds)(m[C],u);return m}},"./src/parsers/CUBE.ts":(n,e,t)=>{t.r(e),t.d(e,{CUBE:()=>o});var i=t("./src/WebGL/index.ts"),r=t("./src/parsers/utils/assignBonds.ts"),s=t("./src/parsers/utils/anumToSymbol.ts");function o(a,h){h=h||{};const d=[[]];let u=a.split(/\r?\n/);const m=h.assignBonds===void 0?!0:h.assignBonds;if(u.length<6)return d;let v=u[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const _=Math.abs(parseFloat(v[0]));let D={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const f=D.origin=new i.Vector3(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3]));v=u[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),v=u[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const l=v[0]>0?.529177:1;f.multiplyScalar(l);const c=Math.abs(v[0]),p=new i.Vector3(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])).multiplyScalar(l);v=u[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const b=Math.abs(v[0]),E=new i.Vector3(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])).multiplyScalar(l);v=u[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const C=Math.abs(v[0]),g=new i.Vector3(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])).multiplyScalar(l);if(D.size={x:c,y:b,z:C},D.unit=new i.Vector3(p.x,E.y,g.z),p.y!=0||p.z!=0||E.x!=0||E.z!=0||g.x!=0||g.y!=0){D.matrix4=new i.Matrix4(p.x,E.x,g.x,0,p.y,E.y,g.y,0,p.z,E.z,g.z,0,0,0,0,1);let P=new i.Matrix4().makeTranslation(f.x,f.y,f.z);D.matrix4=D.matrix4.multiplyMatrices(P,D.matrix4),D.matrix=D.matrix4.matrix3FromTopLeft(),D.origin=new i.Vector3(0,0,0),D.unit=new i.Vector3(1,1,1)}d.modelData=[{cryst:D}],u=u.splice(6,_);for(var x=d[d.length-1].length,y=x+u.length,w=x;w<y;++w){var M={};M.serial=w;var S=u[w-x],O=S.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");M.elem=s.anumToSymbol[O[0]],M.x=parseFloat(O[2])*l,M.y=parseFloat(O[3])*l,M.z=parseFloat(O[4])*l,M.hetflag=!0,M.bonds=[],M.bondOrder=[],M.properties={},d[d.length-1].push(M)}if(m)for(let P=0;P<d.length;P++)(0,r.assignBonds)(d[P],h);return d}},"./src/parsers/GRO.ts":(n,e,t)=>{t.r(e),t.d(e,{GRO:()=>s});var i=t("./src/parsers/utils/assignPDBBonds.ts"),r=t("./src/parsers/utils/atomNameToElem.ts");function s(o,a){const h=[],d=o.split(/\r?\n|\r/);for(;d.length>0;){const u=parseInt(d[1]);if(d.length<3||isNaN(u)||u<=0||d.length<u+3)break;const v=[];h.push(v);let _=2;const D=v.length,f=D+u;for(let l=D;l<f;l++){const c=d[_++],p={};p.serial=l,p.atom=c.slice(10,15).trim(),p.elem=(0,r.atomNameToElem)(p.atom,!0),p.x=10*parseFloat(c.slice(20,28)),p.y=10*parseFloat(c.slice(28,36)),p.z=10*parseFloat(c.slice(36,44)),p.resi=parseInt(c.slice(0,5)),p.resn=c.slice(5,10).trim(),p.bonds=[],p.bondOrder=[],p.properties={},c.length>44&&(p.dx=10*parseFloat(c.slice(44,52)),p.dy=10*parseFloat(c.slice(52,60)),p.dz=10*parseFloat(c.slice(60,68))),v[l]=p}if(d.length<=_+3){const c=d[_++].trim().split(/\s+/);if(c.length===3){for(let p=0;p<3;p++)c[p]=(parseFloat(c[p])*10).toString();h.box=c}}d.splice(0,++_)}for(let u=0;u<h.length;u++)(0,i.assignPDBBonds)(h[u],a);return h}},"./src/parsers/LAMMPSTRJ.ts":(n,e,t)=>{t.r(e),t.d(e,{LAMMPSTRJ:()=>s});var i=t("./src/parsers/utils/assignBonds.ts");const r={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function s(o,a){const h=[],d=o.split(/\r?\n|\r/);let u=0,m=0,v=0;for(;v<d.length-9;){for(var _=v;_<d.length;_++)if(d[_].match(/ITEM: NUMBER OF ATOMS/)&&(m=parseInt(d[_+1])),d[_].match(/ITEM: ATOMS/)){u=_+1;break}const D=d[u-1].replace("ITEM: ATOMS ","").split(" ");h.push([]);for(let f=u;f<u+m;f++){const l={},c={},p=d[f].split(" ");for(let b=0;b<p.length;b++){const E=r[D[b]];E!==void 0&&(E==="serial"?l[E]=parseInt(p[b]):E==="x"||E==="y"||E==="z"?l[E]=parseFloat(p[b]):E==="charge"||E==="radius"?c[E]=parseFloat(p[b]):l[E]=p[b]),l.properties=c,l.bonds=[],l.bondOrder=[]}h[h.length-1][f-u]=l}v=u+m-1}if(a.assignBonds)for(let D=0;D<h.length;D++)(0,i.assignBonds)(h[D],a);return h}},"./src/parsers/MMTF.ts":(n,e,t)=>{t.r(e),t.d(e,{MMTFparser:()=>m});var i=t("./src/utilities.ts"),r=t("./src/WebGL/index.ts"),s=t("./src/parsers/utils/computeSecondaryStructure.ts"),o=t("./src/parsers/utils/processSymmetries.ts"),a=t("./src/vendor/mmtf.js"),h=function(v){return String.fromCharCode.apply(null,v).replace(/\0/g,"")},d=function(v){return v==0||v==2||v==4?"h":v==3?"s":"c"};let u=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function m(v,_){var D=!_.keepH,f=_.altLoc?_.altLoc:"A",l=!!_.noSecondaryStructure,c=!_.noComputeSecondaryStructure,p=!_.doAssembly,b=_.assemblyIndex?_.assemblyIndex:0;typeof v=="string"?v=(0,i.base64ToArray)(v):v=new Uint8Array(v);var E=a.decode(v),C=[[]],g=C.modelData=[],x=0,y=0,w=0,M=E.secStructList,S=E.bFactorList,O=E.altLocList,P=E.occupancyList,I=E.bondAtomList,F=E.bondOrderList,k=E.numModels;if(k==0)return C;_.multimodel||(k=1);var B,U,W,R,z,G,q=[];if(!p&&E.bioAssemblyList&&E.bioAssemblyList.length>0){var Q=E.bioAssemblyList[b].transformList;for(B=0,G=Q.length;B<G;B++){var ne=new r.Matrix4(Q[B].matrix);ne.transpose(),q.push(ne)}}var te=null;if(E.unitCell){var oe=E.unitCell;te={a:oe[0],b:oe[1],c:oe[2],alpha:oe[3],beta:oe[4],gamma:oe[5]}}let re=[];E.entityList.forEach(de=>{de.chainIndexList.forEach($=>{re[$]=de.type=="polymer"})});var le=0;for(z=0;z<k;z++){var Ce=E.chainsPerModel[z],De=C[C.length-1],Oe=[];for(g.push({symmetries:q,cryst:te}),B=0;B<Ce;++B){var _e=E.groupsPerChain[x],Z=h(E.chainIdList.subarray(x*4,x*4+4));E.chainNameList&&(Z=h(E.chainNameList.subarray(x*4,x*4+4)));var xe=y,we="";for(U=0;U<_e;++U){var ie=E.groupList[E.groupTypeList[y]],Ne=ie.atomNameList.length,Ge=0,Ue=!1,Ie=!1;if(M){Ge=M[y];var ze=d(Ge);(y==0||ze!=we)&&(Ue=!0),we=ze;var Re=y+1;(Re>=M.length||d(M[Re]!=ze))&&(Ie=!0)}var Le=E.groupIdList[y],We=ie.groupName;let de=ie.chemCompType;var He=w;let $=u.has(de)||!re[x];for(W=0;W<Ne;++W){var H=ie.elementList[W];if(D&&H=="H"){w+=1;continue}var K="";S&&(K=S[w]);var X="";O&&O[w]&&(X=String.fromCharCode(O[w]));var pe="";if(P&&(pe=P[w]),X!=""&&X!=f&&f!="*"){w+=1;continue}var ue=E.atomIdList[w],ye=ie.atomNameList[W],Se=0;ie.atomChargeList&&(Se=ie.atomChargeList[W]);var V=E.xCoordList[w],he=E.yCoordList[w],ve=E.zCoordList[w];Oe[w]=De.length,De.push({resn:We,x:V,y:he,z:ve,elem:H,hetflag:$,chain:Z,resi:Le,icode:X,rescode:Le+(X!=" "?"^"+X:""),serial:ue,altLoc:X,index:w,atom:ye,bonds:[],ss:d(Ge),ssbegin:Ue,ssend:Ie,bondOrder:[],properties:{charge:Se,occupancy:pe},b:K}),w+=1}var Pe=ie.bondAtomList;for(W=0,R=ie.bondOrderList.length;W<R;++W){var ae=He+Pe[W*2],me=He+Pe[W*2+1],j=ie.bondOrderList[W],Te=Oe[ae],Be=Oe[me],L=De[Te],ge=De[Be];L&&ge&&(L.bonds.push(Be),L.bondOrder.push(j),ge.bonds.push(Te),ge.bondOrder.push(j))}y+=1}for(y=xe,U=0;U<_e;++U)y+=1;x+=1}if(I)for(let de=le,$=I.length;de<$;de+=2){let se=I[de],ce=I[de+1],Fe=F?F[de/2]:1;if(se>=w){le=de;break}let ke=Oe[se],Ee=Oe[ce],$e=De[ke],Xe=De[Ee];$e&&Xe&&($e.bonds.push(Ee),$e.bondOrder.push(Fe),Xe.bonds.push(ke),Xe.bondOrder.push(Fe))}_.multimodel&&(_.onemol||C.push([]))}if(!p)for(let de=0;de<C.length;de++)(0,o.processSymmetries)(g[de].symmetries,C[de],_,g[de].cryst);return c&&!l&&(0,s.computeSecondaryStructure)(C,_.hbondCutoff),C}},"./src/parsers/MOL2.ts":(n,e,t)=>{t.r(e),t.d(e,{MOL2:()=>r});let i={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function r(s,o){var a=[[]],h=!1;typeof o.keepH<"u"&&(h=!o.keepH);var d=s.search(/@<TRIPOS>MOLECULE/),u=s.search(/@<TRIPOS>ATOM/);if(d==-1||u==-1)return a;for(var m=s.substring(d).split(/\r?\n|\r/);m.length>0;){var v=[],_=m[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),D=parseInt(_[0]),f=0;_.length>1&&(f=parseInt(_[1]));var l=4,c;for(c=3;c<m.length;c++)if(m[c]=="@<TRIPOS>ATOM"){l=c+1;break}var p=a[a.length-1].length,b=p+D,E;for(c=p;c<b;c++){E=m[l++],_=E.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var C={},g=_[5];if(i[g]!==void 0?g=i[g]:(g=g.split(".")[0],g=g[0].toUpperCase()+g.substring(1).toLowerCase()),C.atom=_[1],C.elem=g,!(C.elem=="H"&&h)){var x=a[a.length-1].length,y=parseInt(_[0]);C.serial=y,C.x=parseFloat(_[2]),C.y=parseFloat(_[3]),C.z=parseFloat(_[4]),C.atom=_[5];var w=parseFloat(_[8]);C.index=x,C.bonds=[],C.bondOrder=[],C.properties={charge:w,partialCharge:w},v[y]=x,a[a.length-1].push(C)}}for(var M=!1;l<m.length;)if(m[l++]=="@<TRIPOS>BOND"){M=!0;break}if(M&&f)for(c=0;c<f;c++){E=m[l++],_=E.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var S=parseInt(_[1]),O=a[a.length-1][v[S]],P=parseInt(_[2]),I=a[a.length-1][v[P]],F=parseInt(_[3]);isNaN(F)&&(F=1),O!==void 0&&I!==void 0&&(O.bonds.push(v[P]),O.bondOrder.push(F),I.bonds.push(v[S]),I.bondOrder.push(F))}if(o.multimodel){o.onemol||a.push([]),m.splice(0,l),s=m.join(`
`);continue}else break}return a}},"./src/parsers/PDB.ts":(n,e,t)=>{t.r(e),t.d(e,{PDB:()=>r});var i=t("./src/parsers/utils/getSinglePDB.ts");function r(s,o){o=o||{};var a=[],h={};a.modelData=[];for(var d=s.split(/\r?\n|\r/);d.length>0;){var u=(0,i.getSinglePDB)(d,o,h),m=u[0],v=u[1];if(d=u[2],m.length!=0){if(o.multimodel&&o.onemol&&a.length>0)for(var _=a[0].length,D=0;D<m.length;D++){var f=m[D];f.index=D;for(var l=0;l<f.bonds.length;l++)f.bonds[l]+=_;a[0].push(f)}else a.modelData.push(v),a.push(m);if(!o.multimodel)break}}return a}},"./src/parsers/PQR.ts":(n,e,t)=>{t.r(e),t.d(e,{PQR:()=>s});var i=t("./src/parsers/utils/assignPDBBonds.ts"),r=t("./src/parsers/utils/computeSecondaryStructure.ts");function s(o,a){var h=[[]],d=!a.noSecondaryStructure;h.modelData=[{symmetries:[]}];var u=[],m=o.split(/\r?\n|\r/),v;for(let M=0;M<m.length;M++){v=m[M].replace(/^\s*/,"");var _=v.substring(0,6);if(_.indexOf("END")==0)if(a.multimodel){a.onemol||h.push([]);continue}else break;else if(_=="ATOM  "||_=="HETATM"){var D;let S=parseInt(v.substring(6,11)),O=v.substring(12,16).replace(/ /g,""),P=v.substring(17,20).trim(),I=v.substring(21,22),F=parseInt(v.substring(22,26));var f=v.substring(30).trim().split(/\s+/),l=parseFloat(f[0]),c=parseFloat(f[1]),p=parseFloat(f[2]),b=parseFloat(f[3]),E=parseFloat(f[4]),C=O[0];O.length>1&&O[1].toUpperCase()!=O[1]&&(C=O.substring(0,2)),v[0]=="H"?D=!0:D=!1,u[S]=h[h.length-1].length,h[h.length-1].push({resn:P,x:l,y:c,z:p,elem:C,hetflag:D,chain:I,resi:F,serial:S,atom:O,bonds:[],ss:"c",bondOrder:[],properties:{charge:b,partialCharge:b,radius:E},pdbline:v})}else if(_=="CONECT"){var g=parseInt(v.substring(6,11)),x=h[h.length-1][u[g]];for(let S=0;S<4;S++){var y=parseInt(v.substring([11,16,21,26][S],[11,16,21,26][S]+5)),w=h[h.length-1][u[y]];x!==void 0&&w!==void 0&&(x.bonds.push(u[y]),x.bondOrder.push(1))}}}for(let M=0;M<h.length;M++)(0,i.assignPDBBonds)(h[M],a),d&&(0,r.computeSecondaryStructure)(h[M],a.hbondCutoff);return h}},"./src/parsers/PRMTOP.ts":(n,e,t)=>{t.r(e),t.d(e,{PRMTOP:()=>i});function i(r){var s=[],o,a=0,h=r.split(/\r?\n|\r/);if(h.length>0&&h[0].includes("VERSION")){var d=h.filter(function(p){return p.includes("POINTERS")||p.includes("ATOM_NAME")||p.includes("CHARGE")||p.includes("RADII")||p.includes("BONDS_INC_HYDROGEN")||p.includes("BONDS_WITHOUT_HYDROGEN")||p.includes("RESIDUE_LABEL")||p.includes("RESIDUE_POINTER")}),u=f("POINTERS");if(u==-1)return[];var m=l(u),v=parseInt(h[u+1].slice(0,m[1]));let c=parseInt(h[u+2].slice(m[1],m[0]+m[1]));if(isNaN(v)||v<=0)return[];if(u=f("ATOM_NAME"),u==-1)return[];m=l(u);var _=m[0];for(let p=0;p<v/m[0];p++){p==parseInt(v/m[0])&&(_=v%m[0]);for(let b=0;b<_;b++){let E={},C={charge:"",radii:""};E.serial=a,E.x=0,E.y=0,E.z=0,E.atom=h[u+1].slice(m[1]*b,m[1]*(b+1)).trim(),E.elem=h[u+1].slice(m[1]*b,m[1]*b+1).trim(),E.properties=C,E.bonds=[],E.bondOrder=[],E.index=s.length,s.push(E),a++}u++}if(u=f("CHARGE"),u!=-1){m=l(u),a=0,_=m[0];for(let p=0;p<v/m[0];p++){p==parseInt(v/m[0])&&(_=v%m[0]);for(let b=0;b<_;b++)s[a].properties.charge=parseFloat(h[u+1].slice(m[1]*b,m[1]*(b+1))),a++;u++}}u=f("RESIDUE_POINTER");var D=[];if(u!=-1){m=l(u),_=m[0],u+=1;for(let p=0;p<c/m[0];p++){p==parseInt(c/m[0])&&(_=c%m[0]);for(let b=0;b<_;b++)D.push(parseInt(h[u].slice(m[1]*b,m[1]*(b+1))));u++}if(u=f("RESIDUE_LABEL"),u!=-1){let p=[];m=l(u),_=m[0],u+=1;for(let g=0;g<c/m[0];g++){g==parseInt(c/m[0])&&(_=c%m[0]);for(let x=0;x<_;x++)p.push(h[u].slice(m[1]*x,m[1]*(x+1)).trim());u++}let b=0,E=0,C="";D.push(s.length+1);for(let g=0;g<s.length;g++)g+1>=D[b]&&(C=p[b],b+=1,E+=1),s[g].resi=E,s[g].resn=C}}if(u=f("RADII"),u!=-1){m=l(u),a=0,_=m[0];for(let p=0;p<v/m[0];p++){p==parseInt(v/m[0])&&(_=v%m[0]);for(let b=0;b<_;b++)s[a].properties.radii=parseFloat(h[u+1].slice(m[1]*b,m[1]*(b+1))),a++;u++}}if(u=f("BONDS_WITHOUT_HYDROGEN"),u!=-1)for(m=l(u),a=0,_=m[0],u=u+1;!h[u].match(/^%FLAG/);){h[u+1].match(/^%FLAG/)&&(_=v%m[0]);for(let p=0;p<_;p++)a%3==0?o=parseInt(h[u].slice(m[1]*p,m[1]*(p+1))/3):a%3==1&&(s[o].bonds.push(parseInt(h[u].slice(m[1]*p,m[1]*(p+1))/3)),s[o].bondOrder.push(1)),a++;u++}if(u=f("BONDS_INC_HYDROGEN"),u!=-1)for(m=l(u),a=0,_=m[0],u=u+1;!h[u].match(/^%FLAG/);){h[u+1].match(/^%FLAG/)&&(_=v%m[0]);for(let p=0;p<_;p++)a%3==0?o=parseInt(h[u].slice(m[1]*p,m[1]*(p+1))/3):a%3==1&&(s[o].bonds.push(parseInt(h[u].slice(m[1]*p,m[1]*(p+1))/3)),s[o].bonds.push(1)),a++;u++}}else return[];function f(c){var p=h.indexOf(d.filter(function(b){return b.includes(c)})[0]);if(Number.isInteger(p)&&p>0){for(;!h[p].includes("FORMAT");)p++;return p}else return-1}function l(c){var p=h[c].match(/\((\d*)\S*/),b=h[c].match(/[a-zA-Z](\d*)\)\s*/);return b==null&&(b=h[c].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(p[1]),parseInt(b[1])]}return[s]}},"./src/parsers/SDF.ts":(n,e,t)=>{t.r(e),t.d(e,{SDF:()=>s});var i=function(o,a){var h=[[]],d=!1;for(typeof a.keepH<"u"&&(d=!a.keepH);o.length>0&&!(o.length<4);){var u=parseInt(o[3].substring(0,3));if(isNaN(u)||u<=0)break;var m=parseInt(o[3].substring(3,6)),v=4;if(o.length<4+u+m)break;var _=[],D=h[h.length-1].length,f=D+u,l,c;for(l=D;l<f;l++,v++){c=o[v];var p={},b=c.substring(31,34).replace(/ /g,"");p.atom=p.elem=b[0].toUpperCase()+b.substring(1).toLowerCase(),(p.elem!=="H"||!d)&&(p.serial=l,_[l]=h[h.length-1].length,p.x=parseFloat(c.substring(0,10)),p.y=parseFloat(c.substring(10,20)),p.z=parseFloat(c.substring(20,30)),p.hetflag=!0,p.bonds=[],p.bondOrder=[],p.properties={},p.index=h[h.length-1].length,h[h.length-1].push(p))}for(l=0;l<m;l++,v++){c=o[v];var E=_[parseInt(c.substring(0,3))-1+D],C=_[parseInt(c.substring(3,6))-1+D],g=parseFloat(c.substring(6));typeof E<"u"&&typeof C<"u"&&(h[h.length-1][E].bonds.push(C),h[h.length-1][E].bondOrder.push(g),h[h.length-1][C].bonds.push(E),h[h.length-1][C].bondOrder.push(g))}if(a.multimodel){for(a.onemol||h.push([]);o[v]!=="$$$$"&&v<o.length;)v++;o.splice(0,++v)}else break}return h},r=function(o,a){var h=[[]],d=!1;for(typeof a.keepH<"u"&&(d=!a.keepH);o.length>0&&!(o.length<8||!o[4].startsWith("M  V30 BEGIN CTAB")||!o[5].startsWith("M  V30 COUNTS")||o[5].length<14);){var u=o[5].substring(13).match(/\S+/g);if(u.length<2)break;var m=parseInt(u[0]);if(isNaN(m)||m<=0)break;var v=parseInt(u[1]),_=7;if(o.length<8+m+v)break;var D=[],f=h[h.length-1].length,l=f+m,c,p;for(c=f;c<l;c++,_++){p=o[_];var b=p.substring(6).match(/\S+/g);if(b.length>4){var E={},C=b[1].replace(/ /g,"");E.atom=E.elem=C[0].toUpperCase()+C.substring(1).toLowerCase(),(E.elem!=="H"||!d)&&(E.serial=c,D[c]=h[h.length-1].length,E.x=parseFloat(b[2]),E.y=parseFloat(b[3]),E.z=parseFloat(b[4]),E.hetflag=!0,E.bonds=[],E.bondOrder=[],E.properties={},E.index=h[h.length-1].length,h[h.length-1].push(E))}}if(o[_]==="M  V30 END ATOM")_++;else break;if(v!==0&&o[_]==="M  V30 BEGIN BOND")_++;else break;for(c=0;c<v;c++,_++){p=o[_];var g=p.substring(6).match(/\S+/g);if(g.length>3){var x=D[parseInt(g[2])-1+f],y=D[parseInt(g[3])-1+f],w=parseFloat(g[1]);typeof x<"u"&&typeof y<"u"&&(h[h.length-1][x].bonds.push(y),h[h.length-1][x].bondOrder.push(w),h[h.length-1][y].bonds.push(x),h[h.length-1][y].bondOrder.push(w))}}if(a.multimodel){for(a.onemol||h.push([]);o[_]!=="$$$$"&&_<o.length;)_++;o.splice(0,++_)}else break}return h};function s(o,a){var h="V2000",d=o.split(/\r?\n|\r/);return d.length>3&&d[3].length>38&&(h=d[3].substring(34,39)),h==="V2000"?i(d,a):h==="V3000"?r(d,a):[[""]]}},"./src/parsers/VASP.ts":(n,e,t)=>{t.r(e),t.d(e,{VASP:()=>s});var i=t("./src/WebGL/index.ts"),r=t("./src/parsers/utils/assignBonds.ts");function s(o,a={}){var h=[[]],d={};const u=a.assignBonds===void 0?!0:a.assignBonds;var m=o.replace(/^\s+/,"").split(/\r?\n/);if(m.length<3)return h;if(m[1].match(/\d+/))d.length=parseFloat(m[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),h;if(d.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),h;d.xVec=new Float32Array(m[2].replace(/^\s+/,"").split(/\s+/)),d.yVec=new Float32Array(m[3].replace(/^\s+/,"").split(/\s+/)),d.zVec=new Float32Array(m[4].replace(/^\s+/,"").split(/\s+/));var v=new i.Matrix3(d.xVec[0],d.xVec[1],d.xVec[2],d.yVec[0],d.yVec[1],d.yVec[2],d.zVec[0],d.zVec[1],d.zVec[2]);v.multiplyScalar(d.length),h.modelData=[{symmetries:[],cryst:{matrix:v}}];var _=m[5].trim().split(/\s+/),D=new Int16Array(m[6].trim().split(/\s+/)),f=m[7].trim(),l=!1;if(f.match(/S/)&&(l=!0,f=m[8].trim()),f.toLowerCase()[0]=="c")f="cartesian";else if(f.toLowerCase()[0]=="d")f="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),h;if(_.length!=D.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(_),console.log(D),h;l?m.splice(0,9):m.splice(0,8);for(var c=0,p=0,b=_.length;p<b;p++){for(var E=_[p],C=0,g=D[p];C<g;C++){var x=new Float32Array(m[c+C].trim().split(/\s+/)),y={};y.elem=E,f=="cartesian"?(y.x=d.length*x[0],y.y=d.length*x[1],y.z=d.length*x[2]):(y.x=d.length*(x[0]*d.xVec[0]+x[1]*d.yVec[0]+x[2]*d.zVec[0]),y.y=d.length*(x[0]*d.xVec[1]+x[1]*d.yVec[1]+x[2]*d.zVec[1]),y.z=d.length*(x[0]*d.xVec[2]+x[1]*d.yVec[2]+x[2]*d.zVec[2])),y.bonds=[],y.bondOrder=[],h[0].push(y)}c+=D[p]}if(u)for(let w=0;w<h.length;w++)(0,r.assignBonds)(h[w],a);return h}},"./src/parsers/XYZ.ts":(n,e,t)=>{t.r(e),t.d(e,{XYZ:()=>s});var i=t("./src/WebGL/index.ts"),r=t("./src/parsers/utils/assignBonds.ts");function s(o,a){a=a||{};for(var h=[[]],d=a.assignBonds===void 0?!0:a.assignBonds,u=o.trimStart().split(/\r?\n|\r/);u.length>0&&!(u.length<3);){var m=parseInt(u[0]);if(isNaN(m)||m<=0||u.length<m+2)break;var v=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,_=v.exec(u[1]);if(_!=null&&_.length>1){var D=new Float32Array(_[1].split(/\s+/)),f=new i.Matrix3(D[0],D[3],D[6],D[1],D[4],D[7],D[2],D[5],D[8]);h.modelData=[{cryst:{matrix:f}}]}for(var l=2,c=h[h.length-1].length,p=c+m,b=c;b<p;b++){var E=u[l++],C=E.trim().split(/\s+/),g={};g.serial=b;var x=C[0];g.atom=g.elem=x[0].toUpperCase()+x.substring(1,2).toLowerCase(),g.x=parseFloat(C[1]),g.y=parseFloat(C[2]),g.z=parseFloat(C[3]),g.hetflag=!0,g.bonds=[],g.bondOrder=[],g.properties={},h[h.length-1][b]=g,C.length>=7&&(g.dx=parseFloat(C[4]),g.dy=parseFloat(C[5]),g.dz=parseFloat(C[6]))}if(a.multimodel)h.push([]),u.splice(0,l);else break}if(d)for(let w=0;w<h.length;w++)(0,r.assignBonds)(h[w],a);if(a.onemol){var y=h;h=[],h.push(y[0]);for(let w=1;w<y.length;w++){let M=h[0].length;for(let S=0;S<y[w].length;S++){let O=y[w][S];for(let P=0;P<O.bonds.length;P++)O.bonds[P]=O.bonds[P]+M;O.index=h[0].length,O.serial=h[0].length,h[0].push(O)}}}return h}},"./src/parsers/cifutils/category.ts":(n,e,t)=>{t.r(e),t.d(e,{Category:()=>r});var i=t("./src/parsers/cifutils/decoder.ts");function r(s){const o=Object.create(null),a=Object.create(null);for(const h of s.columns)o[h.name]=h;return{rowCount:s.rowCount,name:s.name.substring(1),fieldNames:s.columns.map(h=>h.name),getField(h){const d=o[h];if(d)return a[h]||(a[h]=(0,i.decode)(d.data)),a[h]}}}},"./src/parsers/cifutils/decoder.ts":(n,e,t)=>{t.r(e),t.d(e,{decode:()=>o});var i=t("./src/parsers/cifutils/encoding.ts");const r=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function s(M,S){const O=new ArrayBuffer(M.length),P=new Uint8Array(O);for(let I=0,F=M.length;I<F;I+=S)for(let k=0;k<S;k++)P[I+S-k-1]=M[I+k];return O}function o(M){let S=M.data;for(let O=M.encoding.length-1;O>=0;O--)S=a(S,M.encoding[O]);return S}function a(M,S){switch(S.kind){case"ByteArray":switch(S.type){case i.Encoding.IntDataType.Uint8:return M;case i.Encoding.IntDataType.Int8:return u(M);case i.Encoding.IntDataType.Int16:return v(M);case i.Encoding.IntDataType.Uint16:return _(M);case i.Encoding.IntDataType.Int32:return D(M);case i.Encoding.IntDataType.Uint32:return f(M);case i.Encoding.FloatDataType.Float32:return l(M);case i.Encoding.FloatDataType.Float64:return c(M);default:throw new Error("unreachable")}case"FixedPoint":return p(M,S);case"IntervalQuantization":return b(M,S);case"RunLength":return E(M,S);case"Delta":return C(M,S);case"IntegerPacking":return y(M,S);case"StringArray":return w(M,S)}}function h(M,S){switch(M){case i.Encoding.IntDataType.Int8:return new Int8Array(S);case i.Encoding.IntDataType.Int16:return new Int16Array(S);case i.Encoding.IntDataType.Int32:return new Int32Array(S);case i.Encoding.IntDataType.Uint8:return new Uint8Array(S);case i.Encoding.IntDataType.Uint16:return new Uint16Array(S);case i.Encoding.IntDataType.Uint32:return new Uint32Array(S);default:return new Int32Array(S)}}function d(M,S){switch(M){case i.Encoding.FloatDataType.Float32:return new Float32Array(S);case i.Encoding.FloatDataType.Float64:return new Float64Array(S);default:return new Float64Array(S)}}function u(M){return new Int8Array(M.buffer,M.byteOffset)}function m(M,S,O){return(M.byteOffset!=0||M.byteLength!=M.buffer.byteLength)&&(M=new Uint8Array(M)),r?new O(M.buffer):new O(s(M,S))}function v(M){return m(M,2,Int16Array)}function _(M){return m(M,2,Uint16Array)}function D(M){return m(M,4,Int32Array)}function f(M){return m(M,4,Uint32Array)}function l(M){return m(M,4,Float32Array)}function c(M){return m(M,8,Float64Array)}function p(M,S){const O=M.length,P=d(S.srcType,O),I=1/S.factor;for(let F=0;F<O;F++)P[F]=I*M[F];return P}function b(M,S){const O=M.length,P=d(S.srcType,O),I=(S.max-S.min)/(S.numSteps-1),F=S.min;for(let k=0;k<O;k++)P[k]=F+I*M[k];return P}function E(M,S){const O=h(S.srcType,S.srcSize);let P=0;for(let I=0,F=M.length;I<F;I+=2){const k=M[I],B=M[I+1];for(let U=0;U<B;++U)O[P++]=k}return O}function C(M,S){const O=M.length,P=h(S.srcType,O);if(!O)return M;P[0]=M[0]+(S.origin|0);for(let I=1;I<O;++I)P[I]=M[I]+P[I-1];return P}function g(M,S){const O=S.byteCount===1?127:32767,P=-O-1,I=M.length,F=new Int32Array(S.srcSize);let k=0,B=0;for(;k<I;){let U=0,W=M[k];for(;W===O||W===P;)U+=W,k++,W=M[k];U+=W,F[B]=U,k++,B++}return F}function x(M,S){const O=S.byteCount===1?255:65535,P=M.length,I=new Int32Array(S.srcSize);let F=0,k=0;for(;F<P;){let B=0,U=M[F];for(;U===O;)B+=U,F++,U=M[F];B+=U,I[k]=B,F++,k++}return I}function y(M,S){return M.length===S.srcSize?M:S.isUnsigned?x(M,S):g(M,S)}function w(M,S){const O=o({encoding:S.offsetEncoding,data:S.offsets}),P=o({encoding:S.dataEncoding,data:M}),I=S.stringData,F=new Array(O.length);F[0]="";for(let U=1,W=O.length;U<W;U++)F[U]=I.substring(O[U-1],O[U]);let k=0;const B=new Array(P.length);for(let U=0,W=P.length;U<W;U++)B[k++]=F[P[U]+1];return B}},"./src/parsers/cifutils/encoding.ts":(n,e,t)=>{t.r(e),t.d(e,{Encoding:()=>r,VERSION:()=>i});const i="0.3.0";var r;(function(s){(function(h){h[h.Int8=1]="Int8",h[h.Int16=2]="Int16",h[h.Int32=3]="Int32",h[h.Uint8=4]="Uint8",h[h.Uint16=5]="Uint16",h[h.Uint32=6]="Uint32"})(s.IntDataType||(s.IntDataType={})),function(h){h[h.Float32=32]="Float32",h[h.Float64=33]="Float64"}(s.FloatDataType||(s.FloatDataType={}));function o(h){let d;return h instanceof Int8Array?d=s.IntDataType.Int8:h instanceof Int16Array?d=s.IntDataType.Int16:h instanceof Int32Array?d=s.IntDataType.Int32:h instanceof Uint8Array?d=s.IntDataType.Uint8:h instanceof Uint16Array?d=s.IntDataType.Uint16:h instanceof Uint32Array?d=s.IntDataType.Uint32:h instanceof Float32Array?d=s.FloatDataType.Float32:h instanceof Float64Array?d=s.FloatDataType.Float64:d=s.IntDataType.Int32,d}s.getDataType=o;function a(h){if(h instanceof Int8Array||h instanceof Int16Array||h instanceof Int32Array)return!0;for(let d=0,u=h.length;d<u;d++)if(d<0)return!1;return!0}s.isSignedIntegerDataType=a})(r||(r={}))},"./src/parsers/index.ts":(n,e,t)=>{t.r(e),t.d(e,{Parsers:()=>p,bondLength:()=>c.bondLength,setBondLength:()=>c.setBondLength});var i=t("./src/parsers/VASP.ts"),r=t("./src/parsers/CUBE.ts"),s=t("./src/parsers/XYZ.ts"),o=t("./src/parsers/SDF.ts"),a=t("./src/parsers/CDJSON.ts"),h=t("./src/parsers/CIF.ts"),d=t("./src/parsers/MOL2.ts"),u=t("./src/parsers/PDB.ts"),m=t("./src/parsers/PQR.ts"),v=t("./src/parsers/MMTF.ts"),_=t("./src/parsers/PRMTOP.ts"),D=t("./src/parsers/GRO.ts"),f=t("./src/parsers/LAMMPSTRJ.ts"),l=t("./src/parsers/BCIF.ts"),c=t("./src/parsers/utils/bondLength.ts");const p={vasp:i.VASP,VASP:i.VASP,cube:r.CUBE,CUBE:r.CUBE,xyz:s.XYZ,XYZ:s.XYZ,sdf:o.SDF,SDF:o.SDF,json:a.CDJSON,cdjson:a.CDJSON,CDJSON:a.CDJSON,mcif:h.CIF,cif:h.CIF,CIF:h.CIF,mol2:d.MOL2,MOL2:d.MOL2,pdb:u.PDB,PDB:u.PDB,pdbqt:u.PDB,PDBQT:u.PDB,pqr:m.PQR,PQR:m.PQR,mmtf:v.MMTFparser,MMTF:v.MMTFparser,prmtop:_.PRMTOP,PRMTOP:_.PRMTOP,gro:D.GRO,GRO:D.GRO,lammpstrj:f.LAMMPSTRJ,LAMMPSTRJ:f.LAMMPSTRJ,bcif:l.BCIF,BCIF:l.BCIF}},"./src/parsers/utils/anumToSymbol.ts":(n,e,t)=>{t.r(e),t.d(e,{anumToSymbol:()=>i});const i={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}},"./src/parsers/utils/areConnected.ts":(n,e,t)=>{t.r(e),t.d(e,{areConnected:()=>s});var i=t("./src/parsers/utils/bondLength.ts");const r=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function s(o,a,h){if(h&&h.unboundCations&&(r.has(o.elem)||r.has(a.elem)))return!1;let d=(0,i.bondLength)(o.elem)+(0,i.bondLength)(a.elem);d+=.25,d*=d;let u=o.x-a.x;if(u*=u,u>d)return!1;let m=o.y-a.y;if(m*=m,m>d)return!1;let v=o.z-a.z;if(v*=v,v>d)return!1;const _=u+m+v;return!(isNaN(_)||_<.5||_>d||o.altLoc!==a.altLoc&&o.altLoc.trim()!==""&&a.altLoc.trim()!=="")}},"./src/parsers/utils/assignBackboneHBonds.ts":(n,e,t)=>{t.r(e),t.d(e,{assignBackboneHBonds:()=>i});function i(r,s){const o=s||3.2,a=o*o,h=[];for(let d=0,u=r.length;d<u;d++){r[d].index=d;const m=r[d];!m.hetflag&&(m.atom==="N"||m.atom==="O")&&(h.push(m),m.hbondOther=null,m.hbondDistanceSq=Number.POSITIVE_INFINITY)}h.sort(function(d,u){return d.z-u.z});for(let d=0,u=h.length;d<u;d++){const m=h[d];for(let v=d+1;v<u;v++){const _=h[v],D=_.z-m.z;if(D>o)break;if(_.atom==m.atom)continue;const f=Math.abs(_.y-m.y);if(f>o)continue;const l=Math.abs(_.x-m.x);if(l>o)continue;const c=l*l+f*f+D*D;c>a||_.chain==m.chain&&Math.abs(_.resi-m.resi)<4||(c<m.hbondDistanceSq&&(m.hbondOther=_,m.hbondDistanceSq=c),c<_.hbondDistanceSq&&(_.hbondOther=m,_.hbondDistanceSq=c))}}}},"./src/parsers/utils/assignBonds.ts":(n,e,t)=>{t.r(e),t.d(e,{assignBonds:()=>o});var i=t("./src/parsers/utils/areConnected.ts");const r=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],s=4.95;function o(a,h){for(let m=0,v=a.length;m<v;m++)a[m].index||(a[m].index=m);const d={x:{y:{z:[]}}};for(let m=0;m<a.length;m++){const v=a[m],_=Math.floor(v.x/s),D=Math.floor(v.y/s),f=Math.floor(v.z/s);d[_]||(d[_]={}),d[_][D]||(d[_][D]={}),d[_][D][f]||(d[_][D][f]=[]),d[_][D][f].push(v)}function u(m,v){for(let _=0;_<m.length;_++){const D=m[_];for(let f=0;f<v.length;f++){const l=v[f];if((0,i.areConnected)(D,l,h)){const c=D.bonds.indexOf(l.index),p=l.bonds.indexOf(D.index);c===-1&&p===-1?(D.bonds.push(l.index),D.bondOrder.push(1),l.bonds.push(D.index),l.bondOrder.push(1)):c===-1?(D.bonds.push(l.index),D.bondOrder.push(l.bondOrder[p])):p===-1&&(l.bonds.push(D.index),l.bondOrder.push(D.bondOrder[c]))}}}}for(let m in d){const v=parseInt(m);for(let _ in d[v]){const D=parseInt(_);for(let f in d[v][D]){const l=parseInt(f),c=d[v][D][l];for(let p=0;p<c.length;p++){const b=c[p];for(let E=p+1;E<c.length;E++){const C=c[E];(0,i.areConnected)(b,C,h)&&b.bonds.indexOf(C.index)==-1&&(b.bonds.push(C.index),b.bondOrder.push(1),C.bonds.push(b.index),C.bondOrder.push(1))}}for(let p=0;p<r.length;p++){const b=r[p];if(!d[v+b.x]||!d[v+b.x][D+b.y]||!d[v+b.x][D+b.y][l+b.z])continue;const E=d[v+b.x][D+b.y][l+b.z];u(c,E)}}}}}},"./src/parsers/utils/assignPDBBonds.ts":(n,e,t)=>{t.r(e),t.d(e,{assignPDBBonds:()=>o});var i=t("./src/parsers/utils/areConnected.ts"),r=t("./src/parsers/utils/assignBonds.ts"),s=t("./src/parsers/utils/standardResidues.ts");function o(a,h){const d=[],u=[];for(let D=0,f=a.length;D<f;D++){const l=a[D];l.index=D,l.hetflag||!s.standardResidues.has(l.resn)?u.push(l):d.push(l)}(0,r.assignBonds)(u,h),d.sort(function(D,f){return D.chain!==f.chain?D.chain<f.chain?-1:1:D.resi-f.resi});let m=-1,v=-1,_;for(let D=0,f=d.length;D<f;D++){const l=d[D];l.resi!==m&&(m=l.resi,_||v++,_=!1),l.reschain=v;for(let c=D+1;c<d.length;c++){const p=d[c];if(p.chain!==l.chain||p.resi-l.resi>1)break;(0,i.areConnected)(l,p,h)&&(l.bonds.indexOf(p.index)===-1&&(l.bonds.push(p.index),l.bondOrder.push(1),p.bonds.push(l.index),p.bondOrder.push(1)),l.resi!==p.resi&&(_=!0))}}}},"./src/parsers/utils/atomNameToElem.ts":(n,e,t)=>{t.r(e),t.d(e,{atomNameToElem:()=>r});var i=t("./src/parsers/utils/bondLength.ts");function r(s,o){let a=s.replace(/ /g,"");return a.length>0&&a[0]==="H"&&a!=="Hg"&&a!=="He"&&a!=="Hf"&&a!=="Hs"&&a!=="Ho"&&(a="H"),a.length>1&&(a=a[0].toUpperCase()+a.substring(1).toLowerCase(),i.bondTable[a]===void 0?a=a[0]:o&&(a==="Ca"||a==="Cd")&&(a="C")),a}},"./src/parsers/utils/bondLength.ts":(n,e,t)=>{t.r(e),t.d(e,{bondLength:()=>r,bondTable:()=>i,setBondLength:()=>s});let i={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function r(o){return i[o]||1.6}function s(o,a){a<0&&(a=0),i[o]=a}},"./src/parsers/utils/computeSecondaryStructure.ts":(n,e,t)=>{t.r(e),t.d(e,{computeSecondaryStructure:()=>r});var i=t("./src/parsers/utils/assignBackboneHBonds.ts");function r(s,o){(0,i.assignBackboneHBonds)(s,o);const a={};let h,d,u,m,v,_;for(h=0,d=s.length;h<d;h++)if(v=s[h],a[v.chain]===void 0&&(a[v.chain]=[]),isFinite(v.hbondDistanceSq)){const D=v.hbondOther;a[D.chain]===void 0&&(a[D.chain]=[]),Math.abs(D.resi-v.resi)===4&&(a[v.chain][v.resi]="h")}for(u in a)for(m=1;m<a[u].length-1;m++){const D=a[u][m-1],f=a[u][m+1];_=a[u][m],D=="h"&&D==f&&_!=D&&(a[u][m]=D)}for(h=0,d=s.length;h<d;h++)v=s[h],isFinite(v.hbondDistanceSq)&&a[v.chain][v.resi]!="h"&&v.ss!=="h"&&(a[v.chain][v.resi]="maybesheet");for(let D=0,f=s.length;D<f;D++)if(v=s[D],isFinite(v.hbondDistanceSq)&&a[v.chain][v.resi]=="maybesheet"){let l=v.hbondOther,c=a[l.chain][l.resi];(c=="maybesheet"||c=="s")&&(a[v.chain][v.resi]="s",a[l.chain][l.resi]="s")}for(let D in a){for(let f=1;f<a[D].length-1;f++){const l=a[D][f-1],c=a[D][f+1];_=a[D][f],l=="s"&&l==c&&_!=l&&(a[D][f]=l)}for(let f=0;f<a[D].length;f++){const l=a[D][f];(l=="h"||l=="s")&&a[D][f-1]!=l&&a[D][f+1]!=l&&delete a[D][f]}}for(h=0,d=s.length;h<d;h++)v=s[h],_=a[v.chain][v.resi],delete v.hbondOther,delete v.hbondDistanceSq,!(_===void 0||_==="maybesheet")&&(v.ss=_,a[v.chain][v.resi-1]!=_&&(v.ssbegin=!0),a[v.chain][v.resi+1]!=_&&(v.ssend=!0))}},"./src/parsers/utils/getSinglePDB.ts":(n,e,t)=>{t.r(e),t.d(e,{getSinglePDB:()=>m});var i=t("./src/WebGL/index.ts"),r=t("./src/parsers/utils/atomNameToElem.ts"),s=t("./src/parsers/utils/bondLength.ts"),o=t("./src/parsers/utils/computeSecondaryStructure.ts"),a=t("./src/parsers/utils/isEmpty.ts"),h=t("./src/parsers/utils/processSymmetries.ts"),d=t("./src/parsers/utils/assignPDBBonds.ts"),u=t("./src/parsers/utils/validateBonds.ts");function m(v,_,D){const f=[],l=_.assignBonds===void 0?!0:_.assignBonds,c=!_.keepH,p=!!_.noSecondaryStructure,b=!_.noComputeSecondaryStructure,E=!_.doAssembly,C=_.altLoc?_.altLoc:"A",g={symmetries:[],cryst:void 0};let x,y=[];const w=[];let M;const S={};for(let O=0;O<v.length;O++){M=v[O].replace(/^\s*/,"");const P=M.substring(0,6);let I,F,k;if(P.indexOf("END")===0){if(y=v.slice(O+1),P==="END")for(const B in D)D.hasOwnProperty(B)&&delete D[B];break}else if(P==="ATOM  "||P==="HETATM"){let B,U,W,R,z,G,q,Q,ne,te,oe,re;if(oe=M.substring(16,17),oe!==" "&&oe!==C&&C!=="*"||(te=parseInt(M.substring(6,11)),x=M.substring(12,16).replace(/ /g,""),B=M.substring(17,20).replace(/ /g,""),U=M.substring(21,22),W=parseInt(M.substring(22,26)),R=M.substring(26,27),z=parseFloat(M.substring(30,38)),G=parseFloat(M.substring(38,46)),q=parseFloat(M.substring(46,54)),re=parseFloat(M.substring(60,68)),ne=M.substring(76,78).replace(/ /g,""),ne===""||s.bondTable[ne]===void 0?ne=(0,r.atomNameToElem)(M.substring(12,14),M[0]=="A"):ne=ne[0].toUpperCase()+ne.substring(1).toLowerCase(),ne==="H"&&c))continue;P[0]=="H"?Q=!0:Q=!1,w[te]=f.length,f.push({resn:B,x:z,y:G,z:q,elem:ne,hetflag:Q,altLoc:oe,chain:U,resi:W,icode:R,rescode:W+(R!==" "?"^"+R:""),serial:te,atom:x,bonds:[],ss:"c",bondOrder:[],properties:{},b:re,pdbline:M})}else if(P==="SHEET "){I=M.substring(21,22),F=parseInt(M.substring(22,26)),k=parseInt(M.substring(33,37)),I in D||(D[I]={}),D[I][F]="s1";for(let B=F+1;B<k;B++)D[I][B]="s";D[I][k]="s2"}else if(P==="CONECT"){const B=parseInt(M.substring(6,11)),U=w[B],W=f[U],R=[11,16,21,26];for(let z=0;z<4;z++){const G=parseInt(M.substring(R[z],R[z]+5)),q=w[G];let Q=U+":"+q;const ne=f[q];if(W!==void 0&&ne!==void 0)if(!S[Q])S[Q]=1,(W.bonds.length==0||W.bonds[W.bonds.length-1]!==q)&&(W.bonds.push(q),W.bondOrder.push(1));else{S[Q]+=1;for(let te=0;te<W.bonds.length;te++)if(W.bonds[te]==q){const oe=S[Q];oe>=4?W.bondOrder[te]=1:W.bondOrder[te]=oe}}}}else if(P==="HELIX "){I=M.substring(19,20),F=parseInt(M.substring(21,25)),k=parseInt(M.substring(33,37)),I in D||(D[I]={}),D[I][F]="h1";for(let B=F+1;B<k;B++)D[I][B]="h";D[I][k]="h2"}else if(!E&&P==="REMARK"&&M.substring(13,18)==="BIOMT"){let B,U=new i.Matrix4;for(B=1;B<=3;B++)if(M=v[O].replace(/^\s*/,""),parseInt(M.substring(18,19))==B)U.elements[B-1]=parseFloat(M.substring(23,33)),U.elements[B-1+4]=parseFloat(M.substring(33,43)),U.elements[B-1+8]=parseFloat(M.substring(43,53)),U.elements[B-1+12]=parseFloat(M.substring(53)),O++;else for(;M.substring(13,18)==="BIOMT";)O++,M=v[O].replace(/^\s*/,"");U.elements[3]=0,U.elements[7]=0,U.elements[11]=0,U.elements[15]=1,g.symmetries.push(U),O--}else if(P==="CRYST1"){let B,U,W,R,z,G;B=parseFloat(M.substring(7,15)),U=parseFloat(M.substring(16,24)),W=parseFloat(M.substring(25,33)),R=parseFloat(M.substring(34,40)),z=parseFloat(M.substring(41,47)),G=parseFloat(M.substring(48,54)),g.cryst={a:B,b:U,c:W,alpha:R,beta:z,gamma:G}}else if(P==="ANISOU"){const B=parseInt(M.substring(6,11)),U=w[B],W=f[U];if(W){const R=M.substring(30).trim().split(/\s+/),z={u11:parseInt(R[0]),u22:parseInt(R[1]),u33:parseInt(R[2]),u12:parseInt(R[3]),u13:parseInt(R[4]),u23:parseInt(R[5])};W.uMat=z}}}if((0,u.validateBonds)(f,w),l&&(0,d.assignPDBBonds)(f,_),E||(0,h.processSymmetries)(g.symmetries,f,_,g.cryst),b&&!p&&(0,o.computeSecondaryStructure)(f,_.hbondCutoff),!(0,a.isEmpty)(D))for(let O=0;O<f.length;O++){const P=f[O];if(P!==void 0&&P.chain in D&&P.resi in D[P.chain]){const I=D[P.chain][P.resi];P.ss=I[0],I.length>1&&(I[1]=="1"?P.ssbegin=!0:I[1]=="2"&&(P.ssend=!0))}}return[f,g,y]}},"./src/parsers/utils/isEmpty.ts":(n,e,t)=>{t.r(e),t.d(e,{isEmpty:()=>i});function i(r){for(const s in r)return!1;return!0}},"./src/parsers/utils/processSymmetries.ts":(n,e,t)=>{t.r(e),t.d(e,{processSymmetries:()=>r});var i=t("./src/WebGL/index.ts");function r(s,o,a,h){const d=!a.duplicateAssemblyAtoms,u=o.length;let m=u,v=-1,_=null,D=null;(a.normalizeAssembly||a.wrapAtoms)&&h&&(_=(0,i.conversionMatrix3)(h.a,h.b,h.c,h.alpha,h.beta,h.gamma),D=new i.Matrix3,D.getInverse3(_));let f=function(p){let b=p.clone().applyMatrix3(D);const E=[b.x,b.y,b.z],C=[0,0,0];for(let x=0;x<3;x++){for(;E[x]<-.001;)E[x]+=1,C[x]+=1;for(;E[x]>1.001;)E[x]-=1,C[x]-=1}const g=new i.Vector3(C[0],C[1],C[2]);return g.applyMatrix3(_),g};if(a.normalizeAssembly&&h)for(let p=0;p<s.length;p++){const b=new i.Vector3(0,0,0);for(let C=0;C<u;C++){const g=new i.Vector3(o[C].x,o[C].y,o[C].z);g.applyMatrix4(s[p]),b.add(g)}b.divideScalar(u);const E=f(b);s[p].isNearlyIdentity()&&E.lengthSq()>.001&&(v=p),s[p].translate(E)}if(d){if(s.length>1)for(let p=0;p<o.length;p++){var l=[];for(let b=0;b<s.length;b++)if(!s[b].isNearlyIdentity()){var c=new i.Vector3;c.set(o[p].x,o[p].y,o[p].z),c.applyMatrix4(s[b]),l.push(c)}o[p].symmetries=l}}else{for(let p=0;p<u;p++)o[p].sym=-1;for(let p=0;p<s.length;p++)if(!s[p].isNearlyIdentity()&&v!=p){let b=new i.Vector3;for(let E=0;E<u;E++){const C=[];for(let x=0;x<o[E].bonds.length;x++)C.push(o[E].bonds[x]+m);if(b.set(o[E].x,o[E].y,o[E].z),b.applyMatrix4(s[p]),a.wrapAtoms&&h){let x=f(b);b.add(x)}const g={};for(const x in o[E])g[x]=o[E][x];g.x=b.x,g.y=b.y,g.z=b.z,g.bonds=C,g.sym=p,g.index=o.length,o.push(g)}m=o.length}else for(let b=0;b<u;b++)o[b].sym=p;if(a.wrapAtoms&&h){let p=new i.Vector3;for(let b=0;b<u;b++){p.set(o[b].x,o[b].y,o[b].z);let E=f(p);p.add(E),o[b].x=p.x,o[b].y=p.y,o[b].z=p.z}}if(v>=0){const p=new i.Vector3;for(let b=0;b<u;b++)p.set(o[b].x,o[b].y,o[b].z),p.applyMatrix4(s[v]),o[b].x=p.x,o[b].y=p.y,o[b].z=p.z}s.length=0}}},"./src/parsers/utils/standardResidues.ts":(n,e,t)=>{t.r(e),t.d(e,{standardResidues:()=>i});const i=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])},"./src/parsers/utils/validateBonds.ts":(n,e,t)=>{t.r(e),t.d(e,{validateBonds:()=>i});function i(r,s){for(let o=0,a=r.length;o<a;o++){const h=r[o];for(let d=0;d<h.bonds.length;d++){const u=h.bonds[d],m=r[u],v=s[h.serial];m&&v&&m.bonds.indexOf(v)<0&&(m.bonds.push(v),m.bondOrder.push(h.bondOrder[d]))}}}},"./src/partialCharges.ts":(n,e,t)=>{t.r(e),t.d(e,{applyPartialCharges:()=>r,partialCharges:()=>i});const i={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function r(s,o){if((!o||typeof s.partialCharge>"u")&&s.resn&&s.atom){var a=s.resn+":"+s.atom;s.properties.partialCharge=i[a]}}},"./src/specs.ts":(n,e,t)=>{t.r(e)},"./src/utilities.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(n,e){for(var t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&(n[t]=e[t]);return n}function deepCopy(n){let e,t,i;if(n==null)return{};if(typeof n!="object"||n===null)return n;e=Array.isArray(n)?[]:{};for(i in n)t=n[i],e[i]=deepCopy(t);return e}function isNumeric(n){var e=typeof n;return(e==="number"||e==="string")&&!isNaN(n-parseFloat(n))}function isEmptyObject(n){return Object.keys(n).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(n){n&&(n.volformat&&!(n.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(n.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(n.voldata,n.volformat)),n.volscheme&&(n.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(n.volscheme)))}function getExtent(n,e){var t,i,r,s,o,a,h,d,u,m,v=!e;if(t=i=r=9999,s=o=a=-9999,h=d=u=m=0,n.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var _=0;_<n.length;_++){var D=n[_];if(!(typeof D>"u"||!isFinite(D.x)||!isFinite(D.y)||!isFinite(D.z))&&(m++,h+=D.x,d+=D.y,u+=D.z,t=t<D.x?t:D.x,i=i<D.y?i:D.y,r=r<D.z?r:D.z,s=s>D.x?s:D.x,o=o>D.y?o:D.y,a=a>D.z?a:D.z,D.symmetries&&v))for(var f=0;f<D.symmetries.length;f++)m++,h+=D.symmetries[f].x,d+=D.symmetries[f].y,u+=D.symmetries[f].z,t=t<D.symmetries[f].x?t:D.symmetries[f].x,i=i<D.symmetries[f].y?i:D.symmetries[f].y,r=r<D.symmetries[f].z?r:D.symmetries[f].z,s=s>D.symmetries[f].x?s:D.symmetries[f].x,o=o>D.symmetries[f].y?o:D.symmetries[f].y,a=a>D.symmetries[f].z?a:D.symmetries[f].z}return[[t,i,r],[s,o,a],[h/m,d/m,u/m]]}function getPropertyRange(n,e){for(var t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=0,s=n.length;r<s;r++){var o=n[r],a=getAtomProperty(o,e);a!=null&&(a<t&&(t=a),a>i&&(i=a))}return!isFinite(t)&&!isFinite(i)?t=i=0:isFinite(t)?isFinite(i)||(i=t):t=i,[t,i]}class PausableTimer{constructor(e,t,i){this.total_time_run=0,this.fn=e,this.arg=i,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(e,t,i)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(n){for(var e=window.atob(n),t=e.length,i=new Uint8Array(t),r=0;r<t;r++)i[r]=e.charCodeAt(r);return i}function getAtomProperty(n,e){var t=null;return n.properties&&typeof n.properties[e]<"u"?t=n.properties[e]:typeof n[e]<"u"&&(t=n[e]),t}function mergeGeos(n,e){var t=e.geometry;t!==void 0&&n.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(n){if(typeof n=="object")return n;if(typeof n>"u"||n==null)return n;try{return JSON.parse(n)}catch{}n=n.replace(/%7E/g,"~");var e=function(v){return isNumeric(v)?Math.floor(parseFloat(v))==parseInt(v)||v.indexOf(".")>=0?parseFloat(v):parseInt(v):v==="true"?!0:v==="false"?!1:v},t={};if(n==="all")return t;for(var i=n.split(";"),r=0;r<i.length;r++){var s=i[r].split(":"),o=s[0],a={},h=s[1];if(h)if(h=h.replace(/~/g,"="),h.indexOf("=")!==-1)for(var d=h.split(","),u=0;u<d.length;u++){var m=d[u].split("=",2);a[m[0]]=e(m[1])}else h.indexOf(",")!==-1?a=h.split(","):a=e(h);t[o]=a}return t}function checkStatus(n){if(!n.ok)throw new Error(`HTTP ${n.status} - ${n.statusText}`);return n}function get(n,e){var t=fetch(n).then(checkStatus).then(i=>i.text());return e?t.then(e):t}function getbin(n,e,t,i){var r;return t=="POST"?r=fetch(n,{method:"POST",body:i}).then(s=>checkStatus(s)).then(s=>s.arrayBuffer()):r=fetch(n).then(s=>checkStatus(s)).then(s=>s.arrayBuffer()),e?r.then(e):r}function download(n,e,t,i){var r="",s="",o="",a=null,h=e.addModel();if(n.indexOf(":")<0&&(n.length==4?n="pdb:"+n:isNaN(n)?n="url:"+n:n="cid:"+n),n.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),n="bcif:"+n.slice(5)),n.substring(0,5)==="bcif:")n=n.substring(5).toUpperCase(),o="https://models.rcsb.org/"+n+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),a=new Promise(function(u){getbin(o).then(function(m){h.addMolData(m,"bcif.gz",t),e.zoomTo(),e.render(),u(h)},function(){console.error("fetch of "+o+" failed.")})});else{if(n.substring(0,4)==="pdb:"){if(r="bcif",t&&t.format&&(r=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),n=n.substring(4).toUpperCase(),!n.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}r=="bcif"?o="https://models.rcsb.org/"+n.toUpperCase()+".bcif.gz":(s=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",o=s+n+"."+r)}else if(n.substring(0,4)=="cid:"){if(r="sdf",n=n.substring(4),!n.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}o="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+n+"/SDF?record_type=3d"}else n.substring(0,4)=="url:"&&(o=n.substring(4),r=o);var d=function(u){h.addMolData(u,r,t),e.zoomTo(),e.render()};a=new Promise(function(u){r=="bcif"?getbin(o).then(function(m){d(m),u(h)}).catch(function(){s=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",o=s+n+".pdb",r="pdb",console.warn("falling back to pdb format"),get(o).then(function(m){d(m),u(h)}).catch(function(m){d(""),u(h),console.error("fetch of "+o+" failed: "+m.statusText)})}):get(o).then(function(m){d(m),u(h)}).catch(function(m){d(""),u(h),console.error("fetch of "+o+" failed: "+m.statusText)})})}return i?(a.then(function(u){i(u)}),h):a}function getColorFromStyle(n,e){let t=e.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let o=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[o]<"u"){let a=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);a.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[o],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:a},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let i=n.color;if(typeof e.color<"u"&&e.color!="spectrum"&&(i=e.color),typeof t<"u"){let o,a;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[n[t.prop]]<"u"&&(i=t.map[n[t.prop]]);else if(typeof t[n[t.prop]]<"u")i=t.map[n[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){o=t.prop;var r=t.gradient;r instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(r=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let h=r.range()||[-1,1];a=getAtomProperty(n,o),a!=null&&(i=r.valueToHex(a,h))}else typeof t.prop<"u"&&typeof t.map<"u"?(o=t.prop,a=getAtomProperty(n,o),typeof t.map[a]<"u"&&(i=t.map[a])):typeof e.colorscheme[n.elem]<"u"?i=e.colorscheme[n.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof e.colorfunc<"u"&&(i=e.colorfunc(n));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(i)}function getElement(n){let e=n;return typeof n=="string"?e=document.querySelector("#"+n):typeof n=="object"&&n.get&&(e=n.get(0)),e}function inflateString(n,e=!0){let t;return typeof n=="string"?t=new TextEncoder().encode(n):t=new Uint8Array(n),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:e?"string":null})}},"./src/vendor/mmtf.js":function(n,e){(function(t,i){i(e)})(this,function(t){function i(H,K,X){for(var pe=(H.byteLength,0),ue=X.length;ue>pe;pe++){var ye=X.charCodeAt(pe);if(128>ye)H.setUint8(K++,ye>>>0&127|0);else if(2048>ye)H.setUint8(K++,ye>>>6&31|192),H.setUint8(K++,ye>>>0&63|128);else if(65536>ye)H.setUint8(K++,ye>>>12&15|224),H.setUint8(K++,ye>>>6&63|128),H.setUint8(K++,ye>>>0&63|128);else{if(!(1114112>ye))throw new Error("bad codepoint "+ye);H.setUint8(K++,ye>>>18&7|240),H.setUint8(K++,ye>>>12&63|128),H.setUint8(K++,ye>>>6&63|128),H.setUint8(K++,ye>>>0&63|128)}}}function r(H){for(var K=0,X=0,pe=H.length;pe>X;X++){var ue=H.charCodeAt(X);if(128>ue)K+=1;else if(2048>ue)K+=2;else if(65536>ue)K+=3;else{if(!(1114112>ue))throw new Error("bad codepoint "+ue);K+=4}}return K}function s(H,K,X){var pe=typeof H;if(pe==="string"){var ue=r(H);if(32>ue)return K.setUint8(X,160|ue),i(K,X+1,H),1+ue;if(256>ue)return K.setUint8(X,217),K.setUint8(X+1,ue),i(K,X+2,H),2+ue;if(65536>ue)return K.setUint8(X,218),K.setUint16(X+1,ue),i(K,X+3,H),3+ue;if(4294967296>ue)return K.setUint8(X,219),K.setUint32(X+1,ue),i(K,X+5,H),5+ue}if(H instanceof Uint8Array){var ue=H.byteLength,ye=new Uint8Array(K.buffer);if(256>ue)return K.setUint8(X,196),K.setUint8(X+1,ue),ye.set(H,X+2),2+ue;if(65536>ue)return K.setUint8(X,197),K.setUint16(X+1,ue),ye.set(H,X+3),3+ue;if(4294967296>ue)return K.setUint8(X,198),K.setUint32(X+1,ue),ye.set(H,X+5),5+ue}if(pe==="number"){if(!isFinite(H))throw new Error("Number not finite: "+H);if(Math.floor(H)!==H)return K.setUint8(X,203),K.setFloat64(X+1,H),9;if(H>=0){if(128>H)return K.setUint8(X,H),1;if(256>H)return K.setUint8(X,204),K.setUint8(X+1,H),2;if(65536>H)return K.setUint8(X,205),K.setUint16(X+1,H),3;if(4294967296>H)return K.setUint8(X,206),K.setUint32(X+1,H),5;throw new Error("Number too big 0x"+H.toString(16))}if(H>=-32)return K.setInt8(X,H),1;if(H>=-128)return K.setUint8(X,208),K.setInt8(X+1,H),2;if(H>=-32768)return K.setUint8(X,209),K.setInt16(X+1,H),3;if(H>=-2147483648)return K.setUint8(X,210),K.setInt32(X+1,H),5;throw new Error("Number too small -0x"+(-H).toString(16).substr(1))}if(H===null)return K.setUint8(X,192),1;if(pe==="boolean")return K.setUint8(X,H?195:194),1;if(pe==="object"){var ue,he=0,Se=Array.isArray(H);if(Se)ue=H.length;else{var V=Object.keys(H);ue=V.length}var he;if(16>ue?(K.setUint8(X,ue|(Se?144:128)),he=1):65536>ue?(K.setUint8(X,Se?220:222),K.setUint16(X+1,ue),he=3):4294967296>ue&&(K.setUint8(X,Se?221:223),K.setUint32(X+1,ue),he=5),Se)for(var ve=0;ue>ve;ve++)he+=s(H[ve],K,X+he);else for(var ve=0;ue>ve;ve++){var Pe=V[ve];he+=s(Pe,K,X+he),he+=s(H[Pe],K,X+he)}return he}throw new Error("Unknown type "+pe)}function o(H){var K=typeof H;if(K==="string"){var X=r(H);if(32>X)return 1+X;if(256>X)return 2+X;if(65536>X)return 3+X;if(4294967296>X)return 5+X}if(H instanceof Uint8Array){var X=H.byteLength;if(256>X)return 2+X;if(65536>X)return 3+X;if(4294967296>X)return 5+X}if(K==="number"){if(Math.floor(H)!==H)return 9;if(H>=0){if(128>H)return 1;if(256>H)return 2;if(65536>H)return 3;if(4294967296>H)return 5;throw new Error("Number too big 0x"+H.toString(16))}if(H>=-32)return 1;if(H>=-128)return 2;if(H>=-32768)return 3;if(H>=-2147483648)return 5;throw new Error("Number too small -0x"+H.toString(16).substr(1))}if(K==="boolean"||H===null)return 1;if(K==="object"){var X,pe=0;if(Array.isArray(H)){X=H.length;for(var ue=0;X>ue;ue++)pe+=o(H[ue])}else{var ye=Object.keys(H);X=ye.length;for(var ue=0;X>ue;ue++){var Se=ye[ue];pe+=o(Se)+o(H[Se])}}if(16>X)return 1+pe;if(65536>X)return 3+pe;if(4294967296>X)return 5+pe;throw new Error("Array or object too long 0x"+X.toString(16))}throw new Error("Unknown type "+K)}function a(H){var K=new ArrayBuffer(o(H)),X=new DataView(K);return s(H,X,0),new Uint8Array(K)}function h(H,K,X){return K?new H(K.buffer,K.byteOffset,K.byteLength/(X||1)):void 0}function d(H){return h(DataView,H)}function u(H){return h(Uint8Array,H)}function m(H){return h(Int8Array,H)}function v(H){return h(Int32Array,H,4)}function _(H){return h(Float32Array,H,4)}function D(H,K){var X=H.length/2;K||(K=new Int16Array(X));for(var pe=0,ue=0;X>pe;++pe,ue+=2)K[pe]=H[ue]<<8^H[ue+1]<<0;return K}function f(H,K){var X=H.length;K||(K=new Uint8Array(2*X));for(var pe=d(K),ue=0;X>ue;++ue)pe.setInt16(2*ue,H[ue]);return u(K)}function l(H,K){var X=H.length/4;K||(K=new Int32Array(X));for(var pe=0,ue=0;X>pe;++pe,ue+=4)K[pe]=H[ue]<<24^H[ue+1]<<16^H[ue+2]<<8^H[ue+3]<<0;return K}function c(H,K){var X=H.length;K||(K=new Uint8Array(4*X));for(var pe=d(K),ue=0;X>ue;++ue)pe.setInt32(4*ue,H[ue]);return u(K)}function p(H,K){var X=H.length;K||(K=new Float32Array(X/4));for(var pe=d(K),ue=d(H),ye=0,Se=0,V=X/4;V>ye;++ye,Se+=4)pe.setFloat32(Se,ue.getFloat32(Se),!0);return K}function b(H,K,X){var pe=H.length,ue=1/K;X||(X=new Float32Array(pe));for(var ye=0;pe>ye;++ye)X[ye]=H[ye]*ue;return X}function E(H,K,X){var pe=H.length;X||(X=new Int32Array(pe));for(var ue=0;pe>ue;++ue)X[ue]=Math.round(H[ue]*K);return X}function C(H,K){var X,pe;if(!K){var ue=0;for(X=0,pe=H.length;pe>X;X+=2)ue+=H[X+1];K=new H.constructor(ue)}var ye=0;for(X=0,pe=H.length;pe>X;X+=2)for(var Se=H[X],V=H[X+1],he=0;V>he;++he)K[ye]=Se,++ye;return K}function g(H){if(H.length===0)return new Int32Array;var K,X,pe=2;for(K=1,X=H.length;X>K;++K)H[K-1]!==H[K]&&(pe+=2);var ue=new Int32Array(pe),ye=0,Se=1;for(K=1,X=H.length;X>K;++K)H[K-1]!==H[K]?(ue[ye]=H[K-1],ue[ye+1]=Se,Se=1,ye+=2):++Se;return ue[ye]=H[H.length-1],ue[ye+1]=Se,ue}function x(H,K){var X=H.length;K||(K=new H.constructor(X)),X&&(K[0]=H[0]);for(var pe=1;X>pe;++pe)K[pe]=H[pe]+K[pe-1];return K}function y(H,K){var X=H.length;K||(K=new H.constructor(X)),K[0]=H[0];for(var pe=1;X>pe;++pe)K[pe]=H[pe]-H[pe-1];return K}function w(H,K){var X,pe,ue=H instanceof Int8Array?127:32767,ye=-ue-1,Se=H.length;if(!K){var V=0;for(X=0;Se>X;++X)H[X]<ue&&H[X]>ye&&++V;K=new Int32Array(V)}for(X=0,pe=0;Se>X;){for(var he=0;H[X]===ue||H[X]===ye;)he+=H[X],++X;he+=H[X],++X,K[pe]=he,++pe}return K}function M(H,K){var X,pe=32767,ue=-pe-1,ye=H.length,Se=0;for(X=0;ye>X;++X){var V=H[X];V===0?++Se:V>0?(Se+=Math.ceil(V/pe),V%pe===0&&(Se+=1)):(Se+=Math.ceil(V/ue),V%ue===0&&(Se+=1))}var he=new Int16Array(Se),ve=0;for(X=0;ye>X;++X){var V=H[X];if(V>=0)for(;V>=pe;)he[ve]=pe,++ve,V-=pe;else for(;ue>=V;)he[ve]=ue,++ve,V-=ue;he[ve]=V,++ve}return he}function S(H,K){return x(C(H),K)}function O(H){return g(y(H))}function P(H,K,X){return b(C(H,v(X)),K,X)}function I(H,K){return g(E(H,K))}function F(H,K,X){return b(x(H,v(X)),K,X)}function k(H,K,X){return y(E(H,K),X)}function B(H,K,X){return b(w(H,v(X)),K,X)}function U(H,K,X){var pe=w(H,v(X));return F(pe,K,_(pe))}function W(H,K,X){return M(k(H,K))}function R(ye){var K=d(ye),X=K.getInt32(0),pe=K.getInt32(4),ue=ye.subarray(8,12),ye=ye.subarray(12);return[X,ye,pe,ue]}function z(H,K,X,pe){var ue=new ArrayBuffer(12+pe.byteLength),ye=new Uint8Array(ue),Se=new DataView(ue);return Se.setInt32(0,H),Se.setInt32(4,K),X&&ye.set(X,8),ye.set(pe,12),ye}function G(H){var K=H.length,X=u(H);return z(2,K,void 0,X)}function q(H){var K=H.length,X=c(H);return z(4,K,void 0,X)}function Q(H,K){var X=H.length/K,pe=c([K]),ue=u(H);return z(5,X,pe,ue)}function ne(H){var K=H.length,X=c(g(H));return z(6,K,void 0,X)}function te(H){var K=H.length,X=c(O(H));return z(8,K,void 0,X)}function oe(H,K){var X=H.length,pe=c([K]),ue=c(I(H,K));return z(9,X,pe,ue)}function re(H,K){var X=H.length,pe=c([K]),ue=f(W(H,K));return z(10,X,pe,ue)}function le(H){var K={};return Ue.forEach(function(X){H[X]!==void 0&&(K[X]=H[X])}),H.bondAtomList&&(K.bondAtomList=q(H.bondAtomList)),H.bondOrderList&&(K.bondOrderList=G(H.bondOrderList)),K.xCoordList=re(H.xCoordList,1e3),K.yCoordList=re(H.yCoordList,1e3),K.zCoordList=re(H.zCoordList,1e3),H.bFactorList&&(K.bFactorList=re(H.bFactorList,100)),H.atomIdList&&(K.atomIdList=te(H.atomIdList)),H.altLocList&&(K.altLocList=ne(H.altLocList)),H.occupancyList&&(K.occupancyList=oe(H.occupancyList,100)),K.groupIdList=te(H.groupIdList),K.groupTypeList=q(H.groupTypeList),H.secStructList&&(K.secStructList=G(H.secStructList)),H.insCodeList&&(K.insCodeList=ne(H.insCodeList)),H.sequenceIndexList&&(K.sequenceIndexList=te(H.sequenceIndexList)),K.chainIdList=Q(H.chainIdList,4),H.chainNameList&&(K.chainNameList=Q(H.chainNameList,4)),K}function Ce(H){function K(he){for(var ve={},Pe=0;he>Pe;Pe++){var ae=ye();ve[ae]=ye()}return ve}function X(he){var ve=H.subarray(Se,Se+he);return Se+=he,ve}function pe(he){var ve=H.subarray(Se,Se+he);Se+=he;var Pe=65535;if(he>Pe){for(var ae=[],me=0;me<ve.length;me+=Pe)ae.push(String.fromCharCode.apply(null,ve.subarray(me,me+Pe)));return ae.join("")}return String.fromCharCode.apply(null,ve)}function ue(he){for(var ve=new Array(he),Pe=0;he>Pe;Pe++)ve[Pe]=ye();return ve}function ye(){var he,ve,Pe=H[Se];if((128&Pe)===0)return Se++,Pe;if((240&Pe)===128)return ve=15&Pe,Se++,K(ve);if((240&Pe)===144)return ve=15&Pe,Se++,ue(ve);if((224&Pe)===160)return ve=31&Pe,Se++,pe(ve);if((224&Pe)===224)return he=V.getInt8(Se),Se++,he;switch(Pe){case 192:return Se++,null;case 194:return Se++,!1;case 195:return Se++,!0;case 196:return ve=V.getUint8(Se+1),Se+=2,X(ve);case 197:return ve=V.getUint16(Se+1),Se+=3,X(ve);case 198:return ve=V.getUint32(Se+1),Se+=5,X(ve);case 202:return he=V.getFloat32(Se+1),Se+=5,he;case 203:return he=V.getFloat64(Se+1),Se+=9,he;case 204:return he=H[Se+1],Se+=2,he;case 205:return he=V.getUint16(Se+1),Se+=3,he;case 206:return he=V.getUint32(Se+1),Se+=5,he;case 208:return he=V.getInt8(Se+1),Se+=2,he;case 209:return he=V.getInt16(Se+1),Se+=3,he;case 210:return he=V.getInt32(Se+1),Se+=5,he;case 217:return ve=V.getUint8(Se+1),Se+=2,pe(ve);case 218:return ve=V.getUint16(Se+1),Se+=3,pe(ve);case 219:return ve=V.getUint32(Se+1),Se+=5,pe(ve);case 220:return ve=V.getUint16(Se+1),Se+=3,ue(ve);case 221:return ve=V.getUint32(Se+1),Se+=5,ue(ve);case 222:return ve=V.getUint16(Se+1),Se+=3,K(ve);case 223:return ve=V.getUint32(Se+1),Se+=5,K(ve)}throw new Error("Unknown type 0x"+Pe.toString(16))}var Se=0,V=new DataView(H.buffer);return ye()}function De(H,K,X,pe){switch(H){case 1:return p(K);case 2:return m(K);case 3:return D(K);case 4:return l(K);case 5:return u(K);case 6:return C(l(K),new Uint8Array(X));case 7:return C(l(K));case 8:return S(l(K));case 9:return P(l(K),l(pe)[0]);case 10:return U(D(K),l(pe)[0]);case 11:return b(D(K),l(pe)[0]);case 12:return B(D(K),l(pe)[0]);case 13:return B(m(K),l(pe)[0]);case 14:return w(D(K));case 15:return w(m(K))}}function Oe(H,K){K=K||{};var X=K.ignoreFields,pe={};return ze.forEach(function(ue){var ye=X?X.indexOf(ue)!==-1:!1,Se=H[ue];ye||Se===void 0||(Se instanceof Uint8Array?pe[ue]=De.apply(null,R(Se)):pe[ue]=Se)}),pe}function _e(H){return String.fromCharCode.apply(null,H).replace(/\0/g,"")}function Z(H,K,X){X=X||{};var pe,ue,ye,Se,V,he,ve=X.firstModelOnly,Pe=K.onModel,ae=K.onChain,me=K.onGroup,j=K.onAtom,Te=K.onBond,Be=0,L=0,ge=0,de=0,$=0,se=-1,ce=H.chainNameList,Fe=H.secStructList,ke=H.insCodeList,Ee=H.sequenceIndexList,$e=H.atomIdList,Xe=H.bFactorList,Ke=H.altLocList,Je=H.occupancyList,Ye=H.bondAtomList,nt=H.bondOrderList;for(pe=0,ue=H.chainsPerModel.length;ue>pe&&!(ve&&Be>0);++pe){var st=H.chainsPerModel[Be];for(Pe&&Pe({chainCount:st,modelIndex:Be}),ye=0;st>ye;++ye){var _t=H.groupsPerChain[L];if(ae){var ut=_e(H.chainIdList.subarray(4*L,4*L+4)),et=null;ce&&(et=_e(ce.subarray(4*L,4*L+4))),ae({groupCount:_t,chainIndex:L,modelIndex:Be,chainId:ut,chainName:et})}for(Se=0;_t>Se;++Se){var ht=H.groupList[H.groupTypeList[ge]],tt=ht.atomNameList.length;if(me){var bt=null;Fe&&(bt=Fe[ge]);var Dt=null;H.insCodeList&&(Dt=String.fromCharCode(ke[ge]));var Et=null;Ee&&(Et=Ee[ge]),me({atomCount:tt,groupIndex:ge,chainIndex:L,modelIndex:Be,groupId:H.groupIdList[ge],groupType:H.groupTypeList[ge],groupName:ht.groupName,singleLetterCode:ht.singleLetterCode,chemCompType:ht.chemCompType,secStruct:bt,insCode:Dt,sequenceIndex:Et})}for(V=0;tt>V;++V){if(j){var St=null;$e&&(St=$e[de]);var Ct=null;Xe&&(Ct=Xe[de]);var zt=null;Ke&&(zt=String.fromCharCode(Ke[de]));var Nt=null;Je&&(Nt=Je[de]),j({atomIndex:de,groupIndex:ge,chainIndex:L,modelIndex:Be,atomId:St,element:ht.elementList[V],atomName:ht.atomNameList[V],formalCharge:ht.formalChargeList[V],xCoord:H.xCoordList[de],yCoord:H.yCoordList[de],zCoord:H.zCoordList[de],bFactor:Ct,altLoc:zt,occupancy:Nt})}de+=1}if(Te){var Tt=ht.bondAtomList;for(V=0,he=ht.bondOrderList.length;he>V;++V)Te({atomIndex1:de-tt+Tt[2*V],atomIndex2:de-tt+Tt[2*V+1],bondOrder:ht.bondOrderList[V]})}ge+=1}L+=1}if($=se+1,se=de-1,Te&&Ye)for(V=0,he=Ye.length;he>V;V+=2){var wt=Ye[V],Lt=Ye[V+1];(wt>=$&&se>=wt||Lt>=$&&se>=Lt)&&Te({atomIndex1:wt,atomIndex2:Lt,bondOrder:nt?nt[V/2]:null})}Be+=1}}function xe(H){return a(le(H))}function we(H,K){H instanceof ArrayBuffer&&(H=new Uint8Array(H));var X;return X=H instanceof Uint8Array?Ce(H):H,Oe(X,K)}function ie(H,K,X,pe){function ue(){try{var Se=we(ye.response);X(Se)}catch(V){pe(V)}}var ye=new XMLHttpRequest;ye.addEventListener("load",ue,!0),ye.addEventListener("error",pe,!0),ye.responseType="arraybuffer",ye.open("GET",K+H.toUpperCase()),ye.send()}function Ne(H,K,X){ie(H,We,K,X)}function Ge(H,K,X){ie(H,He,K,X)}var Ue=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],Ie=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],ze=Ue.concat(Ie),Re="v1.0.1",Le="//mmtf.rcsb.org/v1.0/",We=Le+"full/",He=Le+"reduced/";t.encode=xe,t.decode=we,t.traverse=Z,t.fetch=Ne,t.fetchReduced=Ge,t.version=Re,t.fetchUrl=We,t.fetchReducedUrl=He,t.encodeMsgpack=a,t.encodeMmtf=le,t.decodeMsgpack=Ce,t.decodeMmtf=Oe})}},__webpack_module_cache__={};function __webpack_require__(n){var e=__webpack_module_cache__[n];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(n,e)=>{for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())}(_3Dmol$1)),_3Dmol$1.exports}var _3DmolExports=require_3Dmol();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function round(n){return n+.5|0}const lim=(n,e,t)=>Math.max(Math.min(n,t),e);function p2b(n){return lim(round(n*2.55),0,255)}function n2b(n){return lim(round(n*255),0,255)}function b2n(n){return lim(round(n/2.55)/100,0,1)}function n2p(n){return lim(round(n*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=n=>hex[n&15],h2=n=>hex[(n&240)>>4]+hex[n&15],eq=n=>(n&240)>>4===(n&15),isShort=n=>eq(n.r)&&eq(n.g)&&eq(n.b)&&eq(n.a);function hexParse(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&map$1[n[1]]*17,g:255&map$1[n[2]]*17,b:255&map$1[n[3]]*17,a:e===5?map$1[n[4]]*17:255}:(e===7||e===9)&&(t={r:map$1[n[1]]<<4|map$1[n[2]],g:map$1[n[3]]<<4|map$1[n[4]],b:map$1[n[5]]<<4|map$1[n[6]],a:e===9?map$1[n[7]]<<4|map$1[n[8]]:255})),t}const alpha=(n,e)=>n<255?e(n):"";function hexString(n){var e=isShort(n)?h1:h2;return n?"#"+e(n.r)+e(n.g)+e(n.b)+alpha(n.a,e):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(n,e,t){const i=e*Math.min(t,1-t),r=(s,o=(s+n/30)%12)=>t-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function hsv2rgbn(n,e,t){const i=(r,s=(r+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function hwb2rgbn(n,e,t){const i=hsl2rgbn(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function hueValue(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function rgb2hsl(n){const t=n.r/255,i=n.g/255,r=n.b/255,s=Math.max(t,i,r),o=Math.min(t,i,r),a=(s+o)/2;let h,d,u;return s!==o&&(u=s-o,d=a>.5?u/(2-s-o):u/(s+o),h=hueValue(t,i,r,u,s),h=h*60+.5),[h|0,d||0,a]}function calln(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(n2b)}function hsl2rgb(n,e,t){return calln(hsl2rgbn,n,e,t)}function hwb2rgb(n,e,t){return calln(hwb2rgbn,n,e,t)}function hsv2rgb(n,e,t){return calln(hsv2rgbn,n,e,t)}function hue(n){return(n%360+360)%360}function hueParse(n){const e=HUE_RE.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?p2b(+e[5]):n2b(+e[5]));const r=hue(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=hwb2rgb(r,s,o):e[1]==="hsv"?i=hsv2rgb(r,s,o):i=hsl2rgb(r,s,o),{r:i[0],g:i[1],b:i[2],a:t}}function rotate(n,e){var t=rgb2hsl(n);t[0]=hue(t[0]+e),t=hsl2rgb(t),n.r=t[0],n.g=t[1],n.b=t[2]}function hslString(n){if(!n)return;const e=rgb2hsl(n),t=e[0],i=n2p(e[1]),r=n2p(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${b2n(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}const map$2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const n={},e=Object.keys(names$1),t=Object.keys(map$2);let i,r,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],r=0;r<t.length;r++)s=t[r],a=a.replace(s,map$2[s]);s=parseInt(names$1[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}let names;function nameParse(n){names||(names=unpack(),names.transparent=[0,0,0,0]);const e=names[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(n){const e=RGB_RE.exec(n);let t=255,i,r,s;if(e){if(e[7]!==i){const o=+e[7];t=e[8]?p2b(o):lim(o*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?p2b(i):lim(i,0,255)),r=255&(e[4]?p2b(r):lim(r,0,255)),s=255&(e[6]?p2b(s):lim(s,0,255)),{r:i,g:r,b:s,a:t}}}function rgbString(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${b2n(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const to=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,from=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function interpolate$1(n,e,t){const i=from(b2n(n.r)),r=from(b2n(n.g)),s=from(b2n(n.b));return{r:n2b(to(i+t*(from(b2n(e.r))-i))),g:n2b(to(r+t*(from(b2n(e.g))-r))),b:n2b(to(s+t*(from(b2n(e.b))-s))),a:n.a+t*(e.a-n.a)}}function modHSL(n,e,t){if(n){let i=rgb2hsl(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=hsl2rgb(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function clone$1(n,e){return n&&Object.assign(e||{},n)}function fromObject(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=n2b(n[3]))):(e=clone$1(n,{r:0,g:0,b:0,a:1}),e.a=n2b(e.a)),e}function functionParse(n){return n.charAt(0)==="r"?rgbParse(n):hueParse(n)}class Color{constructor(e){if(e instanceof Color)return e;const t=typeof e;let i;t==="object"?i=fromObject(e):t==="string"&&(i=hexParse(e)||nameParse(e)||functionParse(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=clone$1(this._rgb);return e&&(e.a=b2n(e.a)),e}set rgb(e){this._rgb=fromObject(e)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,r=e.rgb;let s;const o=t===s?.5:t,a=2*o-1,h=i.a-r.a,d=((a*h===-1?a:(a+h)/(1+a*h))+1)/2;s=1-d,i.r=255&d*i.r+s*r.r+.5,i.g=255&d*i.g+s*r.g+.5,i.b=255&d*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=interpolate$1(this._rgb,e._rgb,t)),this}clone(){return new Color(this.rgb)}alpha(e){return this._rgb.a=n2b(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=round(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return modHSL(this._rgb,2,e),this}darken(e){return modHSL(this._rgb,2,-e),this}saturate(e){return modHSL(this._rgb,1,e),this}desaturate(e){return modHSL(this._rgb,1,-e),this}rotate(e){return rotate(this._rgb,e),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function noop(){}const uid=(()=>{let n=0;return()=>n++})();function isNullOrUndef(n){return n==null}function isArray(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function isObject(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function isNumberFinite(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function finiteOrDefault(n,e){return isNumberFinite(n)?n:e}function valueOrDefault(n,e){return typeof n>"u"?e:n}const toPercentage=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,toDimension=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function callback(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function each(n,e,t,i){let r,s,o;if(isArray(n))for(s=n.length,r=0;r<s;r++)e.call(t,n[r],r);else if(isObject(n))for(o=Object.keys(n),s=o.length,r=0;r<s;r++)e.call(t,n[o[r]],o[r])}function _elementsEqual(n,e){let t,i,r,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],s=e[t],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function clone(n){if(isArray(n))return n.map(clone);if(isObject(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let r=0;for(;r<i;++r)e[t[r]]=clone(n[t[r]]);return e}return n}function isValidKey(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function _merger(n,e,t,i){if(!isValidKey(n))return;const r=e[n],s=t[n];isObject(r)&&isObject(s)?merge(r,s,i):e[n]=clone(s)}function merge(n,e,t){const i=isArray(e)?e:[e],r=i.length;if(!isObject(n))return n;t=t||{};const s=t.merger||_merger;let o;for(let a=0;a<r;++a){if(o=i[a],!isObject(o))continue;const h=Object.keys(o);for(let d=0,u=h.length;d<u;++d)s(h[d],n,o,t)}return n}function mergeIf(n,e){return merge(n,e,{merger:_mergerIf})}function _mergerIf(n,e,t){if(!isValidKey(n))return;const i=e[n],r=t[n];isObject(i)&&isObject(r)?mergeIf(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=clone(r))}const keyResolvers={"":n=>n,x:n=>n.x,y:n=>n.y};function _splitKey(n){const e=n.split("."),t=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function _getKeyResolver(n){const e=_splitKey(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function resolveObjectKey(n,e){return(keyResolvers[e]||(keyResolvers[e]=_getKeyResolver(e)))(n)}function _capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)}const defined=n=>typeof n<"u",isFunction=n=>typeof n=="function",setsEqual=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function _isClickEvent(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(n,e,t){return Math.abs(n-e)<t}function niceNum(n){const e=Math.round(n);n=almostEquals(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(log10(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function _factorize(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,s)=>r-s).pop(),e}function isNonPrimitive(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function isNumber(n){return!isNonPrimitive(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function almostWhole(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function _setMinAndMaxByKey(n,e,t){let i,r,s;for(i=0,r=n.length;i<r;i++)s=n[i][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function toRadians(n){return n*(PI/180)}function toDegrees(n){return n*(180/PI)}function _decimalPlaces(n){if(!isNumberFinite(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function getAngleFromPoint(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);let s=Math.atan2(i,t);return s<-.5*PI&&(s+=TAU),{angle:s,distance:r}}function distanceBetweenPoints(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function _angleDiff(n,e){return(n-e+PITAU)%TAU-PI}function _normalizeAngle(n){return(n%TAU+TAU)%TAU}function _angleBetween(n,e,t,i){const r=_normalizeAngle(n),s=_normalizeAngle(e),o=_normalizeAngle(t),a=_normalizeAngle(s-r),h=_normalizeAngle(o-r),d=_normalizeAngle(r-s),u=_normalizeAngle(r-o);return r===s||r===o||i&&s===o||a>h&&d<u}function _limitValue(n,e,t){return Math.max(e,Math.min(t,n))}function _int16Range(n){return _limitValue(n,-32768,32767)}function _isBetween(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function _lookup(n,e,t){t=t||(o=>n[o]<e);let i=n.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,t(s)?r=s:i=s;return{lo:r,hi:i}}const _lookupByKey=(n,e,t,i)=>_lookup(n,t,i?r=>{const s=n[r][e];return s<t||s===t&&n[r+1][e]===t}:r=>n[r][e]<t),_rlookupByKey=(n,e,t)=>_lookup(n,t,i=>n[i][e]>=t);function _filterBetween(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),arrayEvents.forEach(t=>{const i="_onData"+_capitalize(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const o=r.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function unlistenArrayEvents(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(arrayEvents.forEach(s=>{delete n[s]}),delete n._chartjs)}function _arrayUnique(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const requestAnimFrame=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function throttled(n,e){let t=[],i=!1;return function(...r){t=r,i||(i=!0,requestAnimFrame.call(window,()=>{i=!1,n.apply(e,t)}))}}function debounce(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const _toLeftRightCenter=n=>n==="start"?"left":n==="end"?"right":"center",_alignStartEnd=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,_textX=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function _getStartAndCountOfVisiblePoints(n,e,t){const i=e.length;let r=0,s=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:h}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:m,max:v,minDefined:_,maxDefined:D}=o.getUserBounds();if(_){if(r=Math.min(_lookupByKey(h,u,m).lo,t?i:_lookupByKey(e,u,o.getPixelForValue(m)).lo),d){const f=h.slice(0,r+1).reverse().findIndex(l=>!isNullOrUndef(l[a.axis]));r-=Math.max(0,f)}r=_limitValue(r,0,i-1)}if(D){let f=Math.max(_lookupByKey(h,o.axis,v,!0).hi+1,t?0:_lookupByKey(e,u,o.getPixelForValue(v),!0).hi+1);if(d){const l=h.slice(f-1).findIndex(c=>!isNullOrUndef(c[a.axis]));f+=Math.max(0,l)}s=_limitValue(f,r,i)-r}else s=i-r}return{start:r,count:s}}function _scaleRangesChanged(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),s}const atEdge=n=>n===0||n===1,elasticIn=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*TAU/t)),elasticOut=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*TAU/t)+1,effects={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*HALF_PI)+1,easeOutSine:n=>Math.sin(n*HALF_PI),easeInOutSine:n=>-.5*(Math.cos(PI*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>atEdge(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>atEdge(n)?n:elasticIn(n,.075,.3),easeOutElastic:n=>atEdge(n)?n:elasticOut(n,.075,.3),easeInOutElastic(n){return atEdge(n)?n:n<.5?.5*elasticIn(n*2,.1125,.45):.5+.5*elasticOut(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-effects.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?effects.easeInBounce(n*2)*.5:effects.easeOutBounce(n*2-1)*.5+.5};function isPatternOrGradient(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function color(n){return isPatternOrGradient(n)?n:new Color(n)}function getHoverColor(n){return isPatternOrGradient(n)?n:new Color(n).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function applyLayoutsDefaults(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(n,e){e=e||{};const t=n+JSON.stringify(e);let i=intlCache.get(t);return i||(i=new Intl.NumberFormat(n,e),intlCache.set(t,i)),i}function formatNumber(n,e,t){return getNumberFormat(e,t).format(n)}const formatters={values(n){return isArray(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let r,s=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(r="scientific"),s=calculateDelta(n,t)}const o=log10(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),h={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(h,this.options.ticks.format),formatNumber(n,i,h)},logarithmic(n,e,t){if(n===0)return"0";const i=t[e].significand||n/Math.pow(10,Math.floor(log10(n)));return[1,2,3,5,10,15].includes(i)||e>.8*t.length?formatters.numeric.call(this,n,e,t):""}};function calculateDelta(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Ticks={formatters};function applyScaleDefaults(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(n,e){if(!e)return n;const t=e.split(".");for(let i=0,r=t.length;i<r;++i){const s=t[i];n=n[s]||(n[s]=Object.create(null))}return n}function set(n,e,t){return typeof e=="string"?merge(getScope$1(n,e),t):merge(getScope$1(n,""),e)}class Defaults{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>getHoverColor(r.backgroundColor),this.hoverBorderColor=(i,r)=>getHoverColor(r.borderColor),this.hoverColor=(i,r)=>getHoverColor(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return set(this,e,t)}get(e){return getScope$1(this,e)}describe(e,t){return set(descriptors,e,t)}override(e,t){return set(overrides,e,t)}route(e,t,i,r){const s=getScope$1(this,e),o=getScope$1(this,i),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const h=this[a],d=o[r];return isObject(h)?Object.assign({},d,h):valueOrDefault(h,d)},set(h){this[a]=h}}})}apply(e){e.forEach(t=>t(this))}}var defaults=new Defaults({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(n){return!n||isNullOrUndef(n.size)||isNullOrUndef(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function _measureText(n,e,t,i,r){let s=e[r];return s||(s=e[r]=n.measureText(r).width,t.push(r)),s>i&&(i=s),i}function _longestText(n,e,t,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},s=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let o=0;const a=t.length;let h,d,u,m,v;for(h=0;h<a;h++)if(m=t[h],m!=null&&!isArray(m))o=_measureText(n,r,s,o,m);else if(isArray(m))for(d=0,u=m.length;d<u;d++)v=m[d],v!=null&&!isArray(v)&&(o=_measureText(n,r,s,o,v));n.restore();const _=s.length/2;if(_>t.length){for(h=0;h<_;h++)delete r[s[h]];s.splice(0,_)}return o}function _alignPixel(n,e,t){const i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function clearCanvas(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function drawPoint(n,e,t,i){drawPointLegend(n,e,t,i,null)}function drawPointLegend(n,e,t,i,r){let s,o,a,h,d,u,m,v;const _=e.pointStyle,D=e.rotation,f=e.radius;let l=(D||0)*RAD_PER_DEG;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(l),n.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),n.restore();return}if(!(isNaN(f)||f<=0)){switch(n.beginPath(),_){default:r?n.ellipse(t,i,r/2,f,0,0,TAU):n.arc(t,i,f,0,TAU),n.closePath();break;case"triangle":u=r?r/2:f,n.moveTo(t+Math.sin(l)*u,i-Math.cos(l)*f),l+=TWO_THIRDS_PI,n.lineTo(t+Math.sin(l)*u,i-Math.cos(l)*f),l+=TWO_THIRDS_PI,n.lineTo(t+Math.sin(l)*u,i-Math.cos(l)*f),n.closePath();break;case"rectRounded":d=f*.516,h=f-d,o=Math.cos(l+QUARTER_PI)*h,m=Math.cos(l+QUARTER_PI)*(r?r/2-d:h),a=Math.sin(l+QUARTER_PI)*h,v=Math.sin(l+QUARTER_PI)*(r?r/2-d:h),n.arc(t-m,i-a,d,l-PI,l-HALF_PI),n.arc(t+v,i-o,d,l-HALF_PI,l),n.arc(t+m,i+a,d,l,l+HALF_PI),n.arc(t-v,i+o,d,l+HALF_PI,l+PI),n.closePath();break;case"rect":if(!D){h=Math.SQRT1_2*f,u=r?r/2:h,n.rect(t-u,i-h,2*u,2*h);break}l+=QUARTER_PI;case"rectRot":m=Math.cos(l)*(r?r/2:f),o=Math.cos(l)*f,a=Math.sin(l)*f,v=Math.sin(l)*(r?r/2:f),n.moveTo(t-m,i-a),n.lineTo(t+v,i-o),n.lineTo(t+m,i+a),n.lineTo(t-v,i+o),n.closePath();break;case"crossRot":l+=QUARTER_PI;case"cross":m=Math.cos(l)*(r?r/2:f),o=Math.cos(l)*f,a=Math.sin(l)*f,v=Math.sin(l)*(r?r/2:f),n.moveTo(t-m,i-a),n.lineTo(t+m,i+a),n.moveTo(t+v,i-o),n.lineTo(t-v,i+o);break;case"star":m=Math.cos(l)*(r?r/2:f),o=Math.cos(l)*f,a=Math.sin(l)*f,v=Math.sin(l)*(r?r/2:f),n.moveTo(t-m,i-a),n.lineTo(t+m,i+a),n.moveTo(t+v,i-o),n.lineTo(t-v,i+o),l+=QUARTER_PI,m=Math.cos(l)*(r?r/2:f),o=Math.cos(l)*f,a=Math.sin(l)*f,v=Math.sin(l)*(r?r/2:f),n.moveTo(t-m,i-a),n.lineTo(t+m,i+a),n.moveTo(t+v,i-o),n.lineTo(t-v,i+o);break;case"line":o=r?r/2:Math.cos(l)*f,a=Math.sin(l)*f,n.moveTo(t-o,i-a),n.lineTo(t+o,i+a);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(l)*(r?r/2:f),i+Math.sin(l)*f);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function _isPointInArea(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function clipArea(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function unclipArea(n){n.restore()}function _steppedLineTo(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function _bezierCurveTo(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function setRenderOpts(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),isNullOrUndef(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function decorateText(n,e,t,i,r){if(r.strikethrough||r.underline){const s=n.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,h=t-s.actualBoundingBoxAscent,d=t+s.actualBoundingBoxDescent,u=r.strikethrough?(h+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function drawBackdrop(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function renderText(n,e,t,i,r,s={}){const o=isArray(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let h,d;for(n.save(),n.font=r.string,setRenderOpts(n,s),h=0;h<o.length;++h)d=o[h],s.backdrop&&drawBackdrop(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),isNullOrUndef(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(d,t,i,s.maxWidth)),n.fillText(d,t,i,s.maxWidth),decorateText(n,t,i,d,s),i+=Number(r.lineHeight);n.restore()}function addRoundedRectPath(n,e){const{x:t,y:i,w:r,h:s,radius:o}=e;n.arc(t+o.topLeft,i+o.topLeft,o.topLeft,1.5*PI,PI,!0),n.lineTo(t,i+s-o.bottomLeft),n.arc(t+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,PI,HALF_PI,!0),n.lineTo(t+r-o.bottomRight,i+s),n.arc(t+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,HALF_PI,0,!0),n.lineTo(t+r,i+o.topRight),n.arc(t+r-o.topRight,i+o.topRight,o.topRight,0,-HALF_PI,!0),n.lineTo(t+o.topLeft,i)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(n,e){const t=(""+n).match(LINE_HEIGHT);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const numberOrZero=n=>+n||0;function _readValueToProps(n,e){const t={},i=isObject(e),r=i?Object.keys(e):e,s=isObject(n)?i?o=>valueOrDefault(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of r)t[o]=numberOrZero(s(o));return t}function toTRBL(n){return _readValueToProps(n,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(n){return _readValueToProps(n,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(n){const e=toTRBL(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function toFont(n,e){n=n||{},e=e||defaults.font;let t=valueOrDefault(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=valueOrDefault(n.style,e.style);i&&!(""+i).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:valueOrDefault(n.family,e.family),lineHeight:toLineHeight(valueOrDefault(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:valueOrDefault(n.weight,e.weight),string:""};return r.string=toFontString(r),r}function resolve(n,e,t,i){let r,s,o;for(r=0,s=n.length;r<s;++r)if(o=n[r],o!==void 0&&o!==void 0)return o}function _addGrace(n,e,t){const{min:i,max:r}=n,s=toDimension(e,(r-i)/2),o=(a,h)=>t&&a===0?0:a+h;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function createContext(n,e){return Object.assign(Object.create(n),e)}function _createResolver(n,e=[""],t,i,r=()=>n[0]){const s=t||n;typeof i>"u"&&(i=_resolve("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>_createResolver([a,...n],e,s,i)};return new Proxy(o,{deleteProperty(a,h){return delete a[h],delete a._keys,delete n[0][h],!0},get(a,h){return _cached(a,h,()=>_resolveWithPrefixes(h,e,n,a))},getOwnPropertyDescriptor(a,h){return Reflect.getOwnPropertyDescriptor(a._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,h){return getKeysFromAllScopes(a).includes(h)},ownKeys(a){return getKeysFromAllScopes(a)},set(a,h,d){const u=a._storage||(a._storage=r());return a[h]=u[h]=d,delete a._keys,!0}})}function _attachContext(n,e,t,i){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:_descriptors(n,i),setContext:s=>_attachContext(n,s,t,i),override:s=>_attachContext(n.override(s),e,t,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return _cached(s,o,()=>_resolveWithContext(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function _descriptors(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:isFunction(t)?t:()=>t,isIndexable:isFunction(i)?i:()=>i}}const readKey=(n,e)=>n?n+_capitalize(e):e,needsSubResolver=(n,e)=>isObject(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _cached(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function _resolveWithContext(n,e,t){const{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=n;let a=i[e];return isFunction(a)&&o.isScriptable(e)&&(a=_resolveScriptable(e,a,n,t)),isArray(a)&&a.length&&(a=_resolveArray(e,a,n,o.isIndexable)),needsSubResolver(e,a)&&(a=_attachContext(a,r,s&&s[e],o)),a}function _resolveScriptable(n,e,t,i){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let h=e(s,o||i);return a.delete(n),needsSubResolver(n,h)&&(h=createSubResolver(r._scopes,r,n,h)),h}function _resolveArray(n,e,t,i){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=t;if(typeof s.index<"u"&&i(n))return e[s.index%e.length];if(isObject(e[0])){const h=e,d=r._scopes.filter(u=>u!==h);e=[];for(const u of h){const m=createSubResolver(d,r,n,u);e.push(_attachContext(m,s,o&&o[n],a))}}return e}function resolveFallback(n,e,t){return isFunction(n)?n(e,t):n}const getScope=(n,e)=>n===!0?e:typeof n=="string"?resolveObjectKey(e,n):void 0;function addScopes(n,e,t,i,r){for(const s of e){const o=getScope(t,s);if(o){n.add(o);const a=resolveFallback(o._fallback,t,r);if(typeof a<"u"&&a!==t&&a!==i)return a}else if(o===!1&&typeof i<"u"&&t!==i)return null}return!1}function createSubResolver(n,e,t,i){const r=e._rootScopes,s=resolveFallback(e._fallback,t,i),o=[...n,...r],a=new Set;a.add(i);let h=addScopesFromKey(a,o,t,s||t,i);return h===null||typeof s<"u"&&s!==t&&(h=addScopesFromKey(a,o,s,h,i),h===null)?!1:_createResolver(Array.from(a),[""],r,s,()=>subGetTarget(e,t,i))}function addScopesFromKey(n,e,t,i,r){for(;t;)t=addScopes(n,e,t,i,r);return t}function subGetTarget(n,e,t){const i=n._getTarget();e in i||(i[e]={});const r=i[e];return isArray(r)&&isObject(t)?t:r||{}}function _resolveWithPrefixes(n,e,t,i){let r;for(const s of e)if(r=_resolve(readKey(s,n),t),typeof r<"u")return needsSubResolver(n,r)?createSubResolver(t,i,n,r):r}function _resolve(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function getKeysFromAllScopes(n){let e=n._keys;return e||(e=n._keys=resolveKeysFromAllScopes(n._scopes)),e}function resolveKeysFromAllScopes(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function _parseObjectDataRadialScale(n,e,t,i){const{iScale:r}=n,{key:s="r"}=this._parsing,o=new Array(i);let a,h,d,u;for(a=0,h=i;a<h;++a)d=a+t,u=e[d],o[a]={r:r.parse(resolveObjectKey(u,s),d)};return o}const EPSILON=Number.EPSILON||1e-14,getPoint=(n,e)=>e<n.length&&!n[e].skip&&n[e],getValueAxis=n=>n==="x"?"y":"x";function splineCurve(n,e,t,i){const r=n.skip?e:n,s=e,o=t.skip?e:t,a=distanceBetweenPoints(s,r),h=distanceBetweenPoints(o,s);let d=a/(a+h),u=h/(a+h);d=isNaN(d)?0:d,u=isNaN(u)?0:u;const m=i*d,v=i*u;return{previous:{x:s.x-m*(o.x-r.x),y:s.y-m*(o.y-r.y)},next:{x:s.x+v*(o.x-r.x),y:s.y+v*(o.y-r.y)}}}function monotoneAdjust(n,e,t){const i=n.length;let r,s,o,a,h,d=getPoint(n,0);for(let u=0;u<i-1;++u)if(h=d,d=getPoint(n,u+1),!(!h||!d)){if(almostEquals(e[u],0,EPSILON)){t[u]=t[u+1]=0;continue}r=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=r*o*e[u],t[u+1]=s*o*e[u])}}function monotoneCompute(n,e,t="x"){const i=getValueAxis(t),r=n.length;let s,o,a,h=getPoint(n,0);for(let d=0;d<r;++d){if(o=a,a=h,h=getPoint(n,d+1),!a)continue;const u=a[t],m=a[i];o&&(s=(u-o[t])/3,a[`cp1${t}`]=u-s,a[`cp1${i}`]=m-s*e[d]),h&&(s=(h[t]-u)/3,a[`cp2${t}`]=u+s,a[`cp2${i}`]=m+s*e[d])}}function splineCurveMonotone(n,e="x"){const t=getValueAxis(e),i=n.length,r=Array(i).fill(0),s=Array(i);let o,a,h,d=getPoint(n,0);for(o=0;o<i;++o)if(a=h,h=d,d=getPoint(n,o+1),!!h){if(d){const u=d[e]-h[e];r[o]=u!==0?(d[t]-h[t])/u:0}s[o]=a?d?sign(r[o-1])!==sign(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}monotoneAdjust(n,r,s),monotoneCompute(n,s,e)}function capControlPoint(n,e,t){return Math.max(Math.min(n,t),e)}function capBezierPoints(n,e){let t,i,r,s,o,a=_isPointInArea(n[0],e);for(t=0,i=n.length;t<i;++t)o=s,s=a,a=t<i-1&&_isPointInArea(n[t+1],e),s&&(r=n[t],o&&(r.cp1x=capControlPoint(r.cp1x,e.left,e.right),r.cp1y=capControlPoint(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=capControlPoint(r.cp2x,e.left,e.right),r.cp2y=capControlPoint(r.cp2y,e.top,e.bottom)))}function _updateBezierControlPoints(n,e,t,i,r){let s,o,a,h;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")splineCurveMonotone(n,r);else{let d=i?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],h=splineCurve(d,a,n[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=h.previous.x,a.cp1y=h.previous.y,a.cp2x=h.next.x,a.cp2y=h.next.y,d=a}e.capBezierPoints&&capBezierPoints(n,t)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function parseMaxStyle(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const getComputedStyle$1=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function getStyle(n,e){return getComputedStyle$1(n).getPropertyValue(e)}const positions=["top","right","bottom","left"];function getPositionedStyle(n,e,t){const i={};t=t?"-"+t:"";for(let r=0;r<4;r++){const s=positions[r];i[s]=parseFloat(n[e+"-"+s+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const useOffsetPos=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function getCanvasPosition(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:s}=i;let o=!1,a,h;if(useOffsetPos(r,s,n.target))a=r,h=s;else{const d=e.getBoundingClientRect();a=i.clientX-d.left,h=i.clientY-d.top,o=!0}return{x:a,y:h,box:o}}function getRelativePosition(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,r=getComputedStyle$1(t),s=r.boxSizing==="border-box",o=getPositionedStyle(r,"padding"),a=getPositionedStyle(r,"border","width"),{x:h,y:d,box:u}=getCanvasPosition(n,t),m=o.left+(u&&a.left),v=o.top+(u&&a.top);let{width:_,height:D}=e;return s&&(_-=o.width+a.width,D-=o.height+a.height),{x:Math.round((h-m)/_*t.width/i),y:Math.round((d-v)/D*t.height/i)}}function getContainerSize(n,e,t){let i,r;if(e===void 0||t===void 0){const s=n&&_getParentNode(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const o=s.getBoundingClientRect(),a=getComputedStyle$1(s),h=getPositionedStyle(a,"border","width"),d=getPositionedStyle(a,"padding");e=o.width-d.width-h.width,t=o.height-d.height-h.height,i=parseMaxStyle(a.maxWidth,s,"clientWidth"),r=parseMaxStyle(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:i||INFINITY,maxHeight:r||INFINITY}}const round1=n=>Math.round(n*10)/10;function getMaximumSize(n,e,t,i){const r=getComputedStyle$1(n),s=getPositionedStyle(r,"margin"),o=parseMaxStyle(r.maxWidth,n,"clientWidth")||INFINITY,a=parseMaxStyle(r.maxHeight,n,"clientHeight")||INFINITY,h=getContainerSize(n,e,t);let{width:d,height:u}=h;if(r.boxSizing==="content-box"){const v=getPositionedStyle(r,"border","width"),_=getPositionedStyle(r,"padding");d-=_.width+v.width,u-=_.height+v.height}return d=Math.max(0,d-s.width),u=Math.max(0,i?d/i:u-s.height),d=round1(Math.min(d,o,h.maxWidth)),u=round1(Math.min(u,a,h.maxHeight)),d&&!u&&(u=round1(d/2)),(e!==void 0||t!==void 0)&&i&&h.height&&u>h.height&&(u=h.height,d=round1(Math.floor(u*i))),{width:d,height:u}}function retinaScale(n,e,t){const i=e||1,r=Math.floor(n.height*i),s=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(n.currentDevicePixelRatio=i,o.height=r,o.width=s,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const supportsEventListenerOptions=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function readUsedSize(n,e){const t=getStyle(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function _pointInLine(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function _steppedInterpolation(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function _bezierInterpolation(n,e,t,i){const r={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=_pointInLine(n,r,t),a=_pointInLine(r,s,t),h=_pointInLine(s,e,t),d=_pointInLine(o,a,t),u=_pointInLine(a,h,t);return _pointInLine(d,u,t)}const getRightToLeftAdapter=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},getLeftToRightAdapter=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function getRtlAdapter(n,e,t){return n?getRightToLeftAdapter(e,t):getLeftToRightAdapter()}function overrideTextDirection(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function restoreTextDirection(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function propertyFn(n){return n==="angle"?{between:_angleBetween,compare:_angleDiff,normalize:_normalizeAngle}:{between:_isBetween,compare:(e,t)=>e-t,normalize:e=>e}}function normalizeSegment({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function getSegment(n,e,t){const{property:i,start:r,end:s}=t,{between:o,normalize:a}=propertyFn(i),h=e.length;let{start:d,end:u,loop:m}=n,v,_;if(m){for(d+=h,u+=h,v=0,_=h;v<_&&o(a(e[d%h][i]),r,s);++v)d--,u--;d%=h,u%=h}return u<d&&(u+=h),{start:d,end:u,loop:m,style:n.style}}function _boundSegment(n,e,t){if(!t)return[n];const{property:i,start:r,end:s}=t,o=e.length,{compare:a,between:h,normalize:d}=propertyFn(i),{start:u,end:m,loop:v,style:_}=getSegment(n,e,t),D=[];let f=!1,l=null,c,p,b;const E=()=>h(r,b,c)&&a(r,b)!==0,C=()=>a(s,c)===0||h(s,b,c),g=()=>f||E(),x=()=>!f||C();for(let y=u,w=u;y<=m;++y)p=e[y%o],!p.skip&&(c=d(p[i]),c!==b&&(f=h(c,r,s),l===null&&g()&&(l=a(c,r)===0?y:w),l!==null&&x()&&(D.push(normalizeSegment({start:l,end:y,loop:v,count:o,style:_})),l=null),w=y,b=c));return l!==null&&D.push(normalizeSegment({start:l,end:m,loop:v,count:o,style:_})),D}function _boundSegments(n,e){const t=[],i=n.segments;for(let r=0;r<i.length;r++){const s=_boundSegment(i[r],n.points,e);s.length&&t.push(...s)}return t}function findStartAndEnd(n,e,t,i){let r=0,s=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(s+=r);s>r&&n[s%e].skip;)s--;return s%=e,{start:r,end:s}}function solidSegments(n,e,t,i){const r=n.length,s=[];let o=e,a=n[e],h;for(h=e+1;h<=t;++h){const d=n[h%r];d.skip||d.stop?a.skip||(i=!1,s.push({start:e%r,end:(h-1)%r,loop:i}),e=o=d.stop?h:null):(o=h,a.skip&&(e=h)),a=d}return o!==null&&s.push({start:e%r,end:o%r,loop:i}),s}function _computeSegments(n,e){const t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];const s=!!n._loop,{start:o,end:a}=findStartAndEnd(t,r,s,i);if(i===!0)return splitByStyles(n,[{start:o,end:a,loop:s}],t,e);const h=a<o?a+r:a,d=!!n._fullLoop&&o===0&&a===r-1;return splitByStyles(n,solidSegments(t,o,h,d),t,e)}function splitByStyles(n,e,t,i){return!i||!i.setContext||!t?e:doSplitByStyles(n,e,t,i)}function doSplitByStyles(n,e,t,i){const r=n._chart.getContext(),s=readStyle(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,h=t.length,d=[];let u=s,m=e[0].start,v=m;function _(D,f,l,c){const p=a?-1:1;if(D!==f){for(D+=h;t[D%h].skip;)D-=p;for(;t[f%h].skip;)f+=p;D%h!==f%h&&(d.push({start:D%h,end:f%h,loop:l,style:c}),u=c,m=f%h)}}for(const D of e){m=a?m:D.start;let f=t[m%h],l;for(v=m+1;v<=D.end;v++){const c=t[v%h];l=readStyle(i.setContext(createContext(r,{type:"segment",p0:f,p1:c,p0DataIndex:(v-1)%h,p1DataIndex:v%h,datasetIndex:o}))),styleChanged(l,u)&&_(m,v-1,D.loop,u),f=c,u=l}m<v-1&&_(m,v-1,D.loop,u)}return d}function readStyle(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function styleChanged(n,e){if(!e)return!1;const t=[],i=function(r,s){return isPatternOrGradient(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function getSizeForArea(n,e,t){return n.options.clip?n[t]:e[t]}function getDatasetArea(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:getSizeForArea(t,e,"left"),right:getSizeForArea(t,e,"right"),top:getSizeForArea(i,e,"top"),bottom:getSizeForArea(i,e,"bottom")}:e}function getDatasetClipArea(n,e){const t=e._clip;if(t.disabled)return!1;const i=getDatasetArea(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const s=t.listeners[r],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(i-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let o=s.length-1,a=!1,h;for(;o>=0;--o)h=s[o],h._active?(h._total>i.duration&&(i.duration=h._total),h.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=color(n||transparent),r=i.valid&&color(e||transparent);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Animation{constructor(e,t,i,r){const s=t[i];r=resolve([e.to,r,s,e.from]);const o=resolve([e.from,s,r]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof o],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=resolve([e.to,t,r,e.from]),this._from=resolve([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to;let h;if(this._active=s!==a&&(o||t<i),!this._active){this._target[r]=a,this._notify(!0);return}if(t<0){this._target[r]=s;return}h=t/i%2,h=o&&h>1?2-h:h,h=this._easing(Math.min(1,Math.max(0,h))),this._target[r]=this._fn(s,a,h)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}}class Animations{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!isObject(e))return;const t=Object.keys(defaults.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!isObject(s))return;const o={};for(const a of t)o[a]=s[a];(isArray(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,t){const i=t.options,r=resolveTargetOptions(e,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&awaitAll(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,t){const i=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let h;for(h=o.length-1;h>=0;--h){const d=o[h];if(d.charAt(0)==="$")continue;if(d==="options"){r.push(...this._animateOptions(e,t));continue}const u=t[d];let m=s[d];const v=i.get(d);if(m)if(v&&m.active()){m.update(v,u,a);continue}else m.cancel();if(!v||!v.duration){e[d]=u;continue}s[d]=m=new Animation(v,e,d,u),r.push(m)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return animator.add(this._chart,i),!0}}function awaitAll(n,e){const t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const s=n[i[r]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function resolveTargetOptions(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function scaleClip(n,e){const t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function defaultClip(n,e,t){if(t===!1)return!1;const i=scaleClip(n,t),r=scaleClip(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function toClip(n){let e,t,i,r;return isObject(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function getSortedDatasetIndices(n,e){const t=[],i=n._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)t.push(i[r].index);return t}function applyStack(n,e,t,i={}){const r=n.keys,s=i.mode==="single";let o,a,h,d;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(h=+r[o],h===t){if(u=!0,i.all)continue;break}d=n.values[h],isNumberFinite(d)&&(s||e===0||sign(e)===sign(d))&&(e+=d)}return!u&&!i.all?0:e}function convertObjectDataToArray(n,e){const{iScale:t,vScale:i}=e,r=t.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let h,d,u;for(h=0,d=o.length;h<d;++h)u=o[h],a[h]={[r]:u,[s]:n[u]};return a}function isStacked(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function getStackKey(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function getUserBounds(n){const{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function getOrCreateStack(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function getLastIndexInStack(n,e,t,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const s=n[r.index];if(t&&s>0||!t&&s<0)return r.index}return null}function updateStacks(n,e){const{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=i,h=s.axis,d=o.axis,u=getStackKey(s,o,i),m=e.length;let v;for(let _=0;_<m;++_){const D=e[_],{[h]:f,[d]:l}=D,c=D._stacks||(D._stacks={});v=c[d]=getOrCreateStack(r,u,f),v[a]=l,v._top=getLastIndexInStack(v,o,!0,i.type),v._bottom=getLastIndexInStack(v,o,!1,i.type);const p=v._visualValues||(v._visualValues={});p[a]=l}}function getFirstScaleId(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function createDatasetContext(n,e){return createContext(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function createDataContext(n,e,t){return createContext(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function clearStacks(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const r of e){const s=r._stacks;if(!s||s[i]===void 0||s[i][t]===void 0)return;delete s[i][t],s[i]._visualValues!==void 0&&s[i]._visualValues[t]!==void 0&&delete s[i]._visualValues[t]}}}const isDirectUpdateMode=n=>n==="reset"||n==="none",cloneIfNotShared=(n,e)=>e?n:Object.assign({},n),createStack=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:getSortedDatasetIndices(t,!0),values:null};class DatasetController{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(m,v,_,D)=>m==="x"?v:m==="r"?D:_,s=t.xAxisID=valueOrDefault(i.xAxisID,getFirstScaleId(e,"x")),o=t.yAxisID=valueOrDefault(i.yAxisID,getFirstScaleId(e,"y")),a=t.rAxisID=valueOrDefault(i.rAxisID,getFirstScaleId(e,"r")),h=t.indexAxis,d=t.iAxisID=r(h,s,o,a),u=t.vAxisID=r(h,o,s,a);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(isObject(t)){const r=this._cachedMeta;this._data=convertObjectDataToArray(t,r)}else if(i!==t){if(i){unlistenArrayEvents(i,this);const r=this._cachedMeta;clearStacks(r),r._parsed=[]}t&&Object.isExtensible(t)&&listenArrayEvents(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=t._stacked;t._stacked=isStacked(t.vScale,t),t.stack!==i.stack&&(r=!0,clearStacks(t),t.stack=i.stack),this._resyncElements(e),(r||s!==t._stacked)&&(updateStacks(this,t._parsed),t._stacked=isStacked(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:o}=i,a=s.axis;let h=e===0&&t===r.length?!0:i._sorted,d=e>0&&i._parsed[e-1],u,m,v;if(this._parsing===!1)i._parsed=r,i._sorted=!0,v=r;else{isArray(r[e])?v=this.parseArrayData(i,r,e,t):isObject(r[e])?v=this.parseObjectData(i,r,e,t):v=this.parsePrimitiveData(i,r,e,t);const _=()=>m[a]===null||d&&m[a]<d[a];for(u=0;u<t;++u)i._parsed[u+e]=m=v[u],h&&(_()&&(h=!1),d=m);i._sorted=h}o&&updateStacks(this,v)}parsePrimitiveData(e,t,i,r){const{iScale:s,vScale:o}=e,a=s.axis,h=o.axis,d=s.getLabels(),u=s===o,m=new Array(r);let v,_,D;for(v=0,_=r;v<_;++v)D=v+i,m[v]={[a]:u||s.parse(d[D],D),[h]:o.parse(t[D],D)};return m}parseArrayData(e,t,i,r){const{xScale:s,yScale:o}=e,a=new Array(r);let h,d,u,m;for(h=0,d=r;h<d;++h)u=h+i,m=t[u],a[h]={x:s.parse(m[0],u),y:o.parse(m[1],u)};return a}parseObjectData(e,t,i,r){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:h="y"}=this._parsing,d=new Array(r);let u,m,v,_;for(u=0,m=r;u<m;++u)v=u+i,_=t[v],d[u]={x:s.parse(resolveObjectKey(_,a),v),y:o.parse(resolveObjectKey(_,h),v)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,s=this._cachedMeta,o=t[e.axis],a={keys:getSortedDatasetIndices(r,!0),values:t._stacks[e.axis]._visualValues};return applyStack(a,o,s.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const s=i[t.axis];let o=s===null?NaN:s;const a=r&&i._stacks[t.axis];r&&a&&(r.values=a,o=applyStack(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&e===i.iScale,o=r.length,a=this._getOtherScale(e),h=createStack(t,i,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:m}=getUserBounds(a);let v,_;function D(){_=r[v];const f=_[a.axis];return!isNumberFinite(_[e.axis])||u>f||m<f}for(v=0;v<o&&!(!D()&&(this.updateRangeFromParsed(d,e,_,h),s));++v);if(s){for(v=o-1;v>=0;--v)if(!D()){this.updateRangeFromParsed(d,e,_,h);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,s,o;for(r=0,s=t.length;r<s;++r)o=t[r][e.axis],isNumberFinite(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=toClip(valueOrDefault(this.options.clip,defaultClip(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],s=t.chartArea,o=[],a=this._drawStart||0,h=this._drawCount||r.length-a,d=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(e,s,a,h),u=a;u<a+h;++u){const m=r[u];m.hidden||(m.active&&d?o.push(m):m.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=createDataContext(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",s=this._cachedDataOpts,o=e+"-"+t,a=s[o],h=this.enableOptionSharing&&defined(i);if(a)return cloneIfNotShared(a,h);const d=this.chart.config,u=d.datasetElementScopeKeys(this._type,e),m=r?[`${e}Hover`,"hover",e,""]:[e,""],v=d.getOptionScopes(this.getDataset(),u),_=Object.keys(defaults.elements[e]),D=()=>this.getContext(i,r,t),f=d.resolveNamedOptions(v,_,D,m);return f.$shared&&(f.$shared=h,s[o]=Object.freeze(cloneIfNotShared(f,h))),f}_resolveAnimations(e,t,i){const r=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,a=s[o];if(a)return a;let h;if(r.options.animation!==!1){const u=this.chart.config,m=u.datasetAnimationScopeKeys(this._type,t),v=u.getOptionScopes(this.getDataset(),m);h=u.createResolver(v,this.getContext(e,i,t))}const d=new Animations(r,h&&h.animations);return h&&h._cacheable&&(s[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,s=this.getSharedOptions(i),o=this.includeOptions(t,s)||s!==r;return this.updateSharedOptions(s,t,i),{sharedOptions:s,includeOptions:o}}updateElement(e,t,i,r){isDirectUpdateMode(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!isDirectUpdateMode(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const s=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[a,h,d]of this._syncList)this[a](h,d);this._syncList=[];const r=i.length,s=t.length,o=Math.min(s,r);o&&this.parse(0,o),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,t,i=!0){const r=this._cachedMeta,s=r.data,o=e+t;let a;const h=d=>{for(d.length+=t,a=d.length-1;a>=o;a--)d[a]=d[a-t]};for(h(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&h(r._parsed),this.parse(e,t),i&&this.updateElements(s,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&clearStacks(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}je(DatasetController,"defaults",{}),je(DatasetController,"datasetElementType",null),je(DatasetController,"dataElementType",null);function getAllScaleValues(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let r=0,s=t.length;r<s;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=_arrayUnique(i.sort((r,s)=>r-s))}return n._cache.$bar}function computeMinSampleSize(n){const e=n.iScale,t=getAllScaleValues(e,n.type);let i=e._length,r,s,o,a;const h=()=>{o===32767||o===-32768||(defined(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(r=0,s=t.length;r<s;++r)o=e.getPixelForValue(t[r]),h();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),h();return i}function computeFitCategoryTraits(n,e,t,i){const r=t.barThickness;let s,o;return isNullOrUndef(r)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:e.pixels[n]-s/2}}function computeFlexCategoryTraits(n,e,t,i){const r=e.pixels,s=r[n];let o=n>0?r[n-1]:null,a=n<r.length-1?r[n+1]:null;const h=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const d=s-(s-Math.min(o,a))/2*h;return{chunk:Math.abs(a-o)/2*h/i,ratio:t.barPercentage,start:d}}function parseFloatBar(n,e,t,i){const r=t.parse(n[0],i),s=t.parse(n[1],i),o=Math.min(r,s),a=Math.max(r,s);let h=o,d=a;Math.abs(o)>Math.abs(a)&&(h=a,d=o),e[t.axis]=d,e._custom={barStart:h,barEnd:d,start:r,end:s,min:o,max:a}}function parseValue(n,e,t,i){return isArray(n)?parseFloatBar(n,e,t,i):e[t.axis]=t.parse(n,i),e}function parseArrayOrPrimitive(n,e,t,i){const r=n.iScale,s=n.vScale,o=r.getLabels(),a=r===s,h=[];let d,u,m,v;for(d=t,u=t+i;d<u;++d)v=e[d],m={},m[r.axis]=a||r.parse(o[d],d),h.push(parseValue(v,m,s,d));return h}function isFloatBar(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function barSign(n,e,t){return n!==0?sign(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function borderProps(n){let e,t,i,r,s;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:t,end:i,reverse:e,top:r,bottom:s}}function setBorderSkipped(n,e,t,i){let r=e.borderSkipped;const s={};if(!r){n.borderSkipped=s;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:h,top:d,bottom:u}=borderProps(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=d:(t._bottom||0)===i?r=u:(s[parseEdge(u,o,a,h)]=!0,r=d)),s[parseEdge(r,o,a,h)]=!0,n.borderSkipped=s}function parseEdge(n,e,t,i){return i?(n=swap(n,e,t),n=startEnd(n,t,e)):n=startEnd(n,e,t),n}function swap(n,e,t){return n===e?t:n===t?e:n}function startEnd(n,e,t){return n==="start"?e:n==="end"?t:n}function setInflateAmount(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class BarController extends DatasetController{parsePrimitiveData(e,t,i,r){return parseArrayOrPrimitive(e,t,i,r)}parseArrayData(e,t,i,r){return parseArrayOrPrimitive(e,t,i,r)}parseObjectData(e,t,i,r){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:h="y"}=this._parsing,d=s.axis==="x"?a:h,u=o.axis==="x"?a:h,m=[];let v,_,D,f;for(v=i,_=i+r;v<_;++v)f=t[v],D={},D[s.axis]=s.parse(resolveObjectKey(f,d),v),m.push(parseValue(resolveObjectKey(f,u),D,o,v));return m}updateRangeFromParsed(e,t,i,r){super.updateRangeFromParsed(e,t,i,r);const s=i._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:r}=t,s=this.getParsed(e),o=s._custom,a=isFloatBar(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,r){const s=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,h=a.getBasePixel(),d=a.isHorizontal(),u=this._getRuler(),{sharedOptions:m,includeOptions:v}=this._getSharedOptions(t,r);for(let _=t;_<t+i;_++){const D=this.getParsed(_),f=s||isNullOrUndef(D[a.axis])?{base:h,head:h}:this._calculateBarValuePixels(_),l=this._calculateBarIndexPixels(_,u),c=(D._stacks||{})[a.axis],p={horizontal:d,base:f.base,enableBorderRadius:!c||isFloatBar(D._custom)||o===c._top||o===c._bottom,x:d?f.head:l.center,y:d?l.center:f.head,height:d?l.size:Math.abs(f.size),width:d?Math.abs(f.size):l.size};v&&(p.options=m||this.resolveDataElementOptions(_,e[_].active?"active":r));const b=p.options||e[_].options;setBorderSkipped(p,b,c,o),setInflateAmount(p,b,u.ratio),this.updateElement(e[_],_,p,r)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),h=a&&a[i.axis],d=u=>{const m=u._parsed.find(_=>_[i.axis]===h),v=m&&m[u.vScale.axis];if(isNullOrUndef(v)||isNaN(v))return!0};for(const u of r)if(!(t!==void 0&&d(u))&&((s===!1||o.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const r=this._getStacks(e,i),s=t!==void 0?r.indexOf(t):-1;return s===-1?r.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,r=[];let s,o;for(s=0,o=t.data.length;s<o;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const a=e.barThickness;return{min:a||computeMinSampleSize(t),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:r},options:{base:s,minBarLength:o}}=this,a=s||0,h=this.getParsed(e),d=h._custom,u=isFloatBar(d);let m=h[t.axis],v=0,_=i?this.applyStack(t,h,i):m,D,f;_!==m&&(v=_-m,_=m),u&&(m=d.barStart,_=d.barEnd-d.barStart,m!==0&&sign(m)!==sign(d.barEnd)&&(v=0),v+=m);const l=!isNullOrUndef(s)&&!u?s:v;let c=t.getPixelForValue(l);if(this.chart.getDataVisibility(e)?D=t.getPixelForValue(v+_):D=c,f=D-c,Math.abs(f)<o){f=barSign(f,t,a)*o,m===a&&(c-=f/2);const p=t.getPixelForDecimal(0),b=t.getPixelForDecimal(1),E=Math.min(p,b),C=Math.max(p,b);c=Math.max(Math.min(c,C),E),D=c+f,i&&!u&&(h._stacks[t.axis]._visualValues[r]=t.getValueForPixel(D)-t.getValueForPixel(c))}if(c===t.getPixelForValue(a)){const p=sign(f)*t.getLineWidthForValue(a)/2;c+=p,f-=p}return{size:f,base:c,head:D,center:D+f/2}}_calculateBarIndexPixels(e,t){const i=t.scale,r=this.options,s=r.skipNull,o=valueOrDefault(r.maxBarThickness,1/0);let a,h;if(t.grouped){const d=s?this._getStackCount(e):t.stackCount,u=r.barThickness==="flex"?computeFlexCategoryTraits(e,t,r,d):computeFitCategoryTraits(e,t,r,d),m=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=u.start+u.chunk*m+u.chunk/2,h=Math.min(o,u.chunk*u.ratio)}else a=i.getPixelForValue(this.getParsed(e)[i.axis],e),h=Math.min(o,t.min*t.ratio);return{base:a-h/2,head:a+h/2,center:a,size:h}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[t.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}je(BarController,"id","bar"),je(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),je(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class BubbleController extends DatasetController{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,r){const s=super.parsePrimitiveData(e,t,i,r);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+i).radius;return s}parseArrayData(e,t,i,r){const s=super.parseArrayData(e,t,i,r);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=valueOrDefault(a[2],this.resolveDataElementOptions(o+i).radius)}return s}parseObjectData(e,t,i,r){const s=super.parseObjectData(e,t,i,r);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=valueOrDefault(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=t,o=this.getParsed(e),a=r.getLabelForValue(o.x),h=s.getLabelForValue(o.y),d=o._custom;return{label:i[e]||"",value:"("+a+", "+h+(d?", "+d:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(t,r),u=o.axis,m=a.axis;for(let v=t;v<t+i;v++){const _=e[v],D=!s&&this.getParsed(v),f={},l=f[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(D[u]),c=f[m]=s?a.getBasePixel():a.getPixelForValue(D[m]);f.skip=isNaN(l)||isNaN(c),d&&(f.options=h||this.resolveDataElementOptions(v,_.active?"active":r),s&&(f.options.radius=0)),this.updateElement(_,v,f,r)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let r=super.resolveDataElementOptions(e,t);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return t!=="active"&&(r.radius=0),r.radius+=valueOrDefault(i&&i._custom,s),r}}je(BubbleController,"id","bubble"),je(BubbleController,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),je(BubbleController,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function getRatioAndOffset(n,e,t){let i=1,r=1,s=0,o=0;if(e<TAU){const a=n,h=a+e,d=Math.cos(a),u=Math.sin(a),m=Math.cos(h),v=Math.sin(h),_=(b,E,C)=>_angleBetween(b,a,h,!0)?1:Math.max(E,E*t,C,C*t),D=(b,E,C)=>_angleBetween(b,a,h,!0)?-1:Math.min(E,E*t,C,C*t),f=_(0,d,m),l=_(HALF_PI,u,v),c=D(PI,d,m),p=D(PI+HALF_PI,u,v);i=(f-c)/2,r=(l-p)/2,s=-(f+c)/2,o=-(l+p)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}class DoughnutController extends DatasetController{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=h=>+i[h];if(isObject(i[e])){const{key:h="value"}=this._parsing;s=d=>+resolveObjectKey(i[d],h)}let o,a;for(o=e,a=e+t;o<a;++o)r._parsed[o]=s(o)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let e=TAU,t=-TAU;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),o=r._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,r=this._cachedMeta,s=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),h=Math.min(toPercentage(this.options.cutout,a),1),d=this._getRingWeight(this.index),{circumference:u,rotation:m}=this._getRotationExtents(),{ratioX:v,ratioY:_,offsetX:D,offsetY:f}=getRatioAndOffset(m,u,h),l=(i.width-o)/v,c=(i.height-o)/_,p=Math.max(Math.min(l,c)/2,0),b=toDimension(this.options.radius,p),E=Math.max(b*h,0),C=(b-E)/this._getVisibleDatasetWeightTotal();this.offsetX=D*b,this.offsetY=f*b,r.total=this.calculateTotal(),this.outerRadius=b-C*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-C*d,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/TAU)}updateElements(e,t,i,r){const s=r==="reset",o=this.chart,a=o.chartArea,d=o.options.animation,u=(a.left+a.right)/2,m=(a.top+a.bottom)/2,v=s&&d.animateScale,_=v?0:this.innerRadius,D=v?0:this.outerRadius,{sharedOptions:f,includeOptions:l}=this._getSharedOptions(t,r);let c=this._getRotation(),p;for(p=0;p<t;++p)c+=this._circumference(p,s);for(p=t;p<t+i;++p){const b=this._circumference(p,s),E=e[p],C={x:u+this.offsetX,y:m+this.offsetY,startAngle:c,endAngle:c+b,circumference:b,outerRadius:D,innerRadius:_};l&&(C.options=f||this.resolveDataElementOptions(p,E.active?"active":r)),c+=b,this.updateElement(E,p,C,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,r;for(r=0;r<t.length;r++){const s=e._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?TAU*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=formatNumber(t._parsed[e],i.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const i=this.chart;let r,s,o,a,h;if(!e){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){o=i.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,s=e.length;r<s;++r)h=a.resolveDataElementOptions(r),h.borderAlign!=="inner"&&(t=Math.max(t,h.borderWidth||0,h.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,r=e.length;i<r;++i){const s=this.resolveDataElementOptions(i);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(valueOrDefault(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}je(DoughnutController,"id","doughnut"),je(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),je(DoughnutController,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),je(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return t.labels.map((s,o)=>{const h=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:r,lineWidth:h.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}});class LineController extends DatasetController{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:a,count:h}=_getStartAndCountOfVisiblePoints(t,r,o);this._drawStart=a,this._drawCount=h,_scaleRangesChanged(t)&&(a=0,h=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:d},e),this.updateElements(r,a,h,e)}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:h,_dataset:d}=this._cachedMeta,{sharedOptions:u,includeOptions:m}=this._getSharedOptions(t,r),v=o.axis,_=a.axis,{spanGaps:D,segment:f}=this.options,l=isNumber(D)?D:Number.POSITIVE_INFINITY,c=this.chart._animationsDisabled||s||r==="none",p=t+i,b=e.length;let E=t>0&&this.getParsed(t-1);for(let C=0;C<b;++C){const g=e[C],x=c?g:{};if(C<t||C>=p){x.skip=!0;continue}const y=this.getParsed(C),w=isNullOrUndef(y[_]),M=x[v]=o.getPixelForValue(y[v],C),S=x[_]=s||w?a.getBasePixel():a.getPixelForValue(h?this.applyStack(a,y,h):y[_],C);x.skip=isNaN(M)||isNaN(S)||w,x.stop=C>0&&Math.abs(y[v]-E[v])>l,f&&(x.parsed=y,x.raw=d.data[C]),m&&(x.options=u||this.resolveDataElementOptions(C,g.active?"active":r)),c||this.updateElement(g,C,x,r),E=y}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}je(LineController,"id","line"),je(LineController,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),je(LineController,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class PolarAreaController extends DatasetController{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=formatNumber(t._parsed[e].r,i.options.locale);return{label:r[e]||"",value:s}}parseObjectData(e,t,i,r){return _parseObjectDataRadialScale.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<t.min&&(t.min=s),s>t.max&&(t.max=s))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(r/2,0),o=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,i,r){const s=r==="reset",o=this.chart,h=o.options.animation,d=this._cachedMeta.rScale,u=d.xCenter,m=d.yCenter,v=d.getIndexAngle(0)-.5*PI;let _=v,D;const f=360/this.countVisibleElements();for(D=0;D<t;++D)_+=this._computeAngle(D,r,f);for(D=t;D<t+i;D++){const l=e[D];let c=_,p=_+this._computeAngle(D,r,f),b=o.getDataVisibility(D)?d.getDistanceFromCenterForValue(this.getParsed(D).r):0;_=p,s&&(h.animateScale&&(b=0),h.animateRotate&&(c=p=v));const E={x:u,y:m,innerRadius:0,outerRadius:b,startAngle:c,endAngle:p,options:this.resolveDataElementOptions(D,l.active?"active":r)};this.updateElement(l,D,E,r)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&t++}),t}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?toRadians(this.resolveDataElementOptions(e,t).angle||i):0}}je(PolarAreaController,"id","polarArea"),je(PolarAreaController,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),je(PolarAreaController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return t.labels.map((s,o)=>{const h=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:r,lineWidth:h.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class PieController extends DoughnutController{}je(PieController,"id","pie"),je(PieController,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class RadarController extends DatasetController{getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,r){return _parseObjectDataRadialScale.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta,i=t.dataset,r=t.data||[],s=t.iScale.getLabels();if(i.points=r,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===r.length,options:o};this.updateElement(i,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,i,r){const s=this._cachedMeta.rScale,o=r==="reset";for(let a=t;a<t+i;a++){const h=e[a],d=this.resolveDataElementOptions(a,h.active?"active":r),u=s.getPointPositionForValue(a,this.getParsed(a).r),m=o?s.xCenter:u.x,v=o?s.yCenter:u.y,_={x:m,y:v,angle:u.angle,skip:isNaN(m)||isNaN(v),options:d};this.updateElement(h,a,_,r)}}}je(RadarController,"id","radar"),je(RadarController,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),je(RadarController,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class ScatterController extends DatasetController{getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=t,o=this.getParsed(e),a=r.getLabelForValue(o.x),h=s.getLabelForValue(o.y);return{label:i[e]||"",value:"("+a+", "+h+")"}}update(e){const t=this._cachedMeta,{data:i=[]}=t,r=this.chart._animationsDisabled;let{start:s,count:o}=_getStartAndCountOfVisiblePoints(t,i,r);if(this._drawStart=s,this._drawCount=o,_scaleRangesChanged(t)&&(s=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:h}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!h._decimated,a.points=i;const d=this.resolveDatasetElementOptions(e);d.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:d},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(i,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:h,_dataset:d}=this._cachedMeta,u=this.resolveDataElementOptions(t,r),m=this.getSharedOptions(u),v=this.includeOptions(r,m),_=o.axis,D=a.axis,{spanGaps:f,segment:l}=this.options,c=isNumber(f)?f:Number.POSITIVE_INFINITY,p=this.chart._animationsDisabled||s||r==="none";let b=t>0&&this.getParsed(t-1);for(let E=t;E<t+i;++E){const C=e[E],g=this.getParsed(E),x=p?C:{},y=isNullOrUndef(g[D]),w=x[_]=o.getPixelForValue(g[_],E),M=x[D]=s||y?a.getBasePixel():a.getPixelForValue(h?this.applyStack(a,g,h):g[D],E);x.skip=isNaN(w)||isNaN(M)||y,x.stop=E>0&&Math.abs(g[_]-b[_])>c,l&&(x.parsed=g,x.raw=d.data[E]),v&&(x.options=m||this.resolveDataElementOptions(E,C.active?"active":r)),p||this.updateElement(C,E,x,r),b=g}this.updateSharedOptions(m,r,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let a=0;for(let h=t.length-1;h>=0;--h)a=Math.max(a,t[h].size(this.resolveDataElementOptions(h))/2);return a>0&&a}const i=e.dataset,r=i.options&&i.options.borderWidth||0;if(!t.length)return r;const s=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,s,o)/2}}je(ScatterController,"id","scatter"),je(ScatterController,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),je(ScatterController,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var controllers=Object.freeze({__proto__:null,BarController,BubbleController,DoughnutController,LineController,PieController,PolarAreaController,RadarController,ScatterController});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(e){je(this,"options");this.options=e||{}}static override(e){Object.assign(DateAdapterBase.prototype,e)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(n,e,t,i){const{controller:r,data:s,_sorted:o}=n,a=r._cachedMeta.iScale,h=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const d=a._reversePixels?_rlookupByKey:_lookupByKey;if(i){if(r._sharedOptions){const u=s[0],m=typeof u.getRange=="function"&&u.getRange(e);if(m){const v=d(s,e,t-m),_=d(s,e,t+m);return{lo:v.lo,hi:_.hi}}}}else{const u=d(s,e,t);if(h){const{vScale:m}=r._cachedMeta,{_parsed:v}=n,_=v.slice(0,u.lo+1).reverse().findIndex(f=>!isNullOrUndef(f[m.axis]));u.lo-=Math.max(0,_);const D=v.slice(u.hi).findIndex(f=>!isNullOrUndef(f[m.axis]));u.hi+=Math.max(0,D)}return u}}return{lo:0,hi:s.length-1}}function evaluateInteractionItems(n,e,t,i,r){const s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,h=s.length;a<h;++a){const{index:d,data:u}=s[a],{lo:m,hi:v}=binarySearch(s[a],e,o,r);for(let _=m;_<=v;++_){const D=u[_];D.skip||i(D,d,_)}}}function getDistanceMetricForAxis(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){const s=e?Math.abs(i.x-r.x):0,o=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function getIntersectItems(n,e,t,i,r){const s=[];return!r&&!n.isPointInArea(e)||evaluateInteractionItems(n,t,e,function(a,h,d){!r&&!_isPointInArea(a,n.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:h,index:d})},!0),s}function getNearestRadialItems(n,e,t,i){let r=[];function s(o,a,h){const{startAngle:d,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:m}=getAngleFromPoint(o,{x:e.x,y:e.y});_angleBetween(m,d,u)&&r.push({element:o,datasetIndex:a,index:h})}return evaluateInteractionItems(n,t,e,s),r}function getNearestCartesianItems(n,e,t,i,r,s){let o=[];const a=getDistanceMetricForAxis(t);let h=Number.POSITIVE_INFINITY;function d(u,m,v){const _=u.inRange(e.x,e.y,r);if(i&&!_)return;const D=u.getCenterPoint(r);if(!(!!s||n.isPointInArea(D))&&!_)return;const l=a(e,D);l<h?(o=[{element:u,datasetIndex:m,index:v}],h=l):l===h&&o.push({element:u,datasetIndex:m,index:v})}return evaluateInteractionItems(n,t,e,d),o}function getNearestItems(n,e,t,i,r,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!i?getNearestRadialItems(n,e,t,r):getNearestCartesianItems(n,e,t,i,r,s)}function getAxisItems(n,e,t,i,r){const s=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return evaluateInteractionItems(n,t,e,(h,d,u)=>{h[o]&&h[o](e[t],r)&&(s.push({element:h,datasetIndex:d,index:u}),a=a||h.inRange(e.x,e.y,r))}),i&&!a?[]:s}var Interaction={modes:{index(n,e,t,i){const r=getRelativePosition(e,n),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?getIntersectItems(n,r,s,i,o):getNearestItems(n,r,s,!1,i,o),h=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const u=a[0].index,m=d.data[u];m&&!m.skip&&h.push({element:m,datasetIndex:d.index,index:u})}),h):[]},dataset(n,e,t,i){const r=getRelativePosition(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?getIntersectItems(n,r,s,i,o):getNearestItems(n,r,s,!1,i,o);if(a.length>0){const h=a[0].datasetIndex,d=n.getDatasetMeta(h).data;a=[];for(let u=0;u<d.length;++u)a.push({element:d[u],datasetIndex:h,index:u})}return a},point(n,e,t,i){const r=getRelativePosition(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return getIntersectItems(n,r,s,i,o)},nearest(n,e,t,i){const r=getRelativePosition(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return getNearestItems(n,r,s,t.intersect,i,o)},x(n,e,t,i){const r=getRelativePosition(e,n);return getAxisItems(n,r,"x",t.intersect,i)},y(n,e,t,i){const r=getRelativePosition(e,n);return getAxisItems(n,r,"y",t.intersect,i)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(n,e){return n.filter(t=>t.pos===e)}function filterDynamicPositionByAxis(n,e){return n.filter(t=>STATIC_POSITIONS.indexOf(t.pos)===-1&&t.box.axis===e)}function sortByWeight(n,e){return n.sort((t,i)=>{const r=e?i:t,s=e?t:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function wrapBoxes(n){const e=[];let t,i,r,s,o,a;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:t,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function buildStacks(n){const e={};for(const t of n){const{stack:i,pos:r,stackWeight:s}=t;if(!i||!STATIC_POSITIONS.includes(r))continue;const o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function setLayoutDims(n,e){const t=buildStacks(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];const{fullSize:h}=a.box,d=t[a.stack],u=d&&a.stackWeight/d.weight;a.horizontal?(a.width=u?u*i:h&&e.availableWidth,a.height=r):(a.width=i,a.height=u?u*r:h&&e.availableHeight)}return t}function buildLayoutBoxes(n){const e=wrapBoxes(n),t=sortByWeight(e.filter(d=>d.box.fullSize),!0),i=sortByWeight(filterByPosition(e,"left"),!0),r=sortByWeight(filterByPosition(e,"right")),s=sortByWeight(filterByPosition(e,"top"),!0),o=sortByWeight(filterByPosition(e,"bottom")),a=filterDynamicPositionByAxis(e,"x"),h=filterDynamicPositionByAxis(e,"y");return{fullSize:t,leftAndTop:i.concat(s),rightAndBottom:r.concat(h).concat(o).concat(a),chartArea:filterByPosition(e,"chartArea"),vertical:i.concat(r).concat(h),horizontal:s.concat(o).concat(a)}}function getCombinedMax(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function updateMaxPadding(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function updateDims(n,e,t,i){const{pos:r,box:s}=t,o=n.maxPadding;if(!isObject(r)){t.size&&(n[r]-=t.size);const m=i[t.stack]||{size:0,count:1};m.size=Math.max(m.size,t.horizontal?s.height:s.width),t.size=m.size/m.count,n[r]+=t.size}s.getPadding&&updateMaxPadding(o,s.getPadding());const a=Math.max(0,e.outerWidth-getCombinedMax(o,n,"left","right")),h=Math.max(0,e.outerHeight-getCombinedMax(o,n,"top","bottom")),d=a!==n.w,u=h!==n.h;return n.w=a,n.h=h,t.horizontal?{same:d,other:u}:{same:u,other:d}}function handleMaxPadding(n){const e=n.maxPadding;function t(i){const r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function getMargins(n,e){const t=e.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return i(n?["left","right"]:["top","bottom"])}function fitBoxes(n,e,t,i){const r=[];let s,o,a,h,d,u;for(s=0,o=n.length,d=0;s<o;++s){a=n[s],h=a.box,h.update(a.width||e.w,a.height||e.h,getMargins(a.horizontal,e));const{same:m,other:v}=updateDims(e,t,a,i);d|=m&&r.length,u=u||v,h.fullSize||r.push(a)}return d&&fitBoxes(r,e,t,i)||u}function setBoxDims(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function placeBoxes(n,e,t,i){const r=t.padding;let{x:s,y:o}=e;for(const a of n){const h=a.box,d=i[a.stack]||{placed:0,weight:1},u=a.stackWeight/d.weight||1;if(a.horizontal){const m=e.w*u,v=d.size||h.height;defined(d.start)&&(o=d.start),h.fullSize?setBoxDims(h,r.left,o,t.outerWidth-r.right-r.left,v):setBoxDims(h,e.left+d.placed,o,m,v),d.start=o,d.placed+=m,o=h.bottom}else{const m=e.h*u,v=d.size||h.width;defined(d.start)&&(s=d.start),h.fullSize?setBoxDims(h,s,r.top,v,t.outerHeight-r.bottom-r.top):setBoxDims(h,s,e.top+d.placed,v,m),d.start=s,d.placed+=m,s=h.right}}e.x=s,e.y=o}var layouts={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const r=toPadding(n.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(t-r.height,0),a=buildLayoutBoxes(n.boxes),h=a.vertical,d=a.horizontal;each(n.boxes,f=>{typeof f.beforeLayout=="function"&&f.beforeLayout()});const u=h.reduce((f,l)=>l.box.options&&l.box.options.display===!1?f:f+1,0)||1,m=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),v=Object.assign({},r);updateMaxPadding(v,toPadding(i));const _=Object.assign({maxPadding:v,w:s,h:o,x:r.left,y:r.top},r),D=setLayoutDims(h.concat(d),m);fitBoxes(a.fullSize,_,m,D),fitBoxes(h,_,m,D),fitBoxes(d,_,m,D)&&fitBoxes(h,_,m,D),handleMaxPadding(_),placeBoxes(a.leftAndTop,_,m,D),_.x+=_.w,_.y+=_.h,placeBoxes(a.rightAndBottom,_,m,D),n.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},each(a.chartArea,f=>{const l=f.box;Object.assign(l,n.chartArea),l.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}}class BasicPlatform extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=n=>n===null||n==="";function initCanvas(n,e){const t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[EXPANDO_KEY]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",isNullOrEmpty(r)){const s=readUsedSize(n,"width");s!==void 0&&(n.width=s)}if(isNullOrEmpty(i))if(n.style.height==="")n.height=n.width/(e||2);else{const s=readUsedSize(n,"height");s!==void 0&&(n.height=s)}return n}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(n,e,t){n&&n.addEventListener(e,t,eventListenerOptions)}function removeListener(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,eventListenerOptions)}function fromNativeEvent(n,e){const t=EVENT_TYPES[n.type]||n.type,{x:i,y:r}=getRelativePosition(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function nodeListContains(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function createAttachObserver(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||nodeListContains(a.addedNodes,i),o=o&&!nodeListContains(a.removedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function createDetachObserver(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||nodeListContains(a.removedNodes,i),o=o&&!nodeListContains(a.addedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const n=window.devicePixelRatio;n!==oldDevicePixelRatio&&(oldDevicePixelRatio=n,drpListeningCharts.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function listenDevicePixelRatioChanges(n,e){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(n,e)}function unlistenDevicePixelRatioChanges(n){drpListeningCharts.delete(n),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(n,e,t){const i=n.canvas,r=i&&_getParentNode(i);if(!r)return;const s=throttled((a,h)=>{const d=r.clientWidth;t(a,h),d<r.clientWidth&&t()},window),o=new ResizeObserver(a=>{const h=a[0],d=h.contentRect.width,u=h.contentRect.height;d===0&&u===0||s(d,u)});return o.observe(r),listenDevicePixelRatioChanges(n,s),o}function releaseObserver(n,e,t){t&&t.disconnect(),e==="resize"&&unlistenDevicePixelRatioChanges(n)}function createProxyAndListen(n,e,t){const i=n.canvas,r=throttled(s=>{n.ctx!==null&&t(fromNativeEvent(s,n))},n);return addListener(i,e,r),r}class DomPlatform extends BasePlatform{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(initCanvas(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[EXPANDO_KEY])return!1;const i=t[EXPANDO_KEY].initial;["height","width"].forEach(s=>{const o=i[s];isNullOrUndef(o)?t.removeAttribute(s):t.setAttribute(s,o)});const r=i.style||{};return Object.keys(r).forEach(s=>{t.style[s]=r[s]}),t.width=t.width,delete t[EXPANDO_KEY],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),o={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[t]||createProxyAndListen;r[t]=o(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[t]||removeListener)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return getMaximumSize(e,t,i,r)}isAttached(e){const t=e&&_getParentNode(e);return!!(t&&t.isConnected)}}function _detectPlatform(n){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){je(this,"x");je(this,"y");je(this,"active",!1);je(this,"options");je(this,"$animations")}tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}je(Element,"defaults",{}),je(Element,"defaultRoutes");function autoSkip(n,e){const t=n.options.ticks,i=determineMaxTicks(n),r=Math.min(t.maxTicksLimit||i,i),s=t.major.enabled?getMajorIndices(e):[],o=s.length,a=s[0],h=s[o-1],d=[];if(o>r)return skipMajors(e,d,s,o/r),d;const u=calculateSpacing(s,e,r);if(o>0){let m,v;const _=o>1?Math.round((h-a)/(o-1)):null;for(skip(e,d,u,isNullOrUndef(_)?0:a-_,a),m=0,v=o-1;m<v;m++)skip(e,d,u,s[m],s[m+1]);return skip(e,d,u,h,isNullOrUndef(_)?e.length:h+_),d}return skip(e,d,u),d}function determineMaxTicks(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function calculateSpacing(n,e,t){const i=getEvenSpacing(n),r=e.length/t;if(!i)return Math.max(r,1);const s=_factorize(i);for(let o=0,a=s.length-1;o<a;o++){const h=s[o];if(h>r)return h}return Math.max(r,1)}function getMajorIndices(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function skipMajors(n,e,t,i){let r=0,s=t[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===s&&(e.push(n[o]),r++,s=t[r*i])}function skip(n,e,t,i,r){const s=valueOrDefault(i,0),o=Math.min(valueOrDefault(r,n.length),n.length);let a=0,h,d,u;for(t=Math.ceil(t),r&&(h=r-i,t=h/Math.floor(h/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(d=Math.max(s,0);d<o;d++)d===u&&(e.push(n[d]),a++,u=Math.round(s+a*t))}function getEvenSpacing(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const reverseAlign=n=>n==="left"?"right":n==="right"?"left":n,offsetFromEdge=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,getTicksLimit=(n,e)=>Math.min(e||n,n);function sample(n,e){const t=[],i=n.length/e,r=n.length;let s=0;for(;s<r;s+=i)t.push(n[Math.floor(s)]);return t}function getPixelForGridLine(n,e,t){const i=n.ticks.length,r=Math.min(e,i-1),s=n._startPixel,o=n._endPixel,a=1e-6;let h=n.getPixelForTick(r),d;if(!(t&&(i===1?d=Math.max(h-s,o-h):e===0?d=(n.getPixelForTick(1)-h)/2:d=(h-n.getPixelForTick(r-1))/2,h+=r<e?d:-d,h<s-a||h>o+a)))return h}function garbageCollect(n,e){each(n,t=>{const i=t.gc,r=i.length/2;let s;if(r>e){for(s=0;s<r;++s)delete t.data[i[s]];i.splice(0,r)}})}function getTickMarkLength(n){return n.drawTicks?n.tickLength:0}function getTitleHeight(n,e){if(!n.display)return 0;const t=toFont(n.font,e),i=toPadding(n.padding);return(isArray(n.text)?n.text.length:1)*t.lineHeight+i.height}function createScaleContext(n,e){return createContext(n,{scale:e,type:"scale"})}function createTickContext(n,e,t){return createContext(n,{tick:t,index:e,type:"tick"})}function titleAlign(n,e,t){let i=_toLeftRightCenter(n);return(t&&e!=="right"||!t&&e==="right")&&(i=reverseAlign(i)),i}function titleArgs(n,e,t,i){const{top:r,left:s,bottom:o,right:a,chart:h}=n,{chartArea:d,scales:u}=h;let m=0,v,_,D;const f=o-r,l=a-s;if(n.isHorizontal()){if(_=_alignStartEnd(i,s,a),isObject(t)){const c=Object.keys(t)[0],p=t[c];D=u[c].getPixelForValue(p)+f-e}else t==="center"?D=(d.bottom+d.top)/2+f-e:D=offsetFromEdge(n,t,e);v=a-s}else{if(isObject(t)){const c=Object.keys(t)[0],p=t[c];_=u[c].getPixelForValue(p)-l+e}else t==="center"?_=(d.left+d.right)/2-l+e:_=offsetFromEdge(n,t,e);D=_alignStartEnd(i,o,r),m=t==="left"?-HALF_PI:HALF_PI}return{titleX:_,titleY:D,maxWidth:v,rotation:m}}class Scale extends Element{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=finiteOrDefault(e,Number.POSITIVE_INFINITY),t=finiteOrDefault(t,Number.NEGATIVE_INFINITY),i=finiteOrDefault(i,Number.POSITIVE_INFINITY),r=finiteOrDefault(r,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(e,i),max:finiteOrDefault(t,r),minDefined:isNumberFinite(e),maxDefined:isNumberFinite(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:t,max:i};const a=this.getMatchingVisibleMetas();for(let h=0,d=a.length;h<d;++h)o=a[h].controller.getMinMax(this,e),r||(t=Math.min(t,o.min)),s||(i=Math.max(i,o.max));return t=s&&t>i?i:t,i=r&&t>i?t:i,{min:finiteOrDefault(t,finiteOrDefault(i,t)),max:finiteOrDefault(i,finiteOrDefault(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=a<this.ticks.length;this._convertTicksToLabels(h?sample(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),callback(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=callback(t.callback,[s.value,i,e],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=getTicksLimit(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,s=t.maxRotation;let o=r,a,h,d;if(!this._isVisible()||!t.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),m=u.widest.width,v=u.highest.height,_=_limitValue(this.chart.width-m,0,this.maxWidth);a=e.offset?this.maxWidth/i:_/(i-1),m+6>a&&(a=_/(i-(e.offset?.5:1)),h=this.maxHeight-getTickMarkLength(e.grid)-t.padding-getTitleHeight(e.title,this.chart.options.font),d=Math.sqrt(m*m+v*v),o=toDegrees(Math.min(Math.asin(_limitValue((u.highest.height+6)/a,-1,1)),Math.asin(_limitValue(h/d,-1,1))-Math.asin(_limitValue(v/d,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const h=getTitleHeight(r,t.options.font);if(a?(e.width=this.maxWidth,e.height=getTickMarkLength(s)+h):(e.height=this.maxHeight,e.width=getTickMarkLength(s)+h),i.display&&this.ticks.length){const{first:d,last:u,widest:m,highest:v}=this._getLabelSizes(),_=i.padding*2,D=toRadians(this.labelRotation),f=Math.cos(D),l=Math.sin(D);if(a){const c=i.mirror?0:l*m.width+f*v.height;e.height=Math.min(this.maxHeight,e.height+c+_)}else{const c=i.mirror?0:f*m.width+l*v.height;e.width=Math.min(this.maxWidth,e.width+c+_)}this._calculatePadding(d,u,l,f)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){const{ticks:{align:s,padding:o},position:a}=this.options,h=this.labelRotation!==0,d=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let v=0,_=0;h?d?(v=r*e.width,_=i*t.height):(v=i*e.height,_=r*t.width):s==="start"?_=t.width:s==="end"?v=e.width:s!=="inner"&&(v=e.width/2,_=t.width/2),this.paddingLeft=Math.max((v-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((_-m+o)*this.width/(this.width-m),0)}else{let u=t.height/2,m=e.height/2;s==="start"?(u=0,m=e.height):s==="end"&&(u=t.height,m=0),this.paddingTop=u+o,this.paddingBottom=m+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)isNullOrUndef(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=sample(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],h=Math.floor(t/getTicksLimit(t,i));let d=0,u=0,m,v,_,D,f,l,c,p,b,E,C;for(m=0;m<t;m+=h){if(D=e[m].label,f=this._resolveTickFontOptions(m),r.font=l=f.string,c=s[l]=s[l]||{data:{},gc:[]},p=f.lineHeight,b=E=0,!isNullOrUndef(D)&&!isArray(D))b=_measureText(r,c.data,c.gc,b,D),E=p;else if(isArray(D))for(v=0,_=D.length;v<_;++v)C=D[v],!isNullOrUndef(C)&&!isArray(C)&&(b=_measureText(r,c.data,c.gc,b,C),E+=p);o.push(b),a.push(E),d=Math.max(b,d),u=Math.max(E,u)}garbageCollect(s,t);const g=o.indexOf(d),x=a.indexOf(u),y=w=>({width:o[w]||0,height:a[w]||0});return{first:y(0),last:y(t-1),widest:y(g),highest:y(x),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=createTickContext(this.getContext(),e,i))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=toRadians(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,h=s?s.highest.height+o:0;return this.isHorizontal()?h*i>a*r?a/i:h/r:h*r<a*i?h/i:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,h=s.offset,d=this.isHorizontal(),m=this.ticks.length+(h?1:0),v=getTickMarkLength(s),_=[],D=a.setContext(this.getContext()),f=D.display?D.width:0,l=f/2,c=function(k){return _alignPixel(i,k,f)};let p,b,E,C,g,x,y,w,M,S,O,P;if(o==="top")p=c(this.bottom),x=this.bottom-v,w=p-l,S=c(e.top)+l,P=e.bottom;else if(o==="bottom")p=c(this.top),S=e.top,P=c(e.bottom)-l,x=p+l,w=this.top+v;else if(o==="left")p=c(this.right),g=this.right-v,y=p-l,M=c(e.left)+l,O=e.right;else if(o==="right")p=c(this.left),M=e.left,O=c(e.right)-l,g=p+l,y=this.left+v;else if(t==="x"){if(o==="center")p=c((e.top+e.bottom)/2+.5);else if(isObject(o)){const k=Object.keys(o)[0],B=o[k];p=c(this.chart.scales[k].getPixelForValue(B))}S=e.top,P=e.bottom,x=p+l,w=x+v}else if(t==="y"){if(o==="center")p=c((e.left+e.right)/2);else if(isObject(o)){const k=Object.keys(o)[0],B=o[k];p=c(this.chart.scales[k].getPixelForValue(B))}g=p-l,y=g-v,M=e.left,O=e.right}const I=valueOrDefault(r.ticks.maxTicksLimit,m),F=Math.max(1,Math.ceil(m/I));for(b=0;b<m;b+=F){const k=this.getContext(b),B=s.setContext(k),U=a.setContext(k),W=B.lineWidth,R=B.color,z=U.dash||[],G=U.dashOffset,q=B.tickWidth,Q=B.tickColor,ne=B.tickBorderDash||[],te=B.tickBorderDashOffset;E=getPixelForGridLine(this,b,h),E!==void 0&&(C=_alignPixel(i,E,W),d?g=y=M=O=C:x=w=S=P=C,_.push({tx1:g,ty1:x,tx2:y,ty2:w,x1:M,y1:S,x2:O,y2:P,width:W,color:R,borderDash:z,borderDashOffset:G,tickWidth:q,tickColor:Q,tickBorderDash:ne,tickBorderDashOffset:te}))}return this._ticksLength=m,this._borderValue=p,_}_computeLabelItems(e){const t=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:h,crossAlign:d,padding:u,mirror:m}=s,v=getTickMarkLength(i.grid),_=v+u,D=m?-u:_,f=-toRadians(this.labelRotation),l=[];let c,p,b,E,C,g,x,y,w,M,S,O,P="middle";if(r==="top")g=this.bottom-D,x=this._getXAxisLabelAlignment();else if(r==="bottom")g=this.top+D,x=this._getXAxisLabelAlignment();else if(r==="left"){const F=this._getYAxisLabelAlignment(v);x=F.textAlign,C=F.x}else if(r==="right"){const F=this._getYAxisLabelAlignment(v);x=F.textAlign,C=F.x}else if(t==="x"){if(r==="center")g=(e.top+e.bottom)/2+_;else if(isObject(r)){const F=Object.keys(r)[0],k=r[F];g=this.chart.scales[F].getPixelForValue(k)+_}x=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")C=(e.left+e.right)/2-_;else if(isObject(r)){const F=Object.keys(r)[0],k=r[F];C=this.chart.scales[F].getPixelForValue(k)}x=this._getYAxisLabelAlignment(v).textAlign}t==="y"&&(h==="start"?P="top":h==="end"&&(P="bottom"));const I=this._getLabelSizes();for(c=0,p=a.length;c<p;++c){b=a[c],E=b.label;const F=s.setContext(this.getContext(c));y=this.getPixelForTick(c)+s.labelOffset,w=this._resolveTickFontOptions(c),M=w.lineHeight,S=isArray(E)?E.length:1;const k=S/2,B=F.color,U=F.textStrokeColor,W=F.textStrokeWidth;let R=x;o?(C=y,x==="inner"&&(c===p-1?R=this.options.reverse?"left":"right":c===0?R=this.options.reverse?"right":"left":R="center"),r==="top"?d==="near"||f!==0?O=-S*M+M/2:d==="center"?O=-I.highest.height/2-k*M+M:O=-I.highest.height+M/2:d==="near"||f!==0?O=M/2:d==="center"?O=I.highest.height/2-k*M:O=I.highest.height-S*M,m&&(O*=-1),f!==0&&!F.showLabelBackdrop&&(C+=M/2*Math.sin(f))):(g=y,O=(1-S)*M/2);let z;if(F.showLabelBackdrop){const G=toPadding(F.backdropPadding),q=I.heights[c],Q=I.widths[c];let ne=O-G.top,te=0-G.left;switch(P){case"middle":ne-=q/2;break;case"bottom":ne-=q;break}switch(x){case"center":te-=Q/2;break;case"right":te-=Q;break;case"inner":c===p-1?te-=Q:c>0&&(te-=Q/2);break}z={left:te,top:ne,width:Q+G.width,height:q+G.height,color:F.backdropColor}}l.push({label:E,font:w,textOffset:O,options:{rotation:f,color:B,strokeColor:U,strokeWidth:W,textAlign:R,textBaseline:P,translation:[C,g],backdrop:z}})}return l}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-toRadians(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,h=o.widest.width;let d,u;return t==="left"?r?(u=this.right+s,i==="near"?d="left":i==="center"?(d="center",u+=h/2):(d="right",u+=h)):(u=this.right-a,i==="near"?d="right":i==="center"?(d="center",u-=h/2):(d="left",u=this.left)):t==="right"?r?(u=this.left+s,i==="near"?d="right":i==="center"?(d="center",u-=h/2):(d="left",u-=h)):(u=this.left+a,i==="near"?d="left":i==="center"?(d="center",u+=h/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:r,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(h,d,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(h.x,h.y),i.lineTo(d.x,d.y),i.stroke(),i.restore())};if(t.display)for(s=0,o=r.length;s<o;++s){const h=r[s];t.drawOnChartArea&&a({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),t.drawTicks&&a({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let d,u,m,v;this.isHorizontal()?(d=_alignPixel(e,this.left,o)-o/2,u=_alignPixel(e,this.right,a)+a/2,m=v=h):(m=_alignPixel(e,this.top,o)-o/2,v=_alignPixel(e,this.bottom,a)+a/2,d=u=h),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(d,m),t.lineTo(u,v),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&clipArea(i,r);const s=this.getLabelItems(e);for(const o of s){const a=o.options,h=o.font,d=o.label,u=o.textOffset;renderText(i,d,0,u,h,a)}r&&unclipArea(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;const s=toFont(i.font),o=toPadding(i.padding),a=i.align;let h=s.lineHeight/2;t==="bottom"||t==="center"||isObject(t)?(h+=o.bottom,isArray(i.text)&&(h+=s.lineHeight*(i.text.length-1))):h+=o.top;const{titleX:d,titleY:u,maxWidth:m,rotation:v}=titleArgs(this,h,t,a);renderText(e,i.text,0,0,s,{color:i.color,maxWidth:m,rotation:v,textAlign:titleAlign(a,t,r),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=valueOrDefault(e.grid&&e.grid.z,-1),r=valueOrDefault(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,o;for(s=0,o=t.length;s<o;++s){const a=t[s];a[i]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return toFont(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class TypedRegistry{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;isIChartComponent(t)&&(i=this.register(t));const r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,registerDefaults(e,o,i),this.override&&defaults.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in defaults[r]&&(delete defaults[r][i],this.override&&delete overrides[i])}}function registerDefaults(n,e,t){const i=merge(Object.create(null),[t?defaults.get(t):{},defaults.get(e),n.defaults]);defaults.set(e,i),n.defaultRoutes&&routeDefaults(e,n.defaultRoutes),n.descriptors&&defaults.describe(e,n.descriptors)}function routeDefaults(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),r=i.pop(),s=[n].concat(i).join("."),o=e[t].split("."),a=o.pop(),h=o.join(".");defaults.route(s,r,h,a)})}function isIChartComponent(n){return"id"in n&&"defaults"in n}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):each(r,o=>{const a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,i){const r=_capitalize(e);callback(i["before"+r],[],i),t[e](i),callback(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(e,t,i,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,t,i);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,i,r){r=r||{};for(const s of e){const o=s.plugin,a=o[i],h=[t,r,s.options];if(callback(a,h,o)===!1&&r.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=valueOrDefault(i.options&&i.options.plugins,{}),s=allPlugins(i);return r===!1&&!t?[]:createDescriptors(e,s,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(h=>a.plugin.id===h.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}}function allPlugins(n){const e={},t=[],i=Object.keys(registry.plugins.items);for(let s=0;s<i.length;s++)t.push(registry.getPlugin(i[s]));const r=n.plugins||[];for(let s=0;s<r.length;s++){const o=r[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function getOpts(n,e){return!e&&n===!1?null:n===!0?{}:n}function createDescriptors(n,{plugins:e,localIds:t},i,r){const s=[],o=n.getContext();for(const a of e){const h=a.id,d=getOpts(i[h],r);d!==null&&s.push({plugin:a,options:pluginOpts(n.config,{plugin:a,local:t[h]},d,o)})}return s}function pluginOpts(n,{plugin:e,local:t},i,r){const s=n.pluginScopeKeys(e),o=n.getOptionScopes(i,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(n,e){const t=defaults.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function getAxisFromDefaultScaleID(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function getDefaultScaleIDFromAxis(n,e){return n===e?"_index_":"_value_"}function idMatchesAxis(n){if(n==="x"||n==="y"||n==="r")return n}function axisFromPosition(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function determineAxis(n,...e){if(idMatchesAxis(n))return n;for(const t of e){const i=t.axis||axisFromPosition(t.position)||n.length>1&&idMatchesAxis(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function retrieveAxisFromDatasets(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return getAxisFromDataset(n,"x",t[0])||getAxisFromDataset(n,"y",t[0])}return{}}function mergeScaleConfig(n,e){const t=overrides[n.type]||{scales:{}},i=e.scales||{},r=getIndexAxis(n.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!isObject(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const h=determineAxis(o,a,retrieveAxisFromDatasets(o,n),defaults.scales[a.type]),d=getDefaultScaleIDFromAxis(h,r),u=t.scales||{};s[o]=mergeIf(Object.create(null),[{axis:h},a,u[h],u[d]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,h=o.indexAxis||getIndexAxis(a,e),u=(overrides[a]||{}).scales||{};Object.keys(u).forEach(m=>{const v=getAxisFromDefaultScaleID(m,h),_=o[v+"AxisID"]||v;s[_]=s[_]||Object.create(null),mergeIf(s[_],[{axis:v},i[_],u[m]])})}),Object.keys(s).forEach(o=>{const a=s[o];mergeIf(a,[defaults.scales[a.type],defaults.scale])}),s}function initOptions(n){const e=n.options||(n.options={});e.plugins=valueOrDefault(e.plugins,{}),e.scales=mergeScaleConfig(n,e)}function initData(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function initConfig(n){return n=n||{},n.data=initData(n.data),initOptions(n),n}const keyCache=new Map,keysCached=new Set;function cachedKeys(n,e){let t=keyCache.get(n);return t||(t=e(),keyCache.set(n,t),keysCached.add(t)),t}const addIfFound=(n,e,t)=>{const i=resolveObjectKey(e,t);i!==void 0&&n.add(i)};class Config{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return cachedKeys(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return cachedKeys(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return cachedKeys(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:s}=this,o=this._cachedScopes(e,i),a=o.get(t);if(a)return a;const h=new Set;t.forEach(u=>{e&&(h.add(e),u.forEach(m=>addIfFound(h,e,m))),u.forEach(m=>addIfFound(h,r,m)),u.forEach(m=>addIfFound(h,overrides[s]||{},m)),u.forEach(m=>addIfFound(h,defaults,m)),u.forEach(m=>addIfFound(h,descriptors,m))});const d=Array.from(h);return d.length===0&&d.push(Object.create(null)),keysCached.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,overrides[t]||{},defaults.datasets[t]||{},{type:t},defaults,descriptors]}resolveNamedOptions(e,t,i,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=getResolver(this._resolverCache,e,r);let h=o;if(needContext(o,t)){s.$shared=!1,i=isFunction(i)?i():i;const d=this.createResolver(e,i,a);h=_attachContext(o,i,d)}for(const d of t)s[d]=h[d];return s}createResolver(e,t,i=[""],r){const{resolver:s}=getResolver(this._resolverCache,e,i);return isObject(t)?_attachContext(s,t,void 0,r):s}}function getResolver(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const r=t.join();let s=i.get(r);return s||(s={resolver:_createResolver(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}const hasFunction=n=>isObject(n)&&Object.getOwnPropertyNames(n).some(e=>isFunction(n[e]));function needContext(n,e){const{isScriptable:t,isIndexable:i}=_descriptors(n);for(const r of e){const s=t(r),o=i(r),a=(o||s)&&n[r];if(s&&(isFunction(a)||hasFunction(a))||o&&isArray(a))return!0}return!1}var version="4.4.9";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(n,e){return n==="top"||n==="bottom"||KNOWN_POSITIONS.indexOf(n)===-1&&e==="x"}function compare2Level(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function onAnimationsComplete(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),callback(t&&t.onComplete,[n],e)}function onAnimationProgress(n){const e=n.chart,t=e.options.animation;callback(t&&t.onProgress,[n],e)}function getCanvas(n){return _isDomSupported()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const instances={},getChart=n=>{const e=getCanvas(n);return Object.values(instances).filter(t=>t.canvas===e).pop()};function moveNumericKeys(n,e,t){const i=Object.keys(n);for(const r of i){const s=+r;if(s>=e){const o=n[r];delete n[r],(t>0||s>e)&&(n[s+t]=o)}}}function determineLastEvent(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}class Chart{static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,t){const i=this.config=new Config(t),r=getCanvas(e),s=getChart(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||_detectPlatform(r)),this.platform.updateConfig(i);const a=this.platform.acquireContext(r,o.aspectRatio),h=a&&a.canvas,d=h&&h.height,u=h&&h.width;if(this.id=uid(),this.ctx=a,this.canvas=h,this.width=u,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(m=>this.update(m),o.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!a||!h){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:s}=this;return isNullOrUndef(e)?t&&s?s:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,t){animator.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),h=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,retinaScale(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),callback(i.onResize,[this,o],this),this.attached&&this._doResize(h)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};each(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const a=t[o],h=determineAxis(o,a),d=h==="r",u=h==="x";return{options:a,dposition:d?"chartArea":u?"bottom":"left",dtype:d?"radialLinear":u?"category":"linear"}}))),each(s,o=>{const a=o.options,h=a.id,d=determineAxis(h,a),u=valueOrDefault(a.type,o.dtype);(a.position===void 0||positionIsHorizontal(a.position,d)!==positionIsHorizontal(o.dposition))&&(a.position=o.dposition),r[h]=!0;let m=null;if(h in i&&i[h].type===u)m=i[h];else{const v=registry.getScale(u);m=new v({id:h,type:u,ctx:this.ctx,chart:this}),i[m.id]=m}m.init(a,e)}),each(r,(o,a)=>{o||delete i[a]}),each(i,o=>{layouts.configure(this,o,o.options),layouts.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,s)=>r.index-s.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const s=t[i];let o=this.getDatasetMeta(i);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=s.indexAxis||getIndexAxis(a,this.options),o.order=s.order||0,o.index=i,o.label=""+s.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const h=registry.getController(a),{datasetElementType:d,dataElementType:u}=defaults.datasets[a];Object.assign(h,{dataElementType:registry.getElement(u),datasetElementType:d&&registry.getElement(d)}),o.controller=new h(this,i),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,u=this.data.datasets.length;d<u;d++){const{controller:m}=this.getDatasetMeta(d),v=!r&&s.indexOf(m)===-1;m.buildOrUpdateElements(v),o=Math.max(+m.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),r||each(s,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:a,_lastEvent:h}=this;h?this._eventHandler(h,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!setsEqual(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of t){const o=i==="_removeElements"?-s:s;moveNumericKeys(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),r=i(0);for(let s=1;s<t;s++)if(!setsEqual(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],each(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,isFunction(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,s;for(r=0,s=t.length;r<s;++r){const o=t[r];(!e||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=getDatasetClipArea(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&clipArea(t,r),e.controller.draw(),r&&unclipArea(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const s=Interaction.modes[t];return typeof s=="function"?s(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(s=>s&&s._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,r);defined(t)?(s.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),o.update(s,{visible:i}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),animator.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},r=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};each(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(h,d)=>{t.addEventListener(this,h,d),e[h]=d},r=(h,d)=>{e[h]&&(t.removeEventListener(this,h,d),delete e[h])},s=(h,d)=>{this.canvas&&this.resize(h,d)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),i("resize",s),i("detach",o)};o=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){each(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},each(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let s,o,a,h;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),a=0,h=e.length;a<h;++a){o=e[a];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!_elementsEqual(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const r=this.options.hover,s=(h,d)=>h.filter(u=>!d.some(m=>u.datasetIndex===m.datasetIndex&&u.index===m.index)),o=s(t,e),a=i?e:s(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:s}=this,o=t,a=this._getActiveElements(e,r,i,o),h=_isClickEvent(e),d=determineLastEvent(e,this._lastEvent,i,h);i&&(this._lastEvent=null,callback(s.onHover,[e,a,this],this),h&&callback(s.onClick,[e,a,this],this));const u=!_elementsEqual(a,r);return(u||t)&&(this._active=a,this._updateHoverStyles(a,r,t)),this._lastEvent=d,u}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}}je(Chart,"defaults",defaults),je(Chart,"instances",instances),je(Chart,"overrides",overrides),je(Chart,"registry",registry),je(Chart,"version",version),je(Chart,"getChart",getChart);function invalidatePlugins(){return each(Chart.instances,n=>n._plugins.invalidate())}function clipArc(n,e,t){const{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:h}=e;let d=r/a;n.beginPath(),n.arc(s,o,a,i-d,t+d),h>r?(d=r/h,n.arc(s,o,h,t+d,i-d,!0)):n.arc(s,o,r,t+HALF_PI,i-HALF_PI),n.closePath(),n.clip()}function toRadiusCorners(n){return _readValueToProps(n,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(n,e,t,i){const r=toRadiusCorners(n.options.borderRadius),s=(t-e)/2,o=Math.min(s,i*e/2),a=h=>{const d=(t-Math.min(s,h))*i/2;return _limitValue(h,0,Math.min(s,d))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:_limitValue(r.innerStart,0,o),innerEnd:_limitValue(r.innerEnd,0,o)}}function rThetaToXY(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function pathArc(n,e,t,i,r,s){const{x:o,y:a,startAngle:h,pixelMargin:d,innerRadius:u}=e,m=Math.max(e.outerRadius+i+t-d,0),v=u>0?u+i+t+d:0;let _=0;const D=r-h;if(i){const F=u>0?u-i:0,k=m>0?m-i:0,B=(F+k)/2,U=B!==0?D*B/(B+i):D;_=(D-U)/2}const f=Math.max(.001,D*m-t/PI)/m,l=(D-f)/2,c=h+l+_,p=r-l-_,{outerStart:b,outerEnd:E,innerStart:C,innerEnd:g}=parseBorderRadius$1(e,v,m,p-c),x=m-b,y=m-E,w=c+b/x,M=p-E/y,S=v+C,O=v+g,P=c+C/S,I=p-g/O;if(n.beginPath(),s){const F=(w+M)/2;if(n.arc(o,a,m,w,F),n.arc(o,a,m,F,M),E>0){const W=rThetaToXY(y,M,o,a);n.arc(W.x,W.y,E,M,p+HALF_PI)}const k=rThetaToXY(O,p,o,a);if(n.lineTo(k.x,k.y),g>0){const W=rThetaToXY(O,I,o,a);n.arc(W.x,W.y,g,p+HALF_PI,I+Math.PI)}const B=(p-g/v+(c+C/v))/2;if(n.arc(o,a,v,p-g/v,B,!0),n.arc(o,a,v,B,c+C/v,!0),C>0){const W=rThetaToXY(S,P,o,a);n.arc(W.x,W.y,C,P+Math.PI,c-HALF_PI)}const U=rThetaToXY(x,c,o,a);if(n.lineTo(U.x,U.y),b>0){const W=rThetaToXY(x,w,o,a);n.arc(W.x,W.y,b,c-HALF_PI,w)}}else{n.moveTo(o,a);const F=Math.cos(w)*m+o,k=Math.sin(w)*m+a;n.lineTo(F,k);const B=Math.cos(M)*m+o,U=Math.sin(M)*m+a;n.lineTo(B,U)}n.closePath()}function drawArc(n,e,t,i,r){const{fullCircles:s,startAngle:o,circumference:a}=e;let h=e.endAngle;if(s){pathArc(n,e,t,i,h,r);for(let d=0;d<s;++d)n.fill();isNaN(a)||(h=o+(a%TAU||TAU))}return pathArc(n,e,t,i,h,r),n.fill(),h}function drawBorder(n,e,t,i,r){const{fullCircles:s,startAngle:o,circumference:a,options:h}=e,{borderWidth:d,borderJoinStyle:u,borderDash:m,borderDashOffset:v}=h,_=h.borderAlign==="inner";if(!d)return;n.setLineDash(m||[]),n.lineDashOffset=v,_?(n.lineWidth=d*2,n.lineJoin=u||"round"):(n.lineWidth=d,n.lineJoin=u||"bevel");let D=e.endAngle;if(s){pathArc(n,e,t,i,D,r);for(let f=0;f<s;++f)n.stroke();isNaN(a)||(D=o+(a%TAU||TAU))}_&&clipArc(n,e,D),s||(pathArc(n,e,t,i,D,r),n.stroke())}class ArcElement extends Element{constructor(t){super();je(this,"circumference");je(this,"endAngle");je(this,"fullCircles");je(this,"innerRadius");je(this,"outerRadius");je(this,"pixelMargin");je(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,i,r){const s=this.getProps(["x","y"],r),{angle:o,distance:a}=getAngleFromPoint(s,{x:t,y:i}),{startAngle:h,endAngle:d,innerRadius:u,outerRadius:m,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),_=(this.options.spacing+this.options.borderWidth)/2,D=valueOrDefault(v,d-h),f=_angleBetween(o,h,d)&&h!==d,l=D>=TAU||f,c=_isBetween(a,u+_,m+_);return l&&c}getCenterPoint(t){const{x:i,y:r,startAngle:s,endAngle:o,innerRadius:a,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:d,spacing:u}=this.options,m=(s+o)/2,v=(a+h+u+d)/2;return{x:i+Math.cos(m)*v,y:r+Math.sin(m)*v}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:i,circumference:r}=this,s=(i.offset||0)/4,o=(i.spacing||0)/2,a=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=r>TAU?Math.floor(r/TAU):0,r===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const h=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(h)*s,Math.sin(h)*s);const d=1-Math.sin(Math.min(PI,r||0)),u=s*d;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,drawArc(t,this,u,o,a),drawBorder(t,this,u,o,a),t.restore()}}je(ArcElement,"id","arc"),je(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),je(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),je(ArcElement,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function setStyle(n,e,t=e){n.lineCap=valueOrDefault(t.borderCapStyle,e.borderCapStyle),n.setLineDash(valueOrDefault(t.borderDash,e.borderDash)),n.lineDashOffset=valueOrDefault(t.borderDashOffset,e.borderDashOffset),n.lineJoin=valueOrDefault(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=valueOrDefault(t.borderWidth,e.borderWidth),n.strokeStyle=valueOrDefault(t.borderColor,e.borderColor)}function lineTo(n,e,t){n.lineTo(t.x,t.y)}function getLineMethod(n){return n.stepped?_steppedLineTo:n.tension||n.cubicInterpolationMode==="monotone"?_bezierCurveTo:lineTo}function pathVars(n,e,t={}){const i=n.length,{start:r=0,end:s=i-1}=t,{start:o,end:a}=e,h=Math.max(r,o),d=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:i,start:h,loop:e.loop,ilen:d<h&&!u?i+d-h:d-h}}function pathSegment(n,e,t,i){const{points:r,options:s}=e,{count:o,start:a,loop:h,ilen:d}=pathVars(r,t,i),u=getLineMethod(s);let{move:m=!0,reverse:v}=i||{},_,D,f;for(_=0;_<=d;++_)D=r[(a+(v?d-_:_))%o],!D.skip&&(m?(n.moveTo(D.x,D.y),m=!1):u(n,f,D,v,s.stepped),f=D);return h&&(D=r[(a+(v?d:0))%o],u(n,f,D,v,s.stepped)),!!h}function fastPathSegment(n,e,t,i){const r=e.points,{count:s,start:o,ilen:a}=pathVars(r,t,i),{move:h=!0,reverse:d}=i||{};let u=0,m=0,v,_,D,f,l,c;const p=E=>(o+(d?a-E:E))%s,b=()=>{f!==l&&(n.lineTo(u,l),n.lineTo(u,f),n.lineTo(u,c))};for(h&&(_=r[p(0)],n.moveTo(_.x,_.y)),v=0;v<=a;++v){if(_=r[p(v)],_.skip)continue;const E=_.x,C=_.y,g=E|0;g===D?(C<f?f=C:C>l&&(l=C),u=(m*u+E)/++m):(b(),n.lineTo(E,C),D=g,m=0,f=l=C),c=C}b()}function _getSegmentMethod(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?fastPathSegment:pathSegment}function _getInterpolationMethod(n){return n.stepped?_steppedInterpolation:n.tension||n.cubicInterpolationMode==="monotone"?_bezierInterpolation:_pointInLine}function strokePathWithCache(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),setStyle(n,e.options),n.stroke(r)}function strokePathDirect(n,e,t,i){const{segments:r,options:s}=e,o=_getSegmentMethod(e);for(const a of r)setStyle(n,s,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const usePath2D=typeof Path2D=="function";function draw(n,e,t,i){usePath2D&&!e.options.segment?strokePathWithCache(n,e,t,i):strokePathDirect(n,e,t,i)}class LineElement extends Element{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;_updateBezierControlPoints(this._points,i,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_computeSegments(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,r=e[t],s=this.points,o=_boundSegments(this,{property:t,start:r,end:r});if(!o.length)return;const a=[],h=_getInterpolationMethod(i);let d,u;for(d=0,u=o.length;d<u;++d){const{start:m,end:v}=o[d],_=s[m],D=s[v];if(_===D){a.push(_);continue}const f=Math.abs((r-_[t])/(D[t]-_[t])),l=h(_,D,f,i.stepped);l[t]=e[t],a.push(l)}return a.length===1?a[0]:a}pathSegment(e,t,i){return _getSegmentMethod(this)(e,this,t,i)}path(e,t,i){const r=this.segments,s=_getSegmentMethod(this);let o=this._loop;t=t||0,i=i||this.points.length-t;for(const a of r)o&=s(e,this,a,{start:t,end:t+i-1});return!!o}draw(e,t,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),draw(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}je(LineElement,"id","line"),je(LineElement,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),je(LineElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),je(LineElement,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function inRange$1(n,e,t,i){const r=n.options,{[t]:s}=n.getProps([t],i);return Math.abs(e-s)<r.radius+r.hitRadius}class PointElement extends Element{constructor(t){super();je(this,"parsed");je(this,"skip");je(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,i,r){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(t-o,2)+Math.pow(i-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,i){return inRange$1(this,t,"x",i)}inYRange(t,i){return inRange$1(this,t,"y",i)}getCenterPoint(t){const{x:i,y:r}=this.getProps(["x","y"],t);return{x:i,y:r}}size(t){t=t||this.options||{};let i=t.radius||0;i=Math.max(i,i&&t.hoverRadius||0);const r=i&&t.borderWidth||0;return(i+r)*2}draw(t,i){const r=this.options;this.skip||r.radius<.1||!_isPointInArea(this,i,this.size(r)/2)||(t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.fillStyle=r.backgroundColor,drawPoint(t,r,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}je(PointElement,"id","point"),je(PointElement,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),je(PointElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function getBarBounds(n,e){const{x:t,y:i,base:r,width:s,height:o}=n.getProps(["x","y","base","width","height"],e);let a,h,d,u,m;return n.horizontal?(m=o/2,a=Math.min(t,r),h=Math.max(t,r),d=i-m,u=i+m):(m=s/2,a=t-m,h=t+m,d=Math.min(i,r),u=Math.max(i,r)),{left:a,top:d,right:h,bottom:u}}function skipOrLimit(n,e,t,i){return n?0:_limitValue(e,t,i)}function parseBorderWidth(n,e,t){const i=n.options.borderWidth,r=n.borderSkipped,s=toTRBL(i);return{t:skipOrLimit(r.top,s.top,0,t),r:skipOrLimit(r.right,s.right,0,e),b:skipOrLimit(r.bottom,s.bottom,0,t),l:skipOrLimit(r.left,s.left,0,e)}}function parseBorderRadius(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,s=toTRBLCorners(r),o=Math.min(e,t),a=n.borderSkipped,h=i||isObject(r);return{topLeft:skipOrLimit(!h||a.top||a.left,s.topLeft,0,o),topRight:skipOrLimit(!h||a.top||a.right,s.topRight,0,o),bottomLeft:skipOrLimit(!h||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:skipOrLimit(!h||a.bottom||a.right,s.bottomRight,0,o)}}function boundingRects(n){const e=getBarBounds(n),t=e.right-e.left,i=e.bottom-e.top,r=parseBorderWidth(n,t/2,i/2),s=parseBorderRadius(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function inRange(n,e,t,i){const r=e===null,s=t===null,a=n&&!(r&&s)&&getBarBounds(n,i);return a&&(r||_isBetween(e,a.left,a.right))&&(s||_isBetween(t,a.top,a.bottom))}function hasRadius(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function addNormalRectPath(n,e){n.rect(e.x,e.y,e.w,e.h)}function inflateRect(n,e,t={}){const i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-i,o=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+s,h:n.h+o,radius:n.radius}}class BarElement extends Element{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=boundingRects(this),a=hasRadius(o.radius)?addRoundedRectPath:addNormalRectPath;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,inflateRect(o,t,s)),e.clip(),a(e,inflateRect(s,-t,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),a(e,inflateRect(s,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return inRange(this,e,t,i)}inXRange(e,t){return inRange(this,e,null,t)}inYRange(e,t){return inRange(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+r)/2:t,y:s?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}je(BarElement,"id","bar"),je(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),je(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var elements=Object.freeze({__proto__:null,ArcElement,BarElement,LineElement,PointElement});const BORDER_COLORS=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],BACKGROUND_COLORS=BORDER_COLORS.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function getBorderColor(n){return BORDER_COLORS[n%BORDER_COLORS.length]}function getBackgroundColor(n){return BACKGROUND_COLORS[n%BACKGROUND_COLORS.length]}function colorizeDefaultDataset(n,e){return n.borderColor=getBorderColor(e),n.backgroundColor=getBackgroundColor(e),++e}function colorizeDoughnutDataset(n,e){return n.backgroundColor=n.data.map(()=>getBorderColor(e++)),e}function colorizePolarAreaDataset(n,e){return n.backgroundColor=n.data.map(()=>getBackgroundColor(e++)),e}function getColorizer(n){let e=0;return(t,i)=>{const r=n.getDatasetMeta(i).controller;r instanceof DoughnutController?e=colorizeDoughnutDataset(t,e):r instanceof PolarAreaController?e=colorizePolarAreaDataset(t,e):r&&(e=colorizeDefaultDataset(t,e))}}function containsColorsDefinitions(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function containsColorsDefinition(n){return n&&(n.borderColor||n.backgroundColor)}function containsDefaultColorsDefenitions(){return defaults.borderColor!=="rgba(0,0,0,0.1)"||defaults.backgroundColor!=="rgba(0,0,0,0.1)"}var plugin_colors={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;const{data:{datasets:i},options:r}=n.config,{elements:s}=r,o=containsColorsDefinitions(i)||containsColorsDefinition(r)||s&&containsColorsDefinitions(s)||containsDefaultColorsDefenitions();if(!t.forceOverride&&o)return;const a=getColorizer(n);i.forEach(a)}};function lttbDecimation(n,e,t,i,r){const s=r.samples||i;if(s>=t)return n.slice(e,e+t);const o=[],a=(t-2)/(s-2);let h=0;const d=e+t-1;let u=e,m,v,_,D,f;for(o[h++]=n[u],m=0;m<s-2;m++){let l=0,c=0,p;const b=Math.floor((m+1)*a)+1+e,E=Math.min(Math.floor((m+2)*a)+1,t)+e,C=E-b;for(p=b;p<E;p++)l+=n[p].x,c+=n[p].y;l/=C,c/=C;const g=Math.floor(m*a)+1+e,x=Math.min(Math.floor((m+1)*a)+1,t)+e,{x:y,y:w}=n[u];for(_=D=-1,p=g;p<x;p++)D=.5*Math.abs((y-l)*(n[p].y-w)-(y-n[p].x)*(c-w)),D>_&&(_=D,v=n[p],f=p);o[h++]=v,u=f}return o[h++]=n[d],o}function minMaxDecimation(n,e,t,i){let r=0,s=0,o,a,h,d,u,m,v,_,D,f;const l=[],c=e+t-1,p=n[e].x,E=n[c].x-p;for(o=e;o<e+t;++o){a=n[o],h=(a.x-p)/E*i,d=a.y;const C=h|0;if(C===u)d<D?(D=d,m=o):d>f&&(f=d,v=o),r=(s*r+a.x)/++s;else{const g=o-1;if(!isNullOrUndef(m)&&!isNullOrUndef(v)){const x=Math.min(m,v),y=Math.max(m,v);x!==_&&x!==g&&l.push({...n[x],x:r}),y!==_&&y!==g&&l.push({...n[y],x:r})}o>0&&g!==_&&l.push(n[g]),l.push(a),u=C,s=0,D=f=d,m=v=_=o}}return l}function cleanDecimatedDataset(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function cleanDecimatedData(n){n.data.datasets.forEach(e=>{cleanDecimatedDataset(e)})}function getStartAndCountOfVisiblePointsSimplified(n,e){const t=e.length;let i=0,r;const{iScale:s}=n,{min:o,max:a,minDefined:h,maxDefined:d}=s.getUserBounds();return h&&(i=_limitValue(_lookupByKey(e,s.axis,o).lo,0,t-1)),d?r=_limitValue(_lookupByKey(e,s.axis,a).hi+1,i,t)-i:r=t-i,{start:i,count:r}}var plugin_decimation={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){cleanDecimatedData(n);return}const i=n.width;n.data.datasets.forEach((r,s)=>{const{_data:o,indexAxis:a}=r,h=n.getDatasetMeta(s),d=o||r.data;if(resolve([a,n.options.indexAxis])==="y"||!h.controller.supportsDecimation)return;const u=n.scales[h.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:m,count:v}=getStartAndCountOfVisiblePointsSimplified(h,d);const _=t.threshold||4*i;if(v<=_){cleanDecimatedDataset(r);return}isNullOrUndef(o)&&(r._data=d,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(f){this._data=f}}));let D;switch(t.algorithm){case"lttb":D=lttbDecimation(d,m,v,i,t);break;case"min-max":D=minMaxDecimation(d,m,v,i);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}r._decimated=D})},destroy(n){cleanDecimatedData(n)}};function _segments(n,e,t){const i=n.segments,r=n.points,s=e.points,o=[];for(const a of i){let{start:h,end:d}=a;d=_findSegmentEnd(h,d,r);const u=_getBounds(t,r[h],r[d],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[h],end:r[d]});continue}const m=_boundSegments(e,u);for(const v of m){const _=_getBounds(t,s[v.start],s[v.end],v.loop),D=_boundSegment(a,r,_);for(const f of D)o.push({source:f,target:v,start:{[t]:_getEdge(u,_,"start",Math.max)},end:{[t]:_getEdge(u,_,"end",Math.min)}})}}return o}function _getBounds(n,e,t,i){if(i)return;let r=e[n],s=t[n];return n==="angle"&&(r=_normalizeAngle(r),s=_normalizeAngle(s)),{property:n,start:r,end:s}}function _pointsFromSegments(n,e){const{x:t=null,y:i=null}=n||{},r=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=_findSegmentEnd(o,a,r);const h=r[o],d=r[a];i!==null?(s.push({x:h.x,y:i}),s.push({x:d.x,y:i})):t!==null&&(s.push({x:t,y:h.y}),s.push({x:t,y:d.y}))}),s}function _findSegmentEnd(n,e,t){for(;e>n;e--){const i=t[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function _getEdge(n,e,t,i){return n&&e?i(n[t],e[t]):n?n[t]:e?e[t]:0}function _createBoundaryLine(n,e){let t=[],i=!1;return isArray(n)?(i=!0,t=n):t=_pointsFromSegments(n,e),t.length?new LineElement({points:t,options:{tension:0},_loop:i,_fullLoop:i}):null}function _shouldApplyFill(n){return n&&n.fill!==!1}function _resolveTarget(n,e,t){let r=n[e].fill;const s=[e];let o;if(!t)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!isNumberFinite(r))return r;if(o=n[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function _decodeFill(n,e,t){const i=parseFillOption(n);if(isObject(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return isNumberFinite(r)&&Math.floor(r)===r?decodeTargetIndex(i[0],e,r,t):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function decodeTargetIndex(n,e,t,i){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=i?!1:t}function _getTargetPixel(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:isObject(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function _getTargetValue(n,e,t){let i;return n==="start"?i=t:n==="end"?i=e.options.reverse?e.min:e.max:isObject(n)?i=n.value:i=e.getBaseValue(),i}function parseFillOption(n){const e=n.options,t=e.fill;let i=valueOrDefault(t&&t.target,t);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function _buildStackLine(n){const{scale:e,index:t,line:i}=n,r=[],s=i.segments,o=i.points,a=getLinesBelow(e,t);a.push(_createBoundaryLine({x:null,y:e.bottom},i));for(let h=0;h<s.length;h++){const d=s[h];for(let u=d.start;u<=d.end;u++)addPointsBelow(r,o[u],a)}return new LineElement({points:r,options:{}})}function getLinesBelow(n,e){const t=[],i=n.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function addPointsBelow(n,e,t){const i=[];for(let r=0;r<t.length;r++){const s=t[r],{first:o,last:a,point:h}=findPoint(s,e,"x");if(!(!h||o&&a)){if(o)i.unshift(h);else if(n.push(h),!a)break}}n.push(...i)}function findPoint(n,e,t){const i=n.interpolate(e,t);if(!i)return{};const r=i[t],s=n.segments,o=n.points;let a=!1,h=!1;for(let d=0;d<s.length;d++){const u=s[d],m=o[u.start][t],v=o[u.end][t];if(_isBetween(r,m,v)){a=r===m,h=r===v;break}}return{first:a,last:h,point:i}}class simpleArc{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:r,y:s,radius:o}=this;return t=t||{start:0,end:TAU},e.arc(r,s,o,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:r}=this,s=e.angle;return{x:t+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function _getTarget(n){const{chart:e,fill:t,line:i}=n;if(isNumberFinite(t))return getLineByIndex(e,t);if(t==="stack")return _buildStackLine(n);if(t==="shape")return!0;const r=computeBoundary(n);return r instanceof simpleArc?r:_createBoundaryLine(r,i)}function getLineByIndex(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function computeBoundary(n){return(n.scale||{}).getPointPositionForValue?computeCircularBoundary(n):computeLinearBoundary(n)}function computeLinearBoundary(n){const{scale:e={},fill:t}=n,i=_getTargetPixel(t,e);if(isNumberFinite(i)){const r=e.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function computeCircularBoundary(n){const{scale:e,fill:t}=n,i=e.options,r=e.getLabels().length,s=i.reverse?e.max:e.min,o=_getTargetValue(t,e,s),a=[];if(i.grid.circular){const h=e.getPointPositionForValue(0,s);return new simpleArc({x:h.x,y:h.y,radius:e.getDistanceFromCenterForValue(o)})}for(let h=0;h<r;++h)a.push(e.getPointPositionForValue(h,o));return a}function _drawfill(n,e,t){const i=_getTarget(e),{chart:r,index:s,line:o,scale:a,axis:h}=e,d=o.options,u=d.fill,m=d.backgroundColor,{above:v=m,below:_=m}=u||{},D=r.getDatasetMeta(s),f=getDatasetClipArea(r,D);i&&o.points.length&&(clipArea(n,t),doFill(n,{line:o,target:i,above:v,below:_,area:t,scale:a,axis:h,clip:f}),unclipArea(n))}function doFill(n,e){const{line:t,target:i,above:r,below:s,area:o,scale:a,clip:h}=e,d=t._loop?"angle":e.axis;n.save(),d==="x"&&s!==r&&(clipVertical(n,i,o.top),fill(n,{line:t,target:i,color:r,scale:a,property:d,clip:h}),n.restore(),n.save(),clipVertical(n,i,o.bottom)),fill(n,{line:t,target:i,color:s,scale:a,property:d,clip:h}),n.restore()}function clipVertical(n,e,t){const{segments:i,points:r}=e;let s=!0,o=!1;n.beginPath();for(const a of i){const{start:h,end:d}=a,u=r[h],m=r[_findSegmentEnd(h,d,r)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(m.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function fill(n,e){const{line:t,target:i,property:r,color:s,scale:o,clip:a}=e,h=_segments(t,i,r);for(const{source:d,target:u,start:m,end:v}of h){const{style:{backgroundColor:_=s}={}}=d,D=i!==!0;n.save(),n.fillStyle=_,clipBounds(n,o,a,D&&_getBounds(r,m,v)),n.beginPath();const f=!!t.pathSegment(n,d);let l;if(D){f?n.closePath():interpolatedLineTo(n,i,v,r);const c=!!i.pathSegment(n,u,{move:f,reverse:!0});l=f&&c,l||interpolatedLineTo(n,i,m,r)}n.closePath(),n.fill(l?"evenodd":"nonzero"),n.restore()}}function clipBounds(n,e,t,i){const r=e.chart.chartArea,{property:s,start:o,end:a}=i||{};if(s==="x"||s==="y"){let h,d,u,m;s==="x"?(h=o,d=r.top,u=a,m=r.bottom):(h=r.left,d=o,u=r.right,m=a),n.beginPath(),t&&(h=Math.max(h,t.left),u=Math.min(u,t.right),d=Math.max(d,t.top),m=Math.min(m,t.bottom)),n.rect(h,d,u-h,m-d),n.clip()}}function interpolatedLineTo(n,e,t,i){const r=e.interpolate(t,i);r&&n.lineTo(r.x,r.y)}var index={id:"filler",afterDatasetsUpdate(n,e,t){const i=(n.data.datasets||[]).length,r=[];let s,o,a,h;for(o=0;o<i;++o)s=n.getDatasetMeta(o),a=s.dataset,h=null,a&&a.options&&a instanceof LineElement&&(h={visible:n.isDatasetVisible(o),index:o,fill:_decodeFill(a,o,i),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=h,r.push(h);for(o=0;o<i;++o)h=r[o],!(!h||h.fill===!1)&&(h.fill=_resolveTarget(r,o,t.propagate))},beforeDraw(n,e,t){const i=t.drawTime==="beforeDraw",r=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&_drawfill(n.ctx,a,s))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;_shouldApplyFill(s)&&_drawfill(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,e,t){const i=e.meta.$filler;!_shouldApplyFill(i)||t.drawTime!=="beforeDatasetDraw"||_drawfill(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const getBoxSize=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},itemsEqual=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class Legend extends Element{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=callback(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=toFont(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:h}=getBoxSize(i,s);let d,u;t.font=r.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(o,s,a,h)+10):(u=this.maxHeight,d=this._fitCols(o,r,a,h)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,h=this.legendHitBoxes=[],d=this.lineWidths=[0],u=r+a;let m=e;s.textAlign="left",s.textBaseline="middle";let v=-1,_=-u;return this.legendItems.forEach((D,f)=>{const l=i+t/2+s.measureText(D.text).width;(f===0||d[d.length-1]+l+2*a>o)&&(m+=u,d[d.length-(f>0?0:1)]=0,_+=u,v++),h[f]={left:0,top:_,row:v,width:l,height:r},d[d.length-1]+=l+a}),m}_fitCols(e,t,i,r){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,h=this.legendHitBoxes=[],d=this.columnSizes=[],u=o-e;let m=a,v=0,_=0,D=0,f=0;return this.legendItems.forEach((l,c)=>{const{itemWidth:p,itemHeight:b}=calculateItemSize(i,t,s,l,r);c>0&&_+b+2*a>u&&(m+=v+a,d.push({width:v,height:_}),D+=v+a,f++,v=_=0),h[c]={left:D,top:_,col:f,width:p,height:b},v=Math.max(v,p),_+=b+a}),m+=v,d.push({width:v,height:_}),m}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:s}}=this,o=getRtlAdapter(s,this.left,this.width);if(this.isHorizontal()){let a=0,h=_alignStartEnd(i,this.left+r,this.right-this.lineWidths[a]);for(const d of t)a!==d.row&&(a=d.row,h=_alignStartEnd(i,this.left+r,this.right-this.lineWidths[a])),d.top+=this.top+e+r,d.left=o.leftForLtr(o.x(h),d.width),h+=d.width+r}else{let a=0,h=_alignStartEnd(i,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const d of t)d.col!==a&&(a=d.col,h=_alignStartEnd(i,this.top+e+r,this.bottom-this.columnSizes[a].height)),d.top=h,d.left+=this.left+r,d.left=o.leftForLtr(o.x(d.left),d.width),h+=d.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;clipArea(e,this),this._draw(),unclipArea(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:s,labels:o}=e,a=defaults.color,h=getRtlAdapter(e.rtl,this.left,this.width),d=toFont(o.font),{padding:u}=o,m=d.size,v=m/2;let _;this.drawTitle(),r.textAlign=h.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=d.string;const{boxWidth:D,boxHeight:f,itemHeight:l}=getBoxSize(o,m),c=function(g,x,y){if(isNaN(D)||D<=0||isNaN(f)||f<0)return;r.save();const w=valueOrDefault(y.lineWidth,1);if(r.fillStyle=valueOrDefault(y.fillStyle,a),r.lineCap=valueOrDefault(y.lineCap,"butt"),r.lineDashOffset=valueOrDefault(y.lineDashOffset,0),r.lineJoin=valueOrDefault(y.lineJoin,"miter"),r.lineWidth=w,r.strokeStyle=valueOrDefault(y.strokeStyle,a),r.setLineDash(valueOrDefault(y.lineDash,[])),o.usePointStyle){const M={radius:f*Math.SQRT2/2,pointStyle:y.pointStyle,rotation:y.rotation,borderWidth:w},S=h.xPlus(g,D/2),O=x+v;drawPointLegend(r,M,S,O,o.pointStyleWidth&&D)}else{const M=x+Math.max((m-f)/2,0),S=h.leftForLtr(g,D),O=toTRBLCorners(y.borderRadius);r.beginPath(),Object.values(O).some(P=>P!==0)?addRoundedRectPath(r,{x:S,y:M,w:D,h:f,radius:O}):r.rect(S,M,D,f),r.fill(),w!==0&&r.stroke()}r.restore()},p=function(g,x,y){renderText(r,y.text,g,x+l/2,d,{strikethrough:y.hidden,textAlign:h.textAlign(y.textAlign)})},b=this.isHorizontal(),E=this._computeTitleHeight();b?_={x:_alignStartEnd(s,this.left+u,this.right-i[0]),y:this.top+u+E,line:0}:_={x:this.left+u,y:_alignStartEnd(s,this.top+E+u,this.bottom-t[0].height),line:0},overrideTextDirection(this.ctx,e.textDirection);const C=l+u;this.legendItems.forEach((g,x)=>{r.strokeStyle=g.fontColor,r.fillStyle=g.fontColor;const y=r.measureText(g.text).width,w=h.textAlign(g.textAlign||(g.textAlign=o.textAlign)),M=D+v+y;let S=_.x,O=_.y;h.setWidth(this.width),b?x>0&&S+M+u>this.right&&(O=_.y+=C,_.line++,S=_.x=_alignStartEnd(s,this.left+u,this.right-i[_.line])):x>0&&O+C>this.bottom&&(S=_.x=S+t[_.line].width+u,_.line++,O=_.y=_alignStartEnd(s,this.top+E+u,this.bottom-t[_.line].height));const P=h.x(S);if(c(P,O,g),S=_textX(w,S+D+v,b?S+M:this.right,e.rtl),p(h.x(S),O,g),b)_.x+=M+u;else if(typeof g.text!="string"){const I=d.lineHeight;_.y+=calculateLegendItemHeight(g,I)+u}else _.y+=C}),restoreTextDirection(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=toFont(t.font),r=toPadding(t.padding);if(!t.display)return;const s=getRtlAdapter(e.rtl,this.left,this.width),o=this.ctx,a=t.position,h=i.size/2,d=r.top+h;let u,m=this.left,v=this.width;if(this.isHorizontal())v=Math.max(...this.lineWidths),u=this.top+d,m=_alignStartEnd(e.align,m,this.right-v);else{const D=this.columnSizes.reduce((f,l)=>Math.max(f,l.height),0);u=d+_alignStartEnd(e.align,this.top,this.bottom-D-e.labels.padding-this._computeTitleHeight())}const _=_alignStartEnd(a,m,m+v);o.textAlign=s.textAlign(_toLeftRightCenter(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=i.string,renderText(o,t.text,_,u,i)}_computeTitleHeight(){const e=this.options.title,t=toFont(e.font),i=toPadding(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,s;if(_isBetween(e,this.left,this.right)&&_isBetween(t,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],_isBetween(e,r.left,r.left+r.width)&&_isBetween(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!isListened(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=itemsEqual(r,i);r&&!s&&callback(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&callback(t.onHover,[e,i,this],this)}else i&&callback(t.onClick,[e,i,this],this)}}function calculateItemSize(n,e,t,i,r){const s=calculateItemWidth(i,n,e,t),o=calculateItemHeight(r,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function calculateItemWidth(n,e,t,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+i.measureText(r).width}function calculateItemHeight(n,e,t){let i=n;return typeof e.text!="string"&&(i=calculateLegendItemHeight(e,t)),i}function calculateLegendItemHeight(n,e){const t=n.text?n.text.length:0;return e*t}function isListened(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(n,e,t){const i=n.legend=new Legend({ctx:n.ctx,options:t,chart:n});layouts.configure(n,i,t),layouts.addBox(n,i)},stop(n){layouts.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;layouts.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(h=>{const d=h.controller.getStyle(t?0:void 0),u=toPadding(d.borderWidth);return{text:e[h.index].label,fillStyle:d.backgroundColor,fontColor:s,hidden:!h.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:i||d.pointStyle,rotation:d.rotation,textAlign:r||d.textAlign,borderRadius:o&&(a||d.borderRadius),datasetIndex:h.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Title extends Element{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=isArray(i.text)?i.text.length:1;this._padding=toPadding(i.padding);const s=r*toFont(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:r,right:s,options:o}=this,a=o.align;let h=0,d,u,m;return this.isHorizontal()?(u=_alignStartEnd(a,i,s),m=t+e,d=s-i):(o.position==="left"?(u=i+e,m=_alignStartEnd(a,r,t),h=PI*-.5):(u=s-e,m=_alignStartEnd(a,t,r),h=PI*.5),d=r-t),{titleX:u,titleY:m,maxWidth:d,rotation:h}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=toFont(t.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:h,rotation:d}=this._drawArgs(s);renderText(e,t.text,0,0,i,{color:t.color,maxWidth:h,rotation:d,textAlign:_toLeftRightCenter(t.align),textBaseline:"middle",translation:[o,a]})}}function createTitle(n,e){const t=new Title({ctx:n.ctx,options:e,chart:n});layouts.configure(n,t,e),layouts.addBox(n,t),n.titleBlock=t}var plugin_title={id:"title",_element:Title,start(n,e,t){createTitle(n,t)},stop(n){const e=n.titleBlock;layouts.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;layouts.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const map=new WeakMap;var plugin_subtitle={id:"subtitle",start(n,e,t){const i=new Title({ctx:n.ctx,options:t,chart:n});layouts.configure(n,i,t),layouts.addBox(n,i),map.set(n,i)},stop(n){layouts.removeBox(n,map.get(n)),map.delete(n)},beforeUpdate(n,e,t){const i=map.get(n);layouts.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(n){if(!n.length)return!1;let e,t,i=new Set,r=0,s=0;for(e=0,t=n.length;e<t;++e){const a=n[e].element;if(a&&a.hasValue()){const h=a.tooltipPosition();i.add(h.x),r+=h.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,h)=>a+h)/i.size,y:r/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){const h=n[s].element;if(h&&h.hasValue()){const d=h.getCenterPoint(),u=distanceBetweenPoints(e,d);u<r&&(r=u,a=h)}}if(a){const h=a.tooltipPosition();t=h.x,i=h.y}return{x:t,y:i}}};function pushOrConcat(n,e){return e&&(isArray(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function splitNewlines(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function createTooltipItem(n,e){const{element:t,datasetIndex:i,index:r}=e,s=n.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:n,label:o,parsed:s.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function getTooltipSize(n,e){const t=n.chart.ctx,{body:i,footer:r,title:s}=n,{boxWidth:o,boxHeight:a}=e,h=toFont(e.bodyFont),d=toFont(e.titleFont),u=toFont(e.footerFont),m=s.length,v=r.length,_=i.length,D=toPadding(e.padding);let f=D.height,l=0,c=i.reduce((E,C)=>E+C.before.length+C.lines.length+C.after.length,0);if(c+=n.beforeBody.length+n.afterBody.length,m&&(f+=m*d.lineHeight+(m-1)*e.titleSpacing+e.titleMarginBottom),c){const E=e.displayColors?Math.max(a,h.lineHeight):h.lineHeight;f+=_*E+(c-_)*h.lineHeight+(c-1)*e.bodySpacing}v&&(f+=e.footerMarginTop+v*u.lineHeight+(v-1)*e.footerSpacing);let p=0;const b=function(E){l=Math.max(l,t.measureText(E).width+p)};return t.save(),t.font=d.string,each(n.title,b),t.font=h.string,each(n.beforeBody.concat(n.afterBody),b),p=e.displayColors?o+2+e.boxPadding:0,each(i,E=>{each(E.before,b),each(E.lines,b),each(E.after,b)}),p=0,t.font=u.string,each(n.footer,b),t.restore(),l+=D.width,{width:l,height:f}}function determineYAlign(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function doesNotFitWithAlign(n,e,t,i){const{x:r,width:s}=i,o=t.caretSize+t.caretPadding;if(n==="left"&&r+s+o>e.width||n==="right"&&r-s-o<0)return!0}function determineXAlign(n,e,t,i){const{x:r,width:s}=t,{width:o,chartArea:{left:a,right:h}}=n;let d="center";return i==="center"?d=r<=(a+h)/2?"left":"right":r<=s/2?d="left":r>=o-s/2&&(d="right"),doesNotFitWithAlign(d,n,e,t)&&(d="center"),d}function determineAlignment(n,e,t){const i=t.yAlign||e.yAlign||determineYAlign(n,t);return{xAlign:t.xAlign||e.xAlign||determineXAlign(n,e,t,i),yAlign:i}}function alignX(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function alignY(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function getBackgroundPoint(n,e,t,i){const{caretSize:r,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:h}=t,d=r+s,{topLeft:u,topRight:m,bottomLeft:v,bottomRight:_}=toTRBLCorners(o);let D=alignX(e,a);const f=alignY(e,h,d);return h==="center"?a==="left"?D+=d:a==="right"&&(D-=d):a==="left"?D-=Math.max(u,v)+r:a==="right"&&(D+=Math.max(m,_)+r),{x:_limitValue(D,0,i.width-e.width),y:_limitValue(f,0,i.height-e.height)}}function getAlignedX(n,e,t){const i=toPadding(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function getBeforeAfterBodyLines(n){return pushOrConcat([],splitNewlines(n))}function createTooltipContext(n,e,t){return createContext(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function overrideCallbacks(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const defaultCallbacks={beforeTitle:noop,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return isNullOrUndef(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop};function invokeCallbackWithFallback(n,e,t,i){const r=n[e].call(t,i);return typeof r>"u"?defaultCallbacks[e].call(t,i):r}class Tooltip extends Element{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&t.options.animation&&i.animations,s=new Animations(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,r=invokeCallbackWithFallback(i,"beforeTitle",this,e),s=invokeCallbackWithFallback(i,"title",this,e),o=invokeCallbackWithFallback(i,"afterTitle",this,e);let a=[];return a=pushOrConcat(a,splitNewlines(r)),a=pushOrConcat(a,splitNewlines(s)),a=pushOrConcat(a,splitNewlines(o)),a}getBeforeBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,r=[];return each(e,s=>{const o={before:[],lines:[],after:[]},a=overrideCallbacks(i,s);pushOrConcat(o.before,splitNewlines(invokeCallbackWithFallback(a,"beforeLabel",this,s))),pushOrConcat(o.lines,invokeCallbackWithFallback(a,"label",this,s)),pushOrConcat(o.after,splitNewlines(invokeCallbackWithFallback(a,"afterLabel",this,s))),r.push(o)}),r}getAfterBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,r=invokeCallbackWithFallback(i,"beforeFooter",this,e),s=invokeCallbackWithFallback(i,"footer",this,e),o=invokeCallbackWithFallback(i,"afterFooter",this,e);let a=[];return a=pushOrConcat(a,splitNewlines(r)),a=pushOrConcat(a,splitNewlines(s)),a=pushOrConcat(a,splitNewlines(o)),a}_createItems(e){const t=this._active,i=this.chart.data,r=[],s=[],o=[];let a=[],h,d;for(h=0,d=t.length;h<d;++h)a.push(createTooltipItem(this.chart,t[h]));return e.filter&&(a=a.filter((u,m,v)=>e.filter(u,m,v,i))),e.itemSort&&(a=a.sort((u,m)=>e.itemSort(u,m,i))),each(a,u=>{const m=overrideCallbacks(e.callbacks,u);r.push(invokeCallbackWithFallback(m,"labelColor",this,u)),s.push(invokeCallbackWithFallback(m,"labelPointStyle",this,u)),o.push(invokeCallbackWithFallback(m,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const i=this.options.setContext(this.getContext()),r=this._active;let s,o=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const a=positioners[i.position].call(this,r,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const h=this._size=getTooltipSize(this,i),d=Object.assign({},a,h),u=determineAlignment(this.chart,i,d),m=getBackgroundPoint(i,d,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:m.x,y:m.y,width:h.width,height:h.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,r){const s=this.getCaretPosition(e,i,r);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,i){const{xAlign:r,yAlign:s}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:h,topRight:d,bottomLeft:u,bottomRight:m}=toTRBLCorners(a),{x:v,y:_}=e,{width:D,height:f}=t;let l,c,p,b,E,C;return s==="center"?(E=_+f/2,r==="left"?(l=v,c=l-o,b=E+o,C=E-o):(l=v+D,c=l+o,b=E-o,C=E+o),p=l):(r==="left"?c=v+Math.max(h,u)+o:r==="right"?c=v+D-Math.max(d,m)-o:c=this.caretX,s==="top"?(b=_,E=b-o,l=c-o,p=c+o):(b=_+f,E=b+o,l=c+o,p=c-o),C=b),{x1:l,x2:c,x3:p,y1:b,y2:E,y3:C}}drawTitle(e,t,i){const r=this.title,s=r.length;let o,a,h;if(s){const d=getRtlAdapter(i.rtl,this.x,this.width);for(e.x=getAlignedX(this,i.titleAlign,i),t.textAlign=d.textAlign(i.titleAlign),t.textBaseline="middle",o=toFont(i.titleFont),a=i.titleSpacing,t.fillStyle=i.titleColor,t.font=o.string,h=0;h<s;++h)t.fillText(r[h],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,h+1===s&&(e.y+=i.titleMarginBottom-a)}}_drawColorBox(e,t,i,r,s){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:h,boxWidth:d}=s,u=toFont(s.bodyFont),m=getAlignedX(this,"left",s),v=r.x(m),_=h<u.lineHeight?(u.lineHeight-h)/2:0,D=t.y+_;if(s.usePointStyle){const f={radius:Math.min(d,h)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},l=r.leftForLtr(v,d)+d/2,c=D+h/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,drawPoint(e,f,l,c),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,drawPoint(e,f,l,c)}else{e.lineWidth=isObject(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const f=r.leftForLtr(v,d),l=r.leftForLtr(r.xPlus(v,1),d-2),c=toTRBLCorners(o.borderRadius);Object.values(c).some(p=>p!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,addRoundedRectPath(e,{x:f,y:D,w:d,h,radius:c}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),addRoundedRectPath(e,{x:l,y:D+1,w:d-2,h:h-2,radius:c}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(f,D,d,h),e.strokeRect(f,D,d,h),e.fillStyle=o.backgroundColor,e.fillRect(l,D+1,d-2,h-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:r}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:h,boxWidth:d,boxPadding:u}=i,m=toFont(i.bodyFont);let v=m.lineHeight,_=0;const D=getRtlAdapter(i.rtl,this.x,this.width),f=function(y){t.fillText(y,D.x(e.x+_),e.y+v/2),e.y+=v+s},l=D.textAlign(o);let c,p,b,E,C,g,x;for(t.textAlign=o,t.textBaseline="middle",t.font=m.string,e.x=getAlignedX(this,l,i),t.fillStyle=i.bodyColor,each(this.beforeBody,f),_=a&&l!=="right"?o==="center"?d/2+u:d+2+u:0,E=0,g=r.length;E<g;++E){for(c=r[E],p=this.labelTextColors[E],t.fillStyle=p,each(c.before,f),b=c.lines,a&&b.length&&(this._drawColorBox(t,e,E,D,i),v=Math.max(m.lineHeight,h)),C=0,x=b.length;C<x;++C)f(b[C]),v=m.lineHeight;each(c.after,f)}_=0,v=m.lineHeight,each(this.afterBody,f),e.y-=s}drawFooter(e,t,i){const r=this.footer,s=r.length;let o,a;if(s){const h=getRtlAdapter(i.rtl,this.x,this.width);for(e.x=getAlignedX(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=h.textAlign(i.footerAlign),t.textBaseline="middle",o=toFont(i.footerFont),t.fillStyle=i.footerColor,t.font=o.string,a=0;a<s;++a)t.fillText(r[a],h.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+i.footerSpacing}}drawBackground(e,t,i,r){const{xAlign:s,yAlign:o}=this,{x:a,y:h}=e,{width:d,height:u}=i,{topLeft:m,topRight:v,bottomLeft:_,bottomRight:D}=toTRBLCorners(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(a+m,h),o==="top"&&this.drawCaret(e,t,i,r),t.lineTo(a+d-v,h),t.quadraticCurveTo(a+d,h,a+d,h+v),o==="center"&&s==="right"&&this.drawCaret(e,t,i,r),t.lineTo(a+d,h+u-D),t.quadraticCurveTo(a+d,h+u,a+d-D,h+u),o==="bottom"&&this.drawCaret(e,t,i,r),t.lineTo(a+_,h+u),t.quadraticCurveTo(a,h+u,a,h+u-_),o==="center"&&s==="left"&&this.drawCaret(e,t,i,r),t.lineTo(a,h+m),t.quadraticCurveTo(a,h,a+m,h),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const o=positioners[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=getTooltipSize(this,e),h=Object.assign({},o,this._size),d=determineAlignment(t,e,h),u=getBackgroundPoint(e,h,d,t);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=toPadding(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=i,this.drawBackground(s,e,r,t),overrideTextDirection(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),restoreTextDirection(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,r=e.map(({datasetIndex:a,index:h})=>{const d=this.chart.getDatasetMeta(a);if(!d)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:d.data[h],index:h}}),s=!_elementsEqual(i,r),o=this._positionChanged(r,t);(s||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,i),a=this._positionChanged(o,e),h=t||!_elementsEqual(o,s)||a;return h&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),h}_getActiveElements(e,t,i,r){const s=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,i);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:i,caretY:r,options:s}=this,o=positioners[s.position].call(this,e,t);return o!==!1&&(i!==o.x||r!==o.y)}}je(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(n,e,t){t&&(n.tooltip=new Tooltip({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},plugins=Object.freeze({__proto__:null,Colors:plugin_colors,Decimation:plugin_decimation,Filler:index,Legend:plugin_legend,SubTitle:plugin_subtitle,Title:plugin_title,Tooltip:plugin_tooltip});const addIfString=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function findOrAddLabel(n,e,t,i){const r=n.indexOf(e);if(r===-1)return addIfString(n,e,t,i);const s=n.lastIndexOf(e);return r!==s?t:r}const validIndex=(n,e)=>n===null?null:_limitValue(Math.round(n),0,e);function _getLabelForValue(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class CategoryScale extends Scale{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:r,label:s}of t)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(isNullOrUndef(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:findOrAddLabel(i,e,valueOrDefault(t,e),this._addedLabels),validIndex(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return _getLabelForValue.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}je(CategoryScale,"id","category"),je(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(n,e){const t=[],{bounds:r,step:s,min:o,max:a,precision:h,count:d,maxTicks:u,maxDigits:m,includeBounds:v}=n,_=s||1,D=u-1,{min:f,max:l}=e,c=!isNullOrUndef(o),p=!isNullOrUndef(a),b=!isNullOrUndef(d),E=(l-f)/(m+1);let C=niceNum((l-f)/D/_)*_,g,x,y,w;if(C<1e-14&&!c&&!p)return[{value:f},{value:l}];w=Math.ceil(l/C)-Math.floor(f/C),w>D&&(C=niceNum(w*C/D/_)*_),isNullOrUndef(h)||(g=Math.pow(10,h),C=Math.ceil(C*g)/g),r==="ticks"?(x=Math.floor(f/C)*C,y=Math.ceil(l/C)*C):(x=f,y=l),c&&p&&s&&almostWhole((a-o)/s,C/1e3)?(w=Math.round(Math.min((a-o)/C,u)),C=(a-o)/w,x=o,y=a):b?(x=c?o:x,y=p?a:y,w=d-1,C=(y-x)/w):(w=(y-x)/C,almostEquals(w,Math.round(w),C/1e3)?w=Math.round(w):w=Math.ceil(w));const M=Math.max(_decimalPlaces(C),_decimalPlaces(x));g=Math.pow(10,isNullOrUndef(h)?M:h),x=Math.round(x*g)/g,y=Math.round(y*g)/g;let S=0;for(c&&(v&&x!==o?(t.push({value:o}),x<o&&S++,almostEquals(Math.round((x+S*C)*g)/g,o,relativeLabelSize(o,E,n))&&S++):x<o&&S++);S<w;++S){const O=Math.round((x+S*C)*g)/g;if(p&&O>a)break;t.push({value:O})}return p&&v&&y!==a?t.length&&almostEquals(t[t.length-1].value,a,relativeLabelSize(a,E,n))?t[t.length-1].value=a:t.push({value:a}):(!p||y===a)&&t.push({value:y}),t}function relativeLabelSize(n,e,{horizontal:t,minRotation:i}){const r=toRadians(i),s=(t?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}class LinearScaleBase extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const o=h=>r=t?r:h,a=h=>s=i?s:h;if(e){const h=sign(r),d=sign(s);h<0&&d<0?a(0):h>0&&d>0&&o(0)}if(r===s){let h=s===0?1:Math.abs(s*.05);a(s+h),e||o(r-h)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=generateTicks$1(r,s);return e.bounds==="ticks"&&_setMinAndMaxByKey(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=toRadians(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}je(LinearScale,"id","linear"),je(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const log10Floor=n=>Math.floor(log10(n)),changeExponent=(n,e)=>Math.pow(10,log10Floor(n)+e);function isMajor(n){return n/Math.pow(10,log10Floor(n))===1}function steps(n,e,t){const i=Math.pow(10,t),r=Math.floor(n/i);return Math.ceil(e/i)-r}function startExp(n,e){const t=e-n;let i=log10Floor(t);for(;steps(n,e,i)>10;)i++;for(;steps(n,e,i)<10;)i--;return Math.min(i,log10Floor(n))}function generateTicks(n,{min:e,max:t}){e=finiteOrDefault(n.min,e);const i=[],r=log10Floor(e);let s=startExp(e,t),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),h=r>s?Math.pow(10,r):0,d=Math.round((e-h)*o)/o,u=Math.floor((e-h)/a/10)*a*10;let m=Math.floor((d-u)/Math.pow(10,s)),v=finiteOrDefault(n.min,Math.round((h+u+m*Math.pow(10,s))*o)/o);for(;v<t;)i.push({value:v,major:isMajor(v),significand:m}),m>=10?m=m<15?15:20:m++,m>=20&&(s++,m=2,o=s>=0?1:o),v=Math.round((h+u+m*Math.pow(10,s))*o)/o;const _=finiteOrDefault(n.max,v);return i.push({value:_,major:isMajor(_),significand:m}),i}class LogarithmicScale extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=LinearScaleBase.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return isNumberFinite(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?Math.max(0,e):null,this.max=isNumberFinite(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!isNumberFinite(this._userMin)&&(this.min=e===changeExponent(this.min,0)?changeExponent(this.min,-1):changeExponent(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,r=this.max;const s=a=>i=e?i:a,o=a=>r=t?r:a;i===r&&(i<=0?(s(1),o(10)):(s(changeExponent(i,-1)),o(changeExponent(r,1)))),i<=0&&s(changeExponent(r,-1)),r<=0&&o(changeExponent(i,1)),this.min=i,this.max=r}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=generateTicks(t,this);return e.bounds==="ticks"&&_setMinAndMaxByKey(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":formatNumber(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=log10(e),this._valueRange=log10(this.max)-log10(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(log10(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}je(LogarithmicScale,"id","logarithmic"),je(LogarithmicScale,"defaults",{ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}});function getTickBackdropHeight(n){const e=n.ticks;if(e.display&&n.display){const t=toPadding(e.backdropPadding);return valueOrDefault(e.font&&e.font.size,defaults.font.size)+t.height}return 0}function measureLabelSize(n,e,t){return t=isArray(t)?t:[t],{w:_longestText(n,e.string,t),h:t.length*e.lineHeight}}function determineLimits(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function fitWithPointLabels(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],s=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?PI/s:0;for(let h=0;h<s;h++){const d=o.setContext(n.getPointLabelContext(h));r[h]=d.padding;const u=n.getPointPosition(h,n.drawingArea+r[h],a),m=toFont(d.font),v=measureLabelSize(n.ctx,m,n._pointLabels[h]);i[h]=v;const _=_normalizeAngle(n.getIndexAngle(h)+a),D=Math.round(toDegrees(_)),f=determineLimits(D,u.x,v.w,0,180),l=determineLimits(D,u.y,v.h,90,270);updateLimits(t,e,_,f,l)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=buildPointLabelItems(n,i,r)}function updateLimits(n,e,t,i,r){const s=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t));let a=0,h=0;i.start<e.l?(a=(e.l-i.start)/s,n.l=Math.min(n.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/s,n.r=Math.max(n.r,e.r+a)),r.start<e.t?(h=(e.t-r.start)/o,n.t=Math.min(n.t,e.t-h)):r.end>e.b&&(h=(r.end-e.b)/o,n.b=Math.max(n.b,e.b+h))}function createPointLabelItem(n,e,t){const i=n.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=t,h=n.getPointPosition(e,i+r+o,s),d=Math.round(toDegrees(_normalizeAngle(h.angle+HALF_PI))),u=yForAngle(h.y,a.h,d),m=getTextAlignForAngle(d),v=leftForTextAlign(h.x,a.w,m);return{visible:!0,x:h.x,y:u,textAlign:m,left:v,top:u,right:v+a.w,bottom:u+a.h}}function isNotOverlapped(n,e){if(!e)return!0;const{left:t,top:i,right:r,bottom:s}=n;return!(_isPointInArea({x:t,y:i},e)||_isPointInArea({x:t,y:s},e)||_isPointInArea({x:r,y:i},e)||_isPointInArea({x:r,y:s},e))}function buildPointLabelItems(n,e,t){const i=[],r=n._pointLabels.length,s=n.options,{centerPointLabels:o,display:a}=s.pointLabels,h={extra:getTickBackdropHeight(s)/2,additionalAngle:o?PI/r:0};let d;for(let u=0;u<r;u++){h.padding=t[u],h.size=e[u];const m=createPointLabelItem(n,u,h);i.push(m),a==="auto"&&(m.visible=isNotOverlapped(m,d),m.visible&&(d=m))}return i}function getTextAlignForAngle(n){return n===0||n===180?"center":n<180?"left":"right"}function leftForTextAlign(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function yForAngle(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function drawPointLabelBox(n,e,t){const{left:i,top:r,right:s,bottom:o}=t,{backdropColor:a}=e;if(!isNullOrUndef(a)){const h=toTRBLCorners(e.borderRadius),d=toPadding(e.backdropPadding);n.fillStyle=a;const u=i-d.left,m=r-d.top,v=s-i+d.width,_=o-r+d.height;Object.values(h).some(D=>D!==0)?(n.beginPath(),addRoundedRectPath(n,{x:u,y:m,w:v,h:_,radius:h}),n.fill()):n.fillRect(u,m,v,_)}}function drawPointLabels(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){const s=n._pointLabelItems[r];if(!s.visible)continue;const o=i.setContext(n.getPointLabelContext(r));drawPointLabelBox(t,o,s);const a=toFont(o.font),{x:h,y:d,textAlign:u}=s;renderText(t,n._pointLabels[r],h,d+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function pathRadiusLine(n,e,t,i){const{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,TAU);else{let s=n.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=n.getPointPosition(o,e),r.lineTo(s.x,s.y)}}function drawRadiusLine(n,e,t,i,r){const s=n.ctx,o=e.circular,{color:a,lineWidth:h}=e;!o&&!i||!a||!h||t<0||(s.save(),s.strokeStyle=a,s.lineWidth=h,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),pathRadiusLine(n,t,o,i),s.closePath(),s.stroke(),s.restore())}function createPointLabelContext(n,e,t){return createContext(n,{label:t,index:e,type:"pointLabel"})}class RadialLinearScale extends LinearScaleBase{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=toPadding(getTickBackdropHeight(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=isNumberFinite(e)&&!isNaN(e)?e:0,this.max=isNumberFinite(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(e){LinearScaleBase.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=callback(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?fitWithPointLabels(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=TAU/(this._pointLabels.length||1),i=this.options.startAngle||0;return _normalizeAngle(e*t+toRadians(i))}getDistanceFromCenterForValue(e){if(isNullOrUndef(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(isNullOrUndef(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return createPointLabelContext(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-HALF_PI+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:s}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),pathRadiusLine(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r,border:s}=t,o=this._pointLabels.length;let a,h,d;if(t.pointLabels.display&&drawPointLabels(this,o),r.display&&this.ticks.forEach((u,m)=>{if(m!==0||m===0&&this.min<0){h=this.getDistanceFromCenterForValue(u.value);const v=this.getContext(m),_=r.setContext(v),D=s.setContext(v);drawRadiusLine(this,_,h,o,D)}}),i.display){for(e.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:m,lineWidth:v}=u;!v||!m||(e.lineWidth=v,e.strokeStyle=m,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,h=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),d=this.getPointPosition(a,h),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,h)=>{if(h===0&&this.min>=0&&!t.reverse)return;const d=i.setContext(this.getContext(h)),u=toFont(d.font);if(s=this.getDistanceFromCenterForValue(this.ticks[h].value),d.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=d.backdropColor;const m=toPadding(d.backdropPadding);e.fillRect(-o/2-m.left,-s-u.size/2-m.top,o+m.width,u.size+m.height)}renderText(e,a.label,0,-s,u,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}}je(RadialLinearScale,"id","radialLinear"),je(RadialLinearScale,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),je(RadialLinearScale,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),je(RadialLinearScale,"descriptors",{angleLines:{_fallback:"grid"}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(n,e){return n-e}function parse(n,e){if(isNullOrUndef(e))return null;const t=n._adapter,{parser:i,round:r,isoWeekday:s}=n._parseOpts;let o=e;return typeof i=="function"&&(o=i(o)),isNumberFinite(o)||(o=typeof i=="string"?t.parse(o,i):t.parse(o)),o===null?null:(r&&(o=r==="week"&&(isNumber(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,r)),+o)}function determineUnitForAutoTicks(n,e,t,i){const r=UNITS.length;for(let s=UNITS.indexOf(n);s<r-1;++s){const o=INTERVALS[UNITS[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=i)return UNITS[s]}return UNITS[r-1]}function determineUnitForFormatting(n,e,t,i,r){for(let s=UNITS.length-1;s>=UNITS.indexOf(t);s--){const o=UNITS[s];if(INTERVALS[o].common&&n._adapter.diff(r,i,o)>=e-1)return o}return UNITS[t?UNITS.indexOf(t):0]}function determineMajorUnit(n){for(let e=UNITS.indexOf(n)+1,t=UNITS.length;e<t;++e)if(INTERVALS[UNITS[e]].common)return UNITS[e]}function addTick(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=_lookup(t,e),s=t[i]>=e?t[i]:t[r];n[s]=!0}}function setMajorTicks(n,e,t,i){const r=n._adapter,s=+r.startOf(e[0].value,i),o=e[e.length-1].value;let a,h;for(a=s;a<=o;a=+r.add(a,1,i))h=t[a],h>=0&&(e[h].major=!0);return e}function ticksFromTimestamps(n,e,t){const i=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,i.push({value:a,major:!1});return s===0||!t?i:setMajorTicks(n,i,r,t)}class TimeScale extends Scale{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),r=this._adapter=new adapters._date(e.adapters.date);r.init(t),mergeIf(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:parse(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function h(d){!o&&!isNaN(d.min)&&(r=Math.min(r,d.min)),!a&&!isNaN(d.max)&&(s=Math.max(s,d.max))}(!o||!a)&&(h(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&h(this.getMinMax(!1))),r=isNumberFinite(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),s=isNumberFinite(s)&&!isNaN(s)?s:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=_filterBetween(r,s,o);return this._unit=t.unit||(i.autoSkip?determineUnitForAutoTicks(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):determineUnitForFormatting(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),ticksFromTimestamps(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=_limitValue(t,0,o),i=_limitValue(i,0,o),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,s=r.time,o=s.unit||determineUnitForAutoTicks(s.minUnit,t,i,this._getLabelCapacity(t)),a=valueOrDefault(r.ticks.stepSize,1),h=o==="week"?s.isoWeekday:!1,d=isNumber(h)||h===!0,u={};let m=t,v,_;if(d&&(m=+e.startOf(m,"isoWeek",h)),m=+e.startOf(m,d?"day":o),e.diff(i,t,o)>1e5*a)throw new Error(t+" and "+i+" are too far apart with stepSize of "+a+" "+o);const D=r.ticks.source==="data"&&this.getDataTimestamps();for(v=m,_=0;v<i;v=+e.add(v,a,o),_++)addTick(u,v,D);return(v===i||r.bounds==="ticks"||_===1)&&addTick(u,v,D),Object.keys(u).sort(sorter).map(f=>+f)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,s=this._unit,o=t||r[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,i,r){const s=this.options,o=s.ticks.callback;if(o)return callback(o,[e,t,i],this);const a=s.time.displayFormats,h=this._unit,d=this._majorUnit,u=h&&a[h],m=d&&a[d],v=i[t],_=d&&m&&v&&v.major;return this._adapter.format(e,r||(_?m:u))}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,s=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),r),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(parse(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}}je(TimeScale,"id","time"),je(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(n,e,t){let i=0,r=n.length-1,s,o,a,h;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=_lookupByKey(n,"pos",e)),{pos:s,time:a}=n[i],{pos:o,time:h}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=_lookupByKey(n,"time",e)),{time:s,pos:a}=n[i],{time:o,pos:h}=n[r]);const d=o-s;return d?a+(h-a)*(e-s)/d:a}class TimeSeriesScale extends TimeScale{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=interpolate(t,this.min),this._tableRange=interpolate(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],s=[];let o,a,h,d,u;for(o=0,a=e.length;o<a;++o)d=e[o],d>=t&&d<=i&&r.push(d);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],h=r[o-1],d=r[o],Math.round((u+h)/2)!==d&&s.push({time:d,pos:o/(a-1)});return s}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return interpolate(this._table,i*this._tableRange+this._minPos,!0)}}je(TimeSeriesScale,"id","timeseries"),je(TimeSeriesScale,"defaults",TimeScale.defaults);var scales=Object.freeze({__proto__:null,CategoryScale,LinearScale,LogarithmicScale,RadialLinearScale,TimeScale,TimeSeriesScale});const registerables=[controllers,elements,plugins,scales];gsapWithCSS.registerPlugin(ScrollTrigger,TextPlugin);Chart.register(...registerables);const GENE_TARGETS=["APOE4","PSEN1","APP","TREM2"],SELECTED_TARGET="APOE4",PROTOCOL_TEXT=`[BEGIN PROTOCOL: CANDIDATE_A7-22_SYNTHESIS]<br>
-------------------------------------------- <br>
1.  Prepare Reagents:<br>
    - Thaw Candidate #A7-22 plasmid (50 ng/L).<br>
    - Prepare 500 mL of LB media. <br>
2.  Transformation:<br>
    - Add 2 L of plasmid to 50 L of E. coli cells.<br>
    - Heat shock at 42C for 45 seconds.<br>
3.  Expression:<br>
    - Inoculate 100 mL of LB media.<br>
    - Grow at 37C until OD600 reaches 0.6.<br>
    - Induce with 1 mM IPTG.<br>
4.  Purification:<br>
    - Harvest cells via centrifugation.<br>
    - Purify using Ni-NTA chromatography.<br>
5.  Validation:<br>
    - Confirm via SDS-PAGE.<br>
    - Store at -80C.<br>
--------------------------------------------<br>
[END PROTOCOL]`;let validationChart=null,viewerInstance=null;function create3DViewer(){if(viewerInstance){viewerInstance.spin(!0);return}try{const n=document.querySelector("#protein-viewer");if(!n)return;n.innerHTML="";const e=_3DmolExports.createViewer(n,{backgroundColor:"black"});fetch("https://github.com/alirezahekmati/ai-drug-discovery-page/models/1b68.pdb").then(t=>t.text()).then(t=>{e.addModel(t,"pdb"),e.setStyle({},{cartoon:{color:"spectrum"}}),e.zoomTo(),e.render(),e.zoom(1.2,1e3),e.spin(!0),viewerInstance=e}).catch(t=>console.error("PDB loading failed:",t))}catch(n){console.error("3D viewer init failed:",n)}}function stop3DViewer(){viewerInstance&&viewerInstance.spin(!1)}function createValidationChart(){const n=document.getElementById("validation-chart");if(!n)return;validationChart&&validationChart.destroy();const e={labels:["Binding Affinity","Stability","Specificity","Solubility","Novelty"],datasets:[{label:"Score",data:[95,88,75,92,85],backgroundColor:"rgba(0, 255, 255, 0.2)",borderColor:"rgba(0, 255, 255, 1)",pointBackgroundColor:"rgba(0, 255, 255, 1)"}]},t={scales:{r:{angleLines:{color:"rgba(255, 255, 255, 0.2)"},grid:{color:"rgba(255, 255, 255, 0.2)"},pointLabels:{color:"#e0e0e0",font:{size:14,family:"'Space Grotesk', sans-serif"}},ticks:{display:!1},suggestedMin:0,suggestedMax:100}},plugins:{legend:{display:!1}},animation:{duration:1500}};validationChart=new Chart(n,{type:"radar",data:e,options:t})}function typeProtocol(){const n=document.querySelector(".protocol-body code");n&&(n.classList.remove("typing-complete"),gsapWithCSS.to(n,{duration:8,text:PROTOCOL_TEXT,ease:"none"}))}async function main(){await loadSlim(tsParticles),await tsParticles.load({id:"tsparticles",options:{background:{color:{value:"#0d0d1a"}},fpsLimit:60,interactivity:{events:{onHover:{enable:!0,mode:"grab"},onClick:{enable:!0,mode:"push"}},modes:{grab:{distance:140,links:{opacity:1}},push:{quantity:4}}},particles:{color:{value:"#ffffff"},links:{color:"#ffffff",distance:150,enable:!0,opacity:.1,width:1},collisions:{enable:!0},move:{direction:"none",enable:!0,outModes:"out",random:!1,speed:.5,straight:!1},number:{density:{enable:!0},value:80},opacity:{value:.2},shape:{type:"circle"},size:{value:{min:1,max:3}}},detectRetina:!0}}),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-1",start:"top bottom",end:"top top",scrub:1}}).to([".title",".subtitle",".scroll-down-indicator",".genesis-particle"],{opacity:0,y:-30,stagger:.1}).to(".terminal-window",{opacity:1,scale:1,duration:1},">-0.5"),ScrollTrigger.create({trigger:"#section-1",start:"top center",once:!0,onEnter:()=>{gsapWithCSS.to("#terminal-text",{duration:3,text:"> Please identify therapeutic targets associated with Alzheimer's disease and propose potential drug candidates aimed at addressing these targets. <br>><br>>Initializing query...<br>> Found 4 potential targets. <br>> APOE4 seems the best one between them",ease:"none",onComplete:()=>{const n=document.querySelector(".targets-container");n.innerHTML="",GENE_TARGETS.forEach(e=>{const t=document.createElement("div");t.className="gene-target",t.innerText=e,e===SELECTED_TARGET&&t.classList.add("selected"),n.appendChild(t)}),gsapWithCSS.to(".gene-target",{opacity:1,y:0,duration:.5,stagger:.2,onComplete:()=>{gsapWithCSS.to(".gene-target.selected",{repeat:-1,yoyo:!0,scale:1.1,duration:.8,borderColor:"#ff00ff",color:"#ff00ff"})}})}})}}),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-2",start:"top bottom",end:"top top",scrub:1,onEnter:()=>create3DViewer(),onLeave:()=>stop3DViewer(),onEnterBack:()=>create3DViewer(),onLeaveBack:()=>stop3DViewer()}}).to([".terminal-window",".targets-container"],{opacity:0,scale:.9}).to(".viewer-container",{opacity:1,scale:1,duration:1},">-0.5"),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-3",start:"top bottom",end:"top top",scrub:1}}).to(".viewer-container",{opacity:0,scale:.9}).to(".validation-container",{opacity:1,y:0,duration:1},">-0.5").call(createValidationChart,[],">"),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-4",start:"top center",once:!0}}).to(".validation-container",{opacity:0,y:-50,duration:.5}).to(".protocol-container",{opacity:1,scale:1,duration:1,ease:"power2.out"},">-0.5").call(typeProtocol,[],">-0.5")}document.addEventListener("DOMContentLoaded",main);
