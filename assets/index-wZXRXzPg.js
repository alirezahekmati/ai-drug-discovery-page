var Gs=Object.defineProperty;var Hs=(r,e,t)=>e in r?Gs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $e=(r,e,t)=>Hs(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const generatedAttribute="generated",mouseDownEvent="pointerdown",mouseUpEvent="pointerup",mouseLeaveEvent="pointerleave",mouseOutEvent="pointerout",mouseMoveEvent="pointermove",touchStartEvent="touchstart",touchEndEvent="touchend",touchMoveEvent="touchmove",touchCancelEvent="touchcancel",resizeEvent="resize",visibilityChangeEvent="visibilitychange",errorPrefix="tsParticles - Error";class Vector3d{constructor(e,t,i){if(this._updateFromAngle=(n,s)=>{this.x=Math.cos(n)*s,this.y=Math.sin(n)*s},!isNumber$1(e)&&e){this.x=e.x,this.y=e.y;const n=e;this.z=n.z?n.z:0}else if(e!==void 0&&t!==void 0)this.x=e,this.y=t,this.z=i??0;else throw new Error(`${errorPrefix} Vector3d not initialized correctly`)}static get origin(){return Vector3d.create(0,0,0)}get angle(){return Math.atan2(this.y,this.x)}set angle(e){this._updateFromAngle(e,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(e){this._updateFromAngle(this.angle,e)}static clone(e){return Vector3d.create(e.x,e.y,e.z)}static create(e,t,i){return new Vector3d(e,t,i)}add(e){return Vector3d.create(this.x+e.x,this.y+e.y,this.z+e.z)}addTo(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}copy(){return Vector3d.clone(this)}distanceTo(e){return this.sub(e).length}distanceToSq(e){return this.sub(e).getLengthSq()}div(e){return Vector3d.create(this.x/e,this.y/e,this.z/e)}divTo(e){this.x/=e,this.y/=e,this.z/=e}getLengthSq(){return this.x**2+this.y**2}mult(e){return Vector3d.create(this.x*e,this.y*e,this.z*e)}multTo(e){this.x*=e,this.y*=e,this.z*=e}normalize(){const e=this.length;e!=0&&this.multTo(1/e)}rotate(e){return Vector3d.create(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e),0)}setTo(e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:0}sub(e){return Vector3d.create(this.x-e.x,this.y-e.y,this.z-e.z)}subFrom(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}class Vector extends Vector3d{constructor(e,t){super(e,t,0)}static get origin(){return Vector.create(0,0)}static clone(e){return Vector.create(e.x,e.y)}static create(e,t){return new Vector(e,t)}}let _random=Math.random;const easings=new Map;function addEasing(r,e){easings.get(r)||easings.set(r,e)}function getEasing(r){return easings.get(r)||(e=>e)}function getRandom(){return clamp$1(_random(),0,1-1e-16)}function clamp$1(r,e,t){return Math.min(Math.max(r,e),t)}function mix(r,e,t,i){return Math.floor((r*t+e*i)/(t+i))}function randomInRange(r){const e=getRangeMax(r);let t=getRangeMin(r);return e===t&&(t=0),getRandom()*(e-t)+t}function getRangeValue(r){return isNumber$1(r)?r:randomInRange(r)}function getRangeMin(r){return isNumber$1(r)?r:r.min}function getRangeMax(r){return isNumber$1(r)?r:r.max}function setRangeValue(r,e){if(r===e||e===void 0&&isNumber$1(r))return r;const t=getRangeMin(r),i=getRangeMax(r);return e!==void 0?{min:Math.min(t,e),max:Math.max(i,e)}:setRangeValue(t,i)}function getValue(r){const e=r.random,{enable:t,minimumValue:i}=isBoolean(e)?{enable:e,minimumValue:0}:e;return getRangeValue(t?setRangeValue(r.value,i):r.value)}function getDistances(r,e){const t=r.x-e.x,i=r.y-e.y;return{dx:t,dy:i,distance:Math.sqrt(t**2+i**2)}}function getDistance(r,e){return getDistances(r,e).distance}function getParticleDirectionAngle(r,e,t){if(isNumber$1(r))return r*Math.PI/180;switch(r){case"top":return-Math.PI/2;case"top-right":return-Math.PI/4;case"right":return 0;case"bottom-right":return Math.PI/4;case"bottom":return Math.PI/2;case"bottom-left":return 3*Math.PI/4;case"left":return Math.PI;case"top-left":return-3*Math.PI/4;case"inside":return Math.atan2(t.y-e.y,t.x-e.x);case"outside":return Math.atan2(e.y-t.y,e.x-t.x);default:return getRandom()*Math.PI*2}}function getParticleBaseVelocity(r){const e=Vector.origin;return e.length=1,e.angle=r,e}function collisionVelocity(r,e,t,i){return Vector.create(r.x*(t-i)/(t+i)+e.x*2*i/(t+i),r.y)}function calcExactPositionOrRandomFromSize(r){var e,t;return{x:((e=r.position)==null?void 0:e.x)??getRandom()*r.size.width,y:((t=r.position)==null?void 0:t.y)??getRandom()*r.size.height}}function parseAlpha(r){return r?r.endsWith("%")?parseFloat(r)/100:parseFloat(r):1}const _logger={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function getLogger(){return _logger}function rectSideBounce(r){const e={bounced:!1},{pSide:t,pOtherSide:i,rectSide:n,rectOtherSide:s,velocity:o,factor:a}=r;return i.min<s.min||i.min>s.max||i.max<s.min||i.max>s.max||(t.max>=n.min&&t.max<=(n.max+n.min)/2&&o>0||t.min<=n.max&&t.min>(n.max+n.min)/2&&o<0)&&(e.velocity=o*-a,e.bounced=!0),e}function checkSelector(r,e){const t=executeOnSingleOrMultiple(e,i=>r.matches(i));return isArray$1(t)?t.some(i=>i):t}function isSsr(){return typeof window>"u"||!window||typeof window.document>"u"||!window.document}function hasMatchMedia(){return!isSsr()&&typeof matchMedia<"u"}function safeMatchMedia(r){if(hasMatchMedia())return matchMedia(r)}function safeMutationObserver(r){if(!(isSsr()||typeof MutationObserver>"u"))return new MutationObserver(r)}function isInArray(r,e){return r===e||isArray$1(e)&&e.indexOf(r)>-1}async function loadFont(r,e){try{await document.fonts.load(`${e??"400"} 36px '${r??"Verdana"}'`)}catch{}}function arrayRandomIndex(r){return Math.floor(getRandom()*r.length)}function itemFromArray(r,e,t=!0){return r[e!==void 0&&t?e%r.length:arrayRandomIndex(r)]}function isPointInside(r,e,t,i,n){return areBoundsInside(calculateBounds(r,i??0),e,t,n)}function areBoundsInside(r,e,t,i){let n=!0;return(!i||i==="bottom")&&(n=r.top<e.height+t.x),n&&(!i||i==="left")&&(n=r.right>t.x),n&&(!i||i==="right")&&(n=r.left<e.width+t.y),n&&(!i||i==="top")&&(n=r.bottom>t.y),n}function calculateBounds(r,e){return{bottom:r.y+e,left:r.x-e,right:r.x+e,top:r.y-e}}function deepExtend(r,...e){for(const t of e){if(t==null)continue;if(!isObject$1(t)){r=t;continue}const i=Array.isArray(t);i&&(isObject$1(r)||!r||!Array.isArray(r))?r=[]:!i&&(isObject$1(r)||!r||Array.isArray(r))&&(r={});for(const n in t){if(n==="__proto__")continue;const s=t,o=s[n],a=r;a[n]=isObject$1(o)&&Array.isArray(o)?o.map(l=>deepExtend(a[n],l)):deepExtend(a[n],o)}}return r}function isDivModeEnabled(r,e){return!!findItemFromSingleOrMultiple(e,t=>t.enable&&isInArray(r,t.mode))}function divModeExecute(r,e,t){executeOnSingleOrMultiple(e,i=>{const n=i.mode;i.enable&&isInArray(r,n)&&singleDivModeExecute(i,t)})}function singleDivModeExecute(r,e){const t=r.selectors;executeOnSingleOrMultiple(t,i=>{e(i,r)})}function divMode(r,e){if(!(!e||!r))return findItemFromSingleOrMultiple(r,t=>checkSelector(e,t.selectors))}function circleBounceDataFromParticle(r){return{position:r.getPosition(),radius:r.getRadius(),mass:r.getMass(),velocity:r.velocity,factor:Vector.create(getValue(r.options.bounce.horizontal),getValue(r.options.bounce.vertical))}}function circleBounce(r,e){const{x:t,y:i}=r.velocity.sub(e.velocity),[n,s]=[r.position,e.position],{dx:o,dy:a}=getDistances(s,n);if(t*o+i*a<0)return;const l=-Math.atan2(a,o),h=r.mass,u=e.mass,g=r.velocity.rotate(l),m=e.velocity.rotate(l),_=collisionVelocity(g,m,h,u),b=collisionVelocity(m,g,h,u),d=_.rotate(-l),c=b.rotate(-l);r.velocity.x=d.x*r.factor.x,r.velocity.y=d.y*r.factor.y,e.velocity.x=c.x*e.factor.x,e.velocity.y=c.y*e.factor.y}function rectBounce(r,e){const t=r.getPosition(),i=r.getRadius(),n=calculateBounds(t,i),s=rectSideBounce({pSide:{min:n.left,max:n.right},pOtherSide:{min:n.top,max:n.bottom},rectSide:{min:e.left,max:e.right},rectOtherSide:{min:e.top,max:e.bottom},velocity:r.velocity.x,factor:getValue(r.options.bounce.horizontal)});s.bounced&&(s.velocity!==void 0&&(r.velocity.x=s.velocity),s.position!==void 0&&(r.position.x=s.position));const o=rectSideBounce({pSide:{min:n.top,max:n.bottom},pOtherSide:{min:n.left,max:n.right},rectSide:{min:e.top,max:e.bottom},rectOtherSide:{min:e.left,max:e.right},velocity:r.velocity.y,factor:getValue(r.options.bounce.vertical)});o.bounced&&(o.velocity!==void 0&&(r.velocity.y=o.velocity),o.position!==void 0&&(r.position.y=o.position))}function executeOnSingleOrMultiple(r,e){return isArray$1(r)?r.map((t,i)=>e(t,i)):e(r,0)}function itemFromSingleOrMultiple(r,e,t){return isArray$1(r)?itemFromArray(r,e,t):r}function findItemFromSingleOrMultiple(r,e){return isArray$1(r)?r.find((t,i)=>e(t,i)):e(r,0)?r:void 0}function initParticleNumericAnimationValue(r,e){const t=r.value,i=r.animation,n={delayTime:getRangeValue(i.delay)*1e3,enable:i.enable,value:getRangeValue(r.value)*e,max:getRangeMax(t)*e,min:getRangeMin(t)*e,loops:0,maxLoops:getRangeValue(i.count),time:0};if(i.enable){switch(n.decay=1-getRangeValue(i.decay),i.mode){case"increase":n.status="increasing";break;case"decrease":n.status="decreasing";break;case"random":n.status=getRandom()>=.5?"increasing":"decreasing";break}const s=i.mode==="auto";switch(i.startValue){case"min":n.value=n.min,s&&(n.status="increasing");break;case"max":n.value=n.max,s&&(n.status="decreasing");break;case"random":default:n.value=randomInRange(n),s&&(n.status=getRandom()>=.5?"increasing":"decreasing");break}}return n.initialValue=n.value,n}function getPositionOrSize(r,e){if(!(r.mode==="percent")){const{mode:n,...s}=r;return s}return"x"in r?{x:r.x/100*e.width,y:r.y/100*e.height}:{width:r.width/100*e.width,height:r.height/100*e.height}}function getPosition(r,e){return getPositionOrSize(r,e)}function isBoolean(r){return typeof r=="boolean"}function isString(r){return typeof r=="string"}function isNumber$1(r){return typeof r=="number"}function isFunction$1(r){return typeof r=="function"}function isObject$1(r){return typeof r=="object"&&r!==null}function isArray$1(r){return Array.isArray(r)}const randomColorValue="random",midColorValue="mid",colorManagers=new Map;function addColorManager(r){colorManagers.set(r.key,r)}function hue2rgb(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function stringToRgba(r){for(const[,s]of colorManagers)if(r.startsWith(s.stringPrefix))return s.parseString(r);const e=/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,t=r.replace(e,(s,o,a,l,h)=>o+o+a+a+l+l+(h!==void 0?h+h:"")),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i,n=i.exec(t);return n?{a:n[4]!==void 0?parseInt(n[4],16)/255:1,b:parseInt(n[3],16),g:parseInt(n[2],16),r:parseInt(n[1],16)}:void 0}function rangeColorToRgb(r,e,t=!0){if(!r)return;const i=isString(r)?{value:r}:r;if(isString(i.value))return colorToRgb(i.value,e,t);if(isArray$1(i.value))return rangeColorToRgb({value:itemFromArray(i.value,e,t)});for(const[,n]of colorManagers){const s=n.handleRangeColor(i);if(s)return s}}function colorToRgb(r,e,t=!0){if(!r)return;const i=isString(r)?{value:r}:r;if(isString(i.value))return i.value===randomColorValue?getRandomRgbColor():stringToRgb(i.value);if(isArray$1(i.value))return colorToRgb({value:itemFromArray(i.value,e,t)});for(const[,n]of colorManagers){const s=n.handleColor(i);if(s)return s}}function rangeColorToHsl(r,e,t=!0){const i=rangeColorToRgb(r,e,t);return i?rgbToHsl(i):void 0}function rgbToHsl(r){const e=r.r/255,t=r.g/255,i=r.b/255,n=Math.max(e,t,i),s=Math.min(e,t,i),o={h:0,l:(n+s)/2,s:0};return n!==s&&(o.s=o.l<.5?(n-s)/(n+s):(n-s)/(2-n-s),o.h=e===n?(t-i)/(n-s):o.h=t===n?2+(i-e)/(n-s):4+(e-t)/(n-s)),o.l*=100,o.s*=100,o.h*=60,o.h<0&&(o.h+=360),o.h>=360&&(o.h-=360),o}function stringToRgb(r){return stringToRgba(r)}function hslToRgb(r){const e={b:0,g:0,r:0},t={h:r.h/360,l:r.l/100,s:r.s/100};if(!t.s)e.r=e.g=e.b=t.l;else{const i=t.l<.5?t.l*(1+t.s):t.l+t.s-t.l*t.s,n=2*t.l-i;e.r=hue2rgb(n,i,t.h+1/3),e.g=hue2rgb(n,i,t.h),e.b=hue2rgb(n,i,t.h-1/3)}return e.r=Math.floor(e.r*255),e.g=Math.floor(e.g*255),e.b=Math.floor(e.b*255),e}function hslaToRgba(r){const e=hslToRgb(r);return{a:r.a,b:e.b,g:e.g,r:e.r}}function getRandomRgbColor(r){return{b:Math.floor(randomInRange(setRangeValue(0,256))),g:Math.floor(randomInRange(setRangeValue(0,256))),r:Math.floor(randomInRange(setRangeValue(0,256)))}}function getStyleFromRgb(r,e){return`rgba(${r.r}, ${r.g}, ${r.b}, ${e??1})`}function getStyleFromHsl(r,e){return`hsla(${r.h}, ${r.s}%, ${r.l}%, ${e??1})`}function colorMix(r,e,t,i){let n=r,s=e;return n.r===void 0&&(n=hslToRgb(r)),s.r===void 0&&(s=hslToRgb(e)),{b:mix(n.b,s.b,t,i),g:mix(n.g,s.g,t,i),r:mix(n.r,s.r,t,i)}}function getLinkColor(r,e,t){if(t===randomColorValue)return getRandomRgbColor();if(t===midColorValue){const i=r.getFillColor()??r.getStrokeColor(),n=(e==null?void 0:e.getFillColor())??(e==null?void 0:e.getStrokeColor());if(i&&n&&e)return colorMix(i,n,r.getRadius(),e.getRadius());{const s=i??n;if(s)return hslToRgb(s)}}else return t}function getLinkRandomColor(r,e,t){const i=isString(r)?r:r.value;return i===randomColorValue?t?rangeColorToRgb({value:i}):e?randomColorValue:midColorValue:i===midColorValue?midColorValue:rangeColorToRgb({value:i})}function getHslFromAnimation(r){return r!==void 0?{h:r.h.value,s:r.s.value,l:r.l.value}:void 0}function getHslAnimationFromHsl(r,e,t){const i={h:{enable:!1,value:r.h},s:{enable:!1,value:r.s},l:{enable:!1,value:r.l}};return e&&(setColorAnimation(i.h,e.h,t),setColorAnimation(i.s,e.s,t),setColorAnimation(i.l,e.l,t)),i}function setColorAnimation(r,e,t){r.enable=e.enable,r.enable?(r.velocity=getRangeValue(e.speed)/100*t,r.decay=1-getRangeValue(e.decay),r.status="increasing",r.loops=0,r.maxLoops=getRangeValue(e.count),r.time=0,r.delayTime=getRangeValue(e.delay)*1e3,e.sync||(r.velocity*=getRandom(),r.value*=getRandom()),r.initialValue=r.value):r.velocity=0}function drawLine(r,e,t){r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.closePath()}function drawTriangle(r,e,t,i){r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.lineTo(i.x,i.y),r.closePath()}function paintBase(r,e,t){r.fillStyle=t??"rgba(0,0,0,0)",r.fillRect(0,0,e.width,e.height)}function paintImage(r,e,t,i){t&&(r.globalAlpha=i,r.drawImage(t,0,0,e.width,e.height),r.globalAlpha=1)}function clear(r,e){r.clearRect(0,0,e.width,e.height)}function drawParticle(r){const{container:e,context:t,particle:i,delta:n,colorStyles:s,backgroundMask:o,composite:a,radius:l,opacity:h,shadow:u,transform:g}=r,m=i.getPosition(),_=i.rotation+(i.pathRotation?i.velocity.angle:0),b={sin:Math.sin(_),cos:Math.cos(_)},d={a:b.cos*(g.a??1),b:b.sin*(g.b??1),c:-b.sin*(g.c??1),d:b.cos*(g.d??1)};t.setTransform(d.a,d.b,d.c,d.d,m.x,m.y),t.beginPath(),o&&(t.globalCompositeOperation=a);const c=i.shadowColor;u.enable&&c&&(t.shadowBlur=u.blur,t.shadowColor=getStyleFromRgb(c),t.shadowOffsetX=u.offset.x,t.shadowOffsetY=u.offset.y),s.fill&&(t.fillStyle=s.fill);const f=i.strokeWidth??0;t.lineWidth=f,s.stroke&&(t.strokeStyle=s.stroke),drawShape(e,t,i,l,h,n),f>0&&t.stroke(),i.close&&t.closePath(),i.fill&&t.fill(),drawShapeAfterEffect(e,t,i,l,h,n),t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0)}function drawShape(r,e,t,i,n,s){if(!t.shape)return;const o=r.drawers.get(t.shape);o&&o.draw(e,t,i,n,s,r.retina.pixelRatio)}function drawShapeAfterEffect(r,e,t,i,n,s){if(!t.shape)return;const o=r.drawers.get(t.shape);!o||!o.afterEffect||o.afterEffect(e,t,i,n,s,r.retina.pixelRatio)}function drawPlugin(r,e,t){e.draw&&e.draw(r,t)}function drawParticlePlugin(r,e,t,i){e.drawParticle&&e.drawParticle(r,t,i)}function alterHsl(r,e,t){return{h:r.h,s:r.s,l:r.l+(e==="darken"?-1:1)*t}}function setTransformValue(r,e,t){const i=e[t];i!==void 0&&(r[t]=(r[t]??1)*i)}class Canvas{constructor(e){this.container=e,this._applyPostDrawUpdaters=t=>{for(const i of this._postDrawUpdaters)i.afterDraw&&i.afterDraw(t)},this._applyPreDrawUpdaters=(t,i,n,s,o,a)=>{for(const l of this._preDrawUpdaters){if(l.getColorStyles){const{fill:h,stroke:u}=l.getColorStyles(i,t,n,s);h&&(o.fill=h),u&&(o.stroke=u)}if(l.getTransformValues){const h=l.getTransformValues(i);for(const u in h)setTransformValue(a,h,u)}l.beforeDraw&&l.beforeDraw(i)}},this._applyResizePlugins=()=>{for(const t of this._resizePlugins)t.resize&&t.resize()},this._getPluginParticleColors=t=>{let i,n;for(const s of this._colorPlugins)if(!i&&s.particleFillColor&&(i=rangeColorToHsl(s.particleFillColor(t))),!n&&s.particleStrokeColor&&(n=rangeColorToHsl(s.particleStrokeColor(t))),i&&n)break;return[i,n]},this._initCover=()=>{const t=this.container.actualOptions,i=t.backgroundMask.cover,n=i.color,s=rangeColorToRgb(n);if(s){const o={...s,a:i.opacity};this._coverColorStyle=getStyleFromRgb(o,o.a)}},this._initStyle=()=>{const t=this.element,i=this.container.actualOptions;if(t){this._fullScreen?(this._originalStyle=deepExtend({},t.style),this._setFullScreenStyle()):this._resetOriginalStyle();for(const n in i.style){if(!n||!i.style)continue;const s=i.style[n];s&&t.style.setProperty(n,s,"important")}}},this._initTrail=async()=>{const t=this.container.actualOptions,i=t.particles.move.trail,n=i.fill;if(i.enable)if(n.color){const s=rangeColorToRgb(n.color);if(!s)return;const o=t.particles.move.trail;this._trailFill={color:{...s},opacity:1/o.length}}else await new Promise((s,o)=>{if(!n.image)return;const a=document.createElement("img");a.addEventListener("load",()=>{this._trailFill={image:a,opacity:1/i.length},s()}),a.addEventListener("error",l=>{o(l.error)}),a.src=n.image})},this._paintBase=t=>{this.draw(i=>paintBase(i,this.size,t))},this._paintImage=(t,i)=>{this.draw(n=>paintImage(n,this.size,t,i))},this._repairStyle=()=>{const t=this.element;t&&(this._safeMutationObserver(i=>i.disconnect()),this._initStyle(),this.initBackground(),this._safeMutationObserver(i=>i.observe(t,{attributes:!0})))},this._resetOriginalStyle=()=>{const t=this.element,i=this._originalStyle;if(!(t&&i))return;const n=t.style;n.position=i.position,n.zIndex=i.zIndex,n.top=i.top,n.left=i.left,n.width=i.width,n.height=i.height},this._safeMutationObserver=t=>{this._mutationObserver&&t(this._mutationObserver)},this._setFullScreenStyle=()=>{const t=this.element;if(!t)return;const i="important",n=t.style;n.setProperty("position","fixed",i),n.setProperty("z-index",this.container.actualOptions.fullScreen.zIndex.toString(10),i),n.setProperty("top","0",i),n.setProperty("left","0",i),n.setProperty("width","100%",i),n.setProperty("height","100%",i)},this.size={height:0,width:0},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){const e=this.container.actualOptions,t=e.particles.move.trail,i=this._trailFill;e.backgroundMask.enable?this.paint():t.enable&&t.length>0&&i?i.color?this._paintBase(getStyleFromRgb(i.color,i.opacity)):i.image&&this._paintImage(i.image,i.opacity):this.draw(n=>{clear(n,this.size)})}destroy(){if(this.stop(),this._generated){const e=this.element;e&&e.remove()}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(e){const t=this._context;if(t)return e(t)}drawParticle(e,t){if(e.spawning||e.destroyed)return;const i=e.getRadius();if(i<=0)return;const n=e.getFillColor(),s=e.getStrokeColor()??n;let[o,a]=this._getPluginParticleColors(e);o||(o=n),a||(a=s),!(!o&&!a)&&this.draw(l=>{var y;const h=this.container,u=h.actualOptions,g=e.options.zIndex,m=(1-e.zIndexFactor)**g.opacityRate,_=e.bubble.opacity??((y=e.opacity)==null?void 0:y.value)??1,b=e.strokeOpacity??_,d=_*m,c=b*m,f={},v={fill:o?getStyleFromHsl(o,d):void 0};v.stroke=a?getStyleFromHsl(a,c):v.fill,this._applyPreDrawUpdaters(l,e,i,d,v,f),drawParticle({container:h,context:l,particle:e,delta:t,colorStyles:v,backgroundMask:u.backgroundMask.enable,composite:u.backgroundMask.composite,radius:i*(1-e.zIndexFactor)**g.sizeRate,opacity:d,shadow:e.options.shadow,transform:f}),this._applyPostDrawUpdaters(e)})}drawParticlePlugin(e,t,i){this.draw(n=>drawParticlePlugin(n,e,t,i))}drawPlugin(e,t){this.draw(i=>drawPlugin(i,e,t))}async init(){this._safeMutationObserver(e=>e.disconnect()),this._mutationObserver=safeMutationObserver(e=>{for(const t of e)t.type==="attributes"&&t.attributeName==="style"&&this._repairStyle()}),this.resize(),this._initStyle(),this._initCover();try{await this._initTrail()}catch(e){getLogger().error(e)}this.initBackground(),this._safeMutationObserver(e=>{this.element&&e.observe(this.element,{attributes:!0})}),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){const e=this.container.actualOptions,t=e.background,i=this.element;if(!i)return;const n=i.style;if(n){if(t.color){const s=rangeColorToRgb(t.color);n.backgroundColor=s?getStyleFromRgb(s,t.opacity):""}else n.backgroundColor="";n.backgroundImage=t.image||"",n.backgroundPosition=t.position||"",n.backgroundRepeat=t.repeat||"",n.backgroundSize=t.size||""}}initPlugins(){this._resizePlugins=[];for(const[,e]of this.container.plugins)e.resize&&this._resizePlugins.push(e),(e.particleFillColor||e.particleStrokeColor)&&this._colorPlugins.push(e)}initUpdaters(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];for(const e of this.container.particles.updaters)e.afterDraw&&this._postDrawUpdaters.push(e),(e.getColorStyles||e.getTransformValues||e.beforeDraw)&&this._preDrawUpdaters.push(e)}loadCanvas(e){this._generated&&this.element&&this.element.remove(),this._generated=e.dataset&&generatedAttribute in e.dataset?e.dataset[generatedAttribute]==="true":this._generated,this.element=e,this.element.ariaHidden="true",this._originalStyle=deepExtend({},this.element.style),this.size.height=e.offsetHeight,this.size.width=e.offsetWidth,this._context=this.element.getContext("2d"),this._safeMutationObserver(t=>{this.element&&t.observe(this.element,{attributes:!0})}),this.container.retina.init(),this.initBackground()}paint(){const e=this.container.actualOptions;this.draw(t=>{e.backgroundMask.enable&&e.backgroundMask.cover?(clear(t,this.size),this._paintBase(this._coverColorStyle)):this._paintBase()})}resize(){if(!this.element)return!1;const e=this.container,t=e.retina.pixelRatio,i=e.canvas.size,n={width:this.element.offsetWidth*t,height:this.element.offsetHeight*t};if(n.height===i.height&&n.width===i.width&&n.height===this.element.height&&n.width===this.element.width)return!1;const s={...i};return this.element.width=i.width=this.element.offsetWidth*t,this.element.height=i.height=this.element.offsetHeight*t,this.container.started&&(this.resizeFactor={width:i.width/s.width,height:i.height/s.height}),!0}stop(){this._safeMutationObserver(e=>e.disconnect()),this._mutationObserver=void 0,this.draw(e=>clear(e,this.size))}async windowResize(){if(!this.element||!this.resize())return;const e=this.container,t=e.updateActualOptions();e.particles.setDensity(),this._applyResizePlugins(),t&&await e.refresh()}}function manageListener(r,e,t,i,n){if(i){let s={passive:!0};isBoolean(n)?s.capture=n:n!==void 0&&(s=n),r.addEventListener(e,t,s)}else{const s=n;r.removeEventListener(e,t,s)}}class EventListeners{constructor(e){this.container=e,this._doMouseTouchClick=t=>{const i=this.container,n=i.actualOptions;if(this._canPush){const s=i.interactivity.mouse,o=s.position;if(!o)return;s.clickPosition={...o},s.clickTime=new Date().getTime();const a=n.interactivity.events.onClick;executeOnSingleOrMultiple(a.mode,l=>this.container.handleClickMode(l))}t.type==="touchend"&&setTimeout(()=>this._mouseTouchFinish(),500)},this._handleThemeChange=t=>{const i=t,n=this.container,s=n.options,o=s.defaultThemes,a=i.matches?o.dark:o.light,l=s.themes.find(h=>h.name===a);l&&l.default.auto&&n.loadTheme(a)},this._handleVisibilityChange=()=>{const t=this.container,i=t.actualOptions;this._mouseTouchFinish(),i.pauseOnBlur&&(document&&document.hidden?(t.pageHidden=!0,t.pause()):(t.pageHidden=!1,t.getAnimationStatus()?t.play(!0):t.draw(!0)))},this._handleWindowResize=async()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout),this._resizeTimeout=setTimeout(async()=>{const t=this.container.canvas;t&&await t.windowResize()},this.container.actualOptions.interactivity.events.resize.delay*1e3)},this._manageInteractivityListeners=(t,i)=>{const n=this._handlers,s=this.container,o=s.actualOptions,a=s.interactivity.element;if(!a)return;const l=a,h=s.canvas.element;h&&(h.style.pointerEvents=l===h?"initial":"none"),(o.interactivity.events.onHover.enable||o.interactivity.events.onClick.enable)&&(manageListener(a,mouseMoveEvent,n.mouseMove,i),manageListener(a,touchStartEvent,n.touchStart,i),manageListener(a,touchMoveEvent,n.touchMove,i),o.interactivity.events.onClick.enable?(manageListener(a,touchEndEvent,n.touchEndClick,i),manageListener(a,mouseUpEvent,n.mouseUp,i),manageListener(a,mouseDownEvent,n.mouseDown,i)):manageListener(a,touchEndEvent,n.touchEnd,i),manageListener(a,t,n.mouseLeave,i),manageListener(a,touchCancelEvent,n.touchCancel,i))},this._manageListeners=t=>{const i=this._handlers,n=this.container,s=n.actualOptions,o=s.interactivity.detectsOn,a=n.canvas.element;let l=mouseLeaveEvent;o==="window"?(n.interactivity.element=window,l=mouseOutEvent):o==="parent"&&a?n.interactivity.element=a.parentElement??a.parentNode:n.interactivity.element=a,this._manageMediaMatch(t),this._manageResize(t),this._manageInteractivityListeners(l,t),document&&manageListener(document,visibilityChangeEvent,i.visibilityChange,t,!1)},this._manageMediaMatch=t=>{const i=this._handlers,n=safeMatchMedia("(prefers-color-scheme: dark)");if(n){if(n.addEventListener!==void 0){manageListener(n,"change",i.themeChange,t);return}n.addListener!==void 0&&(t?n.addListener(i.oldThemeChange):n.removeListener(i.oldThemeChange))}},this._manageResize=t=>{const i=this._handlers,n=this.container;if(!n.actualOptions.interactivity.events.resize)return;if(typeof ResizeObserver>"u"){manageListener(window,resizeEvent,i.resize,t);return}const o=n.canvas.element;this._resizeObserver&&!t?(o&&this._resizeObserver.unobserve(o),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&t&&o&&(this._resizeObserver=new ResizeObserver(async a=>{a.find(h=>h.target===o)&&await this._handleWindowResize()}),this._resizeObserver.observe(o))},this._mouseDown=()=>{const{interactivity:t}=this.container;if(!t)return;const{mouse:i}=t;i.clicking=!0,i.downPosition=i.position},this._mouseTouchClick=t=>{const i=this.container,n=i.actualOptions,{mouse:s}=i.interactivity;s.inside=!0;let o=!1;const a=s.position;if(!(!a||!n.interactivity.events.onClick.enable)){for(const[,l]of i.plugins)if(l.clickPositionValid&&(o=l.clickPositionValid(a),o))break;o||this._doMouseTouchClick(t),s.clicking=!1}},this._mouseTouchFinish=()=>{const t=this.container.interactivity;if(!t)return;const i=t.mouse;delete i.position,delete i.clickPosition,delete i.downPosition,t.status=mouseLeaveEvent,i.inside=!1,i.clicking=!1},this._mouseTouchMove=t=>{const i=this.container,n=i.actualOptions,s=i.interactivity,o=i.canvas.element;if(!s||!s.element)return;s.mouse.inside=!0;let a;if(t.type.startsWith("pointer")){this._canPush=!0;const h=t;if(s.element===window){if(o){const u=o.getBoundingClientRect();a={x:h.clientX-u.left,y:h.clientY-u.top}}}else if(n.interactivity.detectsOn==="parent"){const u=h.target,g=h.currentTarget;if(u&&g&&o){const m=u.getBoundingClientRect(),_=g.getBoundingClientRect(),b=o.getBoundingClientRect();a={x:h.offsetX+2*m.left-(_.left+b.left),y:h.offsetY+2*m.top-(_.top+b.top)}}else a={x:h.offsetX??h.clientX,y:h.offsetY??h.clientY}}else h.target===o&&(a={x:h.offsetX??h.clientX,y:h.offsetY??h.clientY})}else if(this._canPush=t.type!=="touchmove",o){const h=t,u=h.touches[h.touches.length-1],g=o.getBoundingClientRect();a={x:u.clientX-(g.left??0),y:u.clientY-(g.top??0)}}const l=i.retina.pixelRatio;a&&(a.x*=l,a.y*=l),s.mouse.position=a,s.status=mouseMoveEvent},this._touchEnd=t=>{const i=t,n=Array.from(i.changedTouches);for(const s of n)this._touches.delete(s.identifier);this._mouseTouchFinish()},this._touchEndClick=t=>{const i=t,n=Array.from(i.changedTouches);for(const s of n)this._touches.delete(s.identifier);this._mouseTouchClick(t)},this._touchStart=t=>{const i=t,n=Array.from(i.changedTouches);for(const s of n)this._touches.set(s.identifier,performance.now());this._mouseTouchMove(t)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:t=>this._mouseTouchMove(t),mouseUp:t=>this._mouseTouchClick(t),touchStart:t=>this._touchStart(t),touchMove:t=>this._mouseTouchMove(t),touchEnd:t=>this._touchEnd(t),touchCancel:t=>this._touchEnd(t),touchEndClick:t=>this._touchEndClick(t),visibilityChange:()=>this._handleVisibilityChange(),themeChange:t=>this._handleThemeChange(t),oldThemeChange:t=>this._handleThemeChange(t),resize:()=>{this._handleWindowResize()}}}addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}}class OptionsColor{constructor(){this.value=""}static create(e,t){const i=new OptionsColor;return i.load(e),t!==void 0&&(isString(t)||isArray$1(t)?i.load({value:t}):i.load(t)),i}load(e){(e==null?void 0:e.value)!==void 0&&(this.value=e.value)}}class Background{constructor(){this.color=new OptionsColor,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}load(e){e&&(e.color!==void 0&&(this.color=OptionsColor.create(this.color,e.color)),e.image!==void 0&&(this.image=e.image),e.position!==void 0&&(this.position=e.position),e.repeat!==void 0&&(this.repeat=e.repeat),e.size!==void 0&&(this.size=e.size),e.opacity!==void 0&&(this.opacity=e.opacity))}}class BackgroundMaskCover{constructor(){this.color=new OptionsColor,this.color.value="#fff",this.opacity=1}load(e){e&&(e.color!==void 0&&(this.color=OptionsColor.create(this.color,e.color)),e.opacity!==void 0&&(this.opacity=e.opacity))}}class BackgroundMask{constructor(){this.composite="destination-out",this.cover=new BackgroundMaskCover,this.enable=!1}load(e){if(e){if(e.composite!==void 0&&(this.composite=e.composite),e.cover!==void 0){const t=e.cover,i=isString(e.cover)?{color:e.cover}:e.cover;this.cover.load(t.color!==void 0?t:{color:i})}e.enable!==void 0&&(this.enable=e.enable)}}}class FullScreen{constructor(){this.enable=!0,this.zIndex=0}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.zIndex!==void 0&&(this.zIndex=e.zIndex))}}class ClickEvent{constructor(){this.enable=!1,this.mode=[]}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.mode!==void 0&&(this.mode=e.mode))}}class DivEvent{constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type="circle"}get el(){return this.elementId}set el(e){this.elementId=e}get elementId(){return this.ids}set elementId(e){this.ids=e}get ids(){return executeOnSingleOrMultiple(this.selectors,e=>e.replace("#",""))}set ids(e){this.selectors=executeOnSingleOrMultiple(e,t=>`#${t}`)}load(e){if(!e)return;const t=e.ids??e.elementId??e.el;t!==void 0&&(this.ids=t),e.selectors!==void 0&&(this.selectors=e.selectors),e.enable!==void 0&&(this.enable=e.enable),e.mode!==void 0&&(this.mode=e.mode),e.type!==void 0&&(this.type=e.type)}}class Parallax{constructor(){this.enable=!1,this.force=2,this.smooth=10}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.force!==void 0&&(this.force=e.force),e.smooth!==void 0&&(this.smooth=e.smooth))}}class HoverEvent{constructor(){this.enable=!1,this.mode=[],this.parallax=new Parallax}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.mode!==void 0&&(this.mode=e.mode),this.parallax.load(e.parallax))}}class ResizeEvent{constructor(){this.delay=.5,this.enable=!0}load(e){e!==void 0&&(e.delay!==void 0&&(this.delay=e.delay),e.enable!==void 0&&(this.enable=e.enable))}}class Events{constructor(){this.onClick=new ClickEvent,this.onDiv=new DivEvent,this.onHover=new HoverEvent,this.resize=new ResizeEvent}get onclick(){return this.onClick}set onclick(e){this.onClick=e}get ondiv(){return this.onDiv}set ondiv(e){this.onDiv=e}get onhover(){return this.onHover}set onhover(e){this.onHover=e}load(e){if(!e)return;this.onClick.load(e.onClick??e.onclick);const t=e.onDiv??e.ondiv;t!==void 0&&(this.onDiv=executeOnSingleOrMultiple(t,i=>{const n=new DivEvent;return n.load(i),n})),this.onHover.load(e.onHover??e.onhover),isBoolean(e.resize)?this.resize.enable=e.resize:this.resize.load(e.resize)}}class Modes{constructor(e,t){this._engine=e,this._container=t}load(e){if(!e||!this._container)return;const t=this._engine.plugins.interactors.get(this._container);if(t)for(const i of t)i.loadModeOptions&&i.loadModeOptions(this,e)}}class Interactivity{constructor(e,t){this.detectsOn="window",this.events=new Events,this.modes=new Modes(e,t)}get detect_on(){return this.detectsOn}set detect_on(e){this.detectsOn=e}load(e){if(!e)return;const t=e.detectsOn??e.detect_on;t!==void 0&&(this.detectsOn=t),this.events.load(e.events),this.modes.load(e.modes)}}class ManualParticle{load(e){e&&(e.position&&(this.position={x:e.position.x??50,y:e.position.y??50,mode:e.position.mode??"percent"}),e.options&&(this.options=deepExtend({},e.options)))}}class Responsive{constructor(){this.maxWidth=1/0,this.options={},this.mode="canvas"}load(e){e&&(e.maxWidth!==void 0&&(this.maxWidth=e.maxWidth),e.mode!==void 0&&(e.mode==="screen"?this.mode="screen":this.mode="canvas"),e.options!==void 0&&(this.options=deepExtend({},e.options)))}}class ThemeDefault{constructor(){this.auto=!1,this.mode="any",this.value=!1}load(e){e&&(e.auto!==void 0&&(this.auto=e.auto),e.mode!==void 0&&(this.mode=e.mode),e.value!==void 0&&(this.value=e.value))}}class Theme{constructor(){this.name="",this.default=new ThemeDefault}load(e){e&&(e.name!==void 0&&(this.name=e.name),this.default.load(e.default),e.options!==void 0&&(this.options=deepExtend({},e.options)))}}class ColorAnimation{constructor(){this.count=0,this.enable=!1,this.offset=0,this.speed=1,this.delay=0,this.decay=0,this.sync=!0}load(e){e&&(e.count!==void 0&&(this.count=setRangeValue(e.count)),e.enable!==void 0&&(this.enable=e.enable),e.offset!==void 0&&(this.offset=setRangeValue(e.offset)),e.speed!==void 0&&(this.speed=setRangeValue(e.speed)),e.decay!==void 0&&(this.decay=setRangeValue(e.decay)),e.delay!==void 0&&(this.delay=setRangeValue(e.delay)),e.sync!==void 0&&(this.sync=e.sync))}}class HslAnimation{constructor(){this.h=new ColorAnimation,this.s=new ColorAnimation,this.l=new ColorAnimation}load(e){e&&(this.h.load(e.h),this.s.load(e.s),this.l.load(e.l))}}class AnimatableColor extends OptionsColor{constructor(){super(),this.animation=new HslAnimation}static create(e,t){const i=new AnimatableColor;return i.load(e),t!==void 0&&(isString(t)||isArray$1(t)?i.load({value:t}):i.load(t)),i}load(e){if(super.load(e),!e)return;const t=e.animation;t!==void 0&&(t.enable!==void 0?this.animation.h.load(t):this.animation.load(e.animation))}}class CollisionsAbsorb{constructor(){this.speed=2}load(e){e&&e.speed!==void 0&&(this.speed=e.speed)}}class CollisionsOverlap{constructor(){this.enable=!0,this.retries=0}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.retries!==void 0&&(this.retries=e.retries))}}class AnimationOptions{constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}load(e){e&&(e.count!==void 0&&(this.count=setRangeValue(e.count)),e.enable!==void 0&&(this.enable=e.enable),e.speed!==void 0&&(this.speed=setRangeValue(e.speed)),e.decay!==void 0&&(this.decay=setRangeValue(e.decay)),e.delay!==void 0&&(this.delay=setRangeValue(e.delay)),e.sync!==void 0&&(this.sync=e.sync))}}class RangedAnimationOptions extends AnimationOptions{constructor(){super(),this.mode="auto",this.startValue="random"}load(e){super.load(e),e&&(e.minimumValue!==void 0&&(this.minimumValue=e.minimumValue),e.mode!==void 0&&(this.mode=e.mode),e.startValue!==void 0&&(this.startValue=e.startValue))}}class Random{constructor(){this.enable=!1,this.minimumValue=0}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.minimumValue!==void 0&&(this.minimumValue=e.minimumValue))}}class ValueWithRandom{constructor(){this.random=new Random,this.value=0}load(e){e&&(isBoolean(e.random)?this.random.enable=e.random:this.random.load(e.random),e.value!==void 0&&(this.value=setRangeValue(e.value,this.random.enable?this.random.minimumValue:void 0)))}}class ParticlesBounceFactor extends ValueWithRandom{constructor(){super(),this.random.minimumValue=.1,this.value=1}}class ParticlesBounce{constructor(){this.horizontal=new ParticlesBounceFactor,this.vertical=new ParticlesBounceFactor}load(e){e&&(this.horizontal.load(e.horizontal),this.vertical.load(e.vertical))}}class Collisions{constructor(){this.absorb=new CollisionsAbsorb,this.bounce=new ParticlesBounce,this.enable=!1,this.maxSpeed=50,this.mode="bounce",this.overlap=new CollisionsOverlap}load(e){e&&(this.absorb.load(e.absorb),this.bounce.load(e.bounce),e.enable!==void 0&&(this.enable=e.enable),e.maxSpeed!==void 0&&(this.maxSpeed=setRangeValue(e.maxSpeed)),e.mode!==void 0&&(this.mode=e.mode),this.overlap.load(e.overlap))}}class MoveAngle{constructor(){this.offset=0,this.value=90}load(e){e&&(e.offset!==void 0&&(this.offset=setRangeValue(e.offset)),e.value!==void 0&&(this.value=setRangeValue(e.value)))}}class MoveAttract{constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}get rotateX(){return this.rotate.x}set rotateX(e){this.rotate.x=e}get rotateY(){return this.rotate.y}set rotateY(e){this.rotate.y=e}load(e){var n,s;if(!e)return;e.distance!==void 0&&(this.distance=setRangeValue(e.distance)),e.enable!==void 0&&(this.enable=e.enable);const t=((n=e.rotate)==null?void 0:n.x)??e.rotateX;t!==void 0&&(this.rotate.x=t);const i=((s=e.rotate)==null?void 0:s.y)??e.rotateY;i!==void 0&&(this.rotate.y=i)}}class MoveCenter{constructor(){this.x=50,this.y=50,this.mode="percent",this.radius=0}load(e){e&&(e.x!==void 0&&(this.x=e.x),e.y!==void 0&&(this.y=e.y),e.mode!==void 0&&(this.mode=e.mode),e.radius!==void 0&&(this.radius=e.radius))}}class MoveGravity{constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}load(e){e&&(e.acceleration!==void 0&&(this.acceleration=setRangeValue(e.acceleration)),e.enable!==void 0&&(this.enable=e.enable),e.inverse!==void 0&&(this.inverse=e.inverse),e.maxSpeed!==void 0&&(this.maxSpeed=setRangeValue(e.maxSpeed)))}}class MovePath{constructor(){this.clamp=!0,this.delay=new ValueWithRandom,this.enable=!1,this.options={}}load(e){e&&(e.clamp!==void 0&&(this.clamp=e.clamp),this.delay.load(e.delay),e.enable!==void 0&&(this.enable=e.enable),this.generator=e.generator,e.options&&(this.options=deepExtend(this.options,e.options)))}}class MoveTrailFill{load(e){e&&(e.color!==void 0&&(this.color=OptionsColor.create(this.color,e.color)),e.image!==void 0&&(this.image=e.image))}}class MoveTrail{constructor(){this.enable=!1,this.length=10,this.fill=new MoveTrailFill}get fillColor(){return this.fill.color}set fillColor(e){this.fill.load({color:e})}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),(e.fill!==void 0||e.fillColor!==void 0)&&this.fill.load(e.fill||{color:e.fillColor}),e.length!==void 0&&(this.length=e.length))}}class OutModes{constructor(){this.default="out"}load(e){e&&(e.default!==void 0&&(this.default=e.default),this.bottom=e.bottom??e.default,this.left=e.left??e.default,this.right=e.right??e.default,this.top=e.top??e.default)}}class Spin{constructor(){this.acceleration=0,this.enable=!1}load(e){e&&(e.acceleration!==void 0&&(this.acceleration=setRangeValue(e.acceleration)),e.enable!==void 0&&(this.enable=e.enable),e.position&&(this.position=deepExtend({},e.position)))}}class Move{constructor(){this.angle=new MoveAngle,this.attract=new MoveAttract,this.center=new MoveCenter,this.decay=0,this.distance={},this.direction="none",this.drift=0,this.enable=!1,this.gravity=new MoveGravity,this.path=new MovePath,this.outModes=new OutModes,this.random=!1,this.size=!1,this.speed=2,this.spin=new Spin,this.straight=!1,this.trail=new MoveTrail,this.vibrate=!1,this.warp=!1}get bounce(){return this.collisions}set bounce(e){this.collisions=e}get collisions(){return!1}set collisions(e){}get noise(){return this.path}set noise(e){this.path=e}get outMode(){return this.outModes.default}set outMode(e){this.outModes.default=e}get out_mode(){return this.outMode}set out_mode(e){this.outMode=e}load(e){if(!e)return;this.angle.load(isNumber$1(e.angle)?{value:e.angle}:e.angle),this.attract.load(e.attract),this.center.load(e.center),e.decay!==void 0&&(this.decay=setRangeValue(e.decay)),e.direction!==void 0&&(this.direction=e.direction),e.distance!==void 0&&(this.distance=isNumber$1(e.distance)?{horizontal:e.distance,vertical:e.distance}:{...e.distance}),e.drift!==void 0&&(this.drift=setRangeValue(e.drift)),e.enable!==void 0&&(this.enable=e.enable),this.gravity.load(e.gravity);const t=e.outModes??e.outMode??e.out_mode;t!==void 0&&(isObject$1(t)?this.outModes.load(t):this.outModes.load({default:t})),this.path.load(e.path??e.noise),e.random!==void 0&&(this.random=e.random),e.size!==void 0&&(this.size=e.size),e.speed!==void 0&&(this.speed=setRangeValue(e.speed)),this.spin.load(e.spin),e.straight!==void 0&&(this.straight=e.straight),this.trail.load(e.trail),e.vibrate!==void 0&&(this.vibrate=e.vibrate),e.warp!==void 0&&(this.warp=e.warp)}}class OpacityAnimation extends RangedAnimationOptions{constructor(){super(),this.destroy="none",this.speed=2}get opacity_min(){return this.minimumValue}set opacity_min(e){this.minimumValue=e}load(e){(e==null?void 0:e.opacity_min)!==void 0&&e.minimumValue===void 0&&(e.minimumValue=e.opacity_min),super.load(e),e&&e.destroy!==void 0&&(this.destroy=e.destroy)}}class Opacity extends ValueWithRandom{constructor(){super(),this.animation=new OpacityAnimation,this.random.minimumValue=.1,this.value=1}get anim(){return this.animation}set anim(e){this.animation=e}load(e){if(!e)return;super.load(e);const t=e.animation??e.anim;t!==void 0&&(this.animation.load(t),this.value=setRangeValue(this.value,this.animation.enable?this.animation.minimumValue:void 0))}}class ParticlesDensity{constructor(){this.enable=!1,this.width=1920,this.height=1080}get area(){return this.width}set area(e){this.width=e}get factor(){return this.height}set factor(e){this.height=e}get value_area(){return this.area}set value_area(e){this.area=e}load(e){if(!e)return;e.enable!==void 0&&(this.enable=e.enable);const t=e.width??e.area??e.value_area;t!==void 0&&(this.width=t);const i=e.height??e.factor;i!==void 0&&(this.height=i)}}class ParticlesNumber{constructor(){this.density=new ParticlesDensity,this.limit=0,this.value=0}get max(){return this.limit}set max(e){this.limit=e}load(e){if(!e)return;this.density.load(e.density);const t=e.limit??e.max;t!==void 0&&(this.limit=t),e.value!==void 0&&(this.value=e.value)}}class Shadow{constructor(){this.blur=0,this.color=new OptionsColor,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}load(e){e&&(e.blur!==void 0&&(this.blur=e.blur),this.color=OptionsColor.create(this.color,e.color),e.enable!==void 0&&(this.enable=e.enable),e.offset!==void 0&&(e.offset.x!==void 0&&(this.offset.x=e.offset.x),e.offset.y!==void 0&&(this.offset.y=e.offset.y)))}}const charKey="character",charAltKey="char",imageKey="image",imageAltKey="images",polygonKey="polygon",polygonAltKey="star";class Shape{constructor(){this.loadShape=(e,t,i,n)=>{if(!e)return;const s=isArray$1(e),o=s?[]:{},a=s!==isArray$1(this.options[t]),l=s!==isArray$1(this.options[i]);a&&(this.options[t]=o),l&&n&&(this.options[i]=o),this.options[t]=deepExtend(this.options[t]??o,e),(!this.options[i]||n)&&(this.options[i]=deepExtend(this.options[i]??o,e))},this.close=!0,this.fill=!0,this.options={},this.type="circle"}get character(){return this.options[charKey]??this.options[charAltKey]}set character(e){this.options[charAltKey]=this.options[charKey]=e}get custom(){return this.options}set custom(e){this.options=e}get image(){return this.options[imageKey]??this.options[imageAltKey]}set image(e){this.options[imageAltKey]=this.options[imageKey]=e}get images(){return this.image}set images(e){this.image=e}get polygon(){return this.options[polygonKey]??this.options[polygonAltKey]}set polygon(e){this.options[polygonAltKey]=this.options[polygonKey]=e}get stroke(){return[]}set stroke(e){}load(e){if(!e)return;const t=e.options??e.custom;if(t!==void 0)for(const i in t){const n=t[i];n&&(this.options[i]=deepExtend(this.options[i]??{},n))}this.loadShape(e.character,charKey,charAltKey,!0),this.loadShape(e.polygon,polygonKey,polygonAltKey,!1),this.loadShape(e.image??e.images,imageKey,imageAltKey,!0),e.close!==void 0&&(this.close=e.close),e.fill!==void 0&&(this.fill=e.fill),e.type!==void 0&&(this.type=e.type)}}class SizeAnimation extends RangedAnimationOptions{constructor(){super(),this.destroy="none",this.speed=5}get size_min(){return this.minimumValue}set size_min(e){this.minimumValue=e}load(e){(e==null?void 0:e.size_min)!==void 0&&e.minimumValue===void 0&&(e.minimumValue=e.size_min),super.load(e),e&&e.destroy!==void 0&&(this.destroy=e.destroy)}}class Size extends ValueWithRandom{constructor(){super(),this.animation=new SizeAnimation,this.random.minimumValue=1,this.value=3}get anim(){return this.animation}set anim(e){this.animation=e}load(e){if(super.load(e),!e)return;const t=e.animation??e.anim;t!==void 0&&(this.animation.load(t),this.value=setRangeValue(this.value,this.animation.enable?this.animation.minimumValue:void 0))}}class Stroke{constructor(){this.width=0}load(e){e&&(e.color!==void 0&&(this.color=AnimatableColor.create(this.color,e.color)),e.width!==void 0&&(this.width=setRangeValue(e.width)),e.opacity!==void 0&&(this.opacity=setRangeValue(e.opacity)))}}class ZIndex extends ValueWithRandom{constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}load(e){super.load(e),e&&(e.opacityRate!==void 0&&(this.opacityRate=e.opacityRate),e.sizeRate!==void 0&&(this.sizeRate=e.sizeRate),e.velocityRate!==void 0&&(this.velocityRate=e.velocityRate))}}class ParticlesOptions{constructor(e,t){this._engine=e,this._container=t,this.bounce=new ParticlesBounce,this.collisions=new Collisions,this.color=new AnimatableColor,this.color.value="#fff",this.groups={},this.move=new Move,this.number=new ParticlesNumber,this.opacity=new Opacity,this.reduceDuplicates=!1,this.shadow=new Shadow,this.shape=new Shape,this.size=new Size,this.stroke=new Stroke,this.zIndex=new ZIndex}load(e){var n,s,o;if(!e)return;if(this.bounce.load(e.bounce),this.color.load(AnimatableColor.create(this.color,e.color)),e.groups!==void 0)for(const a in e.groups){const l=e.groups[a];l!==void 0&&(this.groups[a]=deepExtend(this.groups[a]??{},l))}this.move.load(e.move),this.number.load(e.number),this.opacity.load(e.opacity),e.reduceDuplicates!==void 0&&(this.reduceDuplicates=e.reduceDuplicates),this.shape.load(e.shape),this.size.load(e.size),this.shadow.load(e.shadow),this.zIndex.load(e.zIndex);const t=((n=e.move)==null?void 0:n.collisions)??((s=e.move)==null?void 0:s.bounce);t!==void 0&&(this.collisions.enable=t),this.collisions.load(e.collisions),e.interactivity!==void 0&&(this.interactivity=deepExtend({},e.interactivity));const i=e.stroke??((o=e.shape)==null?void 0:o.stroke);if(i&&(this.stroke=executeOnSingleOrMultiple(i,a=>{const l=new Stroke;return l.load(a),l})),this._container){const a=this._engine.plugins.updaters.get(this._container);if(a)for(const h of a)h.loadOptions&&h.loadOptions(this,e);const l=this._engine.plugins.interactors.get(this._container);if(l)for(const h of l)h.loadParticlesOptions&&h.loadParticlesOptions(this,e)}}}function loadOptions(r,...e){for(const t of e)r.load(t)}function loadParticlesOptions(r,e,...t){const i=new ParticlesOptions(r,e);return loadOptions(i,...t),i}class Options{constructor(e,t){this._findDefaultTheme=i=>this.themes.find(n=>n.default.value&&n.default.mode===i)??this.themes.find(n=>n.default.value&&n.default.mode==="any"),this._importPreset=i=>{this.load(this._engine.plugins.getPreset(i))},this._engine=e,this._container=t,this.autoPlay=!0,this.background=new Background,this.backgroundMask=new BackgroundMask,this.defaultThemes={},this.delay=0,this.fullScreen=new FullScreen,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new Interactivity(e,t),this.manualParticles=[],this.particles=loadParticlesOptions(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}get backgroundMode(){return this.fullScreen}set backgroundMode(e){this.fullScreen.load(e)}get fps_limit(){return this.fpsLimit}set fps_limit(e){this.fpsLimit=e}get retina_detect(){return this.detectRetina}set retina_detect(e){this.detectRetina=e}load(e){var o,a;if(!e)return;e.preset!==void 0&&executeOnSingleOrMultiple(e.preset,l=>this._importPreset(l)),e.autoPlay!==void 0&&(this.autoPlay=e.autoPlay),e.delay!==void 0&&(this.delay=setRangeValue(e.delay));const t=e.detectRetina??e.retina_detect;t!==void 0&&(this.detectRetina=t),e.duration!==void 0&&(this.duration=setRangeValue(e.duration));const i=e.fpsLimit??e.fps_limit;i!==void 0&&(this.fpsLimit=i),e.pauseOnBlur!==void 0&&(this.pauseOnBlur=e.pauseOnBlur),e.pauseOnOutsideViewport!==void 0&&(this.pauseOnOutsideViewport=e.pauseOnOutsideViewport),e.zLayers!==void 0&&(this.zLayers=e.zLayers),this.background.load(e.background);const n=e.fullScreen??e.backgroundMode;isBoolean(n)?this.fullScreen.enable=n:this.fullScreen.load(n),this.backgroundMask.load(e.backgroundMask),this.interactivity.load(e.interactivity),e.manualParticles&&(this.manualParticles=e.manualParticles.map(l=>{const h=new ManualParticle;return h.load(l),h})),this.particles.load(e.particles),this.style=deepExtend(this.style,e.style),this._engine.plugins.loadOptions(this,e),e.smooth!==void 0&&(this.smooth=e.smooth);const s=this._engine.plugins.interactors.get(this._container);if(s)for(const l of s)l.loadOptions&&l.loadOptions(this,e);if(e.responsive!==void 0)for(const l of e.responsive){const h=new Responsive;h.load(l),this.responsive.push(h)}if(this.responsive.sort((l,h)=>l.maxWidth-h.maxWidth),e.themes!==void 0)for(const l of e.themes){const h=this.themes.find(u=>u.name===l.name);if(h)h.load(l);else{const u=new Theme;u.load(l),this.themes.push(u)}}this.defaultThemes.dark=(o=this._findDefaultTheme("dark"))==null?void 0:o.name,this.defaultThemes.light=(a=this._findDefaultTheme("light"))==null?void 0:a.name}setResponsive(e,t,i){this.load(i);const n=this.responsive.find(s=>s.mode==="screen"&&screen?s.maxWidth>screen.availWidth:s.maxWidth*t>e);return this.load(n==null?void 0:n.options),n==null?void 0:n.maxWidth}setTheme(e){if(e){const t=this.themes.find(i=>i.name===e);t&&this.load(t.options)}else{const t=safeMatchMedia("(prefers-color-scheme: dark)"),i=t&&t.matches,n=this._findDefaultTheme(i?"dark":"light");n&&this.load(n.options)}}}class InteractionManager{constructor(e,t){this.container=t,this._engine=e,this._interactors=e.plugins.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[]}async externalInteract(e){for(const t of this._externalInteractors)t.isEnabled()&&await t.interact(e)}handleClickMode(e){for(const t of this._externalInteractors)t.handleClickMode&&t.handleClickMode(e)}init(){this._externalInteractors=[],this._particleInteractors=[];for(const e of this._interactors){switch(e.type){case"external":this._externalInteractors.push(e);break;case"particles":this._particleInteractors.push(e);break}e.init()}}async particlesInteract(e,t){for(const i of this._externalInteractors)i.clear(e,t);for(const i of this._particleInteractors)i.isEnabled(e)&&await i.interact(e,t)}async reset(e){for(const t of this._externalInteractors)t.isEnabled()&&t.reset(e);for(const t of this._particleInteractors)t.isEnabled(e)&&t.reset(e)}}const fixOutMode=r=>{if(!isInArray(r.outMode,r.checkModes))return;const e=r.radius*2;r.coord>r.maxCoord-e?r.setCb(-r.radius):r.coord<e&&r.setCb(r.radius)};class Particle{constructor(e,t,i,n,s,o){this.container=i,this._calcPosition=(a,l,h,u=0)=>{for(const[,v]of a.plugins){const y=v.particlePosition!==void 0?v.particlePosition(l,this):void 0;if(y)return Vector3d.create(y.x,y.y,h)}const g=a.canvas.size,m=calcExactPositionOrRandomFromSize({size:g,position:l}),_=Vector3d.create(m.x,m.y,h),b=this.getRadius(),d=this.options.move.outModes,c=v=>{fixOutMode({outMode:v,checkModes:["bounce","bounce-horizontal"],coord:_.x,maxCoord:a.canvas.size.width,setCb:y=>_.x+=y,radius:b})},f=v=>{fixOutMode({outMode:v,checkModes:["bounce","bounce-vertical"],coord:_.y,maxCoord:a.canvas.size.height,setCb:y=>_.y+=y,radius:b})};return c(d.left??d.default),c(d.right??d.default),f(d.top??d.default),f(d.bottom??d.default),this._checkOverlap(_,u)?this._calcPosition(a,void 0,h,u+1):_},this._calculateVelocity=()=>{const a=getParticleBaseVelocity(this.direction),l=a.copy(),h=this.options.move;if(h.direction==="inside"||h.direction==="outside")return l;const u=Math.PI/180*getRangeValue(h.angle.value),g=Math.PI/180*getRangeValue(h.angle.offset),m={left:g-u/2,right:g+u/2};return h.straight||(l.angle+=randomInRange(setRangeValue(m.left,m.right))),h.random&&typeof h.speed=="number"&&(l.length*=getRandom()),l},this._checkOverlap=(a,l=0)=>{const h=this.options.collisions,u=this.getRadius();if(!h.enable)return!1;const g=h.overlap;if(g.enable)return!1;const m=g.retries;if(m>=0&&l>m)throw new Error(`${errorPrefix} particle is overlapping and can't be placed`);return!!this.container.particles.find(_=>getDistance(a,_.position)<u+_.getRadius())},this._getRollColor=a=>{if(!a||!this.roll||!this.backColor&&!this.roll.alter)return a;const l=this.roll.horizontal&&this.roll.vertical?2:1,h=this.roll.horizontal?Math.PI/2:0;return Math.floor(((this.roll.angle??0)+h)/(Math.PI/l))%2?this.backColor?this.backColor:this.roll.alter?alterHsl(a,this.roll.alter.type,this.roll.alter.value):a:a},this._initPosition=a=>{const l=this.container,h=getRangeValue(this.options.zIndex.value);this.position=this._calcPosition(l,a,clamp$1(h,0,l.zLayers)),this.initialPosition=this.position.copy();const u=l.canvas.size;switch(this.moveCenter={...getPosition(this.options.move.center,u),radius:this.options.move.center.radius??0,mode:this.options.move.center.mode??"percent"},this.direction=getParticleDirectionAngle(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case"inside":this.outType="inside";break;case"outside":this.outType="outside";break}this.offset=Vector.origin},this._loadShapeData=(a,l)=>{const h=a.options[this.shape];if(h)return deepExtend({close:a.close,fill:a.fill},itemFromSingleOrMultiple(h,this.id,l))},this._engine=e,this.init(t,n,s,o)}destroy(e){if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;const t=this.container,i=this.pathGenerator;for(const[,n]of t.plugins)n.particleDestroyed&&n.particleDestroyed(this,e);for(const n of t.particles.updaters)n.particleDestroyed&&n.particleDestroyed(this,e);i&&i.reset(this)}draw(e){const t=this.container;for(const[,i]of t.plugins)t.canvas.drawParticlePlugin(i,this,e);t.canvas.drawParticle(this,e)}getFillColor(){return this._getRollColor(this.bubble.color??getHslFromAnimation(this.color))}getMass(){return this.getRadius()**2*Math.PI/2}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){return this.bubble.radius??this.size.value}getStrokeColor(){return this._getRollColor(this.bubble.color??getHslFromAnimation(this.strokeColor))}init(e,t,i,n){const s=this.container,o=this._engine;this.id=e,this.group=n,this.fill=!0,this.pathRotation=!1,this.close=!0,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType="normal",this.ignoresResizeRatio=!0;const a=s.retina.pixelRatio,l=s.actualOptions,h=loadParticlesOptions(this._engine,s,l.particles),u=h.shape.type,{reduceDuplicates:g}=h;this.shape=itemFromSingleOrMultiple(u,this.id,g);const m=h.shape;if(i&&i.shape&&i.shape.type){const y=i.shape.type,D=itemFromSingleOrMultiple(y,this.id,g);D&&(this.shape=D,m.load(i.shape))}this.shapeData=this._loadShapeData(m,g),h.load(i);const _=this.shapeData;_&&h.load(_.particles);const b=new Interactivity(o,s);b.load(s.actualOptions.interactivity),b.load(h.interactivity),this.interactivity=b,this.fill=(_==null?void 0:_.fill)??h.shape.fill,this.close=(_==null?void 0:_.close)??h.shape.close,this.options=h;const d=this.options.move.path;this.pathDelay=getValue(d.delay)*1e3,d.generator&&(this.pathGenerator=this._engine.plugins.getPathGenerator(d.generator),this.pathGenerator&&s.addPath(d.generator,this.pathGenerator)&&this.pathGenerator.init(s)),s.retina.initParticle(this),this.size=initParticleNumericAnimationValue(this.options.size,a),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(t),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=1-getRangeValue(this.options.move.decay);const c=s.particles;c.needsSort=c.needsSort||c.lastZIndex<this.position.z,c.lastZIndex=this.position.z,this.zIndexFactor=this.position.z/s.zLayers,this.sides=24;let f=s.drawers.get(this.shape);f||(f=this._engine.plugins.getShapeDrawer(this.shape),f&&s.drawers.set(this.shape,f)),f&&f.loadShape&&f.loadShape(this);const v=f==null?void 0:f.getSidesCount;v&&(this.sides=v(this)),this.spawning=!1,this.shadowColor=rangeColorToRgb(this.options.shadow.color);for(const y of s.particles.updaters)y.init(this);for(const y of s.particles.movers)y.init&&y.init(this);f&&f.particleInit&&f.particleInit(s,this);for(const[,y]of s.plugins)y.particleCreated&&y.particleCreated(this)}isInsideCanvas(){const e=this.getRadius(),t=this.container.canvas.size,i=this.position;return i.x>=-e&&i.y>=-e&&i.y<=t.height+e&&i.x<=t.width+e}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){for(const e of this.container.particles.updaters)e.reset&&e.reset(this)}}class Point{constructor(e,t){this.position=e,this.particle=t}}class Range{constructor(e,t){this.position={x:e,y:t}}}class Rectangle extends Range{constructor(e,t,i,n){super(e,t),this.size={height:n,width:i}}contains(e){const t=this.size.width,i=this.size.height,n=this.position;return e.x>=n.x&&e.x<=n.x+t&&e.y>=n.y&&e.y<=n.y+i}intersects(e){e instanceof Circle&&e.intersects(this);const t=this.size.width,i=this.size.height,n=this.position,s=e.position,o=e instanceof Rectangle?e.size:{width:0,height:0},a=o.width,l=o.height;return s.x<n.x+t&&s.x+a>n.x&&s.y<n.y+i&&s.y+l>n.y}}class Circle extends Range{constructor(e,t,i){super(e,t),this.radius=i}contains(e){return getDistance(e,this.position)<=this.radius}intersects(e){const t=this.position,i=e.position,n={x:Math.abs(i.x-t.x),y:Math.abs(i.y-t.y)},s=this.radius;if(e instanceof Circle){const o=s+e.radius,a=Math.sqrt(n.x**2+n.y**2);return o>a}else if(e instanceof Rectangle){const{width:o,height:a}=e.size;return Math.pow(n.x-o,2)+Math.pow(n.y-a,2)<=s**2||n.x<=s+o&&n.y<=s+a||n.x<=o||n.y<=a}return!1}}class QuadTree{constructor(e,t){this.rectangle=e,this.capacity=t,this._subdivide=()=>{const{x:i,y:n}=this.rectangle.position,{width:s,height:o}=this.rectangle.size,{capacity:a}=this;for(let l=0;l<4;l++)this._subs.push(new QuadTree(new Rectangle(i+s/2*(l%2),n+o/2*(Math.round(l/2)-l%2),s/2,o/2),a));this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}insert(e){return this.rectangle.contains(e.position)?this._points.length<this.capacity?(this._points.push(e),!0):(this._divided||this._subdivide(),this._subs.some(t=>t.insert(e))):!1}query(e,t,i){const n=i||[];if(!e.intersects(this.rectangle))return[];for(const s of this._points)!e.contains(s.position)&&getDistance(e.position,s.position)>s.particle.getRadius()&&(!t||t(s.particle))||n.push(s.particle);if(this._divided)for(const s of this._subs)s.query(e,t,n);return n}queryCircle(e,t,i){return this.query(new Circle(e.x,e.y,t),i)}queryRectangle(e,t,i){return this.query(new Rectangle(e.x,e.y,t.width,t.height),i)}}const qTreeCapacity=4,qTreeRectangle=r=>new Rectangle(-r.width/4,-r.height/4,r.width*3/2,r.height*3/2);let Particles$1=class{constructor(e,t){this._applyDensity=(n,s,o)=>{var _;if(!((_=n.number.density)!=null&&_.enable))return;const a=n.number,l=this._initDensityFactor(a.density),h=a.value,u=a.limit>0?a.limit:h,g=Math.min(h,u)*l+s,m=Math.min(this.count,this.filter(b=>b.group===o).length);this.limit=a.limit*l,m<g?this.push(Math.abs(g-m),void 0,n,o):m>g&&this.removeQuantity(m-g,o)},this._initDensityFactor=n=>{const s=this._container;if(!s.canvas.element||!n.enable)return 1;const o=s.canvas.element,a=s.retina.pixelRatio;return o.width*o.height/(n.factor*a**2*n.area)},this._pushParticle=(n,s,o,a)=>{try{let l=this.pool.pop();l?l.init(this._nextId,n,s,o):l=new Particle(this._engine,this._nextId,this._container,n,s,o);let h=!0;return a&&(h=a(l)),h?(this._array.push(l),this._zArray.push(l),this._nextId++,this._engine.dispatchEvent("particleAdded",{container:this._container,data:{particle:l}}),l):void 0}catch(l){getLogger().warning(`${errorPrefix} adding particle: ${l}`);return}},this._removeParticle=(n,s,o)=>{const a=this._array[n];if(!a||a.group!==s)return!1;a.destroy(o);const l=this._zArray.indexOf(a);return this._array.splice(n,1),this._zArray.splice(l,1),this.pool.push(a),this._engine.dispatchEvent("particleRemoved",{container:this._container,data:{particle:a}}),!0},this._engine=e,this._container=t,this._nextId=0,this._array=[],this._zArray=[],this.pool=[],this.limit=0,this.needsSort=!1,this.lastZIndex=0,this._interactionManager=new InteractionManager(e,t);const i=t.canvas.size;this.quadTree=new QuadTree(qTreeRectangle(i),qTreeCapacity),this.movers=this._engine.plugins.getMovers(t,!0),this.updaters=this._engine.plugins.getUpdaters(t,!0)}get count(){return this._array.length}addManualParticles(){const e=this._container,t=e.actualOptions;for(const i of t.manualParticles)this.addParticle(i.position?getPosition(i.position,e.canvas.size):void 0,i.options)}addParticle(e,t,i,n){const s=this._container,o=s.actualOptions,a=o.particles.number.limit;if(a>0){const l=this.count+1-a;l>0&&this.removeQuantity(l)}return this._pushParticle(e,t,i,n)}clear(){this._array=[],this._zArray=[]}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}async draw(e){const t=this._container;t.canvas.clear(),await this.update(e);for(const[,i]of t.plugins)t.canvas.drawPlugin(i,e);for(const i of this._zArray)i.draw(e)}filter(e){return this._array.filter(e)}find(e){return this._array.find(e)}handleClickMode(e){this._interactionManager.handleClickMode(e)}init(){var n;const e=this._container,t=e.actualOptions;this.lastZIndex=0,this.needsSort=!1;let i=!1;this.updaters=this._engine.plugins.getUpdaters(e,!0),this._interactionManager.init();for(const[,s]of e.plugins)if(s.particlesInitialization!==void 0&&(i=s.particlesInitialization()),i)break;this._interactionManager.init();for(const[,s]of e.pathGenerators)s.init(e);if(this.addManualParticles(),!i){for(const s in t.particles.groups){const o=t.particles.groups[s];for(let a=this.count,l=0;l<((n=o.number)==null?void 0:n.value)&&a<t.particles.number.value;a++,l++)this.addParticle(void 0,o,s)}for(let s=this.count;s<t.particles.number.value;s++)this.addParticle()}}push(e,t,i,n){this.pushing=!0;for(let s=0;s<e;s++)this.addParticle(t==null?void 0:t.position,i,n);this.pushing=!1}async redraw(){this.clear(),this.init(),await this.draw({value:0,factor:0})}remove(e,t,i){this.removeAt(this._array.indexOf(e),void 0,t,i)}removeAt(e,t=1,i,n){if(e<0||e>this.count)return;let s=0;for(let o=e;s<t&&o<this.count;o++)this._removeParticle(o--,i,n)&&s++}removeQuantity(e,t){this.removeAt(0,e,t)}setDensity(){const e=this._container.actualOptions,t=e.particles.groups;for(const i in t)this._applyDensity(t[i],0,i);this._applyDensity(e.particles,e.manualParticles.length)}async update(e){const t=this._container,i=new Set;this.quadTree=new QuadTree(qTreeRectangle(t.canvas.size),qTreeCapacity);for(const[,n]of t.pathGenerators)n.update();for(const[,n]of t.plugins)n.update&&n.update(e);for(const n of this._array){const s=t.canvas.resizeFactor;s&&!n.ignoresResizeRatio&&(n.position.x*=s.width,n.position.y*=s.height,n.initialPosition.x*=s.width,n.initialPosition.y*=s.height),n.ignoresResizeRatio=!1,await this._interactionManager.reset(n);for(const[,o]of this._container.plugins){if(n.destroyed)break;o.particleUpdate&&o.particleUpdate(n,e)}for(const o of this.movers)o.isEnabled(n)&&o.move(n,e);if(n.destroyed){i.add(n);continue}this.quadTree.insert(new Point(n.getPosition(),n))}if(i.size){const n=s=>!i.has(s);this._array=this.filter(n),this._zArray=this._zArray.filter(n),this.pool.push(...i)}await this._interactionManager.externalInteract(e);for(const n of this._array){for(const s of this.updaters)s.update(n,e);!n.destroyed&&!n.spawning&&await this._interactionManager.particlesInteract(n,e)}if(delete t.canvas.resizeFactor,this.needsSort){const n=this._zArray;n.sort((s,o)=>o.position.z-s.position.z||s.id-o.id),this.lastZIndex=n[n.length-1].position.z,this.needsSort=!1}}};class Retina{constructor(e){this.container=e,this.pixelRatio=1,this.reduceFactor=1}init(){const e=this.container,t=e.actualOptions;this.pixelRatio=!t.detectRetina||isSsr()?1:window.devicePixelRatio,this.reduceFactor=1;const i=this.pixelRatio;if(e.canvas.element){const o=e.canvas.element;e.canvas.size.width=o.offsetWidth*i,e.canvas.size.height=o.offsetHeight*i}const n=t.particles,s=n.move;this.attractDistance=getRangeValue(s.attract.distance)*i,this.maxSpeed=getRangeValue(s.gravity.maxSpeed)*i,this.sizeAnimationSpeed=getRangeValue(n.size.animation.speed)*i}initParticle(e){const t=e.options,i=this.pixelRatio,n=t.move,s=n.distance,o=e.retina;o.attractDistance=getRangeValue(n.attract.distance)*i,o.moveDrift=getRangeValue(n.drift)*i,o.moveSpeed=getRangeValue(n.speed)*i,o.sizeAnimationSpeed=getRangeValue(t.size.animation.speed)*i;const a=o.maxDistance;a.horizontal=s.horizontal!==void 0?s.horizontal*i:void 0,a.vertical=s.vertical!==void 0?s.vertical*i:void 0,o.maxSpeed=getRangeValue(n.gravity.maxSpeed)*i}}function guardCheck(r){return r&&!r.destroyed}function initDelta(r,e=60,t=!1){return{value:r,factor:t?60/e:60*r/1e3}}function loadContainerOptions(r,e,...t){const i=new Options(r,e);return loadOptions(i,...t),i}const defaultPathGeneratorKey="default",defaultPathGenerator={generate:r=>r.velocity,init:()=>{},update:()=>{},reset:()=>{}};class Container{constructor(e,t,i){this.id=t,this._intersectionManager=n=>{if(!(!guardCheck(this)||!this.actualOptions.pauseOnOutsideViewport))for(const s of n)s.target===this.interactivity.element&&(s.isIntersecting?this.play:this.pause)()},this._nextFrame=async n=>{try{if(!this.smooth&&this.lastFrameTime!==void 0&&n<this.lastFrameTime+1e3/this.fpsLimit){this.draw(!1);return}this.lastFrameTime??(this.lastFrameTime=n);const s=initDelta(n-this.lastFrameTime,this.fpsLimit,this.smooth);if(this.addLifeTime(s.value),this.lastFrameTime=n,s.value>1e3){this.draw(!1);return}if(await this.particles.draw(s),!this.alive()){this.destroy();return}this.getAnimationStatus()&&this.draw(!1)}catch(s){getLogger().error(`${errorPrefix} in animation loop`,s)}},this._engine=e,this.fpsLimit=120,this.smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this.lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._sourceOptions=i,this._initialSourceOptions=i,this.retina=new Retina(this),this.canvas=new Canvas(this),this.particles=new Particles$1(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.drawers=new Map,this._options=loadContainerOptions(this._engine,this),this.actualOptions=loadContainerOptions(this._engine,this),this._eventListeners=new EventListeners(this),typeof IntersectionObserver<"u"&&IntersectionObserver&&(this._intersectionObserver=new IntersectionObserver(n=>this._intersectionManager(n))),this._engine.dispatchEvent("containerBuilt",{container:this})}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(e){if(!guardCheck(this))return;const t=this.interactivity.element;if(!t)return;const i=(g,m,_)=>{if(!guardCheck(this))return;const b=this.retina.pixelRatio,d={x:m.x*b,y:m.y*b},c=this.particles.quadTree.queryCircle(d,_*b);e(g,c)},n=g=>{if(!guardCheck(this))return;const m=g,_={x:m.offsetX||m.clientX,y:m.offsetY||m.clientY};i(g,_,1)},s=()=>{guardCheck(this)&&(h=!0,u=!1)},o=()=>{guardCheck(this)&&(u=!0)},a=g=>{if(guardCheck(this)){if(h&&!u){const m=g;let _=m.touches[m.touches.length-1];if(!_&&(_=m.changedTouches[m.changedTouches.length-1],!_))return;const b=this.canvas.element,d=b?b.getBoundingClientRect():void 0,c={x:_.clientX-(d?d.left:0),y:_.clientY-(d?d.top:0)};i(g,c,Math.max(_.radiusX,_.radiusY))}h=!1,u=!1}},l=()=>{guardCheck(this)&&(h=!1,u=!1)};let h=!1,u=!1;t.addEventListener("click",n),t.addEventListener("touchstart",s),t.addEventListener("touchmove",o),t.addEventListener("touchend",a),t.addEventListener("touchcancel",l)}addLifeTime(e){this._lifeTime+=e}addPath(e,t,i=!1){return!guardCheck(this)||!i&&this.pathGenerators.has(e)?!1:(this.pathGenerators.set(e,t??defaultPathGenerator),!0)}alive(){return!this._duration||this._lifeTime<=this._duration}destroy(){if(!guardCheck(this))return;this.stop(),this.particles.destroy(),this.canvas.destroy();for(const[,i]of this.drawers)i.destroy&&i.destroy(this);for(const i of this.drawers.keys())this.drawers.delete(i);this._engine.plugins.destroy(this),this.destroyed=!0;const e=this._engine.dom(),t=e.findIndex(i=>i===this);t>=0&&e.splice(t,1),this._engine.dispatchEvent("containerDestroyed",{container:this})}draw(e){if(!guardCheck(this))return;let t=e;this._drawAnimationFrame=requestAnimationFrame(async i=>{t&&(this.lastFrameTime=void 0,t=!1),await this._nextFrame(i)})}async export(e,t={}){for(const[,i]of this.plugins){if(!i.export)continue;const n=await i.export(e,t);if(n.supported)return n.blob}getLogger().error(`${errorPrefix} - Export plugin with type ${e} not found`)}getAnimationStatus(){return!this._paused&&!this.pageHidden&&guardCheck(this)}handleClickMode(e){if(guardCheck(this)){this.particles.handleClickMode(e);for(const[,t]of this.plugins)t.handleClickMode&&t.handleClickMode(e)}}async init(){if(!guardCheck(this))return;const e=this._engine.plugins.getSupportedShapes();for(const i of e){const n=this._engine.plugins.getShapeDrawer(i);n&&this.drawers.set(i,n)}this._options=loadContainerOptions(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=loadContainerOptions(this._engine,this,this._options);const t=this._engine.plugins.getAvailablePlugins(this);for(const[i,n]of t)this.plugins.set(i,n);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize(),this.zLayers=this.actualOptions.zLayers,this._duration=getRangeValue(this.actualOptions.duration)*1e3,this._delay=getRangeValue(this.actualOptions.delay)*1e3,this._lifeTime=0,this.fpsLimit=this.actualOptions.fpsLimit>0?this.actualOptions.fpsLimit:120,this.smooth=this.actualOptions.smooth;for(const[,i]of this.drawers)i.init&&await i.init(this);for(const[,i]of this.plugins)i.init&&await i.init();this._engine.dispatchEvent("containerInit",{container:this}),this.particles.init(),this.particles.setDensity();for(const[,i]of this.plugins)i.particlesSetup&&i.particlesSetup();this._engine.dispatchEvent("particlesSetup",{container:this})}async loadTheme(e){guardCheck(this)&&(this._currentTheme=e,await this.refresh())}pause(){if(guardCheck(this)&&(this._drawAnimationFrame!==void 0&&(cancelAnimationFrame(this._drawAnimationFrame),delete this._drawAnimationFrame),!this._paused)){for(const[,e]of this.plugins)e.pause&&e.pause();this.pageHidden||(this._paused=!0),this._engine.dispatchEvent("containerPaused",{container:this})}}play(e){if(!guardCheck(this))return;const t=this._paused||e;if(this._firstStart&&!this.actualOptions.autoPlay){this._firstStart=!1;return}if(this._paused&&(this._paused=!1),t)for(const[,i]of this.plugins)i.play&&i.play();this._engine.dispatchEvent("containerPlay",{container:this}),this.draw(t||!1)}async refresh(){if(guardCheck(this))return this.stop(),this.start()}async reset(){if(guardCheck(this))return this._initialSourceOptions=void 0,this._options=loadContainerOptions(this._engine,this),this.actualOptions=loadContainerOptions(this._engine,this,this._options),this.refresh()}setNoise(e,t,i){guardCheck(this)&&this.setPath(e,t,i)}setPath(e,t,i){if(!e||!guardCheck(this))return;const n={...defaultPathGenerator};if(isFunction$1(e))n.generate=e,t&&(n.init=t),i&&(n.update=i);else{const s=n;n.generate=e.generate||s.generate,n.init=e.init||s.init,n.update=e.update||s.update}this.addPath(defaultPathGeneratorKey,n,!0)}async start(){!guardCheck(this)||this.started||(await this.init(),this.started=!0,await new Promise(e=>{this._delayTimeout=setTimeout(async()=>{this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element);for(const[,t]of this.plugins)t.start&&await t.start();this._engine.dispatchEvent("containerStarted",{container:this}),this.play(),e()},this._delay)}))}stop(){if(!(!guardCheck(this)||!this.started)){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);for(const[,e]of this.plugins)e.stop&&e.stop();for(const e of this.plugins.keys())this.plugins.delete(e);this._sourceOptions=this._options,this._engine.dispatchEvent("containerStopped",{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];const e=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this.responsiveMaxWidth===e?!1:(this.responsiveMaxWidth=e,!0)}}class EventDispatcher{constructor(){this._listeners=new Map}addEventListener(e,t){this.removeEventListener(e,t);let i=this._listeners.get(e);i||(i=[],this._listeners.set(e,i)),i.push(t)}dispatchEvent(e,t){const i=this._listeners.get(e);i&&i.forEach(n=>n(t))}hasEventListener(e){return!!this._listeners.get(e)}removeAllEventListeners(e){e?this._listeners.delete(e):this._listeners=new Map}removeEventListener(e,t){const i=this._listeners.get(e);if(!i)return;const n=i.length,s=i.indexOf(t);s<0||(n===1?this._listeners.delete(e):i.splice(s,1))}}function getItemsFromInitializer(r,e,t,i=!1){let n=e.get(r);return(!n||i)&&(n=[...t.values()].map(s=>s(r)),e.set(r,n)),n}class Plugins{constructor(e){this._engine=e,this.plugins=[],this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.drawers=new Map,this.pathGenerators=new Map}addInteractor(e,t){this._initializers.interactors.set(e,t)}addParticleMover(e,t){this._initializers.movers.set(e,t)}addParticleUpdater(e,t){this._initializers.updaters.set(e,t)}addPathGenerator(e,t){!this.getPathGenerator(e)&&this.pathGenerators.set(e,t)}addPlugin(e){!this.getPlugin(e.id)&&this.plugins.push(e)}addPreset(e,t,i=!1){(i||!this.getPreset(e))&&this.presets.set(e,t)}addShapeDrawer(e,t){executeOnSingleOrMultiple(e,i=>{!this.getShapeDrawer(i)&&this.drawers.set(i,t)})}destroy(e){this.updaters.delete(e),this.movers.delete(e),this.interactors.delete(e)}getAvailablePlugins(e){const t=new Map;for(const i of this.plugins)i.needsPlugin(e.actualOptions)&&t.set(i.id,i.getPlugin(e));return t}getInteractors(e,t=!1){return getItemsFromInitializer(e,this.interactors,this._initializers.interactors,t)}getMovers(e,t=!1){return getItemsFromInitializer(e,this.movers,this._initializers.movers,t)}getPathGenerator(e){return this.pathGenerators.get(e)}getPlugin(e){return this.plugins.find(t=>t.id===e)}getPreset(e){return this.presets.get(e)}getShapeDrawer(e){return this.drawers.get(e)}getSupportedShapes(){return this.drawers.keys()}getUpdaters(e,t=!1){return getItemsFromInitializer(e,this.updaters,this._initializers.updaters,t)}loadOptions(e,t){for(const i of this.plugins)i.loadOptions(e,t)}loadParticlesOptions(e,t,...i){const n=this.updaters.get(e);if(n)for(const s of n)s.loadOptions&&s.loadOptions(t,...i)}}async function getDataFromUrl(r){const e=itemFromSingleOrMultiple(r.url,r.index);if(!e)return r.fallback;const t=await fetch(e);return t.ok?t.json():(getLogger().error(`${errorPrefix} ${t.status} while retrieving config file`),r.fallback)}function isParamsEmpty(r){return!r.id&&!r.element&&!r.url&&!r.options}function isParams(r){return!isParamsEmpty(r)}class Engine{constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new EventDispatcher,this._initialized=!1,this.plugins=new Plugins(this)}get configs(){const e={};for(const[t,i]of this._configs)e[t]=i;return e}get version(){return"2.12.0"}addConfig(e,t){isString(e)?t&&(t.name=e,this._configs.set(e,t)):this._configs.set(e.name??"default",e)}addEventListener(e,t){this._eventDispatcher.addEventListener(e,t)}async addInteractor(e,t,i=!0){this.plugins.addInteractor(e,t),await this.refresh(i)}async addMover(e,t,i=!0){this.plugins.addParticleMover(e,t),await this.refresh(i)}async addParticleUpdater(e,t,i=!0){this.plugins.addParticleUpdater(e,t),await this.refresh(i)}async addPathGenerator(e,t,i=!0){this.plugins.addPathGenerator(e,t),await this.refresh(i)}async addPlugin(e,t=!0){this.plugins.addPlugin(e),await this.refresh(t)}async addPreset(e,t,i=!1,n=!0){this.plugins.addPreset(e,t,i),await this.refresh(n)}async addShape(e,t,i,n,s,o=!0){let a,l=o,h,u,g;isBoolean(i)?(l=i,h=void 0):h=i,isBoolean(n)?(l=n,u=void 0):u=n,isBoolean(s)?(l=s,g=void 0):g=s,isFunction$1(t)?a={afterEffect:u,destroy:g,draw:t,init:h}:a=t,this.plugins.addShapeDrawer(e,a),await this.refresh(l)}dispatchEvent(e,t){this._eventDispatcher.dispatchEvent(e,t)}dom(){return this._domArray}domItem(e){const t=this.dom(),i=t[e];if(!i||i.destroyed){t.splice(e,1);return}return i}init(){this._initialized||(this._initialized=!0)}async load(e,t){return this.loadFromArray(e,t)}async loadFromArray(e,t,i){let n;return isParams(e)?n=e:(n={},isString(e)?n.id=e:n.options=e,isNumber$1(t)?n.index=t:n.options=t??n.options,n.index=i??n.index),this._loadParams(n)}async loadJSON(e,t,i){let n,s;return isNumber$1(t)||t===void 0?n=e:(s=e,n=t),this._loadParams({id:s,url:n,index:i})}async refresh(e=!0){e&&this.dom().forEach(t=>t.refresh())}removeEventListener(e,t){this._eventDispatcher.removeEventListener(e,t)}async set(e,t,i,n){const s={index:n};return isString(e)?s.id=e:s.element=e,t instanceof HTMLElement?s.element=t:s.options=t,isNumber$1(i)?s.index=i:s.options=i??s.options,this._loadParams(s)}async setJSON(e,t,i,n){const s={};return e instanceof HTMLElement?(s.element=e,s.url=t,s.index=i):(s.id=e,s.element=t,s.url=i,s.index=n),this._loadParams(s)}setOnClickHandler(e){const t=this.dom();if(!t.length)throw new Error(`${errorPrefix} can only set click handlers after calling tsParticles.load()`);for(const i of t)i.addClickHandler(e)}async _loadParams(e){const t=e.id??`tsparticles${Math.floor(getRandom()*1e4)}`,{index:i,url:n}=e,s=n?await getDataFromUrl({fallback:e.options,url:n,index:i}):e.options;let o=e.element??document.getElementById(t);o||(o=document.createElement("div"),o.id=t,document.body.append(o));const a=itemFromSingleOrMultiple(s,i),l=this.dom(),h=l.findIndex(m=>m.id===t);if(h>=0){const m=this.domItem(h);m&&!m.destroyed&&(m.destroy(),l.splice(h,1))}let u;if(o.tagName.toLowerCase()==="canvas")u=o,u.dataset[generatedAttribute]="false";else{const m=o.getElementsByTagName("canvas");m.length?(u=m[0],u.dataset[generatedAttribute]="false"):(u=document.createElement("canvas"),u.dataset[generatedAttribute]="true",o.appendChild(u))}u.style.width||(u.style.width="100%"),u.style.height||(u.style.height="100%");const g=new Container(this,t,a);return h>=0?l.splice(h,0,g):l.push(g),g.canvas.loadCanvas(u),await g.start(),g}}class HslColorManager{constructor(){this.key="hsl",this.stringPrefix="hsl"}handleColor(e){const t=e.value,i=t.hsl??e.value;if(i.h!==void 0&&i.s!==void 0&&i.l!==void 0)return hslToRgb(i)}handleRangeColor(e){const t=e.value,i=t.hsl??e.value;if(i.h!==void 0&&i.l!==void 0)return hslToRgb({h:getRangeValue(i.h),l:getRangeValue(i.l),s:getRangeValue(i.s)})}parseString(e){if(!e.startsWith("hsl"))return;const t=/hsla?\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([\d.%]+)\s*)?\)/i,i=t.exec(e);return i?hslaToRgba({a:i.length>4?parseAlpha(i[5]):1,h:parseInt(i[1],10),l:parseInt(i[3],10),s:parseInt(i[2],10)}):void 0}}class RgbColorManager{constructor(){this.key="rgb",this.stringPrefix="rgb"}handleColor(e){const t=e.value,i=t.rgb??e.value;if(i.r!==void 0)return i}handleRangeColor(e){const t=e.value,i=t.rgb??e.value;if(i.r!==void 0)return{r:getRangeValue(i.r),g:getRangeValue(i.g),b:getRangeValue(i.b)}}parseString(e){if(!e.startsWith(this.stringPrefix))return;const t=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([\d.%]+)\s*)?\)/i,i=t.exec(e);return i?{a:i.length>4?parseAlpha(i[5]):1,b:parseInt(i[3],10),g:parseInt(i[2],10),r:parseInt(i[1],10)}:void 0}}function init(){const r=new RgbColorManager,e=new HslColorManager;addColorManager(r),addColorManager(e);const t=new Engine;return t.init(),t}class ExternalInteractorBase{constructor(e){this.container=e,this.type="external"}}class ParticlesInteractorBase{constructor(e){this.container=e,this.type="particles"}}const tsParticles=init();isSsr()||(window.tsParticles=tsParticles);class Particles{static init(e){var s;const t=new Particles,i=e.selector;if(!i)throw new Error("No selector provided");const n=document.querySelector(i);if(!n)throw new Error("No element found for selector");return tsParticles.set(i.replace(".","").replace("!",""),n,{fullScreen:{enable:!1},particles:{color:{value:e.color??"!000000"},links:{color:"random",distance:e.minDistance??120,enable:e.connectParticles??!1},move:{enable:!0,speed:e.speed??.5},number:{value:e.maxParticles??100},size:{value:{min:1,max:e.sizeVariations??3}}},responsive:(s=e.responsive)==null?void 0:s.map(o=>{var a,l,h,u,g;return{maxWidth:o.breakpoint,options:{particles:{color:{value:(a=o.options)==null?void 0:a.color},links:{distance:(l=o.options)==null?void 0:l.minDistance,enable:(h=o.options)==null?void 0:h.connectParticles},number:{value:e.maxParticles},move:{enable:!0,speed:(u=o.options)==null?void 0:u.speed},size:{value:(g=o.options)==null?void 0:g.sizeVariations}}}}})}).then(o=>{t._container=o}),t}destroy(){const e=this._container;e&&e.destroy()}pauseAnimation(){const e=this._container;e&&e.pause()}resumeAnimation(){const e=this._container;e&&e.play()}}const initParticlesJS=r=>{const e=(i,n)=>r.load(i,n);e.load=(i,n,s)=>{r.loadJSON(i,n).then(o=>{o&&s(o)}).catch(()=>{s(void 0)})},e.setOnClickHandler=i=>{r.setOnClickHandler(i)};const t=r.dom();return{particlesJS:e,pJSDom:t}},initPjs=r=>{const{particlesJS:e,pJSDom:t}=initParticlesJS(r);return window.particlesJS=e,window.pJSDom=t,window.Particles=Particles,{particlesJS:e,pJSDom:t,Particles}};function applyDistance(r){const e=r.initialPosition,{dx:t,dy:i}=getDistances(e,r.position),n=Math.abs(t),s=Math.abs(i),{maxDistance:o}=r.retina,a=o.horizontal,l=o.vertical;if(!(!a&&!l)){if((a&&n>=a||l&&s>=l)&&!r.misplaced)r.misplaced=!!a&&n>a||!!l&&s>l,a&&(r.velocity.x=r.velocity.y/2-r.velocity.x),l&&(r.velocity.y=r.velocity.x/2-r.velocity.y);else if((!a||n<a)&&(!l||s<l)&&r.misplaced)r.misplaced=!1;else if(r.misplaced){const h=r.position,u=r.velocity;a&&(h.x<e.x&&u.x<0||h.x>e.x&&u.x>0)&&(u.x*=-getRandom()),l&&(h.y<e.y&&u.y<0||h.y>e.y&&u.y>0)&&(u.y*=-getRandom())}}}function move(r,e,t,i,n,s){applyPath(r,s);const o=r.gravity,a=o!=null&&o.enable&&o.inverse?-1:1;n&&t&&(r.velocity.x+=n*s.factor/(60*t)),o!=null&&o.enable&&t&&(r.velocity.y+=a*(o.acceleration*s.factor)/(60*t));const l=r.moveDecay;r.velocity.multTo(l);const h=r.velocity.mult(t);o!=null&&o.enable&&i>0&&(!o.inverse&&h.y>=0&&h.y>=i||o.inverse&&h.y<=0&&h.y<=-i)&&(h.y=a*i,t&&(r.velocity.y=h.y/t));const u=r.options.zIndex,g=(1-r.zIndexFactor)**u.velocityRate;h.multTo(g);const{position:m}=r;m.addTo(h),e.vibrate&&(m.x+=Math.sin(m.x*Math.cos(m.y)),m.y+=Math.cos(m.y*Math.sin(m.x)))}function spin(r,e){const t=r.container;if(!r.spin)return;const i={x:r.spin.direction==="clockwise"?Math.cos:Math.sin,y:r.spin.direction==="clockwise"?Math.sin:Math.cos};r.position.x=r.spin.center.x+r.spin.radius*i.x(r.spin.angle),r.position.y=r.spin.center.y+r.spin.radius*i.y(r.spin.angle),r.spin.radius+=r.spin.acceleration;const n=Math.max(t.canvas.size.width,t.canvas.size.height);r.spin.radius>n/2?(r.spin.radius=n/2,r.spin.acceleration*=-1):r.spin.radius<0&&(r.spin.radius=0,r.spin.acceleration*=-1),r.spin.angle+=e/100*(1-r.spin.radius/n)}function applyPath(r,e){var o;const t=r.options,i=t.move.path;if(!i.enable)return;if(r.lastPathTime<=r.pathDelay){r.lastPathTime+=e.value;return}const s=(o=r.pathGenerator)==null?void 0:o.generate(r,e);s&&r.velocity.addTo(s),i.clamp&&(r.velocity.x=clamp$1(r.velocity.x,-1,1),r.velocity.y=clamp$1(r.velocity.y,-1,1)),r.lastPathTime-=r.pathDelay}function getProximitySpeedFactor(r){return r.slow.inRange?r.slow.factor:1}const diffFactor=2;class BaseMover{constructor(){this._initSpin=e=>{const t=e.container,i=e.options,n=i.move.spin;if(!n.enable)return;const s=n.position??{x:50,y:50},o={x:s.x/100*t.canvas.size.width,y:s.y/100*t.canvas.size.height},a=e.getPosition(),l=getDistance(a,o),h=getRangeValue(n.acceleration);e.retina.spinAcceleration=h*t.retina.pixelRatio,e.spin={center:o,direction:e.velocity.x>=0?"clockwise":"counter-clockwise",angle:e.velocity.angle,radius:l,acceleration:e.retina.spinAcceleration}}}init(e){const t=e.options,i=t.move.gravity;e.gravity={enable:i.enable,acceleration:getRangeValue(i.acceleration),inverse:i.inverse},this._initSpin(e)}isEnabled(e){return!e.destroyed&&e.options.move.enable}move(e,t){var b,d;const i=e.options,n=i.move;if(!n.enable)return;const s=e.container,o=s.retina.pixelRatio,a=getProximitySpeedFactor(e),l=((b=e.retina).moveSpeed??(b.moveSpeed=getRangeValue(n.speed)*o))*s.retina.reduceFactor,h=(d=e.retina).moveDrift??(d.moveDrift=getRangeValue(e.options.move.drift)*o),u=getRangeMax(i.size.value)*o,g=n.size?e.getRadius()/u:1,m=l*g*a*(t.factor||1)/diffFactor,_=e.retina.maxSpeed??s.retina.maxSpeed;n.spin.enable?spin(e,m):move(e,n,m,_,h,t),applyDistance(e)}}async function loadBaseMover(r,e=!0){await r.addMover("base",()=>new BaseMover,e)}class CircleDrawer{draw(e,t,i){t.circleRange||(t.circleRange={min:0,max:Math.PI*2});const n=t.circleRange;e.arc(0,0,i,n.min,n.max,!1)}getSidesCount(){return 12}particleInit(e,t){const i=t.shapeData,n=(i==null?void 0:i.angle)??{max:360,min:0};t.circleRange=isObject$1(n)?{min:n.min*Math.PI/180,max:n.max*Math.PI/180}:{min:0,max:n*Math.PI/180}}}async function loadCircleShape(r,e=!0){await r.addShape("circle",new CircleDrawer,e)}function updateColorValue$1(r,e,t,i,n){if(!e||!t.enable||(e.maxLoops??0)>0&&(e.loops??0)>(e.maxLoops??0)||(e.time||(e.time=0),(e.delayTime??0)>0&&e.time<(e.delayTime??0)&&(e.time+=r.value),(e.delayTime??0)>0&&e.time<(e.delayTime??0)))return;const s=randomInRange(t.offset),o=(e.velocity??0)*r.factor+s*3.6,a=e.decay??1;!n||e.status==="increasing"?(e.value+=o,e.value>i&&(e.loops||(e.loops=0),e.loops++,n&&(e.status="decreasing",e.value-=e.value%i))):(e.value-=o,e.value<0&&(e.loops||(e.loops=0),e.loops++,e.status="increasing",e.value+=e.value)),e.velocity&&a!==1&&(e.velocity*=a),e.value>i&&(e.value%=i)}function updateColor(r,e){const{h:t,s:i,l:n}=r.options.color.animation,{color:s}=r;if(!s)return;const{h:o,s:a,l}=s;o&&updateColorValue$1(e,o,t,360,!1),a&&updateColorValue$1(e,a,i,100,!0),l&&updateColorValue$1(e,l,n,100,!0)}class ColorUpdater{constructor(e){this.container=e}init(e){const t=rangeColorToHsl(e.options.color,e.id,e.options.reduceDuplicates);t&&(e.color=getHslAnimationFromHsl(t,e.options.color.animation,this.container.retina.reduceFactor))}isEnabled(e){const{h:t,s:i,l:n}=e.options.color.animation,{color:s}=e;return!e.destroyed&&!e.spawning&&((s==null?void 0:s.h.value)!==void 0&&t.enable||(s==null?void 0:s.s.value)!==void 0&&i.enable||(s==null?void 0:s.l.value)!==void 0&&n.enable)}update(e,t){updateColor(e,t)}}async function loadColorUpdater(r,e=!0){await r.addParticleUpdater("color",t=>new ColorUpdater(t),e)}function checkDestroy$1(r,e,t,i){switch(r.options.opacity.animation.destroy){case"max":e>=i&&r.destroy();break;case"min":e<=t&&r.destroy();break}}function updateOpacity(r,e){const t=r.opacity;if(r.destroyed||!(t!=null&&t.enable)||(t.maxLoops??0)>0&&(t.loops??0)>(t.maxLoops??0))return;const i=t.min,n=t.max,s=t.decay??1;if(t.time||(t.time=0),(t.delayTime??0)>0&&t.time<(t.delayTime??0)&&(t.time+=e.value),!((t.delayTime??0)>0&&t.time<(t.delayTime??0))){switch(t.status){case"increasing":t.value>=n?(t.status="decreasing",t.loops||(t.loops=0),t.loops++):t.value+=(t.velocity??0)*e.factor;break;case"decreasing":t.value<=i?(t.status="increasing",t.loops||(t.loops=0),t.loops++):t.value-=(t.velocity??0)*e.factor;break}t.velocity&&t.decay!==1&&(t.velocity*=s),checkDestroy$1(r,t.value,i,n),r.destroyed||(t.value=clamp$1(t.value,i,n))}}class OpacityUpdater{constructor(e){this.container=e}init(e){const t=e.options.opacity;e.opacity=initParticleNumericAnimationValue(t,1);const i=t.animation;i.enable&&(e.opacity.velocity=getRangeValue(i.speed)/100*this.container.retina.reduceFactor,i.sync||(e.opacity.velocity*=getRandom()))}isEnabled(e){return!e.destroyed&&!e.spawning&&!!e.opacity&&e.opacity.enable&&((e.opacity.maxLoops??0)<=0||(e.opacity.maxLoops??0)>0&&(e.opacity.loops??0)<(e.opacity.maxLoops??0))}reset(e){e.opacity&&(e.opacity.time=0,e.opacity.loops=0)}update(e,t){this.isEnabled(e)&&updateOpacity(e,t)}}async function loadOpacityUpdater(r,e=!0){await r.addParticleUpdater("opacity",t=>new OpacityUpdater(t),e)}function bounceHorizontal(r){if(r.outMode!=="bounce"&&r.outMode!=="bounce-horizontal"&&r.outMode!=="bounceHorizontal"&&r.outMode!=="split"||r.direction!=="left"&&r.direction!=="right")return;r.bounds.right<0&&r.direction==="left"?r.particle.position.x=r.size+r.offset.x:r.bounds.left>r.canvasSize.width&&r.direction==="right"&&(r.particle.position.x=r.canvasSize.width-r.size-r.offset.x);const e=r.particle.velocity.x;let t=!1;if(r.direction==="right"&&r.bounds.right>=r.canvasSize.width&&e>0||r.direction==="left"&&r.bounds.left<=0&&e<0){const n=getValue(r.particle.options.bounce.horizontal);r.particle.velocity.x*=-n,t=!0}if(!t)return;const i=r.offset.x+r.size;r.bounds.right>=r.canvasSize.width&&r.direction==="right"?r.particle.position.x=r.canvasSize.width-i:r.bounds.left<=0&&r.direction==="left"&&(r.particle.position.x=i),r.outMode==="split"&&r.particle.destroy()}function bounceVertical(r){if(r.outMode!=="bounce"&&r.outMode!=="bounce-vertical"&&r.outMode!=="bounceVertical"&&r.outMode!=="split"||r.direction!=="bottom"&&r.direction!=="top")return;r.bounds.bottom<0&&r.direction==="top"?r.particle.position.y=r.size+r.offset.y:r.bounds.top>r.canvasSize.height&&r.direction==="bottom"&&(r.particle.position.y=r.canvasSize.height-r.size-r.offset.y);const e=r.particle.velocity.y;let t=!1;if(r.direction==="bottom"&&r.bounds.bottom>=r.canvasSize.height&&e>0||r.direction==="top"&&r.bounds.top<=0&&e<0){const n=getValue(r.particle.options.bounce.vertical);r.particle.velocity.y*=-n,t=!0}if(!t)return;const i=r.offset.y+r.size;r.bounds.bottom>=r.canvasSize.height&&r.direction==="bottom"?r.particle.position.y=r.canvasSize.height-i:r.bounds.top<=0&&r.direction==="top"&&(r.particle.position.y=i),r.outMode==="split"&&r.particle.destroy()}class BounceOutMode{constructor(e){this.container=e,this.modes=["bounce","bounce-vertical","bounce-horizontal","bounceVertical","bounceHorizontal","split"]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;let o=!1;for(const[,m]of s.plugins)if(m.particleBounce!==void 0&&(o=m.particleBounce(e,i,t)),o)break;if(o)return;const a=e.getPosition(),l=e.offset,h=e.getRadius(),u=calculateBounds(a,h),g=s.canvas.size;bounceHorizontal({particle:e,outMode:n,direction:t,bounds:u,canvasSize:g,offset:l,size:h}),bounceVertical({particle:e,outMode:n,direction:t,bounds:u,canvasSize:g,offset:l,size:h})}}class DestroyOutMode{constructor(e){this.container=e,this.modes=["destroy"]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;switch(e.outType){case"normal":case"outside":if(isPointInside(e.position,s.canvas.size,Vector.origin,e.getRadius(),t))return;break;case"inside":{const{dx:o,dy:a}=getDistances(e.position,e.moveCenter),{x:l,y:h}=e.velocity;if(l<0&&o>e.moveCenter.radius||h<0&&a>e.moveCenter.radius||l>=0&&o<-e.moveCenter.radius||h>=0&&a<-e.moveCenter.radius)return;break}}s.particles.remove(e,void 0,!0)}}class NoneOutMode{constructor(e){this.container=e,this.modes=["none"]}update(e,t,i,n){if(!this.modes.includes(n)||e.options.move.distance.horizontal&&(t==="left"||t==="right")||e.options.move.distance.vertical&&(t==="top"||t==="bottom"))return;const s=e.options.move.gravity,o=this.container,a=o.canvas.size,l=e.getRadius();if(s.enable){const h=e.position;(!s.inverse&&h.y>a.height+l&&t==="bottom"||s.inverse&&h.y<-l&&t==="top")&&o.particles.remove(e)}else{if(e.velocity.y>0&&e.position.y<=a.height+l||e.velocity.y<0&&e.position.y>=-l||e.velocity.x>0&&e.position.x<=a.width+l||e.velocity.x<0&&e.position.x>=-l)return;isPointInside(e.position,o.canvas.size,Vector.origin,l,t)||o.particles.remove(e)}}}class OutOutMode{constructor(e){this.container=e,this.modes=["out"]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;switch(e.outType){case"inside":{const{x:o,y:a}=e.velocity,l=Vector.origin;l.length=e.moveCenter.radius,l.angle=e.velocity.angle+Math.PI,l.addTo(Vector.create(e.moveCenter));const{dx:h,dy:u}=getDistances(e.position,l);if(o<=0&&h>=0||a<=0&&u>=0||o>=0&&h<=0||a>=0&&u<=0)return;e.position.x=Math.floor(randomInRange({min:0,max:s.canvas.size.width})),e.position.y=Math.floor(randomInRange({min:0,max:s.canvas.size.height}));const{dx:g,dy:m}=getDistances(e.position,e.moveCenter);e.direction=Math.atan2(-m,-g),e.velocity.angle=e.direction;break}default:{if(isPointInside(e.position,s.canvas.size,Vector.origin,e.getRadius(),t))return;switch(e.outType){case"outside":{e.position.x=Math.floor(randomInRange({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.x,e.position.y=Math.floor(randomInRange({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.y;const{dx:o,dy:a}=getDistances(e.position,e.moveCenter);e.moveCenter.radius&&(e.direction=Math.atan2(a,o),e.velocity.angle=e.direction);break}case"normal":{const o=e.options.move.warp,a=s.canvas.size,l={bottom:a.height+e.getRadius()+e.offset.y,left:-e.getRadius()-e.offset.x,right:a.width+e.getRadius()+e.offset.x,top:-e.getRadius()-e.offset.y},h=e.getRadius(),u=calculateBounds(e.position,h);t==="right"&&u.left>a.width+e.offset.x?(e.position.x=l.left,e.initialPosition.x=e.position.x,o||(e.position.y=getRandom()*a.height,e.initialPosition.y=e.position.y)):t==="left"&&u.right<-e.offset.x&&(e.position.x=l.right,e.initialPosition.x=e.position.x,o||(e.position.y=getRandom()*a.height,e.initialPosition.y=e.position.y)),t==="bottom"&&u.top>a.height+e.offset.y?(o||(e.position.x=getRandom()*a.width,e.initialPosition.x=e.position.x),e.position.y=l.top,e.initialPosition.y=e.position.y):t==="top"&&u.bottom<-e.offset.y&&(o||(e.position.x=getRandom()*a.width,e.initialPosition.x=e.position.x),e.position.y=l.bottom,e.initialPosition.y=e.position.y);break}}break}}}}class OutOfCanvasUpdater{constructor(e){this.container=e,this._updateOutMode=(t,i,n,s)=>{for(const o of this.updaters)o.update(t,s,i,n)},this.updaters=[new BounceOutMode(e),new DestroyOutMode(e),new OutOutMode(e),new NoneOutMode(e)]}init(){}isEnabled(e){return!e.destroyed&&!e.spawning}update(e,t){const i=e.options.move.outModes;this._updateOutMode(e,t,i.bottom??i.default,"bottom"),this._updateOutMode(e,t,i.left??i.default,"left"),this._updateOutMode(e,t,i.right??i.default,"right"),this._updateOutMode(e,t,i.top??i.default,"top")}}async function loadOutModesUpdater(r,e=!0){await r.addParticleUpdater("outModes",t=>new OutOfCanvasUpdater(t),e)}function checkDestroy(r,e,t,i){switch(r.options.size.animation.destroy){case"max":e>=i&&r.destroy();break;case"min":e<=t&&r.destroy();break}}function updateSize(r,e){const t=r.size;if(r.destroyed||!t||!t.enable||(t.maxLoops??0)>0&&(t.loops??0)>(t.maxLoops??0))return;const i=(t.velocity??0)*e.factor,n=t.min,s=t.max,o=t.decay??1;if(t.time||(t.time=0),(t.delayTime??0)>0&&t.time<(t.delayTime??0)&&(t.time+=e.value),!((t.delayTime??0)>0&&t.time<(t.delayTime??0))){switch(t.status){case"increasing":t.value>=s?(t.status="decreasing",t.loops||(t.loops=0),t.loops++):t.value+=i;break;case"decreasing":t.value<=n?(t.status="increasing",t.loops||(t.loops=0),t.loops++):t.value-=i}t.velocity&&o!==1&&(t.velocity*=o),checkDestroy(r,t.value,n,s),r.destroyed||(t.value=clamp$1(t.value,n,s))}}class SizeUpdater{init(e){const t=e.container,i=e.options.size,n=i.animation;n.enable&&(e.size.velocity=(e.retina.sizeAnimationSpeed??t.retina.sizeAnimationSpeed)/100*t.retina.reduceFactor,n.sync||(e.size.velocity*=getRandom()))}isEnabled(e){return!e.destroyed&&!e.spawning&&e.size.enable&&((e.size.maxLoops??0)<=0||(e.size.maxLoops??0)>0&&(e.size.loops??0)<(e.size.maxLoops??0))}reset(e){e.size.loops=0}update(e,t){this.isEnabled(e)&&updateSize(e,t)}}async function loadSizeUpdater(r,e=!0){await r.addParticleUpdater("size",()=>new SizeUpdater,e)}async function loadBasic(r,e=!0){await loadBaseMover(r,!1),await loadCircleShape(r,!1),await loadColorUpdater(r,!1),await loadOpacityUpdater(r,!1),await loadOutModesUpdater(r,!1),await loadSizeUpdater(r,!1),await r.refresh(e)}async function loadEasingQuadPlugin(){addEasing("ease-in-quad",r=>r**2),addEasing("ease-out-quad",r=>1-(1-r)**2),addEasing("ease-in-out-quad",r=>r<.5?2*r**2:1-(-2*r+2)**2/2)}class Attract{constructor(){this.distance=200,this.duration=.4,this.easing="ease-out-quad",this.factor=1,this.maxSpeed=50,this.speed=1}load(e){e&&(e.distance!==void 0&&(this.distance=e.distance),e.duration!==void 0&&(this.duration=e.duration),e.easing!==void 0&&(this.easing=e.easing),e.factor!==void 0&&(this.factor=e.factor),e.maxSpeed!==void 0&&(this.maxSpeed=e.maxSpeed),e.speed!==void 0&&(this.speed=e.speed))}}let Attractor$1=class extends ExternalInteractorBase{constructor(e,t){super(t),this._clickAttract=()=>{const i=this.container;i.attract||(i.attract={particles:[]});const{attract:n}=i;if(n.finish||(n.count||(n.count=0),n.count++,n.count===i.particles.count&&(n.finish=!0)),n.clicking){const s=i.interactivity.mouse.clickPosition,o=i.retina.attractModeDistance;if(!o||o<0||!s)return;this._processAttract(s,o,new Circle(s.x,s.y,o))}else n.clicking===!1&&(n.particles=[])},this._hoverAttract=()=>{const i=this.container,n=i.interactivity.mouse.position,s=i.retina.attractModeDistance;!s||s<0||!n||this._processAttract(n,s,new Circle(n.x,n.y,s))},this._processAttract=(i,n,s)=>{const o=this.container,a=o.actualOptions.interactivity.modes.attract;if(!a)return;const l=o.particles.quadTree.query(s,h=>this.isEnabled(h));for(const h of l){const{dx:u,dy:g,distance:m}=getDistances(h.position,i),_=a.speed*a.factor,b=clamp$1(getEasing(a.easing)(1-m/n)*_,0,a.maxSpeed),d=Vector.create(m===0?_:u/m*b,m===0?_:g/m*b);h.position.subFrom(d)}},this._engine=e,t.attract||(t.attract={particles:[]}),this.handleClickMode=i=>{const n=this.container.actualOptions,s=n.interactivity.modes.attract;if(!(!s||i!=="attract")){t.attract||(t.attract={particles:[]}),t.attract.clicking=!0,t.attract.count=0;for(const o of t.attract.particles)this.isEnabled(o)&&o.velocity.setTo(o.initialVelocity);t.attract.particles=[],t.attract.finish=!1,setTimeout(()=>{t.destroyed||(t.attract||(t.attract={particles:[]}),t.attract.clicking=!1)},s.duration*1e3)}}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.attract;t&&(e.retina.attractModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions,i=e.interactivity.status===mouseMoveEvent,n=t.interactivity.events,s=n.onHover.enable,o=n.onHover.mode,a=n.onClick.enable,l=n.onClick.mode;i&&s&&isInArray("attract",o)?this._hoverAttract():a&&isInArray("attract",l)&&this._clickAttract()}isEnabled(e){const t=this.container,i=t.actualOptions,n=t.interactivity.mouse,s=((e==null?void 0:e.interactivity)??i.interactivity).events;if((!n.position||!s.onHover.enable)&&(!n.clickPosition||!s.onClick.enable))return!1;const o=s.onHover.mode,a=s.onClick.mode;return isInArray("attract",o)||isInArray("attract",a)}loadModeOptions(e,...t){e.attract||(e.attract=new Attract);for(const i of t)e.attract.load(i==null?void 0:i.attract)}reset(){}};async function loadExternalAttractInteraction(r,e=!0){await r.addInteractor("externalAttract",t=>new Attractor$1(r,t),e)}class Bounce{constructor(){this.distance=200}load(e){e&&e.distance!==void 0&&(this.distance=e.distance)}}class Bouncer extends ExternalInteractorBase{constructor(e){super(e),this._processBounce=(t,i,n)=>{const s=this.container.particles.quadTree.query(n,o=>this.isEnabled(o));for(const o of s)n instanceof Circle?circleBounce(circleBounceDataFromParticle(o),{position:t,mass:i**2*Math.PI/2,velocity:Vector.origin,factor:Vector.origin}):n instanceof Rectangle&&rectBounce(o,calculateBounds(t,i))},this._processMouseBounce=()=>{const t=this.container,i=t.retina.pixelRatio,n=10*i,s=t.interactivity.mouse.position,o=t.retina.bounceModeDistance;!o||o<0||!s||this._processBounce(s,o,new Circle(s.x,s.y,o+n))},this._singleSelectorBounce=(t,i)=>{const n=this.container,s=document.querySelectorAll(t);s.length&&s.forEach(o=>{const a=o,l=n.retina.pixelRatio,h={x:(a.offsetLeft+a.offsetWidth/2)*l,y:(a.offsetTop+a.offsetHeight/2)*l},u=a.offsetWidth/2*l,g=10*l,m=i.type==="circle"?new Circle(h.x,h.y,u+g):new Rectangle(a.offsetLeft*l-g,a.offsetTop*l-g,a.offsetWidth*l+g*2,a.offsetHeight*l+g*2);this._processBounce(h,u,m)})}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bounce;t&&(e.retina.bounceModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions,i=t.interactivity.events,n=e.interactivity.status===mouseMoveEvent,s=i.onHover.enable,o=i.onHover.mode,a=i.onDiv;n&&s&&isInArray("bounce",o)?this._processMouseBounce():divModeExecute("bounce",a,(l,h)=>this._singleSelectorBounce(l,h))}isEnabled(e){const t=this.container,i=t.actualOptions,n=t.interactivity.mouse,s=((e==null?void 0:e.interactivity)??i.interactivity).events,o=s.onDiv;return n.position&&s.onHover.enable&&isInArray("bounce",s.onHover.mode)||isDivModeEnabled("bounce",o)}loadModeOptions(e,...t){e.bounce||(e.bounce=new Bounce);for(const i of t)e.bounce.load(i==null?void 0:i.bounce)}reset(){}}async function loadExternalBounceInteraction(r,e=!0){await r.addInteractor("externalBounce",t=>new Bouncer(t),e)}class BubbleBase{constructor(){this.distance=200,this.duration=.4,this.mix=!1}load(e){if(e){if(e.distance!==void 0&&(this.distance=e.distance),e.duration!==void 0&&(this.duration=e.duration),e.mix!==void 0&&(this.mix=e.mix),e.opacity!==void 0&&(this.opacity=e.opacity),e.color!==void 0){const t=isArray$1(this.color)?void 0:this.color;this.color=executeOnSingleOrMultiple(e.color,i=>OptionsColor.create(t,i))}e.size!==void 0&&(this.size=e.size)}}}class BubbleDiv extends BubbleBase{constructor(){super(),this.selectors=[]}get ids(){return executeOnSingleOrMultiple(this.selectors,e=>e.replace("#",""))}set ids(e){this.selectors=executeOnSingleOrMultiple(e,t=>`#${t}`)}load(e){super.load(e),e&&(e.ids!==void 0&&(this.ids=e.ids),e.selectors!==void 0&&(this.selectors=e.selectors))}}class Bubble extends BubbleBase{load(e){super.load(e),e&&(this.divs=executeOnSingleOrMultiple(e.divs,t=>{const i=new BubbleDiv;return i.load(t),i}))}}function calculateBubbleValue(r,e,t,i){if(e>=t){const n=r+(e-t)*i;return clamp$1(n,r,e)}else if(e<t){const n=r-(t-e)*i;return clamp$1(n,e,r)}}class Bubbler extends ExternalInteractorBase{constructor(e){super(e),this._clickBubble=()=>{var h;const t=this.container,i=t.actualOptions,n=t.interactivity.mouse.clickPosition,s=i.interactivity.modes.bubble;if(!s||!n)return;t.bubble||(t.bubble={});const o=t.retina.bubbleModeDistance;if(!o||o<0)return;const a=t.particles.quadTree.queryCircle(n,o,u=>this.isEnabled(u)),{bubble:l}=t;for(const u of a){if(!l.clicking)continue;u.bubble.inRange=!l.durationEnd;const g=u.getPosition(),m=getDistance(g,n),_=(new Date().getTime()-(t.interactivity.mouse.clickTime||0))/1e3;_>s.duration&&(l.durationEnd=!0),_>s.duration*2&&(l.clicking=!1,l.durationEnd=!1);const b={bubbleObj:{optValue:t.retina.bubbleModeSize,value:u.bubble.radius},particlesObj:{optValue:getRangeMax(u.options.size.value)*t.retina.pixelRatio,value:u.size.value},type:"size"};this._process(u,m,_,b);const d={bubbleObj:{optValue:s.opacity,value:u.bubble.opacity},particlesObj:{optValue:getRangeMax(u.options.opacity.value),value:((h=u.opacity)==null?void 0:h.value)??1},type:"opacity"};this._process(u,m,_,d),!l.durationEnd&&m<=o?this._hoverBubbleColor(u,m):delete u.bubble.color}},this._hoverBubble=()=>{const t=this.container,i=t.interactivity.mouse.position,n=t.retina.bubbleModeDistance;if(!n||n<0||i===void 0)return;const s=t.particles.quadTree.queryCircle(i,n,o=>this.isEnabled(o));for(const o of s){o.bubble.inRange=!0;const a=o.getPosition(),l=getDistance(a,i),h=1-l/n;l<=n?h>=0&&t.interactivity.status===mouseMoveEvent&&(this._hoverBubbleSize(o,h),this._hoverBubbleOpacity(o,h),this._hoverBubbleColor(o,h)):this.reset(o),t.interactivity.status===mouseLeaveEvent&&this.reset(o)}},this._hoverBubbleColor=(t,i,n)=>{const s=this.container.actualOptions,o=n??s.interactivity.modes.bubble;if(o){if(!t.bubble.finalColor){const a=o.color;if(!a)return;const l=itemFromSingleOrMultiple(a);t.bubble.finalColor=rangeColorToHsl(l)}if(t.bubble.finalColor)if(o.mix){t.bubble.color=void 0;const a=t.getFillColor();t.bubble.color=a?rgbToHsl(colorMix(a,t.bubble.finalColor,1-i,i)):t.bubble.finalColor}else t.bubble.color=t.bubble.finalColor}},this._hoverBubbleOpacity=(t,i,n)=>{var g,m;const s=this.container,o=s.actualOptions,a=(n==null?void 0:n.opacity)??((g=o.interactivity.modes.bubble)==null?void 0:g.opacity);if(!a)return;const l=t.options.opacity.value,h=((m=t.opacity)==null?void 0:m.value)??1,u=calculateBubbleValue(h,a,getRangeMax(l),i);u!==void 0&&(t.bubble.opacity=u)},this._hoverBubbleSize=(t,i,n)=>{const s=this.container,o=n!=null&&n.size?n.size*s.retina.pixelRatio:s.retina.bubbleModeSize;if(o===void 0)return;const a=getRangeMax(t.options.size.value)*s.retina.pixelRatio,l=t.size.value,h=calculateBubbleValue(l,o,a,i);h!==void 0&&(t.bubble.radius=h)},this._process=(t,i,n,s)=>{const o=this.container,a=s.bubbleObj.optValue,l=o.actualOptions,h=l.interactivity.modes.bubble;if(!h||a===void 0)return;const u=h.duration,g=o.retina.bubbleModeDistance,m=s.particlesObj.optValue,_=s.bubbleObj.value,b=s.particlesObj.value||0,d=s.type;if(!(!g||g<0||a===m))if(o.bubble||(o.bubble={}),o.bubble.durationEnd)_&&(d==="size"&&delete t.bubble.radius,d==="opacity"&&delete t.bubble.opacity);else if(i<=g){if((_??b)!==a){const f=b-n*(b-a)/u;d==="size"&&(t.bubble.radius=f),d==="opacity"&&(t.bubble.opacity=f)}}else d==="size"&&delete t.bubble.radius,d==="opacity"&&delete t.bubble.opacity},this._singleSelectorHover=(t,i,n)=>{const s=this.container,o=document.querySelectorAll(i),a=s.actualOptions.interactivity.modes.bubble;!a||!o.length||o.forEach(l=>{const h=l,u=s.retina.pixelRatio,g={x:(h.offsetLeft+h.offsetWidth/2)*u,y:(h.offsetTop+h.offsetHeight/2)*u},m=h.offsetWidth/2*u,_=n.type==="circle"?new Circle(g.x,g.y,m):new Rectangle(h.offsetLeft*u,h.offsetTop*u,h.offsetWidth*u,h.offsetHeight*u),b=s.particles.quadTree.query(_,d=>this.isEnabled(d));for(const d of b){if(!_.contains(d.getPosition()))continue;d.bubble.inRange=!0;const c=a.divs,f=divMode(c,h);(!d.bubble.div||d.bubble.div!==h)&&(this.clear(d,t,!0),d.bubble.div=h),this._hoverBubbleSize(d,1,f),this._hoverBubbleOpacity(d,1,f),this._hoverBubbleColor(d,1,f)}})},e.bubble||(e.bubble={}),this.handleClickMode=t=>{t==="bubble"&&(e.bubble||(e.bubble={}),e.bubble.clicking=!0)}}clear(e,t,i){e.bubble.inRange&&!i||(delete e.bubble.div,delete e.bubble.opacity,delete e.bubble.radius,delete e.bubble.color)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bubble;t&&(e.retina.bubbleModeDistance=t.distance*e.retina.pixelRatio,t.size!==void 0&&(e.retina.bubbleModeSize=t.size*e.retina.pixelRatio))}async interact(e){const t=this.container.actualOptions,i=t.interactivity.events,n=i.onHover,s=i.onClick,o=n.enable,a=n.mode,l=s.enable,h=s.mode,u=i.onDiv;o&&isInArray("bubble",a)?this._hoverBubble():l&&isInArray("bubble",h)?this._clickBubble():divModeExecute("bubble",u,(g,m)=>this._singleSelectorHover(e,g,m))}isEnabled(e){const t=this.container,i=t.actualOptions,n=t.interactivity.mouse,s=((e==null?void 0:e.interactivity)??i.interactivity).events,{onClick:o,onDiv:a,onHover:l}=s,h=isDivModeEnabled("bubble",a);return h||l.enable&&n.position||o.enable&&n.clickPosition?isInArray("bubble",l.mode)||isInArray("bubble",o.mode)||h:!1}loadModeOptions(e,...t){e.bubble||(e.bubble=new Bubble);for(const i of t)e.bubble.load(i==null?void 0:i.bubble)}reset(e){e.bubble.inRange=!1}}async function loadExternalBubbleInteraction(r,e=!0){await r.addInteractor("externalBubble",t=>new Bubbler(t),e)}class ConnectLinks{constructor(){this.opacity=.5}load(e){e&&e.opacity!==void 0&&(this.opacity=e.opacity)}}class Connect{constructor(){this.distance=80,this.links=new ConnectLinks,this.radius=60}get lineLinked(){return this.links}set lineLinked(e){this.links=e}get line_linked(){return this.links}set line_linked(e){this.links=e}load(e){e&&(e.distance!==void 0&&(this.distance=e.distance),this.links.load(e.links??e.lineLinked??e.line_linked),e.radius!==void 0&&(this.radius=e.radius))}}function gradient(r,e,t,i){const n=Math.floor(t.getRadius()/e.getRadius()),s=e.getFillColor(),o=t.getFillColor();if(!s||!o)return;const a=e.getPosition(),l=t.getPosition(),h=colorMix(s,o,e.getRadius(),t.getRadius()),u=r.createLinearGradient(a.x,a.y,l.x,l.y);return u.addColorStop(0,getStyleFromHsl(s,i)),u.addColorStop(n>1?1:n,getStyleFromRgb(h,i)),u.addColorStop(1,getStyleFromHsl(o,i)),u}function drawConnectLine(r,e,t,i,n){drawLine(r,i,n),r.lineWidth=e,r.strokeStyle=t,r.stroke()}function lineStyle(r,e,t,i){const n=r.actualOptions,s=n.interactivity.modes.connect;if(s)return gradient(e,t,i,s.links.opacity)}function drawConnection(r,e,t){r.canvas.draw(i=>{const n=lineStyle(r,i,e,t);if(!n)return;const s=e.getPosition(),o=t.getPosition();drawConnectLine(i,e.retina.linksWidth??0,n,s,o)})}class Connector extends ExternalInteractorBase{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.connect;t&&(e.retina.connectModeDistance=t.distance*e.retina.pixelRatio,e.retina.connectModeRadius=t.radius*e.retina.pixelRatio)}async interact(){const e=this.container;if(e.actualOptions.interactivity.events.onHover.enable&&e.interactivity.status==="pointermove"){const i=e.interactivity.mouse.position;if(!e.retina.connectModeDistance||e.retina.connectModeDistance<0||!e.retina.connectModeRadius||e.retina.connectModeRadius<0||!i)return;const n=Math.abs(e.retina.connectModeRadius),s=e.particles.quadTree.queryCircle(i,n,a=>this.isEnabled(a));let o=0;for(const a of s){const l=a.getPosition();for(const h of s.slice(o+1)){const u=h.getPosition(),g=Math.abs(e.retina.connectModeDistance),m=Math.abs(l.x-u.x),_=Math.abs(l.y-u.y);m<g&&_<g&&drawConnection(e,a,h)}++o}}}isEnabled(e){const t=this.container,i=t.interactivity.mouse,n=((e==null?void 0:e.interactivity)??t.actualOptions.interactivity).events;return n.onHover.enable&&i.position?isInArray("connect",n.onHover.mode):!1}loadModeOptions(e,...t){e.connect||(e.connect=new Connect);for(const i of t)e.connect.load(i==null?void 0:i.connect)}reset(){}}async function loadExternalConnectInteraction(r,e=!0){await r.addInteractor("externalConnect",t=>new Connector(t),e)}class GrabLinks{constructor(){this.blink=!1,this.consent=!1,this.opacity=1}load(e){e&&(e.blink!==void 0&&(this.blink=e.blink),e.color!==void 0&&(this.color=OptionsColor.create(this.color,e.color)),e.consent!==void 0&&(this.consent=e.consent),e.opacity!==void 0&&(this.opacity=e.opacity))}}class Grab{constructor(){this.distance=100,this.links=new GrabLinks}get lineLinked(){return this.links}set lineLinked(e){this.links=e}get line_linked(){return this.links}set line_linked(e){this.links=e}load(e){e&&(e.distance!==void 0&&(this.distance=e.distance),this.links.load(e.links??e.lineLinked??e.line_linked))}}function drawGrabLine(r,e,t,i,n,s){drawLine(r,t,i),r.strokeStyle=getStyleFromRgb(n,s),r.lineWidth=e,r.stroke()}function drawGrab(r,e,t,i,n){r.canvas.draw(s=>{const o=e.getPosition();drawGrabLine(s,e.retina.linksWidth??0,o,n,t,i)})}class Grabber extends ExternalInteractorBase{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.grab;t&&(e.retina.grabModeDistance=t.distance*e.retina.pixelRatio)}async interact(){var a;const e=this.container,t=e.actualOptions,i=t.interactivity;if(!i.modes.grab||!i.events.onHover.enable||e.interactivity.status!==mouseMoveEvent)return;const n=e.interactivity.mouse.position;if(!n)return;const s=e.retina.grabModeDistance;if(!s||s<0)return;const o=e.particles.quadTree.queryCircle(n,s,l=>this.isEnabled(l));for(const l of o){const h=l.getPosition(),u=getDistance(h,n);if(u>s)continue;const g=i.modes.grab.links,m=g.opacity,_=m-u*m/s;if(_<=0)continue;const b=g.color??((a=l.options.links)==null?void 0:a.color);if(!e.particles.grabLineColor&&b){const c=i.modes.grab.links;e.particles.grabLineColor=getLinkRandomColor(b,c.blink,c.consent)}const d=getLinkColor(l,void 0,e.particles.grabLineColor);d&&drawGrab(e,l,d,_,n)}}isEnabled(e){const t=this.container,i=t.interactivity.mouse,n=((e==null?void 0:e.interactivity)??t.actualOptions.interactivity).events;return n.onHover.enable&&!!i.position&&isInArray("grab",n.onHover.mode)}loadModeOptions(e,...t){e.grab||(e.grab=new Grab);for(const i of t)e.grab.load(i==null?void 0:i.grab)}reset(){}}async function loadExternalGrabInteraction(r,e=!0){await r.addInteractor("externalGrab",t=>new Grabber(t),e)}class Pauser extends ExternalInteractorBase{constructor(e){super(e),this.handleClickMode=t=>{if(t!=="pause")return;const i=this.container;i.getAnimationStatus()?i.pause():i.play()}}clear(){}init(){}async interact(){}isEnabled(){return!0}reset(){}}async function loadExternalPauseInteraction(r,e=!0){await r.addInteractor("externalPause",t=>new Pauser(t),e)}class Push{constructor(){this.default=!0,this.groups=[],this.quantity=4}get particles_nb(){return this.quantity}set particles_nb(e){this.quantity=setRangeValue(e)}load(e){if(!e)return;e.default!==void 0&&(this.default=e.default),e.groups!==void 0&&(this.groups=e.groups.map(i=>i)),this.groups.length||(this.default=!0);const t=e.quantity??e.particles_nb;t!==void 0&&(this.quantity=setRangeValue(t))}}class Pusher extends ExternalInteractorBase{constructor(e){super(e),this.handleClickMode=t=>{if(t!=="push")return;const i=this.container,n=i.actualOptions,s=n.interactivity.modes.push;if(!s)return;const o=getRangeValue(s.quantity);if(o<=0)return;const a=itemFromArray([void 0,...s.groups]),l=a!==void 0?i.actualOptions.particles.groups[a]:void 0;i.particles.push(o,i.interactivity.mouse,l,a)}}clear(){}init(){}async interact(){}isEnabled(){return!0}loadModeOptions(e,...t){e.push||(e.push=new Push);for(const i of t)e.push.load(i==null?void 0:i.push)}reset(){}}async function loadExternalPushInteraction(r,e=!0){await r.addInteractor("externalPush",t=>new Pusher(t),e)}class Remove{constructor(){this.quantity=2}get particles_nb(){return this.quantity}set particles_nb(e){this.quantity=setRangeValue(e)}load(e){if(!e)return;const t=e.quantity??e.particles_nb;t!==void 0&&(this.quantity=setRangeValue(t))}}class Remover extends ExternalInteractorBase{constructor(e){super(e),this.handleClickMode=t=>{const i=this.container,n=i.actualOptions;if(!n.interactivity.modes.remove||t!=="remove")return;const s=getRangeValue(n.interactivity.modes.remove.quantity);i.particles.removeQuantity(s)}}clear(){}init(){}async interact(){}isEnabled(){return!0}loadModeOptions(e,...t){e.remove||(e.remove=new Remove);for(const i of t)e.remove.load(i==null?void 0:i.remove)}reset(){}}async function loadExternalRemoveInteraction(r,e=!0){await r.addInteractor("externalRemove",t=>new Remover(t),e)}class RepulseBase{constructor(){this.distance=200,this.duration=.4,this.factor=100,this.speed=1,this.maxSpeed=50,this.easing="ease-out-quad"}load(e){e&&(e.distance!==void 0&&(this.distance=e.distance),e.duration!==void 0&&(this.duration=e.duration),e.easing!==void 0&&(this.easing=e.easing),e.factor!==void 0&&(this.factor=e.factor),e.speed!==void 0&&(this.speed=e.speed),e.maxSpeed!==void 0&&(this.maxSpeed=e.maxSpeed))}}class RepulseDiv extends RepulseBase{constructor(){super(),this.selectors=[]}get ids(){return executeOnSingleOrMultiple(this.selectors,e=>e.replace("#",""))}set ids(e){this.selectors=executeOnSingleOrMultiple(e,t=>`#${t}`)}load(e){super.load(e),e&&(e.ids!==void 0&&(this.ids=e.ids),e.selectors!==void 0&&(this.selectors=e.selectors))}}class Repulse extends RepulseBase{load(e){super.load(e),e&&(this.divs=executeOnSingleOrMultiple(e.divs,t=>{const i=new RepulseDiv;return i.load(t),i}))}}class Repulser extends ExternalInteractorBase{constructor(e,t){super(t),this._clickRepulse=()=>{const i=this.container,n=i.actualOptions.interactivity.modes.repulse;if(!n)return;const s=i.repulse||{particles:[]};if(s.finish||(s.count||(s.count=0),s.count++,s.count===i.particles.count&&(s.finish=!0)),s.clicking){const o=i.retina.repulseModeDistance;if(!o||o<0)return;const a=Math.pow(o/6,3),l=i.interactivity.mouse.clickPosition;if(l===void 0)return;const h=new Circle(l.x,l.y,a),u=i.particles.quadTree.query(h,g=>this.isEnabled(g));for(const g of u){const{dx:m,dy:_,distance:b}=getDistances(l,g.position),d=b**2,c=n.speed,f=-a*c/d;if(d<=a){s.particles.push(g);const v=Vector.create(m,_);v.length=f,g.velocity.setTo(v)}}}else if(s.clicking===!1){for(const o of s.particles)o.velocity.setTo(o.initialVelocity);s.particles=[]}},this._hoverRepulse=()=>{const i=this.container,n=i.interactivity.mouse.position,s=i.retina.repulseModeDistance;!s||s<0||!n||this._processRepulse(n,s,new Circle(n.x,n.y,s))},this._processRepulse=(i,n,s,o)=>{const a=this.container,l=a.particles.quadTree.query(s,u=>this.isEnabled(u)),h=a.actualOptions.interactivity.modes.repulse;if(h)for(const u of l){const{dx:g,dy:m,distance:_}=getDistances(u.position,i),b=((o==null?void 0:o.speed)??h.speed)*h.factor,d=clamp$1(getEasing(h.easing)(1-_/n)*b,0,h.maxSpeed),c=Vector.create(_===0?b:g/_*d,_===0?b:m/_*d);u.position.addTo(c)}},this._singleSelectorRepulse=(i,n)=>{const s=this.container,o=s.actualOptions.interactivity.modes.repulse;if(!o)return;const a=document.querySelectorAll(i);a.length&&a.forEach(l=>{const h=l,u=s.retina.pixelRatio,g={x:(h.offsetLeft+h.offsetWidth/2)*u,y:(h.offsetTop+h.offsetHeight/2)*u},m=h.offsetWidth/2*u,_=n.type==="circle"?new Circle(g.x,g.y,m):new Rectangle(h.offsetLeft*u,h.offsetTop*u,h.offsetWidth*u,h.offsetHeight*u),b=o.divs,d=divMode(b,h);this._processRepulse(g,m,_,d)})},this._engine=e,t.repulse||(t.repulse={particles:[]}),this.handleClickMode=i=>{const n=this.container.actualOptions,s=n.interactivity.modes.repulse;if(!s||i!=="repulse")return;t.repulse||(t.repulse={particles:[]});const o=t.repulse;o.clicking=!0,o.count=0;for(const a of t.repulse.particles)this.isEnabled(a)&&a.velocity.setTo(a.initialVelocity);o.particles=[],o.finish=!1,setTimeout(()=>{t.destroyed||(o.clicking=!1)},s.duration*1e3)}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.repulse;t&&(e.retina.repulseModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions,i=e.interactivity.status===mouseMoveEvent,n=t.interactivity.events,s=n.onHover,o=s.enable,a=s.mode,l=n.onClick,h=l.enable,u=l.mode,g=n.onDiv;i&&o&&isInArray("repulse",a)?this._hoverRepulse():h&&isInArray("repulse",u)?this._clickRepulse():divModeExecute("repulse",g,(m,_)=>this._singleSelectorRepulse(m,_))}isEnabled(e){const t=this.container,i=t.actualOptions,n=t.interactivity.mouse,s=((e==null?void 0:e.interactivity)??i.interactivity).events,o=s.onDiv,a=s.onHover,l=s.onClick,h=isDivModeEnabled("repulse",o);if(!(h||a.enable&&n.position||l.enable&&n.clickPosition))return!1;const u=a.mode,g=l.mode;return isInArray("repulse",u)||isInArray("repulse",g)||h}loadModeOptions(e,...t){e.repulse||(e.repulse=new Repulse);for(const i of t)e.repulse.load(i==null?void 0:i.repulse)}reset(){}}async function loadExternalRepulseInteraction(r,e=!0){await r.addInteractor("externalRepulse",t=>new Repulser(r,t),e)}class Slow{constructor(){this.factor=3,this.radius=200}load(e){e&&(e.factor!==void 0&&(this.factor=e.factor),e.radius!==void 0&&(this.radius=e.radius))}}class Slower extends ExternalInteractorBase{constructor(e){super(e)}clear(e,t,i){e.slow.inRange&&!i||(e.slow.factor=1)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.slow;t&&(e.retina.slowModeRadius=t.radius*e.retina.pixelRatio)}async interact(){}isEnabled(e){const t=this.container,i=t.interactivity.mouse,n=((e==null?void 0:e.interactivity)??t.actualOptions.interactivity).events;return n.onHover.enable&&!!i.position&&isInArray("slow",n.onHover.mode)}loadModeOptions(e,...t){e.slow||(e.slow=new Slow);for(const i of t)e.slow.load(i==null?void 0:i.slow)}reset(e){e.slow.inRange=!1;const t=this.container,i=t.actualOptions,n=t.interactivity.mouse.position,s=t.retina.slowModeRadius,o=i.interactivity.modes.slow;if(!o||!s||s<0||!n)return;const a=e.getPosition(),l=getDistance(n,a),h=l/s,u=o.factor,{slow:g}=e;l>s||(g.inRange=!0,g.factor=h/u)}}async function loadExternalSlowInteraction(r,e=!0){await r.addInteractor("externalSlow",t=>new Slower(t),e)}const InterlaceOffsets=[0,4,2,1],InterlaceSteps=[8,8,4,2];class ByteStream{constructor(e){this.pos=0,this.data=new Uint8ClampedArray(e)}getString(e){const t=this.data.slice(this.pos,this.pos+e);return this.pos+=t.length,t.reduce((i,n)=>i+String.fromCharCode(n),"")}nextByte(){return this.data[this.pos++]}nextTwoBytes(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}readSubBlocks(){let e="",t=0;do{t=this.data[this.pos++];for(let i=t;--i>=0;e+=String.fromCharCode(this.data[this.pos++]));}while(t!==0);return e}readSubBlocksBin(){let e=0,t=0;for(let n=0;(e=this.data[this.pos+n])!==0;n+=e+1)t+=e;const i=new Uint8Array(t);for(let n=0;(e=this.data[this.pos++])!==0;)for(let s=e;--s>=0;i[n++]=this.data[this.pos++]);return i}skipSubBlocks(){for(;this.data[this.pos]!==0;this.pos+=this.data[this.pos]+1);this.pos++}}function parseColorTable(r,e){const t=[];for(let i=0;i<e;i++)t.push({r:r.data[r.pos],g:r.data[r.pos+1],b:r.data[r.pos+2]}),r.pos+=3;return t}async function parseExtensionBlock(r,e,t,i){switch(r.nextByte()){case 249:{const n=e.frames[t(!1)];r.pos++;const s=r.nextByte();n.GCreserved=(s&224)>>>5,n.disposalMethod=(s&28)>>>2,n.userInputDelayFlag=(s&2)===2;const o=(s&1)===1;n.delayTime=r.nextTwoBytes()*10;const a=r.nextByte();o&&i(a),r.pos++;break}case 255:{r.pos++;const n={identifier:r.getString(8),authenticationCode:r.getString(3),data:r.readSubBlocksBin()};e.applicationExtensions.push(n);break}case 254:{e.comments.push([t(!1),r.readSubBlocks()]);break}case 1:{if(e.globalColorTable.length===0)throw new EvalError("plain text extension without global color table");r.pos++,e.frames[t(!1)].plainTextData={left:r.nextTwoBytes(),top:r.nextTwoBytes(),width:r.nextTwoBytes(),height:r.nextTwoBytes(),charSize:{width:r.nextTwoBytes(),height:r.nextTwoBytes()},foregroundColor:r.nextByte(),backgroundColor:r.nextByte(),text:r.readSubBlocks()};break}default:r.skipSubBlocks();break}}async function parseImageBlock(r,e,t,i,n,s){const o=e.frames[i(!0)];o.left=r.nextTwoBytes(),o.top=r.nextTwoBytes(),o.width=r.nextTwoBytes(),o.height=r.nextTwoBytes();const a=r.nextByte(),l=(a&128)===128,h=(a&64)===64;o.sortFlag=(a&32)===32,o.reserved=(a&24)>>>3;const u=1<<(a&7)+1;l&&(o.localColorTable=parseColorTable(r,u));const g=f=>{const{r:v,g:y,b:D}=(l?o.localColorTable:e.globalColorTable)[f];return{r:v,g:y,b:D,a:f===n(null)?t?~~((v+y+D)/3):0:255}},m=(()=>{try{return new ImageData(o.width,o.height,{colorSpace:"srgb"})}catch(f){if(f instanceof DOMException&&f.name==="IndexSizeError")return null;throw f}})();if(m==null)throw new EvalError("GIF frame size is to large");const _=r.nextByte(),b=r.readSubBlocksBin(),d=1<<_,c=(f,v)=>{const y=f>>>3,D=f&7;return(b[y]+(b[y+1]<<8)+(b[y+2]<<16)&(1<<v)-1<<D)>>>D};if(h){for(let f=0,v=_+1,y=0,D=[[0]],E=0;E<4;E++)if(InterlaceOffsets[E]<o.height)for(let p=0,x=0;;){const w=f;if(f=c(y,v),y+=v+1,f===d){v=_+1,D.length=d+2;for(let C=0;C<D.length;C++)D[C]=C<d?[C]:[]}else{f>=D.length?D.push(D[w].concat(D[w][0])):w!==d&&D.push(D[w].concat(D[f][0]));for(let C=0;C<D[f].length;C++){const{r:S,g:A,b:P,a:O}=g(D[f][C]);m.data.set([S,A,P,O],InterlaceOffsets[E]*o.width+InterlaceSteps[E]*x+p%(o.width*4)),p+=4}D.length===1<<v&&v<12&&v++}if(p===o.width*4*(x+1)&&(x++,InterlaceOffsets[E]+InterlaceSteps[E]*x>=o.height))break}o.image=m,o.bitmap=await createImageBitmap(m)}else{for(let f=0,v=_+1,y=0,D=[[0]],E=-4;;){const p=f;if(f=c(y,v),y+=v,f===d){v=_+1,D.length=d+2;for(let x=0;x<D.length;x++)D[x]=x<d?[x]:[]}else{if(f===d+1)break;f>=D.length?D.push(D[p].concat(D[p][0])):p!==d&&D.push(D[p].concat(D[f][0]));for(let x=0;x<D[f].length;x++){const{r:w,g:C,b:S,a:A}=g(D[f][x]);m.data.set([w,C,S,A],E+=4)}D.length>=1<<v&&v<12&&v++}}o.image=m,o.bitmap=await createImageBitmap(m)}}async function parseBlock(r,e,t,i,n,s){switch(r.nextByte()){case 59:return!0;case 44:await parseImageBlock(r,e,t,i,n);break;case 33:await parseExtensionBlock(r,e,i,n);break;default:throw new EvalError("undefined block found")}return!1}function getGIFLoopAmount(r){for(const e of r.applicationExtensions)if(e.identifier+e.authenticationCode==="NETSCAPE2.0")return e.data[1]+(e.data[2]<<8);return NaN}async function decodeGIF(r,e,t){t||(t=!1);const i=await fetch(r);if(!i.ok&&i.status===404)throw new EvalError("file not found");const n=await i.arrayBuffer(),s={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},o=new ByteStream(new Uint8ClampedArray(n));if(o.getString(6)!=="GIF89a")throw new Error("not a supported GIF file");s.width=o.nextTwoBytes(),s.height=o.nextTwoBytes();const a=o.nextByte(),l=(a&128)===128;s.colorRes=(a&112)>>>4,s.sortFlag=(a&8)===8;const h=1<<(a&7)+1,u=o.nextByte();s.pixelAspectRatio=o.nextByte(),s.pixelAspectRatio!==0&&(s.pixelAspectRatio=(s.pixelAspectRatio+15)/64),l&&(s.globalColorTable=parseColorTable(o,h));const g=(()=>{try{return new ImageData(s.width,s.height,{colorSpace:"srgb"})}catch(D){if(D instanceof DOMException&&D.name==="IndexSizeError")return null;throw D}})();if(g==null)throw new Error("GIF frame size is to large");const{r:m,g:_,b}=s.globalColorTable[u];g.data.set(l?[m,_,b,255]:[0,0,0,0]);for(let D=4;D<g.data.length;D*=2)g.data.copyWithin(D,0,D);s.backgroundImage=g;let d=-1,c=!0,f=-1;const v=D=>(D&&(c=!0),d),y=D=>(D!=null&&(f=D),f);try{do c&&(s.frames.push({left:0,top:0,width:0,height:0,disposalMethod:0,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),d++,f=-1,c=!1);while(!await parseBlock(o,s,t,v,y,e));s.frames.length--;for(const D of s.frames){if(D.userInputDelayFlag&&D.delayTime===0){s.totalTime=1/0;break}s.totalTime+=D.delayTime}return s}catch(D){throw D instanceof EvalError?new Error(`error while parsing frame ${d} "${D.message}"`):D}}const currentColorRegex=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?\))|currentcolor/gi;function replaceColorSvg(r,e,t){const{svgData:i}=r;if(!i)return"";const n=getStyleFromHsl(e,t);if(i.includes("fill"))return i.replace(currentColorRegex,()=>n);const s=i.indexOf(">");return`${i.substring(0,s)} fill="${n}"${i.substring(s)}`}async function loadImage(r){return new Promise(e=>{r.loading=!0;const t=new Image;r.element=t,t.addEventListener("load",()=>{r.loading=!1,e()}),t.addEventListener("error",()=>{r.element=void 0,r.error=!0,r.loading=!1,getLogger().error(`${errorPrefix} loading image: ${r.source}`),e()}),t.src=r.source})}async function loadGifImage(r){if(r.type!=="gif"){await loadImage(r);return}r.loading=!0;try{r.gifData=await decodeGIF(r.source),r.gifLoopCount=getGIFLoopAmount(r.gifData)??0,r.gifLoopCount===0&&(r.gifLoopCount=1/0)}catch{r.error=!0}r.loading=!1}async function downloadSvgImage(r){if(r.type!=="svg"){await loadImage(r);return}r.loading=!0;const e=await fetch(r.source);e.ok?r.svgData=await e.text():(getLogger().error(`${errorPrefix} Image not found`),r.error=!0),r.loading=!1}function replaceImageColor(r,e,t,i){var o;const n=replaceColorSvg(r,t,((o=i.opacity)==null?void 0:o.value)??1),s={color:t,gif:e.gif,data:{...r,svgData:n},loaded:!1,ratio:e.width/e.height,replaceColor:e.replaceColor??e.replace_color,source:e.src};return new Promise(a=>{const l=new Blob([n],{type:"image/svg+xml"}),h=URL||window.URL||window.webkitURL||window,u=h.createObjectURL(l),g=new Image;g.addEventListener("load",()=>{s.loaded=!0,s.element=g,a(s),h.revokeObjectURL(u)}),g.addEventListener("error",async()=>{h.revokeObjectURL(u);const m={...r,error:!1,loading:!0};await loadImage(m),s.loaded=!0,s.element=m.element,a(s)}),g.src=u})}class ImageDrawer{constructor(e){this.loadImageShape=async t=>{if(!this._engine.loadImage)throw new Error(`${errorPrefix} image shape not initialized`);await this._engine.loadImage({gif:t.gif,name:t.name,replaceColor:t.replaceColor??t.replace_color??!1,src:t.src})},this._engine=e}addImage(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}draw(e,t,i,n,s){const o=t.image,a=o==null?void 0:o.element;if(o){if(e.globalAlpha=n,o.gif&&o.gifData){const l=new OffscreenCanvas(o.gifData.width,o.gifData.height),h=l.getContext("2d");if(!h)throw new Error("could not create offscreen canvas context");h.imageSmoothingQuality="low",h.imageSmoothingEnabled=!1,h.clearRect(0,0,l.width,l.height),t.gifLoopCount===void 0&&(t.gifLoopCount=o.gifLoopCount??0);let u=t.gifFrame??0;const g={x:-o.gifData.width*.5,y:-o.gifData.height*.5},m=o.gifData.frames[u];if(t.gifTime===void 0&&(t.gifTime=0),!m.bitmap)return;switch(e.scale(i/o.gifData.width,i/o.gifData.height),m.disposalMethod){case 4:case 5:case 6:case 7:case 0:h.drawImage(m.bitmap,m.left,m.top),e.drawImage(l,g.x,g.y),h.clearRect(0,0,l.width,l.height);break;case 1:h.drawImage(m.bitmap,m.left,m.top),e.drawImage(l,g.x,g.y);break;case 2:h.drawImage(m.bitmap,m.left,m.top),e.drawImage(l,g.x,g.y),h.clearRect(0,0,l.width,l.height),o.gifData.globalColorTable.length===0?h.putImageData(o.gifData.frames[0].image,g.x+m.left,g.y+m.top):h.putImageData(o.gifData.backgroundImage,g.x,g.y);break;case 3:{const _=h.getImageData(0,0,l.width,l.height);h.drawImage(m.bitmap,m.left,m.top),e.drawImage(l,g.x,g.y),h.clearRect(0,0,l.width,l.height),h.putImageData(_,0,0)}break}if(t.gifTime+=s.value,t.gifTime>m.delayTime){if(t.gifTime-=m.delayTime,++u>=o.gifData.frames.length){if(--t.gifLoopCount<=0)return;u=0,h.clearRect(0,0,l.width,l.height)}t.gifFrame=u}e.scale(o.gifData.width/i,o.gifData.height/i)}else if(a){const l=o.ratio,h={x:-i,y:-i};e.drawImage(a,h.x,h.y,i*2,i*2/l)}e.globalAlpha=1}}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(!(!t.preload||!this._engine.loadImage))for(const i of t.preload)await this._engine.loadImage(i)}loadShape(e){if(e.shape!=="image"&&e.shape!=="images")return;this._engine.images||(this._engine.images=[]);const t=e.shapeData;this._engine.images.find(n=>n.name===t.name||n.source===t.src)||this.loadImageShape(t).then(()=>{this.loadShape(e)})}particleInit(e,t){if(t.shape!=="image"&&t.shape!=="images")return;this._engine.images||(this._engine.images=[]);const i=this._engine.images,n=t.shapeData,s=t.getFillColor(),o=i.find(l=>l.name===n.name||l.source===n.src);if(!o)return;const a=n.replaceColor??n.replace_color??o.replaceColor;if(o.loading){setTimeout(()=>{this.particleInit(e,t)});return}(async()=>{let l;o.svgData&&s?l=await replaceImageColor(o,n,s,t):l={color:s,data:o,element:o.element,gif:o.gif,gifData:o.gifData,gifLoopCount:o.gifLoopCount,loaded:!0,ratio:n.width&&n.height?n.width/n.height:o.ratio??1,replaceColor:a,source:n.src},l.ratio||(l.ratio=1);const h=n.fill??t.fill,u=n.close??t.close,g={image:l,fill:h,close:u};t.image=g.image,t.fill=g.fill,t.close=g.close})()}}class Preload{constructor(){this.src="",this.gif=!1}load(e){e&&(e.gif!==void 0&&(this.gif=e.gif),e.height!==void 0&&(this.height=e.height),e.name!==void 0&&(this.name=e.name),e.replaceColor!==void 0&&(this.replaceColor=e.replaceColor),e.src!==void 0&&(this.src=e.src),e.width!==void 0&&(this.width=e.width))}}class ImagePreloaderPlugin{constructor(e){this.id="imagePreloader",this._engine=e}getPlugin(){return{}}loadOptions(e,t){if(!t||!t.preload)return;e.preload||(e.preload=[]);const i=e.preload;for(const n of t.preload){const s=i.find(o=>o.name===n.name||o.src===n.src);if(s)s.load(n);else{const o=new Preload;o.load(n),i.push(o)}}}needsPlugin(){return!0}}function addLoadImageToEngine(r){r.loadImage||(r.loadImage=async e=>{if(!e.name&&!e.src)throw new Error(`${errorPrefix} no image source provided`);if(r.images||(r.images=[]),!r.images.find(t=>t.name===e.name||t.source===e.src))try{const t={gif:e.gif??!1,name:e.name??e.src,source:e.src,type:e.src.substring(e.src.length-3),error:!1,loading:!0,replaceColor:e.replaceColor,ratio:e.width&&e.height?e.width/e.height:void 0};r.images.push(t),await(e.gif?loadGifImage:e.replaceColor?downloadSvgImage:loadImage)(t)}catch{throw new Error(`${errorPrefix} ${e.name??e.src} not found`)}})}async function loadImageShape(r,e=!0){addLoadImageToEngine(r);const t=new ImagePreloaderPlugin(r);await r.addPlugin(t,e),await r.addShape(["image","images"],new ImageDrawer(r),e)}class LifeDelay extends ValueWithRandom{constructor(){super(),this.sync=!1}load(e){e&&(super.load(e),e.sync!==void 0&&(this.sync=e.sync))}}class LifeDuration extends ValueWithRandom{constructor(){super(),this.random.minimumValue=1e-4,this.sync=!1}load(e){e&&(super.load(e),e.sync!==void 0&&(this.sync=e.sync))}}class Life{constructor(){this.count=0,this.delay=new LifeDelay,this.duration=new LifeDuration}load(e){e&&(e.count!==void 0&&(this.count=e.count),this.delay.load(e.delay),this.duration.load(e.duration))}}class LifeUpdater{constructor(e){this.container=e}init(e){const t=this.container,i=e.options,n=i.life;n&&(e.life={delay:t.retina.reduceFactor?getRangeValue(n.delay.value)*(n.delay.sync?1:getRandom())/t.retina.reduceFactor*1e3:0,delayTime:0,duration:t.retina.reduceFactor?getRangeValue(n.duration.value)*(n.duration.sync?1:getRandom())/t.retina.reduceFactor*1e3:0,time:0,count:n.count},e.life.duration<=0&&(e.life.duration=-1),e.life.count<=0&&(e.life.count=-1),e.life&&(e.spawning=e.life.delay>0))}isEnabled(e){return!e.destroyed}loadOptions(e,...t){e.life||(e.life=new Life);for(const i of t)e.life.load(i==null?void 0:i.life)}update(e,t){if(!this.isEnabled(e)||!e.life)return;const i=e.life;let n=!1;if(e.spawning)if(i.delayTime+=t.value,i.delayTime>=e.life.delay)n=!0,e.spawning=!1,i.delayTime=0,i.time=0;else return;if(i.duration===-1||e.spawning||(n?i.time=0:i.time+=t.value,i.time<i.duration))return;if(i.time=0,e.life.count>0&&e.life.count--,e.life.count===0){e.destroy();return}const s=this.container.canvas.size,o=setRangeValue(0,s.width),a=setRangeValue(0,s.width);e.position.x=randomInRange(o),e.position.y=randomInRange(a),e.spawning=!0,i.delayTime=0,i.time=0,e.reset();const l=e.options.life;l&&(i.delay=getRangeValue(l.delay.value)*1e3,i.duration=getRangeValue(l.duration.value)*1e3)}}async function loadLifeUpdater(r,e=!0){await r.addParticleUpdater("life",t=>new LifeUpdater(t),e)}class LineDrawer{draw(e,t,i){const n=t.shapeData;e.moveTo(-i/2,0),e.lineTo(i/2,0),e.lineCap=(n==null?void 0:n.cap)??"butt"}getSidesCount(){return 1}}async function loadLineShape(r,e=!0){await r.addShape("line",new LineDrawer,e)}class ParallaxMover{init(){}isEnabled(e){return!isSsr()&&!e.destroyed&&e.container.actualOptions.interactivity.events.onHover.parallax.enable}move(e){const t=e.container,i=t.actualOptions,n=i.interactivity.events.onHover.parallax;if(isSsr()||!n.enable)return;const s=n.force,o=t.interactivity.mouse.position;if(!o)return;const a=t.canvas.size,l={x:a.width/2,y:a.height/2},h=n.smooth,u=e.getRadius()/s,g={x:(o.x-l.x)*u,y:(o.y-l.y)*u},{offset:m}=e;m.x+=(g.x-m.x)/h,m.y+=(g.y-m.y)/h}}async function loadParallaxMover(r,e=!0){await r.addMover("parallax",()=>new ParallaxMover,e)}class Attractor extends ParticlesInteractorBase{constructor(e){super(e)}clear(){}init(){}async interact(e){const t=this.container,i=e.retina.attractDistance??t.retina.attractDistance,n=e.getPosition(),s=t.particles.quadTree.queryCircle(n,i);for(const o of s){if(e===o||!o.options.move.attract.enable||o.destroyed||o.spawning)continue;const a=o.getPosition(),{dx:l,dy:h}=getDistances(n,a),u=e.options.move.attract.rotate,g=l/(u.x*1e3),m=h/(u.y*1e3),_=o.size.value/e.size.value,b=1/_;e.velocity.x-=g*_,e.velocity.y-=m*_,o.velocity.x+=g*b,o.velocity.y+=m*b}}isEnabled(e){return e.options.move.attract.enable}reset(){}}async function loadParticlesAttractInteraction(r,e=!0){await r.addInteractor("particlesAttract",t=>new Attractor(t),e)}function updateAbsorb(r,e,t,i,n,s){const o=clamp$1(r.options.collisions.absorb.speed*n.factor/10,0,i);r.size.value+=o/2,t.size.value-=o,i<=s&&(t.size.value=0,t.destroy())}function absorb(r,e,t,i){const n=r.getRadius(),s=e.getRadius();n===void 0&&s!==void 0?r.destroy():n!==void 0&&s===void 0?e.destroy():n!==void 0&&s!==void 0&&(n>=s?updateAbsorb(r,n,e,s,t,i):updateAbsorb(e,s,r,n,t,i))}const fixBounceSpeed=r=>{r.collisionMaxSpeed===void 0&&(r.collisionMaxSpeed=getRangeValue(r.options.collisions.maxSpeed)),r.velocity.length>r.collisionMaxSpeed&&(r.velocity.length=r.collisionMaxSpeed)};function bounce(r,e){circleBounce(circleBounceDataFromParticle(r),circleBounceDataFromParticle(e)),fixBounceSpeed(r),fixBounceSpeed(e)}function destroy(r,e){!r.unbreakable&&!e.unbreakable&&bounce(r,e),r.getRadius()===void 0&&e.getRadius()!==void 0?r.destroy():r.getRadius()!==void 0&&e.getRadius()===void 0?e.destroy():r.getRadius()!==void 0&&e.getRadius()!==void 0&&(r.getRadius()>=e.getRadius()?e:r).destroy()}function resolveCollision(r,e,t,i){switch(r.options.collisions.mode){case"absorb":{absorb(r,e,t,i);break}case"bounce":{bounce(r,e);break}case"destroy":{destroy(r,e);break}}}class Collider extends ParticlesInteractorBase{constructor(e){super(e)}clear(){}init(){}async interact(e,t){if(e.destroyed||e.spawning)return;const i=this.container,n=e.getPosition(),s=e.getRadius(),o=i.particles.quadTree.queryCircle(n,s*2);for(const a of o){if(e===a||!a.options.collisions.enable||e.options.collisions.mode!==a.options.collisions.mode||a.destroyed||a.spawning)continue;const l=a.getPosition(),h=a.getRadius();if(Math.abs(Math.round(n.z)-Math.round(l.z))>s+h)continue;const u=getDistance(n,l),g=s+h;u>g||resolveCollision(e,a,t,i.retina.pixelRatio)}}isEnabled(e){return e.options.collisions.enable}reset(){}}async function loadParticlesCollisionsInteraction(r,e=!0){await r.addInteractor("particlesCollisions",t=>new Collider(t),e)}class CircleWarp extends Circle{constructor(e,t,i,n){super(e,t,i),this.canvasSize=n,this.canvasSize={...n}}contains(e){const{width:t,height:i}=this.canvasSize,{x:n,y:s}=e;return super.contains(e)||super.contains({x:n-t,y:s})||super.contains({x:n-t,y:s-i})||super.contains({x:n,y:s-i})}intersects(e){if(super.intersects(e))return!0;const t=e,i=e,n={x:e.position.x-this.canvasSize.width,y:e.position.y-this.canvasSize.height};if(i.radius!==void 0){const s=new Circle(n.x,n.y,i.radius*2);return super.intersects(s)}else if(t.size!==void 0){const s=new Rectangle(n.x,n.y,t.size.width*2,t.size.height*2);return super.intersects(s)}return!1}}class LinksShadow{constructor(){this.blur=5,this.color=new OptionsColor,this.color.value="#000",this.enable=!1}load(e){e&&(e.blur!==void 0&&(this.blur=e.blur),this.color=OptionsColor.create(this.color,e.color),e.enable!==void 0&&(this.enable=e.enable))}}class LinksTriangle{constructor(){this.enable=!1,this.frequency=1}load(e){e&&(e.color!==void 0&&(this.color=OptionsColor.create(this.color,e.color)),e.enable!==void 0&&(this.enable=e.enable),e.frequency!==void 0&&(this.frequency=e.frequency),e.opacity!==void 0&&(this.opacity=e.opacity))}}class Links{constructor(){this.blink=!1,this.color=new OptionsColor,this.color.value="#fff",this.consent=!1,this.distance=100,this.enable=!1,this.frequency=1,this.opacity=1,this.shadow=new LinksShadow,this.triangles=new LinksTriangle,this.width=1,this.warp=!1}load(e){e&&(e.id!==void 0&&(this.id=e.id),e.blink!==void 0&&(this.blink=e.blink),this.color=OptionsColor.create(this.color,e.color),e.consent!==void 0&&(this.consent=e.consent),e.distance!==void 0&&(this.distance=e.distance),e.enable!==void 0&&(this.enable=e.enable),e.frequency!==void 0&&(this.frequency=e.frequency),e.opacity!==void 0&&(this.opacity=e.opacity),this.shadow.load(e.shadow),this.triangles.load(e.triangles),e.width!==void 0&&(this.width=e.width),e.warp!==void 0&&(this.warp=e.warp))}}function getLinkDistance(r,e,t,i,n){const{dx:s,dy:o,distance:a}=getDistances(r,e);if(!n||a<=t)return a;const l={x:Math.abs(s),y:Math.abs(o)},h={x:Math.min(l.x,i.width-l.x),y:Math.min(l.y,i.height-l.y)};return Math.sqrt(h.x**2+h.y**2)}class Linker extends ParticlesInteractorBase{constructor(e){super(e),this._setColor=t=>{if(!t.options.links)return;const i=this.linkContainer,n=t.options.links;let s=n.id===void 0?i.particles.linksColor:i.particles.linksColors.get(n.id);if(s)return;const o=n.color;s=getLinkRandomColor(o,n.blink,n.consent),n.id===void 0?i.particles.linksColor=s:i.particles.linksColors.set(n.id,s)},this.linkContainer=e}clear(){}init(){this.linkContainer.particles.linksColor=void 0,this.linkContainer.particles.linksColors=new Map}async interact(e){if(!e.options.links)return;e.links=[];const t=e.getPosition(),i=this.container,n=i.canvas.size;if(t.x<0||t.y<0||t.x>n.width||t.y>n.height)return;const s=e.options.links,o=s.opacity,a=e.retina.linksDistance??0,l=s.warp,h=l?new CircleWarp(t.x,t.y,a,n):new Circle(t.x,t.y,a),u=i.particles.quadTree.query(h);for(const g of u){const m=g.options.links;if(e===g||!(m!=null&&m.enable)||s.id!==m.id||g.spawning||g.destroyed||!g.links||e.links.some(c=>c.destination===g)||g.links.some(c=>c.destination===e))continue;const _=g.getPosition();if(_.x<0||_.y<0||_.x>n.width||_.y>n.height)continue;const b=getLinkDistance(t,_,a,n,l&&m.warp);if(b>a)continue;const d=(1-b/a)*o;this._setColor(e),e.links.push({destination:g,opacity:d})}}isEnabled(e){var t;return!!((t=e.options.links)!=null&&t.enable)}loadParticlesOptions(e,...t){e.links||(e.links=new Links);for(const i of t)e.links.load((i==null?void 0:i.links)??(i==null?void 0:i.lineLinked)??(i==null?void 0:i.line_linked))}reset(){}}async function loadLinksInteraction(r,e=!0){await r.addInteractor("particlesLinks",t=>new Linker(t),e)}function drawLinkLine(r){let e=!1;const{begin:t,end:i,maxDistance:n,context:s,canvasSize:o,width:a,backgroundMask:l,colorLine:h,opacity:u,links:g}=r;if(getDistance(t,i)<=n)drawLine(s,t,i),e=!0;else if(g.warp){let _,b;const d={x:i.x-o.width,y:i.y},c=getDistances(t,d);if(c.distance<=n){const f=t.y-c.dy/c.dx*t.x;_={x:0,y:f},b={x:o.width,y:f}}else{const f={x:i.x,y:i.y-o.height},v=getDistances(t,f);if(v.distance<=n){const D=-(t.y-v.dy/v.dx*t.x)/(v.dy/v.dx);_={x:D,y:0},b={x:D,y:o.height}}else{const y={x:i.x-o.width,y:i.y-o.height},D=getDistances(t,y);if(D.distance<=n){const E=t.y-D.dy/D.dx*t.x;_={x:-E/(D.dy/D.dx),y:E},b={x:_.x+o.width,y:_.y+o.height}}}}_&&b&&(drawLine(s,t,_),drawLine(s,i,b),e=!0)}if(!e)return;s.lineWidth=a,l.enable&&(s.globalCompositeOperation=l.composite),s.strokeStyle=getStyleFromRgb(h,u);const{shadow:m}=g;if(m.enable){const _=rangeColorToRgb(m.color);_&&(s.shadowBlur=m.blur,s.shadowColor=getStyleFromRgb(_))}s.stroke()}function drawLinkTriangle(r){const{context:e,pos1:t,pos2:i,pos3:n,backgroundMask:s,colorTriangle:o,opacityTriangle:a}=r;drawTriangle(e,t,i,n),s.enable&&(e.globalCompositeOperation=s.composite),e.fillStyle=getStyleFromRgb(o,a),e.fill()}function getLinkKey(r){return r.sort((e,t)=>e-t),r.join("_")}function setLinkFrequency(r,e){const t=getLinkKey(r.map(n=>n.id));let i=e.get(t);return i===void 0&&(i=getRandom(),e.set(t,i)),i}class LinkInstance{constructor(e){this.container=e,this._drawLinkLine=(t,i)=>{const n=t.options.links;if(!(n!=null&&n.enable))return;const s=this.container,o=s.actualOptions,a=i.destination,l=t.getPosition(),h=a.getPosition();let u=i.opacity;s.canvas.draw(g=>{var f;let m;const _=(f=t.options.twinkle)==null?void 0:f.lines;if(_!=null&&_.enable){const v=_.frequency,y=rangeColorToRgb(_.color);getRandom()<v&&y&&(m=y,u=getRangeValue(_.opacity))}if(!m){const v=n.id!==void 0?s.particles.linksColors.get(n.id):s.particles.linksColor;m=getLinkColor(t,a,v)}if(!m)return;const b=t.retina.linksWidth??0,d=t.retina.linksDistance??0,{backgroundMask:c}=o;drawLinkLine({context:g,width:b,begin:l,end:h,maxDistance:d,canvasSize:s.canvas.size,links:n,backgroundMask:c,colorLine:m,opacity:u})})},this._drawLinkTriangle=(t,i,n)=>{const s=t.options.links;if(!(s!=null&&s.enable))return;const o=s.triangles;if(!o.enable)return;const a=this.container,l=a.actualOptions,h=i.destination,u=n.destination,g=o.opacity??(i.opacity+n.opacity)/2;g<=0||a.canvas.draw(m=>{const _=t.getPosition(),b=h.getPosition(),d=u.getPosition(),c=t.retina.linksDistance??0;if(getDistance(_,b)>c||getDistance(d,b)>c||getDistance(d,_)>c)return;let f=rangeColorToRgb(o.color);if(!f){const v=s.id!==void 0?a.particles.linksColors.get(s.id):a.particles.linksColor;f=getLinkColor(t,h,v)}f&&drawLinkTriangle({context:m,pos1:_,pos2:b,pos3:d,backgroundMask:l.backgroundMask,colorTriangle:f,opacityTriangle:g})})},this._drawTriangles=(t,i,n,s)=>{var l,h,u;const o=n.destination;if(!((l=t.links)!=null&&l.triangles.enable&&((h=o.options.links)!=null&&h.triangles.enable)))return;const a=(u=o.links)==null?void 0:u.filter(g=>{const m=this._getLinkFrequency(o,g.destination);return o.options.links&&m<=o.options.links.frequency&&s.findIndex(_=>_.destination===g.destination)>=0});if(a!=null&&a.length)for(const g of a){const m=g.destination;this._getTriangleFrequency(i,o,m)>t.links.triangles.frequency||this._drawLinkTriangle(i,n,g)}},this._getLinkFrequency=(t,i)=>setLinkFrequency([t,i],this._freqs.links),this._getTriangleFrequency=(t,i,n)=>setLinkFrequency([t,i,n],this._freqs.triangles),this._freqs={links:new Map,triangles:new Map}}drawParticle(e,t){const{links:i,options:n}=t;if(!i||i.length<=0)return;const s=i.filter(o=>n.links&&this._getLinkFrequency(t,o.destination)<=n.links.frequency);for(const o of s)this._drawTriangles(n,t,o,s),o.opacity>0&&(t.retina.linksWidth??0)>0&&this._drawLinkLine(t,o)}async init(){this._freqs.links=new Map,this._freqs.triangles=new Map}particleCreated(e){if(e.links=[],!e.options.links)return;const t=this.container.retina.pixelRatio,{retina:i}=e,{distance:n,width:s}=e.options.links;i.linksDistance=n*t,i.linksWidth=s*t}particleDestroyed(e){e.links=[]}}class LinksPlugin{constructor(){this.id="links"}getPlugin(e){return new LinkInstance(e)}loadOptions(){}needsPlugin(){return!0}}async function loadLinksPlugin(r,e=!0){const t=new LinksPlugin;await r.addPlugin(t,e)}async function loadParticlesLinksInteraction(r,e=!0){await loadLinksInteraction(r,e),await loadLinksPlugin(r,e)}class PolygonDrawerBase{draw(e,t,i){const n=this.getCenter(t,i),s=this.getSidesData(t,i),o=s.count.numerator*s.count.denominator,a=s.count.numerator/s.count.denominator,l=180*(a-2)/a,h=Math.PI-Math.PI*l/180;if(e){e.beginPath(),e.translate(n.x,n.y),e.moveTo(0,0);for(let u=0;u<o;u++)e.lineTo(s.length,0),e.translate(s.length,0),e.rotate(h)}}getSidesCount(e){const t=e.shapeData;return Math.round(getRangeValue((t==null?void 0:t.sides)??(t==null?void 0:t.nb_sides)??5))}}class PolygonDrawer extends PolygonDrawerBase{getCenter(e,t){return{x:-t/(e.sides/3.5),y:-t/(2.66/3.5)}}getSidesData(e,t){const i=e.sides;return{count:{denominator:1,numerator:i},length:t*2.66/(i/3)}}}class TriangleDrawer extends PolygonDrawerBase{getCenter(e,t){return{x:-t,y:t/1.66}}getSidesCount(){return 3}getSidesData(e,t){return{count:{denominator:2,numerator:3},length:t*2}}}async function loadGenericPolygonShape(r,e=!0){await r.addShape("polygon",new PolygonDrawer,e)}async function loadTriangleShape(r,e=!0){await r.addShape("triangle",new TriangleDrawer,e)}async function loadPolygonShape(r,e=!0){await loadGenericPolygonShape(r,e),await loadTriangleShape(r,e)}class RotateAnimation{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){e&&(e.enable!==void 0&&(this.enable=e.enable),e.speed!==void 0&&(this.speed=setRangeValue(e.speed)),e.decay!==void 0&&(this.decay=setRangeValue(e.decay)),e.sync!==void 0&&(this.sync=e.sync))}}class Rotate extends ValueWithRandom{constructor(){super(),this.animation=new RotateAnimation,this.direction="clockwise",this.path=!1,this.value=0}load(e){e&&(super.load(e),e.direction!==void 0&&(this.direction=e.direction),this.animation.load(e.animation),e.path!==void 0&&(this.path=e.path))}}function updateRotate(r,e){const t=r.rotate,i=r.options.rotate;if(!t||!i)return;const n=i.animation,s=(t.velocity??0)*e.factor,o=2*Math.PI,a=t.decay??1;if(n.enable){switch(t.status){case"increasing":t.value+=s,t.value>o&&(t.value-=o);break;case"decreasing":default:t.value-=s,t.value<0&&(t.value+=o);break}t.velocity&&a!==1&&(t.velocity*=a)}}class RotateUpdater{constructor(e){this.container=e}init(e){const t=e.options.rotate;if(!t)return;e.rotate={enable:t.animation.enable,value:getRangeValue(t.value)*Math.PI/180},e.pathRotation=t.path;let i=t.direction;switch(i==="random"&&(i=Math.floor(getRandom()*2)>0?"counter-clockwise":"clockwise"),i){case"counter-clockwise":case"counterClockwise":e.rotate.status="decreasing";break;case"clockwise":e.rotate.status="increasing";break}const n=t.animation;n.enable&&(e.rotate.decay=1-getRangeValue(n.decay),e.rotate.velocity=getRangeValue(n.speed)/360*this.container.retina.reduceFactor,n.sync||(e.rotate.velocity*=getRandom())),e.rotation=e.rotate.value}isEnabled(e){const t=e.options.rotate;return t?!e.destroyed&&!e.spawning&&t.animation.enable&&!t.path:!1}loadOptions(e,...t){e.rotate||(e.rotate=new Rotate);for(const i of t)e.rotate.load(i==null?void 0:i.rotate)}update(e,t){var i;this.isEnabled(e)&&(updateRotate(e,t),e.rotation=((i=e.rotate)==null?void 0:i.value)??0)}}async function loadRotateUpdater(r,e=!0){await r.addParticleUpdater("rotate",t=>new RotateUpdater(t),e)}const fixFactor=Math.sqrt(2);class SquareDrawer{draw(e,t,i){const n=i/fixFactor,s=n*2;e.rect(-n,-n,s,s)}getSidesCount(){return 4}}async function loadSquareShape(r,e=!0){await r.addShape(["edge","square"],new SquareDrawer,e)}class StarDrawer{draw(e,t,i){const n=t.sides,s=t.starInset??2;e.moveTo(0,0-i);for(let o=0;o<n;o++)e.rotate(Math.PI/n),e.lineTo(0,0-i*s),e.rotate(Math.PI/n),e.lineTo(0,0-i)}getSidesCount(e){const t=e.shapeData;return Math.round(getRangeValue((t==null?void 0:t.sides)??(t==null?void 0:t.nb_sides)??5))}particleInit(e,t){const i=t.shapeData,n=getRangeValue((i==null?void 0:i.inset)??2);t.starInset=n}}async function loadStarShape(r,e=!0){await r.addShape("star",new StarDrawer,e)}function updateColorValue(r,e,t,i,n){if(!e||!t.enable||(e.maxLoops??0)>0&&(e.loops??0)>(e.maxLoops??0)||(e.time||(e.time=0),(e.delayTime??0)>0&&e.time<(e.delayTime??0)&&(e.time+=r.value),(e.delayTime??0)>0&&e.time<(e.delayTime??0)))return;const s=randomInRange(t.offset),o=(e.velocity??0)*r.factor+s*3.6,a=e.decay??1;!n||e.status==="increasing"?(e.value+=o,e.value>i&&(e.loops||(e.loops=0),e.loops++,n&&(e.status="decreasing",e.value-=e.value%i))):(e.value-=o,e.value<0&&(e.loops||(e.loops=0),e.loops++,e.status="increasing",e.value+=e.value)),e.velocity&&a!==1&&(e.velocity*=a),e.value>i&&(e.value%=i)}function updateStrokeColor(r,e){if(!r.strokeColor||!r.strokeAnimation)return;const{h:t,s:i,l:n}=r.strokeColor,{h:s,s:o,l:a}=r.strokeAnimation;t&&updateColorValue(e,t,s,360,!1),i&&updateColorValue(e,i,o,100,!0),n&&updateColorValue(e,n,a,100,!0)}class StrokeColorUpdater{constructor(e){this.container=e}init(e){var o;const t=this.container,i=e.options,n=itemFromSingleOrMultiple(i.stroke,e.id,i.reduceDuplicates);e.strokeWidth=getRangeValue(n.width)*t.retina.pixelRatio,e.strokeOpacity=getRangeValue(n.opacity??1),e.strokeAnimation=(o=n.color)==null?void 0:o.animation;const s=rangeColorToHsl(n.color)??e.getFillColor();s&&(e.strokeColor=getHslAnimationFromHsl(s,e.strokeAnimation,t.retina.reduceFactor))}isEnabled(e){const t=e.strokeAnimation,{strokeColor:i}=e;return!e.destroyed&&!e.spawning&&!!t&&((i==null?void 0:i.h.value)!==void 0&&i.h.enable||(i==null?void 0:i.s.value)!==void 0&&i.s.enable||(i==null?void 0:i.l.value)!==void 0&&i.l.enable)}update(e,t){this.isEnabled(e)&&updateStrokeColor(e,t)}}async function loadStrokeColorUpdater(r,e=!0){await r.addParticleUpdater("strokeColor",t=>new StrokeColorUpdater(t),e)}const validTypes=["text","character","char"];class TextDrawer{draw(e,t,i,n){const s=t.shapeData;if(s===void 0)return;const o=s.value;if(o===void 0)return;t.text===void 0&&(t.text=itemFromSingleOrMultiple(o,t.randomIndexData));const a=t.text,l=s.style??"",h=s.weight??"400",u=Math.round(i)*2,g=s.font??"Verdana",m=t.fill,_=a.length*i/2;e.font=`${l} ${h} ${u}px "${g}"`;const b={x:-_,y:i/2};e.globalAlpha=n,m?e.fillText(a,b.x,b.y):e.strokeText(a,b.x,b.y),e.globalAlpha=1}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(validTypes.find(i=>isInArray(i,t.particles.shape.type))){const i=validTypes.map(s=>t.particles.shape.options[s]).find(s=>!!s),n=[];executeOnSingleOrMultiple(i,s=>{n.push(loadFont(s.font,s.weight))}),await Promise.all(n)}}particleInit(e,t){if(!t.shape||!validTypes.includes(t.shape))return;const i=t.shapeData;if(i===void 0)return;const n=i.value;n!==void 0&&(t.text=itemFromSingleOrMultiple(n,t.randomIndexData))}}async function loadTextShape(r,e=!0){await r.addShape(validTypes,new TextDrawer,e)}async function loadSlim(r,e=!0){initPjs(r),await loadParallaxMover(r,!1),await loadExternalAttractInteraction(r,!1),await loadExternalBounceInteraction(r,!1),await loadExternalBubbleInteraction(r,!1),await loadExternalConnectInteraction(r,!1),await loadExternalGrabInteraction(r,!1),await loadExternalPauseInteraction(r,!1),await loadExternalPushInteraction(r,!1),await loadExternalRemoveInteraction(r,!1),await loadExternalRepulseInteraction(r,!1),await loadExternalSlowInteraction(r,!1),await loadParticlesAttractInteraction(r,!1),await loadParticlesCollisionsInteraction(r,!1),await loadParticlesLinksInteraction(r,!1),await loadEasingQuadPlugin(),await loadImageShape(r,!1),await loadLineShape(r,!1),await loadPolygonShape(r,!1),await loadSquareShape(r,!1),await loadStarShape(r,!1),await loadTextShape(r,!1),await loadLifeUpdater(r,!1),await loadRotateUpdater(r,!1),await loadStrokeColorUpdater(r,!1),await loadBasic(r,e)}function _assertThisInitialized(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _inheritsLoose(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults$1={duration:.5,overwrite:!1,delay:0},_suppressOverwrites$1,_reverting$1,_context$2,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString$1=function(e){return typeof e=="string"},_isFunction$1=function(e){return typeof e=="function"},_isNumber$1=function(e){return typeof e=="number"},_isUndefined=function(e){return typeof e>"u"},_isObject$1=function(e){return typeof e=="object"},_isNotFalse=function(e){return e!==!1},_windowExists$2=function(){return typeof window<"u"},_isFuncOrString=function(e){return _isFunction$1(e)||_isString$1(e)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$3,_coreInitted$2,_doc$3,_globals={},_installScope={},_coreReady,_install=function(e){return(_installScope=_merge(e,_globals))&&gsap$3},_missingPlugin=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},_warn=function(e,t){return!t&&console.warn(e)},_addGlobal=function(e,t){return e&&(_globals[e]=t)&&_installScope&&(_installScope[e]=t)||_globals},_emptyFunc=function(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function(e){var t=e[0],i,n;if(_isObject$1(t)||_isFunction$1(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=_harnessPlugins.length;n--&&!_harnessPlugins[n].targetTest(t););i=_harnessPlugins[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new GSCache(e[n],i)))||e.splice(n,1);return e},_getCache=function(e){return e._gsap||_harness(toArray(e))[0]._gsap},_getProperty=function(e,t,i){return(i=e[t])&&_isFunction$1(i)?e[t]():_isUndefined(i)&&e.getAttribute&&e.getAttribute(t)||i},_forEachName=function(e,t){return(e=e.split(",")).forEach(t)||e},_round$1=function(e){return Math.round(e*1e5)/1e5||0},_roundPrecise=function(e){return Math.round(e*1e7)/1e7||0},_parseRelative=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},_arrayContainsAny=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},_lazyRender=function(){var e=_lazyTweens.length,t=_lazyTweens.slice(0),i,n;for(_lazyLookup={},_lazyTweens.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},_isRevertWorthy=function(e){return!!(e._initted||e._startAt||e.add)},_lazySafeRender=function(e,t,i,n){_lazyTweens.length&&!_reverting$1&&_lazyRender(),e.render(t,i,!!(_reverting$1&&t<0&&_isRevertWorthy(e))),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(_delimitedValueExp).length<2?t:_isString$1(e)?e.trim():e},_passThrough$1=function(e){return e},_setDefaults$1=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_setKeyframeDefaults=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},_merge=function(e,t){for(var i in t)e[i]=t[i];return e},_mergeDeep=function r(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=_isObject$1(t[i])?r(e[i]||(e[i]={}),t[i]):t[i]);return e},_copyExcluding=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},_inheritDefaults=function(e){var t=e.parent||_globalTimeline,i=e.keyframes?_setKeyframeDefaults(_isArray(e.keyframes)):_setDefaults$1;if(_isNotFalse(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},_arraysMatch=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},_addLinkedListItem=function(e,t,i,n,s){var o=e[n],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=o,t.parent=t._dp=e,t},_removeLinkedListItem=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},_removeFromParent=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},_uncache=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},_recacheAncestors=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},_rewindStartAt=function(e,t,i,n){return e._startAt&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},_hasNoPausedAncestors=function r(e){return!e||e._ts&&r(e.parent)},_elapsedCycleDuration=function(e){return e._repeat?_animationCycle(e._tTime,e=e.duration()+e._rDelay)*e:0},_animationCycle=function(e,t){var i=Math.floor(e=_roundPrecise(e/t));return e&&i===e?i-1:i},_parentToChildTotalTime=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},_setEnd=function(e){return e._end=_roundPrecise(e._start+(e._tDur/Math.abs(e._ts||e._rts||_tinyNum)||0))},_alignPlayhead=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=_roundPrecise(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),_setEnd(e),i._dirty||_uncache(i,e)),e},_postAddChecks=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=_parentToChildTotalTime(e.rawTime(),t),(!t._dur||_clamp$1(0,t.totalDuration(),i)-t._tTime>_tinyNum)&&t.render(i,!0)),_uncache(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-_tinyNum}},_addToTimeline=function(e,t,i,n){return t.parent&&_removeFromParent(t),t._start=_roundPrecise((_isNumber$1(i)?i:i||e!==_globalTimeline?_parsePosition$1(e,i,t):e._time)+t._delay),t._end=_roundPrecise(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),_addLinkedListItem(e,t,"_first","_last",e._sort?"_start":0),_isFromOrFromStart(t)||(e._recent=t),n||_postAddChecks(e,t),e._ts<0&&_alignPlayhead(e,e._tTime),e},_scrollTrigger=function(e,t){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",t))&&_globals.ScrollTrigger.create(t,e)},_attemptInitTween=function(e,t,i,n,s){if(_initTween(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!_reverting$1&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(e),e._lazy=[s,n],1},_parentPlayheadIsBeforeStart=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},_isFromOrFromStart=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},_renderZeroDurationTween=function(e,t,i,n){var s=e.ratio,o=t<0||!t&&(!e._start&&_parentPlayheadIsBeforeStart(e)&&!(!e._initted&&_isFromOrFromStart(e))||(e._ts<0||e._dp._ts<0)&&!_isFromOrFromStart(e))?0:1,a=e._rDelay,l=0,h,u,g;if(a&&e._repeat&&(l=_clamp$1(0,e._tDur,t),u=_animationCycle(l,a),e._yoyo&&u&1&&(o=1-o),u!==_animationCycle(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||_reverting$1||n||e._zTime===_tinyNum||!t&&e._zTime){if(!e._initted&&_attemptInitTween(e,t,n,i,l))return;for(g=e._zTime,e._zTime=t||(i?_tinyNum:0),i||(i=t&&!g),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,h=e._pt;h;)h.r(o,h.d),h=h._next;t<0&&_rewindStartAt(e,t,i,!0),e._onUpdate&&!i&&_callback$1(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&_callback$1(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&_removeFromParent(e,1),!i&&!_reverting$1&&(_callback$1(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},_findNextPauseTween=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},_setDuration=function(e,t,i,n){var s=e._repeat,o=_roundPrecise(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:_roundPrecise(o*(s+1)+e._rDelay*s):o,a>0&&!n&&_alignPlayhead(e,e._tTime=e._tDur*a),e.parent&&_setEnd(e),i||_uncache(e.parent,e),e},_onUpdateTotalDuration=function(e){return e instanceof Timeline?_uncache(e):_setDuration(e,e._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition$1=function r(e,t,i){var n=e.labels,s=e._recent||_zeroPosition,o=e.duration()>=_bigNum$1?s.endTime(!1):e._dur,a,l,h;return _isString$1(t)&&(isNaN(t)||t in n)?(l=t.charAt(0),h=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(a<0?s:i).totalDuration()/100:1)):a<0?(t in n||(n[t]=o),n[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),h&&i&&(l=l/100*(_isArray(i)?i[0]:i).totalDuration()),a>1?r(e,t.substr(0,a-1),i)+l:o+l)):t==null?o:+t},_createTweenType=function(e,t,i){var n=_isNumber$1(t[1]),s=(n?2:1)+(e<2?0:1),o=t[s],a,l;if(n&&(o.duration=t[1]),o.parent=i,e){for(a=o,l=i;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=_isNotFalse(l.vars.inherit)&&l.parent;o.immediateRender=_isNotFalse(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new Tween(t[0],o,t[s+1])},_conditionalReturn=function(e,t){return e||e===0?t(e):t},_clamp$1=function(e,t,i){return i<e?e:i>t?t:i},getUnit=function(e,t){return!_isString$1(e)||!(t=_unitExp.exec(e))?"":t[1]},clamp=function(e,t,i){return _conditionalReturn(i,function(n){return _clamp$1(e,t,n)})},_slice=[].slice,_isArrayLike=function(e,t){return e&&_isObject$1(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&_isObject$1(e[0]))&&!e.nodeType&&e!==_win$3},_flatten=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var s;return _isString$1(n)&&!t||_isArrayLike(n,1)?(s=i).push.apply(s,toArray(n)):i.push(n)})||i},toArray=function(e,t,i){return _context$2&&!t&&_context$2.selector?_context$2.selector(e):_isString$1(e)&&!i&&(_coreInitted$2||!_wake())?_slice.call((t||_doc$3).querySelectorAll(e),0):_isArray(e)?_flatten(e,i):_isArrayLike(e)?_slice.call(e,0):e?[e]:[]},selector=function(e){return e=toArray(e)[0]||_warn("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return toArray(t,i.querySelectorAll?i:i===e?_warn("Invalid scope")||_doc$3.createElement("div"):e)}},shuffle=function(e){return e.sort(function(){return .5-Math.random()})},distribute=function(e){if(_isFunction$1(e))return e;var t=_isObject$1(e)?e:{each:e},i=_parseEase(t.ease),n=t.from||0,s=parseFloat(t.base)||0,o={},a=n>0&&n<1,l=isNaN(n)||a,h=t.axis,u=n,g=n;return _isString$1(n)?u=g={center:.5,edges:.5,end:1}[n]||0:!a&&l&&(u=n[0],g=n[1]),function(m,_,b){var d=(b||t).length,c=o[d],f,v,y,D,E,p,x,w,C;if(!c){if(C=t.grid==="auto"?0:(t.grid||[1,_bigNum$1])[1],!C){for(x=-_bigNum$1;x<(x=b[C++].getBoundingClientRect().left)&&C<d;);C<d&&C--}for(c=o[d]=[],f=l?Math.min(C,d)*u-.5:n%C,v=C===_bigNum$1?0:l?d*g/C-.5:n/C|0,x=0,w=_bigNum$1,p=0;p<d;p++)y=p%C-f,D=v-(p/C|0),c[p]=E=h?Math.abs(h==="y"?D:y):_sqrt(y*y+D*D),E>x&&(x=E),E<w&&(w=E);n==="random"&&shuffle(c),c.max=x-w,c.min=w,c.v=d=(parseFloat(t.amount)||parseFloat(t.each)*(C>d?d-1:h?h==="y"?d/C:C:Math.max(C,d/C))||0)*(n==="edges"?-1:1),c.b=d<0?s-d:s,c.u=getUnit(t.amount||t.each)||0,i=i&&d<0?_invertEase(i):i}return d=(c[m]-c.min)/c.max||0,_roundPrecise(c.b+(i?i(d):d)*c.v)+c.u}},_roundModifier=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=_roundPrecise(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(_isNumber$1(i)?0:getUnit(i))}},snap=function(e,t){var i=_isArray(e),n,s;return!i&&_isObject$1(e)&&(n=i=e.radius||_bigNum$1,e.values?(e=toArray(e.values),(s=!_isNumber$1(e[0]))&&(n*=n)):e=_roundModifier(e.increment)),_conditionalReturn(t,i?_isFunction$1(e)?function(o){return s=e(o),Math.abs(s-o)<=n?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),h=_bigNum$1,u=0,g=e.length,m,_;g--;)s?(m=e[g].x-a,_=e[g].y-l,m=m*m+_*_):m=Math.abs(e[g]-a),m<h&&(h=m,u=g);return u=!n||h<=n?e[u]:o,s||u===o||_isNumber$1(o)?u:u+getUnit(o)}:_roundModifier(e))},random=function(e,t,i,n){return _conditionalReturn(_isArray(e)?!t:i===!0?!!(i=0):!n,function(){return _isArray(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},pipe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(s,o){return o(s)},n)}},unitize=function(e,t){return function(i){return e(parseFloat(i))+(t||getUnit(i))}},normalize=function(e,t,i){return mapRange(e,t,0,1,i)},_wrapArray=function(e,t,i){return _conditionalReturn(i,function(n){return e[~~t(n)]})},wrap=function r(e,t,i){var n=t-e;return _isArray(e)?_wrapArray(e,r(0,e.length),t):_conditionalReturn(i,function(s){return(n+(s-e)%n)%n+e})},wrapYoyo=function r(e,t,i){var n=t-e,s=n*2;return _isArray(e)?_wrapArray(e,r(0,e.length-1),t):_conditionalReturn(i,function(o){return o=(s+(o-e)%s)%s||0,e+(o>n?s-o:o)})},_replaceRandom=function(e){for(var t=0,i="",n,s,o,a;~(n=e.indexOf("random(",t));)o=e.indexOf(")",n),a=e.charAt(n+7)==="[",s=e.substr(n+7,o-n-7).match(a?_delimitedValueExp:_strictNumExp),i+=e.substr(t,n-t)+random(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},mapRange=function(e,t,i,n,s){var o=t-e,a=n-i;return _conditionalReturn(s,function(l){return i+((l-e)/o*a||0)})},interpolate$2=function r(e,t,i,n){var s=isNaN(e+t)?0:function(_){return(1-_)*e+_*t};if(!s){var o=_isString$1(e),a={},l,h,u,g,m;if(i===!0&&(n=1)&&(i=null),o)e={p:e},t={p:t};else if(_isArray(e)&&!_isArray(t)){for(u=[],g=e.length,m=g-2,h=1;h<g;h++)u.push(r(e[h-1],e[h]));g--,s=function(b){b*=g;var d=Math.min(m,~~b);return u[d](b-d)},i=t}else n||(e=_merge(_isArray(e)?[]:{},e));if(!u){for(l in t)_addPropTween.call(a,e,l,"get",t[l]);s=function(b){return _renderPropTweens(b,a)||(o?e.p:e)}}}return _conditionalReturn(i,s)},_getLabelInDirection=function(e,t,i){var n=e.labels,s=_bigNum$1,o,a,l;for(o in n)a=n[o]-t,a<0==!!i&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},_callback$1=function(e,t,i){var n=e.vars,s=n[t],o=_context$2,a=e._ctx,l,h,u;if(s)return l=n[t+"Params"],h=n.callbackScope||e,i&&_lazyTweens.length&&_lazyRender(),a&&(_context$2=a),u=l?s.apply(h,l):s.call(h),_context$2=o,u},_interrupt=function(e){return _removeFromParent(e),e.scrollTrigger&&e.scrollTrigger.kill(!!_reverting$1),e.progress()<1&&_callback$1(e,"onInterrupt"),e},_quickTween,_registerPluginQueue=[],_createPlugin=function(e){if(e)if(e=!e.name&&e.default||e,_windowExists$2()||e.headless){var t=e.name,i=_isFunction$1(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},o={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),e!==n){if(_plugins[t])return;_setDefaults$1(n,_setDefaults$1(_copyExcluding(e,s),o)),_merge(n.prototype,_merge(s,_copyExcluding(e,o))),_plugins[n.prop=t]=n,e.targetTest&&(_harnessPlugins.push(n),_reservedProps[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}_addGlobal(t,n),e.register&&e.register(gsap$3,n,PropTween)}else _registerPluginQueue.push(e)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*_255+.5|0},splitColor=function(e,t,i){var n=e?_isNumber$1(e)?[e>>16,e>>8&_255,e&_255]:0:_colorLookup.black,s,o,a,l,h,u,g,m,_,b;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),_colorLookup[e])n=_colorLookup[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&_255,n&_255,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&_255,e&_255]}else if(e.substr(0,3)==="hsl"){if(n=b=e.match(_strictNumExp),!t)l=+n[0]%360/360,h=+n[1]/100,u=+n[2]/100,o=u<=.5?u*(h+1):u+h-u*h,s=u*2-o,n.length>3&&(n[3]*=1),n[0]=_hue(l+1/3,s,o),n[1]=_hue(l,s,o),n[2]=_hue(l-1/3,s,o);else if(~e.indexOf("="))return n=e.match(_numExp),i&&n.length<4&&(n[3]=1),n}else n=e.match(_strictNumExp)||_colorLookup.transparent;n=n.map(Number)}return t&&!b&&(s=n[0]/_255,o=n[1]/_255,a=n[2]/_255,g=Math.max(s,o,a),m=Math.min(s,o,a),u=(g+m)/2,g===m?l=h=0:(_=g-m,h=u>.5?_/(2-g-m):_/(g+m),l=g===s?(o-a)/_+(o<a?6:0):g===o?(a-s)/_+2:(s-o)/_+4,l*=60),n[0]=~~(l+.5),n[1]=~~(h*100+.5),n[2]=~~(u*100+.5)),i&&n.length<4&&(n[3]=1),n},_colorOrderData=function(e){var t=[],i=[],n=-1;return e.split(_colorExp).forEach(function(s){var o=s.match(_numWithUnitExp)||[];t.push.apply(t,o),i.push(n+=o.length+1)}),t.c=i,t},_formatColors=function(e,t,i){var n="",s=(e+n).match(_colorExp),o=t?"hsla(":"rgba(",a=0,l,h,u,g;if(!s)return e;if(s=s.map(function(m){return(m=splitColor(m,t,1))&&o+(t?m[0]+","+m[1]+"%,"+m[2]+"%,"+m[3]:m.join(","))+")"}),i&&(u=_colorOrderData(e),l=i.c,l.join(n)!==u.c.join(n)))for(h=e.replace(_colorExp,"1").split(_numWithUnitExp),g=h.length-1;a<g;a++)n+=h[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!h)for(h=e.split(_colorExp),g=h.length-1;a<g;a++)n+=h[a]+s[a];return n+h[g]},_colorExp=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in _colorLookup)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function(e){var t=e.join(" "),i;if(_colorExp.lastIndex=0,_colorExp.test(t))return i=_hslExp.test(t),e[1]=_formatColors(e[1],i),e[0]=_formatColors(e[0],i,_colorOrderData(e[1])),!0},_tickerActive,_ticker=function(){var r=Date.now,e=500,t=33,i=r(),n=i,s=1e3/240,o=s,a=[],l,h,u,g,m,_,b=function d(c){var f=r()-n,v=c===!0,y,D,E,p;if((f>e||f<0)&&(i+=f-t),n+=f,E=n-i,y=E-o,(y>0||v)&&(p=++g.frame,m=E-g.time*1e3,g.time=E=E/1e3,o+=y+(y>=s?4:s-y),D=1),v||(l=h(d)),D)for(_=0;_<a.length;_++)a[_](E,m,p,c)};return g={time:0,frame:0,tick:function(){b(!0)},deltaRatio:function(c){return m/(1e3/(c||60))},wake:function(){_coreReady&&(!_coreInitted$2&&_windowExists$2()&&(_win$3=_coreInitted$2=window,_doc$3=_win$3.document||{},_globals.gsap=gsap$3,(_win$3.gsapVersions||(_win$3.gsapVersions=[])).push(gsap$3.version),_install(_installScope||_win$3.GreenSockGlobals||!_win$3.gsap&&_win$3||{}),_registerPluginQueue.forEach(_createPlugin)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&g.sleep(),h=u||function(c){return setTimeout(c,o-g.time*1e3+1|0)},_tickerActive=1,b(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(l),_tickerActive=0,h=_emptyFunc},lagSmoothing:function(c,f){e=c||1/0,t=Math.min(f||33,e)},fps:function(c){s=1e3/(c||240),o=g.time*1e3+s},add:function(c,f,v){var y=f?function(D,E,p,x){c(D,E,p,x),g.remove(y)}:c;return g.remove(c),a[v?"unshift":"push"](y),_wake(),y},remove:function(c,f){~(f=a.indexOf(c))&&a.splice(f,1)&&_>=f&&_--},_listeners:a},g}(),_wake=function(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],s=1,o=i.length,a,l,h;s<o;s++)l=i[s],a=s!==o-1?l.lastIndexOf(","):l.length,h=l.substr(0,a),t[n]=isNaN(h)?h.replace(_quotesExp,"").trim():+h,n=l.substr(a+1).trim();return t},_valueInParentheses=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},_configEaseFromString=function(e){var t=(e+"").split("("),i=_easeMap[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[_parseObjectInString(t[1])]:_valueInParentheses(e).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(e)?_easeMap._CE("",e):i},_invertEase=function(e){return function(t){return 1-e(1-t)}},_propagateYoyoEase=function r(e,t){for(var i=e._first,n;i;)i instanceof Timeline?r(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?r(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},_parseEase=function(e,t){return e&&(_isFunction$1(e)?e:_easeMap[e]||_configEaseFromString(e))||t},_insertEase=function(e,t,i,n){i===void 0&&(i=function(l){return 1-t(1-l)}),n===void 0&&(n=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:n},o;return _forEachName(e,function(a){_easeMap[a]=_globals[a]=s,_easeMap[o=a.toLowerCase()]=i;for(var l in s)_easeMap[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=_easeMap[a+"."+l]=s[l]}),s},_easeInOutFromOut=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},_configElastic=function r(e,t,i){var n=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/_2PI*(Math.asin(1/n)||0),a=function(u){return u===1?1:n*Math.pow(2,-10*u)*_sin((u-o)*s)+1},l=e==="out"?a:e==="in"?function(h){return 1-a(1-h)}:_easeInOutFromOut(a);return s=_2PI/s,l.config=function(h,u){return r(e,h,u)},l},_configBack=function r(e,t){t===void 0&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},n=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:_easeInOutFromOut(i);return n.config=function(s){return r(e,s)},n};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;_insertEase(r+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(r,e){var t=1/e,i=2*t,n=2.5*t,s=function(a){return a<t?r*a*a:a<i?r*Math.pow(a-1.5/e,2)+.75:a<n?r*(a-=2.25/e)*a+.9375:r*Math.pow(a-2.625/e,2)+.984375};_insertEase("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);_insertEase("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});_insertEase("Circ",function(r){return-(_sqrt(1-r*r)-1)});_insertEase("Sine",function(r){return r===1?1:-_cos(r*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,o=1-_tinyNum;return function(a){return((n*_clamp$1(0,o,a)|0)+s)*i}}};_defaults$1.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return _callbackNames+=r+","+r+"Params,"});var GSCache=function(e,t){this.id=_gsID++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:_getProperty,this.set=t?t.getSetter:_getSetter},Animation$1=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,_setDuration(this,+t.duration,1,1),this.data=t.data,_context$2&&(this._ctx=_context$2,_context$2.data.push(this)),_tickerActive||_ticker.wake()}var e=r.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(_wake(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(_alignPlayhead(this,i),!s._dp||s.parent||_postAddChecks(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===_tinyNum||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),_lazySafeRender(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+_elapsedCycleDuration(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,n){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,n):this._repeat?_animationCycle(this._tTime,s)+1:1},e.timeScale=function(i,n){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-_tinyNum?0:this._rts,this.totalTime(_clamp$1(-Math.abs(this._delay),this.totalDuration(),s),n!==!1),_setEnd(this),_recacheAncestors(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&_addToTimeline(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(_isNotFalse(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(n.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=_revertConfig);var n=_reverting$1;return _reverting$1=i,_isRevertWorthy(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),_reverting$1=n,this},e.globalTime=function(i){for(var n=this,s=arguments.length?i:n.rawTime();n;)s=n._start+s/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,_onUpdateTotalDuration(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(_parsePosition$1(this,i),_isNotFalse(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,_isNotFalse(n)),this._dur||(this._zTime=-_tinyNum),this},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-_tinyNum:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=n&&s<this.endTime(!0)-_tinyNum)},e.eventCallback=function(i,n,s){var o=this.vars;return arguments.length>1?(n?(o[i]=n,s&&(o[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=n)):delete o[i],this):o[i]},e.then=function(i){var n=this;return new Promise(function(s){var o=_isFunction$1(i)?i:_passThrough$1,a=function(){var h=n.then;n.then=null,_isFunction$1(o)&&(o=o(n))&&(o.then||o===n)&&(n.then=h),s(o),n.then=h};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?a():n._prom=a})},e.kill=function(){_interrupt(this)},r}();_setDefaults$1(Animation$1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(r){_inheritsLoose(e,r);function e(i,n){var s;return i===void 0&&(i={}),s=r.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=_isNotFalse(i.sortChildren),_globalTimeline&&_addToTimeline(i.parent||_globalTimeline,_assertThisInitialized(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&_scrollTrigger(_assertThisInitialized(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(n,s,o){return _createTweenType(0,arguments,this),this},t.from=function(n,s,o){return _createTweenType(1,arguments,this),this},t.fromTo=function(n,s,o,a){return _createTweenType(2,arguments,this),this},t.set=function(n,s,o){return s.duration=0,s.parent=this,_inheritDefaults(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Tween(n,s,_parsePosition$1(this,o),1),this},t.call=function(n,s,o){return _addToTimeline(this,Tween.delayedCall(0,n,s),o)},t.staggerTo=function(n,s,o,a,l,h,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=h,o.onCompleteParams=u,o.parent=this,new Tween(n,o,_parsePosition$1(this,l)),this},t.staggerFrom=function(n,s,o,a,l,h,u){return o.runBackwards=1,_inheritDefaults(o).immediateRender=_isNotFalse(o.immediateRender),this.staggerTo(n,s,o,a,l,h,u)},t.staggerFromTo=function(n,s,o,a,l,h,u,g){return a.startAt=o,_inheritDefaults(a).immediateRender=_isNotFalse(a.immediateRender),this.staggerTo(n,s,a,l,h,u,g)},t.render=function(n,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,h=this._dur,u=n<=0?0:_roundPrecise(n),g=this._zTime<0!=n<0&&(this._initted||!h),m,_,b,d,c,f,v,y,D,E,p,x;if(this!==_globalTimeline&&u>l&&n>=0&&(u=l),u!==this._tTime||o||g){if(a!==this._time&&h&&(u+=this._time-a,n+=this._time-a),m=u,D=this._start,y=this._ts,f=!y,g&&(h||(a=this._zTime),(n||!s)&&(this._zTime=n)),this._repeat){if(p=this._yoyo,c=h+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(c*100+n,s,o);if(m=_roundPrecise(u%c),u===l?(d=this._repeat,m=h):(E=_roundPrecise(u/c),d=~~E,d&&d===E&&(m=h,d--),m>h&&(m=h)),E=_animationCycle(this._tTime,c),!a&&this._tTime&&E!==d&&this._tTime-E*c-this._dur<=0&&(E=d),p&&d&1&&(m=h-m,x=1),d!==E&&!this._lock){var w=p&&E&1,C=w===(p&&d&1);if(d<E&&(w=!w),a=w?0:u%h?h:u,this._lock=1,this.render(a||(x?0:_roundPrecise(d*c)),s,!h)._lock=0,this._tTime=u,!s&&this.parent&&_callback$1(this,"onRepeat"),this.vars.repeatRefresh&&!x&&(this.invalidate()._lock=1),a&&a!==this._time||f!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,l=this._tDur,C&&(this._lock=2,a=w?h:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!x&&this.invalidate()),this._lock=0,!this._ts&&!f)return this;_propagateYoyoEase(this,x)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=_findNextPauseTween(this,_roundPrecise(a),_roundPrecise(m)),v&&(u-=m-(m=v._start))),this._tTime=u,this._time=m,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,a=0),!a&&u&&!s&&!E&&(_callback$1(this,"onStart"),this._tTime!==u))return this;if(m>=a&&n>=0)for(_=this._first;_;){if(b=_._next,(_._act||m>=_._start)&&_._ts&&v!==_){if(_.parent!==this)return this.render(n,s,o);if(_.render(_._ts>0?(m-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(m-_._start)*_._ts,s,o),m!==this._time||!this._ts&&!f){v=0,b&&(u+=this._zTime=-_tinyNum);break}}_=b}else{_=this._last;for(var S=n<0?n:m;_;){if(b=_._prev,(_._act||S<=_._end)&&_._ts&&v!==_){if(_.parent!==this)return this.render(n,s,o);if(_.render(_._ts>0?(S-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(S-_._start)*_._ts,s,o||_reverting$1&&_isRevertWorthy(_)),m!==this._time||!this._ts&&!f){v=0,b&&(u+=this._zTime=S?-_tinyNum:_tinyNum);break}}_=b}}if(v&&!s&&(this.pause(),v.render(m>=a?0:-_tinyNum)._zTime=m>=a?1:-1,this._ts))return this._start=D,_setEnd(this),this.render(n,s,o);this._onUpdate&&!s&&_callback$1(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&a)&&(D===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((n||!h)&&(u===l&&this._ts>0||!u&&this._ts<0)&&_removeFromParent(this,1),!s&&!(n<0&&!a)&&(u||a||!l)&&(_callback$1(this,u===l&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,s){var o=this;if(_isNumber$1(s)||(s=_parsePosition$1(this,s,n)),!(n instanceof Animation$1)){if(_isArray(n))return n.forEach(function(a){return o.add(a,s)}),this;if(_isString$1(n))return this.addLabel(n,s);if(_isFunction$1(n))n=Tween.delayedCall(0,n);else return this}return this!==n?_addToTimeline(this,n,s):this},t.getChildren=function(n,s,o,a){n===void 0&&(n=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-_bigNum$1);for(var l=[],h=this._first;h;)h._start>=a&&(h instanceof Tween?s&&l.push(h):(o&&l.push(h),n&&l.push.apply(l,h.getChildren(!0,s,o)))),h=h._next;return l},t.getById=function(n){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===n)return s[o]},t.remove=function(n){return _isString$1(n)?this.removeLabel(n):_isFunction$1(n)?this.killTweensOf(n):(n.parent===this&&_removeLinkedListItem(this,n),n===this._recent&&(this._recent=this._last),_uncache(this))},t.totalTime=function(n,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),r.prototype.totalTime.call(this,n,s),this._forcing=0,this):this._tTime},t.addLabel=function(n,s){return this.labels[n]=_parsePosition$1(this,s),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,s,o){var a=Tween.delayedCall(0,s||_emptyFunc,o);return a.data="isPause",this._hasPause=1,_addToTimeline(this,a,_parsePosition$1(this,n))},t.removePause=function(n){var s=this._first;for(n=_parsePosition$1(this,n);s;)s._start===n&&s.data==="isPause"&&_removeFromParent(s),s=s._next},t.killTweensOf=function(n,s,o){for(var a=this.getTweensOf(n,o),l=a.length;l--;)_overwritingTween!==a[l]&&a[l].kill(n,s);return this},t.getTweensOf=function(n,s){for(var o=[],a=toArray(n),l=this._first,h=_isNumber$1(s),u;l;)l instanceof Tween?_arrayContainsAny(l._targets,a)&&(h?(!_overwritingTween||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},t.tweenTo=function(n,s){s=s||{};var o=this,a=_parsePosition$1(o,n),l=s,h=l.startAt,u=l.onStart,g=l.onStartParams,m=l.immediateRender,_,b=Tween.to(o,_setDefaults$1({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale())||_tinyNum,onStart:function(){if(o.pause(),!_){var c=s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale());b._dur!==c&&_setDuration(b,c,0,1).render(b._time,!0,!0),_=1}u&&u.apply(b,g||[])}},s));return m?b.render(0):b},t.tweenFromTo=function(n,s,o){return this.tweenTo(s,_setDefaults$1({startAt:{time:_parsePosition$1(this,n)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),_getLabelInDirection(this,_parsePosition$1(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),_getLabelInDirection(this,_parsePosition$1(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+_tinyNum)},t.shiftChildren=function(n,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,h;a;)a._start>=o&&(a._start+=n,a._end+=n),a=a._next;if(s)for(h in l)l[h]>=o&&(l[h]+=n);return _uncache(this)},t.invalidate=function(n){var s=this._first;for(this._lock=0;s;)s.invalidate(n),s=s._next;return r.prototype.invalidate.call(this,n)},t.clear=function(n){n===void 0&&(n=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),_uncache(this)},t.totalDuration=function(n){var s=0,o=this,a=o._last,l=_bigNum$1,h,u,g;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-n:n));if(o._dirty){for(g=o.parent;a;)h=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,_addToTimeline(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!g&&!o._dp||g&&g.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=h;_setDuration(o,o===_globalTimeline&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(n){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(n,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var s=_globalTimeline._first;if((!s||!s._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||_ticker.sleep()}}},e}(Animation$1);_setDefaults$1(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function(e,t,i,n,s,o,a){var l=new PropTween(this._pt,e,t,0,1,_renderComplexString,null,s),h=0,u=0,g,m,_,b,d,c,f,v;for(l.b=i,l.e=n,i+="",n+="",(f=~n.indexOf("random("))&&(n=_replaceRandom(n)),o&&(v=[i,n],o(v,e,t),i=v[0],n=v[1]),m=i.match(_complexStringNumExp)||[];g=_complexStringNumExp.exec(n);)b=g[0],d=n.substring(h,g.index),_?_=(_+1)%5:d.substr(-5)==="rgba("&&(_=1),b!==m[u++]&&(c=parseFloat(m[u-1])||0,l._pt={_next:l._pt,p:d||u===1?d:",",s:c,c:b.charAt(1)==="="?_parseRelative(c,b)-c:parseFloat(b)-c,m:_&&_<4?Math.round:0},h=_complexStringNumExp.lastIndex);return l.c=h<n.length?n.substring(h,n.length):"",l.fp=a,(_relExp.test(n)||f)&&(l.e=0),this._pt=l,l},_addPropTween=function(e,t,i,n,s,o,a,l,h,u){_isFunction$1(n)&&(n=n(s||0,e,o));var g=e[t],m=i!=="get"?i:_isFunction$1(g)?h?e[t.indexOf("set")||!_isFunction$1(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():g,_=_isFunction$1(g)?h?_setterFuncWithParam:_setterFunc:_setterPlain,b;if(_isString$1(n)&&(~n.indexOf("random(")&&(n=_replaceRandom(n)),n.charAt(1)==="="&&(b=_parseRelative(m,n)+(getUnit(m)||0),(b||b===0)&&(n=b))),!u||m!==n||_forceAllPropTweens)return!isNaN(m*n)&&n!==""?(b=new PropTween(this._pt,e,t,+m||0,n-(m||0),typeof g=="boolean"?_renderBoolean:_renderPlain,0,_),h&&(b.fp=h),a&&b.modifier(a,this,e),this._pt=b):(!g&&!(t in e)&&_missingPlugin(t,n),_addComplexStringPropTween.call(this,e,t,m,n,_,l||_config.stringFilter,h))},_processVars=function(e,t,i,n,s){if(_isFunction$1(e)&&(e=_parseFuncOrString(e,s,t,i,n)),!_isObject$1(e)||e.style&&e.nodeType||_isArray(e)||_isTypedArray(e))return _isString$1(e)?_parseFuncOrString(e,s,t,i,n):e;var o={},a;for(a in e)o[a]=_parseFuncOrString(e[a],s,t,i,n);return o},_checkPlugin=function(e,t,i,n,s,o){var a,l,h,u;if(_plugins[e]&&(a=new _plugins[e]).init(s,a.rawVars?t[e]:_processVars(t[e],n,s,o,i),i,n,o)!==!1&&(i._pt=l=new PropTween(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==_quickTween))for(h=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)h[a._props[u]]=l;return a},_overwritingTween,_forceAllPropTweens,_initTween=function r(e,t,i){var n=e.vars,s=n.ease,o=n.startAt,a=n.immediateRender,l=n.lazy,h=n.onUpdate,u=n.runBackwards,g=n.yoyoEase,m=n.keyframes,_=n.autoRevert,b=e._dur,d=e._startAt,c=e._targets,f=e.parent,v=f&&f.data==="nested"?f.vars.targets:c,y=e._overwrite==="auto"&&!_suppressOverwrites$1,D=e.timeline,E,p,x,w,C,S,A,P,O,F,I,B,k;if(D&&(!m||!s)&&(s="none"),e._ease=_parseEase(s,_defaults$1.ease),e._yEase=g?_invertEase(_parseEase(g===!0?s:g,_defaults$1.ease)):0,g&&e._yoyo&&!e._repeat&&(g=e._yEase,e._yEase=e._ease,e._ease=g),e._from=!D&&!!n.runBackwards,!D||m&&!n.stagger){if(P=c[0]?_getCache(c[0]).harness:0,B=P&&n[P.prop],E=_copyExcluding(n,_reservedProps),d&&(d._zTime<0&&d.progress(1),t<0&&u&&a&&!_?d.render(-1,!0):d.revert(u&&b?_revertConfigNoKill:_startAtRevertConfig),d._lazy=0),o){if(_removeFromParent(e._startAt=Tween.set(c,_setDefaults$1({data:"isStart",overwrite:!1,parent:f,immediateRender:!0,lazy:!d&&_isNotFalse(l),startAt:null,delay:0,onUpdate:h&&function(){return _callback$1(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1||!a&&!_)&&e._startAt.revert(_revertConfigNoKill),a&&b&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(u&&b&&!d){if(t&&(a=!1),x=_setDefaults$1({overwrite:!1,data:"isFromStart",lazy:a&&!d&&_isNotFalse(l),immediateRender:a,stagger:0,parent:f},E),B&&(x[P.prop]=B),_removeFromParent(e._startAt=Tween.set(c,x)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e._startAt.render(-1,!0)),e._zTime=t,!a)r(e._startAt,_tinyNum,_tinyNum);else if(!t)return}for(e._pt=e._ptCache=0,l=b&&_isNotFalse(l)||l&&!b,p=0;p<c.length;p++){if(C=c[p],A=C._gsap||_harness(c)[p]._gsap,e._ptLookup[p]=F={},_lazyLookup[A.id]&&_lazyTweens.length&&_lazyRender(),I=v===c?p:v.indexOf(C),P&&(O=new P).init(C,B||E,e,I,v)!==!1&&(e._pt=w=new PropTween(e._pt,C,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(U){F[U]=w}),O.priority&&(S=1)),!P||B)for(x in E)_plugins[x]&&(O=_checkPlugin(x,E,e,I,C,v))?O.priority&&(S=1):F[x]=w=_addPropTween.call(e,C,x,"get",E[x],I,v,0,n.stringFilter);e._op&&e._op[p]&&e.kill(C,e._op[p]),y&&e._pt&&(_overwritingTween=e,_globalTimeline.killTweensOf(C,F,e.globalTime(t)),k=!e.parent,_overwritingTween=0),e._pt&&l&&(_lazyLookup[A.id]=1)}S&&_sortPropTweensByPriority(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!k,m&&t<=0&&D.render(_bigNum$1,!0,!0)},_updatePropTweens=function(e,t,i,n,s,o,a,l){var h=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,g,m,_;if(!h)for(h=e._ptCache[t]=[],m=e._ptLookup,_=e._targets.length;_--;){if(u=m[_][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return _forceAllPropTweens=1,e.vars[t]="+=0",_initTween(e,a),_forceAllPropTweens=0,l?_warn(t+" not eligible for reset"):1;h.push(u)}for(_=h.length;_--;)g=h[_],u=g._pt||g,u.s=(n||n===0)&&!s?n:u.s+(n||0)+o*u.c,u.c=i-u.s,g.e&&(g.e=_round$1(i)+getUnit(g.e)),g.b&&(g.b=u.s+getUnit(g.b))},_addAliasesToVars=function(e,t){var i=e[0]?_getCache(e[0]).harness:0,n=i&&i.aliases,s,o,a,l;if(!n)return t;s=_merge({},t);for(o in n)if(o in s)for(l=n[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},_parseKeyframe=function(e,t,i,n){var s=t.ease||n||"power1.inOut",o,a;if(_isArray(t))a=i[e]||(i[e]=[]),t.forEach(function(l,h){return a.push({t:h/(t.length-1)*100,v:l,e:s})});else for(o in t)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},_parseFuncOrString=function(e,t,i,n,s){return _isFunction$1(e)?e.call(t,i,n,s):_isString$1(e)&&~e.indexOf("random(")?_replaceRandom(e):e},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return _staggerPropsToSkip[r]=1});var Tween=function(r){_inheritsLoose(e,r);function e(i,n,s,o){var a;typeof n=="number"&&(s.duration=n,n=s,s=null),a=r.call(this,o?n:_inheritDefaults(n))||this;var l=a.vars,h=l.duration,u=l.delay,g=l.immediateRender,m=l.stagger,_=l.overwrite,b=l.keyframes,d=l.defaults,c=l.scrollTrigger,f=l.yoyoEase,v=n.parent||_globalTimeline,y=(_isArray(i)||_isTypedArray(i)?_isNumber$1(i[0]):"length"in n)?[i]:toArray(i),D,E,p,x,w,C,S,A;if(a._targets=y.length?_harness(y):_warn("GSAP target "+i+" not found. https://gsap.com",!_config.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=_,b||m||_isFuncOrString(h)||_isFuncOrString(u)){if(n=a.vars,D=a.timeline=new Timeline({data:"nested",defaults:d||{},targets:v&&v.data==="nested"?v.vars.targets:y}),D.kill(),D.parent=D._dp=_assertThisInitialized(a),D._start=0,m||_isFuncOrString(h)||_isFuncOrString(u)){if(x=y.length,S=m&&distribute(m),_isObject$1(m))for(w in m)~_staggerTweenProps.indexOf(w)&&(A||(A={}),A[w]=m[w]);for(E=0;E<x;E++)p=_copyExcluding(n,_staggerPropsToSkip),p.stagger=0,f&&(p.yoyoEase=f),A&&_merge(p,A),C=y[E],p.duration=+_parseFuncOrString(h,_assertThisInitialized(a),E,C,y),p.delay=(+_parseFuncOrString(u,_assertThisInitialized(a),E,C,y)||0)-a._delay,!m&&x===1&&p.delay&&(a._delay=u=p.delay,a._start+=u,p.delay=0),D.to(C,p,S?S(E,C,y):0),D._ease=_easeMap.none;D.duration()?h=u=0:a.timeline=0}else if(b){_inheritDefaults(_setDefaults$1(D.vars.defaults,{ease:"none"})),D._ease=_parseEase(b.ease||n.ease||"none");var P=0,O,F,I;if(_isArray(b))b.forEach(function(B){return D.to(y,B,">")}),D.duration();else{p={};for(w in b)w==="ease"||w==="easeEach"||_parseKeyframe(w,b[w],p,b.easeEach);for(w in p)for(O=p[w].sort(function(B,k){return B.t-k.t}),P=0,E=0;E<O.length;E++)F=O[E],I={ease:F.e,duration:(F.t-(E?O[E-1].t:0))/100*h},I[w]=F.v,D.to(y,I,P),P+=I.duration;D.duration()<h&&D.to({},{duration:h-D.duration()})}}h||a.duration(h=D.duration())}else a.timeline=0;return _===!0&&!_suppressOverwrites$1&&(_overwritingTween=_assertThisInitialized(a),_globalTimeline.killTweensOf(y),_overwritingTween=0),_addToTimeline(v,_assertThisInitialized(a),s),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(g||!h&&!b&&a._start===_roundPrecise(v._time)&&_isNotFalse(g)&&_hasNoPausedAncestors(_assertThisInitialized(a))&&v.data!=="nested")&&(a._tTime=-_tinyNum,a.render(Math.max(0,-u)||0)),c&&_scrollTrigger(_assertThisInitialized(a),c),a}var t=e.prototype;return t.render=function(n,s,o){var a=this._time,l=this._tDur,h=this._dur,u=n<0,g=n>l-_tinyNum&&!u?l:n<_tinyNum?0:n,m,_,b,d,c,f,v,y,D;if(!h)_renderZeroDurationTween(this,n,s,o);else if(g!==this._tTime||!n||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u||this._lazy){if(m=g,y=this.timeline,this._repeat){if(d=h+this._rDelay,this._repeat<-1&&u)return this.totalTime(d*100+n,s,o);if(m=_roundPrecise(g%d),g===l?(b=this._repeat,m=h):(c=_roundPrecise(g/d),b=~~c,b&&b===c?(m=h,b--):m>h&&(m=h)),f=this._yoyo&&b&1,f&&(D=this._yEase,m=h-m),c=_animationCycle(this._tTime,d),m===a&&!o&&this._initted&&b===c)return this._tTime=g,this;b!==c&&(y&&this._yEase&&_propagateYoyoEase(y,f),this.vars.repeatRefresh&&!f&&!this._lock&&m!==d&&this._initted&&(this._lock=o=1,this.render(_roundPrecise(d*b),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,u?n:m,o,s,g))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&b!==c))return this;if(h!==this._dur)return this.render(n,s,o)}if(this._tTime=g,this._time=m,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(D||this._ease)(m/h),this._from&&(this.ratio=v=1-v),!a&&g&&!s&&!c&&(_callback$1(this,"onStart"),this._tTime!==g))return this;for(_=this._pt;_;)_.r(v,_.d),_=_._next;y&&y.render(n<0?n:y._dur*y._ease(m/this._dur),s,o)||this._startAt&&(this._zTime=n),this._onUpdate&&!s&&(u&&_rewindStartAt(this,n,s,o),_callback$1(this,"onUpdate")),this._repeat&&b!==c&&this.vars.onRepeat&&!s&&this.parent&&_callback$1(this,"onRepeat"),(g===this._tDur||!g)&&this._tTime===g&&(u&&!this._onUpdate&&_rewindStartAt(this,n,!0,!0),(n||!h)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&_removeFromParent(this,1),!s&&!(u&&!a)&&(g||a||f)&&(_callback$1(this,g===l?"onComplete":"onReverseComplete",!0),this._prom&&!(g<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),r.prototype.invalidate.call(this,n)},t.resetTo=function(n,s,o,a,l){_tickerActive||_ticker.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||_initTween(this,h),u=this._ease(h/this._dur),_updatePropTweens(this,n,s,o,a,u,h,l)?this.resetTo(n,s,o,a,1):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,s){if(s===void 0&&(s="all"),!n&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!_reverting$1),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(n,s,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&o!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=n?toArray(n):a,h=this._ptLookup,u=this._pt,g,m,_,b,d,c,f;if((!s||s==="all")&&_arraysMatch(a,l))return s==="all"&&(this._pt=0),_interrupt(this);for(g=this._op=this._op||[],s!=="all"&&(_isString$1(s)&&(d={},_forEachName(s,function(v){return d[v]=1}),s=d),s=_addAliasesToVars(a,s)),f=a.length;f--;)if(~l.indexOf(a[f])){m=h[f],s==="all"?(g[f]=s,b=m,_={}):(_=g[f]=g[f]||{},b=s);for(d in b)c=m&&m[d],c&&((!("kill"in c.d)||c.d.kill(d)===!0)&&_removeLinkedListItem(this,c,"_pt"),delete m[d]),_!=="all"&&(_[d]=1)}return this._initted&&!this._pt&&u&&_interrupt(this),this},e.to=function(n,s){return new e(n,s,arguments[2])},e.from=function(n,s){return _createTweenType(1,arguments)},e.delayedCall=function(n,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(n,s,o){return _createTweenType(2,arguments)},e.set=function(n,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(n,s)},e.killTweensOf=function(n,s,o){return _globalTimeline.killTweensOf(n,s,o)},e}(Animation$1);_setDefaults$1(Tween.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(r){Tween[r]=function(){var e=new Timeline,t=_slice.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var _setterPlain=function(e,t,i){return e[t]=i},_setterFunc=function(e,t,i){return e[t](i)},_setterFuncWithParam=function(e,t,i,n){return e[t](n.fp,i)},_setterAttribute=function(e,t,i){return e.setAttribute(t,i)},_getSetter=function(e,t){return _isFunction$1(e[t])?_setterFunc:_isUndefined(e[t])&&e.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},_renderBoolean=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},_renderComplexString=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},_renderPropTweens=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},_addPluginModifier=function(e,t,i,n){for(var s=this._pt,o;s;)o=s._next,s.p===n&&s.modifier(e,t,i),s=o},_killPropTweensOf=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?_removeLinkedListItem(this,t,"_pt"):t.dep||(i=1),t=n;return!i},_setterWithModifier=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},_sortPropTweensByPriority=function(e){for(var t=e._pt,i,n,s,o;t;){for(i=t._next,n=s;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:o)?t._prev._next=t:s=t,(t._next=n)?n._prev=t:o=t,t=i}e._pt=s},PropTween=function(){function r(t,i,n,s,o,a,l,h,u){this.t=i,this.s=s,this.c=o,this.p=n,this.r=a||_renderPlain,this.d=l||this,this.set=h||_setterPlain,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(i,n,s){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=i,this.mt=s,this.tween=n},r}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return _reservedProps[r]=1});_globals.TweenMax=_globals.TweenLite=Tween;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults$1,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners$1={},_emptyArray$1=[],_lastMediaTime=0,_contextID=0,_dispatch$1=function(e){return(_listeners$1[e]||_emptyArray$1).map(function(t){return t()})},_onMediaChange=function(){var e=Date.now(),t=[];e-_lastMediaTime>2&&(_dispatch$1("matchMediaInit"),_media.forEach(function(i){var n=i.queries,s=i.conditions,o,a,l,h;for(a in n)o=_win$3.matchMedia(n[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,h=1);h&&(i.revert(),l&&t.push(i))}),_dispatch$1("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(n){return i.add(null,n)})}),_lastMediaTime=e,_dispatch$1("matchMedia"))},Context=function(){function r(t,i){this.selector=i&&selector(i),this.data=[],this._r=[],this.isReverted=!1,this.id=_contextID++,t&&this.add(t)}var e=r.prototype;return e.add=function(i,n,s){_isFunction$1(i)&&(s=n,n=i,i=_isFunction$1);var o=this,a=function(){var h=_context$2,u=o.selector,g;return h&&h!==o&&h.data.push(o),s&&(o.selector=selector(s)),_context$2=o,g=n.apply(o,arguments),_isFunction$1(g)&&o._r.push(g),_context$2=h,o.selector=u,o.isReverted=!1,g};return o.last=a,i===_isFunction$1?a(o,function(l){return o.add(null,l)}):i?o[i]=a:a},e.ignore=function(i){var n=_context$2;_context$2=null,i(this),_context$2=n},e.getTweens=function(){var i=[];return this.data.forEach(function(n){return n instanceof r?i.push.apply(i,n.getTweens()):n instanceof Tween&&!(n.parent&&n.parent.data==="nested")&&i.push(n)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,n){var s=this;if(i?function(){for(var a=s.getTweens(),l=s.data.length,h;l--;)h=s.data[l],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,g){return g.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),l=s.data.length;l--;)h=s.data[l],h instanceof Timeline?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof Tween)&&h.revert&&h.revert(i);s._r.forEach(function(u){return u(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),n)for(var o=_media.length;o--;)_media[o].id===this.id&&_media.splice(o,1)},e.revert=function(i){this.kill(i||{})},r}(),MatchMedia=function(){function r(t){this.contexts=[],this.scope=t,_context$2&&_context$2.data.push(this)}var e=r.prototype;return e.add=function(i,n,s){_isObject$1(i)||(i={matches:i});var o=new Context(0,s||this.scope),a=o.conditions={},l,h,u;_context$2&&!o.selector&&(o.selector=_context$2.selector),this.contexts.push(o),n=o.add("onMatch",n),o.queries=i;for(h in i)h==="all"?u=1:(l=_win$3.matchMedia(i[h]),l&&(_media.indexOf(o)<0&&_media.push(o),(a[h]=l.matches)&&(u=1),l.addListener?l.addListener(_onMediaChange):l.addEventListener("change",_onMediaChange)));return u&&n(o,function(g){return o.add(null,g)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(n){return n.kill(i,!0)})},r}(),_gsap={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return _createPlugin(n)})},timeline:function(e){return new Timeline(e)},getTweensOf:function(e,t){return _globalTimeline.getTweensOf(e,t)},getProperty:function(e,t,i,n){_isString$1(e)&&(e=toArray(e)[0]);var s=_getCache(e||{}).get,o=i?_passThrough$1:_numericIfPossible;return i==="native"&&(i=""),e&&(t?o((_plugins[t]&&_plugins[t].get||s)(e,t,i,n)):function(a,l,h){return o((_plugins[a]&&_plugins[a].get||s)(e,a,l,h))})},quickSetter:function(e,t,i){if(e=toArray(e),e.length>1){var n=e.map(function(u){return gsap$3.quickSetter(u,t,i)}),s=n.length;return function(u){for(var g=s;g--;)n[g](u)}}e=e[0]||{};var o=_plugins[t],a=_getCache(e),l=a.harness&&(a.harness.aliases||{})[t]||t,h=o?function(u){var g=new o;_quickTween._pt=0,g.init(e,i?u+i:u,_quickTween,0,[e]),g.render(1,g),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:a.set(e,l);return o?h:function(u){return h(e,l,i?u+i:u,a,1)}},quickTo:function(e,t,i){var n,s=gsap$3.to(e,_setDefaults$1((n={},n[t]="+=0.1",n.paused=!0,n.stagger=0,n),i||{})),o=function(l,h,u){return s.resetTo(t,l,h,u)};return o.tween=s,o},isTweening:function(e){return _globalTimeline.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=_parseEase(e.ease,_defaults$1.ease)),_mergeDeep(_defaults$1,e||{})},config:function(e){return _mergeDeep(_config,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,o=e.extendTimeline;(n||"").split(",").forEach(function(a){return a&&!_plugins[a]&&!_globals[a]&&_warn(t+" effect requires "+a+" plugin.")}),_effects[t]=function(a,l,h){return i(toArray(a),_setDefaults$1(l||{},s),h)},o&&(Timeline.prototype[t]=function(a,l,h){return this.add(_effects[t](a,_isObject$1(l)?l:(h=l)&&{},this),h)})},registerEase:function(e,t){_easeMap[e]=_parseEase(t)},parseEase:function(e,t){return arguments.length?_parseEase(e,t):_easeMap},getById:function(e){return _globalTimeline.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Timeline(e),n,s;for(i.smoothChildTiming=_isNotFalse(e.smoothChildTiming),_globalTimeline.remove(i),i._dp=0,i._time=i._tTime=_globalTimeline._time,n=_globalTimeline._first;n;)s=n._next,(t||!(!n._dur&&n instanceof Tween&&n.vars.onComplete===n._targets[0]))&&_addToTimeline(i,n,n._start-n._delay),n=s;return _addToTimeline(_globalTimeline,i,0),i},context:function(e,t){return e?new Context(e,t):_context$2},matchMedia:function(e){return new MatchMedia(e)},matchMediaRefresh:function(){return _media.forEach(function(e){var t=e.conditions,i,n;for(n in t)t[n]&&(t[n]=!1,i=1);i&&e.revert()})||_onMediaChange()},addEventListener:function(e,t){var i=_listeners$1[e]||(_listeners$1[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=_listeners$1[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate:interpolate$2,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween,Timeline,Animation:Animation$1,getCache:_getCache,_removeLinkedListItem,reverting:function(){return _reverting$1},context:function(e){return e&&_context$2&&(_context$2.data.push(e),e._ctx=_context$2),_context$2},suppressOverwrites:function(e){return _suppressOverwrites$1=e}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return _gsap[r]=Tween[r]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},_addModifiers=function(e,t){var i=e._targets,n,s,o;for(n in t)for(s=i.length;s--;)o=e._ptLookup[s][n],o&&(o=o.d)&&(o._pt&&(o=_getPluginPropTween(o,n)),o&&o.modifier&&o.modifier(t[n],e,i[s],n))},_buildModifierPlugin=function(e,t){return{name:e,headless:1,rawVars:1,init:function(n,s,o){o._onInit=function(a){var l,h;if(_isString$1(s)&&(l={},_forEachName(s,function(u){return l[u]=1}),s=l),t){l={};for(h in s)l[h]=t(s[h]);s=l}_addModifiers(a,s)}}}},gsap$3=_gsap.registerPlugin({name:"attr",init:function(e,t,i,n,s){var o,a,l;this.tween=i;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],n,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)_reverting$1?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween.version=Timeline.version=gsap$3.version="3.13.0";_coreReady=1;_windowExists$2()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _win$2,_doc$2,_docElement,_pluginInitted,_tempDiv$1,_recentSetterPlugin,_reverting,_windowExists$1=function(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp$1=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderPropWithEnd=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderCSSPropWithBeginning=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},_renderRoundedCSSProp=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},_renderNonTweeningValue=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},_renderNonTweeningValueOnlyAtEnd=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},_setterCSSStyle=function(e,t,i){return e.style[t]=i},_setterCSSProp=function(e,t,i){return e.style.setProperty(t,i)},_setterTransform=function(e,t,i){return e._gsap[t]=i},_setterScale=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},_setterScaleWithRender=function(e,t,i,n,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},_setterTransformWithRender=function(e,t,i,n,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},_transformProp$1="transform",_transformOriginProp=_transformProp$1+"Origin",_saveStyle=function r(e,t){var i=this,n=this.target,s=n.style,o=n._gsap;if(e in _transformProps&&s){if(this.tfm=this.tfm||{},e!=="transform")e=_propertyAliases[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=_get(n,a)}):this.tfm[e]=o.x?o[e]:_get(n,e),e===_transformOriginProp&&(this.tfm.zOrigin=o.zOrigin);else return _propertyAliases.transform.split(",").forEach(function(a){return r.call(i,a,t)});if(this.props.indexOf(_transformProp$1)>=0)return;o.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,t,"")),e=_transformProp$1}(s||t)&&this.props.push(e,t,s[e])},_removeIndependentTransforms=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},_revertStyle=function(){var e=this.props,t=this.target,i=t.style,n=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(_capsExp$1,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)n[o]=this.tfm[o];n.svg&&(n.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=_reverting(),(!s||!s.isStart)&&!i[_transformProp$1]&&(_removeIndependentTransforms(i),n.zOrigin&&i[_transformOriginProp]&&(i[_transformOriginProp]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},_getStyleSaver=function(e,t){var i={target:e,props:[],revert:_revertStyle,save:_saveStyle};return e._gsap||gsap$3.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(n){return i.save(n)}),i},_supports3D,_createElement=function(e,t){var i=_doc$2.createElementNS?_doc$2.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):_doc$2.createElement(e);return i&&i.style?i:_doc$2.createElement(e)},_getComputedProperty=function r(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(_capsExp$1,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&r(e,_checkPropPrefix(t)||t,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function(e,t,i){var n=t||_tempDiv$1,s=n.style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(_prefixes[o]+e in s););return o<0?null:(o===3?"ms":o>=0?_prefixes[o]:"")+e},_initCore$1=function(){_windowExists$1()&&window.document&&(_win$2=window,_doc$2=_win$2.document,_docElement=_doc$2.documentElement,_tempDiv$1=_createElement("div")||{style:{}},_createElement("div"),_transformProp$1=_checkPropPrefix(_transformProp$1),_transformOriginProp=_transformProp$1+"Origin",_tempDiv$1.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap$3.core.reverting,_pluginInitted=1)},_getReparentedCloneBBox=function(e){var t=e.ownerSVGElement,i=_createElement("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=e.cloneNode(!0),s;n.style.display="block",i.appendChild(n),_docElement.appendChild(i);try{s=n.getBBox()}catch{}return i.removeChild(n),_docElement.removeChild(i),s},_getAttributeFallbacks=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},_getBBox=function(e){var t,i;try{t=e.getBBox()}catch{t=_getReparentedCloneBBox(e),i=1}return t&&(t.width||t.height)||i||(t=_getReparentedCloneBBox(e)),t&&!t.width&&!t.x&&!t.y?{x:+_getAttributeFallbacks(e,["x","cx","x1"])||0,y:+_getAttributeFallbacks(e,["y","cy","y1"])||0,width:0,height:0}:t},_isSVG=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&_getBBox(e))},_removeProperty=function(e,t){if(t){var i=e.style,n;t in _transformProps&&t!==_transformOriginProp&&(t=_transformProp$1),i.removeProperty?(n=t.substr(0,2),(n==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(n==="--"?t:t.replace(_capsExp$1,"-$1").toLowerCase())):i.removeAttribute(t)}},_addNonTweeningPT=function(e,t,i,n,s,o){var a=new PropTween(e._pt,t,i,0,1,o?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return e._pt=a,a.b=n,a.e=s,e._props.push(i),a},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function r(e,t,i,n){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=_tempDiv$1.style,l=_horizontalExp.test(t),h=e.tagName.toLowerCase()==="svg",u=(h?"client":"offset")+(l?"Width":"Height"),g=100,m=n==="px",_=n==="%",b,d,c,f;if(n===o||!s||_nonConvertibleUnits[n]||_nonConvertibleUnits[o])return s;if(o!=="px"&&!m&&(s=r(e,t,i,"px")),f=e.getCTM&&_isSVG(e),(_||o==="%")&&(_transformProps[t]||~t.indexOf("adius")))return b=f?e.getBBox()[l?"width":"height"]:e[u],_round$1(_?s/b*g:s/100*b);if(a[l?"width":"height"]=g+(m?o:n),d=n!=="rem"&&~t.indexOf("adius")||n==="em"&&e.appendChild&&!h?e:e.parentNode,f&&(d=(e.ownerSVGElement||{}).parentNode),(!d||d===_doc$2||!d.appendChild)&&(d=_doc$2.body),c=d._gsap,c&&_&&c.width&&l&&c.time===_ticker.time&&!c.uncache)return _round$1(s/c.width*g);if(_&&(t==="height"||t==="width")){var v=e.style[t];e.style[t]=g+n,b=e[u],v?e.style[t]=v:_removeProperty(e,t)}else(_||o==="%")&&!_nonStandardLayouts[_getComputedProperty(d,"display")]&&(a.position=_getComputedProperty(e,"position")),d===e&&(a.position="static"),d.appendChild(_tempDiv$1),b=_tempDiv$1[u],d.removeChild(_tempDiv$1),a.position="absolute";return l&&_&&(c=_getCache(d),c.time=_ticker.time,c.width=d[u]),_round$1(m?b*s/g:b&&s?g/b*s:0)},_get=function(e,t,i,n){var s;return _pluginInitted||_initCore$1(),t in _propertyAliases&&t!=="transform"&&(t=_propertyAliases[t],~t.indexOf(",")&&(t=t.split(",")[0])),_transformProps[t]&&t!=="transform"?(s=_parseTransform(e,n),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:_firstTwoOnly(_getComputedProperty(e,_transformOriginProp))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||n||~(s+"").indexOf("calc("))&&(s=_specialProps[t]&&_specialProps[t](e,t,i)||_getComputedProperty(e,t)||_getProperty(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?_convertToUnit(e,t,s,i)+i:s},_tweenComplexCSSString=function(e,t,i,n){if(!i||i==="none"){var s=_checkPropPrefix(t,e,1),o=s&&_getComputedProperty(e,s,1);o&&o!==i?(t=s,i=o):t==="borderColor"&&(i=_getComputedProperty(e,"borderTopColor"))}var a=new PropTween(this._pt,e.style,t,0,1,_renderComplexString),l=0,h=0,u,g,m,_,b,d,c,f,v,y,D,E;if(a.b=i,a.e=n,i+="",n+="",n.substring(0,6)==="var(--"&&(n=_getComputedProperty(e,n.substring(4,n.indexOf(")")))),n==="auto"&&(d=e.style[t],e.style[t]=n,n=_getComputedProperty(e,t)||n,d?e.style[t]=d:_removeProperty(e,t)),u=[i,n],_colorStringFilter(u),i=u[0],n=u[1],m=i.match(_numWithUnitExp)||[],E=n.match(_numWithUnitExp)||[],E.length){for(;g=_numWithUnitExp.exec(n);)c=g[0],v=n.substring(l,g.index),b?b=(b+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(b=1),c!==(d=m[h++]||"")&&(_=parseFloat(d)||0,D=d.substr((_+"").length),c.charAt(1)==="="&&(c=_parseRelative(_,c)+D),f=parseFloat(c),y=c.substr((f+"").length),l=_numWithUnitExp.lastIndex-y.length,y||(y=y||_config.units[t]||D,l===n.length&&(n+=y,a.e+=y)),D!==y&&(_=_convertToUnit(e,t,d,y)||0),a._pt={_next:a._pt,p:v||h===1?v:",",s:_,c:f-_,m:b&&b<4||t==="zIndex"?Math.round:0});a.c=l<n.length?n.substring(l,n.length):""}else a.r=t==="display"&&n==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(n)&&(a.e=0),this._pt=a,a},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=_keywordToPercent[i]||i,t[1]=_keywordToPercent[n]||n,t.join(" ")},_renderClearProps=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,s=t.u,o=i._gsap,a,l,h;if(s==="all"||s===!0)n.cssText="",l=1;else for(s=s.split(","),h=s.length;--h>-1;)a=s[h],_transformProps[a]&&(l=1,a=a==="transformOrigin"?_transformOriginProp:_transformProp$1),_removeProperty(i,a);l&&(_removeProperty(i,_transformProp$1),o&&(o.svg&&i.removeAttribute("transform"),n.scale=n.rotate=n.translate="none",_parseTransform(i,1),o.uncache=1,_removeIndependentTransforms(n)))}},_specialProps={clearProps:function(e,t,i,n,s){if(s.data!=="isFromStart"){var o=e._pt=new PropTween(e._pt,t,i,0,0,_renderClearProps);return o.u=n,o.pr=-10,o.tween=s,e._props.push(i),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},_getComputedTransformMatrixAsArray=function(e){var t=_getComputedProperty(e,_transformProp$1);return _isNullTransform(t)?_identity2DMatrix:t.substr(7).match(_numExp).map(_round$1)},_getMatrix=function(e,t){var i=e._gsap||_getCache(e),n=e.style,s=_getComputedTransformMatrixAsArray(e),o,a,l,h;return i.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:s):(s===_identity2DMatrix&&!e.offsetParent&&e!==_docElement&&!i.svg&&(l=n.display,n.display="block",o=e.parentNode,(!o||!e.offsetParent&&!e.getBoundingClientRect().width)&&(h=1,a=e.nextElementSibling,_docElement.appendChild(e)),s=_getComputedTransformMatrixAsArray(e),l?n.display=l:_removeProperty(e,"display"),h&&(a?o.insertBefore(e,a):o?o.appendChild(e):_docElement.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},_applySVGOrigin=function(e,t,i,n,s,o){var a=e._gsap,l=s||_getMatrix(e,!0),h=a.xOrigin||0,u=a.yOrigin||0,g=a.xOffset||0,m=a.yOffset||0,_=l[0],b=l[1],d=l[2],c=l[3],f=l[4],v=l[5],y=t.split(" "),D=parseFloat(y[0])||0,E=parseFloat(y[1])||0,p,x,w,C;i?l!==_identity2DMatrix&&(x=_*c-b*d)&&(w=D*(c/x)+E*(-d/x)+(d*v-c*f)/x,C=D*(-b/x)+E*(_/x)-(_*v-b*f)/x,D=w,E=C):(p=_getBBox(e),D=p.x+(~y[0].indexOf("%")?D/100*p.width:D),E=p.y+(~(y[1]||y[0]).indexOf("%")?E/100*p.height:E)),n||n!==!1&&a.smooth?(f=D-h,v=E-u,a.xOffset=g+(f*_+v*d)-f,a.yOffset=m+(f*b+v*c)-v):a.xOffset=a.yOffset=0,a.xOrigin=D,a.yOrigin=E,a.smooth=!!n,a.origin=t,a.originIsAbsolute=!!i,e.style[_transformOriginProp]="0px 0px",o&&(_addNonTweeningPT(o,a,"xOrigin",h,D),_addNonTweeningPT(o,a,"yOrigin",u,E),_addNonTweeningPT(o,a,"xOffset",g,a.xOffset),_addNonTweeningPT(o,a,"yOffset",m,a.yOffset)),e.setAttribute("data-svg-origin",D+" "+E)},_parseTransform=function(e,t){var i=e._gsap||new GSCache(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,s=i.scaleX<0,o="px",a="deg",l=getComputedStyle(e),h=_getComputedProperty(e,_transformOriginProp)||"0",u,g,m,_,b,d,c,f,v,y,D,E,p,x,w,C,S,A,P,O,F,I,B,k,U,W,R,z,V,q,Q,re;return u=g=m=d=c=f=v=y=D=0,_=b=1,i.svg=!!(e.getCTM&&_isSVG(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(n[_transformProp$1]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[_transformProp$1]!=="none"?l[_transformProp$1]:"")),n.scale=n.rotate=n.translate="none"),x=_getMatrix(e,i.svg),i.svg&&(i.uncache?(U=e.getBBox(),h=i.xOrigin-U.x+"px "+(i.yOrigin-U.y)+"px",k=""):k=!t&&e.getAttribute("data-svg-origin"),_applySVGOrigin(e,k||h,!!k||i.originIsAbsolute,i.smooth!==!1,x)),E=i.xOrigin||0,p=i.yOrigin||0,x!==_identity2DMatrix&&(A=x[0],P=x[1],O=x[2],F=x[3],u=I=x[4],g=B=x[5],x.length===6?(_=Math.sqrt(A*A+P*P),b=Math.sqrt(F*F+O*O),d=A||P?_atan2(P,A)*_RAD2DEG:0,v=O||F?_atan2(O,F)*_RAD2DEG+d:0,v&&(b*=Math.abs(Math.cos(v*_DEG2RAD))),i.svg&&(u-=E-(E*A+p*O),g-=p-(E*P+p*F))):(re=x[6],q=x[7],R=x[8],z=x[9],V=x[10],Q=x[11],u=x[12],g=x[13],m=x[14],w=_atan2(re,V),c=w*_RAD2DEG,w&&(C=Math.cos(-w),S=Math.sin(-w),k=I*C+R*S,U=B*C+z*S,W=re*C+V*S,R=I*-S+R*C,z=B*-S+z*C,V=re*-S+V*C,Q=q*-S+Q*C,I=k,B=U,re=W),w=_atan2(-O,V),f=w*_RAD2DEG,w&&(C=Math.cos(-w),S=Math.sin(-w),k=A*C-R*S,U=P*C-z*S,W=O*C-V*S,Q=F*S+Q*C,A=k,P=U,O=W),w=_atan2(P,A),d=w*_RAD2DEG,w&&(C=Math.cos(w),S=Math.sin(w),k=A*C+P*S,U=I*C+B*S,P=P*C-A*S,B=B*C-I*S,A=k,I=U),c&&Math.abs(c)+Math.abs(d)>359.9&&(c=d=0,f=180-f),_=_round$1(Math.sqrt(A*A+P*P+O*O)),b=_round$1(Math.sqrt(B*B+re*re)),w=_atan2(I,B),v=Math.abs(w)>2e-4?w*_RAD2DEG:0,D=Q?1/(Q<0?-Q:Q):0),i.svg&&(k=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(e,_transformProp$1)),k&&e.setAttribute("transform",k))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(_*=-1,v+=d<=0?180:-180,d+=d<=0?180:-180):(b*=-1,v+=v<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=g-((i.yPercent=g&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-g)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=m+o,i.scaleX=_round$1(_),i.scaleY=_round$1(b),i.rotation=_round$1(d)+a,i.rotationX=_round$1(c)+a,i.rotationY=_round$1(f)+a,i.skewX=v+a,i.skewY=y+a,i.transformPerspective=D+o,(i.zOrigin=parseFloat(h.split(" ")[2])||!t&&i.zOrigin||0)&&(n[_transformOriginProp]=_firstTwoOnly(h)),i.xOffset=i.yOffset=0,i.force3D=_config.force3D,i.renderTransform=i.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,i.uncache=0,i},_firstTwoOnly=function(e){return(e=e.split(" "))[0]+" "+e[1]},_addPxTranslate=function(e,t,i){var n=getUnit(t);return _round$1(parseFloat(t)+parseFloat(_convertToUnit(e,"x",i+"px",n)))+n},_renderNon3DTransforms=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,_renderCSSTransforms(e,t)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.z,h=i.rotation,u=i.rotationY,g=i.rotationX,m=i.skewX,_=i.skewY,b=i.scaleX,d=i.scaleY,c=i.transformPerspective,f=i.force3D,v=i.target,y=i.zOrigin,D="",E=f==="auto"&&e&&e!==1||f===!0;if(y&&(g!==_zeroDeg||u!==_zeroDeg)){var p=parseFloat(u)*_DEG2RAD,x=Math.sin(p),w=Math.cos(p),C;p=parseFloat(g)*_DEG2RAD,C=Math.cos(p),o=_addPxTranslate(v,o,x*C*-y),a=_addPxTranslate(v,a,-Math.sin(p)*-y),l=_addPxTranslate(v,l,w*C*-y+y)}c!==_zeroPx&&(D+="perspective("+c+_endParenthesis),(n||s)&&(D+="translate("+n+"%, "+s+"%) "),(E||o!==_zeroPx||a!==_zeroPx||l!==_zeroPx)&&(D+=l!==_zeroPx||E?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+_endParenthesis),h!==_zeroDeg&&(D+="rotate("+h+_endParenthesis),u!==_zeroDeg&&(D+="rotateY("+u+_endParenthesis),g!==_zeroDeg&&(D+="rotateX("+g+_endParenthesis),(m!==_zeroDeg||_!==_zeroDeg)&&(D+="skew("+m+", "+_+_endParenthesis),(b!==1||d!==1)&&(D+="scale("+b+", "+d+_endParenthesis),v.style[_transformProp$1]=D||"translate(0, 0)"},_renderSVGTransforms=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.rotation,h=i.skewX,u=i.skewY,g=i.scaleX,m=i.scaleY,_=i.target,b=i.xOrigin,d=i.yOrigin,c=i.xOffset,f=i.yOffset,v=i.forceCSS,y=parseFloat(o),D=parseFloat(a),E,p,x,w,C;l=parseFloat(l),h=parseFloat(h),u=parseFloat(u),u&&(u=parseFloat(u),h+=u,l+=u),l||h?(l*=_DEG2RAD,h*=_DEG2RAD,E=Math.cos(l)*g,p=Math.sin(l)*g,x=Math.sin(l-h)*-m,w=Math.cos(l-h)*m,h&&(u*=_DEG2RAD,C=Math.tan(h-u),C=Math.sqrt(1+C*C),x*=C,w*=C,u&&(C=Math.tan(u),C=Math.sqrt(1+C*C),E*=C,p*=C)),E=_round$1(E),p=_round$1(p),x=_round$1(x),w=_round$1(w)):(E=g,w=m,p=x=0),(y&&!~(o+"").indexOf("px")||D&&!~(a+"").indexOf("px"))&&(y=_convertToUnit(_,"x",o,"px"),D=_convertToUnit(_,"y",a,"px")),(b||d||c||f)&&(y=_round$1(y+b-(b*E+d*x)+c),D=_round$1(D+d-(b*p+d*w)+f)),(n||s)&&(C=_.getBBox(),y=_round$1(y+n/100*C.width),D=_round$1(D+s/100*C.height)),C="matrix("+E+","+p+","+x+","+w+","+y+","+D+")",_.setAttribute("transform",C),v&&(_.style[_transformProp$1]=C)},_addRotationalPropTween=function(e,t,i,n,s){var o=360,a=_isString$1(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?_RAD2DEG:1),h=l-n,u=n+h+"deg",g,m;return a&&(g=s.split("_")[1],g==="short"&&(h%=o,h!==h%(o/2)&&(h+=h<0?o:-o)),g==="cw"&&h<0?h=(h+o*_bigNum)%o-~~(h/o)*o:g==="ccw"&&h>0&&(h=(h-o*_bigNum)%o-~~(h/o)*o)),e._pt=m=new PropTween(e._pt,t,i,n,h,_renderPropWithEnd),m.e=u,m.u="deg",e._props.push(i),m},_assign=function(e,t){for(var i in t)e[i]=t[i];return e},_addRawTransformPTs=function(e,t,i){var n=_assign({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,l,h,u,g,m,_,b;n.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),o[_transformProp$1]=t,a=_parseTransform(i,1),_removeProperty(i,_transformProp$1),i.setAttribute("transform",h)):(h=getComputedStyle(i)[_transformProp$1],o[_transformProp$1]=t,a=_parseTransform(i,1),o[_transformProp$1]=h);for(l in _transformProps)h=n[l],u=a[l],h!==u&&s.indexOf(l)<0&&(_=getUnit(h),b=getUnit(u),g=_!==b?_convertToUnit(i,l,h,b):parseFloat(h),m=parseFloat(u),e._pt=new PropTween(e._pt,a,l,g,m-g,_renderCSSProp),e._pt.u=b||0,e._props.push(l));_assign(a,n)};_forEachName("padding,margin,Width,Radius",function(r,e){var t="Top",i="Right",n="Bottom",s="Left",o=(e<3?[t,i,n,s]:[t+s,t+i,n+i,n+s]).map(function(a){return e<2?r+a:"border"+a+r});_specialProps[e>1?"border"+r:r]=function(a,l,h,u,g){var m,_;if(arguments.length<4)return m=o.map(function(b){return _get(a,b,h)}),_=m.join(" "),_.split(m[0]).length===5?m[0]:_;m=(u+"").split(" "),_={},o.forEach(function(b,d){return _[b]=m[d]=m[d]||m[(d-1)/2|0]}),a.init(l,_,g)}});var CSSPlugin={name:"css",register:_initCore$1,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var o=this._props,a=e.style,l=i.vars.startAt,h,u,g,m,_,b,d,c,f,v,y,D,E,p,x,w;_pluginInitted||_initCore$1(),this.styles=this.styles||_getStyleSaver(e),w=this.styles.props,this.tween=i;for(d in t)if(d!=="autoRound"&&(u=t[d],!(_plugins[d]&&_checkPlugin(d,t,i,n,e,s)))){if(_=typeof u,b=_specialProps[d],_==="function"&&(u=u.call(i,n,e,s),_=typeof u),_==="string"&&~u.indexOf("random(")&&(u=_replaceRandom(u)),b)b(this,e,d,u,i)&&(x=1);else if(d.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(d)+"").trim(),u+="",_colorExp.lastIndex=0,_colorExp.test(h)||(c=getUnit(h),f=getUnit(u)),f?c!==f&&(h=_convertToUnit(e,d,h,f)+f):c&&(u+=c),this.add(a,"setProperty",h,u,n,s,0,0,d),o.push(d),w.push(d,0,a[d]);else if(_!=="undefined"){if(l&&d in l?(h=typeof l[d]=="function"?l[d].call(i,n,e,s):l[d],_isString$1(h)&&~h.indexOf("random(")&&(h=_replaceRandom(h)),getUnit(h+"")||h==="auto"||(h+=_config.units[d]||getUnit(_get(e,d))||""),(h+"").charAt(1)==="="&&(h=_get(e,d))):h=_get(e,d),m=parseFloat(h),v=_==="string"&&u.charAt(1)==="="&&u.substr(0,2),v&&(u=u.substr(2)),g=parseFloat(u),d in _propertyAliases&&(d==="autoAlpha"&&(m===1&&_get(e,"visibility")==="hidden"&&g&&(m=0),w.push("visibility",0,a.visibility),_addNonTweeningPT(this,a,"visibility",m?"inherit":"hidden",g?"inherit":"hidden",!g)),d!=="scale"&&d!=="transform"&&(d=_propertyAliases[d],~d.indexOf(",")&&(d=d.split(",")[0]))),y=d in _transformProps,y){if(this.styles.save(d),_==="string"&&u.substring(0,6)==="var(--"&&(u=_getComputedProperty(e,u.substring(4,u.indexOf(")"))),g=parseFloat(u)),D||(E=e._gsap,E.renderTransform&&!t.parseTransform||_parseTransform(e,t.parseTransform),p=t.smoothOrigin!==!1&&E.smooth,D=this._pt=new PropTween(this._pt,a,_transformProp$1,0,1,E.renderTransform,E,0,-1),D.dep=1),d==="scale")this._pt=new PropTween(this._pt,E,"scaleY",E.scaleY,(v?_parseRelative(E.scaleY,v+g):g)-E.scaleY||0,_renderCSSProp),this._pt.u=0,o.push("scaleY",d),d+="X";else if(d==="transformOrigin"){w.push(_transformOriginProp,0,a[_transformOriginProp]),u=_convertKeywordsToPercentages(u),E.svg?_applySVGOrigin(e,u,0,p,0,this):(f=parseFloat(u.split(" ")[2])||0,f!==E.zOrigin&&_addNonTweeningPT(this,E,"zOrigin",E.zOrigin,f),_addNonTweeningPT(this,a,d,_firstTwoOnly(h),_firstTwoOnly(u)));continue}else if(d==="svgOrigin"){_applySVGOrigin(e,u,1,p,0,this);continue}else if(d in _rotationalProperties){_addRotationalPropTween(this,E,d,m,v?_parseRelative(m,v+u):u);continue}else if(d==="smoothOrigin"){_addNonTweeningPT(this,E,"smooth",E.smooth,u);continue}else if(d==="force3D"){E[d]=u;continue}else if(d==="transform"){_addRawTransformPTs(this,u,e);continue}}else d in a||(d=_checkPropPrefix(d)||d);if(y||(g||g===0)&&(m||m===0)&&!_complexExp.test(u)&&d in a)c=(h+"").substr((m+"").length),g||(g=0),f=getUnit(u)||(d in _config.units?_config.units[d]:c),c!==f&&(m=_convertToUnit(e,d,h,f)),this._pt=new PropTween(this._pt,y?E:a,d,m,(v?_parseRelative(m,v+g):g)-m,!y&&(f==="px"||d==="zIndex")&&t.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=f||0,c!==f&&f!=="%"&&(this._pt.b=h,this._pt.r=_renderCSSPropWithBeginning);else if(d in a)_tweenComplexCSSString.call(this,e,d,h,v?v+u:u);else if(d in e)this.add(e,d,h||e[d],v?v+u:u,n,s);else if(d!=="parseTransform"){_missingPlugin(d,u);continue}y||(d in a?w.push(d,0,a[d]):typeof e[d]=="function"?w.push(d,2,e[d]()):w.push(d,1,h||e[d])),o.push(d)}}x&&_sortPropTweensByPriority(this)},render:function(e,t){if(t.tween._time||!_reverting())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function(e,t,i){var n=_propertyAliases[t];return n&&n.indexOf(",")<0&&(t=n),t in _transformProps&&t!==_transformOriginProp&&(e._gsap.x||_get(e,"x"))?i&&_recentSetterPlugin===i?t==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=i||{})&&(t==="scale"?_setterScaleWithRender:_setterTransformWithRender):e.style&&!_isUndefined(e.style[t])?_setterCSSStyle:~t.indexOf("-")?_setterCSSProp:_getSetter(e,t)},core:{_removeProperty,_getMatrix}};gsap$3.utils.checkPrefix=_checkPropPrefix;gsap$3.core.getStyleSaver=_getStyleSaver;(function(r,e,t,i){var n=_forEachName(r+","+e+","+t,function(s){_transformProps[s]=1});_forEachName(e,function(s){_config.units[s]="deg",_rotationalProperties[s]=1}),_propertyAliases[n[13]]=r+","+e,_forEachName(i,function(s){var o=s.split(":");_propertyAliases[o[1]]=n[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){_config.units[r]="px"});gsap$3.registerPlugin(CSSPlugin);var gsapWithCSS=gsap$3.registerPlugin(CSSPlugin)||gsap$3;gsapWithCSS.core.Tween;function _defineProperties(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),r}/*!
 * Observer 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$2,_coreInitted$1,_win$1,_doc$1,_docEl$1,_body$1,_isTouch,_pointerType,ScrollTrigger$1,_root$1,_normalizer$1,_eventTypes,_context$1,_getGSAP$2=function(){return gsap$2||typeof window<"u"&&(gsap$2=window.gsap)&&gsap$2.registerPlugin&&gsap$2},_startup$1=1,_observers=[],_scrollers=[],_proxies=[],_getTime$1=Date.now,_bridge=function(e,t){return t},_integrate=function(){var e=ScrollTrigger$1.core,t=e.bridge||{},i=e._scrollers,n=e._proxies;i.push.apply(i,_scrollers),n.push.apply(n,_proxies),_scrollers=i,_proxies=n,_bridge=function(o,a){return t[o](a)}},_getProxyProp=function(e,t){return~_proxies.indexOf(e)&&_proxies[_proxies.indexOf(e)+1][t]},_isViewport$1=function(e){return!!~_root$1.indexOf(e)},_addListener$1=function(e,t,i,n,s){return e.addEventListener(t,i,{passive:n!==!1,capture:!!s})},_removeListener$1=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},_scrollLeft="scrollLeft",_scrollTop="scrollTop",_onScroll$1=function(){return _normalizer$1&&_normalizer$1.isPressed||_scrollers.cache++},_scrollCacheFunc=function(e,t){var i=function n(s){if(s||s===0){_startup$1&&(_win$1.history.scrollRestoration="manual");var o=_normalizer$1&&_normalizer$1.isPressed;s=n.v=Math.round(s)||(_normalizer$1&&_normalizer$1.iOS?1:0),e(s),n.cacheID=_scrollers.cache,o&&_bridge("ss",s)}else(t||_scrollers.cache!==n.cacheID||_bridge("ref"))&&(n.cacheID=_scrollers.cache,n.v=e());return n.v+n.offset};return i.offset=0,e&&i},_horizontal={s:_scrollLeft,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:_scrollCacheFunc(function(r){return arguments.length?_win$1.scrollTo(r,_vertical.sc()):_win$1.pageXOffset||_doc$1[_scrollLeft]||_docEl$1[_scrollLeft]||_body$1[_scrollLeft]||0})},_vertical={s:_scrollTop,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:_horizontal,sc:_scrollCacheFunc(function(r){return arguments.length?_win$1.scrollTo(_horizontal.sc(),r):_win$1.pageYOffset||_doc$1[_scrollTop]||_docEl$1[_scrollTop]||_body$1[_scrollTop]||0})},_getTarget$1=function(e,t){return(t&&t._ctx&&t._ctx.selector||gsap$2.utils.toArray)(e)[0]||(typeof e=="string"&&gsap$2.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},_isWithin=function(e,t){for(var i=t.length;i--;)if(t[i]===e||t[i].contains(e))return!0;return!1},_getScrollFunc=function(e,t){var i=t.s,n=t.sc;_isViewport$1(e)&&(e=_doc$1.scrollingElement||_docEl$1);var s=_scrollers.indexOf(e),o=n===_vertical.sc?1:2;!~s&&(s=_scrollers.push(e)-1),_scrollers[s+o]||_addListener$1(e,"scroll",_onScroll$1);var a=_scrollers[s+o],l=a||(_scrollers[s+o]=_scrollCacheFunc(_getProxyProp(e,i),!0)||(_isViewport$1(e)?n:_scrollCacheFunc(function(h){return arguments.length?e[i]=h:e[i]})));return l.target=e,a||(l.smooth=gsap$2.getProperty(e,"scrollBehavior")==="smooth"),l},_getVelocityProp=function(e,t,i){var n=e,s=e,o=_getTime$1(),a=o,l=t||50,h=Math.max(500,l*3),u=function(b,d){var c=_getTime$1();d||c-o>l?(s=n,n=b,a=o,o=c):i?n+=b:n=s+(b-s)/(c-a)*(o-a)},g=function(){s=n=i?0:n,a=o=0},m=function(b){var d=a,c=s,f=_getTime$1();return(b||b===0)&&b!==n&&u(b),o===a||f-a>h?0:(n+(i?c:-c))/((i?f:o)-d)*1e3};return{update:u,reset:g,getVelocity:m}},_getEvent=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},_getAbsoluteMax=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},_setScrollTrigger=function(){ScrollTrigger$1=gsap$2.core.globals().ScrollTrigger,ScrollTrigger$1&&ScrollTrigger$1.core&&_integrate()},_initCore=function(e){return gsap$2=e||_getGSAP$2(),!_coreInitted$1&&gsap$2&&typeof document<"u"&&document.body&&(_win$1=window,_doc$1=document,_docEl$1=_doc$1.documentElement,_body$1=_doc$1.body,_root$1=[_win$1,_doc$1,_docEl$1,_body$1],gsap$2.utils.clamp,_context$1=gsap$2.core.context||function(){},_pointerType="onpointerenter"in _body$1?"pointer":"mouse",_isTouch=Observer.isTouch=_win$1.matchMedia&&_win$1.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in _win$1||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,_eventTypes=Observer.eventTypes=("ontouchstart"in _docEl$1?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in _docEl$1?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return _startup$1=0},500),_setScrollTrigger(),_coreInitted$1=1),_coreInitted$1};_horizontal.op=_vertical;_scrollers.cache=0;var Observer=function(){function r(t){this.init(t)}var e=r.prototype;return e.init=function(i){_coreInitted$1||_initCore(gsap$2)||console.warn("Please gsap.registerPlugin(Observer)"),ScrollTrigger$1||_setScrollTrigger();var n=i.tolerance,s=i.dragMinimum,o=i.type,a=i.target,l=i.lineHeight,h=i.debounce,u=i.preventDefault,g=i.onStop,m=i.onStopDelay,_=i.ignore,b=i.wheelSpeed,d=i.event,c=i.onDragStart,f=i.onDragEnd,v=i.onDrag,y=i.onPress,D=i.onRelease,E=i.onRight,p=i.onLeft,x=i.onUp,w=i.onDown,C=i.onChangeX,S=i.onChangeY,A=i.onChange,P=i.onToggleX,O=i.onToggleY,F=i.onHover,I=i.onHoverEnd,B=i.onMove,k=i.ignoreCheck,U=i.isNormalizer,W=i.onGestureStart,R=i.onGestureEnd,z=i.onWheel,V=i.onEnable,q=i.onDisable,Q=i.onClick,re=i.scrollSpeed,te=i.capture,ae=i.allowClicks,ne=i.lockAxis,le=i.onLockAxis;this.target=a=_getTarget$1(a)||_docEl$1,this.vars=i,_&&(_=gsap$2.utils.toArray(_)),n=n||1e-9,s=s||0,b=b||1,re=re||1,o=o||"wheel,touch,pointer",h=h!==!1,l||(l=parseFloat(_win$1.getComputedStyle(_body$1).lineHeight)||22);var Ee,De,Pe,pe,Z,be,Ce,ie=this,Ne=0,Ve=0,Ue=i.passive||!u&&i.passive!==!1,Fe=_getScrollFunc(a,_horizontal),ze=_getScrollFunc(a,_vertical),Re=Fe(),Le=ze(),We=~o.indexOf("touch")&&!~o.indexOf("pointer")&&_eventTypes[0]==="pointerdown",He=_isViewport$1(a),H=a.ownerDocument||_doc$1,K=[0,0,0],X=[0,0,0],_e=0,ue=function(){return _e=_getTime$1()},ye=function(Ie,Be){return(ie.event=Ie)&&_&&_isWithin(Ie.target,_)||Be&&We&&Ie.pointerType!=="touch"||k&&k(Ie,Be)},Ae=function(){ie._vx.reset(),ie._vy.reset(),De.pause(),g&&g(ie)},G=function(){var Ie=ie.deltaX=_getAbsoluteMax(K),Be=ie.deltaY=_getAbsoluteMax(X),we=Math.abs(Ie)>=n,je=Math.abs(Be)>=n;A&&(we||je)&&A(ie,Ie,Be,K,X),we&&(E&&ie.deltaX>0&&E(ie),p&&ie.deltaX<0&&p(ie),C&&C(ie),P&&ie.deltaX<0!=Ne<0&&P(ie),Ne=ie.deltaX,K[0]=K[1]=K[2]=0),je&&(w&&ie.deltaY>0&&w(ie),x&&ie.deltaY<0&&x(ie),S&&S(ie),O&&ie.deltaY<0!=Ve<0&&O(ie),Ve=ie.deltaY,X[0]=X[1]=X[2]=0),(pe||Pe)&&(B&&B(ie),Pe&&(c&&Pe===1&&c(ie),v&&v(ie),Pe=0),pe=!1),be&&!(be=!1)&&le&&le(ie),Z&&(z(ie),Z=!1),Ee=0},ce=function(Ie,Be,we){K[we]+=Ie,X[we]+=Be,ie._vx.update(Ie),ie._vy.update(Be),h?Ee||(Ee=requestAnimationFrame(G)):G()},ve=function(Ie,Be){ne&&!Ce&&(ie.axis=Ce=Math.abs(Ie)>Math.abs(Be)?"x":"y",be=!0),Ce!=="y"&&(K[2]+=Ie,ie._vx.update(Ie,!0)),Ce!=="x"&&(X[2]+=Be,ie._vy.update(Be,!0)),h?Ee||(Ee=requestAnimationFrame(G)):G()},Oe=function(Ie){if(!ye(Ie,1)){Ie=_getEvent(Ie,u);var Be=Ie.clientX,we=Ie.clientY,je=Be-ie.x,Xe=we-ie.y,Ke=ie.isDragging;ie.x=Be,ie.y=we,(Ke||(je||Xe)&&(Math.abs(ie.startX-Be)>=s||Math.abs(ie.startY-we)>=s))&&(Pe=Ke?2:1,Ke||(ie.isDragging=!0),ve(je,Xe))}},oe=ie.onPress=function(he){ye(he,1)||he&&he.button||(ie.axis=Ce=null,De.pause(),ie.isPressed=!0,he=_getEvent(he),Ne=Ve=0,ie.startX=ie.x=he.clientX,ie.startY=ie.y=he.clientY,ie._vx.reset(),ie._vy.reset(),_addListener$1(U?a:H,_eventTypes[1],Oe,Ue,!0),ie.deltaX=ie.deltaY=0,y&&y(ie))},me=ie.onRelease=function(he){if(!ye(he,1)){_removeListener$1(U?a:H,_eventTypes[1],Oe,!0);var Ie=!isNaN(ie.y-ie.startY),Be=ie.isDragging,we=Be&&(Math.abs(ie.x-ie.startX)>3||Math.abs(ie.y-ie.startY)>3),je=_getEvent(he);!we&&Ie&&(ie._vx.reset(),ie._vy.reset(),u&&ae&&gsap$2.delayedCall(.08,function(){if(_getTime$1()-_e>300&&!he.defaultPrevented){if(he.target.click)he.target.click();else if(H.createEvent){var Xe=H.createEvent("MouseEvents");Xe.initMouseEvent("click",!0,!0,_win$1,1,je.screenX,je.screenY,je.clientX,je.clientY,!1,!1,!1,!1,0,null),he.target.dispatchEvent(Xe)}}})),ie.isDragging=ie.isGesturing=ie.isPressed=!1,g&&Be&&!U&&De.restart(!0),Pe&&G(),f&&Be&&f(ie),D&&D(ie,we)}},$=function(Ie){return Ie.touches&&Ie.touches.length>1&&(ie.isGesturing=!0)&&W(Ie,ie.isDragging)},Te=function(){return(ie.isGesturing=!1)||R(ie)},ke=function(Ie){if(!ye(Ie)){var Be=Fe(),we=ze();ce((Be-Re)*re,(we-Le)*re,1),Re=Be,Le=we,g&&De.restart(!0)}},L=function(Ie){if(!ye(Ie)){Ie=_getEvent(Ie,u),z&&(Z=!0);var Be=(Ie.deltaMode===1?l:Ie.deltaMode===2?_win$1.innerHeight:1)*b;ce(Ie.deltaX*Be,Ie.deltaY*Be,0),g&&!U&&De.restart(!0)}},ge=function(Ie){if(!ye(Ie)){var Be=Ie.clientX,we=Ie.clientY,je=Be-ie.x,Xe=we-ie.y;ie.x=Be,ie.y=we,pe=!0,g&&De.restart(!0),(je||Xe)&&ve(je,Xe)}},de=function(Ie){ie.event=Ie,F(ie)},j=function(Ie){ie.event=Ie,I(ie)},se=function(Ie){return ye(Ie)||_getEvent(Ie,u)&&Q(ie)};De=ie._dc=gsap$2.delayedCall(m||.25,Ae).pause(),ie.deltaX=ie.deltaY=0,ie._vx=_getVelocityProp(0,50,!0),ie._vy=_getVelocityProp(0,50,!0),ie.scrollX=Fe,ie.scrollY=ze,ie.isDragging=ie.isGesturing=ie.isPressed=!1,_context$1(this),ie.enable=function(he){return ie.isEnabled||(_addListener$1(He?H:a,"scroll",_onScroll$1),o.indexOf("scroll")>=0&&_addListener$1(He?H:a,"scroll",ke,Ue,te),o.indexOf("wheel")>=0&&_addListener$1(a,"wheel",L,Ue,te),(o.indexOf("touch")>=0&&_isTouch||o.indexOf("pointer")>=0)&&(_addListener$1(a,_eventTypes[0],oe,Ue,te),_addListener$1(H,_eventTypes[2],me),_addListener$1(H,_eventTypes[3],me),ae&&_addListener$1(a,"click",ue,!0,!0),Q&&_addListener$1(a,"click",se),W&&_addListener$1(H,"gesturestart",$),R&&_addListener$1(H,"gestureend",Te),F&&_addListener$1(a,_pointerType+"enter",de),I&&_addListener$1(a,_pointerType+"leave",j),B&&_addListener$1(a,_pointerType+"move",ge)),ie.isEnabled=!0,ie.isDragging=ie.isGesturing=ie.isPressed=pe=Pe=!1,ie._vx.reset(),ie._vy.reset(),Re=Fe(),Le=ze(),he&&he.type&&oe(he),V&&V(ie)),ie},ie.disable=function(){ie.isEnabled&&(_observers.filter(function(he){return he!==ie&&_isViewport$1(he.target)}).length||_removeListener$1(He?H:a,"scroll",_onScroll$1),ie.isPressed&&(ie._vx.reset(),ie._vy.reset(),_removeListener$1(U?a:H,_eventTypes[1],Oe,!0)),_removeListener$1(He?H:a,"scroll",ke,te),_removeListener$1(a,"wheel",L,te),_removeListener$1(a,_eventTypes[0],oe,te),_removeListener$1(H,_eventTypes[2],me),_removeListener$1(H,_eventTypes[3],me),_removeListener$1(a,"click",ue,!0),_removeListener$1(a,"click",se),_removeListener$1(H,"gesturestart",$),_removeListener$1(H,"gestureend",Te),_removeListener$1(a,_pointerType+"enter",de),_removeListener$1(a,_pointerType+"leave",j),_removeListener$1(a,_pointerType+"move",ge),ie.isEnabled=ie.isPressed=ie.isDragging=!1,q&&q(ie))},ie.kill=ie.revert=function(){ie.disable();var he=_observers.indexOf(ie);he>=0&&_observers.splice(he,1),_normalizer$1===ie&&(_normalizer$1=0)},_observers.push(ie),U&&_isViewport$1(a)&&(_normalizer$1=ie),ie.enable(d)},_createClass(r,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),r}();Observer.version="3.13.0";Observer.create=function(r){return new Observer(r)};Observer.register=_initCore;Observer.getAll=function(){return _observers.slice()};Observer.getById=function(r){return _observers.filter(function(e){return e.vars.id===r})[0]};_getGSAP$2()&&gsap$2.registerPlugin(Observer);/*!
 * ScrollTrigger 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$1,_coreInitted,_win,_doc,_docEl,_body,_root,_resizeDelay,_toArray,_clamp,_time2,_syncInterval,_refreshing,_pointerIsDown,_transformProp,_i,_prevWidth,_prevHeight,_autoRefresh,_sort,_suppressOverwrites,_ignoreResize,_normalizer,_ignoreMobileResize,_baseScreenHeight,_baseScreenWidth,_fixIOSBug,_context,_scrollRestoration,_div100vh,_100vh,_isReverted,_clampingMax,_limitCallbacks,_startup=1,_getTime=Date.now,_time1=_getTime(),_lastScrollTime=0,_enabled=0,_parseClamp=function(e,t,i){var n=_isString(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return i["_"+t+"Clamp"]=n,n?e.substr(6,e.length-7):e},_keepClamp=function(e,t){return t&&(!_isString(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},_rafBugFix=function r(){return _enabled&&requestAnimationFrame(r)},_pointerDownHandler=function(){return _pointerIsDown=1},_pointerUpHandler=function(){return _pointerIsDown=0},_passThrough=function(e){return e},_round=function(e){return Math.round(e*1e5)/1e5||0},_windowExists=function(){return typeof window<"u"},_getGSAP$1=function(){return gsap$1||_windowExists()&&(gsap$1=window.gsap)&&gsap$1.registerPlugin&&gsap$1},_isViewport=function(e){return!!~_root.indexOf(e)},_getViewportDimension=function(e){return(e==="Height"?_100vh:_win["inner"+e])||_docEl["client"+e]||_body["client"+e]},_getBoundsFunc=function(e){return _getProxyProp(e,"getBoundingClientRect")||(_isViewport(e)?function(){return _winOffsets.width=_win.innerWidth,_winOffsets.height=_100vh,_winOffsets}:function(){return _getBounds$1(e)})},_getSizeFunc=function(e,t,i){var n=i.d,s=i.d2,o=i.a;return(o=_getProxyProp(e,"getBoundingClientRect"))?function(){return o()[n]}:function(){return(t?_getViewportDimension(s):e["client"+s])||0}},_getOffsetsFunc=function(e,t){return!t||~_proxies.indexOf(e)?_getBoundsFunc(e):function(){return _winOffsets}},_maxScroll=function(e,t){var i=t.s,n=t.d2,s=t.d,o=t.a;return Math.max(0,(i="scroll"+n)&&(o=_getProxyProp(e,i))?o()-_getBoundsFunc(e)()[s]:_isViewport(e)?(_docEl[i]||_body[i])-_getViewportDimension(n):e[i]-e["offset"+n])},_iterateAutoRefresh=function(e,t){for(var i=0;i<_autoRefresh.length;i+=3)(!t||~t.indexOf(_autoRefresh[i+1]))&&e(_autoRefresh[i],_autoRefresh[i+1],_autoRefresh[i+2])},_isString=function(e){return typeof e=="string"},_isFunction=function(e){return typeof e=="function"},_isNumber=function(e){return typeof e=="number"},_isObject=function(e){return typeof e=="object"},_endAnimation=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},_callback=function(e,t){if(e.enabled){var i=e._ctx?e._ctx.add(function(){return t(e)}):t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},_abs=Math.abs,_left="left",_top="top",_right="right",_bottom="bottom",_width="width",_height="height",_Right="Right",_Left="Left",_Top="Top",_Bottom="Bottom",_padding="padding",_margin="margin",_Width="Width",_Height="Height",_px="px",_getComputedStyle=function(e){return _win.getComputedStyle(e)},_makePositionable=function(e){var t=_getComputedStyle(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},_setDefaults=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_getBounds$1=function(e,t){var i=t&&_getComputedStyle(e)[_transformProp]!=="matrix(1, 0, 0, 1, 0, 0)"&&gsap$1.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=e.getBoundingClientRect();return i&&i.progress(0).kill(),n},_getSize=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},_getLabelRatioArray=function(e){var t=[],i=e.labels,n=e.duration(),s;for(s in i)t.push(i[s]/n);return t},_getClosestLabel=function(e){return function(t){return gsap$1.utils.snap(_getLabelRatioArray(e),t)}},_snapDirectional=function(e){var t=gsap$1.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort(function(n,s){return n-s});return i?function(n,s,o){o===void 0&&(o=.001);var a;if(!s)return t(n);if(s>0){for(n-=o,a=0;a<i.length;a++)if(i[a]>=n)return i[a];return i[a-1]}else for(a=i.length,n+=o;a--;)if(i[a]<=n)return i[a];return i[0]}:function(n,s,o){o===void 0&&(o=.001);var a=t(n);return!s||Math.abs(a-n)<o||a-n<0==s<0?a:t(s<0?n-e:n+e)}},_getLabelAtDirection=function(e){return function(t,i){return _snapDirectional(_getLabelRatioArray(e))(t,i.direction)}},_multiListener=function(e,t,i,n){return i.split(",").forEach(function(s){return e(t,s,n)})},_addListener=function(e,t,i,n,s){return e.addEventListener(t,i,{passive:!n,capture:!!s})},_removeListener=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},_wheelListener=function(e,t,i){i=i&&i.wheelHandler,i&&(e(t,"wheel",i),e(t,"touchmove",i))},_markerDefaults={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},_defaults={toggleActions:"play",anticipatePin:0},_keywords={top:0,left:0,center:.5,bottom:1,right:1},_offsetToPx=function(e,t){if(_isString(e)){var i=e.indexOf("="),n=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(n*=t/100),e=e.substr(0,i-1)),e=n+(e in _keywords?_keywords[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},_createMarker=function(e,t,i,n,s,o,a,l){var h=s.startColor,u=s.endColor,g=s.fontSize,m=s.indent,_=s.fontWeight,b=_doc.createElement("div"),d=_isViewport(i)||_getProxyProp(i,"pinType")==="fixed",c=e.indexOf("scroller")!==-1,f=d?_body:i,v=e.indexOf("start")!==-1,y=v?h:u,D="border-color:"+y+";font-size:"+g+";color:"+y+";font-weight:"+_+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return D+="position:"+((c||l)&&d?"fixed;":"absolute;"),(c||l||!d)&&(D+=(n===_vertical?_right:_bottom)+":"+(o+parseFloat(m))+"px;"),a&&(D+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),b._isStart=v,b.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),b.style.cssText=D,b.innerText=t||t===0?e+"-"+t:e,f.children[0]?f.insertBefore(b,f.children[0]):f.appendChild(b),b._offset=b["offset"+n.op.d2],_positionMarker(b,0,n,v),b},_positionMarker=function(e,t,i,n){var s={display:"block"},o=i[n?"os2":"p2"],a=i[n?"p2":"os2"];e._isFlipped=n,s[i.a+"Percent"]=n?-100:0,s[i.a]=n?"1px":0,s["border"+o+_Width]=1,s["border"+a+_Width]=0,s[i.p]=t+"px",gsap$1.set(e,s)},_triggers=[],_ids={},_rafID,_sync=function(){return _getTime()-_lastScrollTime>34&&(_rafID||(_rafID=requestAnimationFrame(_updateAll)))},_onScroll=function(){(!_normalizer||!_normalizer.isPressed||_normalizer.startX>_body.clientWidth)&&(_scrollers.cache++,_normalizer?_rafID||(_rafID=requestAnimationFrame(_updateAll)):_updateAll(),_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime())},_setBaseDimensions=function(){_baseScreenWidth=_win.innerWidth,_baseScreenHeight=_win.innerHeight},_onResize=function(e){_scrollers.cache++,(e===!0||!_refreshing&&!_ignoreResize&&!_doc.fullscreenElement&&!_doc.webkitFullscreenElement&&(!_ignoreMobileResize||_baseScreenWidth!==_win.innerWidth||Math.abs(_win.innerHeight-_baseScreenHeight)>_win.innerHeight*.25))&&_resizeDelay.restart(!0)},_listeners={},_emptyArray=[],_softRefresh=function r(){return _removeListener(ScrollTrigger,"scrollEnd",r)||_refreshAll(!0)},_dispatch=function(e){return _listeners[e]&&_listeners[e].map(function(t){return t()})||_emptyArray},_savedStyles=[],_revertRecorded=function(e){for(var t=0;t<_savedStyles.length;t+=5)(!e||_savedStyles[t+4]&&_savedStyles[t+4].query===e)&&(_savedStyles[t].style.cssText=_savedStyles[t+1],_savedStyles[t].getBBox&&_savedStyles[t].setAttribute("transform",_savedStyles[t+2]||""),_savedStyles[t+3].uncache=1)},_revertAll=function(e,t){var i;for(_i=0;_i<_triggers.length;_i++)i=_triggers[_i],i&&(!t||i._ctx===t)&&(e?i.kill(1):i.revert(!0,!0));_isReverted=!0,t&&_revertRecorded(t),t||_dispatch("revert")},_clearScrollMemory=function(e,t){_scrollers.cache++,(t||!_refreshingAll)&&_scrollers.forEach(function(i){return _isFunction(i)&&i.cacheID++&&(i.rec=0)}),_isString(e)&&(_win.history.scrollRestoration=_scrollRestoration=e)},_refreshingAll,_refreshID=0,_queueRefreshID,_queueRefreshAll=function(){if(_queueRefreshID!==_refreshID){var e=_queueRefreshID=_refreshID;requestAnimationFrame(function(){return e===_refreshID&&_refreshAll(!0)})}},_refresh100vh=function(){_body.appendChild(_div100vh),_100vh=!_normalizer&&_div100vh.offsetHeight||_win.innerHeight,_body.removeChild(_div100vh)},_hideAllMarkers=function(e){return _toArray(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},_refreshAll=function(e,t){if(_docEl=_doc.documentElement,_body=_doc.body,_root=[_win,_doc,_docEl,_body],_lastScrollTime&&!e&&!_isReverted){_addListener(ScrollTrigger,"scrollEnd",_softRefresh);return}_refresh100vh(),_refreshingAll=ScrollTrigger.isRefreshing=!0,_scrollers.forEach(function(n){return _isFunction(n)&&++n.cacheID&&(n.rec=n())});var i=_dispatch("refreshInit");_sort&&ScrollTrigger.sort(),t||_revertAll(),_scrollers.forEach(function(n){_isFunction(n)&&(n.smooth&&(n.target.style.scrollBehavior="auto"),n(0))}),_triggers.slice(0).forEach(function(n){return n.refresh()}),_isReverted=!1,_triggers.forEach(function(n){if(n._subPinOffset&&n.pin){var s=n.vars.horizontal?"offsetWidth":"offsetHeight",o=n.pin[s];n.revert(!0,1),n.adjustPinSpacing(n.pin[s]-o),n.refresh()}}),_clampingMax=1,_hideAllMarkers(!0),_triggers.forEach(function(n){var s=_maxScroll(n.scroller,n._dir),o=n.vars.end==="max"||n._endClamp&&n.end>s,a=n._startClamp&&n.start>=s;(o||a)&&n.setPositions(a?s-1:n.start,o?Math.max(a?s:n.start+1,s):n.end,!0)}),_hideAllMarkers(!1),_clampingMax=0,i.forEach(function(n){return n&&n.render&&n.render(-1)}),_scrollers.forEach(function(n){_isFunction(n)&&(n.smooth&&requestAnimationFrame(function(){return n.target.style.scrollBehavior="smooth"}),n.rec&&n(n.rec))}),_clearScrollMemory(_scrollRestoration,1),_resizeDelay.pause(),_refreshID++,_refreshingAll=2,_updateAll(2),_triggers.forEach(function(n){return _isFunction(n.vars.onRefresh)&&n.vars.onRefresh(n)}),_refreshingAll=ScrollTrigger.isRefreshing=!1,_dispatch("refresh")},_lastScroll=0,_direction=1,_primary,_updateAll=function(e){if(e===2||!_refreshingAll&&!_isReverted){ScrollTrigger.isUpdating=!0,_primary&&_primary.update(0);var t=_triggers.length,i=_getTime(),n=i-_time1>=50,s=t&&_triggers[0].scroll();if(_direction=_lastScroll>s?-1:1,_refreshingAll||(_lastScroll=s),n&&(_lastScrollTime&&!_pointerIsDown&&i-_lastScrollTime>200&&(_lastScrollTime=0,_dispatch("scrollEnd")),_time2=_time1,_time1=i),_direction<0){for(_i=t;_i-- >0;)_triggers[_i]&&_triggers[_i].update(0,n);_direction=1}else for(_i=0;_i<t;_i++)_triggers[_i]&&_triggers[_i].update(0,n);ScrollTrigger.isUpdating=!1}_rafID=0},_propNamesToCopy=[_left,_top,_bottom,_right,_margin+_Bottom,_margin+_Right,_margin+_Top,_margin+_Left,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],_stateProps=_propNamesToCopy.concat([_width,_height,"boxSizing","max"+_Width,"max"+_Height,"position",_margin,_padding,_padding+_Top,_padding+_Right,_padding+_Bottom,_padding+_Left]),_swapPinOut=function(e,t,i){_setState(i);var n=e._gsap;if(n.spacerIsNative)_setState(n.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},_swapPinIn=function(e,t,i,n){if(!e._gsap.swappedIn){for(var s=_propNamesToCopy.length,o=t.style,a=e.style,l;s--;)l=_propNamesToCopy[s],o[l]=i[l];o.position=i.position==="absolute"?"absolute":"relative",i.display==="inline"&&(o.display="inline-block"),a[_bottom]=a[_right]="auto",o.flexBasis=i.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[_width]=_getSize(e,_horizontal)+_px,o[_height]=_getSize(e,_vertical)+_px,o[_padding]=a[_margin]=a[_top]=a[_left]="0",_setState(n),a[_width]=a["max"+_Width]=i[_width],a[_height]=a["max"+_Height]=i[_height],a[_padding]=i[_padding],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},_capsExp=/([A-Z])/g,_setState=function(e){if(e){var t=e.t.style,i=e.length,n=0,s,o;for((e.t._gsap||gsap$1.core.getCache(e.t)).uncache=1;n<i;n+=2)o=e[n+1],s=e[n],o?t[s]=o:t[s]&&t.removeProperty(s.replace(_capsExp,"-$1").toLowerCase())}},_getState=function(e){for(var t=_stateProps.length,i=e.style,n=[],s=0;s<t;s++)n.push(_stateProps[s],i[_stateProps[s]]);return n.t=e,n},_copyState=function(e,t,i){for(var n=[],s=e.length,o=i?8:0,a;o<s;o+=2)a=e[o],n.push(a,a in t?t[a]:e[o+1]);return n.t=e.t,n},_winOffsets={left:0,top:0},_parsePosition=function(e,t,i,n,s,o,a,l,h,u,g,m,_,b){_isFunction(e)&&(e=e(l)),_isString(e)&&e.substr(0,3)==="max"&&(e=m+(e.charAt(4)==="="?_offsetToPx("0"+e.substr(3),i):0));var d=_?_.time():0,c,f,v;if(_&&_.seek(0),isNaN(e)||(e=+e),_isNumber(e))_&&(e=gsap$1.utils.mapRange(_.scrollTrigger.start,_.scrollTrigger.end,0,m,e)),a&&_positionMarker(a,i,n,!0);else{_isFunction(t)&&(t=t(l));var y=(e||"0").split(" "),D,E,p,x;v=_getTarget$1(t,l)||_body,D=_getBounds$1(v)||{},(!D||!D.left&&!D.top)&&_getComputedStyle(v).display==="none"&&(x=v.style.display,v.style.display="block",D=_getBounds$1(v),x?v.style.display=x:v.style.removeProperty("display")),E=_offsetToPx(y[0],D[n.d]),p=_offsetToPx(y[1]||"0",i),e=D[n.p]-h[n.p]-u+E+s-p,a&&_positionMarker(a,p,n,i-p<20||a._isStart&&p>20),i-=i-p}if(b&&(l[b]=e||-.001,e<0&&(e=0)),o){var w=e+i,C=o._isStart;c="scroll"+n.d2,_positionMarker(o,w,n,C&&w>20||!C&&(g?Math.max(_body[c],_docEl[c]):o.parentNode[c])<=w+1),g&&(h=_getBounds$1(a),g&&(o.style[n.op.p]=h[n.op.p]-n.op.m-o._offset+_px))}return _&&v&&(c=_getBounds$1(v),_.seek(m),f=_getBounds$1(v),_._caScrollDist=c[n.p]-f[n.p],e=e/_._caScrollDist*m),_&&_.seek(d),_?e:Math.round(e)},_prefixExp=/(webkit|moz|length|cssText|inset)/i,_reparent=function(e,t,i,n){if(e.parentNode!==t){var s=e.style,o,a;if(t===_body){e._stOrig=s.cssText,a=_getComputedStyle(e);for(o in a)!+o&&!_prefixExp.test(o)&&a[o]&&typeof s[o]=="string"&&o!=="0"&&(s[o]=a[o]);s.top=i,s.left=n}else s.cssText=e._stOrig;gsap$1.core.getCache(e).uncache=1,t.appendChild(e)}},_interruptionTracker=function(e,t,i){var n=t,s=n;return function(o){var a=Math.round(e());return a!==n&&a!==s&&Math.abs(a-n)>3&&Math.abs(a-s)>3&&(o=a,i&&i()),s=n,n=Math.round(o),n}},_shiftMarker=function(e,t,i){var n={};n[t.p]="+="+i,gsap$1.set(e,n)},_getTweenCreator=function(e,t){var i=_getScrollFunc(e,t),n="_scroll"+t.p2,s=function o(a,l,h,u,g){var m=o.tween,_=l.onComplete,b={};h=h||i();var d=_interruptionTracker(i,h,function(){m.kill(),o.tween=0});return g=u&&g||0,u=u||a-h,m&&m.kill(),l[n]=a,l.inherit=!1,l.modifiers=b,b[n]=function(){return d(h+u*m.ratio+g*m.ratio*m.ratio)},l.onUpdate=function(){_scrollers.cache++,o.tween&&_updateAll()},l.onComplete=function(){o.tween=0,_&&_.call(m)},m=o.tween=gsap$1.to(e,l),m};return e[n]=i,i.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},_addListener(e,"wheel",i.wheelHandler),ScrollTrigger.isTouch&&_addListener(e,"touchmove",i.wheelHandler),s},ScrollTrigger=function(){function r(t,i){_coreInitted||r.register(gsap$1)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),_context(this),this.init(t,i)}var e=r.prototype;return e.init=function(i,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!_enabled){this.update=this.refresh=this.kill=_passThrough;return}i=_setDefaults(_isString(i)||_isNumber(i)||i.nodeType?{trigger:i}:i,_defaults);var s=i,o=s.onUpdate,a=s.toggleClass,l=s.id,h=s.onToggle,u=s.onRefresh,g=s.scrub,m=s.trigger,_=s.pin,b=s.pinSpacing,d=s.invalidateOnRefresh,c=s.anticipatePin,f=s.onScrubComplete,v=s.onSnapComplete,y=s.once,D=s.snap,E=s.pinReparent,p=s.pinSpacer,x=s.containerAnimation,w=s.fastScrollEnd,C=s.preventOverlaps,S=i.horizontal||i.containerAnimation&&i.horizontal!==!1?_horizontal:_vertical,A=!g&&g!==0,P=_getTarget$1(i.scroller||_win),O=gsap$1.core.getCache(P),F=_isViewport(P),I=("pinType"in i?i.pinType:_getProxyProp(P,"pinType")||F&&"fixed")==="fixed",B=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],k=A&&i.toggleActions.split(" "),U="markers"in i?i.markers:_defaults.markers,W=F?0:parseFloat(_getComputedStyle(P)["border"+S.p2+_Width])||0,R=this,z=i.onRefreshInit&&function(){return i.onRefreshInit(R)},V=_getSizeFunc(P,F,S),q=_getOffsetsFunc(P,F),Q=0,re=0,te=0,ae=_getScrollFunc(P,S),ne,le,Ee,De,Pe,pe,Z,be,Ce,ie,Ne,Ve,Ue,Fe,ze,Re,Le,We,He,H,K,X,_e,ue,ye,Ae,G,ce,ve,Oe,oe,me,$,Te,ke,L,ge,de,j;if(R._startClamp=R._endClamp=!1,R._dir=S,c*=45,R.scroller=P,R.scroll=x?x.time.bind(x):ae,De=ae(),R.vars=i,n=n||i.animation,"refreshPriority"in i&&(_sort=1,i.refreshPriority===-9999&&(_primary=R)),O.tweenScroll=O.tweenScroll||{top:_getTweenCreator(P,_vertical),left:_getTweenCreator(P,_horizontal)},R.tweenTo=ne=O.tweenScroll[S.p],R.scrubDuration=function(we){$=_isNumber(we)&&we,$?me?me.duration(we):me=gsap$1.to(n,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:$,paused:!0,onComplete:function(){return f&&f(R)}}):(me&&me.progress(1).kill(),me=0)},n&&(n.vars.lazy=!1,n._initted&&!R.isReverted||n.vars.immediateRender!==!1&&i.immediateRender!==!1&&n.duration()&&n.render(0,!0,!0),R.animation=n.pause(),n.scrollTrigger=R,R.scrubDuration(g),Oe=0,l||(l=n.vars.id)),D&&((!_isObject(D)||D.push)&&(D={snapTo:D}),"scrollBehavior"in _body.style&&gsap$1.set(F?[_body,_docEl]:P,{scrollBehavior:"auto"}),_scrollers.forEach(function(we){return _isFunction(we)&&we.target===(F?_doc.scrollingElement||_docEl:P)&&(we.smooth=!1)}),Ee=_isFunction(D.snapTo)?D.snapTo:D.snapTo==="labels"?_getClosestLabel(n):D.snapTo==="labelsDirectional"?_getLabelAtDirection(n):D.directional!==!1?function(we,je){return _snapDirectional(D.snapTo)(we,_getTime()-re<500?0:je.direction)}:gsap$1.utils.snap(D.snapTo),Te=D.duration||{min:.1,max:2},Te=_isObject(Te)?_clamp(Te.min,Te.max):_clamp(Te,Te),ke=gsap$1.delayedCall(D.delay||$/2||.1,function(){var we=ae(),je=_getTime()-re<500,Xe=ne.tween;if((je||Math.abs(R.getVelocity())<10)&&!Xe&&!_pointerIsDown&&Q!==we){var Ke=(we-pe)/Fe,Je=n&&!A?n.totalProgress():Ke,Ye=je?0:(Je-oe)/(_getTime()-_time2)*1e3||0,rt=gsap$1.utils.clamp(-Ke,1-Ke,_abs(Ye/2)*Ye/.185),st=Ke+(D.inertia===!1?0:rt),pt,ut,et=D,ct=et.onStart,tt=et.onInterrupt,xt=et.onComplete;if(pt=Ee(st,R),_isNumber(pt)||(pt=st),ut=Math.max(0,Math.round(pe+pt*Fe)),we<=Z&&we>=pe&&ut!==we){if(Xe&&!Xe._initted&&Xe.data<=_abs(ut-we))return;D.inertia===!1&&(rt=pt-Ke),ne(ut,{duration:Te(_abs(Math.max(_abs(st-Je),_abs(pt-Je))*.185/Ye/.05||0)),ease:D.ease||"power3",data:_abs(ut-we),onInterrupt:function(){return ke.restart(!0)&&tt&&tt(R)},onComplete:function(){R.update(),Q=ae(),n&&!A&&(me?me.resetTo("totalProgress",pt,n._tTime/n._tDur):n.progress(pt)),Oe=oe=n&&!A?n.totalProgress():R.progress,v&&v(R),xt&&xt(R)}},we,rt*Fe,ut-we-rt*Fe),ct&&ct(R,ne.tween)}}else R.isActive&&Q!==we&&ke.restart(!0)}).pause()),l&&(_ids[l]=R),m=R.trigger=_getTarget$1(m||_!==!0&&_),j=m&&m._gsap&&m._gsap.stRevert,j&&(j=j(R)),_=_===!0?m:_getTarget$1(_),_isString(a)&&(a={targets:m,className:a}),_&&(b===!1||b===_margin||(b=!b&&_.parentNode&&_.parentNode.style&&_getComputedStyle(_.parentNode).display==="flex"?!1:_padding),R.pin=_,le=gsap$1.core.getCache(_),le.spacer?ze=le.pinState:(p&&(p=_getTarget$1(p),p&&!p.nodeType&&(p=p.current||p.nativeElement),le.spacerIsNative=!!p,p&&(le.spacerState=_getState(p))),le.spacer=We=p||_doc.createElement("div"),We.classList.add("pin-spacer"),l&&We.classList.add("pin-spacer-"+l),le.pinState=ze=_getState(_)),i.force3D!==!1&&gsap$1.set(_,{force3D:!0}),R.spacer=We=le.spacer,ve=_getComputedStyle(_),ue=ve[b+S.os2],H=gsap$1.getProperty(_),K=gsap$1.quickSetter(_,S.a,_px),_swapPinIn(_,We,ve),Le=_getState(_)),U){Ve=_isObject(U)?_setDefaults(U,_markerDefaults):_markerDefaults,ie=_createMarker("scroller-start",l,P,S,Ve,0),Ne=_createMarker("scroller-end",l,P,S,Ve,0,ie),He=ie["offset"+S.op.d2];var se=_getTarget$1(_getProxyProp(P,"content")||P);be=this.markerStart=_createMarker("start",l,se,S,Ve,He,0,x),Ce=this.markerEnd=_createMarker("end",l,se,S,Ve,He,0,x),x&&(de=gsap$1.quickSetter([be,Ce],S.a,_px)),!I&&!(_proxies.length&&_getProxyProp(P,"fixedMarkers")===!0)&&(_makePositionable(F?_body:P),gsap$1.set([ie,Ne],{force3D:!0}),Ae=gsap$1.quickSetter(ie,S.a,_px),ce=gsap$1.quickSetter(Ne,S.a,_px))}if(x){var he=x.vars.onUpdate,Ie=x.vars.onUpdateParams;x.eventCallback("onUpdate",function(){R.update(0,0,1),he&&he.apply(x,Ie||[])})}if(R.previous=function(){return _triggers[_triggers.indexOf(R)-1]},R.next=function(){return _triggers[_triggers.indexOf(R)+1]},R.revert=function(we,je){if(!je)return R.kill(!0);var Xe=we!==!1||!R.enabled,Ke=_refreshing;Xe!==R.isReverted&&(Xe&&(L=Math.max(ae(),R.scroll.rec||0),te=R.progress,ge=n&&n.progress()),be&&[be,Ce,ie,Ne].forEach(function(Je){return Je.style.display=Xe?"none":"block"}),Xe&&(_refreshing=R,R.update(Xe)),_&&(!E||!R.isActive)&&(Xe?_swapPinOut(_,We,ze):_swapPinIn(_,We,_getComputedStyle(_),ye)),Xe||R.update(Xe),_refreshing=Ke,R.isReverted=Xe)},R.refresh=function(we,je,Xe,Ke){if(!((_refreshing||!R.enabled)&&!je)){if(_&&we&&_lastScrollTime){_addListener(r,"scrollEnd",_softRefresh);return}!_refreshingAll&&z&&z(R),_refreshing=R,ne.tween&&!Xe&&(ne.tween.kill(),ne.tween=0),me&&me.pause(),d&&n&&(n.revert({kill:!1}).invalidate(),n.getChildren&&n.getChildren(!0,!0,!1).forEach(function(Ot){return Ot.vars.immediateRender&&Ot.render(0,!0,!0)})),R.isReverted||R.revert(!0,!0),R._subPinOffset=!1;var Je=V(),Ye=q(),rt=x?x.duration():_maxScroll(P,S),st=Fe<=.01||!Fe,pt=0,ut=Ke||0,et=_isObject(Xe)?Xe.end:i.end,ct=i.endTrigger||m,tt=_isObject(Xe)?Xe.start:i.start||(i.start===0||!m?0:_?"0 0":"0 100%"),xt=R.pinnedContainer=i.pinnedContainer&&_getTarget$1(i.pinnedContainer,R),Dt=m&&Math.max(0,_triggers.indexOf(R))||0,wt=Dt,At,Et,zt,Nt,Tt,Ct,Lt,jt,bi,Kt,kt,Yt,at;for(U&&_isObject(Xe)&&(Yt=gsap$1.getProperty(ie,S.p),at=gsap$1.getProperty(Ne,S.p));wt-- >0;)Ct=_triggers[wt],Ct.end||Ct.refresh(0,1)||(_refreshing=R),Lt=Ct.pin,Lt&&(Lt===m||Lt===_||Lt===xt)&&!Ct.isReverted&&(Kt||(Kt=[]),Kt.unshift(Ct),Ct.revert(!0,!0)),Ct!==_triggers[wt]&&(Dt--,wt--);for(_isFunction(tt)&&(tt=tt(R)),tt=_parseClamp(tt,"start",R),pe=_parsePosition(tt,m,Je,S,ae(),be,ie,R,Ye,W,I,rt,x,R._startClamp&&"_startClamp")||(_?-.001:0),_isFunction(et)&&(et=et(R)),_isString(et)&&!et.indexOf("+=")&&(~et.indexOf(" ")?et=(_isString(tt)?tt.split(" ")[0]:"")+et:(pt=_offsetToPx(et.substr(2),Je),et=_isString(tt)?tt:(x?gsap$1.utils.mapRange(0,x.duration(),x.scrollTrigger.start,x.scrollTrigger.end,pe):pe)+pt,ct=m)),et=_parseClamp(et,"end",R),Z=Math.max(pe,_parsePosition(et||(ct?"100% 0":rt),ct,Je,S,ae()+pt,Ce,Ne,R,Ye,W,I,rt,x,R._endClamp&&"_endClamp"))||-.001,pt=0,wt=Dt;wt--;)Ct=_triggers[wt],Lt=Ct.pin,Lt&&Ct.start-Ct._pinPush<=pe&&!x&&Ct.end>0&&(At=Ct.end-(R._startClamp?Math.max(0,Ct.start):Ct.start),(Lt===m&&Ct.start-Ct._pinPush<pe||Lt===xt)&&isNaN(tt)&&(pt+=At*(1-Ct.progress)),Lt===_&&(ut+=At));if(pe+=pt,Z+=pt,R._startClamp&&(R._startClamp+=pt),R._endClamp&&!_refreshingAll&&(R._endClamp=Z||-.001,Z=Math.min(Z,_maxScroll(P,S))),Fe=Z-pe||(pe-=.01)&&.001,st&&(te=gsap$1.utils.clamp(0,1,gsap$1.utils.normalize(pe,Z,L))),R._pinPush=ut,be&&pt&&(At={},At[S.a]="+="+pt,xt&&(At[S.p]="-="+ae()),gsap$1.set([be,Ce],At)),_&&!(_clampingMax&&R.end>=_maxScroll(P,S)))At=_getComputedStyle(_),Nt=S===_vertical,zt=ae(),X=parseFloat(H(S.a))+ut,!rt&&Z>1&&(kt=(F?_doc.scrollingElement||_docEl:P).style,kt={style:kt,value:kt["overflow"+S.a.toUpperCase()]},F&&_getComputedStyle(_body)["overflow"+S.a.toUpperCase()]!=="scroll"&&(kt.style["overflow"+S.a.toUpperCase()]="scroll")),_swapPinIn(_,We,At),Le=_getState(_),Et=_getBounds$1(_,!0),jt=I&&_getScrollFunc(P,Nt?_horizontal:_vertical)(),b?(ye=[b+S.os2,Fe+ut+_px],ye.t=We,wt=b===_padding?_getSize(_,S)+Fe+ut:0,wt&&(ye.push(S.d,wt+_px),We.style.flexBasis!=="auto"&&(We.style.flexBasis=wt+_px)),_setState(ye),xt&&_triggers.forEach(function(Ot){Ot.pin===xt&&Ot.vars.pinSpacing!==!1&&(Ot._subPinOffset=!0)}),I&&ae(L)):(wt=_getSize(_,S),wt&&We.style.flexBasis!=="auto"&&(We.style.flexBasis=wt+_px)),I&&(Tt={top:Et.top+(Nt?zt-pe:jt)+_px,left:Et.left+(Nt?jt:zt-pe)+_px,boxSizing:"border-box",position:"fixed"},Tt[_width]=Tt["max"+_Width]=Math.ceil(Et.width)+_px,Tt[_height]=Tt["max"+_Height]=Math.ceil(Et.height)+_px,Tt[_margin]=Tt[_margin+_Top]=Tt[_margin+_Right]=Tt[_margin+_Bottom]=Tt[_margin+_Left]="0",Tt[_padding]=At[_padding],Tt[_padding+_Top]=At[_padding+_Top],Tt[_padding+_Right]=At[_padding+_Right],Tt[_padding+_Bottom]=At[_padding+_Bottom],Tt[_padding+_Left]=At[_padding+_Left],Re=_copyState(ze,Tt,E),_refreshingAll&&ae(0)),n?(bi=n._initted,_suppressOverwrites(1),n.render(n.duration(),!0,!0),_e=H(S.a)-X+Fe+ut,G=Math.abs(Fe-_e)>1,I&&G&&Re.splice(Re.length-2,2),n.render(0,!0,!0),bi||n.invalidate(!0),n.parent||n.totalTime(n.totalTime()),_suppressOverwrites(0)):_e=Fe,kt&&(kt.value?kt.style["overflow"+S.a.toUpperCase()]=kt.value:kt.style.removeProperty("overflow-"+S.a));else if(m&&ae()&&!x)for(Et=m.parentNode;Et&&Et!==_body;)Et._pinOffset&&(pe-=Et._pinOffset,Z-=Et._pinOffset),Et=Et.parentNode;Kt&&Kt.forEach(function(Ot){return Ot.revert(!1,!0)}),R.start=pe,R.end=Z,De=Pe=_refreshingAll?L:ae(),!x&&!_refreshingAll&&(De<L&&ae(L),R.scroll.rec=0),R.revert(!1,!0),re=_getTime(),ke&&(Q=-1,ke.restart(!0)),_refreshing=0,n&&A&&(n._initted||ge)&&n.progress()!==ge&&n.progress(ge||0,!0).render(n.time(),!0,!0),(st||te!==R.progress||x||d||n&&!n._initted)&&(n&&!A&&(n._initted||te||n.vars.immediateRender!==!1)&&n.totalProgress(x&&pe<-.001&&!te?gsap$1.utils.normalize(pe,Z,0):te,!0),R.progress=st||(De-pe)/Fe===te?0:te),_&&b&&(We._pinOffset=Math.round(R.progress*_e)),me&&me.invalidate(),isNaN(Yt)||(Yt-=gsap$1.getProperty(ie,S.p),at-=gsap$1.getProperty(Ne,S.p),_shiftMarker(ie,S,Yt),_shiftMarker(be,S,Yt-(Ke||0)),_shiftMarker(Ne,S,at),_shiftMarker(Ce,S,at-(Ke||0))),st&&!_refreshingAll&&R.update(),u&&!_refreshingAll&&!Ue&&(Ue=!0,u(R),Ue=!1)}},R.getVelocity=function(){return(ae()-Pe)/(_getTime()-_time2)*1e3||0},R.endAnimation=function(){_endAnimation(R.callbackAnimation),n&&(me?me.progress(1):n.paused()?A||_endAnimation(n,R.direction<0,1):_endAnimation(n,n.reversed()))},R.labelToScroll=function(we){return n&&n.labels&&(pe||R.refresh()||pe)+n.labels[we]/n.duration()*Fe||0},R.getTrailing=function(we){var je=_triggers.indexOf(R),Xe=R.direction>0?_triggers.slice(0,je).reverse():_triggers.slice(je+1);return(_isString(we)?Xe.filter(function(Ke){return Ke.vars.preventOverlaps===we}):Xe).filter(function(Ke){return R.direction>0?Ke.end<=pe:Ke.start>=Z})},R.update=function(we,je,Xe){if(!(x&&!Xe&&!we)){var Ke=_refreshingAll===!0?L:R.scroll(),Je=we?0:(Ke-pe)/Fe,Ye=Je<0?0:Je>1?1:Je||0,rt=R.progress,st,pt,ut,et,ct,tt,xt,Dt;if(je&&(Pe=De,De=x?ae():Ke,D&&(oe=Oe,Oe=n&&!A?n.totalProgress():Ye)),c&&_&&!_refreshing&&!_startup&&_lastScrollTime&&(!Ye&&pe<Ke+(Ke-Pe)/(_getTime()-_time2)*c?Ye=1e-4:Ye===1&&Z>Ke+(Ke-Pe)/(_getTime()-_time2)*c&&(Ye=.9999)),Ye!==rt&&R.enabled){if(st=R.isActive=!!Ye&&Ye<1,pt=!!rt&&rt<1,tt=st!==pt,ct=tt||!!Ye!=!!rt,R.direction=Ye>rt?1:-1,R.progress=Ye,ct&&!_refreshing&&(ut=Ye&&!rt?0:Ye===1?1:rt===1?2:3,A&&(et=!tt&&k[ut+1]!=="none"&&k[ut+1]||k[ut],Dt=n&&(et==="complete"||et==="reset"||et in n))),C&&(tt||Dt)&&(Dt||g||!n)&&(_isFunction(C)?C(R):R.getTrailing(C).forEach(function(zt){return zt.endAnimation()})),A||(me&&!_refreshing&&!_startup?(me._dp._time-me._start!==me._time&&me.render(me._dp._time-me._start),me.resetTo?me.resetTo("totalProgress",Ye,n._tTime/n._tDur):(me.vars.totalProgress=Ye,me.invalidate().restart())):n&&n.totalProgress(Ye,!!(_refreshing&&(re||we)))),_){if(we&&b&&(We.style[b+S.os2]=ue),!I)K(_round(X+_e*Ye));else if(ct){if(xt=!we&&Ye>rt&&Z+1>Ke&&Ke+1>=_maxScroll(P,S),E)if(!we&&(st||xt)){var wt=_getBounds$1(_,!0),At=Ke-pe;_reparent(_,_body,wt.top+(S===_vertical?At:0)+_px,wt.left+(S===_vertical?0:At)+_px)}else _reparent(_,We);_setState(st||xt?Re:Le),G&&Ye<1&&st||K(X+(Ye===1&&!xt?_e:0))}}D&&!ne.tween&&!_refreshing&&!_startup&&ke.restart(!0),a&&(tt||y&&Ye&&(Ye<1||!_limitCallbacks))&&_toArray(a.targets).forEach(function(zt){return zt.classList[st||y?"add":"remove"](a.className)}),o&&!A&&!we&&o(R),ct&&!_refreshing?(A&&(Dt&&(et==="complete"?n.pause().totalProgress(1):et==="reset"?n.restart(!0).pause():et==="restart"?n.restart(!0):n[et]()),o&&o(R)),(tt||!_limitCallbacks)&&(h&&tt&&_callback(R,h),B[ut]&&_callback(R,B[ut]),y&&(Ye===1?R.kill(!1,1):B[ut]=0),tt||(ut=Ye===1?1:3,B[ut]&&_callback(R,B[ut]))),w&&!st&&Math.abs(R.getVelocity())>(_isNumber(w)?w:2500)&&(_endAnimation(R.callbackAnimation),me?me.progress(1):_endAnimation(n,et==="reverse"?1:!Ye,1))):A&&o&&!_refreshing&&o(R)}if(ce){var Et=x?Ke/x.duration()*(x._caScrollDist||0):Ke;Ae(Et+(ie._isFlipped?1:0)),ce(Et)}de&&de(-Ke/x.duration()*(x._caScrollDist||0))}},R.enable=function(we,je){R.enabled||(R.enabled=!0,_addListener(P,"resize",_onResize),F||_addListener(P,"scroll",_onScroll),z&&_addListener(r,"refreshInit",z),we!==!1&&(R.progress=te=0,De=Pe=Q=ae()),je!==!1&&R.refresh())},R.getTween=function(we){return we&&ne?ne.tween:me},R.setPositions=function(we,je,Xe,Ke){if(x){var Je=x.scrollTrigger,Ye=x.duration(),rt=Je.end-Je.start;we=Je.start+rt*we/Ye,je=Je.start+rt*je/Ye}R.refresh(!1,!1,{start:_keepClamp(we,Xe&&!!R._startClamp),end:_keepClamp(je,Xe&&!!R._endClamp)},Ke),R.update()},R.adjustPinSpacing=function(we){if(ye&&we){var je=ye.indexOf(S.d)+1;ye[je]=parseFloat(ye[je])+we+_px,ye[1]=parseFloat(ye[1])+we+_px,_setState(ye)}},R.disable=function(we,je){if(R.enabled&&(we!==!1&&R.revert(!0,!0),R.enabled=R.isActive=!1,je||me&&me.pause(),L=0,le&&(le.uncache=1),z&&_removeListener(r,"refreshInit",z),ke&&(ke.pause(),ne.tween&&ne.tween.kill()&&(ne.tween=0)),!F)){for(var Xe=_triggers.length;Xe--;)if(_triggers[Xe].scroller===P&&_triggers[Xe]!==R)return;_removeListener(P,"resize",_onResize),F||_removeListener(P,"scroll",_onScroll)}},R.kill=function(we,je){R.disable(we,je),me&&!je&&me.kill(),l&&delete _ids[l];var Xe=_triggers.indexOf(R);Xe>=0&&_triggers.splice(Xe,1),Xe===_i&&_direction>0&&_i--,Xe=0,_triggers.forEach(function(Ke){return Ke.scroller===R.scroller&&(Xe=1)}),Xe||_refreshingAll||(R.scroll.rec=0),n&&(n.scrollTrigger=null,we&&n.revert({kill:!1}),je||n.kill()),be&&[be,Ce,ie,Ne].forEach(function(Ke){return Ke.parentNode&&Ke.parentNode.removeChild(Ke)}),_primary===R&&(_primary=0),_&&(le&&(le.uncache=1),Xe=0,_triggers.forEach(function(Ke){return Ke.pin===_&&Xe++}),Xe||(le.spacer=0)),i.onKill&&i.onKill(R)},_triggers.push(R),R.enable(!1,!1),j&&j(R),n&&n.add&&!Fe){var Be=R.update;R.update=function(){R.update=Be,_scrollers.cache++,pe||Z||R.refresh()},gsap$1.delayedCall(.01,R.update),Fe=.01,pe=Z=0}else R.refresh();_&&_queueRefreshAll()},r.register=function(i){return _coreInitted||(gsap$1=i||_getGSAP$1(),_windowExists()&&window.document&&r.enable(),_coreInitted=_enabled),_coreInitted},r.defaults=function(i){if(i)for(var n in i)_defaults[n]=i[n];return _defaults},r.disable=function(i,n){_enabled=0,_triggers.forEach(function(o){return o[n?"kill":"disable"](i)}),_removeListener(_win,"wheel",_onScroll),_removeListener(_doc,"scroll",_onScroll),clearInterval(_syncInterval),_removeListener(_doc,"touchcancel",_passThrough),_removeListener(_body,"touchstart",_passThrough),_multiListener(_removeListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_removeListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_resizeDelay.kill(),_iterateAutoRefresh(_removeListener);for(var s=0;s<_scrollers.length;s+=3)_wheelListener(_removeListener,_scrollers[s],_scrollers[s+1]),_wheelListener(_removeListener,_scrollers[s],_scrollers[s+2])},r.enable=function(){if(_win=window,_doc=document,_docEl=_doc.documentElement,_body=_doc.body,gsap$1&&(_toArray=gsap$1.utils.toArray,_clamp=gsap$1.utils.clamp,_context=gsap$1.core.context||_passThrough,_suppressOverwrites=gsap$1.core.suppressOverwrites||_passThrough,_scrollRestoration=_win.history.scrollRestoration||"auto",_lastScroll=_win.pageYOffset||0,gsap$1.core.globals("ScrollTrigger",r),_body)){_enabled=1,_div100vh=document.createElement("div"),_div100vh.style.height="100vh",_div100vh.style.position="absolute",_refresh100vh(),_rafBugFix(),Observer.register(gsap$1),r.isTouch=Observer.isTouch,_fixIOSBug=Observer.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),_ignoreMobileResize=Observer.isTouch===1,_addListener(_win,"wheel",_onScroll),_root=[_win,_doc,_docEl,_body],gsap$1.matchMedia?(r.matchMedia=function(h){var u=gsap$1.matchMedia(),g;for(g in h)u.add(g,h[g]);return u},gsap$1.addEventListener("matchMediaInit",function(){return _revertAll()}),gsap$1.addEventListener("matchMediaRevert",function(){return _revertRecorded()}),gsap$1.addEventListener("matchMedia",function(){_refreshAll(0,1),_dispatch("matchMedia")}),gsap$1.matchMedia().add("(orientation: portrait)",function(){return _setBaseDimensions(),_setBaseDimensions})):console.warn("Requires GSAP 3.11.0 or later"),_setBaseDimensions(),_addListener(_doc,"scroll",_onScroll);var i=_body.hasAttribute("style"),n=_body.style,s=n.borderTopStyle,o=gsap$1.core.Animation.prototype,a,l;for(o.revert||Object.defineProperty(o,"revert",{value:function(){return this.time(-.01,!0)}}),n.borderTopStyle="solid",a=_getBounds$1(_body),_vertical.m=Math.round(a.top+_vertical.sc())||0,_horizontal.m=Math.round(a.left+_horizontal.sc())||0,s?n.borderTopStyle=s:n.removeProperty("border-top-style"),i||(_body.setAttribute("style",""),_body.removeAttribute("style")),_syncInterval=setInterval(_sync,250),gsap$1.delayedCall(.5,function(){return _startup=0}),_addListener(_doc,"touchcancel",_passThrough),_addListener(_body,"touchstart",_passThrough),_multiListener(_addListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_addListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_transformProp=gsap$1.utils.checkPrefix("transform"),_stateProps.push(_transformProp),_coreInitted=_getTime(),_resizeDelay=gsap$1.delayedCall(.2,_refreshAll).pause(),_autoRefresh=[_doc,"visibilitychange",function(){var h=_win.innerWidth,u=_win.innerHeight;_doc.hidden?(_prevWidth=h,_prevHeight=u):(_prevWidth!==h||_prevHeight!==u)&&_onResize()},_doc,"DOMContentLoaded",_refreshAll,_win,"load",_refreshAll,_win,"resize",_onResize],_iterateAutoRefresh(_addListener),_triggers.forEach(function(h){return h.enable(0,1)}),l=0;l<_scrollers.length;l+=3)_wheelListener(_removeListener,_scrollers[l],_scrollers[l+1]),_wheelListener(_removeListener,_scrollers[l],_scrollers[l+2])}},r.config=function(i){"limitCallbacks"in i&&(_limitCallbacks=!!i.limitCallbacks);var n=i.syncInterval;n&&clearInterval(_syncInterval)||(_syncInterval=n)&&setInterval(_sync,n),"ignoreMobileResize"in i&&(_ignoreMobileResize=r.isTouch===1&&i.ignoreMobileResize),"autoRefreshEvents"in i&&(_iterateAutoRefresh(_removeListener)||_iterateAutoRefresh(_addListener,i.autoRefreshEvents||"none"),_ignoreResize=(i.autoRefreshEvents+"").indexOf("resize")===-1)},r.scrollerProxy=function(i,n){var s=_getTarget$1(i),o=_scrollers.indexOf(s),a=_isViewport(s);~o&&_scrollers.splice(o,a?6:2),n&&(a?_proxies.unshift(_win,n,_body,n,_docEl,n):_proxies.unshift(s,n))},r.clearMatchMedia=function(i){_triggers.forEach(function(n){return n._ctx&&n._ctx.query===i&&n._ctx.kill(!0,!0)})},r.isInViewport=function(i,n,s){var o=(_isString(i)?_getTarget$1(i):i).getBoundingClientRect(),a=o[s?_width:_height]*n||0;return s?o.right-a>0&&o.left+a<_win.innerWidth:o.bottom-a>0&&o.top+a<_win.innerHeight},r.positionInViewport=function(i,n,s){_isString(i)&&(i=_getTarget$1(i));var o=i.getBoundingClientRect(),a=o[s?_width:_height],l=n==null?a/2:n in _keywords?_keywords[n]*a:~n.indexOf("%")?parseFloat(n)*a/100:parseFloat(n)||0;return s?(o.left+l)/_win.innerWidth:(o.top+l)/_win.innerHeight},r.killAll=function(i){if(_triggers.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),i!==!0){var n=_listeners.killAll||[];_listeners={},n.forEach(function(s){return s()})}},r}();ScrollTrigger.version="3.13.0";ScrollTrigger.saveStyles=function(r){return r?_toArray(r).forEach(function(e){if(e&&e.style){var t=_savedStyles.indexOf(e);t>=0&&_savedStyles.splice(t,5),_savedStyles.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),gsap$1.core.getCache(e),_context())}}):_savedStyles};ScrollTrigger.revert=function(r,e){return _revertAll(!r,e)};ScrollTrigger.create=function(r,e){return new ScrollTrigger(r,e)};ScrollTrigger.refresh=function(r){return r?_onResize(!0):(_coreInitted||ScrollTrigger.register())&&_refreshAll(!0)};ScrollTrigger.update=function(r){return++_scrollers.cache&&_updateAll(r===!0?2:0)};ScrollTrigger.clearScrollMemory=_clearScrollMemory;ScrollTrigger.maxScroll=function(r,e){return _maxScroll(r,e?_horizontal:_vertical)};ScrollTrigger.getScrollFunc=function(r,e){return _getScrollFunc(_getTarget$1(r),e?_horizontal:_vertical)};ScrollTrigger.getById=function(r){return _ids[r]};ScrollTrigger.getAll=function(){return _triggers.filter(function(r){return r.vars.id!=="ScrollSmoother"})};ScrollTrigger.isScrolling=function(){return!!_lastScrollTime};ScrollTrigger.snapDirectional=_snapDirectional;ScrollTrigger.addEventListener=function(r,e){var t=_listeners[r]||(_listeners[r]=[]);~t.indexOf(e)||t.push(e)};ScrollTrigger.removeEventListener=function(r,e){var t=_listeners[r],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};ScrollTrigger.batch=function(r,e){var t=[],i={},n=e.interval||.016,s=e.batchMax||1e9,o=function(h,u){var g=[],m=[],_=gsap$1.delayedCall(n,function(){u(g,m),g=[],m=[]}).pause();return function(b){g.length||_.restart(!0),g.push(b.trigger),m.push(b),s<=g.length&&_.progress(1)}},a;for(a in e)i[a]=a.substr(0,2)==="on"&&_isFunction(e[a])&&a!=="onRefreshInit"?o(a,e[a]):e[a];return _isFunction(s)&&(s=s(),_addListener(ScrollTrigger,"refresh",function(){return s=e.batchMax()})),_toArray(r).forEach(function(l){var h={};for(a in i)h[a]=i[a];h.trigger=l,t.push(ScrollTrigger.create(h))}),t};var _clampScrollAndGetDurationMultiplier=function(e,t,i,n){return t>n?e(n):t<0&&e(0),i>n?(n-t)/(i-t):i<0?t/(t-i):1},_allowNativePanning=function r(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Observer.isTouch?" pinch-zoom":""):"none",e===_docEl&&r(_body,t)},_overflow={auto:1,scroll:1},_nestedScroll=function(e){var t=e.event,i=e.target,n=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,o=s._gsap||gsap$1.core.getCache(s),a=_getTime(),l;if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s!==_body&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(_overflow[(l=_getComputedStyle(s)).overflowY]||_overflow[l.overflowX]));)s=s.parentNode;o._isScroll=s&&s!==i&&!_isViewport(s)&&(_overflow[(l=_getComputedStyle(s)).overflowY]||_overflow[l.overflowX]),o._isScrollT=a}(o._isScroll||n==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},_inputObserver=function(e,t,i,n){return Observer.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:n=n&&_nestedScroll,onPress:n,onDrag:n,onScroll:n,onEnable:function(){return i&&_addListener(_doc,Observer.eventTypes[0],_captureInputs,!1,!0)},onDisable:function(){return _removeListener(_doc,Observer.eventTypes[0],_captureInputs,!0)}})},_inputExp=/(input|label|select|textarea)/i,_inputIsFocused,_captureInputs=function(e){var t=_inputExp.test(e.target.tagName);(t||_inputIsFocused)&&(e._gsapAllow=!0,_inputIsFocused=t)},_getScrollNormalizer=function(e){_isObject(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,i=t.normalizeScrollX,n=t.momentum,s=t.allowNestedScroll,o=t.onRelease,a,l,h=_getTarget$1(e.target)||_docEl,u=gsap$1.core.globals().ScrollSmoother,g=u&&u.get(),m=_fixIOSBug&&(e.content&&_getTarget$1(e.content)||g&&e.content!==!1&&!g.smooth()&&g.content()),_=_getScrollFunc(h,_vertical),b=_getScrollFunc(h,_horizontal),d=1,c=(Observer.isTouch&&_win.visualViewport?_win.visualViewport.scale*_win.visualViewport.width:_win.outerWidth)/_win.innerWidth,f=0,v=_isFunction(n)?function(){return n(a)}:function(){return n||2.8},y,D,E=_inputObserver(h,e.type,!0,s),p=function(){return D=!1},x=_passThrough,w=_passThrough,C=function(){l=_maxScroll(h,_vertical),w=_clamp(_fixIOSBug?1:0,l),i&&(x=_clamp(0,_maxScroll(h,_horizontal))),y=_refreshID},S=function(){m._gsap.y=_round(parseFloat(m._gsap.y)+_.offset)+"px",m.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(m._gsap.y)+", 0, 1)",_.offset=_.cacheID=0},A=function(){if(D){requestAnimationFrame(p);var U=_round(a.deltaY/2),W=w(_.v-U);if(m&&W!==_.v+_.offset){_.offset=W-_.v;var R=_round((parseFloat(m&&m._gsap.y)||0)-_.offset);m.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+R+", 0, 1)",m._gsap.y=R+"px",_.cacheID=_scrollers.cache,_updateAll()}return!0}_.offset&&S(),D=!0},P,O,F,I,B=function(){C(),P.isActive()&&P.vars.scrollY>l&&(_()>l?P.progress(1)&&_(l):P.resetTo("scrollY",l))};return m&&gsap$1.set(m,{y:"+=0"}),e.ignoreCheck=function(k){return _fixIOSBug&&k.type==="touchmove"&&A()||d>1.05&&k.type!=="touchstart"||a.isGesturing||k.touches&&k.touches.length>1},e.onPress=function(){D=!1;var k=d;d=_round((_win.visualViewport&&_win.visualViewport.scale||1)/c),P.pause(),k!==d&&_allowNativePanning(h,d>1.01?!0:i?!1:"x"),O=b(),F=_(),C(),y=_refreshID},e.onRelease=e.onGestureStart=function(k,U){if(_.offset&&S(),!U)I.restart(!0);else{_scrollers.cache++;var W=v(),R,z;i&&(R=b(),z=R+W*.05*-k.velocityX/.227,W*=_clampScrollAndGetDurationMultiplier(b,R,z,_maxScroll(h,_horizontal)),P.vars.scrollX=x(z)),R=_(),z=R+W*.05*-k.velocityY/.227,W*=_clampScrollAndGetDurationMultiplier(_,R,z,_maxScroll(h,_vertical)),P.vars.scrollY=w(z),P.invalidate().duration(W).play(.01),(_fixIOSBug&&P.vars.scrollY>=l||R>=l-1)&&gsap$1.to({},{onUpdate:B,duration:W})}o&&o(k)},e.onWheel=function(){P._ts&&P.pause(),_getTime()-f>1e3&&(y=0,f=_getTime())},e.onChange=function(k,U,W,R,z){if(_refreshID!==y&&C(),U&&i&&b(x(R[2]===U?O+(k.startX-k.x):b()+U-R[1])),W){_.offset&&S();var V=z[2]===W,q=V?F+k.startY-k.y:_()+W-z[1],Q=w(q);V&&q!==Q&&(F+=Q-q),_(Q)}(W||U)&&_updateAll()},e.onEnable=function(){_allowNativePanning(h,i?!1:"x"),ScrollTrigger.addEventListener("refresh",B),_addListener(_win,"resize",B),_.smooth&&(_.target.style.scrollBehavior="auto",_.smooth=b.smooth=!1),E.enable()},e.onDisable=function(){_allowNativePanning(h,!0),_removeListener(_win,"resize",B),ScrollTrigger.removeEventListener("refresh",B),E.kill()},e.lockAxis=e.lockAxis!==!1,a=new Observer(e),a.iOS=_fixIOSBug,_fixIOSBug&&!_()&&_(1),_fixIOSBug&&gsap$1.ticker.add(_passThrough),I=a._dc,P=gsap$1.to(a,{ease:"power4",paused:!0,inherit:!1,scrollX:i?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:_interruptionTracker(_,_(),function(){return P.pause()})},onUpdate:_updateAll,onComplete:I.vars.onComplete}),a};ScrollTrigger.sort=function(r){if(_isFunction(r))return _triggers.sort(r);var e=_win.pageYOffset||0;return ScrollTrigger.getAll().forEach(function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+_win.innerHeight}),_triggers.sort(r||function(t,i){return(t.vars.refreshPriority||0)*-1e6+(t.vars.containerAnimation?1e6:t._sortY)-((i.vars.containerAnimation?1e6:i._sortY)+(i.vars.refreshPriority||0)*-1e6)})};ScrollTrigger.observe=function(r){return new Observer(r)};ScrollTrigger.normalizeScroll=function(r){if(typeof r>"u")return _normalizer;if(r===!0&&_normalizer)return _normalizer.enable();if(r===!1){_normalizer&&_normalizer.kill(),_normalizer=r;return}var e=r instanceof Observer?r:_getScrollNormalizer(r);return _normalizer&&_normalizer.target===e.target&&_normalizer.kill(),_isViewport(e.target)&&(_normalizer=e),e};ScrollTrigger.core={_getVelocityProp,_inputObserver,_scrollers,_proxies,bridge:{ss:function(){_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime()},ref:function(){return _refreshing}}};_getGSAP$1()&&gsap$1.registerPlugin(ScrollTrigger);/*!
 * strings: 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _trimExp=/(?:^\s+|\s+$)/g,emojiExp=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2642\u2640]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDD27\uDCBC\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCC\uDFCB]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;function getText(r){var e=r.nodeType,t="";if(e===1||e===9||e===11){if(typeof r.textContent=="string")return r.textContent;for(r=r.firstChild;r;r=r.nextSibling)t+=getText(r)}else if(e===3||e===4)return r.nodeValue;return t}function splitInnerHTML(r,e,t,i,n){for(var s=r.firstChild,o=[],a;s;)s.nodeType===3?(a=(s.nodeValue+"").replace(/^\n+/g,""),i||(a=a.replace(/\s+/g," ")),o.push.apply(o,emojiSafeSplit(a,e,t,i,n))):(s.nodeName+"").toLowerCase()==="br"?o[o.length-1]+="<br>":o.push(s.outerHTML),s=s.nextSibling;if(!n)for(a=o.length;a--;)o[a]==="&"&&o.splice(a,1,"&amp;");return o}function emojiSafeSplit(r,e,t,i,n){if(r+="",t&&(r=r.trim?r.trim():r.replace(_trimExp,"")),e&&e!=="")return r.replace(/>/g,"&gt;").replace(/</g,"&lt;").split(e);for(var s=[],o=r.length,a=0,l,h;a<o;a++)h=r.charAt(a),(h.charCodeAt(0)>=55296&&h.charCodeAt(0)<=56319||r.charCodeAt(a+1)>=65024&&r.charCodeAt(a+1)<=65039)&&(l=((r.substr(a,12).split(emojiExp)||[])[1]||"").length||2,h=r.substr(a,l),s.emoji=1,a+=l-1),s.push(n?h:h===">"?"&gt;":h==="<"?"&lt;":i&&h===" "&&(r.charAt(a-1)===" "||r.charAt(a+1)===" ")?"&nbsp;":h);return s}/*!
 * TextPlugin 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap,_tempDiv,_getGSAP=function(){return gsap||typeof window<"u"&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap},TextPlugin={version:"3.13.0",name:"text",init:function(e,t,i){typeof t!="object"&&(t={value:t});var n=e.nodeName.toUpperCase(),s=this,o=t,a=o.newClass,l=o.oldClass,h=o.preserveSpaces,u=o.rtl,g=s.delimiter=t.delimiter||"",m=s.fillChar=t.fillChar||(t.padSpace?"&nbsp;":""),_,b,d,c,f,v,y,D;if(s.svg=e.getBBox&&(n==="TEXT"||n==="TSPAN"),!("innerHTML"in e)&&!s.svg)return!1;if(s.target=e,!("value"in t)){s.text=s.original=[""];return}for(d=splitInnerHTML(e,g,!1,h,s.svg),_tempDiv||(_tempDiv=document.createElement("div")),_tempDiv.innerHTML=t.value,b=splitInnerHTML(_tempDiv,g,!1,h,s.svg),s.from=i._from,(s.from||u)&&!(u&&s.from)&&(n=d,d=b,b=n),s.hasClass=!!(a||l),s.newClass=u?l:a,s.oldClass=u?a:l,n=d.length-b.length,_=n<0?d:b,n<0&&(n=-n);--n>-1;)_.push(m);if(t.type==="diff"){for(c=0,f=[],v=[],y="",n=0;n<b.length;n++)D=b[n],D===d[n]?y+=D:(f[c]=y+D,v[c++]=y+d[n],y="");b=f,d=v,y&&(b.push(y),d.push(y))}t.speed&&i.duration(Math.min(.05/t.speed*_.length,t.maxDuration||9999)),s.rtl=u,s.original=d,s.text=b,s._props.push("text")},render:function(e,t){e>1?e=1:e<0&&(e=0),t.from&&(e=1-e);var i=t.text,n=t.hasClass,s=t.newClass,o=t.oldClass,a=t.delimiter,l=t.target,h=t.fillChar,u=t.original,g=t.rtl,m=i.length,_=(g?1-e:e)*m+.5|0,b,d,c;n&&e?(b=s&&_,d=o&&_!==m,c=(b?"<span class='"+s+"'>":"")+i.slice(0,_).join(a)+(b?"</span>":"")+(d?"<span class='"+o+"'>":"")+a+u.slice(_).join(a)+(d?"</span>":"")):c=i.slice(0,_).join(a)+a+u.slice(_).join(a),t.svg?l.textContent=c:l.innerHTML=h==="&nbsp;"&&~c.indexOf("  ")?c.split("  ").join("&nbsp;&nbsp;"):c}};TextPlugin.splitInnerHTML=splitInnerHTML;TextPlugin.emojiSafeSplit=emojiSafeSplit;TextPlugin.getText=getText;_getGSAP()&&gsap.registerPlugin(TextPlugin);var _3Dmol$1={exports:{}};/*!
 * 3dmol v2.5.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */var _3Dmol=_3Dmol$1.exports,hasRequired_3Dmol;function require_3Dmol(){return hasRequired_3Dmol||(hasRequired_3Dmol=1,function(module,exports){(function(e,t){module.exports=t()})(_3Dmol,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":(r,e,t)=>{t.r(e),t.d(e,{IOBuffer:()=>a});var i=t("./node_modules/iobuffer/lib-esm/text.js");const n=1024*8,s=(()=>{const l=new Uint8Array(4),h=new Uint32Array(l.buffer);return!((h[0]=1)&l[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(h=n,u={}){$e(this,"buffer");$e(this,"byteLength");$e(this,"byteOffset");$e(this,"length");$e(this,"offset");$e(this,"lastWrittenByte");$e(this,"littleEndian");$e(this,"_data");$e(this,"_mark");$e(this,"_marks");let g=!1;typeof h=="number"?h=new ArrayBuffer(h):(g=!0,this.lastWrittenByte=h.byteLength);const m=u.offset?u.offset>>>0:0,_=h.byteLength-m;let b=m;(ArrayBuffer.isView(h)||h instanceof a)&&(h.byteLength!==h.buffer.byteLength&&(b=h.byteOffset+m),h=h.buffer),g?this.lastWrittenByte=_:this.lastWrittenByte=0,this.buffer=h,this.length=_,this.byteLength=_,this.byteOffset=b,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,b,_),this._mark=0,this._marks=[]}available(h=1){return this.offset+h<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(h=1){return this.offset+=h,this}back(h=1){return this.offset-=h,this}seek(h){return this.offset=h,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const h=this._marks.pop();if(h===void 0)throw new Error("Mark stack empty");return this.seek(h),this}rewind(){return this.offset=0,this}ensureAvailable(h=1){if(!this.available(h)){const g=(this.offset+h)*2,m=new Uint8Array(g);m.set(new Uint8Array(this.buffer)),this.buffer=m.buffer,this.length=g,this.byteLength=g,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(h=1){return this.readArray(h,"uint8")}readArray(h,u){const g=o[u].BYTES_PER_ELEMENT*h,m=this.byteOffset+this.offset,_=this.buffer.slice(m,m+g);if(this.littleEndian===s&&u!=="uint8"&&u!=="int8"){const d=new Uint8Array(this.buffer.slice(m,m+g));d.reverse();const c=new o[u](d.buffer);return this.offset+=g,c.reverse(),c}const b=new o[u](_);return this.offset+=g,b}readInt16(){const h=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,h}readUint16(){const h=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,h}readInt32(){const h=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,h}readUint32(){const h=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,h}readFloat32(){const h=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,h}readFloat64(){const h=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,h}readBigInt64(){const h=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,h}readBigUint64(){const h=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,h}readChar(){return String.fromCharCode(this.readInt8())}readChars(h=1){let u="";for(let g=0;g<h;g++)u+=this.readChar();return u}readUtf8(h=1){return(0,i.decode)(this.readBytes(h))}decodeText(h=1,u="utf8"){return(0,i.decode)(this.readBytes(h),u)}writeBoolean(h){return this.writeUint8(h?255:0),this}writeInt8(h){return this.ensureAvailable(1),this._data.setInt8(this.offset++,h),this._updateLastWrittenByte(),this}writeUint8(h){return this.ensureAvailable(1),this._data.setUint8(this.offset++,h),this._updateLastWrittenByte(),this}writeByte(h){return this.writeUint8(h)}writeBytes(h){this.ensureAvailable(h.length);for(let u=0;u<h.length;u++)this._data.setUint8(this.offset++,h[u]);return this._updateLastWrittenByte(),this}writeInt16(h){return this.ensureAvailable(2),this._data.setInt16(this.offset,h,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(h){return this.ensureAvailable(2),this._data.setUint16(this.offset,h,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(h){return this.ensureAvailable(4),this._data.setInt32(this.offset,h,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(h){return this.ensureAvailable(4),this._data.setUint32(this.offset,h,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(h){return this.ensureAvailable(4),this._data.setFloat32(this.offset,h,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(h){return this.ensureAvailable(8),this._data.setFloat64(this.offset,h,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(h){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,h,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(h){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,h,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(h){return this.writeUint8(h.charCodeAt(0))}writeChars(h){for(let u=0;u<h.length;u++)this.writeUint8(h.charCodeAt(u));return this}writeUtf8(h){return this.writeBytes((0,i.encode)(h))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},"./node_modules/iobuffer/lib-esm/text.js":(r,e,t)=>{t.r(e),t.d(e,{decode:()=>i,encode:()=>s});function i(o,a="utf8"){return new TextDecoder(a).decode(o)}const n=new TextEncoder;function s(o){return n.encode(o)}},"./node_modules/netcdfjs/lib-esm/data.js":(r,e,t)=>{t.r(e),t.d(e,{nonRecord:()=>n,record:()=>s});var i=t("./node_modules/netcdfjs/lib-esm/types.js");function n(o,a){const l=(0,i.str2num)(a.type),h=a.size/(0,i.num2bytes)(l),u=new Array(h);for(let g=0;g<h;g++)u[g]=(0,i.readType)(o,l,1);return u}function s(o,a,l){const h=(0,i.str2num)(a.type),u=a.size?a.size/(0,i.num2bytes)(h):1,g=l.length,m=new Array(g),_=l.recordStep;if(_)for(let b=0;b<g;b++){const d=o.offset;m[b]=(0,i.readType)(o,h,u),o.seek(d+_)}else throw new Error("recordDimension.recordStep is undefined");return m}},"./node_modules/netcdfjs/lib-esm/header.js":(r,e,t)=>{t.r(e),t.d(e,{header:()=>u});var i=t("./node_modules/netcdfjs/lib-esm/types.js"),n=t("./node_modules/netcdfjs/lib-esm/utils.js");const s=0,o=10,a=11,l=12,h=0;function u(b,d){const c={version:d},f={length:b.readUint32()},v=g(b);Array.isArray(v)||(f.id=v.recordId,f.name=v.recordName,c.dimensions=v.dimensions),c.globalAttributes=m(b);const y=_(b,f==null?void 0:f.id,d);return Array.isArray(y)||(c.variables=y.variables,f.recordStep=y.recordStep),c.recordDimension=f,c}function g(b){const d={};let c,f;const v=b.readUint32();let y;if(v===s)return(0,n.notNetcdf)(b.readUint32()!==s,"wrong empty tag for list of dimensions"),[];{(0,n.notNetcdf)(v!==o,"wrong tag for list of dimensions");const D=b.readUint32();y=new Array(D);for(let E=0;E<D;E++){const p=(0,n.readName)(b),x=b.readUint32();x===h&&(c=E,f=p),y[E]={name:p,size:x}}}return c!==void 0&&(d.recordId=c),f!==void 0&&(d.recordName=f),d.dimensions=y,d}function m(b){const d=b.readUint32();let c;if(d===s)return(0,n.notNetcdf)(b.readUint32()!==s,"wrong empty tag for list of attributes"),[];{(0,n.notNetcdf)(d!==l,"wrong tag for list of attributes");const f=b.readUint32();c=new Array(f);for(let v=0;v<f;v++){const y=(0,n.readName)(b),D=b.readUint32();(0,n.notNetcdf)(D<1||D>6,`non valid type ${D}`);const E=b.readUint32(),p=(0,i.readType)(b,D,E);(0,n.padding)(b),c[v]={name:y,type:(0,i.num2str)(D),value:p}}}return c}function _(b,d,c){const f=b.readUint32();let v=0,y;if(f===s)return(0,n.notNetcdf)(b.readUint32()!==s,"wrong empty tag for list of variables"),[];{(0,n.notNetcdf)(f!==a,"wrong tag for list of variables");const D=b.readUint32();y=new Array(D);for(let E=0;E<D;E++){const p=(0,n.readName)(b),x=b.readUint32(),w=new Array(x);for(let F=0;F<x;F++)w[F]=b.readUint32();const C=m(b),S=b.readUint32();(0,n.notNetcdf)(S<1&&S>6,`non valid type ${S}`);const A=b.readUint32();let P=b.readUint32();c===2&&((0,n.notNetcdf)(P>0,"offsets larger than 4GB not supported"),P=b.readUint32());let O=!1;typeof d<"u"&&w[0]===d&&(v+=A,O=!0),y[E]={name:p,dimensions:w,attributes:C,type:(0,i.num2str)(S),size:A,offset:P,record:O}}}return{variables:y,recordStep:v}}},"./node_modules/netcdfjs/lib-esm/index.js":(r,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>i.NetCDFReader});var i=t("./node_modules/netcdfjs/lib-esm/parser.js")},"./node_modules/netcdfjs/lib-esm/parser.js":(r,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>l});var i=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),n=t("./node_modules/netcdfjs/lib-esm/data.js"),s=t("./node_modules/netcdfjs/lib-esm/header.js"),o=t("./node_modules/netcdfjs/lib-esm/toString.js"),a=t("./node_modules/netcdfjs/lib-esm/utils.js");class l{constructor(u){this.toString=o.toString;const g=new i.IOBuffer(u);g.setBigEndian(),(0,a.notNetcdf)(g.readChars(3)!=="CDF","should start with CDF");const m=g.readByte();(0,a.notNetcdf)(m>2,"unknown version"),this.header=(0,s.header)(g,m),this.buffer=g}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(u){const g=this.globalAttributes.find(m=>m.name===u);return g?g.value:null}getDataVariableAsString(u){const g=this.getDataVariable(u);return g?g.join(""):null}get variables(){return this.header.variables}getDataVariable(u){let g;if(typeof u=="string"?g=this.header.variables.find(m=>m.name===u):g=u,g===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(g.offset),g.record?(0,n.record)(this.buffer,g,this.header.recordDimension):(0,n.nonRecord)(this.buffer,g)}dataVariableExists(u){return this.header.variables.find(m=>m.name===u)!==void 0}attributeExists(u){return this.globalAttributes.find(m=>m.name===u)!==void 0}}},"./node_modules/netcdfjs/lib-esm/toString.js":(r,e,t)=>{t.r(e),t.d(e,{toString:()=>i});function i(){const n=[];n.push("DIMENSIONS");for(const o of this.dimensions)n.push(`  ${o.name.padEnd(30)} = size: ${o.size}`);n.push(""),n.push("GLOBAL ATTRIBUTES");for(const o of this.globalAttributes)n.push(`  ${o.name.padEnd(30)} = ${o.value}`);const s=JSON.parse(JSON.stringify(this.variables));n.push(""),n.push("VARIABLES:");for(const o of s){o.value=this.getDataVariable(o);let a=JSON.stringify(o.value);a.length>50&&(a=a.substring(0,50)),isNaN(o.value.length)||(a+=` (length: ${o.value.length})`),n.push(`  ${o.name.padEnd(30)} = ${a}`)}return n.join(`
`)}},"./node_modules/netcdfjs/lib-esm/types.js":(r,e,t)=>{t.r(e),t.d(e,{num2bytes:()=>s,num2str:()=>n,readType:()=>l,str2num:()=>o});const i={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function n(u){switch(Number(u)){case i.BYTE:return"byte";case i.CHAR:return"char";case i.SHORT:return"short";case i.INT:return"int";case i.FLOAT:return"float";case i.DOUBLE:return"double";default:return"undefined"}}function s(u){switch(Number(u)){case i.BYTE:return 1;case i.CHAR:return 1;case i.SHORT:return 2;case i.INT:return 4;case i.FLOAT:return 4;case i.DOUBLE:return 8;default:return-1}}function o(u){switch(String(u)){case"byte":return i.BYTE;case"char":return i.CHAR;case"short":return i.SHORT;case"int":return i.INT;case"float":return i.FLOAT;case"double":return i.DOUBLE;default:return-1}}function a(u,g){if(u!==1){const m=new Array(u);for(let _=0;_<u;_++)m[_]=g();return m}else return g()}function l(u,g,m){switch(g){case i.BYTE:return Array.from(u.readBytes(m));case i.CHAR:return h(u.readChars(m));case i.SHORT:return a(m,u.readInt16.bind(u));case i.INT:return a(m,u.readInt32.bind(u));case i.FLOAT:return a(m,u.readFloat32.bind(u));case i.DOUBLE:return a(m,u.readFloat64.bind(u));default:throw new Error(`non valid type ${g}`)}}function h(u){return u.charCodeAt(u.length-1)===0?u.substring(0,u.length-1):u}},"./node_modules/netcdfjs/lib-esm/utils.js":(r,e,t)=>{t.r(e),t.d(e,{notNetcdf:()=>i,padding:()=>n,readName:()=>s});function i(o,a){if(o)throw new TypeError(`Not a valid NetCDF v3.x file: ${a}`)}function n(o){o.offset%4!==0&&o.skip(4-o.offset%4)}function s(o){const a=o.readUint32(),l=o.readChars(a);return n(o),l}},"./node_modules/pako/dist/pako.esm.mjs":(r,e,t)=>{t.r(e),t.d(e,{Deflate:()=>$n,Inflate:()=>Xn,constants:()=>qn,default:()=>Vs,deflate:()=>jn,deflateRaw:()=>Kn,gzip:()=>Yn,inflate:()=>Zn,inflateRaw:()=>Qn,ungzip:()=>Jn});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const i=4,n=0,s=1,o=2;function a(M){let N=M.length;for(;--N>=0;)M[N]=0}const l=0,h=1,u=2,g=3,m=258,_=29,b=256,d=b+1+_,c=30,f=19,v=2*d+1,y=15,D=16,E=7,p=256,x=16,w=17,C=18,S=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),A=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),P=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F=512,I=new Array((d+2)*2);a(I);const B=new Array(c*2);a(B);const k=new Array(F);a(k);const U=new Array(m-g+1);a(U);const W=new Array(_);a(W);const R=new Array(c);a(R);function z(M,N,T,Y,ee){this.static_tree=M,this.extra_bits=N,this.extra_base=T,this.elems=Y,this.max_length=ee,this.has_stree=M&&M.length}let V,q,Q;function re(M,N){this.dyn_tree=M,this.max_code=0,this.stat_desc=N}const te=M=>M<256?k[M]:k[256+(M>>>7)],ae=(M,N)=>{M.pending_buf[M.pending++]=N&255,M.pending_buf[M.pending++]=N>>>8&255},ne=(M,N,T)=>{M.bi_valid>D-T?(M.bi_buf|=N<<M.bi_valid&65535,ae(M,M.bi_buf),M.bi_buf=N>>D-M.bi_valid,M.bi_valid+=T-D):(M.bi_buf|=N<<M.bi_valid&65535,M.bi_valid+=T)},le=(M,N,T)=>{ne(M,T[N*2],T[N*2+1])},Ee=(M,N)=>{let T=0;do T|=M&1,M>>>=1,T<<=1;while(--N>0);return T>>>1},De=M=>{M.bi_valid===16?(ae(M,M.bi_buf),M.bi_buf=0,M.bi_valid=0):M.bi_valid>=8&&(M.pending_buf[M.pending++]=M.bi_buf&255,M.bi_buf>>=8,M.bi_valid-=8)},Pe=(M,N)=>{const T=N.dyn_tree,Y=N.max_code,ee=N.stat_desc.static_tree,J=N.stat_desc.has_stree,Me=N.stat_desc.extra_bits,xe=N.stat_desc.extra_base,qe=N.stat_desc.max_length;let fe,Se,_t,Qe,Ge,it,St=0;for(Qe=0;Qe<=y;Qe++)M.bl_count[Qe]=0;for(T[M.heap[M.heap_max]*2+1]=0,fe=M.heap_max+1;fe<v;fe++)Se=M.heap[fe],Qe=T[T[Se*2+1]*2+1]+1,Qe>qe&&(Qe=qe,St++),T[Se*2+1]=Qe,!(Se>Y)&&(M.bl_count[Qe]++,Ge=0,Se>=xe&&(Ge=Me[Se-xe]),it=T[Se*2],M.opt_len+=it*(Qe+Ge),J&&(M.static_len+=it*(ee[Se*2+1]+Ge)));if(St!==0){do{for(Qe=qe-1;M.bl_count[Qe]===0;)Qe--;M.bl_count[Qe]--,M.bl_count[Qe+1]+=2,M.bl_count[qe]--,St-=2}while(St>0);for(Qe=qe;Qe!==0;Qe--)for(Se=M.bl_count[Qe];Se!==0;)_t=M.heap[--fe],!(_t>Y)&&(T[_t*2+1]!==Qe&&(M.opt_len+=(Qe-T[_t*2+1])*T[_t*2],T[_t*2+1]=Qe),Se--)}},pe=(M,N,T)=>{const Y=new Array(y+1);let ee=0,J,Me;for(J=1;J<=y;J++)ee=ee+T[J-1]<<1,Y[J]=ee;for(Me=0;Me<=N;Me++){let xe=M[Me*2+1];xe!==0&&(M[Me*2]=Ee(Y[xe]++,xe))}},Z=()=>{let M,N,T,Y,ee;const J=new Array(y+1);for(T=0,Y=0;Y<_-1;Y++)for(W[Y]=T,M=0;M<1<<S[Y];M++)U[T++]=Y;for(U[T-1]=Y,ee=0,Y=0;Y<16;Y++)for(R[Y]=ee,M=0;M<1<<A[Y];M++)k[ee++]=Y;for(ee>>=7;Y<c;Y++)for(R[Y]=ee<<7,M=0;M<1<<A[Y]-7;M++)k[256+ee++]=Y;for(N=0;N<=y;N++)J[N]=0;for(M=0;M<=143;)I[M*2+1]=8,M++,J[8]++;for(;M<=255;)I[M*2+1]=9,M++,J[9]++;for(;M<=279;)I[M*2+1]=7,M++,J[7]++;for(;M<=287;)I[M*2+1]=8,M++,J[8]++;for(pe(I,d+1,J),M=0;M<c;M++)B[M*2+1]=5,B[M*2]=Ee(M,5);V=new z(I,S,b+1,d,y),q=new z(B,A,0,c,y),Q=new z(new Array(0),P,0,f,E)},be=M=>{let N;for(N=0;N<d;N++)M.dyn_ltree[N*2]=0;for(N=0;N<c;N++)M.dyn_dtree[N*2]=0;for(N=0;N<f;N++)M.bl_tree[N*2]=0;M.dyn_ltree[p*2]=1,M.opt_len=M.static_len=0,M.sym_next=M.matches=0},Ce=M=>{M.bi_valid>8?ae(M,M.bi_buf):M.bi_valid>0&&(M.pending_buf[M.pending++]=M.bi_buf),M.bi_buf=0,M.bi_valid=0},ie=(M,N,T,Y)=>{const ee=N*2,J=T*2;return M[ee]<M[J]||M[ee]===M[J]&&Y[N]<=Y[T]},Ne=(M,N,T)=>{const Y=M.heap[T];let ee=T<<1;for(;ee<=M.heap_len&&(ee<M.heap_len&&ie(N,M.heap[ee+1],M.heap[ee],M.depth)&&ee++,!ie(N,Y,M.heap[ee],M.depth));)M.heap[T]=M.heap[ee],T=ee,ee<<=1;M.heap[T]=Y},Ve=(M,N,T)=>{let Y,ee,J=0,Me,xe;if(M.sym_next!==0)do Y=M.pending_buf[M.sym_buf+J++]&255,Y+=(M.pending_buf[M.sym_buf+J++]&255)<<8,ee=M.pending_buf[M.sym_buf+J++],Y===0?le(M,ee,N):(Me=U[ee],le(M,Me+b+1,N),xe=S[Me],xe!==0&&(ee-=W[Me],ne(M,ee,xe)),Y--,Me=te(Y),le(M,Me,T),xe=A[Me],xe!==0&&(Y-=R[Me],ne(M,Y,xe)));while(J<M.sym_next);le(M,p,N)},Ue=(M,N)=>{const T=N.dyn_tree,Y=N.stat_desc.static_tree,ee=N.stat_desc.has_stree,J=N.stat_desc.elems;let Me,xe,qe=-1,fe;for(M.heap_len=0,M.heap_max=v,Me=0;Me<J;Me++)T[Me*2]!==0?(M.heap[++M.heap_len]=qe=Me,M.depth[Me]=0):T[Me*2+1]=0;for(;M.heap_len<2;)fe=M.heap[++M.heap_len]=qe<2?++qe:0,T[fe*2]=1,M.depth[fe]=0,M.opt_len--,ee&&(M.static_len-=Y[fe*2+1]);for(N.max_code=qe,Me=M.heap_len>>1;Me>=1;Me--)Ne(M,T,Me);fe=J;do Me=M.heap[1],M.heap[1]=M.heap[M.heap_len--],Ne(M,T,1),xe=M.heap[1],M.heap[--M.heap_max]=Me,M.heap[--M.heap_max]=xe,T[fe*2]=T[Me*2]+T[xe*2],M.depth[fe]=(M.depth[Me]>=M.depth[xe]?M.depth[Me]:M.depth[xe])+1,T[Me*2+1]=T[xe*2+1]=fe,M.heap[1]=fe++,Ne(M,T,1);while(M.heap_len>=2);M.heap[--M.heap_max]=M.heap[1],Pe(M,N),pe(T,qe,M.bl_count)},Fe=(M,N,T)=>{let Y,ee=-1,J,Me=N[0*2+1],xe=0,qe=7,fe=4;for(Me===0&&(qe=138,fe=3),N[(T+1)*2+1]=65535,Y=0;Y<=T;Y++)J=Me,Me=N[(Y+1)*2+1],!(++xe<qe&&J===Me)&&(xe<fe?M.bl_tree[J*2]+=xe:J!==0?(J!==ee&&M.bl_tree[J*2]++,M.bl_tree[x*2]++):xe<=10?M.bl_tree[w*2]++:M.bl_tree[C*2]++,xe=0,ee=J,Me===0?(qe=138,fe=3):J===Me?(qe=6,fe=3):(qe=7,fe=4))},ze=(M,N,T)=>{let Y,ee=-1,J,Me=N[0*2+1],xe=0,qe=7,fe=4;for(Me===0&&(qe=138,fe=3),Y=0;Y<=T;Y++)if(J=Me,Me=N[(Y+1)*2+1],!(++xe<qe&&J===Me)){if(xe<fe)do le(M,J,M.bl_tree);while(--xe!==0);else J!==0?(J!==ee&&(le(M,J,M.bl_tree),xe--),le(M,x,M.bl_tree),ne(M,xe-3,2)):xe<=10?(le(M,w,M.bl_tree),ne(M,xe-3,3)):(le(M,C,M.bl_tree),ne(M,xe-11,7));xe=0,ee=J,Me===0?(qe=138,fe=3):J===Me?(qe=6,fe=3):(qe=7,fe=4)}},Re=M=>{let N;for(Fe(M,M.dyn_ltree,M.l_desc.max_code),Fe(M,M.dyn_dtree,M.d_desc.max_code),Ue(M,M.bl_desc),N=f-1;N>=3&&M.bl_tree[O[N]*2+1]===0;N--);return M.opt_len+=3*(N+1)+5+5+4,N},Le=(M,N,T,Y)=>{let ee;for(ne(M,N-257,5),ne(M,T-1,5),ne(M,Y-4,4),ee=0;ee<Y;ee++)ne(M,M.bl_tree[O[ee]*2+1],3);ze(M,M.dyn_ltree,N-1),ze(M,M.dyn_dtree,T-1)},We=M=>{let N=4093624447,T;for(T=0;T<=31;T++,N>>>=1)if(N&1&&M.dyn_ltree[T*2]!==0)return n;if(M.dyn_ltree[9*2]!==0||M.dyn_ltree[10*2]!==0||M.dyn_ltree[13*2]!==0)return s;for(T=32;T<b;T++)if(M.dyn_ltree[T*2]!==0)return s;return n};let He=!1;const H=M=>{He||(Z(),He=!0),M.l_desc=new re(M.dyn_ltree,V),M.d_desc=new re(M.dyn_dtree,q),M.bl_desc=new re(M.bl_tree,Q),M.bi_buf=0,M.bi_valid=0,be(M)},K=(M,N,T,Y)=>{ne(M,(l<<1)+(Y?1:0),3),Ce(M),ae(M,T),ae(M,~T),T&&M.pending_buf.set(M.window.subarray(N,N+T),M.pending),M.pending+=T},X=M=>{ne(M,h<<1,3),le(M,p,I),De(M)},_e=(M,N,T,Y)=>{let ee,J,Me=0;M.level>0?(M.strm.data_type===o&&(M.strm.data_type=We(M)),Ue(M,M.l_desc),Ue(M,M.d_desc),Me=Re(M),ee=M.opt_len+3+7>>>3,J=M.static_len+3+7>>>3,J<=ee&&(ee=J)):ee=J=T+5,T+4<=ee&&N!==-1?K(M,N,T,Y):M.strategy===i||J===ee?(ne(M,(h<<1)+(Y?1:0),3),Ve(M,I,B)):(ne(M,(u<<1)+(Y?1:0),3),Le(M,M.l_desc.max_code+1,M.d_desc.max_code+1,Me+1),Ve(M,M.dyn_ltree,M.dyn_dtree)),be(M),Y&&Ce(M)},ue=(M,N,T)=>(M.pending_buf[M.sym_buf+M.sym_next++]=N,M.pending_buf[M.sym_buf+M.sym_next++]=N>>8,M.pending_buf[M.sym_buf+M.sym_next++]=T,N===0?M.dyn_ltree[T*2]++:(M.matches++,N--,M.dyn_ltree[(U[T]+b+1)*2]++,M.dyn_dtree[te(N)*2]++),M.sym_next===M.sym_end);var ye=H,Ae=K,G=_e,ce=ue,ve=X,Oe={_tr_init:ye,_tr_stored_block:Ae,_tr_flush_block:G,_tr_tally:ce,_tr_align:ve},me=(M,N,T,Y)=>{let ee=M&65535|0,J=M>>>16&65535|0,Me=0;for(;T!==0;){Me=T>2e3?2e3:T,T-=Me;do ee=ee+N[Y++]|0,J=J+ee|0;while(--Me);ee%=65521,J%=65521}return ee|J<<16|0};const $=()=>{let M,N=[];for(var T=0;T<256;T++){M=T;for(var Y=0;Y<8;Y++)M=M&1?3988292384^M>>>1:M>>>1;N[T]=M}return N},Te=new Uint32Array($());var L=(M,N,T,Y)=>{const ee=Te,J=Y+T;M^=-1;for(let Me=Y;Me<J;Me++)M=M>>>8^ee[(M^N[Me])&255];return M^-1},ge={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},de={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:j,_tr_stored_block:se,_tr_flush_block:he,_tr_tally:Ie,_tr_align:Be}=Oe,{Z_NO_FLUSH:we,Z_PARTIAL_FLUSH:je,Z_FULL_FLUSH:Xe,Z_FINISH:Ke,Z_BLOCK:Je,Z_OK:Ye,Z_STREAM_END:rt,Z_STREAM_ERROR:st,Z_DATA_ERROR:pt,Z_BUF_ERROR:ut,Z_DEFAULT_COMPRESSION:et,Z_FILTERED:ct,Z_HUFFMAN_ONLY:tt,Z_RLE:xt,Z_FIXED:Dt,Z_DEFAULT_STRATEGY:wt,Z_UNKNOWN:At,Z_DEFLATED:Et}=de,zt=9,Nt=15,Tt=8,jt=256+1+29,bi=30,Kt=19,kt=2*jt+1,Yt=15,at=3,Ot=258,Ut=Ot+at+1,tr=32,ti=42,Pi=57,Oi=69,Li=73,Ri=91,Ii=103,Xt=113,ai=666,Rt=1,ii=2,Zt=3,ni=4,ir=3,Qt=(M,N)=>(M.msg=ge[N],N),Ki=M=>M*2-(M>4?9:0),Ht=M=>{let N=M.length;for(;--N>=0;)M[N]=0},nr=M=>{let N,T,Y,ee=M.w_size;N=M.hash_size,Y=N;do T=M.head[--Y],M.head[Y]=T>=ee?T-ee:0;while(--N);N=ee,Y=N;do T=M.prev[--Y],M.prev[Y]=T>=ee?T-ee:0;while(--N)};let $t=(M,N,T)=>(N<<M.hash_shift^T)&M.hash_mask;const It=M=>{const N=M.state;let T=N.pending;T>M.avail_out&&(T=M.avail_out),T!==0&&(M.output.set(N.pending_buf.subarray(N.pending_out,N.pending_out+T),M.next_out),M.next_out+=T,N.pending_out+=T,M.total_out+=T,M.avail_out-=T,N.pending-=T,N.pending===0&&(N.pending_out=0))},Ft=(M,N)=>{he(M,M.block_start>=0?M.block_start:-1,M.strstart-M.block_start,N),M.block_start=M.strstart,It(M.strm)},mt=(M,N)=>{M.pending_buf[M.pending++]=N},li=(M,N)=>{M.pending_buf[M.pending++]=N>>>8&255,M.pending_buf[M.pending++]=N&255},Fi=(M,N,T,Y)=>{let ee=M.avail_in;return ee>Y&&(ee=Y),ee===0?0:(M.avail_in-=ee,N.set(M.input.subarray(M.next_in,M.next_in+ee),T),M.state.wrap===1?M.adler=me(M.adler,N,ee,T):M.state.wrap===2&&(M.adler=L(M.adler,N,ee,T)),M.next_in+=ee,M.total_in+=ee,ee)},Yi=(M,N)=>{let T=M.max_chain_length,Y=M.strstart,ee,J,Me=M.prev_length,xe=M.nice_match;const qe=M.strstart>M.w_size-Ut?M.strstart-(M.w_size-Ut):0,fe=M.window,Se=M.w_mask,_t=M.prev,Qe=M.strstart+Ot;let Ge=fe[Y+Me-1],it=fe[Y+Me];M.prev_length>=M.good_match&&(T>>=2),xe>M.lookahead&&(xe=M.lookahead);do if(ee=N,!(fe[ee+Me]!==it||fe[ee+Me-1]!==Ge||fe[ee]!==fe[Y]||fe[++ee]!==fe[Y+1])){Y+=2,ee++;do;while(fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&fe[++Y]===fe[++ee]&&Y<Qe);if(J=Ot-(Qe-Y),Y=Qe-Ot,J>Me){if(M.match_start=N,Me=J,J>=xe)break;Ge=fe[Y+Me-1],it=fe[Y+Me]}}while((N=_t[N&Se])>qe&&--T!==0);return Me<=M.lookahead?Me:M.lookahead},ri=M=>{const N=M.w_size;let T,Y,ee;do{if(Y=M.window_size-M.lookahead-M.strstart,M.strstart>=N+(N-Ut)&&(M.window.set(M.window.subarray(N,N+N-Y),0),M.match_start-=N,M.strstart-=N,M.block_start-=N,M.insert>M.strstart&&(M.insert=M.strstart),nr(M),Y+=N),M.strm.avail_in===0)break;if(T=Fi(M.strm,M.window,M.strstart+M.lookahead,Y),M.lookahead+=T,M.lookahead+M.insert>=at)for(ee=M.strstart-M.insert,M.ins_h=M.window[ee],M.ins_h=$t(M,M.ins_h,M.window[ee+1]);M.insert&&(M.ins_h=$t(M,M.ins_h,M.window[ee+at-1]),M.prev[ee&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=ee,ee++,M.insert--,!(M.lookahead+M.insert<at)););}while(M.lookahead<Ut&&M.strm.avail_in!==0)},Xi=(M,N)=>{let T=M.pending_buf_size-5>M.w_size?M.w_size:M.pending_buf_size-5,Y,ee,J,Me=0,xe=M.strm.avail_in;do{if(Y=65535,J=M.bi_valid+42>>3,M.strm.avail_out<J||(J=M.strm.avail_out-J,ee=M.strstart-M.block_start,Y>ee+M.strm.avail_in&&(Y=ee+M.strm.avail_in),Y>J&&(Y=J),Y<T&&(Y===0&&N!==Ke||N===we||Y!==ee+M.strm.avail_in)))break;Me=N===Ke&&Y===ee+M.strm.avail_in?1:0,se(M,0,0,Me),M.pending_buf[M.pending-4]=Y,M.pending_buf[M.pending-3]=Y>>8,M.pending_buf[M.pending-2]=~Y,M.pending_buf[M.pending-1]=~Y>>8,It(M.strm),ee&&(ee>Y&&(ee=Y),M.strm.output.set(M.window.subarray(M.block_start,M.block_start+ee),M.strm.next_out),M.strm.next_out+=ee,M.strm.avail_out-=ee,M.strm.total_out+=ee,M.block_start+=ee,Y-=ee),Y&&(Fi(M.strm,M.strm.output,M.strm.next_out,Y),M.strm.next_out+=Y,M.strm.avail_out-=Y,M.strm.total_out+=Y)}while(Me===0);return xe-=M.strm.avail_in,xe&&(xe>=M.w_size?(M.matches=2,M.window.set(M.strm.input.subarray(M.strm.next_in-M.w_size,M.strm.next_in),0),M.strstart=M.w_size,M.insert=M.strstart):(M.window_size-M.strstart<=xe&&(M.strstart-=M.w_size,M.window.set(M.window.subarray(M.w_size,M.w_size+M.strstart),0),M.matches<2&&M.matches++,M.insert>M.strstart&&(M.insert=M.strstart)),M.window.set(M.strm.input.subarray(M.strm.next_in-xe,M.strm.next_in),M.strstart),M.strstart+=xe,M.insert+=xe>M.w_size-M.insert?M.w_size-M.insert:xe),M.block_start=M.strstart),M.high_water<M.strstart&&(M.high_water=M.strstart),Me?ni:N!==we&&N!==Ke&&M.strm.avail_in===0&&M.strstart===M.block_start?ii:(J=M.window_size-M.strstart,M.strm.avail_in>J&&M.block_start>=M.w_size&&(M.block_start-=M.w_size,M.strstart-=M.w_size,M.window.set(M.window.subarray(M.w_size,M.w_size+M.strstart),0),M.matches<2&&M.matches++,J+=M.w_size,M.insert>M.strstart&&(M.insert=M.strstart)),J>M.strm.avail_in&&(J=M.strm.avail_in),J&&(Fi(M.strm,M.window,M.strstart,J),M.strstart+=J,M.insert+=J>M.w_size-M.insert?M.w_size-M.insert:J),M.high_water<M.strstart&&(M.high_water=M.strstart),J=M.bi_valid+42>>3,J=M.pending_buf_size-J>65535?65535:M.pending_buf_size-J,T=J>M.w_size?M.w_size:J,ee=M.strstart-M.block_start,(ee>=T||(ee||N===Ke)&&N!==we&&M.strm.avail_in===0&&ee<=J)&&(Y=ee>J?J:ee,Me=N===Ke&&M.strm.avail_in===0&&Y===ee?1:0,se(M,M.block_start,Y,Me),M.block_start+=Y,It(M.strm)),Me?Zt:Rt)},zi=(M,N)=>{let T,Y;for(;;){if(M.lookahead<Ut){if(ri(M),M.lookahead<Ut&&N===we)return Rt;if(M.lookahead===0)break}if(T=0,M.lookahead>=at&&(M.ins_h=$t(M,M.ins_h,M.window[M.strstart+at-1]),T=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),T!==0&&M.strstart-T<=M.w_size-Ut&&(M.match_length=Yi(M,T)),M.match_length>=at)if(Y=Ie(M,M.strstart-M.match_start,M.match_length-at),M.lookahead-=M.match_length,M.match_length<=M.max_lazy_match&&M.lookahead>=at){M.match_length--;do M.strstart++,M.ins_h=$t(M,M.ins_h,M.window[M.strstart+at-1]),T=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart;while(--M.match_length!==0);M.strstart++}else M.strstart+=M.match_length,M.match_length=0,M.ins_h=M.window[M.strstart],M.ins_h=$t(M,M.ins_h,M.window[M.strstart+1]);else Y=Ie(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++;if(Y&&(Ft(M,!1),M.strm.avail_out===0))return Rt}return M.insert=M.strstart<at-1?M.strstart:at-1,N===Ke?(Ft(M,!0),M.strm.avail_out===0?Zt:ni):M.sym_next&&(Ft(M,!1),M.strm.avail_out===0)?Rt:ii},si=(M,N)=>{let T,Y,ee;for(;;){if(M.lookahead<Ut){if(ri(M),M.lookahead<Ut&&N===we)return Rt;if(M.lookahead===0)break}if(T=0,M.lookahead>=at&&(M.ins_h=$t(M,M.ins_h,M.window[M.strstart+at-1]),T=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),M.prev_length=M.match_length,M.prev_match=M.match_start,M.match_length=at-1,T!==0&&M.prev_length<M.max_lazy_match&&M.strstart-T<=M.w_size-Ut&&(M.match_length=Yi(M,T),M.match_length<=5&&(M.strategy===ct||M.match_length===at&&M.strstart-M.match_start>4096)&&(M.match_length=at-1)),M.prev_length>=at&&M.match_length<=M.prev_length){ee=M.strstart+M.lookahead-at,Y=Ie(M,M.strstart-1-M.prev_match,M.prev_length-at),M.lookahead-=M.prev_length-1,M.prev_length-=2;do++M.strstart<=ee&&(M.ins_h=$t(M,M.ins_h,M.window[M.strstart+at-1]),T=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart);while(--M.prev_length!==0);if(M.match_available=0,M.match_length=at-1,M.strstart++,Y&&(Ft(M,!1),M.strm.avail_out===0))return Rt}else if(M.match_available){if(Y=Ie(M,0,M.window[M.strstart-1]),Y&&Ft(M,!1),M.strstart++,M.lookahead--,M.strm.avail_out===0)return Rt}else M.match_available=1,M.strstart++,M.lookahead--}return M.match_available&&(Y=Ie(M,0,M.window[M.strstart-1]),M.match_available=0),M.insert=M.strstart<at-1?M.strstart:at-1,N===Ke?(Ft(M,!0),M.strm.avail_out===0?Zt:ni):M.sym_next&&(Ft(M,!1),M.strm.avail_out===0)?Rt:ii},rr=(M,N)=>{let T,Y,ee,J;const Me=M.window;for(;;){if(M.lookahead<=Ot){if(ri(M),M.lookahead<=Ot&&N===we)return Rt;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=at&&M.strstart>0&&(ee=M.strstart-1,Y=Me[ee],Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee])){J=M.strstart+Ot;do;while(Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&Y===Me[++ee]&&ee<J);M.match_length=Ot-(J-ee),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=at?(T=Ie(M,1,M.match_length-at),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(T=Ie(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),T&&(Ft(M,!1),M.strm.avail_out===0))return Rt}return M.insert=0,N===Ke?(Ft(M,!0),M.strm.avail_out===0?Zt:ni):M.sym_next&&(Ft(M,!1),M.strm.avail_out===0)?Rt:ii},sr=(M,N)=>{let T;for(;;){if(M.lookahead===0&&(ri(M),M.lookahead===0)){if(N===we)return Rt;break}if(M.match_length=0,T=Ie(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,T&&(Ft(M,!1),M.strm.avail_out===0))return Rt}return M.insert=0,N===Ke?(Ft(M,!0),M.strm.avail_out===0?Zt:ni):M.sym_next&&(Ft(M,!1),M.strm.avail_out===0)?Rt:ii};function Wt(M,N,T,Y,ee){this.good_length=M,this.max_lazy=N,this.nice_length=T,this.max_chain=Y,this.func=ee}const ci=[new Wt(0,0,0,0,Xi),new Wt(4,4,8,4,zi),new Wt(4,5,16,8,zi),new Wt(4,6,32,32,zi),new Wt(4,4,16,16,si),new Wt(8,16,32,32,si),new Wt(8,16,128,128,si),new Wt(8,32,128,256,si),new Wt(32,128,258,1024,si),new Wt(32,258,258,4096,si)],or=M=>{M.window_size=2*M.w_size,Ht(M.head),M.max_lazy_match=ci[M.level].max_lazy,M.good_match=ci[M.level].good_length,M.nice_match=ci[M.level].nice_length,M.max_chain_length=ci[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=at-1,M.match_available=0,M.ins_h=0};function ar(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Et,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(kt*2),this.dyn_dtree=new Uint16Array((2*bi+1)*2),this.bl_tree=new Uint16Array((2*Kt+1)*2),Ht(this.dyn_ltree),Ht(this.dyn_dtree),Ht(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Yt+1),this.heap=new Uint16Array(2*jt+1),Ht(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*jt+1),Ht(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const hi=M=>{if(!M)return 1;const N=M.state;return!N||N.strm!==M||N.status!==ti&&N.status!==Pi&&N.status!==Oi&&N.status!==Li&&N.status!==Ri&&N.status!==Ii&&N.status!==Xt&&N.status!==ai?1:0},Zi=M=>{if(hi(M))return Qt(M,st);M.total_in=M.total_out=0,M.data_type=At;const N=M.state;return N.pending=0,N.pending_out=0,N.wrap<0&&(N.wrap=-N.wrap),N.status=N.wrap===2?Pi:N.wrap?ti:Xt,M.adler=N.wrap===2?0:1,N.last_flush=-2,j(N),Ye},Qi=M=>{const N=Zi(M);return N===Ye&&or(M.state),N},lr=(M,N)=>hi(M)||M.state.wrap!==2?st:(M.state.gzhead=N,Ye),Ji=(M,N,T,Y,ee,J)=>{if(!M)return st;let Me=1;if(N===et&&(N=6),Y<0?(Me=0,Y=-Y):Y>15&&(Me=2,Y-=16),ee<1||ee>zt||T!==Et||Y<8||Y>15||N<0||N>9||J<0||J>Dt||Y===8&&Me!==1)return Qt(M,st);Y===8&&(Y=9);const xe=new ar;return M.state=xe,xe.strm=M,xe.status=ti,xe.wrap=Me,xe.gzhead=null,xe.w_bits=Y,xe.w_size=1<<xe.w_bits,xe.w_mask=xe.w_size-1,xe.hash_bits=ee+7,xe.hash_size=1<<xe.hash_bits,xe.hash_mask=xe.hash_size-1,xe.hash_shift=~~((xe.hash_bits+at-1)/at),xe.window=new Uint8Array(xe.w_size*2),xe.head=new Uint16Array(xe.hash_size),xe.prev=new Uint16Array(xe.w_size),xe.lit_bufsize=1<<ee+6,xe.pending_buf_size=xe.lit_bufsize*4,xe.pending_buf=new Uint8Array(xe.pending_buf_size),xe.sym_buf=xe.lit_bufsize,xe.sym_end=(xe.lit_bufsize-1)*3,xe.level=N,xe.strategy=J,xe.method=T,Qi(M)},cr=(M,N)=>Ji(M,N,Et,Nt,Tt,wt),hr=(M,N)=>{if(hi(M)||N>Je||N<0)return M?Qt(M,st):st;const T=M.state;if(!M.output||M.avail_in!==0&&!M.input||T.status===ai&&N!==Ke)return Qt(M,M.avail_out===0?ut:st);const Y=T.last_flush;if(T.last_flush=N,T.pending!==0){if(It(M),M.avail_out===0)return T.last_flush=-1,Ye}else if(M.avail_in===0&&Ki(N)<=Ki(Y)&&N!==Ke)return Qt(M,ut);if(T.status===ai&&M.avail_in!==0)return Qt(M,ut);if(T.status===ti&&T.wrap===0&&(T.status=Xt),T.status===ti){let ee=Et+(T.w_bits-8<<4)<<8,J=-1;if(T.strategy>=tt||T.level<2?J=0:T.level<6?J=1:T.level===6?J=2:J=3,ee|=J<<6,T.strstart!==0&&(ee|=tr),ee+=31-ee%31,li(T,ee),T.strstart!==0&&(li(T,M.adler>>>16),li(T,M.adler&65535)),M.adler=1,T.status=Xt,It(M),T.pending!==0)return T.last_flush=-1,Ye}if(T.status===Pi){if(M.adler=0,mt(T,31),mt(T,139),mt(T,8),T.gzhead)mt(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),mt(T,T.gzhead.time&255),mt(T,T.gzhead.time>>8&255),mt(T,T.gzhead.time>>16&255),mt(T,T.gzhead.time>>24&255),mt(T,T.level===9?2:T.strategy>=tt||T.level<2?4:0),mt(T,T.gzhead.os&255),T.gzhead.extra&&T.gzhead.extra.length&&(mt(T,T.gzhead.extra.length&255),mt(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(M.adler=L(M.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=Oi;else if(mt(T,0),mt(T,0),mt(T,0),mt(T,0),mt(T,0),mt(T,T.level===9?2:T.strategy>=tt||T.level<2?4:0),mt(T,ir),T.status=Xt,It(M),T.pending!==0)return T.last_flush=-1,Ye}if(T.status===Oi){if(T.gzhead.extra){let ee=T.pending,J=(T.gzhead.extra.length&65535)-T.gzindex;for(;T.pending+J>T.pending_buf_size;){let xe=T.pending_buf_size-T.pending;if(T.pending_buf.set(T.gzhead.extra.subarray(T.gzindex,T.gzindex+xe),T.pending),T.pending=T.pending_buf_size,T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex+=xe,It(M),T.pending!==0)return T.last_flush=-1,Ye;ee=0,J-=xe}let Me=new Uint8Array(T.gzhead.extra);T.pending_buf.set(Me.subarray(T.gzindex,T.gzindex+J),T.pending),T.pending+=J,T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex=0}T.status=Li}if(T.status===Li){if(T.gzhead.name){let ee=T.pending,J;do{if(T.pending===T.pending_buf_size){if(T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee)),It(M),T.pending!==0)return T.last_flush=-1,Ye;ee=0}T.gzindex<T.gzhead.name.length?J=T.gzhead.name.charCodeAt(T.gzindex++)&255:J=0,mt(T,J)}while(J!==0);T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee)),T.gzindex=0}T.status=Ri}if(T.status===Ri){if(T.gzhead.comment){let ee=T.pending,J;do{if(T.pending===T.pending_buf_size){if(T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee)),It(M),T.pending!==0)return T.last_flush=-1,Ye;ee=0}T.gzindex<T.gzhead.comment.length?J=T.gzhead.comment.charCodeAt(T.gzindex++)&255:J=0,mt(T,J)}while(J!==0);T.gzhead.hcrc&&T.pending>ee&&(M.adler=L(M.adler,T.pending_buf,T.pending-ee,ee))}T.status=Ii}if(T.status===Ii){if(T.gzhead.hcrc){if(T.pending+2>T.pending_buf_size&&(It(M),T.pending!==0))return T.last_flush=-1,Ye;mt(T,M.adler&255),mt(T,M.adler>>8&255),M.adler=0}if(T.status=Xt,It(M),T.pending!==0)return T.last_flush=-1,Ye}if(M.avail_in!==0||T.lookahead!==0||N!==we&&T.status!==ai){let ee=T.level===0?Xi(T,N):T.strategy===tt?sr(T,N):T.strategy===xt?rr(T,N):ci[T.level].func(T,N);if((ee===Zt||ee===ni)&&(T.status=ai),ee===Rt||ee===Zt)return M.avail_out===0&&(T.last_flush=-1),Ye;if(ee===ii&&(N===je?Be(T):N!==Je&&(se(T,0,0,!1),N===Xe&&(Ht(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),It(M),M.avail_out===0))return T.last_flush=-1,Ye}return N!==Ke?Ye:T.wrap<=0?rt:(T.wrap===2?(mt(T,M.adler&255),mt(T,M.adler>>8&255),mt(T,M.adler>>16&255),mt(T,M.adler>>24&255),mt(T,M.total_in&255),mt(T,M.total_in>>8&255),mt(T,M.total_in>>16&255),mt(T,M.total_in>>24&255)):(li(T,M.adler>>>16),li(T,M.adler&65535)),It(M),T.wrap>0&&(T.wrap=-T.wrap),T.pending!==0?Ye:rt)},ur=M=>{if(hi(M))return st;const N=M.state.status;return M.state=null,N===Xt?Qt(M,pt):Ye},fr=(M,N)=>{let T=N.length;if(hi(M))return st;const Y=M.state,ee=Y.wrap;if(ee===2||ee===1&&Y.status!==ti||Y.lookahead)return st;if(ee===1&&(M.adler=me(M.adler,N,T,0)),Y.wrap=0,T>=Y.w_size){ee===0&&(Ht(Y.head),Y.strstart=0,Y.block_start=0,Y.insert=0);let qe=new Uint8Array(Y.w_size);qe.set(N.subarray(T-Y.w_size,T),0),N=qe,T=Y.w_size}const J=M.avail_in,Me=M.next_in,xe=M.input;for(M.avail_in=T,M.next_in=0,M.input=N,ri(Y);Y.lookahead>=at;){let qe=Y.strstart,fe=Y.lookahead-(at-1);do Y.ins_h=$t(Y,Y.ins_h,Y.window[qe+at-1]),Y.prev[qe&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=qe,qe++;while(--fe);Y.strstart=qe,Y.lookahead=at-1,ri(Y)}return Y.strstart+=Y.lookahead,Y.block_start=Y.strstart,Y.insert=Y.lookahead,Y.lookahead=0,Y.match_length=Y.prev_length=at-1,Y.match_available=0,M.next_in=Me,M.input=xe,M.avail_in=J,Y.wrap=ee,Ye};var dr=cr,gr=Ji,pr=Qi,_r=Zi,mr=lr,vr=hr,br=ur,xr=fr,yr="pako deflate (from Nodeca project)",ui={deflateInit:dr,deflateInit2:gr,deflateReset:pr,deflateResetKeep:_r,deflateSetHeader:mr,deflate:vr,deflateEnd:br,deflateSetDictionary:xr,deflateInfo:yr};const Dr=(M,N)=>Object.prototype.hasOwnProperty.call(M,N);var wr=function(M){const N=Array.prototype.slice.call(arguments,1);for(;N.length;){const T=N.shift();if(T){if(typeof T!="object")throw new TypeError(T+"must be non-object");for(const Y in T)Dr(T,Y)&&(M[Y]=T[Y])}}return M},Er=M=>{let N=0;for(let Y=0,ee=M.length;Y<ee;Y++)N+=M[Y].length;const T=new Uint8Array(N);for(let Y=0,ee=0,J=M.length;Y<J;Y++){let Me=M[Y];T.set(Me,ee),ee+=Me.length}return T},xi={assign:wr,flattenChunks:Er};let qi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{qi=!1}const fi=new Uint8Array(256);for(let M=0;M<256;M++)fi[M]=M>=252?6:M>=248?5:M>=240?4:M>=224?3:M>=192?2:1;fi[254]=fi[254]=1;var Cr=M=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(M);let N,T,Y,ee,J,Me=M.length,xe=0;for(ee=0;ee<Me;ee++)T=M.charCodeAt(ee),(T&64512)===55296&&ee+1<Me&&(Y=M.charCodeAt(ee+1),(Y&64512)===56320&&(T=65536+(T-55296<<10)+(Y-56320),ee++)),xe+=T<128?1:T<2048?2:T<65536?3:4;for(N=new Uint8Array(xe),J=0,ee=0;J<xe;ee++)T=M.charCodeAt(ee),(T&64512)===55296&&ee+1<Me&&(Y=M.charCodeAt(ee+1),(Y&64512)===56320&&(T=65536+(T-55296<<10)+(Y-56320),ee++)),T<128?N[J++]=T:T<2048?(N[J++]=192|T>>>6,N[J++]=128|T&63):T<65536?(N[J++]=224|T>>>12,N[J++]=128|T>>>6&63,N[J++]=128|T&63):(N[J++]=240|T>>>18,N[J++]=128|T>>>12&63,N[J++]=128|T>>>6&63,N[J++]=128|T&63);return N};const Mr=(M,N)=>{if(N<65534&&M.subarray&&qi)return String.fromCharCode.apply(null,M.length===N?M:M.subarray(0,N));let T="";for(let Y=0;Y<N;Y++)T+=String.fromCharCode(M[Y]);return T};var Sr=(M,N)=>{const T=N||M.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(M.subarray(0,N));let Y,ee;const J=new Array(T*2);for(ee=0,Y=0;Y<T;){let Me=M[Y++];if(Me<128){J[ee++]=Me;continue}let xe=fi[Me];if(xe>4){J[ee++]=65533,Y+=xe-1;continue}for(Me&=xe===2?31:xe===3?15:7;xe>1&&Y<T;)Me=Me<<6|M[Y++]&63,xe--;if(xe>1){J[ee++]=65533;continue}Me<65536?J[ee++]=Me:(Me-=65536,J[ee++]=55296|Me>>10&1023,J[ee++]=56320|Me&1023)}return Mr(J,ee)},Ar=(M,N)=>{N=N||M.length,N>M.length&&(N=M.length);let T=N-1;for(;T>=0&&(M[T]&192)===128;)T--;return T<0||T===0?N:T+fi[M[T]]>N?T:N},di={string2buf:Cr,buf2string:Sr,utf8border:Ar};function Tr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var en=Tr;const tn=Object.prototype.toString,{Z_NO_FLUSH:Pr,Z_SYNC_FLUSH:Or,Z_FULL_FLUSH:Lr,Z_FINISH:Rr,Z_OK:yi,Z_STREAM_END:Ir,Z_DEFAULT_COMPRESSION:Fr,Z_DEFAULT_STRATEGY:zr,Z_DEFLATED:kr}=de;function gi(M){this.options=xi.assign({level:Fr,method:kr,chunkSize:16384,windowBits:15,memLevel:8,strategy:zr},M||{});let N=this.options;N.raw&&N.windowBits>0?N.windowBits=-N.windowBits:N.gzip&&N.windowBits>0&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new en,this.strm.avail_out=0;let T=ui.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(T!==yi)throw new Error(ge[T]);if(N.header&&ui.deflateSetHeader(this.strm,N.header),N.dictionary){let Y;if(typeof N.dictionary=="string"?Y=di.string2buf(N.dictionary):tn.call(N.dictionary)==="[object ArrayBuffer]"?Y=new Uint8Array(N.dictionary):Y=N.dictionary,T=ui.deflateSetDictionary(this.strm,Y),T!==yi)throw new Error(ge[T]);this._dict_set=!0}}gi.prototype.push=function(M,N){const T=this.strm,Y=this.options.chunkSize;let ee,J;if(this.ended)return!1;for(N===~~N?J=N:J=N===!0?Rr:Pr,typeof M=="string"?T.input=di.string2buf(M):tn.call(M)==="[object ArrayBuffer]"?T.input=new Uint8Array(M):T.input=M,T.next_in=0,T.avail_in=T.input.length;;){if(T.avail_out===0&&(T.output=new Uint8Array(Y),T.next_out=0,T.avail_out=Y),(J===Or||J===Lr)&&T.avail_out<=6){this.onData(T.output.subarray(0,T.next_out)),T.avail_out=0;continue}if(ee=ui.deflate(T,J),ee===Ir)return T.next_out>0&&this.onData(T.output.subarray(0,T.next_out)),ee=ui.deflateEnd(this.strm),this.onEnd(ee),this.ended=!0,ee===yi;if(T.avail_out===0){this.onData(T.output);continue}if(J>0&&T.next_out>0){this.onData(T.output.subarray(0,T.next_out)),T.avail_out=0;continue}if(T.avail_in===0)break}return!0},gi.prototype.onData=function(M){this.chunks.push(M)},gi.prototype.onEnd=function(M){M===yi&&(this.result=xi.flattenChunks(this.chunks)),this.chunks=[],this.err=M,this.msg=this.strm.msg};function ki(M,N){const T=new gi(N);if(T.push(M,!0),T.err)throw T.msg||ge[T.err];return T.result}function Br(M,N){return N=N||{},N.raw=!0,ki(M,N)}function Ur(M,N){return N=N||{},N.gzip=!0,ki(M,N)}var Wr=gi,Nr=ki,Vr=Br,Gr=Ur,Hr={Deflate:Wr,deflate:Nr,deflateRaw:Vr,gzip:Gr};const Di=16209,$r=16191;var jr=function(N,T){let Y,ee,J,Me,xe,qe,fe,Se,_t,Qe,Ge,it,St,dt,lt,bt,ht,Ze,vt,Pt,nt,yt,gt,ot;const ft=N.state;Y=N.next_in,gt=N.input,ee=Y+(N.avail_in-5),J=N.next_out,ot=N.output,Me=J-(T-N.avail_out),xe=J+(N.avail_out-257),qe=ft.dmax,fe=ft.wsize,Se=ft.whave,_t=ft.wnext,Qe=ft.window,Ge=ft.hold,it=ft.bits,St=ft.lencode,dt=ft.distcode,lt=(1<<ft.lenbits)-1,bt=(1<<ft.distbits)-1;e:do{it<15&&(Ge+=gt[Y++]<<it,it+=8,Ge+=gt[Y++]<<it,it+=8),ht=St[Ge&lt];t:for(;;){if(Ze=ht>>>24,Ge>>>=Ze,it-=Ze,Ze=ht>>>16&255,Ze===0)ot[J++]=ht&65535;else if(Ze&16){vt=ht&65535,Ze&=15,Ze&&(it<Ze&&(Ge+=gt[Y++]<<it,it+=8),vt+=Ge&(1<<Ze)-1,Ge>>>=Ze,it-=Ze),it<15&&(Ge+=gt[Y++]<<it,it+=8,Ge+=gt[Y++]<<it,it+=8),ht=dt[Ge&bt];i:for(;;){if(Ze=ht>>>24,Ge>>>=Ze,it-=Ze,Ze=ht>>>16&255,Ze&16){if(Pt=ht&65535,Ze&=15,it<Ze&&(Ge+=gt[Y++]<<it,it+=8,it<Ze&&(Ge+=gt[Y++]<<it,it+=8)),Pt+=Ge&(1<<Ze)-1,Pt>qe){N.msg="invalid distance too far back",ft.mode=Di;break e}if(Ge>>>=Ze,it-=Ze,Ze=J-Me,Pt>Ze){if(Ze=Pt-Ze,Ze>Se&&ft.sane){N.msg="invalid distance too far back",ft.mode=Di;break e}if(nt=0,yt=Qe,_t===0){if(nt+=fe-Ze,Ze<vt){vt-=Ze;do ot[J++]=Qe[nt++];while(--Ze);nt=J-Pt,yt=ot}}else if(_t<Ze){if(nt+=fe+_t-Ze,Ze-=_t,Ze<vt){vt-=Ze;do ot[J++]=Qe[nt++];while(--Ze);if(nt=0,_t<vt){Ze=_t,vt-=Ze;do ot[J++]=Qe[nt++];while(--Ze);nt=J-Pt,yt=ot}}}else if(nt+=_t-Ze,Ze<vt){vt-=Ze;do ot[J++]=Qe[nt++];while(--Ze);nt=J-Pt,yt=ot}for(;vt>2;)ot[J++]=yt[nt++],ot[J++]=yt[nt++],ot[J++]=yt[nt++],vt-=3;vt&&(ot[J++]=yt[nt++],vt>1&&(ot[J++]=yt[nt++]))}else{nt=J-Pt;do ot[J++]=ot[nt++],ot[J++]=ot[nt++],ot[J++]=ot[nt++],vt-=3;while(vt>2);vt&&(ot[J++]=ot[nt++],vt>1&&(ot[J++]=ot[nt++]))}}else if((Ze&64)===0){ht=dt[(ht&65535)+(Ge&(1<<Ze)-1)];continue i}else{N.msg="invalid distance code",ft.mode=Di;break e}break}}else if((Ze&64)===0){ht=St[(ht&65535)+(Ge&(1<<Ze)-1)];continue t}else if(Ze&32){ft.mode=$r;break e}else{N.msg="invalid literal/length code",ft.mode=Di;break e}break}}while(Y<ee&&J<xe);vt=it>>3,Y-=vt,it-=vt<<3,Ge&=(1<<it)-1,N.next_in=Y,N.next_out=J,N.avail_in=Y<ee?5+(ee-Y):5-(Y-ee),N.avail_out=J<xe?257+(xe-J):257-(J-xe),ft.hold=Ge,ft.bits=it};const oi=15,nn=852,rn=592,sn=0,Bi=1,on=2,Kr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Yr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Xr=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Zr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var pi=(M,N,T,Y,ee,J,Me,xe)=>{const qe=xe.bits;let fe=0,Se=0,_t=0,Qe=0,Ge=0,it=0,St=0,dt=0,lt=0,bt=0,ht,Ze,vt,Pt,nt,yt=null,gt;const ot=new Uint16Array(oi+1),ft=new Uint16Array(oi+1);let ei=null,er,Ai,Ti;for(fe=0;fe<=oi;fe++)ot[fe]=0;for(Se=0;Se<Y;Se++)ot[N[T+Se]]++;for(Ge=qe,Qe=oi;Qe>=1&&ot[Qe]===0;Qe--);if(Ge>Qe&&(Ge=Qe),Qe===0)return ee[J++]=1<<24|64<<16|0,ee[J++]=1<<24|64<<16|0,xe.bits=1,0;for(_t=1;_t<Qe&&ot[_t]===0;_t++);for(Ge<_t&&(Ge=_t),dt=1,fe=1;fe<=oi;fe++)if(dt<<=1,dt-=ot[fe],dt<0)return-1;if(dt>0&&(M===sn||Qe!==1))return-1;for(ft[1]=0,fe=1;fe<oi;fe++)ft[fe+1]=ft[fe]+ot[fe];for(Se=0;Se<Y;Se++)N[T+Se]!==0&&(Me[ft[N[T+Se]]++]=Se);if(M===sn?(yt=ei=Me,gt=20):M===Bi?(yt=Kr,ei=Yr,gt=257):(yt=Xr,ei=Zr,gt=0),bt=0,Se=0,fe=_t,nt=J,it=Ge,St=0,vt=-1,lt=1<<Ge,Pt=lt-1,M===Bi&&lt>nn||M===on&&lt>rn)return 1;for(;;){er=fe-St,Me[Se]+1<gt?(Ai=0,Ti=Me[Se]):Me[Se]>=gt?(Ai=ei[Me[Se]-gt],Ti=yt[Me[Se]-gt]):(Ai=96,Ti=0),ht=1<<fe-St,Ze=1<<it,_t=Ze;do Ze-=ht,ee[nt+(bt>>St)+Ze]=er<<24|Ai<<16|Ti|0;while(Ze!==0);for(ht=1<<fe-1;bt&ht;)ht>>=1;if(ht!==0?(bt&=ht-1,bt+=ht):bt=0,Se++,--ot[fe]===0){if(fe===Qe)break;fe=N[T+Me[Se]]}if(fe>Ge&&(bt&Pt)!==vt){for(St===0&&(St=Ge),nt+=_t,it=fe-St,dt=1<<it;it+St<Qe&&(dt-=ot[it+St],!(dt<=0));)it++,dt<<=1;if(lt+=1<<it,M===Bi&&lt>nn||M===on&&lt>rn)return 1;vt=bt&Pt,ee[vt]=Ge<<24|it<<16|nt-J|0}}return bt!==0&&(ee[nt+bt]=fe-St<<24|64<<16|0),xe.bits=Ge,0};const Qr=0,an=1,ln=2,{Z_FINISH:cn,Z_BLOCK:Jr,Z_TREES:wi,Z_OK:Jt,Z_STREAM_END:qr,Z_NEED_DICT:es,Z_STREAM_ERROR:Bt,Z_DATA_ERROR:hn,Z_MEM_ERROR:un,Z_BUF_ERROR:ts,Z_DEFLATED:fn}=de,Ei=16180,dn=16181,gn=16182,pn=16183,_n=16184,mn=16185,vn=16186,bn=16187,xn=16188,yn=16189,Ci=16190,Vt=16191,Ui=16192,Dn=16193,Wi=16194,wn=16195,En=16196,Cn=16197,Mn=16198,Mi=16199,Si=16200,Sn=16201,An=16202,Tn=16203,Pn=16204,On=16205,Ni=16206,Ln=16207,Rn=16208,Mt=16209,In=16210,Fn=16211,is=852,ns=592,rs=15,zn=M=>(M>>>24&255)+(M>>>8&65280)+((M&65280)<<8)+((M&255)<<24);function ss(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qt=M=>{if(!M)return 1;const N=M.state;return!N||N.strm!==M||N.mode<Ei||N.mode>Fn?1:0},kn=M=>{if(qt(M))return Bt;const N=M.state;return M.total_in=M.total_out=N.total=0,M.msg="",N.wrap&&(M.adler=N.wrap&1),N.mode=Ei,N.last=0,N.havedict=0,N.flags=-1,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new Int32Array(is),N.distcode=N.distdyn=new Int32Array(ns),N.sane=1,N.back=-1,Jt},Bn=M=>{if(qt(M))return Bt;const N=M.state;return N.wsize=0,N.whave=0,N.wnext=0,kn(M)},Un=(M,N)=>{let T;if(qt(M))return Bt;const Y=M.state;return N<0?(T=0,N=-N):(T=(N>>4)+5,N<48&&(N&=15)),N&&(N<8||N>15)?Bt:(Y.window!==null&&Y.wbits!==N&&(Y.window=null),Y.wrap=T,Y.wbits=N,Bn(M))},Wn=(M,N)=>{if(!M)return Bt;const T=new ss;M.state=T,T.strm=M,T.window=null,T.mode=Ei;const Y=Un(M,N);return Y!==Jt&&(M.state=null),Y},os=M=>Wn(M,rs);let Nn=!0,Vi,Gi;const as=M=>{if(Nn){Vi=new Int32Array(512),Gi=new Int32Array(32);let N=0;for(;N<144;)M.lens[N++]=8;for(;N<256;)M.lens[N++]=9;for(;N<280;)M.lens[N++]=7;for(;N<288;)M.lens[N++]=8;for(pi(an,M.lens,0,288,Vi,0,M.work,{bits:9}),N=0;N<32;)M.lens[N++]=5;pi(ln,M.lens,0,32,Gi,0,M.work,{bits:5}),Nn=!1}M.lencode=Vi,M.lenbits=9,M.distcode=Gi,M.distbits=5},Vn=(M,N,T,Y)=>{let ee;const J=M.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new Uint8Array(J.wsize)),Y>=J.wsize?(J.window.set(N.subarray(T-J.wsize,T),0),J.wnext=0,J.whave=J.wsize):(ee=J.wsize-J.wnext,ee>Y&&(ee=Y),J.window.set(N.subarray(T-Y,T-Y+ee),J.wnext),Y-=ee,Y?(J.window.set(N.subarray(T-Y,T),0),J.wnext=Y,J.whave=J.wsize):(J.wnext+=ee,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=ee))),0},ls=(M,N)=>{let T,Y,ee,J,Me,xe,qe,fe,Se,_t,Qe,Ge,it,St,dt=0,lt,bt,ht,Ze,vt,Pt,nt,yt;const gt=new Uint8Array(4);let ot,ft;const ei=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qt(M)||!M.output||!M.input&&M.avail_in!==0)return Bt;T=M.state,T.mode===Vt&&(T.mode=Ui),Me=M.next_out,ee=M.output,qe=M.avail_out,J=M.next_in,Y=M.input,xe=M.avail_in,fe=T.hold,Se=T.bits,_t=xe,Qe=qe,yt=Jt;e:for(;;)switch(T.mode){case Ei:if(T.wrap===0){T.mode=Ui;break}for(;Se<16;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(T.wrap&2&&fe===35615){T.wbits===0&&(T.wbits=15),T.check=0,gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0),fe=0,Se=0,T.mode=dn;break}if(T.head&&(T.head.done=!1),!(T.wrap&1)||(((fe&255)<<8)+(fe>>8))%31){M.msg="incorrect header check",T.mode=Mt;break}if((fe&15)!==fn){M.msg="unknown compression method",T.mode=Mt;break}if(fe>>>=4,Se-=4,nt=(fe&15)+8,T.wbits===0&&(T.wbits=nt),nt>15||nt>T.wbits){M.msg="invalid window size",T.mode=Mt;break}T.dmax=1<<T.wbits,T.flags=0,M.adler=T.check=1,T.mode=fe&512?yn:Vt,fe=0,Se=0;break;case dn:for(;Se<16;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(T.flags=fe,(T.flags&255)!==fn){M.msg="unknown compression method",T.mode=Mt;break}if(T.flags&57344){M.msg="unknown header flags set",T.mode=Mt;break}T.head&&(T.head.text=fe>>8&1),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Se=0,T.mode=gn;case gn:for(;Se<32;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.head&&(T.head.time=fe),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,gt[2]=fe>>>16&255,gt[3]=fe>>>24&255,T.check=L(T.check,gt,4,0)),fe=0,Se=0,T.mode=pn;case pn:for(;Se<16;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.head&&(T.head.xflags=fe&255,T.head.os=fe>>8),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Se=0,T.mode=_n;case _n:if(T.flags&1024){for(;Se<16;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.length=fe,T.head&&(T.head.extra_len=fe),T.flags&512&&T.wrap&4&&(gt[0]=fe&255,gt[1]=fe>>>8&255,T.check=L(T.check,gt,2,0)),fe=0,Se=0}else T.head&&(T.head.extra=null);T.mode=mn;case mn:if(T.flags&1024&&(Ge=T.length,Ge>xe&&(Ge=xe),Ge&&(T.head&&(nt=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Uint8Array(T.head.extra_len)),T.head.extra.set(Y.subarray(J,J+Ge),nt)),T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ge,J)),xe-=Ge,J+=Ge,T.length-=Ge),T.length))break e;T.length=0,T.mode=vn;case vn:if(T.flags&2048){if(xe===0)break e;Ge=0;do nt=Y[J+Ge++],T.head&&nt&&T.length<65536&&(T.head.name+=String.fromCharCode(nt));while(nt&&Ge<xe);if(T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ge,J)),xe-=Ge,J+=Ge,nt)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=bn;case bn:if(T.flags&4096){if(xe===0)break e;Ge=0;do nt=Y[J+Ge++],T.head&&nt&&T.length<65536&&(T.head.comment+=String.fromCharCode(nt));while(nt&&Ge<xe);if(T.flags&512&&T.wrap&4&&(T.check=L(T.check,Y,Ge,J)),xe-=Ge,J+=Ge,nt)break e}else T.head&&(T.head.comment=null);T.mode=xn;case xn:if(T.flags&512){for(;Se<16;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(T.wrap&4&&fe!==(T.check&65535)){M.msg="header crc mismatch",T.mode=Mt;break}fe=0,Se=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),M.adler=T.check=0,T.mode=Vt;break;case yn:for(;Se<32;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}M.adler=T.check=zn(fe),fe=0,Se=0,T.mode=Ci;case Ci:if(T.havedict===0)return M.next_out=Me,M.avail_out=qe,M.next_in=J,M.avail_in=xe,T.hold=fe,T.bits=Se,es;M.adler=T.check=1,T.mode=Vt;case Vt:if(N===Jr||N===wi)break e;case Ui:if(T.last){fe>>>=Se&7,Se-=Se&7,T.mode=Ni;break}for(;Se<3;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}switch(T.last=fe&1,fe>>>=1,Se-=1,fe&3){case 0:T.mode=Dn;break;case 1:if(as(T),T.mode=Mi,N===wi){fe>>>=2,Se-=2;break e}break;case 2:T.mode=En;break;case 3:M.msg="invalid block type",T.mode=Mt}fe>>>=2,Se-=2;break;case Dn:for(fe>>>=Se&7,Se-=Se&7;Se<32;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if((fe&65535)!==(fe>>>16^65535)){M.msg="invalid stored block lengths",T.mode=Mt;break}if(T.length=fe&65535,fe=0,Se=0,T.mode=Wi,N===wi)break e;case Wi:T.mode=wn;case wn:if(Ge=T.length,Ge){if(Ge>xe&&(Ge=xe),Ge>qe&&(Ge=qe),Ge===0)break e;ee.set(Y.subarray(J,J+Ge),Me),xe-=Ge,J+=Ge,qe-=Ge,Me+=Ge,T.length-=Ge;break}T.mode=Vt;break;case En:for(;Se<14;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(T.nlen=(fe&31)+257,fe>>>=5,Se-=5,T.ndist=(fe&31)+1,fe>>>=5,Se-=5,T.ncode=(fe&15)+4,fe>>>=4,Se-=4,T.nlen>286||T.ndist>30){M.msg="too many length or distance symbols",T.mode=Mt;break}T.have=0,T.mode=Cn;case Cn:for(;T.have<T.ncode;){for(;Se<3;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.lens[ei[T.have++]]=fe&7,fe>>>=3,Se-=3}for(;T.have<19;)T.lens[ei[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,ot={bits:T.lenbits},yt=pi(Qr,T.lens,0,19,T.lencode,0,T.work,ot),T.lenbits=ot.bits,yt){M.msg="invalid code lengths set",T.mode=Mt;break}T.have=0,T.mode=Mn;case Mn:for(;T.have<T.nlen+T.ndist;){for(;dt=T.lencode[fe&(1<<T.lenbits)-1],lt=dt>>>24,bt=dt>>>16&255,ht=dt&65535,!(lt<=Se);){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(ht<16)fe>>>=lt,Se-=lt,T.lens[T.have++]=ht;else{if(ht===16){for(ft=lt+2;Se<ft;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(fe>>>=lt,Se-=lt,T.have===0){M.msg="invalid bit length repeat",T.mode=Mt;break}nt=T.lens[T.have-1],Ge=3+(fe&3),fe>>>=2,Se-=2}else if(ht===17){for(ft=lt+3;Se<ft;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}fe>>>=lt,Se-=lt,nt=0,Ge=3+(fe&7),fe>>>=3,Se-=3}else{for(ft=lt+7;Se<ft;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}fe>>>=lt,Se-=lt,nt=0,Ge=11+(fe&127),fe>>>=7,Se-=7}if(T.have+Ge>T.nlen+T.ndist){M.msg="invalid bit length repeat",T.mode=Mt;break}for(;Ge--;)T.lens[T.have++]=nt}}if(T.mode===Mt)break;if(T.lens[256]===0){M.msg="invalid code -- missing end-of-block",T.mode=Mt;break}if(T.lenbits=9,ot={bits:T.lenbits},yt=pi(an,T.lens,0,T.nlen,T.lencode,0,T.work,ot),T.lenbits=ot.bits,yt){M.msg="invalid literal/lengths set",T.mode=Mt;break}if(T.distbits=6,T.distcode=T.distdyn,ot={bits:T.distbits},yt=pi(ln,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,ot),T.distbits=ot.bits,yt){M.msg="invalid distances set",T.mode=Mt;break}if(T.mode=Mi,N===wi)break e;case Mi:T.mode=Si;case Si:if(xe>=6&&qe>=258){M.next_out=Me,M.avail_out=qe,M.next_in=J,M.avail_in=xe,T.hold=fe,T.bits=Se,jr(M,Qe),Me=M.next_out,ee=M.output,qe=M.avail_out,J=M.next_in,Y=M.input,xe=M.avail_in,fe=T.hold,Se=T.bits,T.mode===Vt&&(T.back=-1);break}for(T.back=0;dt=T.lencode[fe&(1<<T.lenbits)-1],lt=dt>>>24,bt=dt>>>16&255,ht=dt&65535,!(lt<=Se);){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(bt&&(bt&240)===0){for(Ze=lt,vt=bt,Pt=ht;dt=T.lencode[Pt+((fe&(1<<Ze+vt)-1)>>Ze)],lt=dt>>>24,bt=dt>>>16&255,ht=dt&65535,!(Ze+lt<=Se);){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}fe>>>=Ze,Se-=Ze,T.back+=Ze}if(fe>>>=lt,Se-=lt,T.back+=lt,T.length=ht,bt===0){T.mode=On;break}if(bt&32){T.back=-1,T.mode=Vt;break}if(bt&64){M.msg="invalid literal/length code",T.mode=Mt;break}T.extra=bt&15,T.mode=Sn;case Sn:if(T.extra){for(ft=T.extra;Se<ft;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.length+=fe&(1<<T.extra)-1,fe>>>=T.extra,Se-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=An;case An:for(;dt=T.distcode[fe&(1<<T.distbits)-1],lt=dt>>>24,bt=dt>>>16&255,ht=dt&65535,!(lt<=Se);){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if((bt&240)===0){for(Ze=lt,vt=bt,Pt=ht;dt=T.distcode[Pt+((fe&(1<<Ze+vt)-1)>>Ze)],lt=dt>>>24,bt=dt>>>16&255,ht=dt&65535,!(Ze+lt<=Se);){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}fe>>>=Ze,Se-=Ze,T.back+=Ze}if(fe>>>=lt,Se-=lt,T.back+=lt,bt&64){M.msg="invalid distance code",T.mode=Mt;break}T.offset=ht,T.extra=bt&15,T.mode=Tn;case Tn:if(T.extra){for(ft=T.extra;Se<ft;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}T.offset+=fe&(1<<T.extra)-1,fe>>>=T.extra,Se-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){M.msg="invalid distance too far back",T.mode=Mt;break}T.mode=Pn;case Pn:if(qe===0)break e;if(Ge=Qe-qe,T.offset>Ge){if(Ge=T.offset-Ge,Ge>T.whave&&T.sane){M.msg="invalid distance too far back",T.mode=Mt;break}Ge>T.wnext?(Ge-=T.wnext,it=T.wsize-Ge):it=T.wnext-Ge,Ge>T.length&&(Ge=T.length),St=T.window}else St=ee,it=Me-T.offset,Ge=T.length;Ge>qe&&(Ge=qe),qe-=Ge,T.length-=Ge;do ee[Me++]=St[it++];while(--Ge);T.length===0&&(T.mode=Si);break;case On:if(qe===0)break e;ee[Me++]=T.length,qe--,T.mode=Si;break;case Ni:if(T.wrap){for(;Se<32;){if(xe===0)break e;xe--,fe|=Y[J++]<<Se,Se+=8}if(Qe-=qe,M.total_out+=Qe,T.total+=Qe,T.wrap&4&&Qe&&(M.adler=T.check=T.flags?L(T.check,ee,Qe,Me-Qe):me(T.check,ee,Qe,Me-Qe)),Qe=qe,T.wrap&4&&(T.flags?fe:zn(fe))!==T.check){M.msg="incorrect data check",T.mode=Mt;break}fe=0,Se=0}T.mode=Ln;case Ln:if(T.wrap&&T.flags){for(;Se<32;){if(xe===0)break e;xe--,fe+=Y[J++]<<Se,Se+=8}if(T.wrap&4&&fe!==(T.total&4294967295)){M.msg="incorrect length check",T.mode=Mt;break}fe=0,Se=0}T.mode=Rn;case Rn:yt=qr;break e;case Mt:yt=hn;break e;case In:return un;case Fn:default:return Bt}return M.next_out=Me,M.avail_out=qe,M.next_in=J,M.avail_in=xe,T.hold=fe,T.bits=Se,(T.wsize||Qe!==M.avail_out&&T.mode<Mt&&(T.mode<Ni||N!==cn))&&Vn(M,M.output,M.next_out,Qe-M.avail_out),_t-=M.avail_in,Qe-=M.avail_out,M.total_in+=_t,M.total_out+=Qe,T.total+=Qe,T.wrap&4&&Qe&&(M.adler=T.check=T.flags?L(T.check,ee,Qe,M.next_out-Qe):me(T.check,ee,Qe,M.next_out-Qe)),M.data_type=T.bits+(T.last?64:0)+(T.mode===Vt?128:0)+(T.mode===Mi||T.mode===Wi?256:0),(_t===0&&Qe===0||N===cn)&&yt===Jt&&(yt=ts),yt},cs=M=>{if(qt(M))return Bt;let N=M.state;return N.window&&(N.window=null),M.state=null,Jt},hs=(M,N)=>{if(qt(M))return Bt;const T=M.state;return(T.wrap&2)===0?Bt:(T.head=N,N.done=!1,Jt)},us=(M,N)=>{const T=N.length;let Y,ee,J;return qt(M)||(Y=M.state,Y.wrap!==0&&Y.mode!==Ci)?Bt:Y.mode===Ci&&(ee=1,ee=me(ee,N,T,0),ee!==Y.check)?hn:(J=Vn(M,N,T,T),J?(Y.mode=In,un):(Y.havedict=1,Jt))};var fs=Bn,ds=Un,gs=kn,ps=os,_s=Wn,ms=ls,vs=cs,bs=hs,xs=us,ys="pako inflate (from Nodeca project)",Gt={inflateReset:fs,inflateReset2:ds,inflateResetKeep:gs,inflateInit:ps,inflateInit2:_s,inflate:ms,inflateEnd:vs,inflateGetHeader:bs,inflateSetDictionary:xs,inflateInfo:ys};function Ds(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ws=Ds;const Gn=Object.prototype.toString,{Z_NO_FLUSH:Es,Z_FINISH:Cs,Z_OK:mi,Z_STREAM_END:Hi,Z_NEED_DICT:$i,Z_STREAM_ERROR:Ms,Z_DATA_ERROR:Hn,Z_MEM_ERROR:Ss}=de;function vi(M){this.options=xi.assign({chunkSize:65536,windowBits:15,to:""},M||{});const N=this.options;N.raw&&N.windowBits>=0&&N.windowBits<16&&(N.windowBits=-N.windowBits,N.windowBits===0&&(N.windowBits=-15)),N.windowBits>=0&&N.windowBits<16&&!(M&&M.windowBits)&&(N.windowBits+=32),N.windowBits>15&&N.windowBits<48&&(N.windowBits&15)===0&&(N.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new en,this.strm.avail_out=0;let T=Gt.inflateInit2(this.strm,N.windowBits);if(T!==mi)throw new Error(ge[T]);if(this.header=new ws,Gt.inflateGetHeader(this.strm,this.header),N.dictionary&&(typeof N.dictionary=="string"?N.dictionary=di.string2buf(N.dictionary):Gn.call(N.dictionary)==="[object ArrayBuffer]"&&(N.dictionary=new Uint8Array(N.dictionary)),N.raw&&(T=Gt.inflateSetDictionary(this.strm,N.dictionary),T!==mi)))throw new Error(ge[T])}vi.prototype.push=function(M,N){const T=this.strm,Y=this.options.chunkSize,ee=this.options.dictionary;let J,Me,xe;if(this.ended)return!1;for(N===~~N?Me=N:Me=N===!0?Cs:Es,Gn.call(M)==="[object ArrayBuffer]"?T.input=new Uint8Array(M):T.input=M,T.next_in=0,T.avail_in=T.input.length;;){for(T.avail_out===0&&(T.output=new Uint8Array(Y),T.next_out=0,T.avail_out=Y),J=Gt.inflate(T,Me),J===$i&&ee&&(J=Gt.inflateSetDictionary(T,ee),J===mi?J=Gt.inflate(T,Me):J===Hn&&(J=$i));T.avail_in>0&&J===Hi&&T.state.wrap>0&&M[T.next_in]!==0;)Gt.inflateReset(T),J=Gt.inflate(T,Me);switch(J){case Ms:case Hn:case $i:case Ss:return this.onEnd(J),this.ended=!0,!1}if(xe=T.avail_out,T.next_out&&(T.avail_out===0||J===Hi))if(this.options.to==="string"){let qe=di.utf8border(T.output,T.next_out),fe=T.next_out-qe,Se=di.buf2string(T.output,qe);T.next_out=fe,T.avail_out=Y-fe,fe&&T.output.set(T.output.subarray(qe,qe+fe),0),this.onData(Se)}else this.onData(T.output.length===T.next_out?T.output:T.output.subarray(0,T.next_out));if(!(J===mi&&xe===0)){if(J===Hi)return J=Gt.inflateEnd(this.strm),this.onEnd(J),this.ended=!0,!0;if(T.avail_in===0)break}}return!0},vi.prototype.onData=function(M){this.chunks.push(M)},vi.prototype.onEnd=function(M){M===mi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=xi.flattenChunks(this.chunks)),this.chunks=[],this.err=M,this.msg=this.strm.msg};function ji(M,N){const T=new vi(N);if(T.push(M),T.err)throw T.msg||ge[T.err];return T.result}function As(M,N){return N=N||{},N.raw=!0,ji(M,N)}var Ts=vi,Ps=ji,Os=As,Ls=ji,Rs={Inflate:Ts,inflate:Ps,inflateRaw:Os,ungzip:Ls};const{Deflate:Is,deflate:Fs,deflateRaw:zs,gzip:ks}=Hr,{Inflate:Bs,inflate:Us,inflateRaw:Ws,ungzip:Ns}=Rs;var $n=Is,jn=Fs,Kn=zs,Yn=ks,Xn=Bs,Zn=Us,Qn=Ws,Jn=Ns,qn=de,Vs={Deflate:$n,deflate:jn,deflateRaw:Kn,gzip:Yn,Inflate:Xn,inflate:Zn,inflateRaw:Qn,ungzip:Jn,constants:qn}},"./node_modules/upng-js/UPNG.js":(r,e,t)=>{(function(){var i={},n;r.exports=i,n=t("./node_modules/upng-js/node_modules/pako/index.js"),function(s,o){s.toRGBA8=function(a){var l=a.width,h=a.height;if(a.tabs.acTL==null)return[s.toRGBA8.decodeImage(a.data,l,h,a).buffer];var u=[];a.frames[0].data==null&&(a.frames[0].data=a.data);for(var g,m=new Uint8Array(l*h*4),_=0;_<a.frames.length;_++){var b=a.frames[_],d=b.rect.x,c=b.rect.y,f=b.rect.width,v=b.rect.height,y=s.toRGBA8.decodeImage(b.data,f,v,a);if(_==0?g=y:b.blend==0?s._copyTile(y,f,v,g,l,h,d,c,0):b.blend==1&&s._copyTile(y,f,v,g,l,h,d,c,1),u.push(g.buffer),g=g.slice(0),b.dispose!=0){if(b.dispose==1)s._copyTile(m,f,v,g,l,h,d,c,0);else if(b.dispose==2){for(var D=_-1;a.frames[D].dispose==2;)D--;g=new Uint8Array(u[D]).slice(0)}}}return u},s.toRGBA8.decodeImage=function(a,l,h,u){var g=l*h,m=s.decode._getBPP(u),_=Math.ceil(l*m/8),b=new Uint8Array(g*4),d=new Uint32Array(b.buffer),c=u.ctype,f=u.depth,v=s._bin.readUshort;if(c==6){var y=g<<2;if(f==8)for(var D=0;D<y;D++)b[D]=a[D];if(f==16)for(var D=0;D<y;D++)b[D]=a[D<<1]}else if(c==2){var E=u.tabs.tRNS,p=-1,x=-1,w=-1;if(E&&(p=E[0],x=E[1],w=E[2]),f==8)for(var D=0;D<g;D++){var C=D<<2,S=D*3;b[C]=a[S],b[C+1]=a[S+1],b[C+2]=a[S+2],b[C+3]=255,p!=-1&&a[S]==p&&a[S+1]==x&&a[S+2]==w&&(b[C+3]=0)}if(f==16)for(var D=0;D<g;D++){var C=D<<2,S=D*6;b[C]=a[S],b[C+1]=a[S+2],b[C+2]=a[S+4],b[C+3]=255,p!=-1&&v(a,S)==p&&v(a,S+2)==x&&v(a,S+4)==w&&(b[C+3]=0)}}else if(c==3){var A=u.tabs.PLTE,P=u.tabs.tRNS,O=P?P.length:0;if(f==1)for(var F=0;F<h;F++)for(var I=F*_,B=F*l,D=0;D<l;D++){var C=B+D<<2,k=a[I+(D>>3)]>>7-((D&7)<<0)&1,U=3*k;b[C]=A[U],b[C+1]=A[U+1],b[C+2]=A[U+2],b[C+3]=k<O?P[k]:255}if(f==2)for(var F=0;F<h;F++)for(var I=F*_,B=F*l,D=0;D<l;D++){var C=B+D<<2,k=a[I+(D>>2)]>>6-((D&3)<<1)&3,U=3*k;b[C]=A[U],b[C+1]=A[U+1],b[C+2]=A[U+2],b[C+3]=k<O?P[k]:255}if(f==4)for(var F=0;F<h;F++)for(var I=F*_,B=F*l,D=0;D<l;D++){var C=B+D<<2,k=a[I+(D>>1)]>>4-((D&1)<<2)&15,U=3*k;b[C]=A[U],b[C+1]=A[U+1],b[C+2]=A[U+2],b[C+3]=k<O?P[k]:255}if(f==8)for(var D=0;D<g;D++){var C=D<<2,k=a[D],U=3*k;b[C]=A[U],b[C+1]=A[U+1],b[C+2]=A[U+2],b[C+3]=k<O?P[k]:255}}else if(c==4){if(f==8)for(var D=0;D<g;D++){var C=D<<2,W=D<<1,R=a[W];b[C]=R,b[C+1]=R,b[C+2]=R,b[C+3]=a[W+1]}if(f==16)for(var D=0;D<g;D++){var C=D<<2,W=D<<2,R=a[W];b[C]=R,b[C+1]=R,b[C+2]=R,b[C+3]=a[W+2]}}else if(c==0){var p=u.tabs.tRNS?u.tabs.tRNS:-1;if(f==1)for(var D=0;D<g;D++){var R=255*(a[D>>3]>>7-(D&7)&1),z=R==p*255?0:255;d[D]=z<<24|R<<16|R<<8|R}if(f==2)for(var D=0;D<g;D++){var R=85*(a[D>>2]>>6-((D&3)<<1)&3),z=R==p*85?0:255;d[D]=z<<24|R<<16|R<<8|R}if(f==4)for(var D=0;D<g;D++){var R=17*(a[D>>1]>>4-((D&1)<<2)&15),z=R==p*17?0:255;d[D]=z<<24|R<<16|R<<8|R}if(f==8)for(var D=0;D<g;D++){var R=a[D],z=R==p?0:255;d[D]=z<<24|R<<16|R<<8|R}if(f==16)for(var D=0;D<g;D++){var R=a[D<<1],z=v(a,D<<1)==p?0:255;d[D]=z<<24|R<<16|R<<8|R}}return b},s.decode=function(a){for(var l=new Uint8Array(a),h=8,u=s._bin,g=u.readUshort,m=u.readUint,_={tabs:{},frames:[]},b=new Uint8Array(l.length),d=0,c,f=0,v=[137,80,78,71,13,10,26,10],y=0;y<8;y++)if(l[y]!=v[y])throw"The input is not a PNG file!";for(;h<l.length;){var D=u.readUint(l,h);h+=4;var E=u.readASCII(l,h,4);if(h+=4,E=="IHDR")s.decode._IHDR(l,h,_);else if(E=="IDAT"){for(var y=0;y<D;y++)b[d+y]=l[h+y];d+=D}else if(E=="acTL")_.tabs[E]={num_frames:m(l,h),num_plays:m(l,h+4)},c=new Uint8Array(l.length);else if(E=="fcTL"){if(f!=0){var p=_.frames[_.frames.length-1];p.data=s.decode._decompress(_,c.slice(0,f),p.rect.width,p.rect.height),f=0}var x={x:m(l,h+12),y:m(l,h+16),width:m(l,h+4),height:m(l,h+8)},w=g(l,h+22);w=g(l,h+20)/(w==0?100:w);var C={rect:x,delay:Math.round(w*1e3),dispose:l[h+24],blend:l[h+25]};_.frames.push(C)}else if(E=="fdAT"){for(var y=0;y<D-4;y++)c[f+y]=l[h+y+4];f+=D-4}else if(E=="pHYs")_.tabs[E]=[u.readUint(l,h),u.readUint(l,h+4),l[h+8]];else if(E=="cHRM"){_.tabs[E]=[];for(var y=0;y<8;y++)_.tabs[E].push(u.readUint(l,h+y*4))}else if(E=="tEXt"){_.tabs[E]==null&&(_.tabs[E]={});var S=u.nextZero(l,h),A=u.readASCII(l,h,S-h),P=u.readASCII(l,S+1,h+D-S-1);_.tabs[E][A]=P}else if(E=="iTXt"){_.tabs[E]==null&&(_.tabs[E]={});var S=0,O=h;S=u.nextZero(l,O);var A=u.readASCII(l,O,S-O);O=S+1,l[O],l[O+1],O+=2,S=u.nextZero(l,O),u.readASCII(l,O,S-O),O=S+1,S=u.nextZero(l,O),u.readUTF8(l,O,S-O),O=S+1;var P=u.readUTF8(l,O,D-(O-h));_.tabs[E][A]=P}else if(E=="PLTE")_.tabs[E]=u.readBytes(l,h,D);else if(E=="hIST"){var F=_.tabs.PLTE.length/3;_.tabs[E]=[];for(var y=0;y<F;y++)_.tabs[E].push(g(l,h+y*2))}else if(E=="tRNS")_.ctype==3?_.tabs[E]=u.readBytes(l,h,D):_.ctype==0?_.tabs[E]=g(l,h):_.ctype==2&&(_.tabs[E]=[g(l,h),g(l,h+2),g(l,h+4)]);else if(E=="gAMA")_.tabs[E]=u.readUint(l,h)/1e5;else if(E=="sRGB")_.tabs[E]=l[h];else if(E=="bKGD")_.ctype==0||_.ctype==4?_.tabs[E]=[g(l,h)]:_.ctype==2||_.ctype==6?_.tabs[E]=[g(l,h),g(l,h+2),g(l,h+4)]:_.ctype==3&&(_.tabs[E]=l[h]);else if(E=="IEND"){if(f!=0){var p=_.frames[_.frames.length-1];p.data=s.decode._decompress(_,c.slice(0,f),p.rect.width,p.rect.height),f=0}_.data=s.decode._decompress(_,b,_.width,_.height);break}h+=D,u.readUint(l,h),h+=4}return delete _.compress,delete _.interlace,delete _.filter,_},s.decode._decompress=function(a,l,h,u){return a.compress==0&&(l=s.decode._inflate(l)),a.interlace==0?l=s.decode._filterZero(l,a,0,h,u):a.interlace==1&&(l=s.decode._readInterlace(l,a)),l},s.decode._inflate=function(a){return o.inflate(a)},s.decode._readInterlace=function(a,l){for(var h=l.width,u=l.height,g=s.decode._getBPP(l),m=g>>3,_=Math.ceil(h*g/8),b=new Uint8Array(u*_),d=0,c=[0,0,4,0,2,0,1],f=[0,4,0,2,0,1,0],v=[8,8,8,4,4,2,2],y=[8,8,4,4,2,2,1],D=0;D<7;){for(var E=v[D],p=y[D],x=0,w=0,C=c[D];C<u;)C+=E,w++;for(var S=f[D];S<h;)S+=p,x++;var A=Math.ceil(x*g/8);s.decode._filterZero(a,l,d,x,w);for(var P=0,O=c[D];O<u;){for(var F=f[D],I=d+P*A<<3;F<h;){if(g==1){var B=a[I>>3];B=B>>7-(I&7)&1,b[O*_+(F>>3)]|=B<<7-((F&3)<<0)}if(g==2){var B=a[I>>3];B=B>>6-(I&7)&3,b[O*_+(F>>2)]|=B<<6-((F&3)<<1)}if(g==4){var B=a[I>>3];B=B>>4-(I&7)&15,b[O*_+(F>>1)]|=B<<4-((F&1)<<2)}if(g>=8)for(var k=O*_+F*m,U=0;U<m;U++)b[k+U]=a[(I>>3)+U];I+=g,F+=p}P++,O+=E}x*w!=0&&(d+=w*(1+A)),D=D+1}return b},s.decode._getBPP=function(a){var l=[1,null,3,1,2,null,4][a.ctype];return l*a.depth},s.decode._filterZero=function(a,l,h,u,g){var m=s.decode._getBPP(l),_=Math.ceil(u*m/8),b=s.decode._paeth;m=Math.ceil(m/8);for(var d=0;d<g;d++){var c=h+d*_,f=c+d+1,v=a[f-1];if(v==0)for(var y=0;y<_;y++)a[c+y]=a[f+y];else if(v==1){for(var y=0;y<m;y++)a[c+y]=a[f+y];for(var y=m;y<_;y++)a[c+y]=a[f+y]+a[c+y-m]&255}else if(d==0){for(var y=0;y<m;y++)a[c+y]=a[f+y];if(v==2)for(var y=m;y<_;y++)a[c+y]=a[f+y]&255;if(v==3)for(var y=m;y<_;y++)a[c+y]=a[f+y]+(a[c+y-m]>>1)&255;if(v==4)for(var y=m;y<_;y++)a[c+y]=a[f+y]+b(a[c+y-m],0,0)&255}else{if(v==2)for(var y=0;y<_;y++)a[c+y]=a[f+y]+a[c+y-_]&255;if(v==3){for(var y=0;y<m;y++)a[c+y]=a[f+y]+(a[c+y-_]>>1)&255;for(var y=m;y<_;y++)a[c+y]=a[f+y]+(a[c+y-_]+a[c+y-m]>>1)&255}if(v==4){for(var y=0;y<m;y++)a[c+y]=a[f+y]+b(0,a[c+y-_],0)&255;for(var y=m;y<_;y++)a[c+y]=a[f+y]+b(a[c+y-m],a[c+y-_],a[c+y-m-_])&255}}}return a},s.decode._paeth=function(a,l,h){var u=a+l-h,g=Math.abs(u-a),m=Math.abs(u-l),_=Math.abs(u-h);return g<=m&&g<=_?a:m<=_?l:h},s.decode._IHDR=function(a,l,h){var u=s._bin;h.width=u.readUint(a,l),l+=4,h.height=u.readUint(a,l),l+=4,h.depth=a[l],l++,h.ctype=a[l],l++,h.compress=a[l],l++,h.filter=a[l],l++,h.interlace=a[l],l++},s._bin={nextZero:function(a,l){for(;a[l]!=0;)l++;return l},readUshort:function(a,l){return a[l]<<8|a[l+1]},writeUshort:function(a,l,h){a[l]=h>>8&255,a[l+1]=h&255},readUint:function(a,l){return a[l]*16777216+(a[l+1]<<16|a[l+2]<<8|a[l+3])},writeUint:function(a,l,h){a[l]=h>>24&255,a[l+1]=h>>16&255,a[l+2]=h>>8&255,a[l+3]=h&255},readASCII:function(a,l,h){for(var u="",g=0;g<h;g++)u+=String.fromCharCode(a[l+g]);return u},writeASCII:function(a,l,h){for(var u=0;u<h.length;u++)a[l+u]=h.charCodeAt(u)},readBytes:function(a,l,h){for(var u=[],g=0;g<h;g++)u.push(a[l+g]);return u},pad:function(a){return a.length<2?"0"+a:a},readUTF8:function(a,l,h){for(var u="",g,m=0;m<h;m++)u+="%"+s._bin.pad(a[l+m].toString(16));try{g=decodeURIComponent(u)}catch{return s._bin.readASCII(a,l,h)}return g}},s._copyTile=function(a,l,h,u,g,m,_,b,d){for(var c=Math.min(l,g),f=Math.min(h,m),v=0,y=0,D=0;D<f;D++)for(var E=0;E<c;E++)if(_>=0&&b>=0?(v=D*l+E<<2,y=(b+D)*g+_+E<<2):(v=(-b+D)*l-_+E<<2,y=D*g+E<<2),d==0)u[y]=a[v],u[y+1]=a[v+1],u[y+2]=a[v+2],u[y+3]=a[v+3];else if(d==1){var p=a[v+3]*.00392156862745098,x=a[v]*p,w=a[v+1]*p,C=a[v+2]*p,S=u[y+3]*(1/255),A=u[y]*S,P=u[y+1]*S,O=u[y+2]*S,F=1-p,I=p+S*F,B=I==0?0:1/I;u[y+3]=255*I,u[y+0]=(x+A*F)*B,u[y+1]=(w+P*F)*B,u[y+2]=(C+O*F)*B}else if(d==2){var p=a[v+3],x=a[v],w=a[v+1],C=a[v+2],S=u[y+3],A=u[y],P=u[y+1],O=u[y+2];p==S&&x==A&&w==P&&C==O?(u[y]=0,u[y+1]=0,u[y+2]=0,u[y+3]=0):(u[y]=x,u[y+1]=w,u[y+2]=C,u[y+3]=p)}else if(d==3){var p=a[v+3],x=a[v],w=a[v+1],C=a[v+2],S=u[y+3],A=u[y],P=u[y+1],O=u[y+2];if(p==S&&x==A&&w==P&&C==O)continue;if(p<220&&S>20)return!1}return!0},s.encode=function(a,l,h,u,g,m){u==null&&(u=0),m==null&&(m=!1);for(var _=new Uint8Array(a[0].byteLength*a.length+100),b=[137,80,78,71,13,10,26,10],d=0;d<8;d++)_[d]=b[d];var c=8,f=s._bin,v=s.crc.crc,y=f.writeUint,D=f.writeUshort,E=f.writeASCII,p=s.encode.compressPNG(a,l,h,u,m);y(_,c,13),c+=4,E(_,c,"IHDR"),c+=4,y(_,c,l),c+=4,y(_,c,h),c+=4,_[c]=p.depth,c++,_[c]=p.ctype,c++,_[c]=0,c++,_[c]=0,c++,_[c]=0,c++,y(_,c,v(_,c-17,17)),c+=4,y(_,c,1),c+=4,E(_,c,"sRGB"),c+=4,_[c]=1,c++,y(_,c,v(_,c-5,5)),c+=4;var x=a.length>1;if(x&&(y(_,c,8),c+=4,E(_,c,"acTL"),c+=4,y(_,c,a.length),c+=4,y(_,c,0),c+=4,y(_,c,v(_,c-12,12)),c+=4),p.ctype==3){var w=p.plte.length;y(_,c,w*3),c+=4,E(_,c,"PLTE"),c+=4;for(var d=0;d<w;d++){var C=d*3,S=p.plte[d],A=S&255,P=S>>8&255,O=S>>16&255;_[c+C+0]=A,_[c+C+1]=P,_[c+C+2]=O}if(c+=w*3,y(_,c,v(_,c-w*3-4,w*3+4)),c+=4,p.gotAlpha){y(_,c,w),c+=4,E(_,c,"tRNS"),c+=4;for(var d=0;d<w;d++)_[c+d]=p.plte[d]>>24&255;c+=w,y(_,c,v(_,c-w-4,w+4)),c+=4}}for(var F=0,I=0;I<p.frames.length;I++){var B=p.frames[I];x&&(y(_,c,26),c+=4,E(_,c,"fcTL"),c+=4,y(_,c,F++),c+=4,y(_,c,B.rect.width),c+=4,y(_,c,B.rect.height),c+=4,y(_,c,B.rect.x),c+=4,y(_,c,B.rect.y),c+=4,D(_,c,g[I]),c+=2,D(_,c,1e3),c+=2,_[c]=B.dispose,c++,_[c]=B.blend,c++,y(_,c,v(_,c-30,30)),c+=4);var k=B.cimg,w=k.length;y(_,c,w+(I==0?0:4)),c+=4;var U=c;E(_,c,I==0?"IDAT":"fdAT"),c+=4,I!=0&&(y(_,c,F++),c+=4);for(var d=0;d<w;d++)_[c+d]=k[d];c+=w,y(_,c,v(_,U,c-U)),c+=4}return y(_,c,0),c+=4,E(_,c,"IEND"),c+=4,y(_,c,v(_,c-4,4)),c+=4,_.buffer.slice(0,c)},s.encode.compressPNG=function(a,l,h,u,g){for(var m=s.encode.compress(a,l,h,u,!1,g),_=0;_<a.length;_++){var b=m.frames[_];b.rect.width;var d=b.rect.height,c=b.bpl,f=b.bpp,v=new Uint8Array(d*c+d);b.cimg=s.encode._filterZero(b.img,d,f,c,v)}return m},s.encode.compress=function(a,l,h,u,g,m){m==null&&(m=!1);for(var _=6,b=8,d=4,c=255,f=0;f<a.length;f++)for(var v=new Uint8Array(a[f]),y=v.length,D=0;D<y;D+=4)c&=v[D+3];var E=c!=255,p={},x=[];if(a.length!=0&&(p[0]=0,x.push(0),u!=0&&u--),u!=0){var w=s.quantize(a,u,g);a=w.bufs;for(var D=0;D<w.plte.length;D++){var C=w.plte[D].est.rgba;p[C]==null&&(p[C]=x.length,x.push(C))}}else for(var f=0;f<a.length;f++)for(var S=new Uint32Array(a[f]),y=S.length,D=0;D<y;D++){var C=S[D];if((D<l||C!=S[D-1]&&C!=S[D-l])&&p[C]==null&&(p[C]=x.length,x.push(C),x.length>=300))break}var A=E?g:!1,P=x.length;P<=256&&m==!1&&(P<=2?b=1:P<=4?b=2:P<=16?b=4:b=8,g&&(b=8),E=!0);for(var O=[],f=0;f<a.length;f++){var F=new Uint8Array(a[f]),I=new Uint32Array(F.buffer),B=0,k=0,U=l,W=h,R=0;if(f!=0&&!A){for(var z=g||f==1||O[O.length-2].dispose==2?1:2,V=0,q=1e9,Q=0;Q<z;Q++){for(var pe=new Uint8Array(a[f-1-Q]),re=new Uint32Array(a[f-1-Q]),te=l,ae=h,ne=-1,le=-1,Ee=0;Ee<h;Ee++)for(var De=0;De<l;De++){var D=Ee*l+De;I[D]!=re[D]&&(De<te&&(te=De),De>ne&&(ne=De),Ee<ae&&(ae=Ee),Ee>le&&(le=Ee))}var Pe=ne==-1?1:(ne-te+1)*(le-ae+1);Pe<q&&(q=Pe,V=Q,ne==-1?(B=k=0,U=W=1):(B=te,k=ae,U=ne-te+1,W=le-ae+1))}var pe=new Uint8Array(a[f-1-V]);V==1&&(O[O.length-1].dispose=2);var Z=new Uint8Array(U*W*4);new Uint32Array(Z.buffer),s._copyTile(pe,l,h,Z,U,W,-B,-k,0),s._copyTile(F,l,h,Z,U,W,-B,-k,3)?(s._copyTile(F,l,h,Z,U,W,-B,-k,2),R=1):(s._copyTile(F,l,h,Z,U,W,-B,-k,0),R=0),F=Z,I=new Uint32Array(F.buffer)}var be=4*U;if(P<=256&&m==!1){be=Math.ceil(b*U/8);for(var Z=new Uint8Array(be*W),Ee=0;Ee<W;Ee++){var D=Ee*be,Ce=Ee*U;if(b==8)for(var De=0;De<U;De++)Z[D+De]=p[I[Ce+De]];else if(b==4)for(var De=0;De<U;De++)Z[D+(De>>1)]|=p[I[Ce+De]]<<4-(De&1)*4;else if(b==2)for(var De=0;De<U;De++)Z[D+(De>>2)]|=p[I[Ce+De]]<<6-(De&3)*2;else if(b==1)for(var De=0;De<U;De++)Z[D+(De>>3)]|=p[I[Ce+De]]<<7-(De&7)*1}F=Z,_=3,d=1}else if(E==!1&&a.length==1){for(var Z=new Uint8Array(U*W*3),ie=U*W,D=0;D<ie;D++){var Ne=D*3,Ve=D*4;Z[Ne]=F[Ve],Z[Ne+1]=F[Ve+1],Z[Ne+2]=F[Ve+2]}F=Z,_=2,d=3,be=3*U}O.push({rect:{x:B,y:k,width:U,height:W},img:F,bpl:be,bpp:d,blend:R,dispose:A?1:0})}return{ctype:_,depth:b,plte:x,gotAlpha:E,frames:O}},s.encode._filterZero=function(a,l,h,u,g){for(var m=[],_=0;_<5;_++)if(!(l*u>5e5&&(_==2||_==3||_==4))){for(var b=0;b<l;b++)s.encode._filterLine(g,a,b,u,h,_);if(m.push(o.deflate(g)),h==1)break}for(var d,c=1e9,f=0;f<m.length;f++)m[f].length<c&&(d=f,c=m[f].length);return m[d]},s.encode._filterLine=function(a,l,h,u,g,m){var _=h*u,b=_+h,d=s.decode._paeth;if(a[b]=m,b++,m==0)for(var c=0;c<u;c++)a[b+c]=l[_+c];else if(m==1){for(var c=0;c<g;c++)a[b+c]=l[_+c];for(var c=g;c<u;c++)a[b+c]=l[_+c]-l[_+c-g]+256&255}else if(h==0){for(var c=0;c<g;c++)a[b+c]=l[_+c];if(m==2)for(var c=g;c<u;c++)a[b+c]=l[_+c];if(m==3)for(var c=g;c<u;c++)a[b+c]=l[_+c]-(l[_+c-g]>>1)+256&255;if(m==4)for(var c=g;c<u;c++)a[b+c]=l[_+c]-d(l[_+c-g],0,0)+256&255}else{if(m==2)for(var c=0;c<u;c++)a[b+c]=l[_+c]+256-l[_+c-u]&255;if(m==3){for(var c=0;c<g;c++)a[b+c]=l[_+c]+256-(l[_+c-u]>>1)&255;for(var c=g;c<u;c++)a[b+c]=l[_+c]+256-(l[_+c-u]+l[_+c-g]>>1)&255}if(m==4){for(var c=0;c<g;c++)a[b+c]=l[_+c]+256-d(0,l[_+c-u],0)&255;for(var c=g;c<u;c++)a[b+c]=l[_+c]+256-d(l[_+c-g],l[_+c-u],l[_+c-g-u])&255}}},s.crc={table:function(){for(var a=new Uint32Array(256),l=0;l<256;l++){for(var h=l,u=0;u<8;u++)h&1?h=3988292384^h>>>1:h=h>>>1;a[l]=h}return a}(),update:function(a,l,h,u){for(var g=0;g<u;g++)a=s.crc.table[(a^l[h+g])&255]^a>>>8;return a},crc:function(a,l,h){return s.crc.update(4294967295,a,l,h)^4294967295}},s.quantize=function(a,l,h){for(var u=[],g=0,m=0;m<a.length;m++)u.push(s.encode.alphaMul(new Uint8Array(a[m]),h)),g+=a[m].byteLength;for(var _=new Uint8Array(g),b=new Uint32Array(_.buffer),d=0,m=0;m<u.length;m++){for(var c=u[m],f=c.length,v=0;v<f;v++)_[d+v]=c[v];d+=f}var y={i0:0,i1:_.length,bst:null,est:null,tdst:0,left:null,right:null};y.bst=s.quantize.stats(_,y.i0,y.i1),y.est=s.quantize.estats(y.bst);for(var D=[y];D.length<l;){for(var E=0,p=0,m=0;m<D.length;m++)D[m].est.L>E&&(E=D[m].est.L,p=m);if(E<.001)break;var x=D[p],w=s.quantize.splitPixels(_,b,x.i0,x.i1,x.est.e,x.est.eMq255),C={i0:x.i0,i1:w,bst:null,est:null,tdst:0,left:null,right:null};C.bst=s.quantize.stats(_,C.i0,C.i1),C.est=s.quantize.estats(C.bst);var S={i0:w,i1:x.i1,bst:null,est:null,tdst:0,left:null,right:null};S.bst={R:[],m:[],N:x.bst.N-C.bst.N};for(var m=0;m<16;m++)S.bst.R[m]=x.bst.R[m]-C.bst.R[m];for(var m=0;m<4;m++)S.bst.m[m]=x.bst.m[m]-C.bst.m[m];S.est=s.quantize.estats(S.bst),x.left=C,x.right=S,D[p]=C,D.push(S)}D.sort(function(z,V){return V.bst.N-z.bst.N});for(var A=0;A<u.length;A++){for(var P=s.quantize.planeDst,O=new Uint8Array(u[A].buffer),F=new Uint32Array(u[A].buffer),I=O.length,m=0;m<I;m+=4){for(var B=O[m]*.00392156862745098,k=O[m+1]*(1/255),U=O[m+2]*(1/255),W=O[m+3]*(1/255),R=y;R.left;)R=P(R.est,B,k,U,W)<=0?R.left:R.right;F[m>>2]=R.est.rgba}u[A]=F.buffer}return{bufs:u,plte:D}},s.quantize.getNearest=function(a,l,h,u,g){if(a.left==null)return a.tdst=s.quantize.dist(a.est.q,l,h,u,g),a;var m=s.quantize.planeDst(a.est,l,h,u,g),_=a.left,b=a.right;m>0&&(_=a.right,b=a.left);var d=s.quantize.getNearest(_,l,h,u,g);if(d.tdst<=m*m)return d;var c=s.quantize.getNearest(b,l,h,u,g);return c.tdst<d.tdst?c:d},s.quantize.planeDst=function(a,l,h,u,g){var m=a.e;return m[0]*l+m[1]*h+m[2]*u+m[3]*g-a.eMq},s.quantize.dist=function(a,l,h,u,g){var m=l-a[0],_=h-a[1],b=u-a[2],d=g-a[3];return m*m+_*_+b*b+d*d},s.quantize.splitPixels=function(a,l,h,u,g,m){var _=s.quantize.vecDot;for(u-=4;h<u;){for(;_(a,h,g)<=m;)h+=4;for(;_(a,u,g)>m;)u-=4;if(h>=u)break;var b=l[h>>2];l[h>>2]=l[u>>2],l[u>>2]=b,h+=4,u-=4}for(;_(a,h,g)>m;)h-=4;return h+4},s.quantize.vecDot=function(a,l,h){return a[l]*h[0]+a[l+1]*h[1]+a[l+2]*h[2]+a[l+3]*h[3]},s.quantize.stats=function(a,l,h){for(var u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=[0,0,0,0],m=h-l>>2,_=l;_<h;_+=4){var b=a[_]*.00392156862745098,d=a[_+1]*(1/255),c=a[_+2]*(1/255),f=a[_+3]*(1/255);g[0]+=b,g[1]+=d,g[2]+=c,g[3]+=f,u[0]+=b*b,u[1]+=b*d,u[2]+=b*c,u[3]+=b*f,u[5]+=d*d,u[6]+=d*c,u[7]+=d*f,u[10]+=c*c,u[11]+=c*f,u[15]+=f*f}return u[4]=u[1],u[8]=u[2],u[12]=u[3],u[9]=u[6],u[13]=u[7],u[14]=u[11],{R:u,m:g,N:m}},s.quantize.estats=function(a){var l=a.R,h=a.m,u=a.N,g=h[0],m=h[1],_=h[2],b=h[3],d=u==0?0:1/u,c=[l[0]-g*g*d,l[1]-g*m*d,l[2]-g*_*d,l[3]-g*b*d,l[4]-m*g*d,l[5]-m*m*d,l[6]-m*_*d,l[7]-m*b*d,l[8]-_*g*d,l[9]-_*m*d,l[10]-_*_*d,l[11]-_*b*d,l[12]-b*g*d,l[13]-b*m*d,l[14]-b*_*d,l[15]-b*b*d],f=c,v=s.M4,y=[.5,.5,.5,.5],D=0,E=0;if(u!=0)for(var p=0;p<10&&(y=v.multVec(f,y),E=Math.sqrt(v.dot(y,y)),y=v.sml(1/E,y),!(Math.abs(E-D)<1e-9));p++)D=E;var x=[g*d,m*d,_*d,b*d],w=v.dot(v.sml(255,x),y),C=x[3]<.001?0:1/x[3];return{Cov:c,q:x,e:y,L:D,eMq255:w,eMq:v.dot(y,x),rgba:(Math.round(255*x[3])<<24|Math.round(255*x[2]*C)<<16|Math.round(255*x[1]*C)<<8|Math.round(255*x[0]*C)<<0)>>>0}},s.M4={multVec:function(a,l){return[a[0]*l[0]+a[1]*l[1]+a[2]*l[2]+a[3]*l[3],a[4]*l[0]+a[5]*l[1]+a[6]*l[2]+a[7]*l[3],a[8]*l[0]+a[9]*l[1]+a[10]*l[2]+a[11]*l[3],a[12]*l[0]+a[13]*l[1]+a[14]*l[2]+a[15]*l[3]]},dot:function(a,l){return a[0]*l[0]+a[1]*l[1]+a[2]*l[2]+a[3]*l[3]},sml:function(a,l){return[a*l[0],a*l[1],a*l[2],a*l[3]]}},s.encode.alphaMul=function(a,l){for(var h=new Uint8Array(a.length),u=a.length>>2,g=0;g<u;g++){var m=g<<2,_=a[m+3];l&&(_=_<128?0:255);var b=_*(1/255);h[m+0]=a[m+0]*b,h[m+1]=a[m+1]*b,h[m+2]=a[m+2]*b,h[m+3]=_}return h}}(i,n)})()},"./node_modules/upng-js/node_modules/pako/index.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,n=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),a={};i(a,n,s,o),r.exports=a},"./node_modules/upng-js/node_modules/pako/lib/deflate.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),n=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),l=Object.prototype.toString,h=0,u=4,g=0,m=1,_=2,b=-1,d=0,c=8;function f(E){if(!(this instanceof f))return new f(E);this.options=n.assign({level:b,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},E||{});var p=this.options;p.raw&&p.windowBits>0?p.windowBits=-p.windowBits:p.gzip&&p.windowBits>0&&p.windowBits<16&&(p.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var x=i.deflateInit2(this.strm,p.level,p.method,p.windowBits,p.memLevel,p.strategy);if(x!==g)throw new Error(o[x]);if(p.header&&i.deflateSetHeader(this.strm,p.header),p.dictionary){var w;if(typeof p.dictionary=="string"?w=s.string2buf(p.dictionary):l.call(p.dictionary)==="[object ArrayBuffer]"?w=new Uint8Array(p.dictionary):w=p.dictionary,x=i.deflateSetDictionary(this.strm,w),x!==g)throw new Error(o[x]);this._dict_set=!0}}f.prototype.push=function(E,p){var x=this.strm,w=this.options.chunkSize,C,S;if(this.ended)return!1;S=p===~~p?p:p===!0?u:h,typeof E=="string"?x.input=s.string2buf(E):l.call(E)==="[object ArrayBuffer]"?x.input=new Uint8Array(E):x.input=E,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new n.Buf8(w),x.next_out=0,x.avail_out=w),C=i.deflate(x,S),C!==m&&C!==g)return this.onEnd(C),this.ended=!0,!1;(x.avail_out===0||x.avail_in===0&&(S===u||S===_))&&(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(x.output,x.next_out))):this.onData(n.shrinkBuf(x.output,x.next_out)))}while((x.avail_in>0||x.avail_out===0)&&C!==m);return S===u?(C=i.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===g):(S===_&&(this.onEnd(g),x.avail_out=0),!0)},f.prototype.onData=function(E){this.chunks.push(E)},f.prototype.onEnd=function(E){E===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg};function v(E,p){var x=new f(p);if(x.push(E,!0),x.err)throw x.msg||o[x.err];return x.result}function y(E,p){return p=p||{},p.raw=!0,v(E,p)}function D(E,p){return p=p||{},p.gzip=!0,v(E,p)}e.Deflate=f,e.deflate=v,e.deflateRaw=y,e.gzip=D},"./node_modules/upng-js/node_modules/pako/lib/inflate.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),n=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),l=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),u=Object.prototype.toString;function g(b){if(!(this instanceof g))return new g(b);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},b||{});var d=this.options;d.raw&&d.windowBits>=0&&d.windowBits<16&&(d.windowBits=-d.windowBits,d.windowBits===0&&(d.windowBits=-15)),d.windowBits>=0&&d.windowBits<16&&!(b&&b.windowBits)&&(d.windowBits+=32),d.windowBits>15&&d.windowBits<48&&(d.windowBits&15)===0&&(d.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var c=i.inflateInit2(this.strm,d.windowBits);if(c!==o.Z_OK)throw new Error(a[c]);if(this.header=new h,i.inflateGetHeader(this.strm,this.header),d.dictionary&&(typeof d.dictionary=="string"?d.dictionary=s.string2buf(d.dictionary):u.call(d.dictionary)==="[object ArrayBuffer]"&&(d.dictionary=new Uint8Array(d.dictionary)),d.raw&&(c=i.inflateSetDictionary(this.strm,d.dictionary),c!==o.Z_OK)))throw new Error(a[c])}g.prototype.push=function(b,d){var c=this.strm,f=this.options.chunkSize,v=this.options.dictionary,y,D,E,p,x,w=!1;if(this.ended)return!1;D=d===~~d?d:d===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof b=="string"?c.input=s.binstring2buf(b):u.call(b)==="[object ArrayBuffer]"?c.input=new Uint8Array(b):c.input=b,c.next_in=0,c.avail_in=c.input.length;do{if(c.avail_out===0&&(c.output=new n.Buf8(f),c.next_out=0,c.avail_out=f),y=i.inflate(c,o.Z_NO_FLUSH),y===o.Z_NEED_DICT&&v&&(y=i.inflateSetDictionary(this.strm,v)),y===o.Z_BUF_ERROR&&w===!0&&(y=o.Z_OK,w=!1),y!==o.Z_STREAM_END&&y!==o.Z_OK)return this.onEnd(y),this.ended=!0,!1;c.next_out&&(c.avail_out===0||y===o.Z_STREAM_END||c.avail_in===0&&(D===o.Z_FINISH||D===o.Z_SYNC_FLUSH))&&(this.options.to==="string"?(E=s.utf8border(c.output,c.next_out),p=c.next_out-E,x=s.buf2string(c.output,E),c.next_out=p,c.avail_out=f-p,p&&n.arraySet(c.output,c.output,E,p,0),this.onData(x)):this.onData(n.shrinkBuf(c.output,c.next_out))),c.avail_in===0&&c.avail_out===0&&(w=!0)}while((c.avail_in>0||c.avail_out===0)&&y!==o.Z_STREAM_END);return y===o.Z_STREAM_END&&(D=o.Z_FINISH),D===o.Z_FINISH?(y=i.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===o.Z_OK):(D===o.Z_SYNC_FLUSH&&(this.onEnd(o.Z_OK),c.avail_out=0),!0)},g.prototype.onData=function(b){this.chunks.push(b)},g.prototype.onEnd=function(b){b===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function m(b,d){var c=new g(d);if(c.push(b,!0),c.err)throw c.msg||a[c.err];return c.result}function _(b,d){return d=d||{},d.raw=!0,m(b,d)}e.Inflate=g,e.inflate=m,e.inflateRaw=_,e.ungzip=m},"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":(r,e)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function i(o,a){return Object.prototype.hasOwnProperty.call(o,a)}e.assign=function(o){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var l=a.shift();if(l){if(typeof l!="object")throw new TypeError(l+"must be non-object");for(var h in l)i(l,h)&&(o[h]=l[h])}}return o},e.shrinkBuf=function(o,a){return o.length===a?o:o.subarray?o.subarray(0,a):(o.length=a,o)};var n={arraySet:function(o,a,l,h,u){if(a.subarray&&o.subarray){o.set(a.subarray(l,l+h),u);return}for(var g=0;g<h;g++)o[u+g]=a[l+g]},flattenChunks:function(o){var a,l,h,u,g,m;for(h=0,a=0,l=o.length;a<l;a++)h+=o[a].length;for(m=new Uint8Array(h),u=0,a=0,l=o.length;a<l;a++)g=o[a],m.set(g,u),u+=g.length;return m}},s={arraySet:function(o,a,l,h,u){for(var g=0;g<h;g++)o[u+g]=a[l+g]},flattenChunks:function(o){return[].concat.apply([],o)}};e.setTyped=function(o){o?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)},"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1,e.string2buf=function(h){var u,g,m,_,b,d=h.length,c=0;for(_=0;_<d;_++)g=h.charCodeAt(_),(g&64512)===55296&&_+1<d&&(m=h.charCodeAt(_+1),(m&64512)===56320&&(g=65536+(g-55296<<10)+(m-56320),_++)),c+=g<128?1:g<2048?2:g<65536?3:4;for(u=new i.Buf8(c),b=0,_=0;b<c;_++)g=h.charCodeAt(_),(g&64512)===55296&&_+1<d&&(m=h.charCodeAt(_+1),(m&64512)===56320&&(g=65536+(g-55296<<10)+(m-56320),_++)),g<128?u[b++]=g:g<2048?(u[b++]=192|g>>>6,u[b++]=128|g&63):g<65536?(u[b++]=224|g>>>12,u[b++]=128|g>>>6&63,u[b++]=128|g&63):(u[b++]=240|g>>>18,u[b++]=128|g>>>12&63,u[b++]=128|g>>>6&63,u[b++]=128|g&63);return u};function l(h,u){if(u<65534&&(h.subarray&&s||!h.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(h,u));for(var g="",m=0;m<u;m++)g+=String.fromCharCode(h[m]);return g}e.buf2binstring=function(h){return l(h,h.length)},e.binstring2buf=function(h){for(var u=new i.Buf8(h.length),g=0,m=u.length;g<m;g++)u[g]=h.charCodeAt(g);return u},e.buf2string=function(h,u){var g,m,_,b,d=u||h.length,c=new Array(d*2);for(m=0,g=0;g<d;){if(_=h[g++],_<128){c[m++]=_;continue}if(b=o[_],b>4){c[m++]=65533,g+=b-1;continue}for(_&=b===2?31:b===3?15:7;b>1&&g<d;)_=_<<6|h[g++]&63,b--;if(b>1){c[m++]=65533;continue}_<65536?c[m++]=_:(_-=65536,c[m++]=55296|_>>10&1023,c[m++]=56320|_&1023)}return l(c,m)},e.utf8border=function(h,u){var g;for(u=u||h.length,u>h.length&&(u=h.length),g=u-1;g>=0&&(h[g]&192)===128;)g--;return g<0||g===0?u:g+o[h[g]]>u?g:u}},"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":r=>{function e(t,i,n,s){for(var o=t&65535|0,a=t>>>16&65535|0,l=0;n!==0;){l=n>2e3?2e3:n,n-=l;do o=o+i[s++]|0,a=a+o|0;while(--l);o%=65521,a%=65521}return o|a<<16|0}r.exports=e},"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":r=>{r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":r=>{function e(){for(var n,s=[],o=0;o<256;o++){n=o;for(var a=0;a<8;a++)n=n&1?3988292384^n>>>1:n>>>1;s[o]=n}return s}var t=e();function i(n,s,o,a){var l=t,h=a+o;n^=-1;for(var u=a;u<h;u++)n=n>>>8^l[(n^s[u])&255];return n^-1}r.exports=i},"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),n=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),l=0,h=1,u=3,g=4,m=5,_=0,b=1,d=-2,c=-3,f=-5,v=-1,y=1,D=2,E=3,p=4,x=0,w=2,C=8,S=9,A=15,P=8,O=29,F=256,I=F+1+O,B=30,k=19,U=2*I+1,W=15,R=3,z=258,V=z+R+1,q=32,Q=42,re=69,te=73,ae=91,ne=103,le=113,Ee=666,De=1,Pe=2,pe=3,Z=4,be=3;function Ce(L,ge){return L.msg=a[ge],ge}function ie(L){return(L<<1)-(L>4?9:0)}function Ne(L){for(var ge=L.length;--ge>=0;)L[ge]=0}function Ve(L){var ge=L.state,de=ge.pending;de>L.avail_out&&(de=L.avail_out),de!==0&&(i.arraySet(L.output,ge.pending_buf,ge.pending_out,de,L.next_out),L.next_out+=de,ge.pending_out+=de,L.total_out+=de,L.avail_out-=de,ge.pending-=de,ge.pending===0&&(ge.pending_out=0))}function Ue(L,ge){n._tr_flush_block(L,L.block_start>=0?L.block_start:-1,L.strstart-L.block_start,ge),L.block_start=L.strstart,Ve(L.strm)}function Fe(L,ge){L.pending_buf[L.pending++]=ge}function ze(L,ge){L.pending_buf[L.pending++]=ge>>>8&255,L.pending_buf[L.pending++]=ge&255}function Re(L,ge,de,j){var se=L.avail_in;return se>j&&(se=j),se===0?0:(L.avail_in-=se,i.arraySet(ge,L.input,L.next_in,se,de),L.state.wrap===1?L.adler=s(L.adler,ge,se,de):L.state.wrap===2&&(L.adler=o(L.adler,ge,se,de)),L.next_in+=se,L.total_in+=se,se)}function Le(L,ge){var de=L.max_chain_length,j=L.strstart,se,he,Ie=L.prev_length,Be=L.nice_match,we=L.strstart>L.w_size-V?L.strstart-(L.w_size-V):0,je=L.window,Xe=L.w_mask,Ke=L.prev,Je=L.strstart+z,Ye=je[j+Ie-1],rt=je[j+Ie];L.prev_length>=L.good_match&&(de>>=2),Be>L.lookahead&&(Be=L.lookahead);do if(se=ge,!(je[se+Ie]!==rt||je[se+Ie-1]!==Ye||je[se]!==je[j]||je[++se]!==je[j+1])){j+=2,se++;do;while(je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&je[++j]===je[++se]&&j<Je);if(he=z-(Je-j),j=Je-z,he>Ie){if(L.match_start=ge,Ie=he,he>=Be)break;Ye=je[j+Ie-1],rt=je[j+Ie]}}while((ge=Ke[ge&Xe])>we&&--de!==0);return Ie<=L.lookahead?Ie:L.lookahead}function We(L){var ge=L.w_size,de,j,se,he,Ie;do{if(he=L.window_size-L.lookahead-L.strstart,L.strstart>=ge+(ge-V)){i.arraySet(L.window,L.window,ge,ge,0),L.match_start-=ge,L.strstart-=ge,L.block_start-=ge,j=L.hash_size,de=j;do se=L.head[--de],L.head[de]=se>=ge?se-ge:0;while(--j);j=ge,de=j;do se=L.prev[--de],L.prev[de]=se>=ge?se-ge:0;while(--j);he+=ge}if(L.strm.avail_in===0)break;if(j=Re(L.strm,L.window,L.strstart+L.lookahead,he),L.lookahead+=j,L.lookahead+L.insert>=R)for(Ie=L.strstart-L.insert,L.ins_h=L.window[Ie],L.ins_h=(L.ins_h<<L.hash_shift^L.window[Ie+1])&L.hash_mask;L.insert&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[Ie+R-1])&L.hash_mask,L.prev[Ie&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=Ie,Ie++,L.insert--,!(L.lookahead+L.insert<R)););}while(L.lookahead<V&&L.strm.avail_in!==0)}function He(L,ge){var de=65535;for(de>L.pending_buf_size-5&&(de=L.pending_buf_size-5);;){if(L.lookahead<=1){if(We(L),L.lookahead===0&&ge===l)return De;if(L.lookahead===0)break}L.strstart+=L.lookahead,L.lookahead=0;var j=L.block_start+de;if((L.strstart===0||L.strstart>=j)&&(L.lookahead=L.strstart-j,L.strstart=j,Ue(L,!1),L.strm.avail_out===0)||L.strstart-L.block_start>=L.w_size-V&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===g?(Ue(L,!0),L.strm.avail_out===0?pe:Z):(L.strstart>L.block_start&&(Ue(L,!1),L.strm.avail_out===0),De)}function H(L,ge){for(var de,j;;){if(L.lookahead<V){if(We(L),L.lookahead<V&&ge===l)return De;if(L.lookahead===0)break}if(de=0,L.lookahead>=R&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),de!==0&&L.strstart-de<=L.w_size-V&&(L.match_length=Le(L,de)),L.match_length>=R)if(j=n._tr_tally(L,L.strstart-L.match_start,L.match_length-R),L.lookahead-=L.match_length,L.match_length<=L.max_lazy_match&&L.lookahead>=R){L.match_length--;do L.strstart++,L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart;while(--L.match_length!==0);L.strstart++}else L.strstart+=L.match_length,L.match_length=0,L.ins_h=L.window[L.strstart],L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+1])&L.hash_mask;else j=n._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++;if(j&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=L.strstart<R-1?L.strstart:R-1,ge===g?(Ue(L,!0),L.strm.avail_out===0?pe:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Pe}function K(L,ge){for(var de,j,se;;){if(L.lookahead<V){if(We(L),L.lookahead<V&&ge===l)return De;if(L.lookahead===0)break}if(de=0,L.lookahead>=R&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),L.prev_length=L.match_length,L.prev_match=L.match_start,L.match_length=R-1,de!==0&&L.prev_length<L.max_lazy_match&&L.strstart-de<=L.w_size-V&&(L.match_length=Le(L,de),L.match_length<=5&&(L.strategy===y||L.match_length===R&&L.strstart-L.match_start>4096)&&(L.match_length=R-1)),L.prev_length>=R&&L.match_length<=L.prev_length){se=L.strstart+L.lookahead-R,j=n._tr_tally(L,L.strstart-1-L.prev_match,L.prev_length-R),L.lookahead-=L.prev_length-1,L.prev_length-=2;do++L.strstart<=se&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+R-1])&L.hash_mask,de=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart);while(--L.prev_length!==0);if(L.match_available=0,L.match_length=R-1,L.strstart++,j&&(Ue(L,!1),L.strm.avail_out===0))return De}else if(L.match_available){if(j=n._tr_tally(L,0,L.window[L.strstart-1]),j&&Ue(L,!1),L.strstart++,L.lookahead--,L.strm.avail_out===0)return De}else L.match_available=1,L.strstart++,L.lookahead--}return L.match_available&&(j=n._tr_tally(L,0,L.window[L.strstart-1]),L.match_available=0),L.insert=L.strstart<R-1?L.strstart:R-1,ge===g?(Ue(L,!0),L.strm.avail_out===0?pe:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Pe}function X(L,ge){for(var de,j,se,he,Ie=L.window;;){if(L.lookahead<=z){if(We(L),L.lookahead<=z&&ge===l)return De;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=R&&L.strstart>0&&(se=L.strstart-1,j=Ie[se],j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se])){he=L.strstart+z;do;while(j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&j===Ie[++se]&&se<he);L.match_length=z-(he-se),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=R?(de=n._tr_tally(L,1,L.match_length-R),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(de=n._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),de&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===g?(Ue(L,!0),L.strm.avail_out===0?pe:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Pe}function _e(L,ge){for(var de;;){if(L.lookahead===0&&(We(L),L.lookahead===0)){if(ge===l)return De;break}if(L.match_length=0,de=n._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,de&&(Ue(L,!1),L.strm.avail_out===0))return De}return L.insert=0,ge===g?(Ue(L,!0),L.strm.avail_out===0?pe:Z):L.last_lit&&(Ue(L,!1),L.strm.avail_out===0)?De:Pe}function ue(L,ge,de,j,se){this.good_length=L,this.max_lazy=ge,this.nice_length=de,this.max_chain=j,this.func=se}var ye;ye=[new ue(0,0,0,0,He),new ue(4,4,8,4,H),new ue(4,5,16,8,H),new ue(4,6,32,32,H),new ue(4,4,16,16,K),new ue(8,16,32,32,K),new ue(8,16,128,128,K),new ue(8,32,128,256,K),new ue(32,128,258,1024,K),new ue(32,258,258,4096,K)];function Ae(L){L.window_size=2*L.w_size,Ne(L.head),L.max_lazy_match=ye[L.level].max_lazy,L.good_match=ye[L.level].good_length,L.nice_match=ye[L.level].nice_length,L.max_chain_length=ye[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=R-1,L.match_available=0,L.ins_h=0}function G(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(U*2),this.dyn_dtree=new i.Buf16((2*B+1)*2),this.bl_tree=new i.Buf16((2*k+1)*2),Ne(this.dyn_ltree),Ne(this.dyn_dtree),Ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(W+1),this.heap=new i.Buf16(2*I+1),Ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*I+1),Ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(L){var ge;return!L||!L.state?Ce(L,d):(L.total_in=L.total_out=0,L.data_type=w,ge=L.state,ge.pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?Q:le,L.adler=ge.wrap===2?0:1,ge.last_flush=l,n._tr_init(ge),_)}function ve(L){var ge=ce(L);return ge===_&&Ae(L.state),ge}function Oe(L,ge){return!L||!L.state||L.state.wrap!==2?d:(L.state.gzhead=ge,_)}function oe(L,ge,de,j,se,he){if(!L)return d;var Ie=1;if(ge===v&&(ge=6),j<0?(Ie=0,j=-j):j>15&&(Ie=2,j-=16),se<1||se>S||de!==C||j<8||j>15||ge<0||ge>9||he<0||he>p)return Ce(L,d);j===8&&(j=9);var Be=new G;return L.state=Be,Be.strm=L,Be.wrap=Ie,Be.gzhead=null,Be.w_bits=j,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=se+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+R-1)/R),Be.window=new i.Buf8(Be.w_size*2),Be.head=new i.Buf16(Be.hash_size),Be.prev=new i.Buf16(Be.w_size),Be.lit_bufsize=1<<se+6,Be.pending_buf_size=Be.lit_bufsize*4,Be.pending_buf=new i.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ge,Be.strategy=he,Be.method=de,ve(L)}function me(L,ge){return oe(L,ge,C,A,P,x)}function $(L,ge){var de,j,se,he;if(!L||!L.state||ge>m||ge<0)return L?Ce(L,d):d;if(j=L.state,!L.output||!L.input&&L.avail_in!==0||j.status===Ee&&ge!==g)return Ce(L,L.avail_out===0?f:d);if(j.strm=L,de=j.last_flush,j.last_flush=ge,j.status===Q)if(j.wrap===2)L.adler=0,Fe(j,31),Fe(j,139),Fe(j,8),j.gzhead?(Fe(j,(j.gzhead.text?1:0)+(j.gzhead.hcrc?2:0)+(j.gzhead.extra?4:0)+(j.gzhead.name?8:0)+(j.gzhead.comment?16:0)),Fe(j,j.gzhead.time&255),Fe(j,j.gzhead.time>>8&255),Fe(j,j.gzhead.time>>16&255),Fe(j,j.gzhead.time>>24&255),Fe(j,j.level===9?2:j.strategy>=D||j.level<2?4:0),Fe(j,j.gzhead.os&255),j.gzhead.extra&&j.gzhead.extra.length&&(Fe(j,j.gzhead.extra.length&255),Fe(j,j.gzhead.extra.length>>8&255)),j.gzhead.hcrc&&(L.adler=o(L.adler,j.pending_buf,j.pending,0)),j.gzindex=0,j.status=re):(Fe(j,0),Fe(j,0),Fe(j,0),Fe(j,0),Fe(j,0),Fe(j,j.level===9?2:j.strategy>=D||j.level<2?4:0),Fe(j,be),j.status=le);else{var Ie=C+(j.w_bits-8<<4)<<8,Be=-1;j.strategy>=D||j.level<2?Be=0:j.level<6?Be=1:j.level===6?Be=2:Be=3,Ie|=Be<<6,j.strstart!==0&&(Ie|=q),Ie+=31-Ie%31,j.status=le,ze(j,Ie),j.strstart!==0&&(ze(j,L.adler>>>16),ze(j,L.adler&65535)),L.adler=1}if(j.status===re)if(j.gzhead.extra){for(se=j.pending;j.gzindex<(j.gzhead.extra.length&65535)&&!(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),Ve(L),se=j.pending,j.pending===j.pending_buf_size));)Fe(j,j.gzhead.extra[j.gzindex]&255),j.gzindex++;j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),j.gzindex===j.gzhead.extra.length&&(j.gzindex=0,j.status=te)}else j.status=te;if(j.status===te)if(j.gzhead.name){se=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),Ve(L),se=j.pending,j.pending===j.pending_buf_size)){he=1;break}j.gzindex<j.gzhead.name.length?he=j.gzhead.name.charCodeAt(j.gzindex++)&255:he=0,Fe(j,he)}while(he!==0);j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),he===0&&(j.gzindex=0,j.status=ae)}else j.status=ae;if(j.status===ae)if(j.gzhead.comment){se=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),Ve(L),se=j.pending,j.pending===j.pending_buf_size)){he=1;break}j.gzindex<j.gzhead.comment.length?he=j.gzhead.comment.charCodeAt(j.gzindex++)&255:he=0,Fe(j,he)}while(he!==0);j.gzhead.hcrc&&j.pending>se&&(L.adler=o(L.adler,j.pending_buf,j.pending-se,se)),he===0&&(j.status=ne)}else j.status=ne;if(j.status===ne&&(j.gzhead.hcrc?(j.pending+2>j.pending_buf_size&&Ve(L),j.pending+2<=j.pending_buf_size&&(Fe(j,L.adler&255),Fe(j,L.adler>>8&255),L.adler=0,j.status=le)):j.status=le),j.pending!==0){if(Ve(L),L.avail_out===0)return j.last_flush=-1,_}else if(L.avail_in===0&&ie(ge)<=ie(de)&&ge!==g)return Ce(L,f);if(j.status===Ee&&L.avail_in!==0)return Ce(L,f);if(L.avail_in!==0||j.lookahead!==0||ge!==l&&j.status!==Ee){var we=j.strategy===D?_e(j,ge):j.strategy===E?X(j,ge):ye[j.level].func(j,ge);if((we===pe||we===Z)&&(j.status=Ee),we===De||we===pe)return L.avail_out===0&&(j.last_flush=-1),_;if(we===Pe&&(ge===h?n._tr_align(j):ge!==m&&(n._tr_stored_block(j,0,0,!1),ge===u&&(Ne(j.head),j.lookahead===0&&(j.strstart=0,j.block_start=0,j.insert=0))),Ve(L),L.avail_out===0))return j.last_flush=-1,_}return ge!==g?_:j.wrap<=0?b:(j.wrap===2?(Fe(j,L.adler&255),Fe(j,L.adler>>8&255),Fe(j,L.adler>>16&255),Fe(j,L.adler>>24&255),Fe(j,L.total_in&255),Fe(j,L.total_in>>8&255),Fe(j,L.total_in>>16&255),Fe(j,L.total_in>>24&255)):(ze(j,L.adler>>>16),ze(j,L.adler&65535)),Ve(L),j.wrap>0&&(j.wrap=-j.wrap),j.pending!==0?_:b)}function Te(L){var ge;return!L||!L.state?d:(ge=L.state.status,ge!==Q&&ge!==re&&ge!==te&&ge!==ae&&ge!==ne&&ge!==le&&ge!==Ee?Ce(L,d):(L.state=null,ge===le?Ce(L,c):_))}function ke(L,ge){var de=ge.length,j,se,he,Ie,Be,we,je,Xe;if(!L||!L.state||(j=L.state,Ie=j.wrap,Ie===2||Ie===1&&j.status!==Q||j.lookahead))return d;for(Ie===1&&(L.adler=s(L.adler,ge,de,0)),j.wrap=0,de>=j.w_size&&(Ie===0&&(Ne(j.head),j.strstart=0,j.block_start=0,j.insert=0),Xe=new i.Buf8(j.w_size),i.arraySet(Xe,ge,de-j.w_size,j.w_size,0),ge=Xe,de=j.w_size),Be=L.avail_in,we=L.next_in,je=L.input,L.avail_in=de,L.next_in=0,L.input=ge,We(j);j.lookahead>=R;){se=j.strstart,he=j.lookahead-(R-1);do j.ins_h=(j.ins_h<<j.hash_shift^j.window[se+R-1])&j.hash_mask,j.prev[se&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=se,se++;while(--he);j.strstart=se,j.lookahead=R-1,We(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=R-1,j.match_available=0,L.next_in=we,L.input=je,L.avail_in=Be,j.wrap=Ie,_}e.deflateInit=me,e.deflateInit2=oe,e.deflateReset=ve,e.deflateResetKeep=ce,e.deflateSetHeader=Oe,e.deflate=$,e.deflateEnd=Te,e.deflateSetDictionary=ke,e.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":r=>{function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=e},"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":r=>{var e=30,t=12;r.exports=function(n,s){var o,a,l,h,u,g,m,_,b,d,c,f,v,y,D,E,p,x,w,C,S,A,P,O,F;o=n.state,a=n.next_in,O=n.input,l=a+(n.avail_in-5),h=n.next_out,F=n.output,u=h-(s-n.avail_out),g=h+(n.avail_out-257),m=o.dmax,_=o.wsize,b=o.whave,d=o.wnext,c=o.window,f=o.hold,v=o.bits,y=o.lencode,D=o.distcode,E=(1<<o.lenbits)-1,p=(1<<o.distbits)-1;e:do{v<15&&(f+=O[a++]<<v,v+=8,f+=O[a++]<<v,v+=8),x=y[f&E];t:for(;;){if(w=x>>>24,f>>>=w,v-=w,w=x>>>16&255,w===0)F[h++]=x&65535;else if(w&16){C=x&65535,w&=15,w&&(v<w&&(f+=O[a++]<<v,v+=8),C+=f&(1<<w)-1,f>>>=w,v-=w),v<15&&(f+=O[a++]<<v,v+=8,f+=O[a++]<<v,v+=8),x=D[f&p];i:for(;;){if(w=x>>>24,f>>>=w,v-=w,w=x>>>16&255,w&16){if(S=x&65535,w&=15,v<w&&(f+=O[a++]<<v,v+=8,v<w&&(f+=O[a++]<<v,v+=8)),S+=f&(1<<w)-1,S>m){n.msg="invalid distance too far back",o.mode=e;break e}if(f>>>=w,v-=w,w=h-u,S>w){if(w=S-w,w>b&&o.sane){n.msg="invalid distance too far back",o.mode=e;break e}if(A=0,P=c,d===0){if(A+=_-w,w<C){C-=w;do F[h++]=c[A++];while(--w);A=h-S,P=F}}else if(d<w){if(A+=_+d-w,w-=d,w<C){C-=w;do F[h++]=c[A++];while(--w);if(A=0,d<C){w=d,C-=w;do F[h++]=c[A++];while(--w);A=h-S,P=F}}}else if(A+=d-w,w<C){C-=w;do F[h++]=c[A++];while(--w);A=h-S,P=F}for(;C>2;)F[h++]=P[A++],F[h++]=P[A++],F[h++]=P[A++],C-=3;C&&(F[h++]=P[A++],C>1&&(F[h++]=P[A++]))}else{A=h-S;do F[h++]=F[A++],F[h++]=F[A++],F[h++]=F[A++],C-=3;while(C>2);C&&(F[h++]=F[A++],C>1&&(F[h++]=F[A++]))}}else if((w&64)===0){x=D[(x&65535)+(f&(1<<w)-1)];continue i}else{n.msg="invalid distance code",o.mode=e;break e}break}}else if((w&64)===0){x=y[(x&65535)+(f&(1<<w)-1)];continue t}else if(w&32){o.mode=t;break e}else{n.msg="invalid literal/length code",o.mode=e;break e}break}}while(a<l&&h<g);C=v>>3,a-=C,v-=C<<3,f&=(1<<v)-1,n.next_in=a,n.next_out=h,n.avail_in=a<l?5+(l-a):5-(a-l),n.avail_out=h<g?257+(g-h):257-(h-g),o.hold=f,o.bits=v}},"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),n=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),s=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),l=0,h=1,u=2,g=4,m=5,_=6,b=0,d=1,c=2,f=-2,v=-3,y=-4,D=-5,E=8,p=1,x=2,w=3,C=4,S=5,A=6,P=7,O=8,F=9,I=10,B=11,k=12,U=13,W=14,R=15,z=16,V=17,q=18,Q=19,re=20,te=21,ae=22,ne=23,le=24,Ee=25,De=26,Pe=27,pe=28,Z=29,be=30,Ce=31,ie=32,Ne=852,Ve=592,Ue=15,Fe=Ue;function ze(oe){return(oe>>>24&255)+(oe>>>8&65280)+((oe&65280)<<8)+((oe&255)<<24)}function Re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Le(oe){var me;return!oe||!oe.state?f:(me=oe.state,oe.total_in=oe.total_out=me.total=0,oe.msg="",me.wrap&&(oe.adler=me.wrap&1),me.mode=p,me.last=0,me.havedict=0,me.dmax=32768,me.head=null,me.hold=0,me.bits=0,me.lencode=me.lendyn=new i.Buf32(Ne),me.distcode=me.distdyn=new i.Buf32(Ve),me.sane=1,me.back=-1,b)}function We(oe){var me;return!oe||!oe.state?f:(me=oe.state,me.wsize=0,me.whave=0,me.wnext=0,Le(oe))}function He(oe,me){var $,Te;return!oe||!oe.state||(Te=oe.state,me<0?($=0,me=-me):($=(me>>4)+1,me<48&&(me&=15)),me&&(me<8||me>15))?f:(Te.window!==null&&Te.wbits!==me&&(Te.window=null),Te.wrap=$,Te.wbits=me,We(oe))}function H(oe,me){var $,Te;return oe?(Te=new Re,oe.state=Te,Te.window=null,$=He(oe,me),$!==b&&(oe.state=null),$):f}function K(oe){return H(oe,Fe)}var X=!0,_e,ue;function ye(oe){if(X){var me;for(_e=new i.Buf32(512),ue=new i.Buf32(32),me=0;me<144;)oe.lens[me++]=8;for(;me<256;)oe.lens[me++]=9;for(;me<280;)oe.lens[me++]=7;for(;me<288;)oe.lens[me++]=8;for(a(h,oe.lens,0,288,_e,0,oe.work,{bits:9}),me=0;me<32;)oe.lens[me++]=5;a(u,oe.lens,0,32,ue,0,oe.work,{bits:5}),X=!1}oe.lencode=_e,oe.lenbits=9,oe.distcode=ue,oe.distbits=5}function Ae(oe,me,$,Te){var ke,L=oe.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new i.Buf8(L.wsize)),Te>=L.wsize?(i.arraySet(L.window,me,$-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(ke=L.wsize-L.wnext,ke>Te&&(ke=Te),i.arraySet(L.window,me,$-Te,ke,L.wnext),Te-=ke,Te?(i.arraySet(L.window,me,$-Te,Te,0),L.wnext=Te,L.whave=L.wsize):(L.wnext+=ke,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=ke))),0}function G(oe,me){var $,Te,ke,L,ge,de,j,se,he,Ie,Be,we,je,Xe,Ke=0,Je,Ye,rt,st,pt,ut,et,ct,tt=new i.Buf8(4),xt,Dt,wt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!oe||!oe.state||!oe.output||!oe.input&&oe.avail_in!==0)return f;$=oe.state,$.mode===k&&($.mode=U),ge=oe.next_out,ke=oe.output,j=oe.avail_out,L=oe.next_in,Te=oe.input,de=oe.avail_in,se=$.hold,he=$.bits,Ie=de,Be=j,ct=b;e:for(;;)switch($.mode){case p:if($.wrap===0){$.mode=U;break}for(;he<16;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if($.wrap&2&&se===35615){$.check=0,tt[0]=se&255,tt[1]=se>>>8&255,$.check=s($.check,tt,2,0),se=0,he=0,$.mode=x;break}if($.flags=0,$.head&&($.head.done=!1),!($.wrap&1)||(((se&255)<<8)+(se>>8))%31){oe.msg="incorrect header check",$.mode=be;break}if((se&15)!==E){oe.msg="unknown compression method",$.mode=be;break}if(se>>>=4,he-=4,et=(se&15)+8,$.wbits===0)$.wbits=et;else if(et>$.wbits){oe.msg="invalid window size",$.mode=be;break}$.dmax=1<<et,oe.adler=$.check=1,$.mode=se&512?I:k,se=0,he=0;break;case x:for(;he<16;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if($.flags=se,($.flags&255)!==E){oe.msg="unknown compression method",$.mode=be;break}if($.flags&57344){oe.msg="unknown header flags set",$.mode=be;break}$.head&&($.head.text=se>>8&1),$.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,$.check=s($.check,tt,2,0)),se=0,he=0,$.mode=w;case w:for(;he<32;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.head&&($.head.time=se),$.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,tt[2]=se>>>16&255,tt[3]=se>>>24&255,$.check=s($.check,tt,4,0)),se=0,he=0,$.mode=C;case C:for(;he<16;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.head&&($.head.xflags=se&255,$.head.os=se>>8),$.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,$.check=s($.check,tt,2,0)),se=0,he=0,$.mode=S;case S:if($.flags&1024){for(;he<16;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.length=se,$.head&&($.head.extra_len=se),$.flags&512&&(tt[0]=se&255,tt[1]=se>>>8&255,$.check=s($.check,tt,2,0)),se=0,he=0}else $.head&&($.head.extra=null);$.mode=A;case A:if($.flags&1024&&(we=$.length,we>de&&(we=de),we&&($.head&&(et=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Array($.head.extra_len)),i.arraySet($.head.extra,Te,L,we,et)),$.flags&512&&($.check=s($.check,Te,we,L)),de-=we,L+=we,$.length-=we),$.length))break e;$.length=0,$.mode=P;case P:if($.flags&2048){if(de===0)break e;we=0;do et=Te[L+we++],$.head&&et&&$.length<65536&&($.head.name+=String.fromCharCode(et));while(et&&we<de);if($.flags&512&&($.check=s($.check,Te,we,L)),de-=we,L+=we,et)break e}else $.head&&($.head.name=null);$.length=0,$.mode=O;case O:if($.flags&4096){if(de===0)break e;we=0;do et=Te[L+we++],$.head&&et&&$.length<65536&&($.head.comment+=String.fromCharCode(et));while(et&&we<de);if($.flags&512&&($.check=s($.check,Te,we,L)),de-=we,L+=we,et)break e}else $.head&&($.head.comment=null);$.mode=F;case F:if($.flags&512){for(;he<16;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if(se!==($.check&65535)){oe.msg="header crc mismatch",$.mode=be;break}se=0,he=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),oe.adler=$.check=0,$.mode=k;break;case I:for(;he<32;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}oe.adler=$.check=ze(se),se=0,he=0,$.mode=B;case B:if($.havedict===0)return oe.next_out=ge,oe.avail_out=j,oe.next_in=L,oe.avail_in=de,$.hold=se,$.bits=he,c;oe.adler=$.check=1,$.mode=k;case k:if(me===m||me===_)break e;case U:if($.last){se>>>=he&7,he-=he&7,$.mode=Pe;break}for(;he<3;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}switch($.last=se&1,se>>>=1,he-=1,se&3){case 0:$.mode=W;break;case 1:if(ye($),$.mode=re,me===_){se>>>=2,he-=2;break e}break;case 2:$.mode=V;break;case 3:oe.msg="invalid block type",$.mode=be}se>>>=2,he-=2;break;case W:for(se>>>=he&7,he-=he&7;he<32;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if((se&65535)!==(se>>>16^65535)){oe.msg="invalid stored block lengths",$.mode=be;break}if($.length=se&65535,se=0,he=0,$.mode=R,me===_)break e;case R:$.mode=z;case z:if(we=$.length,we){if(we>de&&(we=de),we>j&&(we=j),we===0)break e;i.arraySet(ke,Te,L,we,ge),de-=we,L+=we,j-=we,ge+=we,$.length-=we;break}$.mode=k;break;case V:for(;he<14;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if($.nlen=(se&31)+257,se>>>=5,he-=5,$.ndist=(se&31)+1,se>>>=5,he-=5,$.ncode=(se&15)+4,se>>>=4,he-=4,$.nlen>286||$.ndist>30){oe.msg="too many length or distance symbols",$.mode=be;break}$.have=0,$.mode=q;case q:for(;$.have<$.ncode;){for(;he<3;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.lens[wt[$.have++]]=se&7,se>>>=3,he-=3}for(;$.have<19;)$.lens[wt[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,xt={bits:$.lenbits},ct=a(l,$.lens,0,19,$.lencode,0,$.work,xt),$.lenbits=xt.bits,ct){oe.msg="invalid code lengths set",$.mode=be;break}$.have=0,$.mode=Q;case Q:for(;$.have<$.nlen+$.ndist;){for(;Ke=$.lencode[se&(1<<$.lenbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,rt=Ke&65535,!(Je<=he);){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if(rt<16)se>>>=Je,he-=Je,$.lens[$.have++]=rt;else{if(rt===16){for(Dt=Je+2;he<Dt;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if(se>>>=Je,he-=Je,$.have===0){oe.msg="invalid bit length repeat",$.mode=be;break}et=$.lens[$.have-1],we=3+(se&3),se>>>=2,he-=2}else if(rt===17){for(Dt=Je+3;he<Dt;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}se>>>=Je,he-=Je,et=0,we=3+(se&7),se>>>=3,he-=3}else{for(Dt=Je+7;he<Dt;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}se>>>=Je,he-=Je,et=0,we=11+(se&127),se>>>=7,he-=7}if($.have+we>$.nlen+$.ndist){oe.msg="invalid bit length repeat",$.mode=be;break}for(;we--;)$.lens[$.have++]=et}}if($.mode===be)break;if($.lens[256]===0){oe.msg="invalid code -- missing end-of-block",$.mode=be;break}if($.lenbits=9,xt={bits:$.lenbits},ct=a(h,$.lens,0,$.nlen,$.lencode,0,$.work,xt),$.lenbits=xt.bits,ct){oe.msg="invalid literal/lengths set",$.mode=be;break}if($.distbits=6,$.distcode=$.distdyn,xt={bits:$.distbits},ct=a(u,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,xt),$.distbits=xt.bits,ct){oe.msg="invalid distances set",$.mode=be;break}if($.mode=re,me===_)break e;case re:$.mode=te;case te:if(de>=6&&j>=258){oe.next_out=ge,oe.avail_out=j,oe.next_in=L,oe.avail_in=de,$.hold=se,$.bits=he,o(oe,Be),ge=oe.next_out,ke=oe.output,j=oe.avail_out,L=oe.next_in,Te=oe.input,de=oe.avail_in,se=$.hold,he=$.bits,$.mode===k&&($.back=-1);break}for($.back=0;Ke=$.lencode[se&(1<<$.lenbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,rt=Ke&65535,!(Je<=he);){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if(Ye&&(Ye&240)===0){for(st=Je,pt=Ye,ut=rt;Ke=$.lencode[ut+((se&(1<<st+pt)-1)>>st)],Je=Ke>>>24,Ye=Ke>>>16&255,rt=Ke&65535,!(st+Je<=he);){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}se>>>=st,he-=st,$.back+=st}if(se>>>=Je,he-=Je,$.back+=Je,$.length=rt,Ye===0){$.mode=De;break}if(Ye&32){$.back=-1,$.mode=k;break}if(Ye&64){oe.msg="invalid literal/length code",$.mode=be;break}$.extra=Ye&15,$.mode=ae;case ae:if($.extra){for(Dt=$.extra;he<Dt;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.length+=se&(1<<$.extra)-1,se>>>=$.extra,he-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=ne;case ne:for(;Ke=$.distcode[se&(1<<$.distbits)-1],Je=Ke>>>24,Ye=Ke>>>16&255,rt=Ke&65535,!(Je<=he);){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if((Ye&240)===0){for(st=Je,pt=Ye,ut=rt;Ke=$.distcode[ut+((se&(1<<st+pt)-1)>>st)],Je=Ke>>>24,Ye=Ke>>>16&255,rt=Ke&65535,!(st+Je<=he);){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}se>>>=st,he-=st,$.back+=st}if(se>>>=Je,he-=Je,$.back+=Je,Ye&64){oe.msg="invalid distance code",$.mode=be;break}$.offset=rt,$.extra=Ye&15,$.mode=le;case le:if($.extra){for(Dt=$.extra;he<Dt;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}$.offset+=se&(1<<$.extra)-1,se>>>=$.extra,he-=$.extra,$.back+=$.extra}if($.offset>$.dmax){oe.msg="invalid distance too far back",$.mode=be;break}$.mode=Ee;case Ee:if(j===0)break e;if(we=Be-j,$.offset>we){if(we=$.offset-we,we>$.whave&&$.sane){oe.msg="invalid distance too far back",$.mode=be;break}we>$.wnext?(we-=$.wnext,je=$.wsize-we):je=$.wnext-we,we>$.length&&(we=$.length),Xe=$.window}else Xe=ke,je=ge-$.offset,we=$.length;we>j&&(we=j),j-=we,$.length-=we;do ke[ge++]=Xe[je++];while(--we);$.length===0&&($.mode=te);break;case De:if(j===0)break e;ke[ge++]=$.length,j--,$.mode=te;break;case Pe:if($.wrap){for(;he<32;){if(de===0)break e;de--,se|=Te[L++]<<he,he+=8}if(Be-=j,oe.total_out+=Be,$.total+=Be,Be&&(oe.adler=$.check=$.flags?s($.check,ke,Be,ge-Be):n($.check,ke,Be,ge-Be)),Be=j,($.flags?se:ze(se))!==$.check){oe.msg="incorrect data check",$.mode=be;break}se=0,he=0}$.mode=pe;case pe:if($.wrap&&$.flags){for(;he<32;){if(de===0)break e;de--,se+=Te[L++]<<he,he+=8}if(se!==($.total&4294967295)){oe.msg="incorrect length check",$.mode=be;break}se=0,he=0}$.mode=Z;case Z:ct=d;break e;case be:ct=v;break e;case Ce:return y;case ie:default:return f}return oe.next_out=ge,oe.avail_out=j,oe.next_in=L,oe.avail_in=de,$.hold=se,$.bits=he,($.wsize||Be!==oe.avail_out&&$.mode<be&&($.mode<Pe||me!==g))&&Ae(oe,oe.output,oe.next_out,Be-oe.avail_out),Ie-=oe.avail_in,Be-=oe.avail_out,oe.total_in+=Ie,oe.total_out+=Be,$.total+=Be,$.wrap&&Be&&(oe.adler=$.check=$.flags?s($.check,ke,Be,oe.next_out-Be):n($.check,ke,Be,oe.next_out-Be)),oe.data_type=$.bits+($.last?64:0)+($.mode===k?128:0)+($.mode===re||$.mode===R?256:0),(Ie===0&&Be===0||me===g)&&ct===b&&(ct=D),ct}function ce(oe){if(!oe||!oe.state)return f;var me=oe.state;return me.window&&(me.window=null),oe.state=null,b}function ve(oe,me){var $;return!oe||!oe.state||($=oe.state,($.wrap&2)===0)?f:($.head=me,me.done=!1,b)}function Oe(oe,me){var $=me.length,Te,ke,L;return!oe||!oe.state||(Te=oe.state,Te.wrap!==0&&Te.mode!==B)?f:Te.mode===B&&(ke=1,ke=n(ke,me,$,0),ke!==Te.check)?v:(L=Ae(oe,me,$,$),L?(Te.mode=Ce,y):(Te.havedict=1,b))}e.inflateReset=We,e.inflateReset2=He,e.inflateResetKeep=Le,e.inflateInit=K,e.inflateInit2=H,e.inflate=G,e.inflateEnd=ce,e.inflateGetHeader=ve,e.inflateSetDictionary=Oe,e.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),n=15,s=852,o=592,a=0,l=1,h=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,c,f,v,y,D,E,p){var x=p.bits,w=0,C=0,S=0,A=0,P=0,O=0,F=0,I=0,B=0,k=0,U,W,R,z,V,q=null,Q=0,re,te=new i.Buf16(n+1),ae=new i.Buf16(n+1),ne=null,le=0,Ee,De,Pe;for(w=0;w<=n;w++)te[w]=0;for(C=0;C<v;C++)te[c[f+C]]++;for(P=x,A=n;A>=1&&te[A]===0;A--);if(P>A&&(P=A),A===0)return y[D++]=20971520,y[D++]=20971520,p.bits=1,0;for(S=1;S<A&&te[S]===0;S++);for(P<S&&(P=S),I=1,w=1;w<=n;w++)if(I<<=1,I-=te[w],I<0)return-1;if(I>0&&(d===a||A!==1))return-1;for(ae[1]=0,w=1;w<n;w++)ae[w+1]=ae[w]+te[w];for(C=0;C<v;C++)c[f+C]!==0&&(E[ae[c[f+C]]++]=C);if(d===a?(q=ne=E,re=19):d===l?(q=u,Q-=257,ne=g,le-=257,re=256):(q=m,ne=_,re=-1),k=0,C=0,w=S,V=D,O=P,F=0,R=-1,B=1<<P,z=B-1,d===l&&B>s||d===h&&B>o)return 1;for(;;){Ee=w-F,E[C]<re?(De=0,Pe=E[C]):E[C]>re?(De=ne[le+E[C]],Pe=q[Q+E[C]]):(De=96,Pe=0),U=1<<w-F,W=1<<O,S=W;do W-=U,y[V+(k>>F)+W]=Ee<<24|De<<16|Pe|0;while(W!==0);for(U=1<<w-1;k&U;)U>>=1;if(U!==0?(k&=U-1,k+=U):k=0,C++,--te[w]===0){if(w===A)break;w=c[f+E[C]]}if(w>P&&(k&z)!==R){for(F===0&&(F=P),V+=S,O=w-F,I=1<<O;O+F<A&&(I-=te[O+F],!(I<=0));)O++,I<<=1;if(B+=1<<O,d===l&&B>s||d===h&&B>o)return 1;R=k&z,y[R]=P<<24|O<<16|V-D|0}}return k!==0&&(y[V+k]=w-F<<24|4194304|0),p.bits=P,0}},"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":r=>{r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":(r,e,t)=>{var i=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),n=4,s=0,o=1,a=2;function l(G){for(var ce=G.length;--ce>=0;)G[ce]=0}var h=0,u=1,g=2,m=3,_=258,b=29,d=256,c=d+1+b,f=30,v=19,y=2*c+1,D=15,E=16,p=7,x=256,w=16,C=17,S=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=512,B=new Array((c+2)*2);l(B);var k=new Array(f*2);l(k);var U=new Array(I);l(U);var W=new Array(_-m+1);l(W);var R=new Array(b);l(R);var z=new Array(f);l(z);function V(G,ce,ve,Oe,oe){this.static_tree=G,this.extra_bits=ce,this.extra_base=ve,this.elems=Oe,this.max_length=oe,this.has_stree=G&&G.length}var q,Q,re;function te(G,ce){this.dyn_tree=G,this.max_code=0,this.stat_desc=ce}function ae(G){return G<256?U[G]:U[256+(G>>>7)]}function ne(G,ce){G.pending_buf[G.pending++]=ce&255,G.pending_buf[G.pending++]=ce>>>8&255}function le(G,ce,ve){G.bi_valid>E-ve?(G.bi_buf|=ce<<G.bi_valid&65535,ne(G,G.bi_buf),G.bi_buf=ce>>E-G.bi_valid,G.bi_valid+=ve-E):(G.bi_buf|=ce<<G.bi_valid&65535,G.bi_valid+=ve)}function Ee(G,ce,ve){le(G,ve[ce*2],ve[ce*2+1])}function De(G,ce){var ve=0;do ve|=G&1,G>>>=1,ve<<=1;while(--ce>0);return ve>>>1}function Pe(G){G.bi_valid===16?(ne(G,G.bi_buf),G.bi_buf=0,G.bi_valid=0):G.bi_valid>=8&&(G.pending_buf[G.pending++]=G.bi_buf&255,G.bi_buf>>=8,G.bi_valid-=8)}function pe(G,ce){var ve=ce.dyn_tree,Oe=ce.max_code,oe=ce.stat_desc.static_tree,me=ce.stat_desc.has_stree,$=ce.stat_desc.extra_bits,Te=ce.stat_desc.extra_base,ke=ce.stat_desc.max_length,L,ge,de,j,se,he,Ie=0;for(j=0;j<=D;j++)G.bl_count[j]=0;for(ve[G.heap[G.heap_max]*2+1]=0,L=G.heap_max+1;L<y;L++)ge=G.heap[L],j=ve[ve[ge*2+1]*2+1]+1,j>ke&&(j=ke,Ie++),ve[ge*2+1]=j,!(ge>Oe)&&(G.bl_count[j]++,se=0,ge>=Te&&(se=$[ge-Te]),he=ve[ge*2],G.opt_len+=he*(j+se),me&&(G.static_len+=he*(oe[ge*2+1]+se)));if(Ie!==0){do{for(j=ke-1;G.bl_count[j]===0;)j--;G.bl_count[j]--,G.bl_count[j+1]+=2,G.bl_count[ke]--,Ie-=2}while(Ie>0);for(j=ke;j!==0;j--)for(ge=G.bl_count[j];ge!==0;)de=G.heap[--L],!(de>Oe)&&(ve[de*2+1]!==j&&(G.opt_len+=(j-ve[de*2+1])*ve[de*2],ve[de*2+1]=j),ge--)}}function Z(G,ce,ve){var Oe=new Array(D+1),oe=0,me,$;for(me=1;me<=D;me++)Oe[me]=oe=oe+ve[me-1]<<1;for($=0;$<=ce;$++){var Te=G[$*2+1];Te!==0&&(G[$*2]=De(Oe[Te]++,Te))}}function be(){var G,ce,ve,Oe,oe,me=new Array(D+1);for(ve=0,Oe=0;Oe<b-1;Oe++)for(R[Oe]=ve,G=0;G<1<<A[Oe];G++)W[ve++]=Oe;for(W[ve-1]=Oe,oe=0,Oe=0;Oe<16;Oe++)for(z[Oe]=oe,G=0;G<1<<P[Oe];G++)U[oe++]=Oe;for(oe>>=7;Oe<f;Oe++)for(z[Oe]=oe<<7,G=0;G<1<<P[Oe]-7;G++)U[256+oe++]=Oe;for(ce=0;ce<=D;ce++)me[ce]=0;for(G=0;G<=143;)B[G*2+1]=8,G++,me[8]++;for(;G<=255;)B[G*2+1]=9,G++,me[9]++;for(;G<=279;)B[G*2+1]=7,G++,me[7]++;for(;G<=287;)B[G*2+1]=8,G++,me[8]++;for(Z(B,c+1,me),G=0;G<f;G++)k[G*2+1]=5,k[G*2]=De(G,5);q=new V(B,A,d+1,c,D),Q=new V(k,P,0,f,D),re=new V(new Array(0),O,0,v,p)}function Ce(G){var ce;for(ce=0;ce<c;ce++)G.dyn_ltree[ce*2]=0;for(ce=0;ce<f;ce++)G.dyn_dtree[ce*2]=0;for(ce=0;ce<v;ce++)G.bl_tree[ce*2]=0;G.dyn_ltree[x*2]=1,G.opt_len=G.static_len=0,G.last_lit=G.matches=0}function ie(G){G.bi_valid>8?ne(G,G.bi_buf):G.bi_valid>0&&(G.pending_buf[G.pending++]=G.bi_buf),G.bi_buf=0,G.bi_valid=0}function Ne(G,ce,ve,Oe){ie(G),ne(G,ve),ne(G,~ve),i.arraySet(G.pending_buf,G.window,ce,ve,G.pending),G.pending+=ve}function Ve(G,ce,ve,Oe){var oe=ce*2,me=ve*2;return G[oe]<G[me]||G[oe]===G[me]&&Oe[ce]<=Oe[ve]}function Ue(G,ce,ve){for(var Oe=G.heap[ve],oe=ve<<1;oe<=G.heap_len&&(oe<G.heap_len&&Ve(ce,G.heap[oe+1],G.heap[oe],G.depth)&&oe++,!Ve(ce,Oe,G.heap[oe],G.depth));)G.heap[ve]=G.heap[oe],ve=oe,oe<<=1;G.heap[ve]=Oe}function Fe(G,ce,ve){var Oe,oe,me=0,$,Te;if(G.last_lit!==0)do Oe=G.pending_buf[G.d_buf+me*2]<<8|G.pending_buf[G.d_buf+me*2+1],oe=G.pending_buf[G.l_buf+me],me++,Oe===0?Ee(G,oe,ce):($=W[oe],Ee(G,$+d+1,ce),Te=A[$],Te!==0&&(oe-=R[$],le(G,oe,Te)),Oe--,$=ae(Oe),Ee(G,$,ve),Te=P[$],Te!==0&&(Oe-=z[$],le(G,Oe,Te)));while(me<G.last_lit);Ee(G,x,ce)}function ze(G,ce){var ve=ce.dyn_tree,Oe=ce.stat_desc.static_tree,oe=ce.stat_desc.has_stree,me=ce.stat_desc.elems,$,Te,ke=-1,L;for(G.heap_len=0,G.heap_max=y,$=0;$<me;$++)ve[$*2]!==0?(G.heap[++G.heap_len]=ke=$,G.depth[$]=0):ve[$*2+1]=0;for(;G.heap_len<2;)L=G.heap[++G.heap_len]=ke<2?++ke:0,ve[L*2]=1,G.depth[L]=0,G.opt_len--,oe&&(G.static_len-=Oe[L*2+1]);for(ce.max_code=ke,$=G.heap_len>>1;$>=1;$--)Ue(G,ve,$);L=me;do $=G.heap[1],G.heap[1]=G.heap[G.heap_len--],Ue(G,ve,1),Te=G.heap[1],G.heap[--G.heap_max]=$,G.heap[--G.heap_max]=Te,ve[L*2]=ve[$*2]+ve[Te*2],G.depth[L]=(G.depth[$]>=G.depth[Te]?G.depth[$]:G.depth[Te])+1,ve[$*2+1]=ve[Te*2+1]=L,G.heap[1]=L++,Ue(G,ve,1);while(G.heap_len>=2);G.heap[--G.heap_max]=G.heap[1],pe(G,ce),Z(ve,ke,G.bl_count)}function Re(G,ce,ve){var Oe,oe=-1,me,$=ce[0*2+1],Te=0,ke=7,L=4;for($===0&&(ke=138,L=3),ce[(ve+1)*2+1]=65535,Oe=0;Oe<=ve;Oe++)me=$,$=ce[(Oe+1)*2+1],!(++Te<ke&&me===$)&&(Te<L?G.bl_tree[me*2]+=Te:me!==0?(me!==oe&&G.bl_tree[me*2]++,G.bl_tree[w*2]++):Te<=10?G.bl_tree[C*2]++:G.bl_tree[S*2]++,Te=0,oe=me,$===0?(ke=138,L=3):me===$?(ke=6,L=3):(ke=7,L=4))}function Le(G,ce,ve){var Oe,oe=-1,me,$=ce[0*2+1],Te=0,ke=7,L=4;for($===0&&(ke=138,L=3),Oe=0;Oe<=ve;Oe++)if(me=$,$=ce[(Oe+1)*2+1],!(++Te<ke&&me===$)){if(Te<L)do Ee(G,me,G.bl_tree);while(--Te!==0);else me!==0?(me!==oe&&(Ee(G,me,G.bl_tree),Te--),Ee(G,w,G.bl_tree),le(G,Te-3,2)):Te<=10?(Ee(G,C,G.bl_tree),le(G,Te-3,3)):(Ee(G,S,G.bl_tree),le(G,Te-11,7));Te=0,oe=me,$===0?(ke=138,L=3):me===$?(ke=6,L=3):(ke=7,L=4)}}function We(G){var ce;for(Re(G,G.dyn_ltree,G.l_desc.max_code),Re(G,G.dyn_dtree,G.d_desc.max_code),ze(G,G.bl_desc),ce=v-1;ce>=3&&G.bl_tree[F[ce]*2+1]===0;ce--);return G.opt_len+=3*(ce+1)+5+5+4,ce}function He(G,ce,ve,Oe){var oe;for(le(G,ce-257,5),le(G,ve-1,5),le(G,Oe-4,4),oe=0;oe<Oe;oe++)le(G,G.bl_tree[F[oe]*2+1],3);Le(G,G.dyn_ltree,ce-1),Le(G,G.dyn_dtree,ve-1)}function H(G){var ce=4093624447,ve;for(ve=0;ve<=31;ve++,ce>>>=1)if(ce&1&&G.dyn_ltree[ve*2]!==0)return s;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return o;for(ve=32;ve<d;ve++)if(G.dyn_ltree[ve*2]!==0)return o;return s}var K=!1;function X(G){K||(be(),K=!0),G.l_desc=new te(G.dyn_ltree,q),G.d_desc=new te(G.dyn_dtree,Q),G.bl_desc=new te(G.bl_tree,re),G.bi_buf=0,G.bi_valid=0,Ce(G)}function _e(G,ce,ve,Oe){le(G,(h<<1)+(Oe?1:0),3),Ne(G,ce,ve)}function ue(G){le(G,u<<1,3),Ee(G,x,B),Pe(G)}function ye(G,ce,ve,Oe){var oe,me,$=0;G.level>0?(G.strm.data_type===a&&(G.strm.data_type=H(G)),ze(G,G.l_desc),ze(G,G.d_desc),$=We(G),oe=G.opt_len+3+7>>>3,me=G.static_len+3+7>>>3,me<=oe&&(oe=me)):oe=me=ve+5,ve+4<=oe&&ce!==-1?_e(G,ce,ve,Oe):G.strategy===n||me===oe?(le(G,(u<<1)+(Oe?1:0),3),Fe(G,B,k)):(le(G,(g<<1)+(Oe?1:0),3),He(G,G.l_desc.max_code+1,G.d_desc.max_code+1,$+1),Fe(G,G.dyn_ltree,G.dyn_dtree)),Ce(G),Oe&&ie(G)}function Ae(G,ce,ve){return G.pending_buf[G.d_buf+G.last_lit*2]=ce>>>8&255,G.pending_buf[G.d_buf+G.last_lit*2+1]=ce&255,G.pending_buf[G.l_buf+G.last_lit]=ve&255,G.last_lit++,ce===0?G.dyn_ltree[ve*2]++:(G.matches++,ce--,G.dyn_ltree[(W[ve]+d+1)*2]++,G.dyn_dtree[ae(ce)*2]++),G.last_lit===G.lit_bufsize-1}e._tr_init=X,e._tr_stored_block=_e,e._tr_flush_block=ye,e._tr_tally=Ae,e._tr_align=ue},"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":r=>{function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=e},"./src/3Dmol.ts":(r,e,t)=>{t.r(e),t.d(e,{CAP:()=>o.CAP,CC:()=>n.CC,CONTEXTS_PER_VIEWPORT:()=>h.CONTEXTS_PER_VIEWPORT,Color:()=>n.Color,CustomLinear:()=>u.CustomLinear,Cylinder:()=>y.Cylinder,GLDraw:()=>o.GLDraw,GLModel:()=>a.GLModel,GLShape:()=>l.GLShape,GLViewer:()=>h.GLViewer,GLVolumetricRender:()=>f.GLVolumetricRender,Gradient:()=>u.Gradient,GradientType:()=>u.GradientType,Label:()=>g.Label,LabelCount:()=>g.LabelCount,MarchingCube:()=>b.MarchingCube,MarchingCubeInitializer:()=>b.MarchingCubeInitializer,Matrix3:()=>v.Matrix3,Matrix4:()=>v.Matrix4,Parsers:()=>m.Parsers,PausableTimer:()=>d.PausableTimer,PointGrid:()=>b.PointGrid,ProteinSurface:()=>b.ProteinSurface,Quaternion:()=>v.Quaternion,ROYGB:()=>u.ROYGB,RWB:()=>u.RWB,Ray:()=>v.Ray,Sinebow:()=>u.Sinebow,Sphere:()=>y.Sphere,SurfaceType:()=>b.SurfaceType,Triangle:()=>y.Triangle,Vector2:()=>v.Vector2,Vector3:()=>v.Vector3,VolumeData:()=>c.VolumeData,adjustVolumeStyle:()=>d.adjustVolumeStyle,applyPartialCharges:()=>_.applyPartialCharges,autoinit:()=>i.autoinit,autoload:()=>i.autoload,base64ToArray:()=>d.base64ToArray,bondLength:()=>m.bondLength,builtinColorSchemes:()=>n.builtinColorSchemes,builtinGradients:()=>u.builtinGradients,chains:()=>n.chains,clamp:()=>v.clamp,conversionMatrix3:()=>v.conversionMatrix3,createStereoViewer:()=>h.createStereoViewer,createViewer:()=>h.createViewer,createViewerGrid:()=>h.createViewerGrid,deepCopy:()=>d.deepCopy,degToRad:()=>v.degToRad,download:()=>d.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>n.elementColors,extend:()=>d.extend,get:()=>d.get,getAtomProperty:()=>d.getAtomProperty,getColorFromStyle:()=>d.getColorFromStyle,getElement:()=>d.getElement,getExtent:()=>d.getExtent,getGradient:()=>u.getGradient,getPropertyRange:()=>d.getPropertyRange,getbin:()=>d.getbin,htmlColors:()=>n.htmlColors,inflateString:()=>d.inflateString,isEmptyObject:()=>d.isEmptyObject,isNumeric:()=>d.isNumeric,makeFunction:()=>d.makeFunction,mergeGeos:()=>d.mergeGeos,normalizeValue:()=>u.normalizeValue,partialCharges:()=>_.partialCharges,processing_autoinit:()=>i.processing_autoinit,residues:()=>n.residues,setBondLength:()=>m.setBondLength,setSyncSurface:()=>b.setSyncSurface,specStringToObject:()=>d.specStringToObject,splitMesh:()=>l.splitMesh,ssColors:()=>n.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>b.syncSurface,viewers:()=>i.viewers});var i=t("./src/autoload.ts"),n=t("./src/colors.ts"),s=t("./src/glcartoon.ts"),o=t("./src/GLDraw.ts"),a=t("./src/GLModel.ts"),l=t("./src/GLShape.ts"),h=t("./src/GLViewer.ts"),u=t("./src/Gradient.ts"),g=t("./src/Label.ts"),m=t("./src/parsers/index.ts"),_=t("./src/partialCharges.ts"),b=t("./src/ProteinSurface4.ts");t("./src/specs.ts");var d=t("./src/utilities.ts"),c=t("./src/VolumeData.ts"),f=t("./src/VolumetricRender.ts"),v=t("./src/WebGL/math/index.ts"),y=t("./src/WebGL/shapes/index.ts")},"./src/GLDraw.ts":(r,e,t)=>{t.r(e),t.d(e,{CAP:()=>n,GLDraw:()=>s});var i=t("./src/WebGL/math/index.ts"),n;(function(o){o[o.NONE=0]="NONE",o[o.FLAT=1]="FLAT",o[o.ROUND=2]="ROUND"})(n||(n={}));var s;(function(o){function a(d,c,f){var v=Math.hypot(d,c),y,D,E,p,x;v<1e-4?(D=0,E=1):(D=-d/v,E=c/v),c=-D*d+E*c,y=Math.hypot(c,f),y<1e-4?(p=0,x=1):(p=f/y,x=c/y);var w=new Float32Array(9);return w[0]=E,w[1]=D,w[2]=0,w[3]=-D*x,w[4]=E*x,w[5]=p,w[6]=D*p,w[7]=-E*p,w[8]=x,w}class l{constructor(){this.cache={};let c=[],f=4,v=Math.pow(2,f),y=2,D=Math.pow(2,y),E=v/D,p;for(c[0]=new i.Vector3(-1,0,0),c[E]=new i.Vector3(0,0,1),c[E*2]=new i.Vector3(1,0,0),c[E*3]=new i.Vector3(0,0,-1),y=3;y<=f;y++){for(D=Math.pow(2,y-1),E=v/D,p=0;p<D-1;p++)c[E/2+p*E]=c[p*E].clone().add(c[(p+1)*E]).normalize();p=D-1,c[E/2+p*E]=c[p*E].clone().add(c[0]).normalize()}this.basisVectors=c}getVerticesForRadius(c,f,v){if(typeof this.cache<"u"&&this.cache[c]!==void 0&&this.cache[c][f+v]!==void 0)return this.cache[c][f+v];for(var y=this.basisVectors.length,D=[],E=[],p,x=0;x<y;x++)D.push(this.basisVectors[x].clone().multiplyScalar(c)),D.push(this.basisVectors[x].clone().multiplyScalar(c)),p=this.basisVectors[x].clone().normalize(),E.push(p),E.push(p);var w=[],C=10,S=y,A=0,P=Math.PI*2,O=0,F=Math.PI,I,B,k=!1,U=!1;for(B=0;B<=C;B++){k=B===0||B===C,U=B===C/2;var W=[],R=[];for(I=0;I<=S;I++){if(U){var z=I<S?2*I:0;R.push(z+1),W.push(z);continue}var V=I/S,q=B/C;if(!k||I===0)if(I<S){var Q=new i.Vector3;Q.x=-c*Math.cos(A+V*P)*Math.sin(O+q*F),f==1?Q.y=0:Q.y=c*Math.cos(O+q*F),Q.z=c*Math.sin(A+V*P)*Math.sin(O+q*F),Math.abs(Q.x)<1e-5&&(Q.x=0),Math.abs(Q.y)<1e-5&&(Q.y=0),Math.abs(Q.z)<1e-5&&(Q.z=0),f==n.FLAT?(p=new i.Vector3(0,Math.cos(O+q*F),0),p.normalize()):(p=new i.Vector3(Q.x,Q.y,Q.z),p.normalize()),D.push(Q),E.push(p),W.push(D.length-1)}else W.push(D.length-S);else k&&W.push(D.length-1)}U&&w.push(R),w.push(W)}var re={vertices:D,normals:E,verticesRows:w,w:S,h:C};return c in this.cache||(this.cache[c]={}),this.cache[c][f+v]=re,re}}var h=new l;function u(d,c,f,v,y,D=0,E=0){if(!c||!f)return;let p=function(he){if(typeof he=="string"){let Ie=he;return Ie.toLowerCase()=="flat"?n.FLAT:Ie.toLowerCase()=="round"?n.ROUND:n.NONE}else return he};D=p(D),E=p(E);var x=E||D;y=y||{r:0,g:0,b:0};var w=a(f.x-c.x,f.y-c.y,f.z-c.z),C=h.getVerticesForRadius(v,E,"to"),S=C.w,A=C.h,P=x?A*S+2:2*S,O=d.updateGeoGroup(P),F=C.vertices,I=C.normals,B=C.verticesRows,k=B[A/2],U=B[A/2+1],W=O.vertices,R,z,V,q,Q,re,te=O.vertexArray,ae=O.normalArray,ne=O.colorArray,le=O.faceArray;for(V=0;V<S;++V){var Ee=2*V;q=w[0]*F[Ee].x+w[3]*F[Ee].y+w[6]*F[Ee].z,Q=w[1]*F[Ee].x+w[4]*F[Ee].y+w[7]*F[Ee].z,re=w[5]*F[Ee].y+w[8]*F[Ee].z,R=3*(W+Ee),z=O.faceidx,te[R]=q+c.x,te[R+1]=Q+c.y,te[R+2]=re+c.z,te[R+3]=q+f.x,te[R+4]=Q+f.y,te[R+5]=re+f.z,ae[R]=q,ae[R+3]=q,ae[R+1]=Q,ae[R+4]=Q,ae[R+2]=re,ae[R+5]=re,ne[R]=y.r,ne[R+3]=y.r,ne[R+1]=y.g,ne[R+4]=y.g,ne[R+2]=y.b,ne[R+5]=y.b,le[z]=U[V]+W,le[z+1]=U[V+1]+W,le[z+2]=k[V]+W,le[z+3]=k[V]+W,le[z+4]=U[V+1]+W,le[z+5]=k[V+1]+W,O.faceidx+=6}if(x){var De=E?0:A/2,Pe=D?A+1:A/2+1,pe,Z,be,Ce,ie,Ne,Ve,Ue,Fe,ze,Re,Le,We,He,H,K,X,_e,ue,ye,Ae,G,ce,ve,Oe,oe,me,$,Te,ke,L,ge;for(Q=De;Q<Pe;Q++)if(Q!==A/2){var de=Q<=A/2?f:c,j=h.getVerticesForRadius(v,E,"to"),se=h.getVerticesForRadius(v,D,"from");for(de===f?(F=j.vertices,I=j.normals,B=j.verticesRows):de==c&&(F=se.vertices,I=se.normals,B=se.verticesRows),q=0;q<S;q++)z=O.faceidx,pe=B[Q][q+1],Te=(pe+W)*3,Z=B[Q][q],ke=(Z+W)*3,be=B[Q+1][q],L=(be+W)*3,Ce=B[Q+1][q+1],ge=(Ce+W)*3,ie=w[0]*F[pe].x+w[3]*F[pe].y+w[6]*F[pe].z,Ne=w[0]*F[Z].x+w[3]*F[Z].y+w[6]*F[Z].z,Ve=w[0]*F[be].x+w[3]*F[be].y+w[6]*F[be].z,Ue=w[0]*F[Ce].x+w[3]*F[Ce].y+w[6]*F[Ce].z,Fe=w[1]*F[pe].x+w[4]*F[pe].y+w[7]*F[pe].z,ze=w[1]*F[Z].x+w[4]*F[Z].y+w[7]*F[Z].z,Re=w[1]*F[be].x+w[4]*F[be].y+w[7]*F[be].z,Le=w[1]*F[Ce].x+w[4]*F[Ce].y+w[7]*F[Ce].z,We=w[5]*F[pe].y+w[8]*F[pe].z,He=w[5]*F[Z].y+w[8]*F[Z].z,H=w[5]*F[be].y+w[8]*F[be].z,K=w[5]*F[Ce].y+w[8]*F[Ce].z,te[Te]=ie+de.x,te[ke]=Ne+de.x,te[L]=Ve+de.x,te[ge]=Ue+de.x,te[Te+1]=Fe+de.y,te[ke+1]=ze+de.y,te[L+1]=Re+de.y,te[ge+1]=Le+de.y,te[Te+2]=We+de.z,te[ke+2]=He+de.z,te[L+2]=H+de.z,te[ge+2]=K+de.z,ne[Te]=y.r,ne[ke]=y.r,ne[L]=y.r,ne[ge]=y.r,ne[Te+1]=y.g,ne[ke+1]=y.g,ne[L+1]=y.g,ne[ge+1]=y.g,ne[Te+2]=y.b,ne[ke+2]=y.b,ne[L+2]=y.b,ne[ge+2]=y.b,X=w[0]*I[pe].x+w[3]*I[pe].y+w[6]*I[pe].z,_e=w[0]*I[Z].x+w[3]*I[Z].y+w[6]*I[Z].z,ue=w[0]*I[be].x+w[3]*I[be].y+w[6]*I[be].z,ye=w[0]*I[Ce].x+w[3]*I[Ce].y+w[6]*I[Ce].z,Ae=w[1]*I[pe].x+w[4]*I[pe].y+w[7]*I[pe].z,G=w[1]*I[Z].x+w[4]*I[Z].y+w[7]*I[Z].z,ce=w[1]*I[be].x+w[4]*I[be].y+w[7]*I[be].z,ve=w[1]*I[Ce].x+w[4]*I[Ce].y+w[7]*I[Ce].z,Oe=w[5]*I[pe].y+w[8]*I[pe].z,oe=w[5]*I[Z].y+w[8]*I[Z].z,me=w[5]*I[be].y+w[8]*I[be].z,$=w[5]*I[Ce].y+w[8]*I[Ce].z,Q===0?(ae[Te]=X,ae[L]=ue,ae[ge]=ye,ae[Te+1]=Ae,ae[L+1]=ce,ae[ge+1]=ve,ae[Te+2]=Oe,ae[L+2]=me,ae[ge+2]=$,le[z]=pe+W,le[z+1]=be+W,le[z+2]=Ce+W,O.faceidx+=3):Q===Pe-1?(ae[Te]=X,ae[ke]=_e,ae[L]=ue,ae[Te+1]=Ae,ae[ke+1]=G,ae[L+1]=ce,ae[Te+2]=Oe,ae[ke+2]=oe,ae[L+2]=me,le[z]=pe+W,le[z+1]=Z+W,le[z+2]=be+W,O.faceidx+=3):(ae[Te]=X,ae[ke]=_e,ae[ge]=ye,ae[Te+1]=Ae,ae[ke+1]=G,ae[ge+1]=ve,ae[Te+2]=Oe,ae[ke+2]=oe,ae[ge+2]=$,ae[ke]=_e,ae[L]=ue,ae[ge]=ye,ae[ke+1]=G,ae[L+1]=ce,ae[ge+1]=ve,ae[ke+2]=oe,ae[L+2]=me,ae[ge+2]=$,le[z]=pe+W,le[z+1]=Z+W,le[z+2]=Ce+W,le[z+3]=Z+W,le[z+4]=be+W,le[z+5]=Ce+W,O.faceidx+=6)}}O.vertices+=P}o.drawCylinder=u;function g(d,c,f,v,y){if(!c||!f)return;y=y||{r:0,g:0,b:0};let D=new i.Vector3(f.x-c.x,f.y-c.y,f.z-c.z);var E=a(D.x,D.y,D.z);D=D.normalize();var p=h.basisVectors.length,x=h.basisVectors,w=p+2,C=d.updateGeoGroup(w),S=C.vertices,A,P,O,F,I,B,k=C.vertexArray,U=C.normalArray,W=C.colorArray,R=C.faceArray;for(A=S*3,k[A]=c.x,k[A+1]=c.y,k[A+2]=c.z,U[A]=-D.x,U[A+1]=-D.y,U[A+2]=-D.z,W[A]=y.r,W[A+1]=y.g,W[A+2]=y.b,k[A+3]=f.x,k[A+4]=f.y,k[A+5]=f.z,U[A+3]=D.x,U[A+4]=D.y,U[A+5]=D.z,W[A+3]=y.r,W[A+4]=y.g,W[A+5]=y.b,A+=6,O=0;O<p;++O){var z=x[O].clone();z.multiplyScalar(v),F=E[0]*z.x+E[3]*z.y+E[6]*z.z,I=E[1]*z.x+E[4]*z.y+E[7]*z.z,B=E[5]*z.y+E[8]*z.z,k[A]=F+c.x,k[A+1]=I+c.y,k[A+2]=B+c.z,U[A]=F,U[A+1]=I,U[A+2]=B,W[A]=y.r,W[A+1]=y.g,W[A+2]=y.b,A+=3}for(C.vertices+=p+2,P=C.faceidx,O=0;O<p;O++){var V=S+2+O,q=S+2+(O+1)%p;R[P]=V,R[P+1]=q,R[P+2]=S,P+=3,R[P]=V,R[P+1]=q,R[P+2]=S+1,P+=3}C.faceidx+=6*p}o.drawCone=g;class m{constructor(){this.cache=new Map}getVerticesForRadius(c,f){f=f||2,this.cache.has(f)||this.cache.set(f,new Map);let v=this.cache.get(f);if(v.has(c))return v.get(c);var y={vertices:[],verticesRows:[],normals:[]},D=16*f,E=10*f;c<1&&(D=10*f,E=8*f);var p=0,x=Math.PI*2,w=0,C=Math.PI,S,A;for(A=0;A<=E;A++){let O=[];for(S=0;S<=D;S++){let F=S/D,I=A/E,B=-c*Math.cos(p+F*x)*Math.sin(w+I*C),k=c*Math.cos(w+I*C),U=c*Math.sin(p+F*x)*Math.sin(w+I*C);var P=new i.Vector3(B,k,U);P.normalize(),y.vertices.push({x:B,y:k,z:U}),y.normals.push(P),O.push(y.vertices.length-1)}y.verticesRows.push(O)}return v.set(c,y),y}}var _=new m;function b(d,c,f,v,y){var D=_.getVerticesForRadius(f,y),E=D.vertices,p=D.normals,x=d.updateGeoGroup(E.length),w=x.vertices,C=x.vertexArray,S=x.colorArray,A=x.faceArray,P=x.lineArray,O=x.normalArray;for(let B=0,k=E.length;B<k;++B){let U=3*(w+B),W=E[B];C[U]=W.x+c.x,C[U+1]=W.y+c.y,C[U+2]=W.z+c.z,S[U]=v.r,S[U+1]=v.g,S[U+2]=v.b}x.vertices+=E.length;let F=D.verticesRows,I=F.length-1;for(let B=0;B<I;B++){let k=F[B].length-1;for(let U=0;U<k;U++){let W=x.faceidx,R=x.lineidx,z=F[B][U+1]+w,V=z*3,q=F[B][U]+w,Q=q*3,re=F[B+1][U]+w,te=re*3,ae=F[B+1][U+1]+w,ne=ae*3,le=p[z-w],Ee=p[q-w],De=p[re-w],Pe=p[ae-w];Math.abs(E[z-w].y)===f?(O[V]=le.x,O[te]=De.x,O[ne]=Pe.x,O[V+1]=le.y,O[te+1]=De.y,O[ne+1]=Pe.y,O[V+2]=le.z,O[te+2]=De.z,O[ne+2]=Pe.z,A[W]=z,A[W+1]=re,A[W+2]=ae,P[R]=z,P[R+1]=re,P[R+2]=z,P[R+3]=ae,P[R+4]=re,P[R+5]=ae,x.faceidx+=3,x.lineidx+=6):Math.abs(E[re-w].y)===f?(O[V]=le.x,O[Q]=Ee.x,O[te]=De.x,O[V+1]=le.y,O[Q+1]=Ee.y,O[te+1]=De.y,O[V+2]=le.z,O[Q+2]=Ee.z,O[te+2]=De.z,A[W]=z,A[W+1]=q,A[W+2]=re,P[R]=z,P[R+1]=q,P[R+2]=z,P[R+3]=re,P[R+4]=q,P[R+5]=re,x.faceidx+=3,x.lineidx+=6):(O[V]=le.x,O[Q]=Ee.x,O[ne]=Pe.x,O[V+1]=le.y,O[Q+1]=Ee.y,O[ne+1]=Pe.y,O[V+2]=le.z,O[Q+2]=Ee.z,O[ne+2]=Pe.z,O[Q]=Ee.x,O[te]=De.x,O[ne]=Pe.x,O[Q+1]=Ee.y,O[te+1]=De.y,O[ne+1]=Pe.y,O[Q+2]=Ee.z,O[te+2]=De.z,O[ne+2]=Pe.z,A[W]=z,A[W+1]=q,A[W+2]=ae,A[W+3]=q,A[W+4]=re,A[W+5]=ae,P[R]=z,P[R+1]=q,P[R+2]=z,P[R+3]=ae,P[R+4]=q,P[R+5]=re,P[R+6]=re,P[R+7]=ae,x.faceidx+=6,x.lineidx+=8)}}}o.drawSphere=b})(s||(s={}))},"./src/GLModel.ts":(r,e,t)=>{t.r(e),t.d(e,{GLModel:()=>b});var i=t("./src/WebGL/index.ts"),n=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts"),a=t("./src/GLDraw.ts"),l=t("./src/glcartoon.ts"),h=t("./src/utilities.ts"),u=t("./src/Gradient.ts"),g=t("./src/parsers/index.ts"),m=t("./node_modules/netcdfjs/lib-esm/index.js"),_=t("./src/parsers/utils/assignBonds.ts");class b{static sameObj(c,f){return c&&f?JSON.stringify(c)==JSON.stringify(f):c==f}constructor(c,f,v){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new s.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=o.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=f||{},this.viewer=v,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:o.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=c}getRadiusFromStyle(c,f){var v=this.defaultSphereRadius;if(typeof f.radius<"u")v=f.radius;else if(b.vdwRadii[c.elem])v=b.vdwRadii[c.elem];else if(c.elem.length>1){let y=c.elem;y=y[0].toUpperCase()+y[1].toLowerCase(),b.vdwRadii[y]&&(v=b.vdwRadii[y])}return typeof f.scale<"u"&&(v*=f.scale),v}drawAtomCross(c,f){if(c.style.cross){var v=c.style.cross;if(!v.hidden){var y=v.linewidth||b.defaultlineWidth;f[y]||(f[y]=new i.Geometry);var D=f[y].updateGeoGroup(6),E=this.getRadiusFromStyle(c,v),p=[[E,0,0],[-E,0,0],[0,E,0],[0,-E,0],[0,0,E],[0,0,-E]],x=c.clickable||c.hoverable;x&&c.intersectionShape===void 0&&(c.intersectionShape={sphere:[],cylinder:[],line:[]});for(var w=(0,h.getColorFromStyle)(c,v),C=D.vertexArray,S=D.colorArray,A=0;A<6;A++){var P=D.vertices*3;if(D.vertices++,C[P]=c.x+p[A][0],C[P+1]=c.y+p[A][1],C[P+2]=c.z+p[A][2],S[P]=w.r,S[P+1]=w.g,S[P+2]=w.b,x){var O=new s.Vector3(p[A][0],p[A][1],p[A][2]);O.multiplyScalar(.1),O.set(O.x+c.x,O.y+c.y,O.z+c.z),c.intersectionShape.line.push(O)}}}}}getGoodCross(c,f,v,y){for(var D=null,E=-1,p=0,x=c.bonds.length;p<x;p++)if(c.bonds[p]!=f.index){let C=c.bonds[p],S=this.atoms[C],P=new s.Vector3(S.x,S.y,S.z).clone();P.sub(v);let O=P.clone();O.cross(y);var w=O.lengthSq();if(w>E&&(E=w,D=O,E>.1))return D}return D}getSideBondV(c,f,v){var y,D,E,p,x,w=new s.Vector3(c.x,c.y,c.z),C=new s.Vector3(f.x,f.y,f.z),S=C.clone(),A=null;if(S.sub(w),c.bonds.length===1)f.bonds.length===1?(A=S.clone(),Math.abs(A.x)>1e-4?A.y+=1:A.x+=1):(y=(v+1)%f.bonds.length,D=f.bonds[y],E=this.atoms[D],E.index==c.index&&(y=(y+1)%f.bonds.length,D=f.bonds[y],E=this.atoms[D]),p=new s.Vector3(E.x,E.y,E.z),x=p.clone(),x.sub(w),A=x.clone(),A.cross(S));else if(A=this.getGoodCross(c,f,w,S),A.lengthSq()<.01){var P=this.getGoodCross(f,c,w,S);P!=null&&(A=P)}return A.lengthSq()<.01&&(A=S.clone(),Math.abs(A.x)>1e-4?A.y+=1:A.x+=1),A.cross(S),A.normalize(),A}addLine(c,f,v,y,D,E){c[v]=y.x,c[v+1]=y.y,c[v+2]=y.z,f[v]=E.r,f[v+1]=E.g,f[v+2]=E.b,c[v+3]=D.x,c[v+4]=D.y,c[v+5]=D.z,f[v+3]=E.r,f[v+4]=E.g,f[v+5]=E.b}drawBondLines(c,f,v){if(c.style.line){var y=c.style.line;if(!y.hidden){var D,E,p,x,w=y.linewidth||b.defaultlineWidth;v[w]||(v[w]=new i.Geometry);for(var C=v[w].updateGeoGroup(6*c.bonds.length),S=C.vertexArray,A=C.colorArray,P=0;P<c.bonds.length;P++){var O=c.bonds[P],F=f[O];if(F.style.line&&!(c.index>=F.index)){var I=new s.Vector3(c.x,c.y,c.z),B=new s.Vector3(F.x,F.y,F.z),k=I.clone().add(B).multiplyScalar(.5),U=!1,W=c.clickable||c.hoverable,R=F.clickable||F.hoverable;(W||R)&&(W&&(c.intersectionShape===void 0&&(c.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),c.intersectionShape.line.push(I),c.intersectionShape.line.push(k)),R&&(F.intersectionShape===void 0&&(F.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),F.intersectionShape.line.push(k),F.intersectionShape.line.push(B)));var z=(0,h.getColorFromStyle)(c,c.style.line),V=(0,h.getColorFromStyle)(F,F.style.line);if(c.bondStyles&&c.bondStyles[P]){var q=c.bondStyles[P];if(!q.iswire)continue;q.singleBond&&(U=!0),typeof q.color1<"u"&&(z=o.CC.color(q.color1)),typeof q.color2<"u"&&(V=o.CC.color(q.color2))}var Q=C.vertices*3,re,te;if(c.bondOrder[P]>1&&c.bondOrder[P]<4&&!U){var ae=this.getSideBondV(c,F,P),ne=B.clone();ne.sub(I),c.bondOrder[P]==2?(ae.multiplyScalar(.1),D=I.clone(),D.add(ae),E=I.clone(),E.sub(ae),p=D.clone(),p.add(ne),x=E.clone(),x.add(ne),z==V?(C.vertices+=4,this.addLine(S,A,Q,D,p,z),this.addLine(S,A,Q+6,E,x,z)):(C.vertices+=8,ne.multiplyScalar(.5),re=D.clone(),re.add(ne),te=E.clone(),te.add(ne),this.addLine(S,A,Q,D,re,z),this.addLine(S,A,Q+6,re,p,V),this.addLine(S,A,Q+12,E,te,z),this.addLine(S,A,Q+18,te,x,V))):c.bondOrder[P]==3&&(ae.multiplyScalar(.1),D=I.clone(),D.add(ae),E=I.clone(),E.sub(ae),p=D.clone(),p.add(ne),x=E.clone(),x.add(ne),z==V?(C.vertices+=6,this.addLine(S,A,Q,I,B,z),this.addLine(S,A,Q+6,D,p,z),this.addLine(S,A,Q+12,E,x,z)):(C.vertices+=12,ne.multiplyScalar(.5),re=D.clone(),re.add(ne),te=E.clone(),te.add(ne),this.addLine(S,A,Q,I,k,z),this.addLine(S,A,Q+6,k,B,V),this.addLine(S,A,Q+12,D,re,z),this.addLine(S,A,Q+18,re,p,V),this.addLine(S,A,Q+24,E,te,z),this.addLine(S,A,Q+30,te,x,V)))}else z==V?(C.vertices+=2,this.addLine(S,A,Q,I,B,z)):(C.vertices+=4,this.addLine(S,A,Q,I,k,z),this.addLine(S,A,Q+6,k,B,V))}}}}}drawAtomSphere(c,f){if(c.style.sphere){var v=c.style.sphere;if(!v.hidden){var y=(0,h.getColorFromStyle)(c,v),D=this.getRadiusFromStyle(c,v);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var E=new s.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new n.Sphere(E,D))}a.GLDraw.drawSphere(f,c,D,y)}}}drawAtomClickSphere(c){if(c.style.clicksphere){var f=c.style.clicksphere;if(!f.hidden){var v=this.getRadiusFromStyle(c,f);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var y=new s.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new n.Sphere(y,v))}}}}drawAtomInstanced(c,f){if(c.style.sphere){var v=c.style.sphere;if(!v.hidden){var y=this.getRadiusFromStyle(c,v),D=(0,h.getColorFromStyle)(c,v),E=f.updateGeoGroup(1),p=E.vertices,x=p*3,w=E.vertexArray,C=E.colorArray,S=E.radiusArray;if(w[x]=c.x,w[x+1]=c.y,w[x+2]=c.z,C[x]=D.r,C[x+1]=D.g,C[x+2]=D.b,S[p]=y,(c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var A=new s.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new n.Sphere(A,y))}E.vertices+=1}}}drawSphereImposter(c,f,v,y){var D=c.updateGeoGroup(4),E,p=D.vertices,x=p*3,w=D.vertexArray,C=D.colorArray;for(E=0;E<4;E++)w[x+3*E]=f.x,w[x+3*E+1]=f.y,w[x+3*E+2]=f.z;var S=D.normalArray;for(E=0;E<4;E++)C[x+3*E]=y.r,C[x+3*E+1]=y.g,C[x+3*E+2]=y.b;S[x+0]=-v,S[x+1]=v,S[x+2]=0,S[x+3]=-v,S[x+4]=-v,S[x+5]=0,S[x+6]=v,S[x+7]=-v,S[x+8]=0,S[x+9]=v,S[x+10]=v,S[x+11]=0,D.vertices+=4;var A=D.faceArray,P=D.faceidx;A[P+0]=p,A[P+1]=p+1,A[P+2]=p+2,A[P+3]=p+2,A[P+4]=p+3,A[P+5]=p,D.faceidx+=6}drawAtomImposter(c,f){if(c.style.sphere){var v=c.style.sphere;if(!v.hidden){var y=this.getRadiusFromStyle(c,v),D=(0,h.getColorFromStyle)(c,v);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var E=new s.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new n.Sphere(E,y))}this.drawSphereImposter(f,c,y,D)}}}calculateDashes(c,f,v,y,D){var E=Math.sqrt(Math.pow(c.x-f.x,2)+Math.pow(c.y-f.y,2)+Math.pow(c.z-f.z,2));v=Math.max(v,0),D=Math.max(D,0)+2*v,y=Math.max(y,.001),y+D>E&&(y=E,D=0);var p=Math.floor((E-y)/(y+D))+1,x=p*y;D=(E-x)/p;for(var w,C=new s.Vector3(c.x,c.y,c.z),S=new s.Vector3((f.x-c.x)/(E/D),(f.y-c.y)/(E/D),(f.z-c.z)/(E/D)),A=new s.Vector3((f.x-c.x)/(E/y),(f.y-c.y)/(E/y),(f.z-c.z)/(E/y)),P=[],O=0;O<p;O++)w=new s.Vector3(C.x+A.x,C.y+A.y,C.z+A.z),P.push({from:C,to:w}),C=new s.Vector3(w.x+S.x,w.y+S.y,w.z+S.z);return P}static drawStickImposter(c,f,v,y,D,E=0,p=0){for(var x=c.updateGeoGroup(4),w=x.vertices,C=w*3,S=x.vertexArray,A=x.colorArray,P=x.radiusArray,O=x.normalArray,F=D.r,I=D.g,B=D.b,k=function(V){var q=-V;return q==0&&(q=-1e-4),q},U=C,W=0;W<4;W++)S[U]=f.x,O[U]=v.x,A[U]=F,U++,S[U]=f.y,O[U]=v.y,A[U]=I,U++,S[U]=f.z,O[U]=v.z,W<2?A[U]=B:A[U]=k(B),U++;x.vertices+=4,P[w]=-y,P[w+1]=y,P[w+2]=-y,P[w+3]=y;var R=x.faceArray,z=x.faceidx;R[z+0]=w,R[z+1]=w+1,R[z+2]=w+2,R[z+3]=w+2,R[z+4]=w+3,R[z+5]=w,x.faceidx+=6}drawBondSticks(c,f,v){var y,D;if(c.style.stick){var E=c.style.stick;if(!E.hidden){var p=E.radius||this.defaultStickRadius,x=E.doubleBondScaling||.4,w=E.tripleBondScaling||.25,C=((y=E.dashedBondConfig)===null||y===void 0?void 0:y.dashLength)||.1,S=((D=E.dashedBondConfig)===null||D===void 0?void 0:D.gapLength)||.25,A=p,P=E.singleBonds||!1,O=E.dashedBonds||!1,F=0,I=0,B,k,U,W,R,z,V,q,Q,re,te,ae=(0,h.getColorFromStyle)(c,E),ne,le,Ee;!c.capDrawn&&c.bonds.length<4&&(F=2);var De=ce=>{var ve=v.imposter?b.drawStickImposter:a.GLDraw.drawCylinder;return!O&&ce>=1?ve:(Oe,oe,me,$,Te,ke=0,L=0,ge=.1,de=.25)=>{var j=this.calculateDashes(oe,me,$,ge,de);j.forEach(se=>{ve(Oe,se.from,se.to,$,Te,ke,L)})}};for(U=0;U<c.bonds.length;U++){var Pe=De(c.bondOrder[U]),pe=c.bonds[U],Z=f[pe];if(ne=le=Ee=null,c.index<Z.index){var be=Z.style;if(!be.stick||be.stick.hidden)continue;var Ce=(0,h.getColorFromStyle)(Z,be.stick);if(A=p,W=P,c.bondStyles&&c.bondStyles[U]){if(R=c.bondStyles[U],R.iswire)continue;R.radius&&(A=R.radius),R.singleBond&&(W=!0),typeof R.color1<"u"&&(ae=o.CC.color(R.color1)),typeof R.color2<"u"&&(Ce=o.CC.color(R.color2))}var ie=new s.Vector3(c.x,c.y,c.z),Ne=new s.Vector3(Z.x,Z.y,Z.z);if(c.bondOrder[U]<=1||W||c.bondOrder[U]>3){if(c.bondOrder[U]<1&&(A*=c.bondOrder[U]),!Z.capDrawn&&Z.bonds.length<4&&(I=2),ae!=Ce?(ne=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5),Pe(v,ie,ne,A,ae,F,0,C,S),Pe(v,ne,Ne,A,Ce,0,I,C,S)):Pe(v,ie,Ne,A,ae,F,I,C,S),B=c.clickable||c.hoverable,k=Z.clickable||Z.hoverable,B||k){if(ne||(ne=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5)),B){var Ve=new n.Cylinder(ie,ne,A),Ue=new n.Sphere(ie,A);c.intersectionShape.cylinder.push(Ve),c.intersectionShape.sphere.push(Ue)}if(k){var Fe=new n.Cylinder(Ne,ne,A),ze=new n.Sphere(Ne,A);Z.intersectionShape.cylinder.push(Fe),Z.intersectionShape.sphere.push(ze)}}}else if(c.bondOrder[U]>1){var Re=0,Le=0;A!=p&&(Re=2,Le=2);var We=Ne.clone(),He=null;We.sub(ie);var H,K,X,_e,ue;He=this.getSideBondV(c,Z,U),c.bondOrder[U]==2?(H=A*x,He.multiplyScalar(H*1.5),K=ie.clone(),K.add(He),X=ie.clone(),X.sub(He),_e=K.clone(),_e.add(We),ue=X.clone(),ue.add(We),ae!=Ce?(ne=new s.Vector3().addVectors(K,_e).multiplyScalar(.5),le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5),Pe(v,K,ne,H,ae,Re,0),Pe(v,ne,_e,H,Ce,0,Le),Pe(v,X,le,H,ae,Re,0),Pe(v,le,ue,H,Ce,0,Le)):(Pe(v,K,_e,H,ae,Re,Le),Pe(v,X,ue,H,ae,Re,Le)),B=c.clickable||c.hoverable,k=Z.clickable||Z.hoverable,(B||k)&&(ne||(ne=new s.Vector3().addVectors(K,_e).multiplyScalar(.5)),le||(le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5)),B&&(z=new n.Cylinder(K,ne,H),V=new n.Cylinder(X,le,H),c.intersectionShape.cylinder.push(z),c.intersectionShape.cylinder.push(V)),k&&(Q=new n.Cylinder(_e,ne,H),re=new n.Cylinder(ue,le,H),Z.intersectionShape.cylinder.push(Q),Z.intersectionShape.cylinder.push(re)))):c.bondOrder[U]==3&&(H=A*w,He.cross(We),He.normalize(),He.multiplyScalar(H*3),K=ie.clone(),K.add(He),X=ie.clone(),X.sub(He),_e=K.clone(),_e.add(We),ue=X.clone(),ue.add(We),ae!=Ce?(ne=new s.Vector3().addVectors(K,_e).multiplyScalar(.5),le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5),Ee=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5),Pe(v,K,ne,H,ae,Re,0),Pe(v,ne,_e,H,Ce,0,Le),Pe(v,ie,Ee,H,ae,F,0),Pe(v,Ee,Ne,H,Ce,0,I),Pe(v,X,le,H,ae,Re,0),Pe(v,le,ue,H,Ce,0,Le)):(Pe(v,K,_e,H,ae,Re,Le),Pe(v,ie,Ne,H,ae,F,I),Pe(v,X,ue,H,ae,Re,Le)),B=c.clickable||c.hoverable,k=Z.clickable||Z.hoverable,(B||k)&&(ne||(ne=new s.Vector3().addVectors(K,_e).multiplyScalar(.5)),le||(le=new s.Vector3().addVectors(X,ue).multiplyScalar(.5)),Ee||(Ee=new s.Vector3().addVectors(ie,Ne).multiplyScalar(.5)),B&&(z=new n.Cylinder(K.clone(),ne.clone(),H),V=new n.Cylinder(X.clone(),le.clone(),H),q=new n.Cylinder(ie.clone(),Ee.clone(),H),c.intersectionShape.cylinder.push(z),c.intersectionShape.cylinder.push(V),c.intersectionShape.cylinder.push(q)),k&&(Q=new n.Cylinder(_e.clone(),ne.clone(),H),re=new n.Cylinder(ue.clone(),le.clone(),H),te=new n.Cylinder(Ne.clone(),Ee.clone(),H),Z.intersectionShape.cylinder.push(Q),Z.intersectionShape.cylinder.push(re),Z.intersectionShape.cylinder.push(te))))}}}var ye=!1,Ae=0,G=!1;for(U=0;U<c.bonds.length;U++)W=P,c.bondStyles&&c.bondStyles[U]&&(R=c.bondStyles[U],R.singleBond&&(W=!0),R.radius&&R.radius!=p&&(G=!0)),(W||c.bondOrder[U]==1)&&Ae++;G?Ae>0&&(ye=!0):Ae==0&&(c.bonds.length>0||E.showNonBonded)&&(ye=!0),ye&&(A=p,v.imposter?this.drawSphereImposter(v.sphereGeometry,c,A,ae):a.GLDraw.drawSphere(v,c,A,ae))}}}createMolObj(c,f){f=f||{};var v=new i.Object3D,y=[],D={},E={},p=this.drawAtomSphere,x=null,w=null;f.supportsImposters?(p=this.drawAtomImposter,x=new i.Geometry(!0),x.imposter=!0,w=new i.Geometry(!0,!0),w.imposter=!0,w.sphereGeometry=new i.Geometry(!0),w.sphereGeometry.imposter=!0,w.drawnCaps={}):f.supportsAIA?(p=this.drawAtomInstanced,x=new i.Geometry(!1,!0,!0),x.instanced=!0,w=new i.Geometry(!0)):(x=new i.Geometry(!0),w=new i.Geometry(!0));var C,S,A,P,O={},F=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(C=0,A=c.length;C<A;C++){var I=c[C];if(I&&I.style){(I.clickable||I.hoverable)&&I.intersectionShape===void 0&&(I.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),P={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(S in P)I.style[S]?I.style[S].opacity?P[S]=parseFloat(I.style[S].opacity):P[S]=1:P[S]=void 0,O[S]?P[S]!=null&&O[S]!=P[S]&&(console.log("Warning: "+S+" opacity is ambiguous"),O[S]=1):O[S]=P[S];p.call(this,I,x),this.drawAtomClickSphere(I),this.drawAtomCross(I,E),this.drawBondLines(I,c,D),this.drawBondSticks(I,c,w),typeof I.style.cartoon<"u"&&!I.style.cartoon.hidden&&(I.style.cartoon.color==="spectrum"&&typeof I.resi=="number"&&!I.hetflag&&(I.resi<F[0]&&(F[0]=I.resi),I.resi>F[1]&&(F[1]=I.resi)),y.push(I))}}if(y.length>0&&(0,l.drawCartoon)(v,y,F,this.defaultCartoonQuality),x&&x.vertices>0){x.initTypedArrays();var B=null,k=null;x.imposter?B=new i.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):x.instanced?(k=new i.Geometry(!0),a.GLDraw.drawSphere(k,{x:0,y:0,z:0},1,new o.Color(.5,.5,.5)),k.initTypedArrays(),B=new i.InstancedMaterial({sphereMaterial:new i.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:k})):B=new i.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),O.sphere<1&&O.sphere>=0&&(B.transparent=!0,B.opacity=O.sphere),k=new i.Mesh(x,B),v.add(k)}if(w.vertices>0){var U=null,W=null,R=w.sphereGeometry;(!R||typeof R.vertices>"u"||R.vertices==0)&&(R=null),w.initTypedArrays(),R&&R.initTypedArrays();var z={ambient:0,vertexColors:!0,reflectivity:0};w.imposter?(U=new i.StickImposterMaterial(z),W=new i.SphereImposterMaterial(z)):(U=new i.MeshLambertMaterial(z),W=new i.MeshLambertMaterial(z),U.wireframe&&(w.setUpWireframe(),R&&R.setUpWireframe())),O.stick<1&&O.stick>=0&&(U.transparent=!0,U.opacity=O.stick,W.transparent=!0,W.opacity=O.stick);var V=new i.Mesh(w,U);if(v.add(V),R){var q=new i.Mesh(R,W);v.add(q)}}var Q;for(C in D)if(D.hasOwnProperty(C)){Q=C;var re=new i.LineBasicMaterial({linewidth:Q,vertexColors:!0});O.line<1&&O.line>=0&&(re.transparent=!0,re.opacity=O.line),D[C].initTypedArrays();var te=new i.Line(D[C],re,i.LineStyle.LinePieces);v.add(te)}for(C in E)if(E.hasOwnProperty(C)){Q=C;var ae=new i.LineBasicMaterial({linewidth:Q,vertexColors:!0});O.cross<1&&O.cross>=0&&(ae.transparent=!0,ae.opacity=O.cross),E[C].initTypedArrays();var ne=new i.Line(E[C],ae,i.LineStyle.LinePieces);v.add(ne)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var le=new i.Object3D,Ee;for(Ee=0;Ee<this.modelData.symmetries.length;Ee++){var De=new i.Object3D;De=v.clone(),De.matrix.copy(this.modelData.symmetries[Ee]),De.matrixAutoUpdate=!1,le.add(De)}return le}return v}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(c){this.atoms=c.atoms,this.frames=c.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const c=this.modelData.cryst;this.modelData.cryst.matrix=(0,s.conversionMatrix3)(c.a,c.b,c.c,c.alpha,c.beta,c.gamma)}return this.modelData.cryst}else return null}setCrystData(c,f,v,y,D,E){c=c||1,f=f||1,v=v||1,y=y||90,D=D||90,E=E||90;const p=(0,s.conversionMatrix3)(c,f,v,y,D,E);this.modelData.cryst={a:c,b:f,c:v,alpha:y,beta:D,gamma:E,matrix:p}}setCrystMatrix(c){c=c||new s.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:c}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(c){typeof c>"u"?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=c,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(c,f,v,y){var D=f-c;return D<-v?f+y:D>v?f-y:f}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var c=this.box[0],f=this.box[1],v=this.box[2],y=c*.9,D=f*.9,E=v*.9,p=0;p<this.atomdfs.length;p++)for(var x=this.atomdfs[p],w=1;w<x.length;w++){var C=this.atoms[x[w][0]],S=this.atoms[x[w][1]];C.x=this.adjustCoord(S.x,C.x,y,c),C.y=this.adjustCoord(S.y,C.y,D,f),C.z=this.adjustCoord(S.z,C.z,E,v)}}setFrame(c){var f=this.getNumFrames();let v=this,y=this.viewer;return new Promise(function(D,E){if(f==0&&D(),(c<0||c>=f)&&(c=f-1),v.frames.url!=null){var p=v.frames.url;(0,h.getbin)(p+"/traj/frame/"+c+"/"+v.frames.path,void 0,"POST",void 0).then(function(x){for(var w=new Float32Array(x,44),C=0,S=0;S<v.atoms.length;S++)v.atoms[S].x=w[C++],v.atoms[S].y=w[C++],v.atoms[S].z=w[C++];v.box&&v.atomdfs&&v.adjustCoordinatesToBox(),D()}).catch(E)}else v.atoms=v.frames[c],D();v.molObj=null,v.modelDatas&&c<v.modelDatas.length&&(v.modelData=v.modelDatas[c],v.unitCellObjects&&y&&(y.removeUnitCell(v),y.addUnitCell(v)))})}addFrame(c){this.frames.push(c)}vibrate(c=10,f=1,v=!1,y){var D=0,E=c;let p=this.viewer;v&&(D=-c,E=c),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),D<E&&(this.frames=[]),v&&(this.frames.origIndex=c);for(var x=D;x<E;x++){var w=[],C=this.frames.length;if(x==0&&!y){this.frames.push(this.atoms);continue}for(var S=0;S<this.atoms.length;S++){var A=(0,h.getAtomProperty)(this.atoms[S],"dx"),P=(0,h.getAtomProperty)(this.atoms[S],"dy"),O=(0,h.getAtomProperty)(this.atoms[S],"dz"),F=new s.Vector3(A,P,O),I=new s.Vector3(this.atoms[S].x,this.atoms[S].y,this.atoms[S].z),B=x*f/c;F.multiplyScalar(B),I.add(F);var k={};for(var U in this.atoms[S])k[U]=this.atoms[S][U];if(k.x=I.x,k.y=I.y,k.z=I.z,w.push(k),p&&y){var W=(0,h.extend)({},y),R=new s.Vector3(A,P,O);if(R.multiplyScalar(f),R.add(I),W.start=I,W.end=R,W.frame=C,!W.color){var z=k.style.sphere;z||(z=k.style.stick),z||(z=k.style.line),W.color=(0,h.getColorFromStyle)(k,z)}p.addArrow(W)}}this.frames.push(w)}}setAtomDefaults(c){for(let f=0;f<c.length;f++){let v=c[f];v&&(v.style=v.style||(0,h.deepCopy)(b.defaultAtomStyle),v.color=v.color||this.ElementColors[v.elem]||this.defaultColor,v.model=this.id,(v.clickable||v.hoverable)&&(v.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(c,f,v={}){var y=b.parseMolData(c,f,v);this.dontDuplicateAtoms=!v.duplicateAssemblyAtoms;var D=y.modelData;if(D&&(Array.isArray(D)?(this.modelData=D[0],v.frames&&(this.modelDatas=D)):this.modelData=D),y.box?this.box=y.box:this.box=null,this.frames.length==0){for(let p=0;p<y.length;p++)y[p].length!=0&&this.frames.push(y[p]);this.frames[0]&&(this.atoms=this.frames[0])}else if(v.frames)for(let p=0;p<y.length;p++)this.frames.push(y[p]);else for(var E=0;E<y.length;E++)this.addAtoms(y[E]);for(let p=0;p<this.frames.length;p++)this.setAtomDefaults(this.frames[p]);v.vibrate&&v.vibrate.frames&&v.vibrate.amplitude&&this.vibrate(v.vibrate.frames,v.vibrate.amplitude),v.style&&this.setStyle({},v.style)}setDontDuplicateAtoms(c){this.dontDuplicateAtoms=c}setModelData(c){this.modelData=c}propertyMatches(c,f){if(c==f)return!0;if(typeof f=="string"&&typeof c=="number"){var v=f.match(/(-?\d+)\s*-\s*(-?\d+)/);if(v){var y=parseInt(v[1]),D=parseInt(v[2]);if(v&&c>=y&&c<=D)return!0}}return!1}static deepCopyAndCache(c,f){if(typeof c!="object"||c==null||c.__cache_created)return c;const v={};for(const y in c){const D=c[y];if(Array.isArray(D)){v[y]=[];for(let E=0;E<D.length;E++)v[y].push(b.deepCopyAndCache(D[E],f))}else typeof D=="object"&&y!="properties"&&y!="model"?v[y]=b.deepCopyAndCache(D,f):v[y]=D;if(y=="and"||y=="or"){const E=[];for(const p of v[y]){const x=new Set;for(const w of f.selectedAtoms(p))x.add(w.index);E.push(x)}if(y=="and"){const p=function(w,C){const S=new Set;for(const A of C)w.has(A)&&S.add(A);return S};let x=new Set(E[0]);for(const w of E.splice(1))x=p(x,w);v[y].__cached_results=x}else if(y=="or"){const p=new Set;for(const x of E)for(const w of x)p.add(w);v[y].__cached_results=p}}}return v.__cache_created=!0,v}atomIsSelected(c,f){if(typeof f>"u")return!0;var v=!!f.invert,y=!0;for(var D in f)if(D=="and"||D=="or"||D=="not"){if(D=="not"){if(this.atomIsSelected(c,f[D])){y=!1;break}}else if(f[D].__cached_results===void 0&&(f=b.deepCopyAndCache(f,this)),y=f[D].__cached_results.has(c.index),!y)break}else if(D==="predicate"){if(!f.predicate(c)){y=!1;break}}else if(D=="properties"&&c[D]){for(var E in f.properties)if(!E.startsWith("__cache")){if(typeof c.properties[E]>"u"){y=!1;break}if(c.properties[E]!=f.properties[E]){y=!1;break}}}else if(D=="model"){let C=f.model;if(typeof C=="number"&&C<0&&(C=this.viewer.getNextModelId()+C),Array.isArray(C)){let S=!1;for(let A=0;A<C.length;A++)if(C[A]==this||C[A]==this.id){S=!0;break}if(!S){y=!1;break}}else if(C!=this&&C!=this.id){y=!1;break}}else if(f.hasOwnProperty(D)&&!b.ignoredKeys.has(D)&&!D.startsWith("__cache")){if(typeof c[D]>"u"){y=!1;break}let C=!1;if(D==="bonds"){var p=f[D];if(p!=c.bonds.length){y=!1;break}}else if(Array.isArray(f[D])){var x=f[D],w=c[D];for(let S=0;S<x.length;S++)if(this.propertyMatches(w,x[S])){C=!0;break}if(!C){y=!1;break}}else{let S=f[D];if(!this.propertyMatches(c[D],S)){y=!1;break}}}return v?!y:y}static squaredDistance(c,f){var v=f.x-c.x,y=f.y-c.y,D=f.z-c.z;return v*v+y*y+D*D}expandAtomList(c,f){if(f<=0)return c;for(var v=(0,h.getExtent)(c,void 0),y=[[],[],[]],D=0;D<3;D++)y[0][D]=v[0][D]-f,y[1][D]=v[1][D]+f,y[2][D]=v[2][D];var E=[];for(let C=0;C<this.atoms.length;C++){var p=this.atoms[C].x,x=this.atoms[C].y,w=this.atoms[C].z;p>=y[0][0]&&p<=y[1][0]&&x>=y[0][1]&&x<=y[1][1]&&w>=y[0][2]&&w<=y[1][2]&&(p>=v[0][0]&&p<=v[1][0]&&x>=v[0][1]&&x<=v[1][1]&&w>=v[0][2]&&w<=v[1][2]||E.push(this.atoms[C]))}return E}static getFloat(c){return typeof c=="number"?c:parseFloat(c)}selectedAtoms(c,f){var v=[];c=b.deepCopyAndCache(c||{},this),f||(f=this.atoms);for(var y=f.length,D=0;D<y;D++){var E=f[D];E&&this.atomIsSelected(E,c)&&v.push(E)}if(c.hasOwnProperty("expand")){const k=b.getFloat(c.expand);let U=this.expandAtomList(v,k),W=v.length;const R=k*k;for(let z=0;z<U.length;z++)for(let V=0;V<W;V++){var p=b.squaredDistance(U[z],v[V]);p<R&&p>0&&v.push(U[z])}}if(c.hasOwnProperty("within")&&c.within.hasOwnProperty("sel")&&c.within.hasOwnProperty("distance")){var x=this.selectedAtoms(c.within.sel,this.atoms),w={};const k=b.getFloat(c.within.distance),U=k*k;for(let W=0;W<x.length;W++)for(let R=0;R<v.length;R++){let z=b.squaredDistance(x[W],v[R]);z<U&&z>0&&(w[R]=1)}var C=[];if(c.within.invert)for(let W=0;W<v.length;W++)w[W]||C.push(v[W]);else for(let W in w)C.push(v[W]);v=C}if(c.hasOwnProperty("byres")){var S={},A=[],P=[];for(let k=0;k<v.length;k++){let U=v[k];var O=U.chain,F=U.resi;if(S[O]===void 0&&(S[O]={}),U.hasOwnProperty("resi")&&S[O][F]===void 0){for(S[O][F]=!0,P.push(U);P.length>0;)if(U=P.pop(),O=U.chain,F=U.resi,A[U.index]===void 0){A[U.index]=!0;for(var I=0;I<U.bonds.length;I++){var B=this.atoms[U.bonds[I]];A[B.index]===void 0&&B.hasOwnProperty("resi")&&B.chain==O&&B.resi==F&&(P.push(B),v.push(B))}}}}}return v}addAtoms(c){this.molObj=null;var f=this.atoms.length,v=[],y;for(y=0;y<c.length;y++)typeof c[y].index>"u"&&(c[y].index=y),typeof c[y].serial>"u"&&(c[y].serial=y),v[c[y].index]=f+y;for(y=0;y<c.length;y++){var D=c[y],E=v[D.index],p=(0,h.extend)({},D);p.index=E,p.bonds=[],p.bondOrder=[],p.model=this.id,p.style=p.style||(0,h.deepCopy)(b.defaultAtomStyle),typeof p.color>"u"&&(p.color=this.ElementColors[p.elem]||this.defaultColor);for(var x=D.bonds?D.bonds.length:0,w=0;w<x;w++){var C=v[D.bonds[w]];typeof C<"u"&&(p.bonds.push(C),p.bondOrder.push(D.bondOrder?D.bondOrder[w]:1))}this.atoms.push(p)}}assignBonds(){(0,_.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(c){this.molObj=null;var f=[],v;for(v=0;v<c.length;v++)f[c[v].index]=!0;var y=[];for(v=0;v<this.atoms.length;v++){var D=this.atoms[v];f[D.index]||y.push(D)}this.atoms=[],this.addAtoms(y)}setStyle(c,f,v){typeof f>"u"&&typeof v>"u"&&(f=c,c={}),c=c,typeof f=="string"&&(f=(0,h.specStringToObject)(f));var y=!1,D=this,E=function(x){var w=D.selectedAtoms(c,x);for(let C=0;C<x.length;C++)x[C]&&(x[C].capDrawn=!1);for(let C=0;C<w.length;C++){y=!0,(w[C].clickable||w[C].hoverable)&&(w[C].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),v||(w[C].style={});for(let S in f)f.hasOwnProperty(S)&&(w[C].style[S]=w[C].style[S]||{},Object.assign(w[C].style[S],f[S]))}};if(c.frame!==void 0&&c.frame<this.frames.length){let x=c.frame;x<0&&(x=this.frames.length+x),E(this.frames[x])}else{E(this.atoms);for(var p=0;p<this.frames.length;p++)this.frames[p]!==this.atoms&&E(this.frames[p])}y&&(this.molObj=null)}setClickable(c,f,v){if(f=!!f,v=(0,h.makeFunction)(v),v===null){console.log("Callback is not a function");return}var y=this.selectedAtoms(c,this.atoms),D=y.length;for(let E=0;E<D;E++)y[E].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},y[E].clickable=f,v&&(y[E].callback=v);D>0&&(this.molObj=null)}setHoverable(c,f,v,y){if(f=!!f,v=(0,h.makeFunction)(v),y=(0,h.makeFunction)(y),v===null){console.log("Hover_callback is not a function");return}if(y===null){console.log("Unhover_callback is not a function");return}var D=this.selectedAtoms(c,this.atoms),E=D.length;for(let p=0;p<E;p++)D[p].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},D[p].hoverable=f,v&&(D[p].hover_callback=v),y&&(D[p].unhover_callback=y);E>0&&(this.molObj=null)}enableContextMenu(c,f){f=!!f;var v,y=this.selectedAtoms(c,this.atoms),D=y.length;for(v=0;v<D;v++)y[v].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},y[v].contextMenuEnabled=f;D>0&&(this.molObj=null)}setColorByElement(c,f){if(!(this.molObj!==null&&b.sameObj(f,this.lastColors))){this.lastColors=f;var v=this.selectedAtoms(c,v);v.length>0&&(this.molObj=null);for(var y=0;y<v.length;y++){var D=v[y];typeof f[D.elem]<"u"&&(D.color=f[D.elem])}}}setColorByProperty(c,f,v,y){var D,E,p=this.selectedAtoms(c,p);for(this.lastColors=null,p.length>0&&(this.molObj=null),typeof v=="string"&&typeof u.Gradient.builtinGradients[v]<"u"&&(v=new u.Gradient.builtinGradients[v]),v=v,y||(y=v.range()),y||(y=(0,h.getPropertyRange)(p,f)),D=0;D<p.length;D++){E=p[D];var x=(0,h.getAtomProperty)(E,f);x!=null&&(E.color=v.valueToHex(parseFloat(E.properties[f]),y))}}setColorByFunction(c,f){var v=this.selectedAtoms(c,v);if(typeof f=="function"){this.lastColors=null,v.length>0&&(this.molObj=null);for(let y=0;y<v.length;y++){let D=v[y];D.color=f(D)}}}toCDObject(c=!1){var f={a:[],b:[]};c&&(f.s=[]);for(let y=0;y<this.atoms.length;y++){let D={},E=this.atoms[y];if(D.x=E.x,D.y=E.y,D.z=E.z,E.elem!="C"&&(D.l=E.elem),c){for(var v=0;v<f.s.length&&JSON.stringify(E.style)!==JSON.stringify(f.s[v]);)v++;v===f.s.length&&f.s.push(E.style),v!==0&&(D.s=v)}f.a.push(D);for(let p=0;p<E.bonds.length;p++){let x=y,w=E.bonds[p];if(x>=w)continue;let C={b:x,e:w},S=E.bondOrder[p];S!=1&&(C.o=S),f.b.push(C)}}return f}globj(c,f){(this.molObj===null||f.regen)&&(this.molObj=this.createMolObj(this.atoms,f),this.renderedMolObj&&(c.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),c.add(this.renderedMolObj))}exportVRML(){var c=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return c.vrml()}removegl(c){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),c.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(c,f,v){let y=this.selectedAtoms(f),D=this.viewer,E=(0,h.deepCopy)(v);for(let x=0;x<y.length;x++){let w=y[x];var p=null;typeof w[c]<"u"?p=String(w[c]):typeof w.properties[c]<"u"&&(p=String(w.properties[c])),p!=null&&(E.position=w,D.addLabel(p,E))}}addResLabels(c,f,v=!1){let y=this.viewer;var D=[],E=function(x,w){for(var C=x.selectedAtoms(c,C),S={},A=0;A<C.length;A++){var P=C[A],O=P.chain,F=P.resn,I=P.resi,B=F+""+I;S[O]||(S[O]={}),S[O][B]||(S[O][B]=[]),S[O][B].push(P)}var k=(0,h.deepCopy)(f);for(let W in S)if(S.hasOwnProperty(W)){var U=S[W];for(let R in U)if(U.hasOwnProperty(R)){let z=U[R],V=new s.Vector3(0,0,0);for(let Q=0;Q<z.length;Q++){let re=z[Q];V.x+=re.x,V.y+=re.y,V.z+=re.z}V.divideScalar(z.length),k.position=V,k.frame=w;let q=y.addLabel(R,k,void 0,!0);D.push(q)}}};if(v){var p=this.getNumFrames();let x=this.atoms;for(let w=0;w<p;w++)this.frames[w]&&(this.atoms=this.frames[w],E(this,w));this.atoms=x}else E(this);return D}setupDFS(){this.atomdfs=[];var c=this,f=new Int8Array(this.atoms.length);f.fill(0);for(var v=function(p,x,w){w.push([p,x]);var C=c.atoms[p];f[p]=1;for(var S=0;S<C.bonds.length;S++){var A=C.bonds[S];c.atoms[A]&&!f[A]&&v(A,p,w)}},y=0;y<this.atoms.length;y++){var D=this.atoms[y];if(D&&!f[y]){var E=[];v(y,-1,E),this.atomdfs.push(E)}}}setCoordinatesFromURL(c,f){this.frames=[];var v=this;return this.box&&this.setupDFS(),c.startsWith("http")||(c="http://"+c),(0,h.get)(c+"/traj/numframes/"+f,function(y){if(!isNaN(parseInt(y)))return v.frames.push(v.atoms),v.frames.numFrames=y,v.frames.url=c,v.frames.path=f,v.setFrame(0)})}setCoordinates(c,f){if(f=f||"",!c)return[];if(/\.gz$/.test(f)){f=f.replace(/\.gz$/,"");try{c=(0,h.inflateString)(c)}catch(S){console.log(S)}}var v={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(v.hasOwnProperty(f)){this.frames=[];for(var y=this.atoms.length,D=b.parseCrd(c,f),E=0;E<D.length;){for(var p=[],x=0;x<y;x++){var w={};for(var C in this.atoms[x])w[C]=this.atoms[x][C];p[x]=w,p[x].x=D[E++],p[x].y=D[E++],p[x].z=D[E++]}this.frames.push(p)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(c){}static parseCrd(c,f){var v=[],y=0;if(f=="pdb")for(var D=c.indexOf(`
ATOM`);D!=-1;){for(;c.slice(D,D+5)==`
ATOM`||c.slice(D,D+7)==`
HETATM`;)v[y++]=parseFloat(c.slice(D+31,D+39)),v[y++]=parseFloat(c.slice(D+39,D+47)),v[y++]=parseFloat(c.slice(D+47,D+55)),D=c.indexOf(`
`,D+54),c.slice(D,D+4)==`
TER`&&(D=c.indexOf(`
`,D+5));D=c.indexOf(`
ATOM`,D)}else if(f=="netcdf"){var E=new m.NetCDFReader(c);v=[].concat.apply([],E.getDataVariable("coordinates"))}else{if(f=="array"||Array.isArray(c))return c.flat(2);{let p=c.indexOf(`
`);f=="inpcrd"&&(p=c.indexOf(`
`,p+1)),c=c.slice(p+1),v=c.match(/\S+/g).map(parseFloat)}}return v}static parseMolData(c,f="",v){if(!c)return[];if(/\.gz$/.test(f)){f=f.replace(/\.gz$/,"");try{f.match(/bcif/i)?c=(0,h.inflateString)(c,!1):c=(0,h.inflateString)(c)}catch(E){console.log(E)}}typeof g.Parsers[f]>"u"&&(f=f.split(".").pop(),typeof g.Parsers[f]>"u"&&(console.log("Unknown format: "+f),c instanceof Uint8Array?f="bcif":c.match(/^@<TRIPOS>MOLECULE/gm)?f="mol2":c.match(/^data_/gm)&&c.match(/^loop_/gm)?f="cif":c.match(/^HETATM/gm)||c.match(/^ATOM/gm)?f="pdb":c.match(/ITEM: TIMESTEP/gm)?f="lammpstrj":c.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?f="sdf":c.match(/^%VERSION\s+VERSION_STAMP/gm)?f="prmtop":f="xyz",console.log("Best guess: "+f)));var y=g.Parsers[f],D=y(c,v);return D}}b.defaultAtomStyle={line:{}},b.defaultlineWidth=1,b.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},b.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])},"./src/GLShape.ts":(r,e,t)=>{t.r(e),t.d(e,{GLShape:()=>m,splitMesh:()=>_});var i=t("./src/WebGL/index.ts"),n=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts"),a=t("./src/ProteinSurface4.ts"),l=t("./src/VolumeData.ts"),h=t("./src/GLDraw.ts"),u=t("./src/glcartoon.ts"),g=t("./src/utilities.ts");class m{static finalizeGeo(d){var c=d.updateGeoGroup(0);c.vertices>0&&c.truncateArrayBuffers(!0,!0)}static updateColor(d,c){c=c||o.CC.color(c),d.colorsNeedUpdate=!0;var f,v,y;c.constructor!==Array&&(f=c.r,v=c.g,y=c.b);for(let D in d.geometryGroups){let E=d.geometryGroups[D],p=E.colorArray;for(let x=0,w=E.vertices;x<w;++x){if(c.constructor===Array){let C=c[x];f=C.r,v=C.g,y=C.b}p[x*3]=f,p[x*3+1]=v,p[x*3+2]=y}}}static drawArrow(d,c,f){var v=f.start,y=f.end,D=f.radius,E=f.radiusRatio,p=f.mid,x=f.midpos;if(!(v&&y))return;var w=c.updateGeoGroup(51),C=new s.Vector3(y.x,y.y,y.z).sub(v);if(x){let oe=C.length();x>0?p=x/oe:p=(oe+x)/oe}C.multiplyScalar(p);var S=new s.Vector3(v.x,v.y,v.z).add(C),A=C.clone().negate();let P=new s.Vector3(v.x,v.y,v.z);d.intersectionShape.cylinder.push(new n.Cylinder(P,S.clone(),D)),d.intersectionShape.sphere.push(new n.Sphere(P,D));var O=[];O[0]=C.clone(),Math.abs(O[0].x)>1e-4?O[0].y+=1:O[0].x+=1,O[0].cross(C),O[0].normalize(),O[4]=O[0].clone(),O[4].crossVectors(O[0],C),O[4].normalize(),O[8]=O[0].clone().negate(),O[12]=O[4].clone().negate(),O[2]=O[0].clone().add(O[4]).normalize(),O[6]=O[4].clone().add(O[8]).normalize(),O[10]=O[8].clone().add(O[12]).normalize(),O[14]=O[12].clone().add(O[0]).normalize(),O[1]=O[0].clone().add(O[2]).normalize(),O[3]=O[2].clone().add(O[4]).normalize(),O[5]=O[4].clone().add(O[6]).normalize(),O[7]=O[6].clone().add(O[8]).normalize(),O[9]=O[8].clone().add(O[10]).normalize(),O[11]=O[10].clone().add(O[12]).normalize(),O[13]=O[12].clone().add(O[14]).normalize(),O[15]=O[14].clone().add(O[0]).normalize();var F=w.vertices,I=w.vertexArray,B=w.faceArray,k=w.normalArray,U=w.lineArray,W,R,z;for(R=0,z=O.length;R<z;++R){W=3*(F+3*R);var V=O[R].clone().multiplyScalar(D).add(v),q=O[R].clone().multiplyScalar(D).add(S),Q=O[R].clone().multiplyScalar(D*E).add(S);if(I[W]=V.x,I[W+1]=V.y,I[W+2]=V.z,I[W+3]=q.x,I[W+4]=q.y,I[W+5]=q.z,I[W+6]=Q.x,I[W+7]=Q.y,I[W+8]=Q.z,R>0){var re=I[W-3],te=I[W-2],ae=I[W-1],ne=new s.Vector3(re,te,ae),le=new s.Vector3(y.x,y.y,y.z),Ee=S.clone(),De=new s.Vector3(Q.x,Q.y,Q.z);d.intersectionShape.triangle.push(new n.Triangle(De,le,ne)),d.intersectionShape.triangle.push(new n.Triangle(ne.clone(),Ee,De.clone()))}}w.vertices+=48,W=w.vertices*3,I[W]=v.x,I[W+1]=v.y,I[W+2]=v.z,I[W+3]=S.x,I[W+4]=S.y,I[W+5]=S.z,I[W+6]=y.x,I[W+7]=y.y,I[W+8]=y.z,w.vertices+=3;var Pe,pe,Z,be,Ce,ie,Ne,Ve,Ue,Fe,ze,Re,Le,We,He,H,K,X,_e,ue=w.vertices-3,ye=w.vertices-2,Ae=w.vertices-1,G=ue*3,ce=ye*3,ve=Ae*3;for(R=0,z=O.length-1;R<z;++R){var Oe=F+3*R;W=Oe*3,pe=w.faceidx,Z=w.lineidx,be=Oe,Fe=be*3,Ce=Oe+1,ze=Ce*3,ie=Oe+2,Re=ie*3,Ne=Oe+4,Le=Ne*3,Ve=Oe+5,We=Ve*3,Ue=Oe+3,He=Ue*3,H=K=O[R],X=_e=O[R+1],k[Fe]=H.x,k[ze]=K.x,k[He]=_e.x,k[Fe+1]=H.y,k[ze+1]=K.y,k[He+1]=_e.y,k[Fe+2]=H.z,k[ze+2]=K.z,k[He+2]=_e.z,k[ze]=K.x,k[Le]=X.x,k[He]=_e.x,k[ze+1]=K.y,k[Le+1]=X.y,k[He+1]=_e.y,k[ze+2]=K.z,k[Le+2]=X.z,k[He+2]=_e.z,k[Re]=K.x,k[We]=X.x,k[Re+1]=K.y,k[We+1]=X.y,k[Re+2]=K.z,k[We+2]=X.z,B[pe]=be,B[pe+1]=Ce,B[pe+2]=Ue,B[pe+3]=Ce,B[pe+4]=Ne,B[pe+5]=Ue,B[pe+6]=be,B[pe+7]=Ue,B[pe+8]=ue,B[pe+9]=ie,B[pe+10]=ye,B[pe+11]=Ve,B[pe+12]=ie,B[pe+13]=Ae,B[pe+14]=Ve,U[Z]=be,U[Z+1]=Ce,U[Z+2]=be,U[Z+3]=Ue,U[Z+4]=Ne,U[Z+5]=Ue,U[Z+6]=be,U[Z+7]=Ue,U[Z+8]=ie,U[Z+9]=Ce,U[Z+10]=ie,U[Z+11]=Ve,U[Z+12]=Ne,U[Z+13]=Ve,U[Z+14]=ie,U[Z+15]=Ae,U[Z+16]=ie,U[Z+17]=Ve,U[Z+18]=Ae,U[Z+19]=Ve,w.faceidx+=15,w.lineidx+=20}Pe=[F+45,F+46,F+1,F,F+47,F+2],pe=w.faceidx,Z=w.lineidx,be=Pe[0],Fe=be*3,Ce=Pe[1],ze=Ce*3,ie=Pe[4],Re=ie*3,Ne=Pe[2],Le=Ne*3,Ve=Pe[5],We=Ve*3,Ue=Pe[3],He=Ue*3,H=K=O[15],X=_e=O[0],k[Fe]=H.x,k[ze]=K.x,k[He]=_e.x,k[Fe+1]=H.y,k[ze+1]=K.y,k[He+1]=_e.y,k[Fe+2]=H.z,k[ze+2]=K.z,k[He+2]=_e.z,k[ze]=K.x,k[Le]=X.x,k[He]=_e.x,k[ze+1]=K.y,k[Le+1]=X.y,k[He+1]=_e.y,k[ze+2]=K.z,k[Le+2]=X.z,k[He+2]=_e.z,k[Re]=K.x,k[We]=X.x,k[Re+1]=K.y,k[We+1]=X.y,k[Re+2]=K.z,k[We+2]=X.z,C.normalize(),A.normalize(),k[G]=A.x,k[ce]=k[ve]=C.x,k[G+1]=A.y,k[ce+1]=k[ve+1]=C.y,k[G+2]=A.z,k[ce+2]=k[ve+2]=C.z,B[pe]=be,B[pe+1]=Ce,B[pe+2]=Ue,B[pe+3]=Ce,B[pe+4]=Ne,B[pe+5]=Ue,B[pe+6]=be,B[pe+7]=Ue,B[pe+8]=ue,B[pe+9]=ie,B[pe+10]=ye,B[pe+11]=Ve,B[pe+12]=ie,B[pe+13]=Ae,B[pe+14]=Ve,U[Z]=be,U[Z+1]=Ce,U[Z+2]=be,U[Z+3]=Ue,U[Z+4]=Ne,U[Z+5]=Ue,U[Z+6]=be,U[Z+7]=Ue,U[Z+8]=ie,U[Z+9]=Ce,U[Z+10]=ie,U[Z+11]=Ve,U[Z+12]=Ne,U[Z+13]=Ve,U[Z+14]=ie,U[Z+15]=Ae,U[Z+16]=ie,U[Z+17]=Ve,U[Z+18]=Ae,U[Z+19]=Ve,w.faceidx+=15,w.lineidx+=20}static updateBoundingFromPoints(d,c,f,v){d.center.set(0,0,0);let y=1/0,D=1/0,E=1/0,p=-1/0,x=-1/0,w=-1/0;d.box&&(y=d.box.min.x,p=d.box.max.x,D=d.box.min.y,x=d.box.max.y,E=d.box.min.z,w=d.box.max.z);for(let P=0,O=v;P<O;P++){var C=f[P*3],S=f[P*3+1],A=f[P*3+2];C<y&&(y=C),S<D&&(D=S),A<E&&(E=A),C>p&&(p=C),S>x&&(x=S),A>w&&(w=A)}d.center.set((p+y)/2,(x+D)/2,(w+E)/2),d.radius=d.center.distanceTo({x:p,y:x,z:w}),d.box={min:{x:y,y:D,z:E},max:{x:p,y:x,z:w}}}static addCustomGeo(d,c,f,v,y){var D=c.addGeoGroup(),E=f.vertexArr,p=f.normalArr,x=f.faceArr;D.vertices=E.length,D.faceidx=x.length;var w,C,S,A,P,O,F,I,B,k=D.vertexArray,U=D.colorArray;for(v.constructor!==Array&&(I=v.r,B=v.g,A=v.b),O=0,F=D.vertices;O<F;++O)w=O*3,C=E[O],k[w]=C.x,k[w+1]=C.y,k[w+2]=C.z,v.constructor===Array&&(P=v[O],I=P.r,B=P.g,A=P.b),U[w]=I,U[w+1]=B,U[w+2]=A;if(y)for(O=0,F=D.faceidx/3;O<F;++O){w=O*3,S=x[w],A=x[w+1],P=x[w+2];var W=new s.Vector3,R=new s.Vector3,z=new s.Vector3;d.intersectionShape.triangle.push(new n.Triangle(W.copy(E[S]),R.copy(E[A]),z.copy(E[P])))}if(y){var V=new s.Vector3(0,0,0),q=0;for(let te=0;te<c.geometryGroups.length;te++)V.add(c.geometryGroups[te].getCentroid()),q++;V.divideScalar(q),m.updateBoundingFromPoints(d.boundingSphere,{centroid:V},k,D.vertices)}if(D.faceArray=new Uint16Array(x),D.truncateArrayBuffers(!0,!0),p.length<D.vertices)D.setNormals();else{var Q=D.normalArray=new Float32Array(D.vertices*3),re;for(O=0,F=D.vertices;O<F;++O)w=O*3,re=p[O],Q[w]=re.x,Q[w+1]=re.y,Q[w+2]=re.z}D.setLineIndices(),D.lineidx=D.lineArray.length}static updateFromStyle(d,c){typeof c.color<"u"?(d.color=c.color||new o.Color,c.color instanceof o.Color||(d.color=o.CC.color(c.color))):d.color=o.CC.color(0),d.wireframe=!!c.wireframe,d.opacity=c.alpha?(0,s.clamp)(c.alpha,0,1):1,typeof c.opacity<"u"&&(d.opacity=(0,s.clamp)(c.opacity,0,1)),d.side=c.side!==void 0?c.side:i.DoubleSide,d.linewidth=typeof c.linewidth>"u"?1:c.linewidth,d.clickable=!!c.clickable,d.callback=(0,g.makeFunction)(c.callback),d.hoverable=!!c.hoverable,d.hover_callback=(0,g.makeFunction)(c.hover_callback),d.unhover_callback=(0,g.makeFunction)(c.unhover_callback),d.contextMenuEnabled=!!c.contextMenuEnabled,d.hidden=c.hidden,d.frame=c.frame}constructor(d){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=i.DoubleSide,this.stylespec=d||{},this.boundingSphere=new n.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},m.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new i.Geometry(!0),this.linegeo=new i.Geometry(!0)}updateStyle(d){for(var c in d)this.stylespec[c]=d[c];if(m.updateFromStyle(this,this.stylespec),d.voldata&&d.volscheme){(0,g.adjustVolumeStyle)(d);const f=d.volscheme,v=d.voldata,y=o.CC,D=f.range()||[-1,1];this.geo.setColors(function(E,p,x){let w=v.getVal(E,p,x);return y.color(f.valueToHex(w,D))}),delete this.color}}addCustom(d){d.vertexArr=d.vertexArr||[],d.faceArr=d.faceArr||[],d.normalArr=d.normalArr||[],m.drawCustom(this,this.geo,d)}addSphere(d){d.center||(d.center=new s.Vector3(0,0,0)),d.radius=d.radius?(0,s.clamp)(d.radius,0,1/0):1.5,d.color=o.CC.color(d.color),this.intersectionShape.sphere.push(new n.Sphere(d.center,d.radius)),h.GLDraw.drawSphere(this.geo,d.center,d.radius,d.color,d.quality),this.components.push({centroid:new s.Vector3(d.center.x,d.center.y,d.center.z)});var c=this.geo.updateGeoGroup(0);m.updateBoundingFromPoints(this.boundingSphere,this.components,c.vertexArray,c.vertices)}addBox(d){var c=d.dimensions||{w:1,h:1,d:1},f;typeof c.w=="number"?f={x:c.w,y:0,z:0}:f=c.w;var v;typeof c.h=="number"?v={x:0,y:c.h,z:0}:v=c.h;var y;typeof c.d=="number"?y={x:0,y:0,z:c.d}:y=c.d;var D=d.corner;D==null&&(d.center!==void 0?D={x:d.center.x-.5*(f.x+v.x+y.x),y:d.center.y-.5*(f.y+v.y+y.y),z:d.center.z-.5*(f.z+v.z+y.z)}:D={x:0,y:0,z:0});var E=[{x:D.x,y:D.y,z:D.z},{x:D.x+f.x,y:D.y+f.y,z:D.z+f.z},{x:D.x+v.x,y:D.y+v.y,z:D.z+v.z},{x:D.x+f.x+v.x,y:D.y+f.y+v.y,z:D.z+f.z+v.z},{x:D.x+y.x,y:D.y+y.y,z:D.z+y.z},{x:D.x+f.x+y.x,y:D.y+f.y+y.y,z:D.z+f.z+y.z},{x:D.x+v.x+y.x,y:D.y+v.y+y.y,z:D.z+v.z+y.z},{x:D.x+f.x+v.x+y.x,y:D.y+f.y+v.y+y.y,z:D.z+f.z+v.z+y.z}],p=[],x=[];p.splice(p.length,0,E[0],E[1],E[2],E[3]),x.splice(x.length,0,0,2,1,1,2,3);var w=4;p.splice(p.length,0,E[2],E[3],E[6],E[7]),x.splice(x.length,0,w+0,w+2,w+1,w+1,w+2,w+3),w+=4,p.splice(p.length,0,E[4],E[5],E[0],E[1]),x.splice(x.length,0,w+0,w+2,w+1,w+1,w+2,w+3),w+=4,p.splice(p.length,0,E[6],E[7],E[4],E[5]),x.splice(x.length,0,w+0,w+2,w+1,w+1,w+2,w+3),w+=4,p.splice(p.length,0,E[3],E[1],E[7],E[5]),x.splice(x.length,0,w+0,w+2,w+1,w+1,w+2,w+3),w+=4,p.splice(p.length,0,E[2],E[6],E[0],E[4]),x.splice(x.length,0,w+0,w+2,w+1,w+1,w+2,w+3),w+=4;var C=(0,g.extend)({},d);C.vertexArr=p,C.faceArr=x,C.normalArr=[],m.drawCustom(this,this.geo,C);var S=new s.Vector3;this.components.push({centroid:S.addVectors(E[0],E[7]).multiplyScalar(.5)});var A=this.geo.updateGeoGroup(0);m.updateBoundingFromPoints(this.boundingSphere,this.components,A.vertexArray,A.vertices)}addCylinder(d){var c,f;d.start?c=new s.Vector3(d.start.x||0,d.start.y||0,d.start.z||0):c=new s.Vector3(0,0,0),d.end?(f=new s.Vector3(d.end.x,d.end.y||0,d.end.z||0),typeof f.x>"u"&&(f.x=3)):f=new s.Vector3(0,0,0);var v=d.radius||.1,y=o.CC.color(d.color);this.intersectionShape.cylinder.push(new n.Cylinder(c,f,v)),h.GLDraw.drawCylinder(this.geo,c,f,v,y,d.fromCap,d.toCap);var D=new s.Vector3;this.components.push({centroid:D.addVectors(c,f).multiplyScalar(.5)});var E=this.geo.updateGeoGroup(0);m.updateBoundingFromPoints(this.boundingSphere,this.components,E.vertexArray,E.vertices)}addDashedCylinder(d){d.dashLength=d.dashLength||.25,d.gapLength=d.gapLength||.25;var c;d.start?c=new s.Vector3(d.start.x||0,d.start.y||0,d.start.z||0):c=new s.Vector3(0,0,0);var f;d.end?(f=new s.Vector3(d.end.x,d.end.y||0,d.end.z||0),typeof f.x>"u"&&(f.x=3)):f=new s.Vector3(3,0,0);for(var v=d.radius||.1,y=o.CC.color(d.color),D=Math.sqrt(Math.pow(c.x-f.x,2)+Math.pow(c.y-f.y,2)+Math.pow(c.z-f.z,2)),E=D/(d.gapLength+d.dashLength),p=new s.Vector3(d.start.x||0,d.start.y||0,d.start.z||0),x=new s.Vector3(d.end.x,d.end.y||0,d.end.z||0),w=new s.Vector3((f.x-c.x)/(D/d.gapLength),(f.y-c.y)/(D/d.gapLength),(f.z-c.z)/(D/d.gapLength)),C=new s.Vector3((f.x-c.x)/(D/d.dashLength),(f.y-c.y)/(D/d.dashLength),(f.z-c.z)/(D/d.dashLength)),S=0;S<E;S++)x=new s.Vector3(p.x+C.x,p.y+C.y,p.z+C.z),this.intersectionShape.cylinder.push(new n.Cylinder(p,x,v)),h.GLDraw.drawCylinder(this.geo,p,x,v,y,d.fromCap,d.toCap),p=new s.Vector3(x.x+w.x,x.y+w.y,x.z+w.z);var A=new s.Vector3;this.components.push({centroid:A.addVectors(c,f).multiplyScalar(.5)});var P=this.geo.updateGeoGroup(0);m.updateBoundingFromPoints(this.boundingSphere,this.components,P.vertexArray,P.vertices)}addCurve(d){d.points=d.points||[],d.smooth=d.smooth||10,typeof d.fromCap>"u"&&(d.fromCap=2),typeof d.toCap>"u"&&(d.toCap=2);var c=(0,u.subdivide_spline)(d.points,d.smooth);if(c.length<3){console.log("Too few points in addCurve");return}var f=d.radius||.1,v=o.CC.color(d.color),y=0,D=c.length-1,E=c[0].distanceTo(c[1]),p=Math.ceil(2*f/E);if(d.toArrow){D-=p;let S={start:c[D],end:c[c.length-1],radius:f,color:v,mid:1e-4};this.addArrow(S)}if(d.fromArrow){y+=p;let S={start:c[y],end:c[0],radius:f,color:v,mid:1e-4};this.addArrow(S)}for(var x=Math.ceil(c.length/2),w={radius:f,color:v,fromCap:2,toCap:2},C=y;C<D;C++)w.start=c[C],w.end=c[C+1],w.fromCap=2,w.toCap=2,C<x?(w.fromCap=2,w.toCap=0):C>x?(w.fromCap=0,w.toCap=2):(w.fromCap=2,w.toCap=2),this.addCylinder(w)}addLine(d){var c,f;d.start?c=new s.Vector3(d.start.x||0,d.start.y||0,d.start.z||0):c=new s.Vector3(0,0,0),d.end?(f=new s.Vector3(d.end.x,d.end.y||0,d.end.z||0),typeof f.x>"u"&&(f.x=3)):f=new s.Vector3(3,0,0);var v=this.geo.updateGeoGroup(2),y=v.vertices,D=y*3,E=v.vertexArray;E[D]=c.x,E[D+1]=c.y,E[D+2]=c.z,E[D+3]=f.x,E[D+4]=f.y,E[D+5]=f.z,v.vertices+=2;var p=v.lineArray,x=v.lineidx;p[x]=y,p[x+1]=y+1,v.lineidx+=2;var w=new s.Vector3;this.components.push({centroid:w.addVectors(c,f).multiplyScalar(.5)}),v=this.geo.updateGeoGroup(0),m.updateBoundingFromPoints(this.boundingSphere,this.components,v.vertexArray,v.vertices)}addArrow(d){if(d.start?d.start=new s.Vector3(d.start.x||0,d.start.y||0,d.start.z||0):d.start=new s.Vector3(0,0,0),d.dir instanceof s.Vector3&&typeof d.length=="number"){var c=d.dir.clone().multiplyScalar(d.length).add(d.start);d.end=c}else d.end?(d.end=new s.Vector3(d.end.x,d.end.y||0,d.end.z||0),typeof d.end.x>"u"&&(d.end.x=3)):d.end=new s.Vector3(3,0,0);d.radius=d.radius||.1,d.radiusRatio=d.radiusRatio||1.618034,d.mid=0<d.mid&&d.mid<1?d.mid:.618034,m.drawArrow(this,this.geo,d);var f=new s.Vector3;this.components.push({centroid:f.addVectors(d.start,d.end).multiplyScalar(.5)});var v=this.geo.updateGeoGroup(0);m.updateBoundingFromPoints(this.boundingSphere,this.components,v.vertexArray,v.vertices)}static distance_from(d,c){return Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2)+Math.pow(d.z-c.z,2))}static inSelectedRegion(d,c,f){for(var v=0;v<c.length;v++)if(m.distance_from(c[v],d)<=f)return!0;return!1}addIsosurface(d,c,f,v){var y=c.isoval!==void 0&&typeof c.isoval=="number"?c.isoval:0,D=!!c.voxel,E=c.smoothness===void 0?1:c.smoothness,p=d.size.x,x=d.size.y,w=d.size.z,C=new Int16Array(p*x*w),S=d.data,A,P;for(A=0,P=C.length;A<P;++A)C[A]=-1;var O=new Uint8Array(p*x*w);for(A=0,P=S.length;A<P;++A){var F=y>=0?S[A]-y:y-S[A];F>0&&(O[A]|=m.ISDONE)}var I=[],B=[];a.MarchingCube.march(O,I,B,{fulltable:!0,voxel:D,unitCube:d.unit,origin:d.origin,matrix:d.matrix,nX:p,nY:x,nZ:w}),!D&&E>0&&a.MarchingCube.laplacianSmooth(E,I,B);var k=[],U=[],W=[];if(c.selectedRegion&&c.coords===void 0&&(c.coords=c.selectedRegion),c.coords===void 0&&c.selection!==void 0&&(v?c.coords=v.selectedAtoms(c.selection):console.log("addIsosurface needs viewer is selection provided.")),c.coords!==void 0){var R=c.coords[0].x,z=c.coords[0].y,V=c.coords[0].z,q=c.coords[0].x,Q=c.coords[0].y,re=c.coords[0].z;for(let Z=0;Z<c.coords.length;Z++)c.coords[Z].x>R?R=c.coords[Z].x:c.coords[Z].x<q&&(q=c.coords[Z].x),c.coords[Z].y>z?z=c.coords[Z].y:c.coords[Z].y<Q&&(Q=c.coords[Z].y),c.coords[Z].z>V?V=c.coords[Z].z:c.coords[Z].z<re&&(re=c.coords[Z].z);var te=2;c.radius!==void 0&&(te=c.radius),c.selectedOffset!==void 0&&(te=c.selectedOffset),c.seldist!==void 0&&(te=c.seldist),q-=te,R+=te,Q-=te,z+=te,re-=te,V+=te;for(let Z=0;Z<I.length;Z++)I[Z].x>q&&I[Z].x<R&&I[Z].y>Q&&I[Z].y<z&&I[Z].z>re&&I[Z].z<V&&m.inSelectedRegion(I[Z],c.coords,te)?(k.push(U.length),U.push(I[Z])):k.push(-1);for(let Z=0;Z+2<B.length;Z+=3)k[B[Z]]!==-1&&k[B[Z+1]]!==-1&&k[B[Z+2]]!==-1&&(W.push(B[Z]-(B[Z]-k[B[Z]])),W.push(B[Z+1]-(B[Z+1]-k[B[Z+1]])),W.push(B[Z+2]-(B[Z+2]-k[B[Z+2]])));I=U,B=W}m.drawCustom(this,this.geo,{vertexArr:I,faceArr:B,normalArr:[],clickable:c.clickable,hoverable:c.hoverable}),this.updateStyle(c);var ae=new s.Vector3(d.origin.x,d.origin.y,d.origin.z),ne=new s.Vector3(d.size.x*d.unit.x,d.size.y*d.unit.y,d.size.z*d.unit.z),le=new s.Vector3(0,0,0),Ee=ae.clone(),De=ae.clone().add(ne);for(let Z=0;Z<I.length;Z++)le.add(I[Z]),Ee.max(I[Z]),De.min(I[Z]);le.divideScalar(I.length);var Pe=le.distanceTo(De),pe=le.distanceTo(Ee);this.boundingSphere.center=le,this.boundingSphere.radius=Math.max(Pe,pe),typeof f=="function"&&f()}addVolumetricData(d,c,f){d=new l.VolumeData(d,c),this.addIsosurface(d,f)}finalize(){return m.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(d){if(this.renderedShapeObj&&(d.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){m.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&m.updateColor(this.geo,this.color),this.shapeObj=new i.Object3D;var c=null;this.side==i.DoubleSide?c=new i.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:i.Coloring.VertexColors}):c=new i.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:i.Coloring.VertexColors});var f=new i.Mesh(this.geo,c);if(this.shapeObj.add(f),this.linegeo&&this.linegeo.vertices>0){var v=new i.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),y=new i.Line(this.linegeo,v,i.LineStyle.LinePieces);this.shapeObj.add(y)}this.renderedShapeObj=this.shapeObj.clone(),d.add(this.renderedShapeObj)}}removegl(d){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),d.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}m.ISDONE=2,m.drawCustom=function(b,d,c){var f=c,v=f.vertexArr,y=f.faceArr;(v.length===0||y.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var D=c.color;typeof D>"u"&&(D=b.color),D=o.CC.color(D);for(var E=_(f),p=0,x=E.length;p<x;p++)m.addCustomGeo(b,d,E[p],E[p].colorArr?E[p].colorArr:D,c.clickable)};function _(b){var d=64e3;if(b.vertexArr.length<d)return[b];var c=[{vertexArr:[],normalArr:[],faceArr:[]}];b.colorArr&&(c.colorArr=[]);var f=[],v=[],y=0,D=b.faceArr;for(let p=0,x=D.length;p<x;p+=3){let w=c[y];for(let C=0;C<3;C++){var E=D[p+C];f[E]!==y&&(f[E]=y,v[E]=w.vertexArr.length,w.vertexArr.push(b.vertexArr[E]),b.normalArr&&b.normalArr[E]&&w.normalArr.push(b.normalArr[E]),b.colorArr&&b.colorArr[E]&&w.colorArr.push(b.colorArr[E])),w.faceArr.push(v[E])}w.vertexArr.length>=d&&(c.push({vertexArr:[],normalArr:[],faceArr:[]}),b.colorArr&&(c.colorArr=[]),y++)}return c}},"./src/GLViewer.ts":(r,e,t)=>{t.r(e),t.d(e,{CONTEXTS_PER_VIEWPORT:()=>d,GLViewer:()=>f,createStereoViewer:()=>D,createViewer:()=>v,createViewerGrid:()=>y});var i=t("./node_modules/upng-js/UPNG.js"),n=t("./src/GLModel.ts"),s=t("./src/GLShape.ts"),o=t("./src/Gradient.ts"),a=t("./src/Label.ts"),l=t("./src/ProteinSurface4.ts"),h=t("./src/VolumeData.ts"),u=t("./src/VolumetricRender.ts"),g=t("./src/WebGL/index.ts"),m=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts"),b=t("./src/utilities.ts");const d=16;class c extends Array{constructor(p){super(...p)}getSymmetries(){if(this.length==0)return[];let p=this[0];return typeof p.symmetries>"u"&&this.setSymmetries([new m.Matrix4]),p.symmetries}setSymmetries(p){typeof p>"u"&&(p=[new m.Matrix4]);for(let x of this)x.symmetries=p,x.finished=!1}}class f{getWidth(){let p=this.container,x=p.offsetWidth;if(x==0&&p.style.display==="none"){let w=p.style.position,C=p.style.visibility;p.style.display="block",p.style.visibility="hidden",p.style.position="absolute",x=p.offsetWidth,p.style.display="none",p.style.visibility=C,p.style.position=w}return x}getHeight(){let p=this.container,x=p.offsetHeight;if(x==0&&p.style.display==="none"){let w=p.style.position,C=p.style.visibility;p.style.display="block",p.style.visibility="hidden",p.style.position="absolute",x=p.offsetHeight,p.style.display="none",p.style.visibility=C,p.style.position=w}return x}setupRenderer(){let p=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new g.Renderer(p),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new g.Scene,this.scene.fog=new g.Fog(this.bgColor,100,200),this.modelGroup=new g.Object3D,this.rotationGroup=new g.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new m.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var p=new g.Light(16777215);p.position=new m.Vector3(.2,.2,1).normalize(),p.intensity=1,this.scene.add(p)}_handleLostContext(p){const x=function(w){const C=w.getBoundingClientRect();return!(C.right<0||C.bottom<0||C.top>(window.innerHeight||document.documentElement.clientHeight)||C.left>(window.innerWidth||document.documentElement.clientWidth))};if(x(this.container)){let w=0;for(let C of document.getElementsByTagName("canvas"))if(x(C)&&C._3dmol_viewer!=null&&(C._3dmol_viewer.resize(),w+=1,w>=d))break}}initContainer(p){this.container=p,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var p=0;for(let w in this.surfaces)if(this.surfaces.hasOwnProperty(w)){var x=parseInt(w);isNaN(x)||x>p&&(p=x)}return p+1}setSlabAndFog(){let p=this.camera.position.z-this.rotationGroup.position.z;p<1&&(p=1),this.camera.near=p+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=p+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=p*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(p){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!p&&this.linkedViewers.length>0))for(var x=this._viewer.getView(),w=0;w<this.linkedViewers.length;w++){var C=this.linkedViewers[w];C.setView(x,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let p=0,x=this.models.length;p<x;p++){let w=this.models[p];if(w){let C=w.selectedAtoms({clickable:!0}),S=w.selectedAtoms({hoverable:!0}),A=w.selectedAtoms({contextMenuEnabled:!0});for(let P=0;P<S.length;P++)this.hoverables.push(S[P]);for(let P=0;P<C.length;P++)this.clickables.push(C[P]);for(let P=0;P<A.length;P++)this.contextMenuEnabledObjects.push(A[P])}}for(let p=0,x=this.shapes.length;p<x;p++){let w=this.shapes[p];w&&w.clickable&&this.clickables.push(w),w&&w.hoverable&&this.hoverables.push(w),w&&w.contextMenuEnabled&&this.contextMenuEnabledObjects.push(w)}}handleClickSelection(p,x,w){let C=this.targetedObjects(p,x,this.clickables);if(C.length){var S=C[0].clickable;S.callback!==void 0&&(typeof S.callback!="function"&&(S.callback=(0,b.makeFunction)(S.callback)),typeof S.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(S)&&this.userContextMenuHandler||S.callback(S,this._viewer,w,this.container,C)))}}canvasOffset(){let p=this.glDOM,x=p.getBoundingClientRect(),w=p.ownerDocument,C=w.documentElement,S=w.defaultView;return{top:x.top+S.pageYOffset-C.clientTop,left:x.left+S.pageXOffset-C.clientLeft}}setHover(p,x,w){this.current_hover!=p&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,b.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,x,this.container,w)),this.current_hover=p,p&&p.hover_callback!==void 0&&(typeof p.hover_callback!="function"&&(p.hover_callback=(0,b.makeFunction)(p.hover_callback)),typeof p.hover_callback=="function"&&p.hover_callback(p,this._viewer,x,this.container,w)))}handleHoverSelection(p,x,w){if(this.hoverables.length==0)return;let C=this.targetedObjects(p,x,this.hoverables);if(C.length){var S=C[0].clickable;this.setHover(S,w,C),this.current_hover=S}else this.setHover(null)}handleHoverContinue(p,x){let w=this.targetedObjects(p,x,this.hoverables);(w.length==0||w[0]===void 0)&&this.setHover(null),w[0]!==void 0&&w[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(p,{allowTolerance:x=p.targetTouches,tolerance:w=5}={}){const C=this.getX(p),S=this.getY(p);if(x){const A=Math.abs(C-this.mouseStartX),P=Math.abs(S-this.mouseStartY);return A<=w&&P<=w}else return C===this.mouseStartX&&S===this.mouseStartY}calcTouchDistance(p){var x=p.targetTouches[0].pageX-p.targetTouches[1].pageX,w=p.targetTouches[0].pageY-p.targetTouches[1].pageY;return Math.hypot(x,w)}getX(p){var x=p.pageX;return x==null&&(x=p.pageX),p.targetTouches&&p.targetTouches[0]?x=p.targetTouches[0].pageX:p.changedTouches&&p.changedTouches[0]&&(x=p.changedTouches[0].pageX),x}getY(p){var x=p.pageY;return x==null&&(x=p.pageY),p.targetTouches&&p.targetTouches[0]?x=p.targetTouches[0].pageY:p.changedTouches&&p.changedTouches[0]&&(x=p.changedTouches[0].pageY),x}isInViewer(p,x){if(this.viewers!=null){var w=this.WIDTH/this.cols,C=this.HEIGHT/this.rows,S=this.canvasOffset(),A=p-S.left,P=x-S.top,O=this.rows-Math.floor(P/C)-1,F=Math.floor(A/w);if(O!=this.row||F!=this.col)return!1}return!0}adjustZoomToLimits(p){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let x=this.CAMERA_Z-this.config.lowerZoomLimit;p>x&&(p=x)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let x=this.CAMERA_Z-this.config.upperZoomLimit;p<x&&(p=x)}return p>this.CAMERA_Z-1&&(p=this.CAMERA_Z-1),p}static slerp(p,x,w){if(w==1)return x.clone();if(w==0)return p.clone();let C=p.x*x.x+p.y*x.y+p.z*x.z+p.w*x.w;if(C>.9995){let B=new m.Quaternion(p.x+w*(x.x-p.x),p.y+w*(x.y-p.y),p.z+w*(x.z-p.z),p.w+w*(x.w-p.w));return B.normalize(),B}C<0&&(x=x.clone().multiplyScalar(-1),C=-C),C>1?C=1:C<-1&&(C=-1);var S=Math.acos(C),A=S*w,P=x.clone();P.sub(p.clone().multiplyScalar(C)),P.normalize();var O=Math.cos(A),F=Math.sin(A),I=new m.Quaternion(p.x*O+P.x*F,p.y*O+P.y*F,p.z*O+P.z*F,p.w*O+P.w*F);return I.normalize(),I}constructor(p,x={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new m.Quaternion(0,0,0,1),this.dq=new m.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=x,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=_.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=_.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=p,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new g.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new m.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new m.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new g.Raycaster(new m.Vector3(0,0,0),new m.Vector3(0,0,0)),this.projector=new g.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=_.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let w=(C,S)=>{C.forEach(A=>{A.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(w),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(w){console.log("error with glviewer callback: "+w)}}targetedObjects(p,x,w){var C={x:p,y:x,z:-1};return Array.isArray(w)||(w=this.selectedAtoms(w)),w.length==0?[]:(this.raycaster.setFromCamera(C,this.camera),this.raycaster.intersectObjects(this.modelGroup,w))}modelToScreen(p){let x=!1;Array.isArray(p)||(p=[p],x=!0);let w=this.renderer.getXRatio(),C=this.renderer.getYRatio(),S=this.col,A=this.row,P=S*(this.WIDTH/w),O=(C-A-1)*(this.HEIGHT/C),F=[],I=this.canvasOffset();return p.forEach(B=>{let k=new m.Vector3(B.x,B.y,B.z);k.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(k,this.camera);let U=this.WIDTH/w*(k.x+1)/2+I.left+P,W=-(this.HEIGHT/C)*(k.y-1)/2+I.top+O;F.push({x:U,y:W})}),x&&(F=F[0]),F}screenOffsetToModel(p,x,w){var C=p/this.WIDTH,S=x/this.HEIGHT,A=w===void 0?this.rotationGroup.position.z:w,P=this.rotationGroup.quaternion,O=new m.Vector3(0,0,A);return this.projector.projectVector(O,this.camera),O.x+=C*2,O.y-=S*2,this.projector.unprojectVector(O,this.camera),O.z=0,O.applyQuaternion(P),O}screenToModelDistance(p,x){let w=this.canvasOffset(),C=new m.Vector3(x.x,x.y,x.z);C.applyMatrix4(this.modelGroup.matrixWorld);let S=C.clone();this.projector.projectVector(C,this.camera);let A=new m.Vector3((p.x-w.left)*2/this.WIDTH-1,(p.y-w.top)*2/-this.HEIGHT+1,C.z);return this.projector.unprojectVector(A,this.camera),A.distanceTo(S)}setViewChangeCallback(p){(typeof p=="function"||p==null)&&(this.viewChangeCallback=p)}setStateChangeCallback(p){(typeof p=="function"||p==null)&&(this.stateChangeCallback=p)}getConfig(){return this.config}setConfig(p){this.config=p,p.ambientOcclusion&&this.renderer.enableAmbientOcclusion(p.ambientOcclusion)}getInternalState(){var p={models:[],surfaces:[],shapes:[],labels:[]};for(let x=0;x<this.models.length;x++)this.models[x]&&(p.models[x]=this.models[x].getInternalState());return p}setInternalState(p){this.clear();var x=p.models;for(let w=0;w<x.length;w++)x[w]&&(this.models[w]=new n.GLModel(w,void 0,this),this.models[w].setInternalState(x[w]));this.render()}setZoomLimits(p,x){typeof p<"u"&&(this.config.lowerZoomLimit=p),x&&(this.config.upperZoomLimit=x),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(p){p.fov!==void 0&&(this.fov=p.fov,this.camera.fov=this.fov),p.z!==void 0&&(this.CAMERA_Z=p.z,this.camera.z=this.CAMERA_Z),p.orthographic!==void 0&&(this.camera.ortho=p.orthographic),this.setSlabAndFog()}_handleMouseDown(p){if(p.preventDefault(),!this.scene)return;var x=this.getX(p),w=this.getY(p);if(x===void 0)return;this.isDragging=!0,this.mouseButton=p.which,this.mouseStartX=x,this.mouseStartY=w,this.touchHold=!0,this.touchDistanceStart=0,p.targetTouches&&p.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(p)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let C=this;p.targetTouches&&p.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(C.touchHold==!0){C.glDOM=C.renderer.domElement;const S=p.targetTouches[0],A=new PointerEvent("contextmenu",Object.assign(Object.assign({},p),{pageX:S.pageX,pageY:S.pageY,screenX:S.screenX,screenY:S.screenY,clientX:S.clientX,clientY:S.clientY}));C.glDOM.dispatchEvent(A)}},this.longTouchDuration))}_handleMouseUp(p){if(this.touchHold=!1,this.isDragging&&this.scene){var x=this.getX(p),w=this.getY(p);if(this.closeEnoughForClick(p)&&this.isInViewer(x,w)){let C=this.mouseXY(x,w);this.handleClickSelection(C.x,C.y,p)}}this.isDragging=!1}_handleMouseScroll(p){if(p.preventDefault(),!!this.scene){var x=this.getX(p),w=this.getY(p);if(x!==void 0&&!(!this.control_all&&!this.isInViewer(x,w))){var C=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,S=1;if(p.ctrlKey&&(S=-1),p.detail)this.rotationGroup.position.z+=S*C*p.detail/10;else if(p.wheelDelta){let A=p.wheelDelta*600/(p.wheelDelta+600);this.rotationGroup.position.z-=S*C*A/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(p){let x=this;return p=p||1,new Promise(function(w){let C=0,S=x.viewChangeCallback,A=[],P=[],O=Date.now();x.viewChangeCallback=function(){P.push(Date.now()-O),O=Date.now(),A.push(new Promise(F=>{x.getCanvas().toBlob(function(I){I.arrayBuffer().then(F)},"image/png")})),C+=1,C==p&&(x.viewChangeCallback=S,Promise.all(A).then(F=>{let I=[];for(let z=0;z<F.length;z++){let V=(0,i.decode)(F[z]);I.push((0,i.toRGBA8)(V)[0])}let B=x.getCanvas().width,k=x.getCanvas().height,U=(0,i.encode)(I,B,k,0,P),W=new Blob([U],{type:"image/png"}),R=new FileReader;R.onload=function(z){w(z.target.result)},R.readAsDataURL(W)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(p){this.hoverDuration=p}mouseXY(p,x){let w=this.canvasOffset(),C=this.renderer.getXRatio(),S=this.renderer.getYRatio(),A=this.col,P=this.row,O=A*(this.WIDTH/C),F=(S-P-1)*(this.HEIGHT/S),I=(p-w.left-O)/(this.WIDTH/C)*2-1,B=-((x-w.top-F)/(this.HEIGHT/S))*2+1;return{x:I,y:B}}_handleMouseMove(p){clearTimeout(this.hoverTimeout),p.preventDefault();let x=this.getX(p),w=this.getY(p);if(x===void 0)return;let C=this.renderer.getXRatio(),S=this.renderer.getYRatio(),A=this.mouseXY(x,w),P=this;this.current_hover!==null&&this.handleHoverContinue(A.x,A.y);var O=0;if(!(!this.control_all&&!this.isInViewer(x,w))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){P.handleHoverSelection(A.x,A.y,p)},this.hoverDuration)),!!this.isDragging)){p.targetTouches&&(p.targetTouches.length>1||p.targetTouches.length===1&&!this.closeEnoughForClick(p))&&clearTimeout(this.longTouchTimeout);var F=(x-this.mouseStartX)/this.WIDTH,I=(w-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&p.targetTouches&&p.targetTouches.length==2){var B=this.calcTouchDistance(p);O=2,I=(B-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else p.targetTouches&&p.targetTouches.length==3&&(O=1);F*=C,I*=S;var k=Math.hypot(F,I),U;if(O==3||this.mouseButton==3&&p.ctrlKey)this.slabNear=this.cslabNear+F*100,this.slabFar=this.cslabFar-I*100;else if(O==2||this.mouseButton==3||p.shiftKey)U=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,U<80&&(U=80),this.rotationGroup.position.z=this.cz+I*U,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(O==1||this.mouseButton==2||p.ctrlKey){var W=this.screenOffsetToModel(C*(x-this.mouseStartX),S*(w-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,W)}else if((O===0||this.mouseButton==1)&&k!==0){var R=Math.sin(k*Math.PI)/k;this.dq.x=Math.cos(k*Math.PI),this.dq.y=0,this.dq.z=R*F,this.dq.w=-R*I,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(p){if(p.preventDefault(),this.closeEnoughForClick(p)){var C=this.mouseStartX,S=this.mouseStartY,w=this.canvasOffset();let A=this.mouseXY(C,S),P=A.x,O=A.y,F=this.targetedObjects(P,O,this.contextMenuEnabledObjects);var x=null;F.length&&(x=F[0].clickable);var w=this.canvasOffset(),C=this.mouseStartX-w.left,S=this.mouseStartY-w.top;this.userContextMenuHandler&&(this.userContextMenuHandler(x,C,S,F,p),this.isDragging=!1)}}setContainer(p){let x=(0,b.getElement)(p)||this.container;return this.initContainer(x),this}setBackgroundColor(p,x){(typeof x>"u"||x<0||x>1)&&(x=1);var w=_.CC.color(p);return this.scene.fog.color=w,this.bgColor=w.getHex(),this.renderer.setClearColorHex(w.getHex(),x),this.show(),this}setProjection(p){this.camera.ortho=p==="orthographic",this.setSlabAndFog()}setViewStyle(p){if(p=p||{},p.style=p.style||"",p.style.includes("outline")?this.renderer.enableOutline(p):this.renderer.disableOutline(),p.style.includes("ambientOcclusion")){var x={};p.strength&&(x.strength=p.strength),p.radius&&(x.radius=p.radius),this.renderer.enableAmbientOcclusion(x)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(p){return this.WIDTH=p||this.WIDTH,this.updateSize(),this}setHeight(p){return this.HEIGHT=p||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let p=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let x=!1,w=this.container.querySelector("canvas");w&&w!=this.renderer.getCanvas()?this.config.canvas=w:(w.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,x=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),p=!0,x&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),p){let x=this.renderer.supportedExtensions();if(x.regen=!0,this.viewers)for(let w=0,C=this.viewers.length;w<C;w++)for(let S=0,A=this.viewers[w].length;S<A;S++)this.viewers[w][S].render(null,x);this._viewer.render(null,x)}else this.show();return this}getModel(p){return p===void 0?this.models.length==0?null:this.models[this.models.length-1]:p instanceof n.GLModel?p:p in this.models?this.models[p]:this.models.length==0?null:this.models[this.models.length-1]}spin(p,x=1,w=!1){if(clearInterval(this.spinInterval),typeof p>"u"&&(p="y"),typeof p=="boolean")if(p)p="y";else return;Array.isArray(p)&&(p={x:p[0],y:p[1],z:p[2]});var C=this;this.spinInterval=setInterval(function(){!C.getCanvas().isConnected&&C.renderer.isLost()&&clearInterval(C.spinInterval),(!w||C.container.checkVisibility&&C.container.checkVisibility())&&C.rotate(1*x,p)},25)}animateMotion(p,x,w,C,S,A){var P=20,O=Math.ceil(p/P);O<1&&(O=1),this.incAnim();var F={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(x){let k=new Array(O);for(let z=0;z<O;z++){let V=(z+1)/O,q={mpos:F.mpos,rz:F.rz,rot:F.rot};q.mpos=w.clone().sub(F.mpos).multiplyScalar(V).add(F.mpos),q.rz=F.rz+V*(C-F.rz),q.rot=f.slerp(F.rot,S,V),q.cam=A.clone().sub(F.cam).multiplyScalar(V).add(F.cam),k[z]=q}let U=0,W=this,R=function(){var z=k[U];U+=1,W.modelGroup.position=z.mpos,W.rotationGroup.position.z=z.rz,W.rotationGroup.quaternion=z.rot,W.camera.lookAt(z.cam),U<k.length?setTimeout(R,P):W.decAnim(),W.show()};setTimeout(R,P)}else{var I={};let k=1/O;if(w&&(I.mpos=w.clone().sub(F.mpos).multiplyScalar(k)),typeof C<"u"&&C!=null&&(I.rz=k*(C-F.rz)),S){var B=f.slerp(F.rot,S,k);I.rot=F.rot.clone().inverse().multiply(B)}A&&(I.cam=A.clone().sub(F.cam).multiplyScalar(k));let U=0,W=this,R=function(){U+=1,I.mpos&&W.modelGroup.position.add(I.mpos),I.rz&&(W.rotationGroup.position.z+=I.rz),I.rot&&W.rotationGroup.quaternion.multiply(I.rot),I.cam&&(W.lookingAt.add(I.cam),W.camera.lookAt(W.lookingAt)),U<O?setTimeout(R,P):W.decAnim(),W.show()};setTimeout(R,P)}}rotate(p,x="y",w=0,C=!1){if(x=="x"?x={x:1,y:0,z:0}:x=="y"?x={x:0,y:1,z:0}:x=="z"&&(x={x:0,y:0,z:1}),x=="vx"?x={vx:1,vy:0,vz:0}:x=="vy"?x={vx:0,vy:1,vz:0}:x=="vz"&&(x={vx:0,vy:0,vz:1}),typeof x.vx<"u"){var S=new m.Vector3(x.vx,x.vy,x.vz);S.applyQuaternion(this.rotationGroup.quaternion),x={x:S.x,y:S.y,z:S.z}}var A=function(I){var B=Math.sin(I/2),k=Math.cos(I/2),U=0,W=0,R=0;return U=x.x*B,W=x.y*B,R=x.z*B,new m.Quaternion(U,W,R,k).normalize()},P=Math.PI*p/180,O=A(P);if(w){var F=new m.Quaternion().copy(this.rotationGroup.quaternion).multiply(O);this.animateMotion(w,C,this.modelGroup.position,this.rotationGroup.position.z,F,this.lookingAt)}else this.rotationGroup.quaternion.multiply(O),this.show();return this}surfacesFinished(){for(var p in this.surfaces)if(!this.surfaces[p][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var p=this.modelGroup.position,x=this.rotationGroup.quaternion;return[p.x,p.y,p.z,this.rotationGroup.position.z,x.x,x.y,x.z,x.w]}setView(p,x){return p===void 0||!(p instanceof Array||p.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=p[0],this.modelGroup.position.y=p[1],this.modelGroup.position.z=p[2],this.rotationGroup.position.z=p[3],this.rotationGroup.quaternion.x=p[4],this.rotationGroup.quaternion.y=p[5],this.rotationGroup.quaternion.z=p[6],this.rotationGroup.quaternion.w=p[7],typeof p[8]<"u"&&(this.rotationGroup.position.x=p[8],this.rotationGroup.position.y=p[9]),this.show(x),this)}render(p,x){this.renderer.setViewport(),this.updateClickables();var w=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var C,S;for(x||(x=this.renderer.supportedExtensions()),C=0;C<this.models.length;C++)this.models[C]&&this.models[C].globj(this.modelGroup,x);for(C=0;C<this.shapes.length;C++)this.shapes[C]&&(typeof this.shapes[C].frame>"u"||this.viewer_frame<0||this.shapes[C].frame<0||this.shapes[C].frame==this.viewer_frame?this.shapes[C].globj(this.modelGroup,x):this.shapes[C].removegl(this.modelGroup));for(C=0;C<this.labels.length;C++)x.regen&&(this.labels[C].dispose(),this.modelGroup.remove(this.labels[C].sprite),this.labels[C].setContext(),this.modelGroup.add(this.labels[C].sprite)),this.labels[C]&&typeof this.labels[C].frame<"u"&&this.labels[C].frame>=0&&(this.modelGroup.remove(this.labels[C].sprite),(this.viewer_frame<0||this.labels[C].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[C].sprite));for(C in this.surfaces)if(this.surfaces.hasOwnProperty(C)){var A=this.surfaces[C];for(S=0;S<A.length;S++)if(A.hasOwnProperty(S)){var P=A[S].geo;if(!A[S].finished||x.regen){P.verticesNeedUpdate=!0,P.elementsNeedUpdate=!0,P.normalsNeedUpdate=!0,P.colorsNeedUpdate=!0,P.buffersNeedUpdate=!0,A[S].mat.needsUpdate=!0,A[S].done&&(A[S].finished=!0),A[S].lastGL&&this.modelGroup.remove(A[S].lastGL);var O=null;if(A[S].mat instanceof g.LineBasicMaterial?O=new g.Line(P,A[S].mat):("wireframe"in A.style&&A.style.wireframe&&P.setUpWireframe(),O=new g.Mesh(P,A[S].mat)),A[S].mat.transparent&&A[S].mat.opacity==0?O.visible=!1:O.visible=!0,A[S].symmetries.length>1||A[S].symmetries.length==1&&!A[S].symmetries[0].isIdentity()){var F,I=new g.Object3D;for(F=0;F<A[S].symmetries.length;F++){var B=O.clone();B.matrix=A[S].symmetries[F],B.matrixAutoUpdate=!1,I.add(B)}A[S].lastGL=I,this.modelGroup.add(I)}else A[S].lastGL=O,this.modelGroup.add(O)}}}return this.setView(w),typeof p=="function"&&p(this),this}getModelList(p){let x=[];if(typeof p>"u"||typeof p.model>"u")for(let C=0;C<this.models.length;C++)this.models[C]&&x.push(this.models[C]);else{let C=p.model;Array.isArray(C)||(C=[C]);for(let S=0;S<C.length;S++)if(typeof C[S]=="number"){var w=C[S];w<0&&(w+=this.models.length),x.push(this.models[w])}else x.push(C[S])}return x}getAtomsFromSel(p){var x=[];typeof p>"u"&&(p={});var w=this.getModelList(p);for(let C=0;C<w.length;C++)x=x.concat(w[C].selectedAtoms(p));return x}atomIsSelected(p,x){typeof x>"u"&&(x={});for(var w=this.getModelList(x),C=0;C<w.length;C++)if(w[C].atomIsSelected(p,x))return!0;return!1}selectedAtoms(p){return this.getAtomsFromSel(p)}getUniqueValues(p,x){typeof x>"u"&&(x={});var w=this.getAtomsFromSel(x),C={};for(var S in w)if(w[S].hasOwnProperty(p)){var A=w[S][p];C[A]=!0}return Object.keys(C)}pdbData(p){for(var x=this.getAtomsFromSel(p),w="",C=0,S=x.length;C<S;++C)w+=x[C].pdbline+`
`;return w}zoom(p=2,x=0,w=!1){var C=(this.CAMERA_Z-this.rotationGroup.position.z)/p,S=this.CAMERA_Z-C;return x>0?this.animateMotion(x,w,this.modelGroup.position,this.adjustZoomToLimits(S),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(S),this.show()),this}translate(p,x,w=0,C=!1){var S=p/this.WIDTH,A=x/this.HEIGHT,P=new m.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(P,this.camera),P.x-=S,P.y-=A,this.projector.unprojectVector(P,this.camera),P.z=0;var O=this.lookingAt.clone().add(P);return w>0?this.animateMotion(w,C,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,O):(this.lookingAt=O,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(p,x,w=0,C=!1){var S=this.screenOffsetToModel(p,x),A=this.modelGroup.position.clone().add(S);return w>0?this.animateMotion(w,C,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=A,this.show()),this}fitSlab(p){p=p||{};var x=this.getAtomsFromSel(p),w=(0,b.getExtent)(x),C=w[1][0]-w[0][0],S=w[1][1]-w[0][1],A=w[1][2]-w[0][2],P=Math.hypot(C,S,A);return P<5&&(P=5),this.slabNear=-P/1.9,this.slabFar=P/2,this}center(p={},x=0,w=!1){var C,S,A=this.getAtomsFromSel(p),P=(0,b.getExtent)(A);(0,b.isEmptyObject)(p)?(this.shapes.forEach(V=>{if(V&&V.boundingSphere&&V.boundingSphere.center){var q=V.boundingSphere.center,Q=V.boundingSphere.radius;Q>0?(A.push(new m.Vector3(q.x+Q,q.y,q.z)),A.push(new m.Vector3(q.x-Q,q.y,q.z)),A.push(new m.Vector3(q.x,q.y+Q,q.z)),A.push(new m.Vector3(q.x,q.y-Q,q.z)),A.push(new m.Vector3(q.x,q.y,q.z+Q)),A.push(new m.Vector3(q.x,q.y,q.z-Q))):A.push(q)}}),P=(0,b.getExtent)(A),C=A,S=P):(C=this.getAtomsFromSel({}),S=(0,b.getExtent)(C));var O=new m.Vector3(P[2][0],P[2][1],P[2][2]),F=S[1][0]-S[0][0],I=S[1][1]-S[0][1],B=S[1][2]-S[0][2],k=Math.hypot(F,I,B);k<5&&(k=5),this.slabNear=-k/1.9,this.slabFar=k/2,F=P[1][0]-P[0][0],I=P[1][1]-P[0][1],B=P[1][2]-P[0][2],k=Math.hypot(F,I,B),k<5&&(k=5);for(var U=25,W=0;W<A.length;W++)if(A[W]){var R=O.distanceToSquared(A[W]);R>U&&(U=R)}k=Math.sqrt(U)*2;var z=O.clone().multiplyScalar(-1);return x>0?this.animateMotion(x,w,z,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=z,this.show()),this}zoomTo(p={},x=0,w=!1){let C=this.getAtomsFromSel(p),S=(0,b.getExtent)(C),A=S;if((0,b.isEmptyObject)(p)){let q=C&&C.length;if(this.shapes.forEach(Q=>{if(Q&&Q.boundingSphere){if(Q.boundingSphere.box){let ae=Q.boundingSphere.box;C.push(new m.Vector3(ae.min.x,ae.min.y,ae.min.z)),C.push(new m.Vector3(ae.max.x,ae.max.y,ae.max.z))}else if(Q.boundingSphere.center){var re=Q.boundingSphere.center,te=Q.boundingSphere.radius;te>0?(C.push(new m.Vector3(re.x+te,re.y,re.z)),C.push(new m.Vector3(re.x-te,re.y,re.z)),C.push(new m.Vector3(re.x,re.y+te,re.z)),C.push(new m.Vector3(re.x,re.y-te,re.z)),C.push(new m.Vector3(re.x,re.y,re.z+te)),C.push(new m.Vector3(re.x,re.y,re.z-te))):C.push(re)}}}),A=(0,b.getExtent)(C),!q)for(let Q=0;Q<3;Q++)S[2][Q]=(A[0][Q]+A[1][Q])/2}else{let q=this.getAtomsFromSel({});A=(0,b.getExtent)(q)}var P=new m.Vector3(S[2][0],S[2][1],S[2][2]),O=A[1][0]-A[0][0],F=A[1][1]-A[0][1],I=A[1][2]-A[0][2],B=Math.hypot(O,F,I);B<5&&(B=5),this.slabNear=-B/1.9,this.slabFar=B/2,Object.keys(p).length===0&&(this.slabNear=Math.min(-B*2,-50),this.slabFar=Math.max(B*2,50));var k=this.config.minimumZoomToDistance||5;O=S[1][0]-S[0][0],F=S[1][1]-S[0][1],I=S[1][2]-S[0][2],B=Math.hypot(O,F,I),B<k&&(B=k);for(var U=k*k,W=0;W<C.length;W++)if(C[W]){var R=P.distanceToSquared(C[W]);R>U&&(U=R)}B=Math.sqrt(U)*2;var z=P.clone().multiplyScalar(-1),V=-(B*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return V=this.adjustZoomToLimits(V),x>0?this.animateMotion(x,w,z,V,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=z,this.rotationGroup.position.z=V,this.show()),this}setSlab(p,x){this.slabNear=p,this.slabFar=x}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(p,x={},w,C=!1){if(w){var S=(0,b.getExtent)(this.getAtomsFromSel(w));x.position={x:S[2][0],y:S[2][1],z:S[2][2]}}var A=new a.Label(p,x);return A.setContext(),this.modelGroup.add(A.sprite),this.labels.push(A),C||this.show(),A}addResLabels(p,x,w=!1){let C=this.labels.length;return this.applyToModels("addResLabels",p,x,w),this.show(),this.labels.slice(C)}addPropertyLabels(p,x,w){return this.applyToModels("addPropertyLabels",p,x,w),this.show(),this}removeLabel(p){for(var x=0;x<this.labels.length;x++)if(this.labels[x]==p){this.labels.splice(x,1),p.dispose(),this.modelGroup.remove(p.sprite);break}return this.show(),this}removeAllLabels(){for(var p=0;p<this.labels.length;p++)this.labels[p]&&this.labels[p].sprite&&this.modelGroup.remove(this.labels[p].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var p=0;p<this.labels.length;p++)this.labels[p]&&this.labels[p].hide();return this.show(),this}showAllLabels(){for(var p=0;p<this.labels.length;p++)this.labels[p]&&this.labels[p].show();return this.show(),this}setLabelStyle(p,x){return this.modelGroup.remove(p.sprite),p.dispose(),p.stylespec=x,p.setContext(),this.modelGroup.add(p.sprite),this.show(),p}setLabelText(p,x){return this.modelGroup.remove(p.sprite),p.dispose(),p.text=x,p.setContext(),this.modelGroup.add(p.sprite),this.show(),p}addShape(p){p=p||{};var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,this.shapes.push(x),x}removeShape(p){if(!p)return this;for(p.removegl(this.modelGroup),delete this.shapes[p.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var p=0;p<this.shapes.length;p++){var x=this.shapes[p];x&&x.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(p){if(p.hasOwnProperty("x")&&p.hasOwnProperty("y")&&p.hasOwnProperty("z"))return p;var x=this.getAtomsFromSel(p);if(x.length==0)return{x:0,y:0,z:0};var w=(0,b.getExtent)(x);return{x:w[0][0]+(w[1][0]-w[0][0])/2,y:w[0][1]+(w[1][1]-w[0][1])/2,z:w[0][2]+(w[1][2]-w[0][2])/2}}addSphere(p){p=p||{},p.center=this.getSelectionCenter(p.center);var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,x.addSphere(p),this.shapes.push(x),x.finalize(),x}addBox(p={}){p.corner!=null&&(p.corner=this.getSelectionCenter(p.corner)),p.center!=null&&(p.center=this.getSelectionCenter(p.center));var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,x.addBox(p),this.shapes.push(x),x.finalize(),x}addArrow(p={}){p.start=this.getSelectionCenter(p.start),p.end=this.getSelectionCenter(p.end);var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,x.addArrow(p),this.shapes.push(x),x.finalize(),x}addCylinder(p={}){p.start=this.getSelectionCenter(p.start),p.end=this.getSelectionCenter(p.end);var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,p.dashed?x.addDashedCylinder(p):x.addCylinder(p),this.shapes.push(x),x.finalize(),x}addCurve(p={}){var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,x.addCurve(p),this.shapes.push(x),x.finalize(),x}addLine(p={}){p.start=this.getSelectionCenter(p.start),p.end=this.getSelectionCenter(p.end),p.wireframe=!0;var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,p.dashed?x=this.addLineDashed(p,x):x.addLine(p),this.shapes.push(x),x.finalize(),x}addUnitCell(p,x){p=this.getModel(p),x=x||{alabel:"a",blabel:"b",clabel:"c"},x.box=x.box||{},x.astyle=x.astyle||{color:"red",radius:.1,midpos:-1},x.bstyle=x.bstyle||{color:"green",radius:.1,midpos:-1},x.cstyle=x.cstyle||{color:"blue",radius:.1,midpos:-1},x.alabelstyle=x.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},x.blabelstyle=x.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},x.clabelstyle=x.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},p.unitCellObjects&&this.removeUnitCell(p),p.unitCellObjects={shapes:[],labels:[]};var w=p.getCrystData(),C=null;if(w){if(w.matrix)C=w.matrix;else{var S=w.a,A=w.b,P=w.c,O=w.alpha,F=w.beta,I=w.gamma;O=O*Math.PI/180,F=F*Math.PI/180,I=I*Math.PI/180;var B,k,U;B=Math.cos(F),k=(Math.cos(O)-Math.cos(F)*Math.cos(I))/Math.sin(I),U=Math.sqrt(Math.max(0,1-B*B-k*k)),C=new m.Matrix3(S,A*Math.cos(I),P*B,0,A*Math.sin(I),P*k,0,0,P*U)}var W=[new m.Vector3(0,0,0),new m.Vector3(1,0,0),new m.Vector3(0,1,0),new m.Vector3(0,0,1),new m.Vector3(1,1,0),new m.Vector3(0,1,1),new m.Vector3(1,0,1),new m.Vector3(1,1,1)];if(w.matrix4)for(let z=0;z<W.length;z++)w.size&&W[z].multiplyVectors(W[z],w.size),W[z]=W[z].applyMatrix4(w.matrix4);else for(let z=0;z<W.length;z++)W[z]=W[z].applyMatrix3(C);if(x.box&&!x.box.hidden){x.box.wireframe=!0;var R=new s.GLShape(x.box);R.shapePosition=this.shapes.length,R.addLine({start:W[0],end:W[1]}),R.addLine({start:W[0],end:W[2]}),R.addLine({start:W[1],end:W[4]}),R.addLine({start:W[2],end:W[4]}),R.addLine({start:W[0],end:W[3]}),R.addLine({start:W[3],end:W[5]}),R.addLine({start:W[2],end:W[5]}),R.addLine({start:W[1],end:W[6]}),R.addLine({start:W[4],end:W[7]}),R.addLine({start:W[6],end:W[7]}),R.addLine({start:W[3],end:W[6]}),R.addLine({start:W[5],end:W[7]}),this.shapes.push(R),p.unitCellObjects.shapes.push(R),R.finalize()}if(!x.astyle.hidden){x.astyle.start=W[0],x.astyle.end=W[1];let z=this.addArrow(x.astyle);p.unitCellObjects.shapes.push(z)}if(!x.bstyle.hidden){x.bstyle.start=W[0],x.bstyle.end=W[2];let z=this.addArrow(x.bstyle);p.unitCellObjects.shapes.push(z)}if(!x.cstyle.hidden){x.cstyle.start=W[0],x.cstyle.end=W[3];let z=this.addArrow(x.cstyle);p.unitCellObjects.shapes.push(z)}if(x.alabel){x.alabelstyle.position=W[1];let z=this.addLabel(x.alabel,x.alabelstyle);p.unitCellObjects.labels.push(z)}if(x.blabel){x.blabelstyle.position=W[2];let z=this.addLabel(x.blabel,x.blabelstyle);p.unitCellObjects.labels.push(z)}if(x.clabel){x.clabelstyle.position=W[3];let z=this.addLabel(x.clabel,x.clabelstyle);p.unitCellObjects.labels.push(z)}}}removeUnitCell(p){if(p=this.getModel(p),p.unitCellObjects){let x=this;p.unitCellObjects.shapes.forEach(function(w){x.removeShape(w)}),p.unitCellObjects.labels.forEach(function(w){x.removeLabel(w)})}delete p.unitCellObjects}replicateUnitCell(p=3,x=p,w=x,C,S,A){C=this.getModel(C);let P=C.getCrystData();if(P){const O=C.selectedAtoms({}),F=P.matrix;let I=function(k){return k%2==0?-k/2:Math.ceil(k/2)};p<=1&&x<=1&&w<=1&&(A=!0,p=x=w=3);let B=function(k,U,W){return!1};if(A){const k=new m.Matrix3().getInverse3(F);B=function(U,W,R){let z=new m.Vector3(U,W,R).applyMatrix3(k);return!(z.x>-1e-4&&z.x<1.0001&&z.y>-1e-4&&z.y<1.0001&&z.z>-1e-4&&z.z<1.0001)}}for(let k=0;k<p;k++)for(let U=0;U<x;U++)for(let W=0;W<w;W++){if(k==0&&U==0&&W==0)continue;let R=new m.Vector3(I(k),I(U),I(W));R.applyMatrix3(F);let z=[];for(let V=0;V<O.length;V++){let q=O[V].x+R.x,Q=O[V].y+R.y,re=O[V].z+R.z;if(B(q,Q,re))continue;let te={};for(let ae in O[V])te[ae]=O[V][ae];te.x=q,te.y=Q,te.z=re,z.push(te)}C.addAtoms(z)}S&&C.assignBonds()}}addLineDashed(p,x){p.dashLength=p.dashLength||.5,p.gapLength=p.gapLength||.5;var w;p.start?w=new m.Vector3(p.start.x||0,p.start.y||0,p.start.z||0):w=new m.Vector3(0,0,0);var C;p.end?C=new m.Vector3(p.end.x,p.end.y||0,p.end.z||0):C=new m.Vector3(0,0,0);var S=new m.Vector3,A=new m.Vector3,P=new m.Vector3,O,F,I,B=w.clone(),k=0;for(S.subVectors(C,w),O=S.length(),S.normalize(),A=S.clone(),P=S.clone(),A.multiplyScalar(p.dashLength),P.multiplyScalar(p.gapLength),F=A.length(),I=P.length();k<O;){if(k+F>O){p.start=w,p.end=C,x.addLine(p);break}B.addVectors(w,A),p.start=w,p.end=B,x.addLine(p),w=B.clone(),k+=F,B.addVectors(w,P),w=B.clone(),k+=I}return x.finalize(),x}addCustom(p){p=p||{};var x=new s.GLShape(p);return x.shapePosition=this.shapes.length,x.addCustom(p),this.shapes.push(x),x.finalize(),x}addVolumetricData(p,x,w={}){var C=new h.VolumeData(p,x);return w.hasOwnProperty("transferfn")?this.addVolumetricRender(C,w):this.addIsosurface(C,w)}addIsosurface(p,x={},w){var C=new s.GLShape(x);return C.shapePosition=this.shapes.length,C.addIsosurface(p,x,w,this),this.shapes.push(C),C}addVolumetricRender(p,x){x=x||{};var w=new u.GLVolumetricRender(p,x,this);return w.shapePosition=this.shapes.length,this.shapes.push(w),w}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(p){if(p){this.scene.fog=new g.Fog(this.bgColor,100,200),this.config.disableFog=!1;const x=p;x.fogStart==null?this.fogStart=.4:this.fogStart=x.fogStart,x.fogEnd==null?this.fogEnd=1:this.fogEnd=x.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(p){this.viewer_frame=p;let x=this;return new Promise(function(w){var C=x.models.map(function(S){return S.setFrame(p)});Promise.all(C).then(function(){w()})})}getFrame(){return this.viewer_frame}getNumFrames(){var p=0;for(let x=0;x<this.models.length;x++)this.models[x].getNumFrames()>p&&(p=this.models[x].getNumFrames());for(let x=0;x<this.shapes.length;x++)this.shapes[x].frame&&this.shapes[x].frame>=p&&(p=this.shapes[x].frame+1);for(let x=0;x<this.labels.length;x++)this.labels[x].frame&&this.labels[x].frame>=p&&(p=this.labels[x].frame+1);return p}getNextModelId(){return this.models.length}animate(p){this.incAnim();var x=100,w="forward",C=1/0;p=p||{},p.interval&&(x=p.interval),p.loop&&(w=p.loop),p.reps&&(C=p.reps);var S=this.getNumFrames(),A=this,P=0;p.startFrame&&(P=p.startFrame%S);var O=1;p.step&&(O=p.step,C/=O);var F=0,I=S*C,B=new Date,k,U,W=function(R){B=new Date,R=="forward"?A.setFrame(P).then(function(){P=(P+O)%S,k()}):R=="backward"?A.setFrame(S-1-P).then(function(){P=(P+O)%S,k()}):A.setFrame(P).then(function(){P+=O,O*=P%(S-1)==0?-1:1,k()})};return k=function(){if(A.render(),!A.getCanvas().isConnected)A.stopAnimate();else if(++F>=I||!A.isAnimated())U.cancel(),A.animationTimers.delete(U),A.decAnim();else{var R=x-(new Date().getTime()-B.getTime());R=R>0?R:0,A.animationTimers.delete(U),U=new b.PausableTimer(W,R,w),A.animationTimers.add(U)}},U=new b.PausableTimer(W,0,w),this.animationTimers.add(U),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(p){p.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(p){p.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(p){p.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(p){return p&&!p.defaultcolors?(p.defaultcolors=this.defaultcolors,p.cartoonQuality=p.cartoonQuality||this.config.cartoonQuality):typeof p>"u"&&(p={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),p}addModel(p,x="",w){w=this.getModelOpt(w);var C=new n.GLModel(this.models.length,w,this);return C.addMolData(p,x,w),this.models.push(C),C}addModels(p,x,w){w=this.getModelOpt(w),w.multimodel=!0,w.frames=!0;for(var C=n.GLModel.parseMolData(p,x,w),S=0;S<C.length;S++){var A=new n.GLModel(this.models.length,w,this);A.setAtomDefaults(C[S]),A.addFrame(C[S]),A.setFrame(0),C.modelData&&A.setModelData(C.modelData[S]),A.setDontDuplicateAtoms(!w.duplicateAssemblyAtoms),this.models.push(A)}return this.models}addModelsAsFrames(p,x,w){w=this.getModelOpt(w),w.multimodel=!0,w.frames=!0;var C=new n.GLModel(this.models.length,w,this);return C.addMolData(p,x,w),this.models.push(C),C}addAsOneMolecule(p,x,w){w=this.getModelOpt(w),w.multimodel=!0,w.onemol=!0;var C=new n.GLModel(this.models.length,w,this);return C.addMolData(p,x,w),this.models.push(C),C}removeModel(p){if(p=this.getModel(p),!!p){for(p.removegl(this.modelGroup),delete this.models[p.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var p=0;p<this.models.length;p++){var x=this.models[p];x&&x.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(p,x){var w={};return x===void 0?w.m=this.models.map(function(C){return C.toCDObject(p)}):w.m=[this.models[x].toCDObject()],JSON.stringify(w)}exportVRML(){var p=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new g.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var x=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=p,x}createModelFrom(p,x=!1){for(var w=new n.GLModel(this.models.length,this.defaultcolors,this),C=0;C<this.models.length;C++)if(this.models[C]){var S=this.models[C].selectedAtoms(p);w.addAtoms(S),x&&this.models[C].removeAtoms(S)}return this.models.push(w),w}applyToModels(p,x,w,C,S,A,P){for(var O=this.getModelList(x),F=0;F<O.length;F++)O[F][p](x,w,C,S,A,P)}setStyle(p,x){return typeof x>"u"&&(x=p,p={}),this.applyToModels("setStyle",p,x,!1),this}addStyle(p,x){return typeof x>"u"&&(x=p,p={}),this.applyToModels("setStyle",p,x,!0),this}setClickable(p,x,w){return this.applyToModels("setClickable",p,x,w),this}setHoverable(p,x,w,C){return this.applyToModels("setHoverable",p,x,w,C),this}enableContextMenu(p,x){return this.applyToModels("enableContextMenu",p,x),this}vibrate(p,x,w,C){return this.applyToModels("vibrate",p,x,w,C),this}setColorByProperty(p,x,w,C){return this.applyToModels("setColorByProperty",p,x,w,C),this}setColorByElement(p,x){return this.applyToModels("setColorByElement",p,x),this}static getAtomsWithin(p,x){var w=[];for(let S=0;S<p.length;S++){var C=p[S];typeof C>"u"||C.x<x[0][0]||C.x>x[1][0]||C.y<x[0][1]||C.y>x[1][1]||C.z<x[0][2]||C.z>x[1][2]||w.push(C)}return w}static volume(p){var x=p[1][0]-p[0][0],w=p[1][1]-p[0][1],C=p[1][2]-p[0][2];return x*w*C}carveUpExtent(p,x,w){let C=[],S={};for(let B=0,k=x.length;B<k;B++)S[x[B].index]=B;let A=function(B){let k=[];for(let U=0,W=B.length;U<W;U++)B[U].index in S&&k.push(S[B[U].index]);return k},P=function(B){let k=[];return k[0]=[B[0][0],B[0][1],B[0][2]],k[1]=[B[1][0],B[1][1],B[1][2]],k},O=function(B){if(f.volume(B)<f.maxVolume)return[B];var k=B[1][0]-B[0][0],U=B[1][1]-B[0][1],W=B[1][2]-B[0][2],R;k>U&&k>W?R=0:U>k&&U>W?R=1:R=2;var z=P(B),V=P(B),q=(B[1][R]-B[0][R])/2+B[0][R];z[1][R]=q,V[0][R]=q;var Q=O(z),re=O(V);return Q.concat(re)},F=O(p),I=6;for(let B=0,k=F.length;B<k;B++){let U=P(F[B]);U[0][0]-=I,U[0][1]-=I,U[0][2]-=I,U[1][0]+=I,U[1][1]+=I,U[1][2]+=I;let W=f.getAtomsWithin(x,U),R=f.getAtomsWithin(w,F[B]);C.push({extent:F[B],atoms:A(W),toshow:A(R)})}return C}static generateSurfaceMesh(p,x,w){var C=new g.Geometry(!0),S=C.updateGeoGroup(0),A=[];for(let Z=0,be=p.length;Z<be;Z++){var P=p[Z];P&&(typeof P.surfaceColor<"u"?A[Z]=P.surfaceColor:P.color&&(A[Z]=_.CC.color(P.color)))}var O=S.vertexArray,F=x.vertices;for(let Z=0,be=F.length;Z<be;Z++){let Ce=S.vertices*3;O[Ce]=F[Z].x,O[Ce+1]=F[Z].y,O[Ce+2]=F[Z].z,S.vertices++}var I=S.colorArray;let B=S.atomArray;if(w.voldata&&w.volscheme){var k=w.volscheme,U=w.voldata,W=k.range()||[-1,1];for(let Z=0,be=F.length;Z<be;Z++){let Ce=F[Z].atomid,ie=U.getVal(F[Z].x,F[Z].y,F[Z].z),Ne=_.CC.color(k.valueToHex(ie,W)),Ve=Z*3;I[Ve]=Ne.r,I[Ve+1]=Ne.g,I[Ve+2]=Ne.b,B[Z]=p[Ce]}}else if(A.length>0)for(let Z=0,be=F.length;Z<be;Z++){let Ce=F[Z].atomid,ie=Z*3;I[ie]=A[Ce].r,I[ie+1]=A[Ce].g,I[ie+2]=A[Ce].b,B[Z]=p[Ce]}var R=x.faces;S.faceidx=R.length,C.initTypedArrays();var z=S.vertexArray,V=S.normalArray,q,Q,re,te;for(let Z=0,be=R.length;Z<be;Z+=3){var ae=R[Z],ne=R[Z+1],le=R[Z+2],Ee=ae*3,De=ne*3,Pe=le*3;q=new m.Vector3(z[Ee],z[Ee+1],z[Ee+2]),Q=new m.Vector3(z[De],z[De+1],z[De+2]),re=new m.Vector3(z[Pe],z[Pe+1],z[Pe+2]),re.subVectors(re,Q),q.subVectors(q,Q),re.cross(q),te=re,te.normalize(),V[Ee]+=te.x,V[De]+=te.x,V[Pe]+=te.x,V[Ee+1]+=te.y,V[De+1]+=te.y,V[Pe+1]+=te.y,V[Ee+2]+=te.z,V[De+2]+=te.z,V[Pe+2]+=te.z}S.faceArray=new Uint16Array(R);var pe=new g.Mesh(C,w);return pe}static generateMeshSyncHelper(p,x,w,C,S,A){var P=new l.ProteinSurface;return P.initparm(x,p!==1,A),P.fillvoxels(S,w),P.buildboundary(),(p==l.SurfaceType.SES||p==l.SurfaceType.MS)&&(P.fastdistancemap(),P.boundingatom(!1),P.fillvoxelswaals(S,w)),P.marchingcube(p),P.getFacesAndVertices(C)}static getMatWithStyle(p){let x=null;p.onesided?x=new g.MeshLambertMaterial:x=new g.MeshDoubleLambertMaterial,x.vertexColors=g.Coloring.VertexColors;for(var w in p)w==="color"||w==="map"||p.hasOwnProperty(w)&&(x[w]=p[w]);return p.opacity!==void 0&&(p.opacity===1?x.transparent=!1:x.transparent=!0),p.wireframe!==void 0&&(x.wireframe=p.wireframe),x}addMesh(p){let x={geo:p.geometry,mat:p.material,done:!0,finished:!1};var w=this.nextSurfID();return this.surfaces[w]=new c([x]),w}static shallowCopy(p){var x=[];let w=p.length;for(let C=0;C<w;C++)x[C]=(0,b.extend)({},p[C]);return x}addSurface(p,x={},w={},C,S,A){let P=this.nextSurfID(),O=null,F=this,I=l.SurfaceType.VDW;typeof p=="string"?f.surfaceTypeMap[p.toUpperCase()]!==void 0?I=f.surfaceTypeMap[p]:console.log("Surface type : "+p+" is not recognized"):typeof p=="number"&&(I=p);var B=null,k=null,U=f.shallowCopy(this.getAtomsFromSel(w));C?B=f.shallowCopy(this.getAtomsFromSel(C)):B=U,(0,b.adjustVolumeStyle)(x);var W=!1,R;for(R=0;R<this.models.length;R++)if(this.models[R]){var z=this.models[R].getSymmetries();if(z.length>1||z.length==1&&!z[0].isIdentity()){W=!0;break}}var V=function(le,Ee,De){S?k=f.shallowCopy(F.getAtomsFromSel(S)):k=De;var Pe,pe=(0,b.getExtent)(De,!0);if(x.map&&x.map.prop){var Z=x.map.prop;let We=(0,o.getGradient)(x.map.scheme||x.map.gradient||new o.Gradient.RWB),He=We.range();He||(He=(0,b.getPropertyRange)(De,Z)),x.colorscheme={prop:Z,gradient:We}}for(let We=0,He=Ee.length;We<He;We++)Pe=Ee[We],Pe.surfaceColor=(0,b.getColorFromStyle)(Pe,x);var be=f.volume(pe),Ce=F.carveUpExtent(pe,Ee,De);if(k&&k.length&&k.length>0){var ie=(0,b.getExtent)(k,!0),Ne=function(We,He){var H=function(_e,ue){var ye=_e.extent,Ae=ye[1][0]-ye[0][0],G=ye[1][1]-ye[0][1],ce=ye[1][2]-ye[0][2],ve=Ae-ue[2][0];ve*=ve;var Oe=G-ue[2][1];Oe*=Oe;var oe=ce-ue[2][2];return oe*=oe,ve+Oe+oe},K=H(We,ie),X=H(He,ie);return K-X};Ce.sort(Ne)}var Ve=[];for(let We=0,He=Ee.length;We<He;We++)Pe=Ee[We],Ve[We]={x:Pe.x,y:Pe.y,z:Pe.z,serial:We,elem:Pe.elem};var Ue=!!l.syncSurface;if((typeof $3Dmol>"u"||typeof $3Dmol.SurfaceWorker>"u")&&(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Ue=!0),Ue){var Fe=function(He){return new Promise(function(H){for(var K=f.generateMeshSyncHelper(I,Ce[He].extent,Ce[He].atoms,Ce[He].toshow,Ve,be),X=(0,s.splitMesh)({vertexArr:K.vertices,faceArr:K.faces}),_e=0,ue=X.length;_e<ue;_e++){K={vertices:X[_e].vertexArr,faces:X[_e].faceArr};var ye=f.generateSurfaceMesh(Ee,K,O);(0,b.mergeGeos)(le.geo,ye)}F.render(),H()})},ze=[];for(let We=0;We<Ce.length;We++)ze.push(Fe(We));return Promise.all(ze).then(function(){return le.done=!0,F.render(),Promise.resolve(P)})}else{var Re=[];I<0&&(I=0);for(let We=0,He=f.numWorkers;We<He;We++){var Le=new Worker($3Dmol.SurfaceWorker);Re.push(Le),Le.postMessage({type:-1,atoms:Ve,volume:be})}return new Promise(function(We,He){var H=0,K=function(){!Re||!Re.length||Re.forEach(function(ye){ye&&ye.terminate&&ye.terminate()})},X=function(ye){for(var Ae=(0,s.splitMesh)({vertexArr:ye.data.vertices,faceArr:ye.data.faces}),G=0,ce=Ae.length;G<ce;G++){var ve={vertices:Ae[G].vertexArr,faces:Ae[G].faceArr},Oe=f.generateSurfaceMesh(Ee,ve,O);(0,b.mergeGeos)(le.geo,Oe)}F.render(),H++,H==Ce.length&&(le.done=!0,K(),We(P))},_e=function(ye){K(),console.log(ye.message+" ("+ye.filename+":"+ye.lineno+")"),He(ye)};for(let ye=0;ye<Ce.length;ye++){var ue=Re[ye%Re.length];ue.onmessage=X,ue.onerror=_e,ue.postMessage({type:I,expandedExtent:Ce[ye].extent,extendedAtoms:Ce[ye].atoms,atomsToShow:Ce[ye].toshow})}})}};x=x||{},O=f.getMatWithStyle(x);let q=new c([]);q.style=x,q.atomsel=w,q.allsel=C,q.focus=S;var Q=null;if(W){var re={},te={};for(R=0;R<this.models.length;R++)re[R]=[],te[R]=[];for(R=0;R<B.length;R++)re[B[R].model].push(B[R]);for(R=0;R<U.length;R++)te[U[R].model].push(U[R]);var ae=[];for(R=0;R<this.models.length;R++)te[R].length>0&&(q.push({geo:new g.Geometry(!0),mat:O,done:!1,finished:!1,symmetries:this.models[R].getSymmetries()}),ae.push(V(q[q.length-1],re[R],te[R])));Q=Promise.all(ae)}else q.push({geo:new g.Geometry(!0),mat:O,done:!1,finished:!1,symmetries:[new m.Matrix4]}),Q=V(q[q.length-1],B,U);return this.surfaces[P]=q,Q.surfid=P,A&&typeof A=="function"?(Q.then(function(ne){A(ne)}),P):Q}setSurfaceMaterialStyle(p,x){if((0,b.adjustVolumeStyle)(x),this.surfaces[p]){var w=this.surfaces[p];for(let S=0;S<w.length;S++){var C=w[S].mat=f.getMatWithStyle(x);if(w[S].mat.side=g.FrontSide,x.wireframe&&w[S].geo.setUpWireframe(),x.color){w[S].mat.color=_.CC.color(x.color),w[S].geo.colorsNeedUpdate=!0;const A=_.CC.color(x.color);w[S].geo.setColor(A)}else if(C.voldata&&C.volscheme){const A=C.volscheme,P=C.voldata,O=_.CC,F=A.range()||[-1,1];w[S].geo.setColors(function(I,B,k){let U=P.getVal(I,B,k);return O.color(A.valueToHex(U,F))})}else{w[S].geo.colorsNeedUpdate=!0;for(let A of w[S].geo.geometryGroups)for(let P=0;P<A.vertices;P++){let O=(0,b.getColorFromStyle)(A.atomArray[P],x),F=3*P;A.colorArray[F]=O.r,A.colorArray[F+1]=O.g,A.colorArray[F+2]=O.b}}w[S].finished=!1}}return this}getSurface(p){return this.surfaces[p]}removeSurface(p){for(var x=this.surfaces[p],w=0;w<x.length;w++)x[w]&&x[w].lastGL&&(x[w].geo!==void 0&&x[w].geo.dispose(),x[w].mat!==void 0&&x[w].mat.dispose(),this.modelGroup.remove(x[w].lastGL));return delete this.surfaces[p],this.show(),this}removeAllSurfaces(){for(var p in this.surfaces)if(this.surfaces.hasOwnProperty(p)){for(var x=this.surfaces[p],w=0;w<x.length;w++)x[w]&&x[w].lastGL&&(x[w].geo!==void 0&&x[w].geo.dispose(),x[w].mat!==void 0&&x[w].mat.dispose(),this.modelGroup.remove(x[w].lastGL));delete this.surfaces[p]}return this.show(),this}jmolMoveTo(){var p=this.modelGroup.position,x="center { "+-p.x+" "+-p.y+" "+-p.z+" }; ",w=this.rotationGroup.quaternion;return x+="moveto .5 quaternion { "+w.x+" "+w.y+" "+w.z+" "+w.w+" };",x}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(p,x){x=x||{};var w=this.getAtomsFromSel(x);if(typeof p=="function")for(let A=0,P=w.length;A<P;A++){let O=w[A];p(O)}else for(let A=0,P=w.length;A<P;A++){var C=w[A];for(let O=0,F=p.length;O<F;O++){let I=p[O];if(I.props)for(var S in I.props)I.props.hasOwnProperty(S)&&this.atomIsSelected(C,I)&&(C.properties||(C.properties={}),C.properties[S]=I.props[S])}}return this}linkViewer(p){return this.linkedViewers.push(p),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(p){this.rotationGroup.position.z=this.CAMERA_Z-p}setAutoEyeSeparation(p,x){var w=this.getPerceivedDistance();return x||(x=5),p||this.camera.position.x>0?this.camera.position.x=w*Math.tan(Math.PI/180*x):this.camera.position.x=-w*Math.tan(Math.PI/180*x),this.camera.lookAt(new m.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(p){this.config.cartoonQuality=p}}f.numWorkers=4,f.maxVolume=64e3,f.surfaceTypeMap={VDW:l.SurfaceType.VDW,MS:l.SurfaceType.MS,SAS:l.SurfaceType.SAS,SES:l.SurfaceType.SES};function v(E,p){if(E=(0,b.getElement)(E),!!E){p=p||{};try{var x=new f(E,p);return x}catch(w){throw"error creating viewer: "+w}}}function y(E,p={},x={}){if(E=(0,b.getElement)(E),!!E){var w=[],C=document.createElement("canvas");x.rows=p.rows,x.cols=p.cols,x.control_all=p.control_all!=null?p.control_all:!1,E.appendChild(C);try{for(var S=0;S<p.rows;S++){for(var A=[],P=0;P<p.cols;P++){x.row=S,x.col=P,x.canvas=C,x.viewers=w,x.control_all=p.control_all;var O=v(E,(0,b.extend)({},x));A.push(O)}w.unshift(A)}}catch(F){throw"error creating viewer grid: "+F}return w}}function D(E){var p=this;if(E=(0,b.getElement)(E),!!E){var x=y(E,{rows:1,cols:2,control_all:!0});this.glviewer1=x[0][0],this.glviewer2=x[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var w=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(S){return typeof p.glviewer1[S]=="function"}),C=0;C<w.length;C++)this[w[C]]=function(S){return function(){var A=this.glviewer1[S].apply(this.glviewer1,arguments),P=this.glviewer2[S].apply(this.glviewer2,arguments);return[A,P]}}(w[C]);this.setCoordinates=function(S,A,P){for(var O=0;O<S.length;O++)S[O].setCoordinates(A,P)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(S){this.glviewer1.render(),this.glviewer2.render(),S&&S(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}},"./src/Gradient.ts":(r,e,t)=>{t.r(e),t.d(e,{CustomLinear:()=>u,Gradient:()=>m,GradientType:()=>n,ROYGB:()=>l,RWB:()=>a,Sinebow:()=>h,builtinGradients:()=>g,getGradient:()=>o,normalizeValue:()=>s});var i=t("./src/colors.ts");class n{}function s(_,b,d){return b>=_?(d<_&&(d=_),d>b&&(d=b),{lo:_,hi:b,val:d}):(d>_&&(d=_),d<b&&(d=b),d=_-d+b,{lo:b,hi:_,val:d})}function o(_){if(_ instanceof n)return _;if(_.gradient!==void 0&&g[_.gradient]){let b=_.min===void 0?-1:_.min,d=_.max===void 0?1:_.max;return _.mid===void 0?_.colors===void 0?new g[_.gradient](b,d):new g[_.gradient](b,d,_.colors):new g[_.gradient](b,d,_.mid)}else if(typeof _.gradient=="string"&&_.gradient.startsWith("linear_")){let b=_.gradient.split("_");b.shift();let d=_.min===void 0?-1:_.min,c=_.max===void 0?1:_.max;return new u(d,c,b)}return _}class a extends n{constructor(b,d,c){super(),this.gradient="RWB",this.mult=1,this.mid=c,this.min=b,this.max=d,typeof d>"u"&&Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0]):b&&d&&!Array.isArray(b)&&(this.min=b,this.max=d)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(b,d){var c,f;if(b=this.mult*b,d?(c=d[0],f=d[1]):(c=this.min,f=this.max),b===void 0)return 16777215;var v=s(c,f,b);c=v.lo,f=v.hi,b=v.val;var y=(f+c)/2;d&&typeof d[2]<"u"?y=d[2]:typeof this.mid<"u"?y=this.mid:y=(c+f)/2;var D,E;return b<y?(D=Math.floor(255*Math.sqrt((b-c)/(y-c))),E=16711680+256*D+D,E):b>y?(D=Math.floor(255*Math.sqrt(1-(b-y)/(f-y))),E=65536*D+256*D+255,E):16777215}}class l extends n{constructor(b,d){super(),this.gradient="ROYGB",this.mult=1,this.min=b,this.max=d,typeof d>"u"&&Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0]):b&&d&&!Array.isArray(b)&&(this.min=b,this.max=d)}valueToHex(b,d){var c,f;if(b=this.mult*b,d?(c=d[0],f=d[1]):(c=this.min,f=this.max),typeof b>"u")return 16777215;var v=s(c,f,b);c=v.lo,f=v.hi,b=v.val;var y=(c+f)/2,D=(c+y)/2,E=(y+f)/2,p,x;return b<D?(p=Math.floor(255*Math.sqrt((b-c)/(D-c))),x=16711680+256*p+0,x):b<y?(p=Math.floor(255*Math.sqrt(1-(b-D)/(y-D))),x=65536*p+65280+0,x):b<E?(p=Math.floor(255*Math.sqrt((b-y)/(E-y))),x=65280+1*p,x):(p=Math.floor(255*Math.sqrt(1-(b-E)/(f-E))),x=0+256*p+255,x)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class h extends n{constructor(b,d){super(),this.gradient="Sinebow",this.mult=1,this.min=b,this.max=d,typeof d>"u"&&Array.isArray(b)&&b.length>=2&&(this.max=b[1],this.min=b[0]),d<b&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(b,d){var c,f;if(b=this.mult*b,d?(c=d[0],f=d[1]):(c=this.min,f=this.max),typeof b>"u")return 16777215;var v=m.normalizeValue(c,f,b);c=v.lo,f=v.hi,b=v.val;var y=(b-c)/(f-c),D=5*y/6+.5,E=Math.sin(Math.PI*D);E*=E*255;var p=Math.sin(Math.PI*(D+1/3));p*=p*255;var x=Math.sin(Math.PI*(D+2/3));return x*=x*255,65536*Math.floor(E)+256*Math.floor(x)+1*Math.floor(p)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class u extends n{constructor(b,d,c){super(),this.gradient="linear",this.colors=new Array;var f;if(Array.isArray(b)&&b.length>=2?(this.max=b[1],this.min=b[0],f=d):(this.min=b,this.max=d,f=c),f)for(let v of f)this.colors.push(i.CC.color(v));else this.colors.push(i.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(b,d){var c,f;if(d?(c=d[0],f=d[1]):(c=this.min,f=this.max),b===void 0)return 16777215;var v=s(c,f,b);c=v.lo,f=v.hi,b=v.val;let y=this.colors.length,D=(f-c)/y,E=Math.min(Math.floor((b-c)/D),y-1),p=Math.min(E+1,y-1),x=(b-c-E*D)/D,w=this.colors[E],C=this.colors[p];return new i.Color(w.r+x*(C.r-w.r),w.g+x*(C.g-w.g),w.b+x*(C.b-w.b)).getHex()}}const g={rwb:a,RWB:a,roygb:l,ROYGB:l,sinebow:h,linear:u};class m extends n{valueToHex(b,d){return 0}range(){return null}}m.RWB=a,m.ROYGB=l,m.Sinebow=h,m.CustomLinear=u,m.builtinGradients=g,m.normalizeValue=s,m.getGradient=o},"./src/Label.ts":(r,e,t)=>{t.r(e),t.d(e,{Label:()=>h,LabelCount:()=>o});var i=t("./src/WebGL/index.ts"),n=t("./src/Gradient.ts"),s=t("./src/colors.ts");let o=0;function a(u,g,m,_,b,d,c){u.beginPath(),u.moveTo(g+d,m),u.lineTo(g+_-d,m),u.quadraticCurveTo(g+_,m,g+_,m+d),u.lineTo(g+_,m+b-d),u.quadraticCurveTo(g+_,m+b,g+_-d,m+b),u.lineTo(g+d,m+b),u.quadraticCurveTo(g,m+b,g,m+b-d),u.lineTo(g,m+d),u.quadraticCurveTo(g,m,g+d,m),u.closePath(),u.fill(),c&&u.stroke()}function l(u,g,m){var _=m;return typeof u<"u"&&(u instanceof s.Color?_=u.scaled():(_=s.CC.color(u),typeof _.scaled<"u"&&(_=_.scaled()))),typeof g<"u"&&(_.a=parseFloat(g)),_}class h{constructor(g,m){this.id=o++,this.stylespec=m||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new i.Sprite,this.text=g,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var g=this.stylespec,m=typeof g.useScreen>"u"?!1:g.useScreen,_=g.showBackground;(_==="0"||_==="false")&&(_=!1),typeof _>"u"&&(_=!0);var b=g.font?g.font:"sans-serif",d=parseInt(g.fontSize)?parseInt(g.fontSize):18,c=l(g.fontColor,g.fontOpacity,{r:255,g:255,b:255,a:1}),f=g.padding?g.padding:4,v=g.borderThickness?g.borderThickness:0,y=l(g.backgroundColor,g.backgroundOpacity,{r:0,g:0,b:0,a:1}),D=l(g.borderColor,g.borderOpacity,y),E=g.position?g.position:{x:-10,y:1,z:1},p=g.inFront!==void 0?g.inFront:!0;(p==="false"||p==="0")&&(p=!1);var x=g.alignment||i.SpriteAlignment.topLeft;typeof x=="string"&&x in i.SpriteAlignment&&(x=i.SpriteAlignment[x]);var w="";g.bold&&(w="bold "),this.context.font=w+d+"px  "+b;var C=this.context.measureText(this.text),S=C.width;_||(v=0);var A=S+2.5*v+2*f,P=d*1.25+2*v+2*f;if(g.backgroundImage){var O=g.backgroundImage,F=g.backgroundWidth?g.backgroundWidth:O.width,I=g.backgroundHeight?g.backgroundHeight:O.height;F>A&&(A=F),I>P&&(P=I)}if(this.canvas.width=A,this.canvas.height=P,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),w="",g.bold&&(w="bold "),this.context.font=w+d+"px  "+b,this.context.fillStyle="rgba("+y.r+","+y.g+","+y.b+","+y.a+")",this.context.strokeStyle="rgba("+D.r+","+D.g+","+D.b+","+D.a+")",g.backgroundGradient){let k=this.context.createLinearGradient(0,P/2,A,P/2),U=n.Gradient.getGradient(g.backgroundGradient),W=U.range(),R=-1,z=1;W&&(R=W[0],z=W[1]);let V=z-R;for(let q=0;q<1.01;q+=.1){let Q=l(U.valueToHex(R+V*q)),re="rgba("+Q.r+","+Q.g+","+Q.b+","+Q.a+")";k.addColorStop(q,re)}this.context.fillStyle=k}this.context.lineWidth=v,_&&a(this.context,v,v,A-2*v,P-2*v,6,v>0),g.backgroundImage&&this.context.drawImage(O,0,0,A,P),this.context.fillStyle="rgba("+c.r+","+c.g+","+c.b+","+c.a+")",this.context.fillText(this.text,v+f,d+v+f,S);var B=new i.Texture(this.canvas);B.needsUpdate=!0,this.sprite.material=new i.SpriteMaterial({map:B,useScreenCoordinates:m,alignment:x,depthTest:!p,screenOffset:g.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(E.x,E.y,E.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}},"./src/ProteinSurface4.ts":(r,e,t)=>{t.r(e),t.d(e,{MarchingCube:()=>l,MarchingCubeInitializer:()=>a,PointGrid:()=>h,ProteinSurface:()=>u,SurfaceType:()=>n,setSyncSurface:()=>o,syncSurface:()=>s});var i=t("./src/WebGL/math/index.ts"),n;(function(g){g[g.VDW=1]="VDW",g[g.MS=2]="MS",g[g.SAS=3]="SAS",g[g.SES=4]="SES"})(n||(n={}));var s=!1;function o(g){s=g}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(s=!0);class a{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(m,_,b,d){let c=!!d.fulltable,f=d.hasOwnProperty("origin")&&d.origin.hasOwnProperty("x")?d.origin:{x:0,y:0,z:0},v=!!d.voxel,y=d.matrix,D=d.nX||0,E=d.nY||0,p=d.nZ||0,x=d.scale||1,w=null;d.unitCube?w=d.unitCube:w={x,y:x,z:x};let C=new Int32Array(D*E*p),S,A;for(S=0,A=C.length;S<A;++S)C[S]=-1;let P=function(B,k,U,W,R,z){let V={x:0,y:0,z:0},q=!!(W&1<<R),Q=!!(W&1<<z),re=R;if(!q&&Q&&(re=z),re&1&&U++,re&2&&k++,re&4&&B++,y){let ae=new i.Vector3(B,k,U);ae=ae.applyMatrix4(y),V={x:ae.x,y:ae.y,z:ae.z}}else V.x=f.x+w.x*B,V.y=f.y+w.y*k,V.z=f.z+w.z*U;let te=(E*B+k)*p+U;return v?(_.push(V),_.length-1):(C[te]<0&&(C[te]=_.length,_.push(V)),C[te])},O=new Int32Array(12),F=c?this.edgeTable2:this.edgeTable,I=c?this.triTable2:this.triTable;for(S=0;S<D-1;++S)for(let B=0;B<E-1;++B)for(let k=0;k<p-1;++k){let U=0;for(let z=0;z<8;++z){let V=(E*(S+((z&4)>>2))+B+((z&2)>>1))*p+k+(z&1),q=!!(m[V]&this.ISDONE);U|=q<<z}if(U===0||U===255)continue;let W=F[U];if(W===0)continue;let R=I[U];W&1&&(O[0]=P(S,B,k,U,0,1)),W&2&&(O[1]=P(S,B,k,U,1,3)),W&4&&(O[2]=P(S,B,k,U,3,2)),W&8&&(O[3]=P(S,B,k,U,2,0)),W&16&&(O[4]=P(S,B,k,U,4,5)),W&32&&(O[5]=P(S,B,k,U,5,7)),W&64&&(O[6]=P(S,B,k,U,7,6)),W&128&&(O[7]=P(S,B,k,U,6,4)),W&256&&(O[8]=P(S,B,k,U,0,4)),W&512&&(O[9]=P(S,B,k,U,1,5)),W&1024&&(O[10]=P(S,B,k,U,3,7)),W&2048&&(O[11]=P(S,B,k,U,2,6));for(let z=0;z<R.length;z+=3){let V=O[R[z]],q=O[R[z+1]],Q=O[R[z+2]];v&&z>=3&&(_.push(_[V]),V=_.length-1,_.push(_[q]),q=_.length-1,_.push(_[Q]),Q=_.length-1),b.push(V),b.push(q),b.push(Q)}}}laplacianSmooth(m,_,b){let d=new Array(_.length),c,f,v,y,D;for(c=0,f=_.length;c<f;c++)d[c]={x:0,y:0,z:0};let E=new Array(20),p;for(c=0;c<20;c++)E[c]=new Array(_.length);for(c=0,f=_.length;c<f;c++)E[0][c]=0;for(c=0,f=b.length/3;c<f;c++){let C=c*3,S=c*3+1,A=c*3+2;for(p=!0,v=0,y=E[0][b[C]];v<y;v++)if(b[S]==E[v+1][b[C]]){p=!1;break}for(p&&(E[0][b[C]]++,E[E[0][b[C]]][b[C]]=b[S]),p=!0,v=0,y=E[0][b[C]];v<y;v++)if(b[A]==E[v+1][b[C]]){p=!1;break}for(p&&(E[0][b[C]]++,E[E[0][b[C]]][b[C]]=b[A]),p=!0,v=0,y=E[0][b[S]];v<y;v++)if(b[C]==E[v+1][b[S]]){p=!1;break}for(p&&(E[0][b[S]]++,E[E[0][b[S]]][b[S]]=b[C]),p=!0,v=0,y=E[0][b[S]];v<y;v++)if(b[A]==E[v+1][b[S]]){p=!1;break}for(p&&(E[0][b[S]]++,E[E[0][b[S]]][b[S]]=b[A]),p=!0,v=0;v<E[0][b[A]];v++)if(b[C]==E[v+1][b[A]]){p=!1;break}for(p&&(E[0][b[A]]++,E[E[0][b[A]]][b[A]]=b[C]),p=!0,v=0,y=E[0][b[A]];v<y;v++)if(b[S]==E[v+1][b[A]]){p=!1;break}p&&(E[0][b[A]]++,E[E[0][b[A]]][b[A]]=b[S])}let x=1,w=.5;for(D=0;D<m;D++){for(c=0,f=_.length;c<f;c++)if(E[0][c]<3)d[c].x=_[c].x,d[c].y=_[c].y,d[c].z=_[c].z;else if(E[0][c]==3||E[0][c]==4){for(d[c].x=0,d[c].y=0,d[c].z=0,v=0,y=E[0][c];v<y;v++)d[c].x+=_[E[v+1][c]].x,d[c].y+=_[E[v+1][c]].y,d[c].z+=_[E[v+1][c]].z;d[c].x+=w*_[c].x,d[c].y+=w*_[c].y,d[c].z+=w*_[c].z,d[c].x/=w+E[0][c],d[c].y/=w+E[0][c],d[c].z/=w+E[0][c]}else{for(d[c].x=0,d[c].y=0,d[c].z=0,v=0,y=E[0][c];v<y;v++)d[c].x+=_[E[v+1][c]].x,d[c].y+=_[E[v+1][c]].y,d[c].z+=_[E[v+1][c]].z;d[c].x+=x*_[c].x,d[c].y+=x*_[c].y,d[c].z+=x*_[c].z,d[c].x/=x+E[0][c],d[c].y/=x+E[0][c],d[c].z/=x+E[0][c]}for(c=0,f=_.length;c<f;c++)_[c].x=d[c].x,_[c].y=d[c].y,_[c].z=d[c].z}}}let l=new a;class h{constructor(m,_,b){this.data=new Int32Array(m*_*b*3),this.width=_,this.height=b}set(m,_,b,d){let c=((m*this.width+_)*this.height+b)*3;this.data[c]=d.ix,this.data[c+1]=d.iy,this.data[c+2]=d.iz}get(m,_,b){let d=((m*this.width+_)*this.height+b)*3;return{ix:this.data[d],iy:this.data[d+1],iz:this.data[d+2]}}}class u{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],u.MarchingCube||(u.MarchingCube=new a)}getVDWIndex(m){return!m.elem||typeof this.vdwRadii[m.elem]>"u"?"X":m.elem}getFacesAndVertices(m){let _={};for(let c=0,f=m.length;c<f;c++)_[m[c]]=!0;let b=this.verts;for(let c=0,f=b.length;c<f;c++)b[c].x=b[c].x/this.scaleFactor-this.ptranx,b[c].y=b[c].y/this.scaleFactor-this.ptrany,b[c].z=b[c].z/this.scaleFactor-this.ptranz;let d=[];for(let c=0,f=this.faces.length;c<f;c+=3){let v=this.faces[c],y=this.faces[c+1],D=this.faces[c+2],E=b[v].atomid,p=b[y].atomid,x=b[D].atomid,w=E;p<w&&(w=p),x<w&&(w=x),_[w]&&v!==y&&y!==D&&v!==D&&(d.push(v),d.push(y),d.push(D))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:b,faces:d}}initparm(m,_,b){b>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let d=1/this.scaleFactor*5.5;this.pminx=m[0][0],this.pmaxx=m[1][0],this.pminy=m[0][1],this.pmaxy=m[1][1],this.pminz=m[0][2],this.pmaxz=m[1][2],_?(this.pminx-=this.probeRadius+d,this.pminy-=this.probeRadius+d,this.pminz-=this.probeRadius+d,this.pmaxx+=this.probeRadius+d,this.pmaxy+=this.probeRadius+d,this.pmaxz+=this.probeRadius+d):(this.pminx-=d,this.pminy-=d,this.pminz-=d,this.pmaxx+=d,this.pmaxy+=d,this.pmaxz+=d),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(_),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(m){let _={};for(const b in this.vdwRadii){let d=this.vdwRadii[b];m?_[b]=(d+this.probeRadius)*this.scaleFactor+.5:_[b]=d*this.scaleFactor+.5;let c=_[b]*_[b];this.widxz[b]=Math.floor(_[b])+1,this.depty[b]=new Int32Array(this.widxz[b]*this.widxz[b]);let f=0;for(let v=0;v<this.widxz[b];v++)for(let y=0;y<this.widxz[b];y++){let D=v*v+y*y;if(D>c)this.depty[b][f]=-1;else{let E=Math.sqrt(c-D);this.depty[b][f]=Math.floor(E)}f++}}}fillvoxels(m,_){for(let b=0,d=this.vpBits.length;b<d;b++)this.vpBits[b]=0,this.vpDistance[b]=-1,this.vpAtomID[b]=-1;for(let b in _){let d=m[_[b]];d!==void 0&&this.fillAtom(d,m)}for(let b=0,d=this.vpBits.length;b<d;b++)this.vpBits[b]&this.INOUT&&(this.vpBits[b]|=this.ISDONE)}fillAtom(m,_){let b=Math.floor(.5+this.scaleFactor*(m.x+this.ptranx)),d=Math.floor(.5+this.scaleFactor*(m.y+this.ptrany)),c=Math.floor(.5+this.scaleFactor*(m.z+this.ptranz)),f=this.getVDWIndex(m),v=0,y=this.pWidth*this.pHeight;for(let D=0,E=this.widxz[f];D<E;D++)for(let p=0;p<E;p++){if(this.depty[f][v]!=-1){for(let x=-1;x<2;x++)for(let w=-1;w<2;w++)for(let C=-1;C<2;C++)if(x!==0&&w!==0&&C!==0){let S=x*D,A=C*p;for(let P=0;P<=this.depty[f][v];P++){let O=P*w,F=b+S,I=d+O,B=c+A;if(F<0||I<0||B<0||F>=this.pLength||I>=this.pWidth||B>=this.pHeight)continue;let k=F*y+I*this.pHeight+B;if(!(this.vpBits[k]&this.INOUT))this.vpBits[k]|=this.INOUT,this.vpAtomID[k]=m.serial;else{let U=_[this.vpAtomID[k]];if(U.serial!=m.serial){let W=b+S-Math.floor(.5+this.scaleFactor*(U.x+this.ptranx)),R=d+O-Math.floor(.5+this.scaleFactor*(U.y+this.ptrany)),z=c+A-Math.floor(.5+this.scaleFactor*(U.z+this.ptranz));S*S+O*O+A*A<W*W+R*R+z*z&&(this.vpAtomID[k]=m.serial)}}}}}v++}}fillvoxelswaals(m,_){for(let b=0,d=this.vpBits.length;b<d;b++)this.vpBits[b]&=~this.ISDONE;for(let b in _){let d=m[_[b]];d!==void 0&&this.fillAtomWaals(d,m)}}fillAtomWaals(m,_){let b=0,d=Math.floor(.5+this.scaleFactor*(m.x+this.ptranx)),c=Math.floor(.5+this.scaleFactor*(m.y+this.ptrany)),f=Math.floor(.5+this.scaleFactor*(m.z+this.ptranz)),v=this.getVDWIndex(m),y=this.pWidth*this.pHeight;for(let D=0,E=this.widxz[v];D<E;D++)for(let p=0;p<E;p++){if(this.depty[v][b]!=-1){for(let x=-1;x<2;x++)for(let w=-1;w<2;w++)for(let C=-1;C<2;C++)if(x!==0&&w!==0&&C!==0){let S=x*D,A=C*p;for(let P=0;P<=this.depty[v][b];P++){let O=P*w,F=d+S,I=c+O,B=f+A;if(F<0||I<0||B<0||F>=this.pLength||I>=this.pWidth||B>=this.pHeight)continue;let k=F*y+I*this.pHeight+B;if(!(this.vpBits[k]&this.ISDONE))this.vpBits[k]|=this.ISDONE,this.vpAtomID[k]=m.serial;else{let U=_[this.vpAtomID[k]];if(U.serial!=m.serial){let W=d+S-Math.floor(.5+this.scaleFactor*(U.x+this.ptranx)),R=c+O-Math.floor(.5+this.scaleFactor*(U.y+this.ptrany)),z=f+A-Math.floor(.5+this.scaleFactor*(U.z+this.ptranz));S*S+O*O+A*A<W*W+R*R+z*z&&(this.vpAtomID[k]=m.serial)}}}}}b++}}buildboundary(){let m=this.pWidth*this.pHeight;for(let _=0;_<this.pLength;_++)for(let b=0;b<this.pHeight;b++)for(let d=0;d<this.pWidth;d++){let c=_*m+d*this.pHeight+b;if(this.vpBits[c]&this.INOUT){let f=0;for(;f<26;){let v=_+this.nb[f][0],y=b+this.nb[f][2],D=d+this.nb[f][1];if(v>-1&&v<this.pLength&&D>-1&&D<this.pWidth&&y>-1&&y<this.pHeight&&!(this.vpBits[v*m+D*this.pHeight+y]&this.INOUT)){this.vpBits[c]|=this.ISBOUND;break}else f++}}}}fastdistancemap(){let m=new h(this.pLength,this.pWidth,this.pHeight),_=this.pWidth*this.pHeight,b=this.cutRadius*this.cutRadius,d=[],c=[],f;for(let D=0;D<this.pLength;D++)for(let E=0;E<this.pWidth;E++)for(let p=0;p<this.pHeight;p++)if(f=D*_+E*this.pHeight+p,this.vpBits[f]&=~this.ISDONE,this.vpBits[f]&this.INOUT&&this.vpBits[f]&this.ISBOUND){let x={ix:D,iy:E,iz:p};m.set(D,E,p,x),d.push(x),this.vpDistance[f]=0,this.vpBits[f]|=this.ISDONE,this.vpBits[f]&=~this.ISBOUND}do{c=this.fastoneshell(d,m),d=[];for(let D=0,E=c.length;D<E;D++)f=_*c[D].ix+this.pHeight*c[D].iy+c[D].iz,this.vpBits[f]&=~this.ISBOUND,this.vpDistance[f]<=1.0404*b&&d.push({ix:c[D].ix,iy:c[D].iy,iz:c[D].iz})}while(d.length!==0);d=[],c=[],m=null;let v=this.scaleFactor-.5;v<0&&(v=0);let y=b-.5/(.1+v);for(let D=0;D<this.pLength;D++)for(let E=0;E<this.pWidth;E++)for(let p=0;p<this.pHeight;p++)f=D*_+E*this.pHeight+p,this.vpBits[f]&=~this.ISBOUND,this.vpBits[f]&this.INOUT&&(!(this.vpBits[f]&this.ISDONE)||this.vpBits[f]&this.ISDONE&&this.vpDistance[f]>=y)&&(this.vpBits[f]|=this.ISBOUND)}fastoneshell(m,_){let b,d,c,f,v,y,D,E,p,x=[];if(m.length===0)return x;let w={ix:-1,iy:-1,iz:-1},C=this.pWidth*this.pHeight;for(let S=0,A=m.length;S<A;S++){b=m[S].ix,d=m[S].iy,c=m[S].iz,E=_.get(b,d,c);for(let P=0;P<6;P++)w.ix=b+this.nb[P][0],w.iy=d+this.nb[P][1],w.iz=c+this.nb[P][2],w.ix<this.pLength&&w.ix>-1&&w.iy<this.pWidth&&w.iy>-1&&w.iz<this.pHeight&&w.iz>-1&&(p=w.ix*C+this.pHeight*w.iy+w.iz,this.vpBits[p]&this.INOUT&&!(this.vpBits[p]&this.ISDONE)?(_.set(w.ix,w.iy,c+this.nb[P][2],E),f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,this.vpDistance[p]=D,this.vpBits[p]|=this.ISDONE,this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})):this.vpBits[p]&this.INOUT&&this.vpBits[p]&this.ISDONE&&(f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,D<this.vpDistance[p]&&(_.set(w.ix,w.iy,w.iz,E),this.vpDistance[p]=D,this.vpBits[p]&this.ISBOUND||(this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})))))}for(let S=0,A=m.length;S<A;S++){b=m[S].ix,d=m[S].iy,c=m[S].iz,E=_.get(b,d,c);for(let P=6;P<18;P++)w.ix=b+this.nb[P][0],w.iy=d+this.nb[P][1],w.iz=c+this.nb[P][2],w.ix<this.pLength&&w.ix>-1&&w.iy<this.pWidth&&w.iy>-1&&w.iz<this.pHeight&&w.iz>-1&&(p=w.ix*C+this.pHeight*w.iy+w.iz,this.vpBits[p]&this.INOUT&&!(this.vpBits[p]&this.ISDONE)?(_.set(w.ix,w.iy,c+this.nb[P][2],E),f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,this.vpDistance[p]=D,this.vpBits[p]|=this.ISDONE,this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})):this.vpBits[p]&this.INOUT&&this.vpBits[p]&this.ISDONE&&(f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,D<this.vpDistance[p]&&(_.set(w.ix,w.iy,w.iz,E),this.vpDistance[p]=D,this.vpBits[p]&this.ISBOUND||(this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})))))}for(let S=0,A=m.length;S<A;S++){b=m[S].ix,d=m[S].iy,c=m[S].iz,E=_.get(b,d,c);for(let P=18;P<26;P++)w.ix=b+this.nb[P][0],w.iy=d+this.nb[P][1],w.iz=c+this.nb[P][2],w.ix<this.pLength&&w.ix>-1&&w.iy<this.pWidth&&w.iy>-1&&w.iz<this.pHeight&&w.iz>-1&&(p=w.ix*C+this.pHeight*w.iy+w.iz,this.vpBits[p]&this.INOUT&&!(this.vpBits[p]&this.ISDONE)?(_.set(w.ix,w.iy,c+this.nb[P][2],E),f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,this.vpDistance[p]=D,this.vpBits[p]|=this.ISDONE,this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})):this.vpBits[p]&this.INOUT&&this.vpBits[p]&this.ISDONE&&(f=w.ix-E.ix,v=w.iy-E.iy,y=w.iz-E.iz,D=f*f+v*v+y*y,D<this.vpDistance[p]&&(_.set(w.ix,w.iy,w.iz,E),this.vpDistance[p]=D,this.vpBits[p]&this.ISBOUND||(this.vpBits[p]|=this.ISBOUND,x.push({ix:w.ix,iy:w.iy,iz:w.iz})))))}return x}marchingcubeinit(m){for(let _=0,b=this.vpBits.length;_<b;_++)m==1?this.vpBits[_]&=~this.ISBOUND:m==4?(this.vpBits[_]&=~this.ISDONE,this.vpBits[_]&this.ISBOUND&&(this.vpBits[_]|=this.ISDONE),this.vpBits[_]&=~this.ISBOUND):m==2?this.vpBits[_]&this.ISBOUND&&this.vpBits[_]&this.ISDONE?this.vpBits[_]&=~this.ISBOUND:this.vpBits[_]&this.ISBOUND&&!(this.vpBits[_]&this.ISDONE)&&(this.vpBits[_]|=this.ISDONE):m==3&&(this.vpBits[_]&=~this.ISBOUND)}marchingcube(m){this.marchingcubeinit(m),this.verts=[],this.faces=[],u.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let _=this.pWidth*this.pHeight;for(let b=0,d=this.verts.length;b<d;b++)this.verts[b].atomid=this.vpAtomID[this.verts[b].x*_+this.pHeight*this.verts[b].y+this.verts[b].z];u.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}u.MarchingCube=new a},"./src/SurfaceWorker.js":()=>{$3Dmol.workerString=(function(){self.onmessage=function(r){var e=r.data,t=e.type;if(t<0)self.atomData=e.atoms,self.volume=e.volume,self.ps=new ProteinSurface;else{var i=self.ps;i.initparm(e.expandedExtent,t!=1,self.volume),i.fillvoxels(self.atomData,e.extendedAtoms),i.buildboundary(),(t===4||t===2)&&(i.fastdistancemap(),i.boundingatom(!1),i.fillvoxelswaals(self.atomData,e.extendedAtoms)),i.marchingcube(t);var n=i.getFacesAndVertices(e.atomsToShow);self.postMessage(n)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},"./src/VolumeData.ts":(r,e,t)=>{t.r(e),t.d(e,{VolumeData:()=>l});var i=t("./src/utilities.ts"),n=t("./src/WebGL/math/index.ts"),s=t("./src/parsers/VASP.ts"),o=t("./src/parsers/CUBE.ts"),a=t("./node_modules/pako/dist/pako.esm.mjs");class l{constructor(u,g,m){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(f){var v=f/(this.size.y*this.size.z),y=f%(this.size.y*this.size.z),D=f%this.size.z;return v*=this.unit.x,y*=this.unit.y,D*=this.unit.z,v+=this.origin.x,y+=this.origin.y,D+=this.origin.z,{x:v,y,z:D}},this.vasp=function(f){var v=f.replace(/^\s+/,"").split(/[\n\r]/),y=(0,s.VASP)(f)[0],D=y.length;if(D==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var E=1.889725992,p=.036749309,x=parseFloat(v[1]),w;w=v[2].replace(/^\s+/,"").split(/\s+/);var C=new n.Vector3(parseFloat(w[0]),parseFloat(w[1]),parseFloat(w[2])).multiplyScalar(x*E);w=v[3].replace(/^\s+/,"").split(/\s+/);var S=new n.Vector3(parseFloat(w[0]),parseFloat(w[1]),parseFloat(w[2])).multiplyScalar(x*E);w=v[4].replace(/^\s+/,"").split(/\s+/);var A=new n.Vector3(parseFloat(w[0]),parseFloat(w[1]),parseFloat(w[2])).multiplyScalar(x*E),P=C.x*(S.y*A.z-A.y*S.z)-S.x*(C.y*A.z-A.y*C.z)+A.x*(C.y*S.z-S.y*C.z);P=Math.abs(P)/Math.pow(E,3);var O=1/P;v.splice(0,8+D+1);var F=v[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),I=Math.abs(parseFloat(F[0])),B=Math.abs(parseFloat(F[1])),k=Math.abs(parseFloat(F[2])),U=this.origin=new n.Vector3(0,0,0);this.size={x:I,y:B,z:k},this.unit=new n.Vector3(C.x,S.y,A.z),C=C.multiplyScalar(1/(E*I)),S=S.multiplyScalar(1/(E*B)),A=A.multiplyScalar(1/(E*k)),(C.y!=0||C.z!=0||S.x!=0||S.z!=0||A.x!=0||A.y!=0)&&(this.matrix=new n.Matrix4(C.x,S.x,A.x,0,C.y,S.y,A.y,0,C.z,S.z,A.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new n.Matrix4().makeTranslation(U.x,U.y,U.z)),this.origin=new n.Vector3(0,0,0),this.unit=new n.Vector3(1,1,1)),v.splice(0,1);var W=v.join(" ");W=W.replace(/^\s+/,"");var R=W.split(/[\s\r]+/);R.splice(I*B*k+1);for(var z=Float32Array.from(R,parseFloat),V=0;V<z.length;V++)z[V]=z[V]*O*p;this.data=z},this.dx=function(f){var v=f.split(/[\n\r]+/),y,D=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,E=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,p=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,x=/data follows/,w=0;for(w=0;w<v.length;w++){var C=v[w];if(y=D.exec(C)){var S=parseInt(y[1]),A=parseInt(y[2]),P=parseInt(y[3]);this.size={x:S,y:A,z:P}}else if(y=p.exec(C)){var O=parseFloat(y[1]);if((parseFloat(y[2])!=0||parseFloat(y[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),w+=1,C=v[w],y=p.exec(C),y==null){console.error("Parse error in dx delta matrix");return}var F=parseFloat(y[2]);if((parseFloat(y[1])!=0||parseFloat(y[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),w+=1,C=v[w],y=p.exec(C),y==null){console.error("Parse error in dx delta matrix");return}var I=parseFloat(y[3]);(parseFloat(y[1])!=0||parseFloat(y[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new n.Vector3(O,F,I)}else if(y=E.exec(C)){var B=parseFloat(y[1]),k=parseFloat(y[2]),U=parseFloat(y[3]);this.origin=new n.Vector3(B,k,U)}else if(y=x.exec(C))break}if(w+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var W=v.splice(w).join(" "),R=W.split(/[\s\r]+/);this.data=Float32Array.from(R,parseFloat)},g=g.toLowerCase(),/\.gz$/.test(g)){g=g.replace(/\.gz$/,"");try{this[g]&&this.isbinary.has(g)?(typeof u=="string"&&(u=(0,i.base64ToArray)(u)),u=(0,a.inflate)(u)):u=new TextDecoder("utf-8").decode((0,a.inflate)(u))}catch(f){console.error(f)}}if(this[g]&&(this.isbinary.has(g)&&typeof u=="string"&&(u=(0,i.base64ToArray)(u)),this[g](u)),m){if(m.negate)for(let f=0,v=this.data.length;f<v;f++)this.data[f]=-this.data[f];if(m.normalize){var _=0;for(let f=0,v=this.data.length;f<v;f++)_+=this.data[f];var b=_/this.data.length;_=0;for(let f=0,v=this.data.length;f<v;f++){var d=this.data[f]-b;_+=d*d}var c=_/this.data.length;for(let f=0,v=this.data.length;f<v;f++)this.data[f]=(this.data[f]-b)/c}}}getIndex(u,g,m){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new n.Matrix4().getInverse(this.matrix));var _=new n.Vector3(u,g,m);_=_.applyMatrix4(this.inversematrix),u=_.x,g=_.y,m=_.z}else u-=this.origin.x,g-=this.origin.y,m-=this.origin.z,u/=this.unit.x,g/=this.unit.y,m/=this.unit.z;return u=Math.round(u),g=Math.round(g),m=Math.round(m),u<0||u>=this.size.x||g<0||g>=this.size.y||m<0||m>=this.size.z?-1:u*this.size.y*this.size.z+g*this.size.z+m}getVal(u,g,m){let _=this.getIndex(u,g,m);return _<0?0:this.data[_]}cube(u){var g=u.split(/\r?\n/);if(!(g.length<6)){var m=(0,o.CUBE)(u,{}).modelData[0].cryst,_=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),b=parseFloat(_[0]),d=Math.abs(b);this.origin=m.origin,this.size=m.size,this.unit=m.unit,this.matrix=m.matrix4;var c=6;b<0&&c++;var f=g.splice(d+c).join(" ");f=f.replace(/^\s+/,"");var v=f.split(/[\s\r]+/);this.data=Float32Array.from(v,parseFloat)}}ccp4(u){var g={};u=new Int8Array(u);var m=new Int32Array(u.buffer,0,56),_=new Float32Array(u.buffer,0,56),b=new DataView(u.buffer);if(g.MAP=String.fromCharCode(b.getUint8(208),b.getUint8(209),b.getUint8(210),b.getUint8(211)),g.MACHST=[b.getUint8(212),b.getUint8(213)],g.MACHST[0]===17&&g.MACHST[1]===17)for(var d=u.byteLength,c=0;c<d;c+=4)b.setFloat32(c,b.getFloat32(c),!0);g.NX=m[0],g.NY=m[1],g.NZ=m[2],g.MODE=m[3],g.NXSTART=m[4],g.NYSTART=m[5],g.NZSTART=m[6],g.MX=m[7],g.MY=m[8],g.MZ=m[9],g.xlen=_[10],g.ylen=_[11],g.zlen=_[12],g.alpha=_[13],g.beta=_[14],g.gamma=_[15],g.MAPC=m[16],g.MAPR=m[17],g.MAPS=m[18],g.DMIN=_[19],g.DMAX=_[20],g.DMEAN=_[21],g.ISPG=m[22],g.NSYMBT=m[23],g.LSKFLG=m[24],g.originX=_[49],g.originY=_[50],g.originZ=_[51],g.ARMS=_[54];var f=g,v=[f.xlen,0,0],y=[f.ylen*Math.cos(Math.PI/180*f.gamma),f.ylen*Math.sin(Math.PI/180*f.gamma),0],D=[f.zlen*Math.cos(Math.PI/180*f.beta),f.zlen*(Math.cos(Math.PI/180*f.alpha)-Math.cos(Math.PI/180*f.gamma)*Math.cos(Math.PI/180*f.beta))/Math.sin(Math.PI/180*f.gamma),0];D[2]=Math.sqrt(f.zlen*f.zlen*Math.sin(Math.PI/180*f.beta)*Math.sin(Math.PI/180*f.beta)-D[1]*D[1]);var E=[0,v,y,D],p=[0,f.MX,f.MY,f.MZ],x=[0,f.MAPC,f.MAPR,f.MAPS];this.matrix=new n.Matrix4,this.matrix.set(E[x[1]][0]/p[x[1]],E[x[2]][0]/p[x[2]],E[x[3]][0]/p[x[3]],0,E[x[1]][1]/p[x[1]],E[x[2]][1]/p[x[2]],E[x[3]][1]/p[x[3]],0,E[x[1]][2]/p[x[1]],E[x[2]][2]/p[x[2]],E[x[3]][2]/p[x[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new n.Matrix4().makeTranslation(f.NXSTART+f.originX,f.NYSTART+f.originY,f.NZSTART+f.originZ)),this.origin=new n.Vector3(0,0,0),this.unit=new n.Vector3(1,1,1),this.size={x:g.NX,y:g.NY,z:g.NZ},this.dimensionorder=[g.MAPC,g.MAPR,g.MAPS];var w=new Float32Array(u.buffer,1024+g.NSYMBT),C=g.NX,S=g.NY,A=g.NZ;this.data=new Float32Array(C*S*A);for(let P=0;P<C;P++)for(let O=0;O<S;O++)for(let F=0;F<A;F++)this.data[(P*S+O)*A+F]=w[(F*S+O)*C+P]}}},"./src/VolumetricRender.ts":(r,e,t)=>{t.r(e),t.d(e,{GLVolumetricRender:()=>l});var i=t("./src/WebGL/shapes/index.ts"),n=t("./src/WebGL/math/index.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/colors.ts"),a=t("./src/GLShape.ts");class l{static interpolateArray(u,g){function m(D,E,p){return D+(E-D)*p}var _=[],b=(u.length-1)/(g-1);_[0]=u[0];for(var d=1;d<g-1;d++){var c=d*b,f=Math.floor(c),v=Math.ceil(c),y=c-f;_[d]=m(u[f],u[v],y)}return _[g-1]=u[u.length-1],_}constructor(u,g,m){this.hidden=!1,this.boundingSphere=new i.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,g=g||{};var _=Object.assign([],g.transferfn);this.subsamples=g.subsamples||5;let b=256;_.forEach(function(S){S.value=parseFloat(S.value)}),_.sort(function(S,A){return S.value-A.value}),this.min=_[0].value,_.length==0&&_.push(_[0]),this.max=_[_.length-1].value;var d,c,f,v,y,D,E,p,x,w;for(let S=0;S<_.length-1;S++)if(f=o.CC.color(_[S].color),v=o.CC.color(_[S+1].color),x=_[S].opacity,w=_[S+1].opacity,d=Math.floor((_[S].value-this.min)*b/(this.max-this.min)),c=Math.floor((_[S+1].value-this.min)*b/(this.max-this.min)),d!=c){y=l.interpolateArray([f.r*255,v.r*255],c-d),D=l.interpolateArray([f.g*255,v.g*255],c-d),E=l.interpolateArray([f.b*255,v.b*255],c-d),p=l.interpolateArray([x*255,w*255],c-d);for(let A=0;A<y.length;A++)this.transferfunctionbuffer.push(y[A]),this.transferfunctionbuffer.push(D[A]),this.transferfunctionbuffer.push(E[A]),this.transferfunctionbuffer.push(p[A])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),u.matrix){let S=new n.Vector3(0,0,0),A=new n.Vector3(u.size.x,u.size.y,u.size.z),P=new n.Vector3(1,1,1);S.applyMatrix4(u.matrix),A.applyMatrix4(u.matrix),P.applyMatrix4(u.matrix).sub(S),this.extent=[[S.x,S.y,S.z],[A.x,A.y,A.z]];for(let B=1;B<7;B++)A.x=B&1?u.size.x:0,A.y=B&2?u.size.y:0,A.z=B&4?u.size.z:0,A.applyMatrix4(u.matrix),this.extent[0][0]=Math.min(this.extent[0][0],A.x),this.extent[0][1]=Math.min(this.extent[0][1],A.y),this.extent[0][2]=Math.min(this.extent[0][2],A.z),this.extent[1][0]=Math.max(this.extent[1][0],A.x),this.extent[1][1]=Math.max(this.extent[1][1],A.y),this.extent[1][2]=Math.max(this.extent[1][2],A.z);let O=A.x-S.x,F=A.y-S.y,I=A.z-S.z;this.maxdepth=Math.sqrt(O*O+F*F+I*I),this.minunit=Math.min(Math.min(P.x,P.y),P.z),this.texmatrix=new n.Matrix4().identity().scale({x:u.size.x,y:u.size.y,z:u.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(u.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new n.Matrix4().identity();let S=u.unit.x*u.size.x,A=u.unit.y*u.size.y,P=u.unit.z*u.size.z;this.texmatrix.makeTranslation(-u.origin.x/S,-u.origin.y/A,-u.origin.z/P),this.texmatrix.scale({x:1/S,y:1/A,z:1/P}),this.minunit=Math.min(Math.min(u.unit.x,u.unit.y),u.unit.z),this.extent=[[u.origin.x,u.origin.y,u.origin.z],[u.origin.x+S,u.origin.y+A,u.origin.z+P]],this.maxdepth=Math.sqrt(S*S+A*A+P*P)}var C=new a.GLShape({});if(C.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=C.finalize(),this.boundingSphere.center=new n.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,g.coords===void 0&&g.selection!==void 0&&(m?g.coords=m.selectedAtoms(g.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),g.coords!==void 0&&g.seldist!==void 0){let S=new Uint8Array(u.data.length),A=g.seldist,P=A*A;for(let O=0,F=g.coords.length;O<F;O++){let I=g.coords[O],B=I.x-A,k=I.y-A,U=I.z-A,W=I.x+A,R=I.y+A,z=I.z+A;if(u.getIndex(B,k,U)>=0||u.getIndex(W,R,z)>=0)for(let V=B;V<W;V+=this.minunit)for(let q=k;q<R;q+=this.minunit)for(let Q=U;Q<z;Q+=this.minunit){let re=u.getIndex(V,q,Q);re>=0&&!S[re]&&(V-I.x)*(V-I.x)+(q-I.y)*(q-I.y)+(Q-I.z)*(Q-I.z)<P&&(S[re]=1)}}for(let O=0,F=u.data.length;O<F;O++)S[O]==0&&(u.data[O]=1/0)}this.data=u}globj(u){if(this.renderedShapeObj&&(u.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new s.Object3D;var g=null,m=new s.Texture(this.data,!0),_=new s.Texture(this.transferfunctionbuffer,!1);m.needsUpdate=!0,_.needsUpdate=!0,_.flipY=!1,g=new s.VolumetricMaterial({transferfn:_,transfermin:this.min,transfermax:this.max,map:m,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var b=new s.Mesh(this.geo,g);this.shapeObj.add(b),this.renderedShapeObj=this.shapeObj.clone(),u.add(this.renderedShapeObj)}}removegl(u){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),u.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}},"./src/WebGL/Camera.ts":(r,e,t)=>{t.r(e),t.d(e,{Camera:()=>s});var i=t("./src/WebGL/core/index.ts"),n=t("./src/WebGL/math/index.ts");class s extends i.Object3D{constructor(a=50,l=1,h=.1,u=2e3,g=!1){super(),this.projectionMatrix=new n.Matrix4,this.projectionMatrixInverse=new n.Matrix4,this.matrixWorldInverse=new n.Matrix4,this.fov=a,this.aspect=l,this.near=h,this.far=u;var m=this.position.z;this.right=m*Math.tan(Math.PI/180*a),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!g,this.updateProjectionMatrix()}lookAt(a){this.matrix.lookAt(this.position,a,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof n.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}},"./src/WebGL/Fog.ts":(r,e,t)=>{t.r(e),t.d(e,{Fog:()=>n});var i=t("./src/colors.ts");class n{constructor(o,a=1,l=1e3){this.name="",this.color=new i.Color(o),this.near=a,this.far=l}clone(){return new n(this.color.getHex(),this.near,this.far)}}},"./src/WebGL/Renderer.ts":(r,e,t)=>{t.r(e),t.d(e,{Renderer:()=>d});var i=t("./src/WebGL/Camera.ts"),n=t("./src/WebGL/constants/Sides.ts"),s=t("./src/WebGL/constants/TextureConstants.ts"),o=t("./src/WebGL/core/index.ts"),a=t("./src/colors.ts"),l=t("./src/WebGL/materials/index.ts"),h=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/objects/index.ts"),g=t("./src/WebGL/shaders/index.ts"),m=t("./src/WebGL/SpritePlugin.ts"),_=null,b=null;class d{constructor(f){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new h.Vector3,this._worldInverse=new h.Matrix4,this._projInverse=new h.Matrix4,this._textureMatrix=new h.Matrix4,this._fullProjModelMatrix=new h.Matrix4,this._fullProjModelMatrixInv=new h.Matrix4,this._direction=new h.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new m.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,f=f||{},this.row=f.row,this.col=f.col,this.rows=f.rows,this.cols=f.cols,this._canvas=f.canvas!==void 0?f.canvas:document.createElement("canvas"),this._precision=f.precision!==void 0?f.precision:"highp",this._alpha=f.alpha!==void 0?f.alpha:!0,this._premultipliedAlpha=f.premultipliedAlpha!==void 0?f.premultipliedAlpha:!0,this._antialias=f.antialias!==void 0?f.antialias:!1,this._upscale=f.upscale!==void 0?f.upscale:this._antialias,this._preserveDrawingBuffer=f.preserveDrawingBuffer!==void 0?f.preserveDrawingBuffer:!1,this._clearColor=f.clearColor!==void 0?new a.Color(f.clearColor):new a.Color(0),this._clearAlpha=f.clearAlpha!==void 0?f.clearAlpha:0,this._outlineMaterial=new l.MeshOutlineMaterial(f.outline),this._outlineSphereImposterMaterial=new l.SphereImposterOutlineMaterial(f.outline),this._outlineStickImposterMaterial=new l.StickImposterOutlineMaterial(f.outline),this._outlineEnabled=!!f.outline,this._AOEnabled=!!f.ambientOcclusion,f.ambientOcclusion&&typeof f.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(f.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),f.ambientOcclusion&&typeof f.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(f.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=f.id,!(f.containerWidth==0||f.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(f,v){this._clearColor.setHex(f),this._clearAlpha=v,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(f){this._outlineMaterial=new l.MeshOutlineMaterial(f),this._outlineSphereImposterMaterial=new l.SphereImposterOutlineMaterial(f),this._outlineStickImposterMaterial=new l.StickImposterOutlineMaterial(f),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(f){f&&(f.strength&&(this._AOstrength=f.strength),f.scale&&(this._AOradius=f.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var f=this._gl.drawingBufferWidth/this.cols,v=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=f,this._viewportHeight=v,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(f*this.col,v*this.row,f,v),this._gl.viewport(f*this.col,v*this.row,f,v))}}setSize(f,v){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=f*this.devicePixelRatio,this._canvas.height=v*this.devicePixelRatio,this._canvas.style.width=f+"px",this._canvas.style.height=v+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var y=f/this.cols,D=v/this.rows;this._viewportWidth=y*this.devicePixelRatio,this._viewportHeight=D*this.devicePixelRatio,this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows,this.setViewport()}else this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(f,v,y){var D=0;(f===void 0||f)&&(D|=this._gl.COLOR_BUFFER_BIT),(v===void 0||v)&&(D|=this._gl.DEPTH_BUFFER_BIT),(y===void 0||y)&&(D|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(D)}setMaterialFaces(f,v){var y=f.side===n.DoubleSide,D=f.side===n.BackSide;f.imposter||(D=v?!D:D),this._oldDoubleSided!==y&&(y?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=y),this._oldFlipSided!==D&&(D?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=D),this._gl.cullFace(this._gl.BACK)}setDepthTest(f){this._oldDepthTest!==f&&(f?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=f)}setDepthWrite(f){this._oldDepthWrite!==f&&(this._gl.depthMask(f),this._oldDepthWrite=f)}setBlending(f){f?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(f,v,y,D){f.addEventListener("dispose",this.onMaterialDispose.bind(this));var E,p;if(p=f.shaderID,p){var x=g.ShaderLib[p];f.vertexShader=x.vertexShader,f.fragmentShader=x.fragmentShader,f.uniforms=g.ShaderUtils.clone(x.uniforms),f.shaded&&f.makeShaded(this.SHADE_TEXTURE)}E={wireframe:f.wireframe,fragdepth:f.imposter,volumetric:f.volumetric,shaded:f.shaded},f.program=this.buildProgram(f.fragmentShader,f.vertexShader,f.uniforms,E)}renderBuffer(f,v,y,D,E,p){if(D.visible){var x,w;if(x=this.setProgram(f,v,y,D,p,this),!!x){w=x.attributes;var C=!1,S=D.wireframe?1:0,A=E.id*16777215+x.id*2+S;A!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=A,C=!0),C&&(this.disableAttributes(),w.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this.enableAttribute(w.position),this._gl.vertexAttribPointer(w.position,3,this._gl.FLOAT,!1,0,0)),w.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglColorBuffer),this.enableAttribute(w.color),this._gl.vertexAttribPointer(w.color,3,this._gl.FLOAT,!1,0,0)),w.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this.enableAttribute(w.normal),this._gl.vertexAttribPointer(w.normal,3,this._gl.FLOAT,!1,0,0)),w.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglOffsetBuffer),this.enableAttribute(w.offset),this._gl.vertexAttribPointer(w.offset,3,this._gl.FLOAT,!1,0,0)),w.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglRadiusBuffer),this.enableAttribute(w.radius),this._gl.vertexAttribPointer(w.radius,1,this._gl.FLOAT,!1,0,0)));var P,O;if(p instanceof u.Mesh){if(D.shaderID==="instanced"){var F=D.sphere.geometryGroups[0];C&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,F.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,F.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,F.faceArray,this._gl.STATIC_DRAW)),P=F.faceidx,this._extInstanced.vertexAttribDivisorANGLE(w.offset,1),this._extInstanced.vertexAttribDivisorANGLE(w.radius,1),this._extInstanced.vertexAttribDivisorANGLE(w.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,P,this._gl.UNSIGNED_SHORT,0,E.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(w.offset,0),this._extInstanced.vertexAttribDivisorANGLE(w.radius,0),this._extInstanced.vertexAttribDivisorANGLE(w.color,0)}else D.wireframe?(O=E.lineidx,this.setLineWidth(D.wireframeLinewidth),C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,O,this._gl.UNSIGNED_SHORT,0)):(P=E.faceidx,C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,P,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=P,this.info.render.faces+=P/3}else p instanceof u.Line&&(O=E.vertices,this.setLineWidth(D.linewidth),this._gl.drawArrays(this._gl.LINES,0,O),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(f,v,y){let D=f.__lights,E=f.fog,p=[];for(let C=0,S=f.__webglObjects.length;C<S;C++){let A=f.__webglObjects[C];A.render&&A[y]&&p.push(A)}if(p.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(f.__webglObjects,!0,y+"Depth",v,D,E,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let x=this._AOshader.uniforms;this._gl.uniform1f(x.total_strength,this._AOstrength),this._gl.uniform1f(x.radius,this._AOradius),this._fullProjModelMatrix=new h.Matrix4,this._fullProjModelMatrixInv=new h.Matrix4;let w=p[0].object;this._fullProjModelMatrix.multiplyMatrices(v.projectionMatrix,w._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(x.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(x.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(f,v){if(!(v instanceof i.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var y,D,E,p,x,w=f.__lights,C=f.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&f.updateMatrixWorld(),v.parent===void 0&&v.updateMatrixWorld(),v.matrixWorldInverse.getInverse(v.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(f),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),x=f.__webglObjects;let S=!1,A=this._AOEnabled;for(y=0,D=x.length;y<D;y++)E=x[y],p=E.object,E.render=!1,p.visible&&(this.setupMatrices(p,v),this.unrollBufferMaterial(E),E.render=!0,E.volumetric&&(S=!0),E.hasAO&&(A=!0));if(this.setBlending(!1),A&&this.setShading(f,v,"opaque"),this.renderObjects(f.__webglObjects,!0,"opaque",v,w,C,!1),A&&this.clearShading(),this.renderSprites(f,v,!1),this.renderObjects(f.__webglObjects,!0,"transparentDepth",v,w,C,!0),this.renderObjects(f.__webglObjects,!1,"transparent",v,w,C,!0),S&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(f.__webglObjects,!1,"volumetric",v,w,C,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(f,v,!0),this._bitmap){const P=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(P),P.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let f=this._viewportWidth,v=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,f,v),this._gl.viewport(0,0,f,v),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,f,v,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,f,v,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,f,v,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,f,v,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let f=this._viewportWidth,v=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,f,v),this._gl.viewport(0,0,f,v),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var y=this._antialias?g.ShaderLib.screenaa:g.ShaderLib.screen;this._screenshader=this.buildProgram(y.fragmentShader,y.vertexShader,y.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var D=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(D),this._gl.STATIC_DRAW);let E=g.ShaderLib.ssao;this._AOshader=this.buildProgram(E.fragmentShader,E.vertexShader,E.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let p=g.ShaderLib.blur;this._blurshader=this.buildProgram(p.fragmentShader,p.vertexShader,p.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(f){if(f.__webglObjects||(f.__webglObjects=[],f.__webglObjectsImmediate=[],f.__webglSprites=[],f.__webglFlares=[]),f.__objectsAdded.length){for(;f.__objectsAdded.length;)this.addObject(f.__objectsAdded[0],f),f.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;f.__objectsRemoved.length;)this.removeObject(f.__objectsRemoved[0],f),f.__objectsRemoved.splice(0,1);for(var v=0,y=f.__webglObjects.length;v<y;v++)this.updateObject(f.__webglObjects[v].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(f,v){(f==null||v==null)&&(f=this._canvas.width,v=this._canvas.height);var y=f/v;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var D=f/this.cols,E=v/this.rows;y=D/E}return y}setTexture(f,v,y){if(f.needsUpdate){f.__webglInit||(f.__webglInit=!0,f.addEventListener("dispose",this.onTextureDispose.bind(this)),f.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+v);var D=y?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(D,f.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,f.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,f.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,f.unpackAlignment);var E=this.paramToGL(f.format),p=this.paramToGL(f.type);if(y)this.setTextureParameters(this._gl.TEXTURE_3D,f),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,f.image.size.z,f.image.size.y,f.image.size.x,0,this._gl.RED,this._gl.FLOAT,f.image.data);else{var x=f.image,w=x.width,C=x.height;typeof w>"u"&&(w=x.length,E==this._gl.RGBA&&(w/=4),C=1),this.setTextureParameters(this._gl.TEXTURE_2D,f),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,E,p,f.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,w,C,0,E,p,f.image)}f.needsUpdate=!1,f.onUpdate&&f.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+v),y?this._gl.bindTexture(this._gl.TEXTURE_3D,f.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,f.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(f){this._enabledAttributes[f]||(this._gl.enableVertexAttribArray(f),this._enabledAttributes[f]=!0)}disableAttributes(){for(let f in this._enabledAttributes)this._enabledAttributes[f]&&(this._gl.disableVertexAttribArray(f),this._enabledAttributes[f]=!1)}setPolygonOffset(f,v,y){this._oldPolygonOffset!==f&&(f?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(f){f!==this._oldLineWidth&&(this._gl.lineWidth(f),this._oldLineWidth=f)}deallocateGeometry(f){if(f.__webglInit=void 0,f.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(f.__webglVertexBuffer),f.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(f.__webglColorBuffer),f.geometryGroups!==void 0)for(var v=0,y=f.groups;v<y;v++){var D=f.geometryGroups[v];D.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(D.__webglVertexBuffer),D.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(D.__webglColorBuffer),D.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(D.__webglNormalBuffer),D.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(D.__webglFaceBuffer),D.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(D.__webglLineBuffer)}}deallocateMaterial(f){var v=f.program;if(v!==void 0){f.program=void 0;var y,D,E,p=!1;for(y=0,D=this._programs.length;y<D;y++)if(E=this._programs[y],E.program===v){E.usedTimes--,E.usedTimes===0&&(p=!0);break}if(p===!0){var x=[];for(y=0,D=this._programs.length;y<D;y++)E=this._programs[y],E.program!==v&&x.push(E);this._programs=x,this._gl.deleteProgram(v),this.info.memory.programs--}}}deallocateTexture(f){if(f.image&&f.image.__webglTextureCube)this._gl.deleteTexture(f.image.__webglTextureCube);else{if(!f.__webglInit)return;f.__webglInit=!1,this._gl.deleteTexture(f.__webglTexture)}}onGeometryDispose(f){var v=f.target;v.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(v),this.info.memory.geometries--}onTextureDispose(f){var v=f.target;v.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(v),this.info.memory.textures--}onMaterialDispose(f){var v=f.target;v.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(v)}getShader(f,v){var y;return!this.isWebGL1()&&!v.startsWith("#version")&&(v=v.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),f=="fragment"?v=v.replace(/varying/g,"in"):v=v.replace(/varying/g,"out"),v=v.replace(/attribute/g,"in"),v=v.replace(/texture2D/g,"texture"),v=v.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),v=v.replace(/gl_FragColor/g,"glFragColor"),v=`#version 300 es
`+v),f==="fragment"?y=this._gl.createShader(this._gl.FRAGMENT_SHADER):f==="vertex"&&(y=this._gl.createShader(this._gl.VERTEX_SHADER)),y==null?null:(this._gl.shaderSource(y,v),this._gl.compileShader(y),this._gl.getShaderParameter(y,this._gl.COMPILE_STATUS)?y:(console.error(this._gl.getShaderInfoLog(y)),console.error("could not initialize shader"),null))}buildProgram(f,v,y,D){var E,p,x,w,C=[];C.push(f),C.push(v);for(E in D)C.push(E),C.push(D[E]);for(w=C.join(),E=0,p=this._programs.length;E<p;E++){var S=this._programs[E];if(S.code===w)return S.usedTimes++,S.program}if(this.isWebGL1()&&D.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(x=this._gl.createProgram(),x==null)return null;var A=this._precision,P="precision "+A+" float;",O=[D.volumetric?"#version 300 es":"",P].join(`
`),F=[D.volumetric?"#version 300 es":"",D.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",D.shaded?"#define SHADED 1":"",D.wireframe?"#define WIREFRAME 1":"",P].join(`
`),I=this.getShader("fragment",F+f),B=this.getShader("vertex",O+v);B!=null&&this._gl.attachShader(x,B),I!=null&&this._gl.attachShader(x,I),this._gl.linkProgram(x),this._gl.getProgramParameter(x,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),x.uniforms={},x.attributes={};var k,U,W;k=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"];for(U in y)k.push(U);for(W=0;W<k.length;W++){var R=k[W];x.uniforms[R]=this._gl.getUniformLocation(x,R)}for(k=["position","normal","color","lineDistance","offset","radius"],W=0;W<k.length;W++){var z=k[W];x.attributes[z]=this._gl.getAttribLocation(x,z)}return x.id=this._programs_counter++,this._programs.push({program:x,code:w,usedTimes:1}),this.info.memory.programs=this._programs.length,x}setProgram(f,v,y,D,E,p){if(D.needsUpdate&&(D.program&&this.deallocateMaterial(D),this.initMaterial(D,v,y,E),D.needsUpdate=!1),D.program==null)return null;var x=!1,w=D.program,C=w.uniforms,S=D.uniforms;if(w!=this._currentProgram&&(this._gl.useProgram(w),this._currentProgram=w,x=!0),D.id!=this._currentMaterialId&&(this._currentMaterialId=D.id,x=!0),f!=this._currentCamera&&(this._currentCamera=f,x=!0),C.projectionMatrix&&this._gl.uniformMatrix4fv(C.projectionMatrix,!1,f.projectionMatrix.elements),C.modelViewMatrix&&this._gl.uniformMatrix4fv(C.modelViewMatrix,!1,E._modelViewMatrix.elements),C.normalMatrix&&this._gl.uniformMatrix3fv(C.normalMatrix,!1,E._normalMatrix.elements),C.projinv&&(this._projInverse.getInverse(f.projectionMatrix),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements)),C.viewMatrix&&this._gl.uniformMatrix4fv(C.viewMatrix,!1,f.matrixWorldInverse.elements),C.vWidth&&this._gl.uniform1f(C.vWidth,this._viewportWidth),C.vHeight&&this._gl.uniform1f(C.vHeight,this._viewportHeight),x){if(S.fogColor.value=y.color,S.fogNear.value=y.near,S.fogFar.value=y.far,D.shaderID.startsWith("lambert")||D.shaderID==="instanced"||D.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(w,v),this._lightsNeedUpdate=!1),S.directionalLightColor.value=this._lights.directional.colors,S.directionalLightDirection.value=this._lights.directional.positions;else if(D.shaderID.endsWith("outline"))S.outlineColor.value=D.outlineColor,S.outlineWidth.value=D.outlineWidth,S.outlinePushback.value=D.outlinePushback,S.outlineMaxPixels.value=D.outlineMaxPixels*this.devicePixelRatio;else if(D.shaderID==="volumetric"){E._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(E._modelViewMatrix),this._projInverse.getInverse(f.projectionMatrix),this._textureMatrix.multiplyMatrices(E.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(C.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements);let A=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);S.step.value=E.material.unit*A,S.maxdepth.value=E.material.maxdepth*A,S.transfermax.value=E.material.transfermax,S.transfermin.value=E.material.transfermin,S.subsamples.value=E.material.subsamples,p.setTexture(E.material.transferfn,4,!1),p.setTexture(E.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}S.opacity.value=D.opacity,this.loadMaterialUniforms(C,S)}return S.shading&&(S.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),w}loadMaterialUniforms(f,v){var y,D,E,p;for(y in v)f[y]&&(D=v[y].type,E=v[y].value,p=f[y],D==="f"?this._gl.uniform1f(p,E):D==="i"?this._gl.uniform1i(p,E):D==="fv"?this._gl.uniform3fv(p,E):D==="c"?this._gl.uniform3f(p,E.r,E.g,E.b):D==="f4"&&this._gl.uniform4f(p,E[0],E[1],E[2],E[3]))}addObject(f,v){var y,D,E,p;if(!f.__webglInit&&(f.__webglInit=!0,f._modelViewMatrix=new h.Matrix4,f._normalMatrix=new h.Matrix3,f.geometry!==void 0&&f.geometry.__webglInit===void 0&&(f.geometry.__webglInit=!0,f.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),f instanceof u.Mesh||f instanceof u.Line))for(E=f.geometry,y=0,D=E.geometryGroups.length;y<D;y++)p=E.geometryGroups[y],p.id=this._geometryGroupCounter++,p.__webglVertexBuffer||(f instanceof u.Mesh?(this.createMeshBuffers(p),E.elementsNeedUpdate=!0,E.normalsNeedUpdate=!0):f instanceof u.Line&&this.createLineBuffers(p),E.verticesNeedUpdate=!0,E.colorsNeedUpdate=!0);if(!f.__webglActive){if(f instanceof u.Mesh||f instanceof u.Line)for(E=f.geometry,y=0,D=E.geometryGroups.length;y<D;y++)p=E.geometryGroups[y],this.addBuffer(v.__webglObjects,p,f);else f instanceof u.Sprite&&v.__webglSprites.push(f);f.__webglActive=!0}}updateObject(f){var v=f.geometry,y;if(f instanceof u.Mesh||f instanceof u.Line){for(var D=0,E=v.geometryGroups.length;D<E;D++)y=v.geometryGroups[D],(v.verticesNeedUpdate||v.elementsNeedUpdate||v.colorsNeedUpdate||v.normalsNeedUpdate)&&this.setBuffers(y,this._gl.STATIC_DRAW);v.verticesNeedUpdate=!1,v.elementsNeedUpdate=!1,v.normalsNeedUpdate=!1,v.colorsNeedUpdate=!1,v.buffersNeedUpdate=!1}}removeObject(f,v){f instanceof u.Mesh||f instanceof u.Line?this.removeInstances(v.__webglObjects,f):f instanceof u.Sprite&&this.removeInstancesDirect(v.__webglSprites,f),f.__webglActive=!1}removeInstances(f,v){for(var y=f.length-1;y>=0;--y)f[y].object===v&&f.splice(y,1)}removeInstancesDirect(f,v){for(var y=f.length-1;y>=0;--y)f[y]===v&&f.splice(y,1)}unrollBufferMaterial(f){var v=f.object,y=v.material;if(y.volumetric)f.opaque=null,f.transparent=null,f.volumetric=y;else if(y.transparent){if(f.opaque=null,f.volumetric=null,f.transparent=y,!y.wireframe){let D=y.clone();D.opacity=0,f.transparentDepth=D}}else{if(f.opaque=y,f.transparent=null,f.volumetric=null,!y.wireframe){let D=y.clone();D.opacity=0,f.opaqueDepth=D}y.hasAO&&(f.hasAO=!0),(this._AOEnabled||f.hasAO)&&(f.opaqueShaded=y.clone(),f.opaqueShaded.shaded=!0)}}setBuffers(f,v){var y=f.vertexArray,D=f.colorArray;if(f.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,f.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,v)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,f.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,v)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,f.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,D,v),f.normalArray&&f.__webglNormalBuffer!==void 0){var E=f.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,f.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,E,v)}if(f.radiusArray&&f.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,f.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,f.radiusArray,v)),f.faceArray&&f.__webglFaceBuffer!==void 0){var p=f.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,f.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,p,v)}if(f.lineArray&&f.__webglLineBuffer!==void 0){var x=f.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,x,v)}}createMeshBuffers(f){f.radiusArray&&(f.__webglRadiusBuffer=this._gl.createBuffer()),f.useOffset&&(f.__webglOffsetBuffer=this._gl.createBuffer()),f.__webglVertexBuffer=this._gl.createBuffer(),f.__webglNormalBuffer=this._gl.createBuffer(),f.__webglColorBuffer=this._gl.createBuffer(),f.__webglFaceBuffer=this._gl.createBuffer(),f.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(f){f.__webglVertexBuffer=this._gl.createBuffer(),f.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(f,v,y){f.push({buffer:v,object:y,opaque:null,transparent:null})}setupMatrices(f,v){f._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,f.matrixWorld),f._normalMatrix.getInverse(f._modelViewMatrix),f._normalMatrix.transpose()}filterFallback(f){return this._gl.LINEAR}setTextureParameters(f,v){f==this._gl.TEXTURE_2D?(this._gl.texParameteri(f,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(f,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(f,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(v.magFilter)),this._gl.texParameteri(f,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(v.minFilter))):(this._gl.texParameteri(f,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(f,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(f,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(f,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(f,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(f,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(f,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(f){return f===s.UnsignedByteType?this._gl.UNSIGNED_BYTE:f===s.RGBAFormat?this._gl.RGBA:f===s.NearestFilter?this._gl.NEAREST:0}setupLights(f,v){var y,D,E,p=0,x=0,w=0,C,S,A=this._lights,P=A.directional.colors,O=A.directional.positions,F=0,I=0;for(y=0,D=v.length;y<D;y++)if(E=v[y],C=E.color,S=E.intensity,E instanceof o.Light){if(this._direction.getPositionFromMatrix(E.matrixWorld),this._vector3.getPositionFromMatrix(E.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;O[I]=this._direction.x,O[I+1]=this._direction.y,O[I+2]=this._direction.z,P[I]=C.r*S,P[I+1]=C.g*S,P[I+2]=C.b*S,I+=3,F++}A.ambient[0]=p,A.ambient[1]=x,A.ambient[2]=w,A.directional.length=F}initGL(){try{if(OffscreenCanvas&&!(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null))(b==null||b.isContextLost())&&(_=new OffscreenCanvas(this._canvas.width,this._canvas.height),b=_.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=_,this._gl=b,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});else if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var f=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(f[6])}catch(v){console.error(v)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(f,v,y,D,E,p,x){var w,C,S,A,P,O,F;v?(P=f.length-1,O=-1,F=-1):(P=0,O=f.length,F=1);for(var I=P;I!==O;I+=F)if(w=f[I],w.render){if(C=w.object,S=w.buffer,A=w[y],(w.hasAO||this._AOEnabled)&&w[y+"Shaded"]&&(A=w[y+"Shaded"]),!A)continue;this.setBlending(x),this.setDepthTest(A.depthTest),this.setDepthWrite(A.depthWrite),this.setPolygonOffset(A.polygonOffset,A.polygonOffsetFactor,A.polygonOffsetUnits);var B=C._modelViewMatrix.isReflected();if(this.setMaterialFaces(A,B),this.renderBuffer(D,E,p,A,S,C),(this._outlineEnabled||A.outline)&&!A.wireframe&&A.shaderID!=="basic"&&A.opacity!==0){let k=this._outlineMaterial;A.shaderID=="sphereimposter"?k=this._outlineSphereImposterMaterial:A.shaderID=="stickimposter"&&(k=this._outlineStickImposterMaterial),this.renderBuffer(D,E,p,k,S,C)}}}renderSprites(f,v,y){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(f,v,this._currentWidth,this._currentHeight,y),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},"./src/WebGL/SpritePlugin.ts":(r,e,t)=>{t.r(e),t.d(e,{SpritePlugin:()=>n});var i=t("./src/WebGL/shaders/index.ts");class n{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(a){this.gl=a.context,this.renderer=a,this.precision=a.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var l=0;this.sprite.vertices[l++]=-1,this.sprite.vertices[l++]=-1,this.sprite.vertices[l++]=0,this.sprite.vertices[l++]=0,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=-1,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=0,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=-1,this.sprite.vertices[l++]=1,this.sprite.vertices[l++]=0,this.sprite.vertices[l++]=1,l=0,this.sprite.faces[l++]=0,this.sprite.faces[l++]=1,this.sprite.faces[l++]=2,this.sprite.faces[l++]=0,this.sprite.faces[l++]=2,this.sprite.faces[l++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(i.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const h={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),h.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),h.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),h.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),h.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),h.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),h.color=this.gl.getUniformLocation(this.sprite.program,"color"),h.map=this.gl.getUniformLocation(this.sprite.program,"map"),h.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),h.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),h.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),h.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),h.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),h.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),h.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),h.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),h.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=h}render(a,l,h,u,g){var m,_,b,d,c,f,v,y,D,E;if(!this.gl)throw new Error("WebGLRenderer not initialized");let p=[];(m=a==null?void 0:a.__webglSprites)===null||m===void 0||m.forEach(R=>{(g&&R.material.depthTest==!1||!g&&R.material.depthTest)&&p.push(R)});let x=p.length;if(!x)return;const w=this.sprite.attributes,C=this.sprite.uniforms;if(!C)throw new Error("Uniforms not defined");var S=h*.5,A=u*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(w.position),this.gl.enableVertexAttribArray(w.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(w.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(w.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(C.projectionMatrix,!1,l.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(C.map,0);var P=a.fog;P?(this.gl.uniform3f(C.fogColor,P.color.r,P.color.g,P.color.b),this.gl.uniform1f(C.fogNear,P.near),this.gl.uniform1f(C.fogFar,P.far)):(this.gl.uniform1f(C.fogNear,0),this.gl.uniform1f(C.fogFar,0));var O;let F,I,B,k=[];for(O=0;O<x;O++)F=p[O],I=F.material,I&&(I.depthTest==!1&&!g||!F.visible||I.opacity===0||(I.useScreenCoordinates?F.z=-F.position.z:(F._modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,F.matrixWorld),F.z=-F._modelViewMatrix.elements[14])));for(p.sort(s),O=0;O<x;O++)if(F=p[O],I=F.material,!!I&&!(!F.visible||I.opacity===0)&&I.map&&I.map.image&&I.map.image.width){this.gl.uniform1f((C==null?void 0:C.alphaTest)||null,I.alphaTest);var U=I.map.image.width,W=I.map.image.height;k[0]=U*this.renderer.devicePixelRatio/h,k[1]=W*this.renderer.devicePixelRatio/u,I.useScreenCoordinates===!0?(this.gl.uniform1i(C.useScreenCoordinates,1),this.gl.uniform3f(C.screenPosition,(F.position.x*this.renderer.devicePixelRatio-S)/S,(A-F.position.y*this.renderer.devicePixelRatio)/A,Math.max(0,Math.min(1,F.position.z)))):(this.gl.uniform1i(C.useScreenCoordinates,0),this.gl.uniformMatrix4fv(C.modelViewMatrix,!1,F._modelViewMatrix.elements)),B=1/(I.scaleByViewport?u:1),k[0]*=B*F.scale.x,k[1]*=B*F.scale.y;let R=(_=I==null?void 0:I.alignment)===null||_===void 0?void 0:_.x,z=(b=I==null?void 0:I.alignment)===null||b===void 0?void 0:b.y;I.screenOffset&&(R=(R||0)+2*I.screenOffset.x/U,z=(z||0)+2*I.screenOffset.y/W),this.gl.uniform2f(C.uvScale,((d=I==null?void 0:I.uvScale)===null||d===void 0?void 0:d.x)||1,((c=I==null?void 0:I.uvScale)===null||c===void 0?void 0:c.y)||1),this.gl.uniform2f(C.uvOffset,((f=I==null?void 0:I.uvOffset)===null||f===void 0?void 0:f.x)||0,((v=I==null?void 0:I.uvOffset)===null||v===void 0?void 0:v.y)||0),this.gl.uniform2f(C.alignment,R||0,z||0),this.gl.uniform1f(C.opacity,I.opacity),this.gl.uniform3f(C.color,((y=I==null?void 0:I.color)===null||y===void 0?void 0:y.r)||0,((D=I==null?void 0:I.color)===null||D===void 0?void 0:D.g)||0,((E=I==null?void 0:I.color)===null||E===void 0?void 0:E.b)||0),this.gl.uniform1f(C.rotation,F.rotation),this.gl.uniform2fv(C.scale,k),this.renderer.setDepthTest(I.depthTest),this.renderer.setDepthWrite(I.depthWrite),this.renderer.setTexture(I.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(a,l){if(!this.gl)throw new Error("WebGL Rendering context not found");var h=this.gl.createProgram();if(!h)throw new Error("Error creating webgl program");var u=this.gl.createShader(this.gl.FRAGMENT_SHADER),g=this.gl.createShader(this.gl.VERTEX_SHADER);if(!u)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!g)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var m="precision "+l+` float;
`;if(this.gl.shaderSource(u,m+a.fragmentShader),this.gl.shaderSource(g,m+a.vertexShader),this.gl.compileShader(u),this.gl.compileShader(g),!this.gl.getShaderParameter(u,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(g,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(u)} 
      ${this.gl.getShaderInfoLog(g)}`);return this.gl.attachShader(h,u),this.gl.attachShader(h,g),this.gl.linkProgram(h),this.gl.getProgramParameter(h,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),h}}function s(o,a){return o.z!==a.z?a.z-o.z:a.id-o.id}},"./src/WebGL/constants/Coloring.ts":(r,e,t)=>{t.r(e),t.d(e,{Coloring:()=>i});var i;(function(n){n[n.NoColors=0]="NoColors",n[n.FaceColors=1]="FaceColors",n[n.VertexColors=2]="VertexColors"})(i||(i={}))},"./src/WebGL/constants/Shading.ts":(r,e,t)=>{t.r(e),t.d(e,{Shading:()=>i});var i;(function(n){n[n.NoShading=0]="NoShading",n[n.FlatShading=1]="FlatShading",n[n.SmoothShading=2]="SmoothShading"})(i||(i={}))},"./src/WebGL/constants/Sides.ts":(r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>n,DoubleSide:()=>s,FrontSide:()=>i});const i=0,n=1,s=2},"./src/WebGL/constants/SpriteAlignment.ts":(r,e,t)=>{t.r(e),t.d(e,{SpriteAlignment:()=>n});var i=t("./src/WebGL/math/index.ts");const n={topLeft:new i.Vector2(1,-1),topCenter:new i.Vector2(0,-1),topRight:new i.Vector2(-1,-1),centerLeft:new i.Vector2(1,0),center:new i.Vector2(0,0),centerRight:new i.Vector2(-1,0),bottomLeft:new i.Vector2(1,1),bottomCenter:new i.Vector2(0,1),bottomRight:new i.Vector2(-1,1)}},"./src/WebGL/constants/TextureConstants.ts":(r,e,t)=>{t.r(e),t.d(e,{ClampToEdgeWrapping:()=>i,FloatType:()=>l,LinearFilter:()=>n,LinearMipMapLinearFilter:()=>o,NearestFilter:()=>s,R32Format:()=>g,RFormat:()=>u,RGBAFormat:()=>h,UnsignedByteType:()=>a});const i=1001,n=1006,s=1007,o=1008,a=1009,l=1010,h=1021,u=1022,g=1023},"./src/WebGL/constants/TextureOperations.ts":(r,e,t)=>{t.r(e),t.d(e,{TextureOperations:()=>i});var i;(function(n){n[n.MultiplyOperation=0]="MultiplyOperation",n[n.MixOperation=1]="MixOperation",n[n.AddOperation=2]="AddOperation"})(i||(i={}))},"./src/WebGL/constants/index.ts":(r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>n.BackSide,ClampToEdgeWrapping:()=>a.ClampToEdgeWrapping,Coloring:()=>i.Coloring,DoubleSide:()=>n.DoubleSide,FloatType:()=>a.FloatType,FrontSide:()=>n.FrontSide,LinearFilter:()=>a.LinearFilter,LinearMipMapLinearFilter:()=>a.LinearMipMapLinearFilter,NearestFilter:()=>a.NearestFilter,R32Format:()=>a.R32Format,RFormat:()=>a.RFormat,RGBAFormat:()=>a.RGBAFormat,Shading:()=>s.Shading,SpriteAlignment:()=>o.SpriteAlignment,TextureOperations:()=>l.TextureOperations,UnsignedByteType:()=>a.UnsignedByteType});var i=t("./src/WebGL/constants/Coloring.ts"),n=t("./src/WebGL/constants/Sides.ts"),s=t("./src/WebGL/constants/Shading.ts"),o=t("./src/WebGL/constants/SpriteAlignment.ts"),a=t("./src/WebGL/constants/TextureConstants.ts"),l=t("./src/WebGL/constants/TextureOperations.ts")},"./src/WebGL/core/EventDispatcher.ts":(r,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>i});class i{constructor(){this.listeners={}}dispatchEvent(s){var o=this.listeners[s.type];if(o!==void 0){s.target=this;for(var a=0,l=o.length;a<l;a++)o[a].call(this,s)}}removeEventListener(s,o){if(!o)this.listeners[s]=[];else{var a=this.listeners[s].indexOf(o);a!==-1&&this.listeners[s].splice(a,1)}}addEventListener(s,o){this.listeners[s]===void 0&&(this.listeners[s]=[]),this.listeners[s].indexOf(o)===-1&&this.listeners[s].push(o)}}},"./src/WebGL/core/Geometry.ts":(r,e,t)=>{t.r(e),t.d(e,{Geometry:()=>h,GeometryGroup:()=>l,GeometryIDCount:()=>u});var i=t("./src/WebGL/materials/LineBasicMaterial.ts"),n=t("./src/WebGL/core/EventDispatcher.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts");const a=65535;class l{constructor(m=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=m}setColor(m){var _=this.vertexArray,b=this.colorArray;if(!_)throw new Error("vertex array not initialized");if(!b)throw new Error("color array not initialized");let d=o.CC.color(m);for(var c=0;c<_.length;c+=3)b[c]=d.r,b[c+1]=d.g,b[c+2]=d.b}setColors(m){var _=this.vertexArray,b=this.colorArray;if(!_)throw new Error("vertex array not initialized");if(!b)throw new Error("color array not initialized");if(_.length!=b.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var d=0;d<_.length;d+=3){var c=m(_[d],_[d+1],_[d+2]);c instanceof o.Color||(c=o.CC.color(c)),b[d]=c.r,b[d+1]=c.g,b[d+2]=c.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var m=new s.Vector3,_,b,d,c,f=0;f<this.vertices;++f)_=f*3,b=this.vertexArray[_],d=this.vertexArray[_+1],c=this.vertexArray[_+2],m.x+=b,m.y+=d,m.z+=c;return m.divideScalar(this.vertices),m}setNormals(){var m=this.faceArray,_=this.vertexArray,b=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!m)throw new Error("face array not initialized");if(!_)throw new Error("vertex array not initialized");if(!b)throw new Error("normal array not initialized");for(var d,c,f,v,y,D,E,p=0;p<m.length/3;++p)d=m[p*3]*3,c=m[p*3+1]*3,f=m[p*3+2]*3,v=new s.Vector3(_[d],_[d+1],_[d+2]),y=new s.Vector3(_[c],_[c+1],_[c+2]),D=new s.Vector3(_[f],_[f+1],_[f+2]),v.subVectors(v,y),D.subVectors(D,y),D.cross(v),E=D,E.normalize(),b[d]+=E.x,b[c]+=E.x,b[f]+=E.x,b[d+1]+=E.y,b[c+1]+=E.y,b[f+1]+=E.y,b[d+2]+=E.z,b[c+2]+=E.z,b[f+2]+=E.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var m=this.faceArray,_=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!m)throw new Error("face array not initialized");for(var b=0;b<this.faceidx/3;++b){var d=b*3,c=d*2,f=m[d],v=m[d+1],y=m[d+2];_[c]=f,_[c+1]=v,_[c+2]=f,_[c+3]=y,_[c+4]=v,_[c+5]=y}}}vrml(m,_){var b,d,c,f,v,y,D,E,p,x,w,C,S,A,P,O,F,I,B="";if(B+=m+`Shape {
`+m+` appearance Appearance {
`+m+`  material Material {
`+m+"   diffuseColor "+((b=_==null?void 0:_.color)===null||b===void 0?void 0:b.r)+" "+((d=_==null?void 0:_.color)===null||d===void 0?void 0:d.g)+" "+((c=_==null?void 0:_.color)===null||c===void 0?void 0:c.b)+`
`,_.wireframe&&this.colorArray){let U=this.colorArray;B+=m+"    emissiveColor "+U[0]+" "+U[1]+" "+U[2]+`
`}_!=null&&_.transparent&&(B+=m+"   transparency "+(1-_.opacity)+`
`),B+=m+`  }
`,B+=m+` }
`;var k=m;if(m+=" ",_ instanceof i.LineBasicMaterial||_.wireframe){B+=m+`geometry IndexedLineSet {
`+m+` colorPerVertex TRUE
`+m+` coord Coordinate {
`+m+`  point [
`;let U,W,R;for(let z=0;z<this.vertices;++z){let V=z*3;U=(f=this.vertexArray)===null||f===void 0?void 0:f[V],W=(v=this.vertexArray)===null||v===void 0?void 0:v[V+1],R=(y=this.vertexArray)===null||y===void 0?void 0:y[V+2],B+=m+"   "+U+" "+W+" "+R+`,
`}if(B+=m+`  ]
`,B+=m+` }
`,this.colorArray&&!_.wireframe){B+=m+` color Color {
`+m+`  color [
`;for(let z=0;z<this.vertices;++z){let V=z*3;U=this.colorArray[V],W=this.colorArray[V+1],R=this.colorArray[V+2],B+=m+"   "+U+" "+W+" "+R+`,
`}B+=m+`  ]
`,B+=m+` }
`}if(B+=m+` coordIndex [
`,_.wireframe&&this.faceArray)for(let z=0;z<this.faceidx;z+=3)U=(D=this.faceArray)===null||D===void 0?void 0:D[z],W=(E=this.faceArray)===null||E===void 0?void 0:E[z+1],R=(p=this.faceArray)===null||p===void 0?void 0:p[z+2],B+=m+"  "+U+", "+W+", "+R+`, -1,
`;else for(let z=0;z<this.vertices-1;z+=2)B+=m+"  "+z+", "+(z+1)+`, -1,
`;B+=m+` ]
`,B+=m+`}
`}else{B+=m+`geometry IndexedFaceSet {
`+m+` colorPerVertex TRUE
`+m+` normalPerVertex TRUE
`+m+` solid FALSE
`,B+=m+` coord Coordinate {
`+m+`  point [
`;let U,W,R;for(let z=0;z<this.vertices;++z){let V=z*3;U=(x=this.vertexArray)===null||x===void 0?void 0:x[V],W=(w=this.vertexArray)===null||w===void 0?void 0:w[V+1],R=(C=this.vertexArray)===null||C===void 0?void 0:C[V+2],B+=m+"   "+U+" "+W+" "+R+`,
`}B+=m+`  ]
`,B+=m+` }
`,B+=m+` normal Normal {
`+m+`  vector [
`;for(let z=0;z<this.vertices;++z){let V=z*3;U=(S=this.normalArray)===null||S===void 0?void 0:S[V],W=(A=this.normalArray)===null||A===void 0?void 0:A[V+1],R=(P=this.normalArray)===null||P===void 0?void 0:P[V+2],B+=m+"   "+U+" "+W+" "+R+`,
`}if(B+=m+`  ]
`,B+=m+` }
`,this.colorArray){B+=m+` color Color {
`+m+`  color [
`;for(let z=0;z<this.vertices;++z){let V=z*3;U=this.colorArray[V],W=this.colorArray[V+1],R=this.colorArray[V+2],B+=m+"   "+U+" "+W+" "+R+`,
`}B+=m+`  ]
`,B+=m+` }
`}B+=m+` coordIndex [
`;for(let z=0;z<this.faceidx;z+=3)U=(O=this.faceArray)===null||O===void 0?void 0:O[z],W=(F=this.faceArray)===null||F===void 0?void 0:F[z+1],R=(I=this.faceArray)===null||I===void 0?void 0:I[z+2],B+=m+"  "+U+", "+W+", "+R+`, -1,
`;B+=m+` ]
`,B+=m+`}
`}return B+=k+"}",B}truncateArrayBuffers(m=!0,_=!1){var b=this.vertexArray,d=this.colorArray,c=this.normalArray,f=this.faceArray,v=this.lineArray,y=this.radiusArray;this.vertexArray=(b==null?void 0:b.subarray(0,this.vertices*3))||null,this.colorArray=(d==null?void 0:d.subarray(0,this.vertices*3))||null,m?(this.normalArray=(c==null?void 0:c.subarray(0,this.vertices*3))||null,this.faceArray=(f==null?void 0:f.subarray(0,this.faceidx))||null,this.lineidx>0?this.lineArray=(v==null?void 0:v.subarray(0,this.lineidx))||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),y&&(this.radiusArray=y.subarray(0,this.vertices)),_&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class h extends n.EventDispatcher{constructor(m=!1,_=!1,b=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=u++,this.mesh=m,this.radii=_,this.offset=b}updateGeoGroup(m=0){var _,b=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!b||b.vertices+m>(((_=b==null?void 0:b.vertexArray)===null||_===void 0?void 0:_.length)||0)/3)&&(b=this.addGeoGroup()),b}vrml(m,_){for(var b="",d=this.geometryGroups.length,c=0;c<d;c++){var f=this.geometryGroups[c];b+=f.vrml(m,_)+`,
`}return b}addGeoGroup(){var m=new l(this.geometryGroups.length);return this.geometryGroups.push(m),this.groups=this.geometryGroups.length,m.vertexArray=new Float32Array(a*3),m.colorArray=new Float32Array(a*3),this.mesh&&(m.normalArray=new Float32Array(a*3),m.faceArray=new Uint16Array(a*6),m.lineArray=new Uint16Array(a*6)),this.radii&&(m.radiusArray=new Float32Array(a)),m.useOffset=this.offset,m}setUpNormals(...m){for(var _=0;_<this.groups;_++){var b=this.geometryGroups[_];b.setNormals(...m)}}setColors(...m){for(var _=this.geometryGroups.length,b=0;b<_;b++){var d=this.geometryGroups[b];d.setColors(...m)}}setColor(...m){let _=this.geometryGroups.length;for(var b=0;b<_;b++){var d=this.geometryGroups[b];d.setColor(...m)}}setUpWireframe(...m){let _=this.geometryGroups.length;for(var b=0;b<_;b++){var d=this.geometryGroups[b];d.setLineIndices(...m)}}initTypedArrays(){for(var m=0;m<this.groups;m++){var _=this.geometryGroups[m];_.__inittedArrays!==!0&&_.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var m=0,_=0;_<this.groups;_++)m+=this.geometryGroups[_].vertices;return m}}let u=0},"./src/WebGL/core/Object3D.ts":(r,e,t)=>{t.r(e),t.d(e,{Light:()=>l,Object3D:()=>o,Object3DIDCount:()=>s,Scene:()=>a});var i=t("./src/WebGL/math/index.ts"),n=t("./src/colors.ts");let s=0;class o{constructor(){this.id=s++,this.name="",this.children=[],this.position=new i.Vector3,this.rotation=new i.Vector3,this.matrix=new i.Matrix4,this.matrixWorld=new i.Matrix4,this.quaternion=new i.Quaternion,this.eulerOrder="XYZ",this.up=new i.Vector3(0,1,0),this.scale=new i.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(u){this.matrix.lookAt(u,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof i.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(u){if(u===this){console.error("Can't add $3Dmol.Object3D to itself");return}u.parent=this,this.children.push(u);for(var g=this;g.parent!==void 0;)g=g.parent;g!==void 0&&g instanceof a&&g.__addObject(u)}remove(u){var g=this.children.indexOf(u);if(g!==-1){u.parent=void 0,this.children.splice(g,1);for(var m=this;m.parent!==void 0;)m=m.parent;m!==void 0&&m instanceof a&&m.__removeObject(u)}}vrml(u){u||(u=" ");var g=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),m=0,_=0,b=0;if(g!=0){let f=Math.sin(g/2);m=this.quaternion.x/f,_=this.quaternion.y/f,b=this.quaternion.z/f}var d=u+`Transform {
`+u+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+u+" rotation "+m+" "+_+" "+b+" "+g+`
`+u+` children [
`;this.geometry&&(d+=this.geometry.vrml(u,this.material));for(var c=0;c<this.children.length;c++)d+=this.children[c].vrml(u+" ")+`,
`;return d+=` ]
`,d+="}",d}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof i.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(u){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||u===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var g=0;g<this.children.length;g++)this.children[g].updateMatrixWorld(!0)}clone(u){u===void 0&&(u=new o),u.name=this.name,u.up.copy(this.up),u.position.copy(this.position),u.rotation instanceof i.Vector3&&this.rotation instanceof i.Vector3?u.rotation.copy(this.rotation):u.rotation=this.rotation,u.eulerOrder=this.eulerOrder,u.scale.copy(this.scale),u.rotationAutoUpdate=this.rotationAutoUpdate,u.matrix.copy(this.matrix),u.matrixWorld.copy(this.matrixWorld),u.quaternion.copy(this.quaternion),u.matrixAutoUpdate=this.matrixAutoUpdate,u.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,u.useQuaternion=this.useQuaternion,u.visible=this.visible;for(var g=0;g<this.children.length;g++){var m=this.children[g];u.add(m.clone())}return u}setVisible(u){this.visible=u;for(var g=0;g<this.children.length;g++){var m=this.children[g];m.setVisible(u)}}}class a extends o{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(u){if(u instanceof l)this.__lights.indexOf(u)===-1&&this.__lights.push(u),u.target&&u.target.parent===void 0&&this.add(u.target);else if(this.__objects.indexOf(u)===-1){this.__objects.push(u),this.__objectsAdded.push(u);var g=this.__objectsRemoved.indexOf(u);g!==-1&&this.__objectsRemoved.splice(g,1)}for(var m=0;m<u.children.length;m++)this.__addObject(u.children[m])}__removeObject(u){var g;if(u instanceof l)g=this.__lights.indexOf(u),g!==-1&&this.__lights.splice(g,1);else if(g=this.__objects.indexOf(u),g!==-1){this.__objects.splice(g,1),this.__objectsRemoved.push(u);var m=this.__objectsAdded.indexOf(u);m!==-1&&this.__objectsAdded.splice(g,1)}for(var _=0;_<u.children.length;_++)this.__removeObject(u.children[_])}}class l extends o{constructor(u,g=1){super(),this.position=new i.Vector3(0,1,0),this.target=new o,this.castShadow=!1,this.onlyShadow=!1,this.color=new n.Color(u),this.intensity=g}}},"./src/WebGL/core/Projector.ts":(r,e,t)=>{t.r(e),t.d(e,{Projector:()=>s});var i=t("./src/WebGL/math/index.ts");const n=new i.Matrix4;class s{static unprojectVector(a,l){return l.projectionMatrixInverse.getInverse(l.projectionMatrix),n.multiplyMatrices(l.matrixWorld,l.projectionMatrixInverse),a.applyProjection(n)}static projectVector(a,l){return l.matrixWorldInverse.getInverse(l.matrixWorld),n.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),a.applyProjection(n)}projectVector(a,l){return s.projectVector(a,l)}unprojectVector(a,l){return s.unprojectVector(a,l)}}},"./src/WebGL/core/Raycaster.ts":(r,e,t)=>{t.r(e),t.d(e,{Raycaster:()=>a,intersectObject:()=>f});var i=t("./src/WebGL/math/index.ts"),n=t("./src/WebGL/shapes/index.ts");const s=(v,y)=>v.distance-y.distance,o=new i.Matrix4;class a{constructor(y,D,E,p){this.precision=1e-4,this.linePrecision=.2,this.ray=new i.Ray(y,D),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=p||0,this.far=E||1/0}set(y,D){this.ray.set(y,D)}setFromCamera(y,D){D.ortho?(this.ray.origin.set(y.x,y.y,(D.near+D.far)/(D.near-D.far)).unproject(D),this.ray.direction.set(0,0,-1).transformDirection(D.matrixWorld)):(this.ray.origin.setFromMatrixPosition(D.matrixWorld),this.ray.direction.set(y.x,y.y,y.z),D.projectionMatrixInverse.getInverse(D.projectionMatrix),o.multiplyMatrices(D.matrixWorld,D.projectionMatrixInverse),this.ray.direction.applyProjection(o),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(y,D){for(var E=[],p=0,x=D.length;p<x;p++)f(y,D[p],this,E);return E.sort(s),E}}const l=v=>Math.min(Math.max(v,-1),1);var h=new n.Sphere,u=new n.Cylinder,g=new n.Triangle,m=new i.Vector3,_=new i.Vector3,b=new i.Vector3,d=new i.Vector3,c=new i.Vector3;function f(v,y,D,E){if(c.getPositionFromMatrix(v.matrixWorld),y.intersectionShape===void 0)return E;var p=y.intersectionShape,x=D.linePrecision;x*=v.matrixWorld.getMaxScaleOnAxis();var w=x*x;if(y.boundingSphere!==void 0&&y.boundingSphere instanceof n.Sphere&&(h.copy(y.boundingSphere),h.applyMatrix4(v.matrixWorld),!D.ray.isIntersectionSphere(h)))return E;var C,S,A,P,O,F,I,B,k,U,W,R,z,V;for(C=0,S=p.triangle.length;C<S;C++)if(p.triangle[C]instanceof n.Triangle){if(g.copy(p.triangle[C]),g.applyMatrix4(v.matrixWorld),A=g.getNormal(),P=D.ray.direction.dot(A),P>=0||(m.subVectors(g.a,D.ray.origin),I=A.dot(m)/P,I<0))continue;_.copy(D.ray.direction).multiplyScalar(I).add(D.ray.origin),_.sub(g.a),b.copy(g.b).sub(g.a),d.copy(g.c).sub(g.a);var q=b.dot(d),Q=b.lengthSq(),re=d.lengthSq();if(R=(Q*_.dot(d)-q*_.dot(b))/(Q*re-q*q),R<0||R>1||(W=(_.dot(b)-R*q)/Q,W<0||W>1||W+R>1))continue;E.push({clickable:y,distance:I})}for(C=0,S=p.cylinder.length;C<S;C++)if(p.cylinder[C]instanceof n.Cylinder){if(u.copy(p.cylinder[C]),u.applyMatrix4(v.matrixWorld),m.subVectors(u.c1,D.ray.origin),O=m.dot(u.direction),F=m.dot(D.ray.direction),P=l(D.ray.direction.dot(u.direction)),k=1-P*P,k===0)continue;z=(P*F-O)/k,V=(F-P*O)/k,_.copy(u.direction).multiplyScalar(z).add(u.c1),b.copy(D.ray.direction).multiplyScalar(V).add(D.ray.origin),B=d.subVectors(_,b).lengthSq();var te=u.radius*u.radius;if(B<=te){if(U=(P*O-F)*(P*O-F)-k*(m.lengthSq()-O*O-te),U<=0?R=I=Math.sqrt(B):R=I=(F-P*O-Math.sqrt(U))/k,W=P*R-O,W<0||W*W>u.lengthSq()||R<0)continue;E.push({clickable:y,distance:I})}}for(C=0,S=p.line.length;C<S;C+=2){_.copy(p.line[C]),_.applyMatrix4(v.matrixWorld),b.copy(p.line[C+1]),b.applyMatrix4(v.matrixWorld),d.subVectors(b,_);var ae=d.lengthSq();d.normalize(),m.subVectors(_,D.ray.origin);var ne=m.dot(d);F=m.dot(D.ray.direction),P=l(D.ray.direction.dot(d)),k=1-P*P,k!==0&&(z=(P*F-ne)/k,V=(F-P*ne)/k,_.add(d.multiplyScalar(z)),b.copy(D.ray.direction).multiplyScalar(V).add(D.ray.origin),B=d.subVectors(b,_).lengthSq(),B<w&&z*z<ae&&E.push({clickable:y,distance:V}))}for(C=0,S=p.sphere.length;C<S;C++)if(p.sphere[C]instanceof n.Sphere&&(h.copy(p.sphere[C]),h.applyMatrix4(v.matrixWorld),D.ray.isIntersectionSphere(h))){_.subVectors(h.center,D.ray.origin);var le=_.dot(D.ray.direction);if(U=le*le-(_.lengthSq()-h.radius*h.radius),le<0)return E;U<=0?I=le:I=le-Math.sqrt(U),E.push({clickable:y,distance:I})}return E}},"./src/WebGL/core/Texture.ts":(r,e,t)=>{t.r(e),t.d(e,{Texture:()=>a,TextureIdCount:()=>l});var i=t("./src/WebGL/constants/TextureConstants.ts"),n=t("./src/WebGL/math/index.ts"),s=t("./src/WebGL/core/EventDispatcher.ts"),o=t("./src/WebGL/core/UVMapping.ts");class a extends s.EventDispatcher{constructor(u,g){super(),this.id=l++,this.name="",this.image=u,this.mapping=new o.UVMapping,this.wrapS=i.ClampToEdgeWrapping,this.wrapT=i.ClampToEdgeWrapping,this.anisotropy=1,g?(this.format=i.RFormat,this.type=i.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=i.NearestFilter,this.minFilter=i.NearestFilter):(this.format=i.RGBAFormat,this.type=i.UnsignedByteType,this.offset=new n.Vector2(0,0),this.repeat=new n.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=i.LinearFilter,this.minFilter=i.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(u=new a){return u.image=this.image,u.mapping=this.mapping,u.wrapS=this.wrapS,u.wrapT=this.wrapT,u.magFilter=this.magFilter,u.minFilter=this.minFilter,u.anisotropy=this.anisotropy,u.format=this.format,u.type=this.type,u.offset.copy(this.offset),u.repeat.copy(this.repeat),u.premultiplyAlpha=this.premultiplyAlpha,u.flipY=this.flipY,u.unpackAlignment=this.unpackAlignment,u}dispose(){this.dispatchEvent({type:"dispose"})}}let l=0},"./src/WebGL/core/UVMapping.ts":(r,e,t)=>{t.r(e),t.d(e,{UVMapping:()=>i});class i{}},"./src/WebGL/core/index.ts":(r,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>i.EventDispatcher,Geometry:()=>n.Geometry,GeometryGroup:()=>n.GeometryGroup,GeometryIDCount:()=>n.GeometryIDCount,Light:()=>s.Light,Object3D:()=>s.Object3D,Object3DIDCount:()=>s.Object3DIDCount,Projector:()=>o.Projector,Raycaster:()=>a.Raycaster,Scene:()=>s.Scene,Texture:()=>l.Texture,TextureIdCount:()=>l.TextureIdCount,UVMapping:()=>h.UVMapping,intersectObject:()=>a.intersectObject});var i=t("./src/WebGL/core/EventDispatcher.ts"),n=t("./src/WebGL/core/Geometry.ts"),s=t("./src/WebGL/core/Object3D.ts"),o=t("./src/WebGL/core/Projector.ts"),a=t("./src/WebGL/core/Raycaster.ts"),l=t("./src/WebGL/core/Texture.ts"),h=t("./src/WebGL/core/UVMapping.ts")},"./src/WebGL/index.ts":(r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>i.BackSide,Camera:()=>u.Camera,ClampToEdgeWrapping:()=>i.ClampToEdgeWrapping,Coloring:()=>i.Coloring,Cylinder:()=>h.Cylinder,DoubleSide:()=>i.DoubleSide,EventDispatcher:()=>n.EventDispatcher,FloatType:()=>i.FloatType,Fog:()=>g.Fog,FrontSide:()=>i.FrontSide,Geometry:()=>n.Geometry,GeometryGroup:()=>n.GeometryGroup,GeometryIDCount:()=>n.GeometryIDCount,ImposterMaterial:()=>s.ImposterMaterial,InstancedMaterial:()=>s.InstancedMaterial,Light:()=>n.Light,Line:()=>a.Line,LineBasicMaterial:()=>s.LineBasicMaterial,LineStyle:()=>a.LineStyle,LinearFilter:()=>i.LinearFilter,LinearMipMapLinearFilter:()=>i.LinearMipMapLinearFilter,Material:()=>s.Material,MaterialIdCount:()=>s.MaterialIdCount,Matrix3:()=>o.Matrix3,Matrix4:()=>o.Matrix4,Mesh:()=>a.Mesh,MeshDoubleLambertMaterial:()=>s.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>s.MeshLambertMaterial,MeshOutlineMaterial:()=>s.MeshOutlineMaterial,NearestFilter:()=>i.NearestFilter,Object3D:()=>n.Object3D,Object3DIDCount:()=>n.Object3DIDCount,Projector:()=>n.Projector,Quaternion:()=>o.Quaternion,R32Format:()=>i.R32Format,RFormat:()=>i.RFormat,RGBAFormat:()=>i.RGBAFormat,Ray:()=>o.Ray,Raycaster:()=>n.Raycaster,Renderer:()=>m.Renderer,Scene:()=>n.Scene,ShaderLib:()=>l.ShaderLib,ShaderUtils:()=>l.ShaderUtils,Shading:()=>i.Shading,Sphere:()=>h.Sphere,SphereImposterMaterial:()=>s.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>s.SphereImposterOutlineMaterial,Sprite:()=>a.Sprite,SpriteAlignment:()=>i.SpriteAlignment,SpriteMaterial:()=>s.SpriteMaterial,SpritePlugin:()=>_.SpritePlugin,StickImposterMaterial:()=>s.StickImposterMaterial,StickImposterOutlineMaterial:()=>s.StickImposterOutlineMaterial,Texture:()=>n.Texture,TextureIdCount:()=>n.TextureIdCount,TextureOperations:()=>i.TextureOperations,Triangle:()=>h.Triangle,UVMapping:()=>n.UVMapping,UnsignedByteType:()=>i.UnsignedByteType,Vector2:()=>o.Vector2,Vector3:()=>o.Vector3,VolumetricMaterial:()=>s.VolumetricMaterial,basic:()=>l.basic,clamp:()=>o.clamp,clone:()=>l.clone,conversionMatrix3:()=>o.conversionMatrix3,degToRad:()=>o.degToRad,instanced:()=>l.instanced,intersectObject:()=>n.intersectObject,lambert:()=>l.lambert,lambertdouble:()=>l.lambertdouble,outline:()=>l.outline,screen:()=>l.screen,screenaa:()=>l.screenaa,sphereimposter:()=>l.sphereimposter,sphereimposteroutline:()=>l.sphereimposteroutline,sprite:()=>l.sprite,stickimposter:()=>l.stickimposter,stickimposteroutline:()=>l.stickimposteroutline,volumetric:()=>l.volumetric});var i=t("./src/WebGL/constants/index.ts"),n=t("./src/WebGL/core/index.ts"),s=t("./src/WebGL/materials/index.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/objects/index.ts"),l=t("./src/WebGL/shaders/index.ts"),h=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/Camera.ts"),g=t("./src/WebGL/Fog.ts"),m=t("./src/WebGL/Renderer.ts"),_=t("./src/WebGL/SpritePlugin.ts")},"./src/WebGL/materials/ImposterMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>l});var i=t("./src/WebGL/constants/Coloring.ts"),n=t("./src/WebGL/constants/Shading.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class l extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.ambient=new s.Color(1048575),this.emissive=new s.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new o.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=n.Shading.SmoothShading,this.shaderID=null,this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.setValues(u)}clone(u=new l){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u}}},"./src/WebGL/materials/InstancedMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{InstancedMaterial:()=>l});var i=t("./src/WebGL/constants/Coloring.ts"),n=t("./src/WebGL/constants/Shading.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class l extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.ambient=new s.Color(1048575),this.emissive=new s.Color(0),this.wrapAround=!1,this.wrapRGB=new o.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=n.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(u)}clone(u=new l){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u.sphere=this.sphere,u}}},"./src/WebGL/materials/LineBasicMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{LineBasicMaterial:()=>s});var i=t("./src/colors.ts"),n=t("./src/WebGL/materials/Material.ts");class s extends n.Material{constructor(a){super(),this.color=new i.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.color.copy(this.color),a}}},"./src/WebGL/materials/Material.ts":(r,e,t)=>{t.r(e),t.d(e,{Material:()=>a,MaterialIdCount:()=>l});var i=t("./src/WebGL/constants/Sides.ts"),n=t("./src/WebGL/core/index.ts"),s=t("./src/WebGL/math/index.ts"),o=t("./src/colors.ts");class a extends n.EventDispatcher{constructor(){super(...arguments),this.id=l++,this.name="",this.side=i.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(u={}){if(u!==void 0)for(var g in u){var m=u[g];if(m===void 0){console.warn("$3Dmol.Material: '"+g+"' parameter is undefined.");continue}if(g in this){var _=this[g];_ instanceof o.Color&&m instanceof o.Color?_.copy(m):_ instanceof o.Color?_.set(m):_ instanceof s.Vector3&&m instanceof s.Vector3?_.copy(m):this[g]=m}}}clone(u=new a){return u.name=this.name,u.side=this.side,u.opacity=this.opacity,u.transparent=this.transparent,u.depthTest=this.depthTest,u.depthWrite=this.depthWrite,u.polygonOffset=this.polygonOffset,u.polygonOffsetFactor=this.polygonOffsetFactor,u.polygonOffsetUnits=this.polygonOffsetUnits,u.alphaTest=this.alphaTest,u.overdraw=this.overdraw,u.visible=this.visible,u}makeShaded(u){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:u},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let l=0},"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{MeshDoubleLambertMaterial:()=>s});var i=t("./src/WebGL/constants/Sides.ts"),n=t("./src/WebGL/materials/MeshLambertMaterial.ts");class s extends n.MeshLambertMaterial{constructor(a){super(a),this.shaderID="lambertdouble",this.side=i.DoubleSide,this.outline=!1}clone(a=new s){return super.clone.call(this,a),a}}},"./src/WebGL/materials/MeshLambertMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{MeshLambertMaterial:()=>l});var i=t("./src/WebGL/constants/Coloring.ts"),n=t("./src/WebGL/constants/Shading.ts"),s=t("./src/WebGL/materials/Material.ts"),o=t("./src/colors.ts"),a=t("./src/WebGL/math/index.ts");class l extends s.Material{constructor(u){super(),this.color=new o.Color(16777215),this.ambient=new o.Color(1048575),this.emissive=new o.Color(0),this.wrapAround=!1,this.wrapRGB=new a.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=n.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=i.Coloring.NoColors,this.skinning=!1,this.setValues(u)}clone(u=new l){return super.clone.call(this,u),u.color.copy(this.color),u.ambient.copy(this.ambient),u.emissive.copy(this.emissive),u.wrapAround=this.wrapAround,u.wrapRGB.copy(this.wrapRGB),u.map=this.map,u.lightMap=this.lightMap,u.specularMap=this.specularMap,u.envMap=this.envMap,u.combine=this.combine,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,u.fog=this.fog,u.shading=this.shading,u.shaderID=this.shaderID,u.vertexColors=this.vertexColors,u.skinning=this.skinning,u.morphTargets=this.morphTargets,u.morphNormals=this.morphNormals,u}}},"./src/WebGL/materials/MeshOutlineMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{MeshOutlineMaterial:()=>s});var i=t("./src/colors.ts"),n=t("./src/WebGL/materials/Material.ts");class s extends n.Material{constructor(a){super(),a=a||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=i.CC.color(a.color||new i.Color(0,0,0)),this.outlineWidth=a.width||.1,this.outlinePushback=a.pushback||1,this.outlineMaxPixels=a.maxpixels||0}clone(a=new s){return super.clone.call(this,a),a.fog=this.fog,a.shaderID=this.shaderID,a.wireframe=this.wireframe,a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/SphereImposterMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{SphereImposterMaterial:()=>n});var i=t("./src/WebGL/materials/ImposterMaterial.ts");class n extends i.ImposterMaterial{constructor(o){super(o),this.shaderID="sphereimposter",this.setValues(o)}clone(o=new n){return super.clone.call(this,o),o}}},"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{SphereImposterOutlineMaterial:()=>s});var i=t("./src/colors.ts"),n=t("./src/WebGL/materials/ImposterMaterial.ts");class s extends n.ImposterMaterial{constructor(a){super(a),a=a||{},this.shaderID="sphereimposteroutline",this.outlineColor=i.CC.color(a.color||new i.Color(0,0,0)),this.outlineWidth=a.width||.1,this.outlinePushback=a.pushback||1,this.outlineMaxPixels=a.maxpixels||0,this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/SpriteMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{SpriteMaterial:()=>l});var i=t("./src/WebGL/constants/SpriteAlignment.ts"),n=t("./src/WebGL/core/Texture.ts"),s=t("./src/colors.ts"),o=t("./src/WebGL/math/index.ts"),a=t("./src/WebGL/materials/Material.ts");class l extends a.Material{constructor(u){super(),this.color=new s.Color(16777215),this.map=new n.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new o.Vector2(0,0),this.uvScale=new o.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=i.SpriteAlignment.center.clone(),this.setValues(u),u=u||{},u.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),u.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),u.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(u=new l){return super.clone.call(this,u),u.color.copy(this.color),u.map=this.map,u.useScreenCoordinates=this.useScreenCoordinates,u.screenOffset=this.screenOffset,u.sizeAttenuation=this.sizeAttenuation,u.scaleByViewport=this.scaleByViewPort,u.alignment.copy(this.alignment),u.uvOffset.copy(this.uvOffset),u}}},"./src/WebGL/materials/StickImposterMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{StickImposterMaterial:()=>n});var i=t("./src/WebGL/materials/ImposterMaterial.ts");class n extends i.ImposterMaterial{constructor(o){super(o),this.shaderID="stickimposter",this.setValues(o)}clone(o=new n){return super.clone.call(this,o),o}}},"./src/WebGL/materials/StickImposterOutlineMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{StickImposterOutlineMaterial:()=>s});var i=t("./src/colors.ts"),n=t("./src/WebGL/materials/ImposterMaterial.ts");class s extends n.ImposterMaterial{constructor(a={}){super(a),this.shaderID="stickimposteroutline",this.outlineColor=new i.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,a.color&&(this.outlineColor=i.CC.color(a.color)),a.width&&(this.outlineWidth=a.width),a.pushback&&(this.outlinePushback=a.pushback),a.maxpixels&&(this.outlineMaxPixels=a.maxpixels),this.setValues(a)}clone(a=new s){return super.clone.call(this,a),a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.outlinePushback=this.outlinePushback,a.outlineMaxPixels=this.outlineMaxPixels,a}}},"./src/WebGL/materials/VolumetricMaterial.ts":(r,e,t)=>{t.r(e),t.d(e,{VolumetricMaterial:()=>o});var i=t("./src/WebGL/constants/Sides.ts"),n=t("./src/colors.ts"),s=t("./src/WebGL/materials/Material.ts");class o extends s.Material{constructor(l){super(),this.transparent=!1,this.volumetric=!0,this.color=new n.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=i.FrontSide,this.setValues(l)}clone(l=new o){return super.clone.call(this,l),l.transparent=this.transparent,l.volumetric=this.volumetric,l.color=this.color,l.transferfn=this.transferfn,l.map=this.map,l.extent=this.extent,l.maxdepth=this.maxdepth,l.unit=this.unit,l.texmatrix=this.texmatrix,l.transfermin=this.transfermin,l.transfermax=this.transfermax,l.subsamples=this.subsamples,l.shaderID=this.shaderID,l.side=this.side,l}}},"./src/WebGL/materials/index.ts":(r,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>i.ImposterMaterial,InstancedMaterial:()=>n.InstancedMaterial,LineBasicMaterial:()=>s.LineBasicMaterial,Material:()=>o.Material,MaterialIdCount:()=>o.MaterialIdCount,MeshDoubleLambertMaterial:()=>a.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>l.MeshLambertMaterial,MeshOutlineMaterial:()=>h.MeshOutlineMaterial,SphereImposterMaterial:()=>u.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>g.SphereImposterOutlineMaterial,SpriteMaterial:()=>m.SpriteMaterial,StickImposterMaterial:()=>_.StickImposterMaterial,StickImposterOutlineMaterial:()=>b.StickImposterOutlineMaterial,VolumetricMaterial:()=>d.VolumetricMaterial});var i=t("./src/WebGL/materials/ImposterMaterial.ts"),n=t("./src/WebGL/materials/InstancedMaterial.ts"),s=t("./src/WebGL/materials/LineBasicMaterial.ts"),o=t("./src/WebGL/materials/Material.ts"),a=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),l=t("./src/WebGL/materials/MeshLambertMaterial.ts"),h=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),u=t("./src/WebGL/materials/SphereImposterMaterial.ts"),g=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),m=t("./src/WebGL/materials/SpriteMaterial.ts"),_=t("./src/WebGL/materials/StickImposterMaterial.ts"),b=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),d=t("./src/WebGL/materials/VolumetricMaterial.ts")},"./src/WebGL/math/Quaternion.ts":(r,e,t)=>{t.r(e),t.d(e,{Quaternion:()=>i});class i{constructor(s,o,a,l){this.x=s||0,this.y=o||0,this.z=a||0,this.w=l!==void 0?l:1}set(s,o,a,l){return this.x=s,this.y=o,this.z=a,this.w=l,this}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let s=this.length();return s===0?(this.x=0,this.y=0,this.z=0,this.w=1):(s=1/s,this.x*=s,this.y*=s,this.z*=s,this.w*=s),this}multiply(s){return this.multiplyQuaternions(this,s)}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}multiplyQuaternions(s,o){const a=s.x,l=s.y,h=s.z,u=s.w,g=o.x,m=o.y,_=o.z,b=o.w;return this.x=a*b+u*g+l*_-h*m,this.y=l*b+u*m+h*g-a*_,this.z=h*b+u*_+a*m-l*g,this.w=u*b-a*g-l*m-h*_,this}sub(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this.w-=s.w,this}clone(){return new i(this.x,this.y,this.z,this.w)}setFromEuler(s){const o=Math.cos(s.x/2),a=Math.cos(s.y/2),l=Math.cos(s.z/2),h=Math.sin(s.x/2),u=Math.sin(s.y/2),g=Math.sin(s.z/2);return this.x=h*a*l+o*u*g,this.y=o*u*l-h*a*g,this.z=o*a*g+h*u*l,this.w=o*a*l-h*u*g,this}}},"./src/WebGL/math/Vector2.ts":(r,e,t)=>{t.r(e),t.d(e,{Vector2:()=>i});class i{constructor(s,o){this.x=s||0,this.y=o||0}set(s,o){return this.x=s,this.y=o,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this}copy(s){return this.x=s.x,this.y=s.y,this}clone(){return new i(this.x,this.y)}}},"./src/WebGL/math/index.ts":(r,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>l.Matrix3,Matrix4:()=>l.Matrix4,Quaternion:()=>i.Quaternion,Ray:()=>l.Ray,Vector2:()=>n.Vector2,Vector3:()=>l.Vector3,clamp:()=>s.clamp,conversionMatrix3:()=>o.conversionMatrix3,degToRad:()=>a.degToRad});var i=t("./src/WebGL/math/Quaternion.ts"),n=t("./src/WebGL/math/Vector2.ts"),s=t("./src/WebGL/math/utils/clamp.ts"),o=t("./src/WebGL/math/utils/conversionMatrix3.ts"),a=t("./src/WebGL/math/utils/degToRad.ts"),l=t("./src/WebGL/math/math.ts")},"./src/WebGL/math/math.ts":(r,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>m,Matrix4:()=>u,Ray:()=>_,Vector3:()=>g});var i=t("./src/WebGL/math/utils/degToRad.ts"),n=t("./src/WebGL/math/utils/clamp.ts"),s,o,a,l,h;class u{constructor(d=1,c=0,f=0,v=0,y=0,D=1,E=0,p=0,x=0,w=0,C=1,S=0,A=0,P=0,O=0,F=1){typeof d<"u"&&typeof d!="number"?this.elements=new Float32Array(d):(this.elements=new Float32Array(16),this.elements[0]=d,this.elements[4]=c,this.elements[8]=f,this.elements[12]=v,this.elements[1]=y,this.elements[5]=D,this.elements[9]=E,this.elements[13]=p,this.elements[2]=x,this.elements[6]=w,this.elements[10]=C,this.elements[14]=S,this.elements[3]=A,this.elements[7]=P,this.elements[11]=O,this.elements[15]=F)}makeScale(d,c,f){throw new Error("Method not implemented.")}set(d,c,f,v,y,D,E,p,x,w,C,S,A,P,O,F){const I=this.elements;return I[0]=d,I[4]=c,I[8]=f,I[12]=v,I[1]=y,I[5]=D,I[9]=E,I[13]=p,I[2]=x,I[6]=w,I[10]=C,I[14]=S,I[3]=A,I[7]=P,I[11]=O,I[15]=F,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(d){const c=d.elements;return this.set(c[0],c[4],c[8],c[12],c[1],c[5],c[9],c[13],c[2],c[6],c[10],c[14],c[3],c[7],c[11],c[15]),this}matrix3FromTopLeft(){const d=this.elements;return new m(d[0],d[4],d[8],d[1],d[5],d[9],d[2],d[6],d[10])}setRotationFromEuler(d,c){const f=this.elements,{x:v,y,z:D}=d,E=Math.cos(v),p=Math.sin(v),x=Math.cos(y),w=Math.sin(y),C=Math.cos(D),S=Math.sin(D);if(c===void 0||c==="XYZ"){const A=E*C,P=E*S,O=p*C,F=p*S;f[0]=x*C,f[4]=-x*S,f[8]=w,f[1]=P+O*w,f[5]=A-F*w,f[9]=-p*x,f[2]=F-A*w,f[6]=O+P*w,f[10]=E*x}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${c}`);return this}setRotationFromQuaternion(d){const c=this.elements,{x:f,y:v,z:y,w:D}=d,E=f+f,p=v+v,x=y+y,w=f*E,C=f*p,S=f*x,A=v*p,P=v*x,O=y*x,F=D*E,I=D*p,B=D*x;return c[0]=1-(A+O),c[4]=C-B,c[8]=S+I,c[1]=C+B,c[5]=1-(w+O),c[9]=P-F,c[2]=S-I,c[6]=P+F,c[10]=1-(w+A),this}multiplyMatrices(d,c){const f=d.elements,v=c.elements,y=this.elements,D=f[0],E=f[4],p=f[8],x=f[12],w=f[1],C=f[5],S=f[9],A=f[13],P=f[2],O=f[6],F=f[10],I=f[14],B=f[3],k=f[7],U=f[11],W=f[15],R=v[0],z=v[4],V=v[8],q=v[12],Q=v[1],re=v[5],te=v[9],ae=v[13],ne=v[2],le=v[6],Ee=v[10],De=v[14],Pe=v[3],pe=v[7],Z=v[11],be=v[15];return y[0]=D*R+E*Q+p*ne+x*Pe,y[4]=D*z+E*re+p*le+x*pe,y[8]=D*V+E*te+p*Ee+x*Z,y[12]=D*q+E*ae+p*De+x*be,y[1]=w*R+C*Q+S*ne+A*Pe,y[5]=w*z+C*re+S*le+A*pe,y[9]=w*V+C*te+S*Ee+A*Z,y[13]=w*q+C*ae+S*De+A*be,y[2]=P*R+O*Q+F*ne+I*Pe,y[6]=P*z+O*re+F*le+I*pe,y[10]=P*V+O*te+F*Ee+I*Z,y[14]=P*q+O*ae+F*De+I*be,y[3]=B*R+k*Q+U*ne+W*Pe,y[7]=B*z+k*re+U*le+W*pe,y[11]=B*V+k*te+U*Ee+W*Z,y[15]=B*q+k*ae+U*De+W*be,this}multiplyScalar(d){const c=this.elements;return c[0]*=d,c[4]*=d,c[8]*=d,c[12]*=d,c[1]*=d,c[5]*=d,c[9]*=d,c[13]*=d,c[2]*=d,c[6]*=d,c[10]*=d,c[14]*=d,c[3]*=d,c[7]*=d,c[11]*=d,c[15]*=d,this}makeTranslation(d,c,f){return this.set(1,0,0,d,0,1,0,c,0,0,1,f,0,0,0,1),this}snap(d){const c=Math.pow(10,4),f=this.elements;for(let v=0;v<16;v++){const y=Math.round(f[v]);y===Math.round(f[v]*c)/c&&(f[v]=y)}return this}transpose(){const d=this.elements;let c;return c=d[1],d[1]=d[4],d[4]=c,c=d[2],d[2]=d[8],d[8]=c,c=d[6],d[6]=d[9],d[9]=c,c=d[3],d[3]=d[12],d[12]=c,c=d[7],d[7]=d[13],d[13]=c,c=d[11],d[11]=d[14],d[14]=c,this}setPosition(d){const c=this.elements;return c[12]=d.x,c[13]=d.y,c[14]=d.z,this}translate(d){const c=this.elements;return c[12]+=d.x,c[13]+=d.y,c[14]+=d.z,this}getInverse(d,c){const f=this.elements,v=d.elements,y=v[0],D=v[4],E=v[8],p=v[12],x=v[1],w=v[5],C=v[9],S=v[13],A=v[2],P=v[6],O=v[10],F=v[14],I=v[3],B=v[7],k=v[11],U=v[15];f[0]=C*F*B-S*O*B+S*P*k-w*F*k-C*P*U+w*O*U,f[4]=p*O*B-E*F*B-p*P*k+D*F*k+E*P*U-D*O*U,f[8]=E*S*B-p*C*B+p*w*k-D*S*k-E*w*U+D*C*U,f[12]=p*C*P-E*S*P-p*w*O+D*S*O+E*w*F-D*C*F,f[1]=S*O*I-C*F*I-S*A*k+x*F*k+C*A*U-x*O*U,f[5]=E*F*I-p*O*I+p*A*k-y*F*k-E*A*U+y*O*U,f[9]=p*C*I-E*S*I-p*x*k+y*S*k+E*x*U-y*C*U,f[13]=E*S*A-p*C*A+p*x*O-y*S*O-E*x*F+y*C*F,f[2]=w*F*I-S*P*I+S*A*B-x*F*B-w*A*U+x*P*U,f[6]=p*P*I-D*F*I-p*A*B+y*F*B+D*A*U-y*P*U,f[10]=D*S*I-p*w*I+p*x*B-y*S*B-D*x*U+y*w*U,f[14]=p*w*A-D*S*A-p*x*P+y*S*P+D*x*F-y*w*F,f[3]=C*P*I-w*O*I-C*A*B+x*O*B+w*A*k-x*P*k,f[7]=D*O*I-E*P*I+E*A*B-y*O*B-D*A*k+y*P*k,f[11]=E*w*I-D*C*I-E*x*B+y*C*B+D*x*k-y*w*k,f[15]=D*C*A-E*w*A+E*x*P-y*C*P-D*x*O+y*w*O;const W=y*f[0]+x*f[4]+A*f[8]+I*f[12];if(W===0){const R="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(c)throw new Error(R);return console.warn(R),this.identity(),this}return this.multiplyScalar(1/W),this}isReflected(){const d=this.elements,c=d[0],f=d[4],v=d[8],y=d[1],D=d[5],E=d[9],p=d[2],x=d[6],w=d[10];return c*D*w+y*x*v+p*f*E-p*D*v-y*f*w-c*x*E<0}scale(d){const c=this.elements,{x:f}=d,{y:v}=d,{z:y}=d;return c[0]*=f,c[4]*=v,c[8]*=y,c[1]*=f,c[5]*=v,c[9]*=y,c[2]*=f,c[6]*=v,c[10]*=y,c[3]*=f,c[7]*=v,c[11]*=y,this}getMaxScaleOnAxis(){const d=this.elements,c=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],f=d[4]*d[4]+d[5]*d[5]+d[6]*d[6],v=d[8]*d[8]+d[9]*d[9]+d[10]*d[10];return Math.sqrt(Math.max(c,Math.max(f,v)))}makeFrustum(d,c,f,v,y,D){const E=this.elements,p=2*y/(c-d),x=2*y/(v-f),w=(c+d)/(c-d),C=(v+f)/(v-f),S=-(D+y)/(D-y),A=-2*D*y/(D-y);return E[0]=p,E[4]=0,E[8]=w,E[12]=0,E[1]=0,E[5]=x,E[9]=C,E[13]=0,E[2]=0,E[6]=0,E[10]=S,E[14]=A,E[3]=0,E[7]=0,E[11]=-1,E[15]=0,this}makePerspective(d,c,f,v){const y=f*Math.tan((0,i.degToRad)(d*.5)),D=-y,E=D*c,p=y*c;return this.makeFrustum(E,p,D,y,f,v)}makeOrthographic(d,c,f,v,y,D){const E=this.elements,p=1/(c-d),x=1/(f-v),w=1/(D-y),C=(c+d)*p,S=(f+v)*x,A=(D+y)*w;return E[0]=2*p,E[4]=0,E[8]=0,E[12]=-C,E[1]=0,E[5]=2*x,E[9]=0,E[13]=-S,E[2]=0,E[6]=0,E[10]=-2*w,E[14]=-A,E[3]=0,E[7]=0,E[11]=0,E[15]=1,this}isEqual(d){const c=d.elements,f=this.elements;return f[0]===c[0]&&f[4]===c[4]&&f[8]===c[8]&&f[12]===c[12]&&f[1]===c[1]&&f[5]===c[5]&&f[9]===c[9]&&f[13]===c[13]&&f[2]===c[2]&&f[6]===c[6]&&f[10]===c[10]&&f[14]===c[14]&&f[3]===c[3]&&f[7]===c[7]&&f[11]===c[11]&&f[15]===c[15]}clone(){const d=this.elements;return new u(d[0],d[4],d[8],d[12],d[1],d[5],d[9],d[13],d[2],d[6],d[10],d[14],d[3],d[7],d[11],d[15])}isIdentity(){const d=this.elements;return d[0]===1&&d[4]===0&&d[8]===0&&d[12]===0&&d[1]===0&&d[5]===1&&d[9]===0&&d[13]===0&&d[2]===0&&d[6]===0&&d[10]===1&&d[14]===0&&d[3]===0&&d[7]===0&&d[11]===0&&d[15]===1}isNearlyIdentity(d){return this.clone().snap(d).isIdentity()}getScale(d){const c=this.elements;return d=d||new g,a.set(c[0],c[1],c[2]),l.set(c[4],c[5],c[6]),h.set(c[8],c[9],c[10]),d.x=a.length(),d.y=l.length(),d.z=h.length(),d}lookAt(d,c,f){const v=this.elements;return h.subVectors(d,c).normalize(),h.length()===0&&(h.z=1),a.crossVectors(f,h).normalize(),a.length()===0&&(h.x+=1e-4,a.crossVectors(f,h).normalize()),l.crossVectors(h,a),v[0]=a.x,v[4]=l.x,v[8]=h.x,v[1]=a.y,v[5]=l.y,v[9]=h.y,v[2]=a.z,v[6]=l.z,v[10]=h.z,this}compose(d,c,f){const v=this.elements;return s.identity(),s.setRotationFromQuaternion(c),o.makeScale(f.x,f.y,f.z),this.multiplyMatrices(s,o),v[12]=d.x,v[13]=d.y,v[14]=d.z,this}}s=new u,o=new u;class g{constructor(d,c,f){this.x=d||0,this.y=c||0,this.z=f||0,this.atomid=void 0}set(d,c,f){return this.x=d,this.y=c,this.z=f,this}copy(d){return this.x=d.x,this.y=d.y,this.z=d.z,this}add(d){return this.x+=d.x,this.y+=d.y,this.z+=d.z,this}addVectors(d,c){return this.x=d.x+c.x,this.y=d.y+c.y,this.z=d.z+c.z,this}multiplyVectors(d,c){return this.x=d.x*c.x,this.y=d.y*c.y,this.z=d.z*c.z,this}sub(d){return this.x-=d.x,this.y-=d.y,this.z-=d.z,this}subVectors(d,c){return this.x=d.x-c.x,this.y=d.y-c.y,this.z=d.z-c.z,this}multiplyScalar(d){return this.x*=d,this.y*=d,this.z*=d,this}divideScalar(d){return d!==0?(this.x/=d,this.y/=d,this.z/=d):(this.x=0,this.y=0,this.z=0),this}max(d){return this.x=Math.max(this.x,d.x),this.y=Math.max(this.y,d.y),this.z=Math.max(this.z,d.z),this}min(d){return this.x=Math.min(this.x,d.x),this.y=Math.min(this.y,d.y),this.z=Math.min(this.z,d.z),this}distanceTo(d){return Math.sqrt(this.distanceToSquared(d))}distanceToSquared(d){const c=this.x-d.x,f=this.y-d.y,v=this.z-d.z;return c*c+f*f+v*v}applyMatrix3(d){const{x:c}=this,{y:f}=this,{z:v}=this,y=d.elements;return this.x=y[0]*c+y[3]*f+y[6]*v,this.y=y[1]*c+y[4]*f+y[7]*v,this.z=y[2]*c+y[5]*f+y[8]*v,this}applyMatrix4(d){const{x:c}=this,{y:f}=this,{z:v}=this,y=d.elements;return this.x=y[0]*c+y[4]*f+y[8]*v+y[12],this.y=y[1]*c+y[5]*f+y[9]*v+y[13],this.z=y[2]*c+y[6]*f+y[10]*v+y[14],this}applyProjection(d){const{x:c}=this,{y:f}=this,{z:v}=this,y=d.elements,D=y[3]*c+y[7]*f+y[11]*v+y[15];return this.x=(y[0]*c+y[4]*f+y[8]*v+y[12])/D,this.y=(y[1]*c+y[5]*f+y[9]*v+y[13])/D,this.z=(y[2]*c+y[6]*f+y[10]*v+y[14])/D,this}applyQuaternion(d){const{x:c}=this,{y:f}=this,{z:v}=this,y=d.x,D=d.y,E=d.z,p=d.w,x={};x.x=2*(f*E-v*D),x.y=2*(v*y-c*E),x.z=2*(c*D-f*y);const w={};return w.x=x.y*E-x.z*D,w.y=x.z*y-x.x*E,w.z=x.x*D-x.y*y,this.x=c+p*x.x+w.x,this.y=f+p*x.y+w.y,this.z=v+p*x.z+w.z,this}negate(){return this.multiplyScalar(-1)}dot(d){return this.x*d.x+this.y*d.y+this.z*d.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(d){const{x:c}=this,{y:f}=this,{z:v}=this;return this.x=f*d.z-v*d.y,this.y=v*d.x-c*d.z,this.z=c*d.y-f*d.x,this}crossVectors(d,c){return this.x=d.y*c.z-d.z*c.y,this.y=d.z*c.x-d.x*c.z,this.z=d.x*c.y-d.y*c.x,this}equals(d){return this.x==d.x&&this.y==d.y&&this.z==d.z}getPositionFromMatrix(d){return this.x=d.elements[12],this.y=d.elements[13],this.z=d.elements[14],this}setEulerFromRotationMatrix(d,c){const f=d.elements,v=f[0],y=f[4],D=f[8],E=f[5],p=f[9],x=f[6],w=f[10];return c===void 0||c==="XYZ"?(this.y=Math.asin((0,n.clamp)(D,-1,1)),Math.abs(D)<.99999?(this.x=Math.atan2(-p,w),this.z=Math.atan2(-y,v)):(this.x=Math.atan2(x,E),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${c}`),this}rotateAboutVector(d,c){d.normalize();const f=Math.cos(c),v=Math.sin(c),y=this.clone().multiplyScalar(f),D=d.clone().cross(this).multiplyScalar(v),E=d.clone().multiplyScalar(d.clone().dot(this)).multiplyScalar(1-f),p=y.add(D).add(E);return this.x=p.x,this.y=p.y,this.z=p.z,this}setFromMatrixPosition(d){const c=d.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}transformDirection(d){const{x:c}=this,{y:f}=this,{z:v}=this,y=d.elements;return this.x=y[0]*c+y[4]*f+y[8]*v,this.y=y[1]*c+y[5]*f+y[9]*v,this.z=y[2]*c+y[6]*f+y[10]*v,this.normalize()}clone(){return new g(this.x,this.y,this.z)}unproject(d){const c=s;return c.multiplyMatrices(d.matrixWorld,c.getInverse(d.projectionMatrix)),this.applyMatrix4(c)}}a=new g,l=new g,h=new g;class m{constructor(d=1,c=0,f=0,v=0,y=1,D=0,E=0,p=0,x=1){this.elements=new Float32Array(9),this.set(d,c,f,v,y,D,E,p,x)}set(d,c,f,v,y,D,E,p,x){const w=this.elements;return w[0]=d,w[3]=c,w[6]=f,w[1]=v,w[4]=y,w[7]=D,w[2]=E,w[5]=p,w[8]=x,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(d){const c=d.elements;this.set(c[0],c[3],c[6],c[1],c[4],c[7],c[2],c[5],c[8])}multiplyScalar(d){const c=this.elements;return c[0]*=d,c[3]*=d,c[6]*=d,c[1]*=d,c[4]*=d,c[7]*=d,c[2]*=d,c[5]*=d,c[8]*=d,this}getInverse3(d){const c=d.elements,f=this.elements;f[0]=c[4]*c[8]-c[5]*c[7],f[3]=c[6]*c[5]-c[3]*c[8],f[6]=c[3]*c[7]-c[6]*c[4],f[1]=c[7]*c[2]-c[1]*c[8],f[4]=c[0]*c[8]-c[6]*c[2],f[7]=c[1]*c[6]-c[0]*c[7],f[2]=c[1]*c[5]-c[2]*c[4],f[5]=c[2]*c[3]-c[0]*c[5],f[8]=c[0]*c[4]-c[1]*c[3];const v=c[0]*f[0]+c[3]*f[1]+c[6]*f[2];return this.multiplyScalar(1/v),this}getInverse(d,c){const f=d.elements,v=this.elements;v[0]=f[10]*f[5]-f[6]*f[9],v[1]=-f[10]*f[1]+f[2]*f[9],v[2]=f[6]*f[1]-f[2]*f[5],v[3]=-f[10]*f[4]+f[6]*f[8],v[4]=f[10]*f[0]-f[2]*f[8],v[5]=-f[6]*f[0]+f[2]*f[4],v[6]=f[9]*f[4]-f[5]*f[8],v[7]=-f[9]*f[0]+f[1]*f[8],v[8]=f[5]*f[0]-f[1]*f[4];const y=f[0]*v[0]+f[1]*v[3]+f[2]*v[6];if(y===0){const D="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(c)throw new Error(D);return console.warn(D),this.identity(),this}return this.multiplyScalar(1/y),this}getDeterminant(){const d=this.elements;return d[0]*d[4]*d[8]+d[1]*d[5]*d[6]+d[2]*d[3]*d[7]-d[2]*d[4]*d[6]-d[1]*d[3]*d[8]-d[0]*d[5]*d[7]}transpose(){let d;const c=this.elements;return d=c[1],c[1]=c[3],c[3]=d,d=c[2],c[2]=c[6],c[6]=d,d=c[5],c[5]=c[7],c[7]=d,this}clone(){const d=this.elements;return new m(d[0],d[3],d[6],d[1],d[4],d[7],d[2],d[5],d[8])}getMatrix4(){const d=this.elements;return new u(d[0],d[3],d[6],0,d[1],d[4],d[7],0,d[2],d[5],d[8],0)}}class _{constructor(d,c){this.origin=d!==void 0?d:new g,this.direction=c!==void 0?c:new g}set(d,c){return this.origin.copy(d),this.direction.copy(c),this}copy(d){return this.origin.copy(d.origin),this.direction.copy(d.direction),this}at(d,c){return(c||new g).copy(this.direction).multiplyScalar(d).add(this.origin)}recast(d){const c=a;return this.origin.copy(this.at(d,c)),this}closestPointToPoint(d,c){const f=c||new g;f.subVectors(d,this.origin);const v=f.dot(this.direction);return f.copy(this.direction).multiplyScalar(v).add(this.origin)}distanceToPoint(d){const c=a,f=c.subVectors(d,this.origin).dot(this.direction);return c.copy(this.direction).multiplyScalar(f).add(this.origin),c.distanceTo(d)}isIntersectionCylinder(){}isIntersectionSphere(d){return this.distanceToPoint(d.center)<=d.radius}isIntersectionPlane(d){return d.normal.dot(this.direction)!==0||d.distanceToPoint(this.origin)===0}distanceToPlane(d){const c=d.normal.dot(this.direction);return c===0?d.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(d.normal)+d.constant)/c}intersectPlane(d,c){const f=this.distanceToPlane(d);if(f!==void 0)return this.at(f,c)}applyMatrix4(d){return this.direction.add(this.origin).applyMatrix4(d),this.origin.applyMatrix4(d),this.direction.sub(this.origin),this}clone(){return new _().copy(this)}}},"./src/WebGL/math/utils/clamp.ts":(r,e,t)=>{t.r(e),t.d(e,{clamp:()=>i});function i(n,s,o){return Math.min(Math.max(n,s),o)}},"./src/WebGL/math/utils/conversionMatrix3.ts":(r,e,t)=>{t.r(e),t.d(e,{conversionMatrix3:()=>n});var i=t("./src/WebGL/math/math.ts");function n(s,o,a,l,h,u){l=l*Math.PI/180,h=h*Math.PI/180,u=u*Math.PI/180;const g=f=>f*f,m=Math.cos(l),_=Math.cos(h),b=Math.cos(u),d=Math.sin(u);return new i.Matrix3(s,o*b,a*_,0,o*d,a*(m-_*b)/d,0,0,a*Math.sqrt(1-g(m)-g(_)-g(b)+2*m*_*b)/d)}},"./src/WebGL/math/utils/degToRad.ts":(r,e,t)=>{t.r(e),t.d(e,{degToRad:()=>n});const i=Math.PI/180;function n(s){return s*i}},"./src/WebGL/objects/Line.ts":(r,e,t)=>{t.r(e),t.d(e,{Line:()=>o,LineStyle:()=>s});var i=t("./src/WebGL/materials/index.ts"),n=t("./src/WebGL/core/index.ts"),s;(function(a){a[a.LineStrip=0]="LineStrip",a[a.LinePieces=1]="LinePieces"})(s||(s={}));class o extends n.Object3D{constructor(l,h=new i.LineBasicMaterial({color:Math.random()*16777215}),u=s.LineStrip){super(),this.geometry=l,this.material=h,this.type=u}clone(l=new o(this.geometry,this.material,this.type)){return super.clone.call(this,l),l}}},"./src/WebGL/objects/Mesh.ts":(r,e,t)=>{t.r(e),t.d(e,{Mesh:()=>n});var i=t("./src/WebGL/core/index.ts");class n extends i.Object3D{constructor(o,a){super(),this.geometry=o,this.material=a}clone(o){return o===void 0&&(o=new n(this.geometry,this.material)),super.clone.call(this,o),o}}},"./src/WebGL/objects/Sprite.ts":(r,e,t)=>{t.r(e),t.d(e,{Sprite:()=>s});var i=t("./src/WebGL/materials/index.ts"),n=t("./src/WebGL/core/index.ts");class s extends n.Object3D{constructor(a=new i.SpriteMaterial){super(),this.material=a,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(a=new s(this.material)){return n.Object3D.prototype.clone.call(this,a),a}}},"./src/WebGL/objects/index.ts":(r,e,t)=>{t.r(e),t.d(e,{Line:()=>i.Line,LineStyle:()=>i.LineStyle,Mesh:()=>n.Mesh,Sprite:()=>s.Sprite});var i=t("./src/WebGL/objects/Line.ts"),n=t("./src/WebGL/objects/Mesh.ts"),s=t("./src/WebGL/objects/Sprite.ts")},"./src/WebGL/shaders/ShaderType.ts":(r,e,t)=>{t.r(e)},"./src/WebGL/shaders/index.ts":(r,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>i.ShaderLib,ShaderUtils:()=>n.ShaderUtils,basic:()=>i.basic,clone:()=>n.clone,instanced:()=>i.instanced,lambert:()=>i.lambert,lambertdouble:()=>i.lambertdouble,outline:()=>i.outline,screen:()=>i.screen,screenaa:()=>i.screenaa,sphereimposter:()=>i.sphereimposter,sphereimposteroutline:()=>i.sphereimposteroutline,sprite:()=>i.sprite,stickimposter:()=>i.stickimposter,stickimposteroutline:()=>i.stickimposteroutline,volumetric:()=>i.volumetric});var i=t("./src/WebGL/shaders/lib/index.ts"),n=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")},"./src/WebGL/shaders/lib/basic/basic.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/basic/basic.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`},"./src/WebGL/shaders/lib/basic/index.ts":(r,e,t)=>{t.r(e),t.d(e,{basic:()=>o});var i=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),n=t("./src/WebGL/shaders/lib/basic/basic.frag"),s=t("./src/WebGL/shaders/lib/basic/basic.vert");const o={vertexShader:s.default.replace("#define GLSLIFY 1",""),fragmentShader:n.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/basic/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}},"./src/WebGL/shaders/lib/blur/blur.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`},"./src/WebGL/shaders/lib/blur/blur.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/blur/index.ts":(r,e,t)=>{t.r(e),t.d(e,{blur:()=>o});var i=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),n=t("./src/WebGL/shaders/lib/blur/blur.frag"),s=t("./src/WebGL/shaders/lib/blur/blur.vert");const o={fragmentShader:n.default,vertexShader:s.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/blur/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/index.ts":(r,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>v,basic:()=>i.basic,instanced:()=>n.instanced,lambert:()=>s.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>a.outline,screen:()=>l.screen,screenaa:()=>h.screenaa,sphereimposter:()=>u.sphereimposter,sphereimposteroutline:()=>g.sphereimposteroutline,sprite:()=>m.sprite,stickimposter:()=>_.stickimposter,stickimposteroutline:()=>b.stickimposteroutline,volumetric:()=>d.volumetric});var i=t("./src/WebGL/shaders/lib/basic/index.ts"),n=t("./src/WebGL/shaders/lib/instanced/index.ts"),s=t("./src/WebGL/shaders/lib/lambert/index.ts"),o=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),a=t("./src/WebGL/shaders/lib/outline/index.ts"),l=t("./src/WebGL/shaders/lib/screen/index.ts"),h=t("./src/WebGL/shaders/lib/screenaa/index.ts"),u=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),g=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),m=t("./src/WebGL/shaders/lib/sprite/index.ts"),_=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),b=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),d=t("./src/WebGL/shaders/lib/volumetric/index.ts"),c=t("./src/WebGL/shaders/lib/ssao/index.ts"),f=t("./src/WebGL/shaders/lib/blur/index.ts");const v={basic:i.basic,blur:f.blur,instanced:n.instanced,lambert:s.lambert,lambertdouble:o.lambertdouble,outline:a.outline,screen:l.screen,screenaa:h.screenaa,ssao:c.ssao,sphereimposter:u.sphereimposter,sphereimposteroutline:g.sphereimposteroutline,sprite:m.sprite,stickimposter:_.stickimposter,stickimposteroutline:b.stickimposteroutline,volumetric:d.volumetric}},"./src/WebGL/shaders/lib/instanced/index.ts":(r,e,t)=>{t.r(e),t.d(e,{instanced:()=>o});var i=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),n=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),s=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/instanced/instanced.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`},"./src/WebGL/shaders/lib/instanced/instanced.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/instanced/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambert/index.ts":(r,e,t)=>{t.r(e),t.d(e,{lambert:()=>o});var i=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),n=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),s=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/lambert/lambert.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`},"./src/WebGL/shaders/lib/lambert/lambert.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`},"./src/WebGL/shaders/lib/lambert/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambertdouble/index.ts":(r,e,t)=>{t.r(e),t.d(e,{lambertdouble:()=>o});var i=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),n=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),s=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/outline/index.ts":(r,e,t)=>{t.r(e),t.d(e,{outline:()=>o});var i=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),n=t("./src/WebGL/shaders/lib/outline/outline.frag"),s=t("./src/WebGL/shaders/lib/outline/outline.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/outline/outline.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/outline/outline.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`},"./src/WebGL/shaders/lib/outline/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new i.Color(0,0,0)},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/screen/index.ts":(r,e,t)=>{t.r(e),t.d(e,{screen:()=>o});var i=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),n=t("./src/WebGL/shaders/lib/screen/screen.frag"),s=t("./src/WebGL/shaders/lib/screen/screen.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/screen/screen.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `},"./src/WebGL/shaders/lib/screen/screen.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screen/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/screenaa/index.ts":(r,e,t)=>{t.r(e),t.d(e,{screenaa:()=>o});var i=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),n=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),s=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/screenaa/screenaa.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`},"./src/WebGL/shaders/lib/screenaa/screenaa.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screenaa/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/sphereimposter/index.ts":(r,e,t)=>{t.r(e),t.d(e,{sphereimposter:()=>o});var i=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),n=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),s=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const o={vertexShader:s.default.replace("#define GLSLIFY 1",""),fragmentShader:n.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`},"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":(r,e,t)=>{t.r(e),t.d(e,{sphereimposteroutline:()=>o});var i=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),n=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),s=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`},"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new i.Color(0,0,0)},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/sprite/index.ts":(r,e,t)=>{t.r(e),t.d(e,{sprite:()=>o});var i=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),n=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),s=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/sprite/sprite.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`},"./src/WebGL/shaders/lib/sprite/sprite.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`},"./src/WebGL/shaders/lib/sprite/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={}},"./src/WebGL/shaders/lib/ssao/index.ts":(r,e,t)=>{t.r(e),t.d(e,{ssao:()=>o});var i=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),n=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),s=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const o={fragmentShader:n.default,vertexShader:s.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/ssao/ssao.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`},"./src/WebGL/shaders/lib/ssao/ssao.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/ssao/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>i});const i={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/stickimposter/index.ts":(r,e,t)=>{t.r(e),t.d(e,{stickimposter:()=>l});var i=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),n=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),s=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),o=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const l={fragmentShader:[n.default,s.default].join(`
`),vertexShader:o.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`},"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`},"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":(r,e,t)=>{t.r(e),t.d(e,{stickimposteroutline:()=>l});var i=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),n=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),s=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"),o=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const l={fragmentShader:n.default+s.default,vertexShader:o.default,uniforms:i.uniforms}},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`},"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new i.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/volumetric/index.ts":(r,e,t)=>{t.r(e),t.d(e,{volumetric:()=>o});var i=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),n=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),s=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const o={fragmentShader:n.default.replace("#define GLSLIFY 1",""),vertexShader:s.default.replace("#define GLSLIFY 1",""),uniforms:i.uniforms}},"./src/WebGL/shaders/lib/volumetric/uniforms.ts":(r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>n});var i=t("./src/colors.ts");const n={opacity:{type:"f",value:1},fogColor:{type:"c",value:new i.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}},"./src/WebGL/shaders/lib/volumetric/volumetric.frag":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `},"./src/WebGL/shaders/lib/volumetric/volumetric.vert":(r,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`},"./src/WebGL/shaders/utils/clone.ts":(r,e,t)=>{t.r(e),t.d(e,{clone:()=>n});var i=t("./src/colors.ts");function n(s){let o={};for(const l in s){o[l]={},o[l].type=s[l].type;var a=s[l].value;a instanceof i.Color?o[l].value=a.clone():typeof a=="number"?o[l].value=a:a instanceof Array?o[l].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return o}},"./src/WebGL/shaders/utils/index.ts":(r,e,t)=>{t.r(e),t.d(e,{ShaderUtils:()=>n,clone:()=>i.clone});var i=t("./src/WebGL/shaders/utils/clone.ts");const n={clone:i.clone}},"./src/WebGL/shapes/Cylinder.ts":(r,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>s});var i=t("./src/WebGL/math/index.ts");let n=new i.Vector3;class s{constructor(a=new i.Vector3,l=new i.Vector3,h=0){this.c1=a,this.c2=l,this.radius=h,this.direction=new i.Vector3().subVectors(this.c2,this.c1).normalize()}copy(a){return this.c1.copy(a.c1),this.c2.copy(a.c2),this.direction.copy(a.direction),this.radius=a.radius,this}lengthSq(){return n.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(a){return this.direction.add(this.c1).applyMatrix4(a),this.c1.applyMatrix4(a),this.c2.applyMatrix4(a),this.direction.sub(this.c1).normalize(),this.radius=this.radius*a.getMaxScaleOnAxis(),this}}},"./src/WebGL/shapes/Sphere.ts":(r,e,t)=>{t.r(e),t.d(e,{Sphere:()=>n});var i=t("./src/WebGL/math/index.ts");class n{constructor(o={x:0,y:0,z:0},a=0){this.center=new i.Vector3(o.x,o.y,o.z),this.radius=a}set(o,a){return this.center.copy(o),this.radius=a,this}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}clone(){return new n().copy(this)}}},"./src/WebGL/shapes/Triangle.ts":(r,e,t)=>{t.r(e),t.d(e,{Triangle:()=>s});var i=t("./src/WebGL/math/index.ts");const n=new i.Vector3;class s{constructor(a=new i.Vector3,l=new i.Vector3,h=new i.Vector3){this.a=a,this.b=l,this.c=h}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}applyMatrix4(a){return this.a.applyMatrix4(a),this.b.applyMatrix4(a),this.c.applyMatrix4(a),this}getNormal(){var a=this.a.clone();return a.sub(this.b),n.subVectors(this.c,this.b),a.cross(n),a.normalize(),a}}},"./src/WebGL/shapes/index.ts":(r,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>n.Cylinder,Sphere:()=>i.Sphere,Triangle:()=>s.Triangle});var i=t("./src/WebGL/shapes/Sphere.ts"),n=t("./src/WebGL/shapes/Cylinder.ts"),s=t("./src/WebGL/shapes/Triangle.ts")},"./src/autoload.ts":(r,e,t)=>{t.r(e),t.d(e,{autoinit:()=>a,autoload:()=>u,processing_autoinit:()=>l,viewers:()=>h});var i=t("./src/GLViewer.ts"),n=t("./src/ProteinSurface4.ts"),s=t("./src/utilities.ts"),o=t("./src/colors.ts"),a=!1,l=!1,h={};function u(g,m){var _,b,d;if(document.querySelector(".viewer_3Dmoljs")!=null&&(a=!0),a){l=!0,g=g??null;var c=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(f=>{var v=[],y=[],D="";f.style.position=="static"&&(f.style.position="relative");var E=null;if(d=null,f.dataset.pdb)v.push("https://files.rcsb.org/view/"+f.dataset.pdb+".pdb"),y.push("pdb");else if(f.dataset.cid)y.push("sdf"),v.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+f.dataset.cid+"/SDF?record_type=3d");else if(f.dataset.href||f.dataset.url){if(f.dataset.href?D=f.dataset.href:D=f.dataset.url,v.push(D),d=D.substring(D.lastIndexOf(".")+1),d=="gz"){let pe=D.substring(0,D.lastIndexOf(".")).lastIndexOf(".");d=D.substring(pe+1)}y.push(d);var p=D.substring(D.lastIndexOf("/")+1,D.lastIndexOf("."));p=="/"&&(p=D.substring(D.lastIndexOf("/")+1)),f.dataset[y[y.length-1]]=p}let x=f.dataset;for(_ in x)_.substring(0,3)==="pdb"&&_!=="pdb"?(v.push("https://files.rcsb.org/view/"+x[_]+".pdb"),y.push("pdb")):_.substring(0,4)==="href"&&_!=="href"?(D=x[_],v.push(D),y.push(D.substring(D.lastIndexOf(".")+1))):_.substring(0,3)==="cid"&&_!=="cid"&&(v.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+x[_]+"/SDF?record_type=3d"),y.push("sdf"));var w={};f.dataset.options&&(w=(0,s.specStringToObject)(f.dataset.options));var C=o.CC.color(f.dataset.backgroundcolor),S=f.dataset.backgroundalpha;S=S==null?1:parseFloat(S);var A={line:{}};f.dataset.style&&(A=(0,s.specStringToObject)(f.dataset.style));var P={};f.dataset.select&&(P=(0,s.specStringToObject)(f.dataset.select));var O=[],F=[],I=[],B={},k=null,U=f.dataset,W=/style(.+)/,R=/surface(.*)/,z=/labelres(.*)/,V=[];for(b in U)Object.prototype.hasOwnProperty.call(U,b)&&V.push(b);for(V.sort(),_=0;_<V.length;_++){b=V[_];var q=W.exec(b),Q,re,te;q&&(Q="select"+q[1],re=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[b]),O.push([re,te])),q=R.exec(b),q&&(Q="select"+q[1],re=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[b]),F.push([re,te])),q=z.exec(b),q&&(Q="select"+q[1],re=(0,s.specStringToObject)(U[Q]),te=(0,s.specStringToObject)(U[b]),I.push([re,te])),b=="zoomto"&&(B=(0,s.specStringToObject)(U[b])),b=="spin"&&(k=(0,s.specStringToObject)(U[b]))}var ae=function(pe){for(pe.setStyle(P,A),E&&E.createSelectionAndStyle(P,A),_=0;_<O.length;_++){let Z=O[_][0]||{},be=O[_][1]||{line:{}};pe.setStyle(Z,be),E&&E.createSelectionAndStyle(P,A)}for(_=0;_<F.length;_++){let Z=F[_][0]||{},be=F[_][1]||{};E?pe.addSurface(n.SurfaceType.VDW,be,Z,Z).then(ie=>{E.loadSurface("VDW",Z,be,ie)}):pe.addSurface(n.SurfaceType.VDW,be,Z,Z)}for(_=0;_<I.length;_++){let Z=I[_][0]||{},be=I[_][1]||{};pe.addResLabels(Z,be)}pe.render(),pe.zoomTo(B),k&&pe.spin(k.axis,k.speed)};let ne=g;try{var le=(0,s.specStringToObject)(f.dataset.config)||{};le.backgroundColor===void 0&&(le.backgroundColor=C),le.backgroundAlpha===void 0&&(le.backgroundAlpha=S),ne==null?ne=h[f.id||c++]=(0,i.createViewer)(f,le):(ne.setBackgroundColor(C,S),ne.setConfig(le),E&&E.initiateUI()),f.dataset.ui&&$3Dmol.StateManager&&(E=new $3Dmol.StateManager(ne))}catch(pe){console.log(pe),f.textContent="WebGL appears to be disabled."}if(v.length!=0){let pe=0,Z=((be,Ce)=>function(ie){D=v[pe];var Ne=be.dataset.type||be.dataset.datatype||y[pe];if(Ce.addModel(ie,Ne,w),E){var Ve=be.dataset[y[pe]];E.setModelTitle(Ve)}pe+=1,pe<v.length?(0,s.get)(v[pe]).then(Z):(ae(Ce),be.dataset.callback&&(0,s.makeFunction)(be.dataset.callback)(Ce),l=!1,m&&m(Ce))})(f,ne);d&&d.endsWith("gz")?(0,s.getbin)(v[0]).then(Z):(0,s.get)(v[0]).then(Z)}else{if(f.dataset.element){var Ee="#"+f.dataset.element,De=document.querySelector(Ee),Pe=De?De.textContent:"";d=f.dataset.type||f.dataset.datatype,ne.addModel(Pe,d,w)}ae(ne),f.dataset.callback&&(0,s.makeFunction)(f.dataset.callback)(ne),l=!1,m&&m(ne)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&u()}},"./src/colors.ts":(r,e,t)=>{t.r(e),t.d(e,{CC:()=>n,Color:()=>i,builtinColorSchemes:()=>g,chains:()=>u,elementColors:()=>l,htmlColors:()=>s,residues:()=>h,ssColors:()=>o});class i{constructor(_,b,d){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof _=="number"?(this.r=_||0,this.g=b||0,this.b=d||0,this):this.set(_||0)}set(_){return _ instanceof i?_.clone():(typeof _=="number"?this.setHex(_):typeof _=="object"&&(this.r=(_==null?void 0:_.r)||0,this.g=(_==null?void 0:_.g)||0,this.b=(_==null?void 0:_.b)||0),this)}setHex(_){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,this}getHex(){var _=Math.round(this.r*255),b=Math.round(this.g*255),d=Math.round(this.b*255);return _<<16|b<<8|d}clone(){return new i(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}scaled(){var _={};return _.r=Math.round(this.r*255),_.g=Math.round(this.g*255),_.b=Math.round(this.b*255),_.a=1,_}}class n{static color(_){if(!_)return n.cache[0];if(_ instanceof i)return _;if(typeof _=="number"&&typeof n.cache[_]<"u")return n.cache[_];if(_&&Array.isArray(_))return _.map(n.color);let b=n.getHex(_),d=new i(b);return n.cache[b]=d,d}static getHex(_){if(Array.isArray(_))return _.map(n.getHex);if(typeof _=="string"){let b=_;if(!isNaN(parseInt(b)))return parseInt(b);if(b=b.trim(),b.length==4&&b[0]=="#"&&(b="#"+b[1]+b[1]+b[2]+b[2]+b[3]+b[3]),b.length==7&&b[0]=="#")return parseInt(b.substring(1),16);let d=n.rgbRegEx.exec(b);if(d){d[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let f=0;for(let v=2;v<5;v++){f*=256;let y=d[v].endsWith("%")?255*parseFloat(d[v])/100:parseFloat(d[v]);f+=Math.round(y)}return f}let c=s[b.toLowerCase()];return c!==void 0?c:(console.error("color not found",_.toLowerCase(),s),0)}return _}}n.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,n.cache={0:new i(0)};const s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},o={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},a={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},l={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:a,defaultColors:Object.assign({},a),greenCarbon:Object.assign(Object.assign({},a),{C:65280}),cyanCarbon:Object.assign(Object.assign({},a),{C:65535}),magentaCarbon:Object.assign(Object.assign({},a),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},a),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},a),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},a),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},a),{C:8388736}),blueCarbon:Object.assign(Object.assign({},a),{C:255})},h={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},u={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},g={ssPyMol:{prop:"ss",map:o.pyMol},ssJmol:{prop:"ss",map:o.Jmol},Jmol:{prop:"elem",map:l.Jmol},amino:{prop:"resn",map:h.amino},shapely:{prop:"resn",map:h.shapely},nucleic:{prop:"resn",map:h.nucleic},chain:{prop:"chain",map:u.atom},rasmol:{prop:"elem",map:l.rasmol},default:{prop:"elem",map:l.defaultColors},greenCarbon:{prop:"elem",map:l.greenCarbon},chainHetatm:{prop:"chain",map:u.hetatm},cyanCarbon:{prop:"elem",map:l.cyanCarbon},magentaCarbon:{prop:"elem",map:l.magentaCarbon},purpleCarbon:{prop:"elem",map:l.purpleCarbon},whiteCarbon:{prop:"elem",map:l.whiteCarbon},orangeCarbon:{prop:"elem",map:l.orangeCarbon},yellowCarbon:{prop:"elem",map:l.yellowCarbon},blueCarbon:{prop:"elem",map:l.blueCarbon}}},"./src/exporter.js":r=>{typeof r.exports=="object"&&(r.exports=window.$3Dmol)},"./src/glcartoon.ts":(r,e,t)=>{t.r(e),t.d(e,{drawCartoon:()=>P,subdivide_spline:()=>u});var i=t("./src/WebGL/math/index.ts"),n=t("./src/WebGL/shapes/index.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/Gradient.ts"),a=t("./src/colors.ts"),l=t("./src/GLDraw.ts"),h=t("./src/utilities.ts");function u(O,F){var I=[],B=O;B=[],B.push(O[0]);var k,U,W,R,z,V,q,Q,re;for(k=1,U=O.length-1;k<U;k++)if(z=O[k],V=O[k+1],z.smoothen){var te=new i.Vector3((z.x+V.x)/2,(z.y+V.y)/2,(z.z+V.z)/2);te.atom=z.atom,B.push(te)}else B.push(z);for(B.push(O[O.length-1]),k=-1,W=B.length;k<=W-3;k++)if(R=B[k===-1?0:k],z=B[k+1],V=B[k+2],q=B[k===W-3?W-1:k+3],Q=new i.Vector3().subVectors(V,R).multiplyScalar(.5),re=new i.Vector3().subVectors(q,z).multiplyScalar(.5),!V.skip)for(var ae=0;ae<F;ae++){var ne=1/F*ae,le=z.x+ne*Q.x+ne*ne*(-3*z.x+3*V.x-2*Q.x-re.x)+ne*ne*ne*(2*z.x-2*V.x+Q.x+re.x),Ee=z.y+ne*Q.y+ne*ne*(-3*z.y+3*V.y-2*Q.y-re.y)+ne*ne*ne*(2*z.y-2*V.y+Q.y+re.y),De=z.z+ne*Q.z+ne*ne*(-3*z.z+3*V.z-2*Q.z-re.z)+ne*ne*ne*(2*z.z-2*V.z+Q.z+re.z),Pe=new i.Vector3(le,Ee,De);ae<F/2?Pe.atom=z.atom:Pe.atom=V.atom,I.push(Pe)}return I.push(B[B.length-1]),I}const g=.5,m=1.3,_=.8,b=.4,d=.4;function c(O,F,I,B){for(var k,U,W,R,z=0,V=F.length;z<V;z++){R=Math.round(z*(B.length-1)/V),W=a.CC.color(B[R]);var q=O.updateGeoGroup(2),Q=q.vertexArray,re=q.colorArray,te=q.faceArray;k=q.vertices,U=k*3,Q[U]=F[z].x,Q[U+1]=F[z].y,Q[U+2]=F[z].z,Q[U+3]=I[z].x,Q[U+4]=I[z].y,Q[U+5]=I[z].z;for(var ae=0;ae<6;++ae)re[U+3*ae]=W.r,re[U+1+3*ae]=W.g,re[U+2+3*ae]=W.b;if(z>0){var ne=[k,k+1,k-1,k-2],le=q.faceidx;te[le]=ne[0],te[le+1]=ne[1],te[le+2]=ne[3],te[le+3]=ne[1],te[le+4]=ne[2],te[le+5]=ne[3],q.faceidx+=6}q.vertices+=2}}function f(O,F,I,B,k,U,W){var R,z,V,q;if(V=F.length,V<2||F[0].length<2)return;for(R=0;R<V;R++)F[R]=u(F[R],B);if(q=F[0].length,!k)return c(O,F[0],F[V-1],I);var Q,re,te,ae,ne,le,Ee=[],De=[],Pe=[];for(z=0;z<V;z++)Ee.push(.25+1.5*Math.sqrt((V-1)*z-Math.pow(z,2))/(V-1)),De.push(.5),Pe.push(2*(Math.pow(z/V,2)-z/V)+.6);var pe=[];for(z=0;z<V*2-1;z++)pe[z]=[z,z+1,z+1-2*V,z-2*V];pe[V*2-1]=[z,z+1-2*V,z+1-4*V,z-2*V];var Z,be,Ce,ie,Ne,Ve,Ue,Fe,ze,Re;let Le=O.updateGeoGroup();for(R=0;R<q;R++){let K=O.groups,X=!1;Le=O.updateGeoGroup(2*V),K!=O.groups&&R>0&&(R=R-1,X=!0),Ve=Math.round(R*(I.length-1)/q),Ne=a.CC.color(I[Ve]),ne=te,le=ae,te=[],ae=[],Q=[],F[0][R].atom!==void 0&&(ie=F[0][R].atom,W==="oval"?re=Ee:W==="rectangle"?re=De:W==="parabola"&&(re=Pe)),re||(re=De);var We,He;for(z=0;z<V;z++)R<q-1?We=F[z][R+1].clone().sub(F[z][R]):We=F[z][R-1].clone().sub(F[z][R]).negate(),z<V-1?He=F[z+1][R].clone().sub(F[z][R]):He=F[z-1][R].clone().sub(F[z][R]).negate(),Q[z]=He.cross(We).normalize().multiplyScalar(k*re[z]);for(z=0;z<V;z++)te[z]=F[z][R].clone().add(Q[z].clone().negate());for(z=0;z<V;z++)ae[z]=F[z][R].clone().add(Q[z]);for(Ue=Le.vertexArray,Fe=Le.colorArray,ze=Le.faceArray,Z=Le.vertices,be=Z*3,z=0;z<V;z++)Ue[be+3*z+0]=te[z].x,Ue[be+3*z+1]=te[z].y,Ue[be+3*z+2]=te[z].z;for(z=0;z<V;z++)Ue[be+3*z+0+3*V]=ae[V-1-z].x,Ue[be+3*z+1+3*V]=ae[V-1-z].y,Ue[be+3*z+2+3*V]=ae[V-1-z].z;for(z=0;z<2*V;++z)Fe[be+3*z+0]=Ne.r,Fe[be+3*z+1]=Ne.g,Fe[be+3*z+2]=Ne.b;if(R>0&&!X){for(z=0;z<V*2;z++)Re=[Z+pe[z][0],Z+pe[z][1],Z+pe[z][2],Z+pe[z][3]],Ce=Le.faceidx,ze[Ce]=Re[0],ze[Ce+1]=Re[1],ze[Ce+2]=Re[3],ze[Ce+3]=Re[1],ze[Ce+4]=Re[2],ze[Ce+5]=Re[3],Le.faceidx+=6;if(ie.clickable||ie.hoverable){var H=[];H.push(new n.Triangle(ne[0],te[0],te[V-1])),H.push(new n.Triangle(ne[0],te[V-1],ne[V-1])),H.push(new n.Triangle(ne[V-1],te[V-1],ae[V-1])),H.push(new n.Triangle(ne[V-1],ae[V-1],le[V-1])),H.push(new n.Triangle(ae[0],le[0],le[V-1])),H.push(new n.Triangle(ae[V-1],ae[0],le[V-1])),H.push(new n.Triangle(te[0],ne[0],le[0])),H.push(new n.Triangle(ae[0],te[0],le[0]));for(z in H)ie.intersectionShape.triangle.push(H[z])}}Le.vertices+=2*V}for(Ue=Le.vertexArray,Fe=Le.colorArray,ze=Le.faceArray,Z=Le.vertices,be=Z*3,Ce=Le.faceidx,R=0;R<V-1;R++)Re=[R,R+1,2*V-2-R,2*V-1-R],Ce=Le.faceidx,ze[Ce]=Re[0],ze[Ce+1]=Re[1],ze[Ce+2]=Re[3],ze[Ce+3]=Re[1],ze[Ce+4]=Re[2],ze[Ce+5]=Re[3],Le.faceidx+=6;for(R=0;R<V-1;R++)Re=[Z-1-R,Z-2-R,Z-2*V+R+1,Z-2*V+R],Ce=Le.faceidx,ze[Ce]=Re[0],ze[Ce+1]=Re[1],ze[Ce+2]=Re[3],ze[Ce+3]=Re[1],ze[Ce+4]=Re[2],ze[Ce+5]=Re[3],Le.faceidx+=6}function v(O,F,I,B,k,U){if(!(F.length<2)){var W,R;if(W=F[0],R=F[F.length-1],W=u(W,B),R=u(R,B),!k)return c(O,W,R,I);var z=[],V,q,Q,re,te,ae=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],ne,le,Ee,De,Pe,pe,Z,be,Ce,ie,Ne,Ve,Ue,Fe,ze,Re,Le;for(be=0,Ce=W.length;be<Ce;be++){if(Pe=Math.round(be*(I.length-1)/Ce),De=a.CC.color(I[Pe]),z.push(q=W[be]),z.push(q),z.push(Q=R[be]),z.push(Q),be<Ce-1){var We=W[be+1].clone().sub(W[be]),He=R[be].clone().sub(W[be]);V=He.cross(We).normalize().multiplyScalar(k)}for(z.push(re=W[be].clone().add(V)),z.push(re),z.push(te=R[be].clone().add(V)),z.push(te),q.atom!==void 0&&(pe=q.atom),Fe=O.updateGeoGroup(8),ze=Fe.vertexArray,Re=Fe.colorArray,Le=Fe.faceArray,ne=Fe.vertices,le=ne*3,ze[le]=q.x,ze[le+1]=q.y,ze[le+2]=q.z,ze[le+3]=q.x,ze[le+4]=q.y,ze[le+5]=q.z,ze[le+6]=Q.x,ze[le+7]=Q.y,ze[le+8]=Q.z,ze[le+9]=Q.x,ze[le+10]=Q.y,ze[le+11]=Q.z,ze[le+12]=re.x,ze[le+13]=re.y,ze[le+14]=re.z,ze[le+15]=re.x,ze[le+16]=re.y,ze[le+17]=re.z,ze[le+18]=te.x,ze[le+19]=te.y,ze[le+20]=te.z,ze[le+21]=te.x,ze[le+22]=te.y,ze[le+23]=te.z,ie=0;ie<8;++ie)Re[le+3*ie]=De.r,Re[le+1+3*ie]=De.g,Re[le+2+3*ie]=De.b;if(be>0){var H=Z!==void 0&&pe!==void 0&&Z.serial!==pe.serial;for(ie=0;ie<4;ie++){var K=[ne+ae[ie][0],ne+ae[ie][1],ne+ae[ie][2],ne+ae[ie][3]];if(Ee=Fe.faceidx,Le[Ee]=K[0],Le[Ee+1]=K[1],Le[Ee+2]=K[3],Le[Ee+3]=K[1],Le[Ee+4]=K[2],Le[Ee+5]=K[3],Fe.faceidx+=6,pe.clickable||Z.clickable||pe.hoverable||Z.hoverable){var X=z[K[3]].clone(),_e=z[K[0]].clone(),ue=z[K[2]].clone(),ye=z[K[1]].clone();if(X.atom=z[K[3]].atom||null,ue.atom=z[K[2]].atom||null,_e.atom=z[K[0]].atom||null,ye.atom=z[K[1]].atom||null,H){var Ae=X.clone().add(_e).multiplyScalar(.5),G=ue.clone().add(ye).multiplyScalar(.5),ce=X.clone().add(ye).multiplyScalar(.5);ie%2===0?((Z.clickable||Z.hoverable)&&(Ne=new n.Triangle(Ae,ce,X),Ve=new n.Triangle(G,ue,ce),Ue=new n.Triangle(ce,ue,X),Z.intersectionShape.triangle.push(Ne),Z.intersectionShape.triangle.push(Ve),Z.intersectionShape.triangle.push(Ue)),(pe.clickable||pe.hoverable)&&(Ne=new n.Triangle(_e,ye,ce),Ve=new n.Triangle(ye,G,ce),Ue=new n.Triangle(_e,ce,Ae),pe.intersectionShape.triangle.push(Ne),pe.intersectionShape.triangle.push(Ve),pe.intersectionShape.triangle.push(Ue))):((pe.clickable||pe.hoverable)&&(Ne=new n.Triangle(Ae,ce,X),Ve=new n.Triangle(G,ue,ce),Ue=new n.Triangle(ce,ue,X),pe.intersectionShape.triangle.push(Ne),pe.intersectionShape.triangle.push(Ve),pe.intersectionShape.triangle.push(Ue)),(Z.clickable||Z.hoverable)&&(Ne=new n.Triangle(_e,ye,ce),Ve=new n.Triangle(ye,G,ce),Ue=new n.Triangle(_e,ce,Ae),Z.intersectionShape.triangle.push(Ne),Z.intersectionShape.triangle.push(Ve),Z.intersectionShape.triangle.push(Ue)))}else(pe.clickable||pe.hoverable)&&(Ne=new n.Triangle(_e,ye,X),Ve=new n.Triangle(ye,ue,X),pe.intersectionShape.triangle.push(Ne),pe.intersectionShape.triangle.push(Ve))}}}Fe.vertices+=8,Z=pe}var ve=z.length-8;for(Fe=O.updateGeoGroup(8),ze=Fe.vertexArray,Re=Fe.colorArray,Le=Fe.faceArray,ne=Fe.vertices,le=ne*3,Ee=Fe.faceidx,be=0;be<4;be++){z.push(z[be*2]),z.push(z[ve+be*2]);var Oe=z[be*2],oe=z[ve+be*2];ze[le+6*be]=Oe.x,ze[le+1+6*be]=Oe.y,ze[le+2+6*be]=Oe.z,ze[le+3+6*be]=oe.x,ze[le+4+6*be]=oe.y,ze[le+5+6*be]=oe.z,Re[le+6*be]=De.r,Re[le+1+6*be]=De.g,Re[le+2+6*be]=De.b,Re[le+3+6*be]=De.r,Re[le+4+6*be]=De.g,Re[le+5+6*be]=De.b}ve+=8,Ne=[ne,ne+2,ne+6,ne+4],Ve=[ne+1,ne+5,ne+7,ne+3],Le[Ee]=Ne[0],Le[Ee+1]=Ne[1],Le[Ee+2]=Ne[3],Le[Ee+3]=Ne[1],Le[Ee+4]=Ne[2],Le[Ee+5]=Ne[3],Le[Ee+6]=Ve[0],Le[Ee+7]=Ve[1],Le[Ee+8]=Ve[3],Le[Ee+9]=Ve[1],Le[Ee+10]=Ve[2],Le[Ee+11]=Ve[3],Fe.faceidx+=12,Fe.vertices+=8}}function y(O,F,I,B,k,U,W){(!W||W==="default")&&(W="rectangle"),W==="edged"?v(O,F,I,B,k):(W==="rectangle"||W==="oval"||W==="parabola")&&f(O,F,I,B,k,U,W)}function D(O){return O&&O.elem==="C"&&O.atom==="CA"}function E(O,F){if(O&&F&&O.chain===F.chain){if(!O.hetflag&&!F.hetflag&&O.reschain===F.reschain&&(O.resi===F.resi||O.resi===F.resi-1))return!0;if(O.resi<F.resi){var I=O.x-F.x,B=O.y-F.y,k=O.z-F.z,U=I*I+B*B+k*k;if(O.atom=="CA"&&F.atom=="CA"&&U<16)return!0;if((O.atom=="P"||F.atom=="P")&&U<64)return!0}}return!1}function p(O,F,I,B,k){if(!(F==null||F.vertices==0)){k&&(F.initTypedArrays(),F.setUpNormals());var U=new s.MeshDoubleLambertMaterial;U.vertexColors=s.Coloring.FaceColors,typeof I=="number"&&I>=0&&I<1&&(U.transparent=!0,U.opacity=I),U.outline=B;var W=new s.Mesh(F,U);O.add(W)}}function x(O,F,I,B,k,U,W,R,z){var V,q,Q,re,te,ae;if(!(!B||!k||!W)){var ne=k.sub(B);ne.normalize();var le=R[z];for(q=z+1;q<R.length&&(le=R[q],le.atom!=W.atom);q++);if(le=le?new i.Vector3(le.x,le.y,le.z):new i.Vector3(0,0,0),le.sub(B),W.ss==="arrow start"){var Ee=le.clone().multiplyScalar(.3).cross(k);B.add(Ee);var De=le.clone().cross(ne).normalize();ne.rotateAboutVector(De,.43)}for(W.style.cartoon.ribbon?V=W.style.cartoon.thickness||b:W.style.cartoon.width?V=W.style.cartoon.width:W.ss==="c"?W.atom==="P"?V=_:V=g:W.ss==="arrow start"?(V=m,te=!0):W.ss==="arrow end"||W.ss==="h"&&W.style.cartoon.tubes||W.ss==="tube start"?V=g:V=m,U!=null&&ne.dot(U)<0&&ne.negate(),ne.multiplyScalar(V),q=0;q<F;q++)Q=-1+q*2/(F-1),re=new i.Vector3(B.x+Q*ne.x,B.y+Q*ne.y,B.z+Q*ne.z),re.atom=W,W.ss==="s"&&(re.smoothen=!0),O[q].push(re);if(te)for(ne.multiplyScalar(2),q=0;q<F;q++)Q=-1+q*2/(F-1),re=new i.Vector3(B.x+Q*ne.x,B.y+Q*ne.y,B.z+Q*ne.z),re.atom=W,re.smoothen=!1,re.skip=!0,O[q].push(re);return ae=W.style.cartoon.style||"default",O.style?O.style!=ae&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),O.style="default"):O.style=ae,(W.ss==="arrow start"||W.ss==="arrow end")&&(W.ss="s"),te}}const w={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},C={DA:!0,DG:!0,A:!0,G:!0},S={DT:!0,DC:!0,U:!0,C:!0,T:!0},A={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function P(O,F,I,B=10){let k=B,U=B;var W,R,z,V,q,Q,re,te,ae,ne,le,Ee,De,Pe,pe,Z,be,Ce,ie=new s.Geometry(!0),Ne=new s.Geometry(!0),Ve=[],Ue=[],Fe=1,ze=!1,Re={};for(var Le in o.Gradient.builtinGradients)o.Gradient.builtinGradients.hasOwnProperty(Le)&&(Re[Le]=new o.Gradient.builtinGradients[Le](I[1],I[0]));var We=function(ke,L){return I&&L.color==="spectrum"?L.colorscheme in Re?Re[L.colorscheme].valueToHex(ke.resi):Re.sinebow.valueToHex(ke.resi):(0,h.getColorFromStyle)(ke,L).getHex()};for(te=0;te<k;te++)Ue[te]=[];var He=!1,H=!1,K=[];for(te in F){if(V=F[te],V.elem==="C"&&V.atom==="CA"){var X=E(z,V);X&&V.ss==="s"?He=!0:He&&(z&&R&&z.style.cartoon.arrows&&R.style.cartoon.arrows&&(z.ss="arrow end",R.ss="arrow start"),He=!1),X&&(z.ss==="h"||z.ss=="tube start")&&z.style.cartoon.tubes?!H&&z.ss!="tube start"&&V.style.cartoon.tubes&&(V.ss="tube start",H=!0):H&&(z.ss==="tube start"?z.ss="tube end":R&&R.style.cartoon.tubes&&(R.ss="tube end"),H=!1),R=z,z=V}V&&V.atom in w&&K.push(V)}H&&z.style.cartoon.tubes&&(z.ss="tube end",H=!1);var _e=function(ke){Ue[0].length>0&&y(Ne,Ue,Ve,U,re,Fe,Ue.style);var L=[],ge=null;if(ke){for(te=0;te<k;te++)L[te]=Ue[te][Ue[te].length-1];ge=Ve[Ve.length-1]}for(Ue=[],te=0;te<k;te++)Ue[te]=[];if(Ve=[],ke){for(te=0;te<k;te++)Ue[te].push(L[te]);Ve.push(ge)}p(O,Ne,Fe,ze,!0),p(O,ie,Fe,ze,!1),Ne=new s.Geometry(!0),ie=new s.Geometry(!0)};z=void 0;let ue=[];for(var ye=0;ye<K.length;ye++){V=K[ye];var Ae=V.resn.trim(),G=Ae in A;if(Fe=1,W=V.style.cartoon,z&&z.style.cartoon&&(Fe=z.style.cartoon.opacity),z&&z.style.cartoon&&z.style.cartoon.outline&&(ze=z.style.cartoon.outline),z&&z.style.cartoon&&(!V.style.cartoon||z.style.cartoon.opacity!=V.style.cartoon.opacity)&&_e(z.chain==V.chain),z&&V&&!E(z,V)&&z.chain&&z.chain==V.chain&&!z.hetflag&&!V.hetflag&&z.reschain+1==V.reschain&&ue.push([z,V]),W.style==="trace"){if(!V.hetflag){if(V.elem==="C"&&V.atom==="CA"||G&&V.atom==="P"||V.atom==="BB"){if(Q=We(V,W),(0,h.isNumeric)(W.thickness)?re=W.thickness:re=b,E(z,V))if(Q==q){var ce=a.CC.color(Q);l.GLDraw.drawCylinder(ie,z,V,re,ce,2,2)}else{var ve=new i.Vector3().addVectors(z,V).multiplyScalar(.5),Oe=a.CC.color(q),oe=a.CC.color(Q);l.GLDraw.drawCylinder(ie,z,ve,re,Oe,2,0),l.GLDraw.drawCylinder(ie,ve,V,re,oe,0,2)}if((V.clickable===!0||V.hoverable)&&V.intersectionShape!==void 0){var me=new i.Vector3(V.x,V.y,V.z);V.intersectionShape.sphere.push(new n.Sphere(me,re))}z=V,q=Q}}}else{if(D(V)||G&&(V.atom==="P"||V.atom.indexOf("O5")==0)){if(Ce)if(V.ss==="tube end")Ce=!1,be=new i.Vector3(V.x,V.y,V.z),l.GLDraw.drawCylinder(ie,Z,be,2,a.CC.color(q),1,1),V.ss="h";else if(z.chain!=V.chain||z.ss==="tube end")Ce=!1,z.ss="h",be=new i.Vector3(z.x,z.y,z.z),l.GLDraw.drawCylinder(ie,Z,be,2,a.CC.color(q),1,1);else continue;if(z&&(!E(z,V)||z.ss==="tube start")){for(z.ss==="tube start"&&(Ce=!0,Z=new i.Vector3(z.x,z.y,z.z),z.ss="h"),pe&&(Ee?Pe=new i.Vector3().addVectors(z,Ee).multiplyScalar(.5):Pe=new i.Vector3(z.x,z.y,z.z),l.GLDraw.drawCylinder(ie,Pe,pe,d,a.CC.color(pe.color),0,2),x(Ue,k,!0,Ee,De,le,z,K,ye),Ve.push(Q),Pe=null,pe=null),Ue[0].length>0&&y(Ne,Ue,Ve,U,re,Fe,Ue.style),Ue=[],te=0;te<k;te++)Ue[te]=[];Ve=[]}if(z===void 0||z.rescode!=V.rescode||z.resi!=V.resi){if(pe&&z!=null){Pe=new i.Vector3().addVectors(z,V).multiplyScalar(.5);var $=Pe.clone().sub(pe).multiplyScalar(.02);Pe.add($),l.GLDraw.drawCylinder(ie,Pe,pe,d,a.CC.color(pe.color),0,2),Pe=null,pe=null}Q=We(V,W),Ve.push(Q),(0,h.isNumeric)(W.thickness)?re=W.thickness:re=b,z=V,ae=new i.Vector3(z.x,z.y,z.z),ae.resi=z.resi,q=Q}(V.clickable===!0||V.hoverable===!0)&&(V.intersectionShape===void 0||V.intersectionShape.triangle===void 0)&&(V.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else z!=null&&(D(z)&&V.atom==="O"||G&&z.atom==="P"&&(V.atom==="OP2"||V.atom==="O2P")||G&&z.atom.indexOf("O5")==0&&V.atom.indexOf("C5")==0)?(ne=new i.Vector3(V.x,V.y,V.z),ne.resi=V.resi,(V.atom==="OP2"||V.atom==="O2P")&&(De=new i.Vector3(V.x,V.y,V.z))):G&&V.atom.indexOf("O3")==0?Ee=new i.Vector3(V.x,V.y,V.z):(V.atom==="N1"&&Ae in C||V.atom==="N3"&&Ae in S)&&(pe=new i.Vector3(V.x,V.y,V.z),pe.color=(0,h.getColorFromStyle)(V,W).getHex());ne&&ae&&ne.resi===ae.resi&&(x(Ue,k,!0,ae,ne,le,z,K,ye),le=ne,ae=null,ne=null,Ve.push(Q))}}pe&&(Ee?Pe=new i.Vector3().addVectors(z,Ee).multiplyScalar(.5):Pe=new i.Vector3(z.x,z.y,z.z),l.GLDraw.drawCylinder(ie,Pe,pe,d,a.CC.color(pe.color),0,2),x(Ue,k,!0,Ee,De,le,z,K,ye),Ve.push(Q)),_e(!1);var Te=function(ke,L){if(ke.style.cartoon.gapcutoff&&ke.style.cartoon.gapcutoff==L.style.cartoon.gapcutoff){let de=ke.style.cartoon.gapcutoff,j=L.resi-ke.resi;if(j>0&&j<de){let se=.25,he=L.x-ke.x,Ie=L.y-ke.y,Be=L.z-ke.z,we=Math.sqrt(he*he+Ie*Ie+Be*Be),je=we/(2*j),Xe=new i.Vector3(ke.x,ke.y,ke.z),Ke=we/je,Je=new i.Vector3((L.x-ke.x)/Ke,(L.y-ke.y)/Ke,(L.z-ke.z)/Ke);Xe.add({x:Je.x/2,y:Je.y/2,z:Je.z/2});let Ye=Xe.clone().add(Je);Je.multiplyScalar(2);let rt=(0,h.extend)({},ke);for(var ge=0;ge<j;ge++){rt.resi+=1;let st=We(rt,rt.style.cartoon);l.GLDraw.drawCylinder(ie,Xe,Ye,se,a.CC.color(st),l.CAP.FLAT,l.CAP.FLAT),Xe.add(Je),Ye.add(Je)}_e(!1)}}};for(let ke of ue)Te(ke[0],ke[1])}},"./src/index.ts":(r,e,t)=>{t.r(e),t.d(e,{CAP:()=>i.CAP,CC:()=>i.CC,CONTEXTS_PER_VIEWPORT:()=>i.CONTEXTS_PER_VIEWPORT,Color:()=>i.Color,CustomLinear:()=>i.CustomLinear,Cylinder:()=>i.Cylinder,GLDraw:()=>i.GLDraw,GLModel:()=>i.GLModel,GLShape:()=>i.GLShape,GLViewer:()=>i.GLViewer,GLVolumetricRender:()=>i.GLVolumetricRender,Gradient:()=>i.Gradient,GradientType:()=>i.GradientType,Label:()=>i.Label,LabelCount:()=>i.LabelCount,MarchingCube:()=>i.MarchingCube,MarchingCubeInitializer:()=>i.MarchingCubeInitializer,Matrix3:()=>i.Matrix3,Matrix4:()=>i.Matrix4,Parsers:()=>i.Parsers,PausableTimer:()=>i.PausableTimer,PointGrid:()=>i.PointGrid,ProteinSurface:()=>i.ProteinSurface,Quaternion:()=>i.Quaternion,ROYGB:()=>i.ROYGB,RWB:()=>i.RWB,Ray:()=>i.Ray,Sinebow:()=>i.Sinebow,Sphere:()=>i.Sphere,SurfaceType:()=>i.SurfaceType,Triangle:()=>i.Triangle,Vector2:()=>i.Vector2,Vector3:()=>i.Vector3,VolumeData:()=>i.VolumeData,adjustVolumeStyle:()=>i.adjustVolumeStyle,applyPartialCharges:()=>i.applyPartialCharges,autoinit:()=>i.autoinit,autoload:()=>i.autoload,base64ToArray:()=>i.base64ToArray,bondLength:()=>i.bondLength,builtinColorSchemes:()=>i.builtinColorSchemes,builtinGradients:()=>i.builtinGradients,chains:()=>i.chains,clamp:()=>i.clamp,conversionMatrix3:()=>i.conversionMatrix3,createStereoViewer:()=>i.createStereoViewer,createViewer:()=>i.createViewer,createViewerGrid:()=>i.createViewerGrid,deepCopy:()=>i.deepCopy,degToRad:()=>i.degToRad,download:()=>i.download,drawCartoon:()=>i.drawCartoon,elementColors:()=>i.elementColors,extend:()=>i.extend,get:()=>i.get,getAtomProperty:()=>i.getAtomProperty,getColorFromStyle:()=>i.getColorFromStyle,getElement:()=>i.getElement,getExtent:()=>i.getExtent,getGradient:()=>i.getGradient,getPropertyRange:()=>i.getPropertyRange,getbin:()=>i.getbin,htmlColors:()=>i.htmlColors,inflateString:()=>i.inflateString,isEmptyObject:()=>i.isEmptyObject,isNumeric:()=>i.isNumeric,makeFunction:()=>i.makeFunction,mergeGeos:()=>i.mergeGeos,normalizeValue:()=>i.normalizeValue,partialCharges:()=>i.partialCharges,processing_autoinit:()=>i.processing_autoinit,residues:()=>i.residues,setBondLength:()=>i.setBondLength,setSyncSurface:()=>i.setSyncSurface,specStringToObject:()=>i.specStringToObject,splitMesh:()=>i.splitMesh,ssColors:()=>i.ssColors,subdivide_spline:()=>i.subdivide_spline,syncSurface:()=>i.syncSurface,viewers:()=>i.viewers});var i=t("./src/3Dmol.ts");window&&(window.$3Dmol=e)},"./src/parsers/BCIF.ts":(r,e,t)=>{t.r(e),t.d(e,{BCIF:()=>b});var i=t("./src/utilities.ts"),n=t("./src/parsers/utils/computeSecondaryStructure.ts"),s=t("./src/parsers/utils/processSymmetries.ts"),o=t("./src/parsers/cifutils/category.ts"),a=t("./src/parsers/utils/assignPDBBonds.ts"),l=t("./src/WebGL/index.ts"),h=t("./src/parsers/utils/isEmpty.ts"),u=t("./src/vendor/mmtf.js");class g{constructor(c){if(this.C={},c){let f=c.getField("comp_id"),v=c.getField("atom_id_1"),y=c.getField("atom_id_2"),D=c.getField("value_order");for(let E=0;E<f.length;E++){let p=f[E],x=v[E],w=y[E],C=D[E],S=1;C=="doub"?S=2:C=="trip"&&(S=3),this.C[p]==null&&(this.C[p]={}),this.C[p][x]==null&&(this.C[p][x]={}),this.C[p][w]==null&&(this.C[p][w]={}),this.C[p][x][w]=S,this.C[p][w][x]=S}}}order(c,f,v){return this.C[c]!==void 0&&this.C[c][f]!==void 0&&this.C[c][f][v]!==void 0?this.C[c][f][v]:0}}class m{constructor(c){if(this.C=[],c){let f=c.getField("conn_type_id"),v=c.getField("ptnr1_label_asym_id"),y=c.getField("ptnr1_label_seq_id"),D=c.getField("ptnr1_label_comp_id"),E=c.getField("ptnr1_label_atom_id"),p=c.getField("ptnr2_label_asym_id"),x=c.getField("ptnr2_label_seq_id"),w=c.getField("ptnr2_label_comp_id"),C=c.getField("ptnr2_label_atom_id"),S=c.getField("pdbx_value_order");for(let A=0;A<f.length;A++)if(f[A]=="disulf"||f[A]=="covale"){let P=S?S[A]==""?1:parseInt(S[A]):1;this.C.push([[v[A],y[A],D[A],E[A]],[p[A],x[A],w[A],C[A]],P])}}}}class _{constructor(){this.R={}}add(c){this.R[c.lchain]==null&&(this.R[c.lchain]={}),this.R[c.lchain][c.lresi]==null&&(this.R[c.lchain][c.lresi]={}),this.R[c.lchain][c.lresi][c.lresn]==null&&(this.R[c.lchain][c.lresi][c.lresn]=[]),this.R[c.lchain][c.lresi][c.lresn].push(c),this.R[c.lchain][c.lresi][c.lresn][c.atom]=c}geta([c,f,v,y]){if(this.R[c]!==void 0&&this.R[c][f]!==void 0&&this.R[c][f][v]!==void 0)return this.R[c][f][v][y]}setBonds(c,f){for(let v in this.R)for(let y in this.R[v])for(let D in this.R[v][y]){let E=this.R[v][y][D];for(let p=0;p<E.length;p++)for(let x=p+1;x<E.length;x++){let w=E[p],C=E[x],S=c.order(D,w.atom,C.atom);w.altLoc!=C.altLoc&&w.altLoc!=""&&C.altLoc!=""&&(S=0),S>0&&(w.bonds.push(C.index),C.bonds.push(w.index),w.bondOrder.push(S),C.bondOrder.push(S))}}for(let v of f.C){let y=v[0],D=v[1],E=v[2],p=this.geta(y),x=this.geta(D);p!=null&&x!=null&&(p.bonds.push(x.index),x.bonds.push(p.index),p.bondOrder.push(E),x.bondOrder.push(E))}}}function b(d,c){var f=!c.keepH,v=c.altLoc?c.altLoc:"A",y=!c.noComputeSecondaryStructure;const D=!c.doAssembly,E=c.assignBonds===void 0?!0:c.assignBonds;if(typeof d=="string")try{d=(0,i.base64ToArray)(d)}catch{d=new TextEncoder().encode(d)}else d=new Uint8Array(d);var p=u.decodeMsgpack(d);p==31&&(d=(0,i.inflateString)(d,!1),p=u.decodeMsgpack(d));var x=[],w=x.modelData=[],C=p.dataBlocks.length;if(C==0)return x;c.multimodel||(C=1);for(let S=0;S<C;S++){let A=x.length;const P=[];w.push({symmetries:[]}),x.push([]);const O=p.dataBlocks[S],F=Object.create(null);for(const Re of O.categories)F[Re.name.substr(1)]=(0,o.Category)(Re);let I={},B=F.struct_conf;if(B){let Re=B.getField("conf_type_id"),Le=B.getField("beg_label_asym_id"),We=B.getField("beg_label_seq_id"),He=B.getField("end_label_seq_id");for(let H=0;H<Re.length;H++)if(Re[H].startsWith("H")){let K=Le[H],X=We[H],_e=He[H];K in I||(I[K]={}),I[K][X]="h1";for(let ue=X+1;ue<_e;ue++)I[K][ue]="h";I[K][_e]="h2"}}let k=F.struct_sheet_range;if(k){let Re=k.getField("id"),Le=k.getField("beg_label_asym_id"),We=k.getField("beg_label_seq_id"),He=k.getField("end_label_seq_id");for(let H=0;H<Re.length;H++){let K=Le[H],X=We[H],_e=He[H];K in I||(I[K]={}),I[K][X]="s1";for(let ue=X+1;ue<_e;ue++)I[K][ue]="s";I[K][_e]="s2"}}let U=F.pdbx_struct_oper_list,W=U.getField("id");if(W&&!D){let Re=U.getField("matrix[1][1]"),Le=U.getField("matrix[1][2]"),We=U.getField("matrix[1][3]"),He=U.getField("matrix[2][1]"),H=U.getField("matrix[2][2]"),K=U.getField("matrix[2][3]"),X=U.getField("matrix[3][1]"),_e=U.getField("matrix[3][2]"),ue=U.getField("matrix[3][3]"),ye=U.getField("vector[1]"),Ae=U.getField("vector[2]"),G=U.getField("vector[3]");for(let ce=0;ce<W.length;ce++){const ve=new l.Matrix4(Re[ce],Le[ce],We[ce],ye[ce],He[ce],H[ce],K[ce],Ae[ce],X[ce],_e[ce],ue[ce],G[ce]);w[w.length-1].symmetries.push(ve)}}let R=new g(F.chem_comp_bond),z=new _,V=new m(F.struct_conn),q=F.atom_site,Q=q.rowCount,re=q.getField("group_PDB"),te=q.getField("Cartn_x"),ae=q.getField("Cartn_y"),ne=q.getField("Cartn_z"),le=q.getField("auth_asym_id"),Ee=q.getField("label_asym_id"),De=q.getField("auth_seq_id"),Pe=q.getField("label_seq_id"),pe=q.getField("auth_comp_id"),Z=q.getField("label_comp_id"),be=q.getField("auth_atom_id"),Ce=q.getField("label_atom_id"),ie=q.getField("type_symbol"),Ne=q.getField("B_iso_or_equiv"),Ve=q.getField("id"),Ue=q.getField("label_alt_id"),Fe=q.getField("pdbx_PDB_model_num"),ze=Fe?Fe[0]:0;for(let Re=0;Re<Q;Re++){if(re!==void 0&&re[Re]==="TER")continue;if(Fe&&Fe[Re]!=ze)if(ze=Fe[Re],c.multimodel)c.onemol||(x.push([]),w.push(w[w.length-1]),ze=Fe[Re],z.setBonds(R,V),z=new _);else break;const Le={};Le.x=te[Re],Le.y=ae[Re],Le.z=ne[Re],Le.chain=le?le[Re]:Ee?Ee[Re]:void 0,Le.lchain=Ee?Ee[Re]:void 0,Le.resi=De?De[Re]:Pe?Pe[Re]:void 0,Le.lresi=Pe?Pe[Re]:void 0,Le.resn=pe?pe[Re].trim():Z?Z[Re].trim():void 0,Le.lresn=Z?Z[Re].trim():void 0,Le.atom=be?be[Re].replace(/"/gm,""):Ce?Ce[Re].replace(/"/gm,""):void 0,Le.icode=Ue?Ue[Re]:void 0,Le.altLoc=Le.icode,Le.hetflag=!re||re[Re]==="HETA"||re[Re]==="HETATM";let We="X";ie&&(We=ie[Re].replace(/\(?\+?\d+.*/,"")),Le.elem=We[0].toUpperCase()+We.substring(1,2).toLowerCase(),Ne&&(Le.b=Ne[Re]),!(f&&Le.elem=="H")&&(Le.altLoc!=""&&Le.altLoc!=v&&v!="*"||(Le.bonds=[],Le.ss="c",Le.serial=Ve[Re],Le.model=ze,Le.bondOrder=[],Le.properties={},Le.index=x[x.length-1].length,P[Le.serial]=[x.length,Le.index],x[x.length-1].push(Le),z.add(Le)))}if(z.setBonds(R,V),!(0,h.isEmpty)(I))for(let Re=A;Re<x.length;Re++){let Le=x[Re];for(let We=0;We<Le.length;We++){const He=Le[We];if(He!==void 0&&He.lchain in I&&He.lresi in I[He.lchain]){const H=I[He.lchain][He.lresi];He.ss=H[0],H.length>1&&(H[1]=="1"?He.ssbegin=!0:H[1]=="2"&&(He.ssend=!0))}}}c.multimodel&&S<C-1&&(c.onemol||(x.push([]),w.push({symmetries:[]})))}for(let S=0;S<x.length;S++)E&&!(c.duplicateAssemblyAtoms&&!c.dontConnectDuplicatedAtoms)&&(0,a.assignPDBBonds)(x[S],c),y&&(0,n.computeSecondaryStructure)(x[S],c.hbondCutoff),(0,s.processSymmetries)(w[S].symmetries,x[S],c,w[S].cryst),c.duplicateAssemblyAtoms&&!c.dontConnectDuplicatedAtoms&&E&&(0,a.assignPDBBonds)(x[S],c);return x}},"./src/parsers/CDJSON.ts":(r,e,t)=>{t.r(e),t.d(e,{CDJSON:()=>i});function i(n,s){var o=[[]];typeof n=="string"&&(n=JSON.parse(n));for(var a=n.m,l=a[0].a,h=a[0].b,u=a[0].s,g=s!==void 0&&s.parseStyle!==void 0?s.parseStyle:u!==void 0,m=o[o.length-1].length,_=0;_<l.length;_++){var b=l[_],d={};d.id=b.i,d.x=b.x,d.y=b.y,d.z=b.z||0,d.bonds=[],d.bondOrder=[];var c=b.l||"C";d.elem=c[0].toUpperCase()+c.substring(1).toLowerCase(),d.serial=o[o.length-1].length,g&&(d.style=u[b.s||0]),o[o.length-1].push(d)}for(let f=0;f<h.length;f++){let v=h[f],y=v.b+m,D=v.e+m,E=v.o||1,p=o[o.length-1][y],x=o[o.length-1][D];p.bonds.push(D),p.bondOrder.push(E),x.bonds.push(y),x.bondOrder.push(E)}return o}},"./src/parsers/CIF.ts":(r,e,t)=>{t.r(e),t.d(e,{CIF:()=>l});var i=t("./src/parsers/utils/computeSecondaryStructure.ts"),n=t("./src/parsers/utils/processSymmetries.ts"),s=t("./src/WebGL/index.ts"),o=t("./src/parsers/utils/assignPDBBonds.ts");const a=function(h,u,g,m){return new s.Vector3(u,g,m).applyMatrix3(h)};function l(h,u={}){const g=[],m=!u.doAssembly,_=g.modelData=[],b=u.assignBonds===void 0?!0:u.assignBonds;function d(E,p){const x=[];let w=0,C=0;for(;C<E.length;){for(;E.substring(C,C+p.length)!==p&&C<E.length;)if(E[C]==="'"){for(C++;C<E.length&&E[C]!=="'";)C++;for(;E.substring(C,C+p.length)!==p&&C<E.length;)C++}else if(E[C]==='"'){for(C++;C<E.length&&E[C]!=='"';)C++;C++}else C++;x.push(E.substring(w,C)),w=C=C+p.length}return x}const c=h.split(/\r?\n|\r/),f=[];let v=!1;for(let E=0;E<c.length;E++){var y=c[E].split("#")[0];if(v?y[0]===";"&&(v=!1):y[0]===";"&&(v=!0),v||y!==""){if(!v&&(y=y.trim(),y[0]==="_")){const p=y.split(/\s/)[0].indexOf(".");if(p>-1){let x=y.split("");x[p]="_",y=x.join(""),y=y.substring(0,p)+"_"+y.substring(p+1)}}f.push(y)}}let D=0;for(;D<f.length;){for(;!f[D].startsWith("data_")||f[D]==="data_global";)D++;D++;const E={};for(;D<f.length&&!f[D].startsWith("data_");)if(f[D][0]===void 0)D++;else if(f[D][0]==="_"){const C=f[D].split(/\s/)[0].toLowerCase(),S=E[C]=E[C]||[],A=f[D].substring(f[D].indexOf(C)+C.length);if(A==="")if(D++,f[D][0]===";"){let P=f[D].substring(1);for(D++;f[D]!==";";)P=P+`
`+f[D],D++;S.push(P)}else S.push(f[D]);else S.push(A.trim());D++}else if(f[D].substring(0,5)==="loop_"){D++;const C=[];for(;f[D]===""||f[D][0]==="_";){if(f[D]!==""){let A=f[D].split(/\s/)[0].toLowerCase(),P=E[A]=E[A]||[];C.push(P)}D++}let S=0;for(;D<f.length&&f[D][0]!=="_"&&!f[D].startsWith("loop_")&&!f[D].startsWith("data_");){let A=d(f[D]," ");for(let P=0;P<A.length;P++)A[P]!==""&&(C[S].push(A[P]),S=(S+1)%C.length);D++}}else D++;_.push({symmetries:[]}),g.push([]);const p=E._atom_site_id!==void 0?E._atom_site_id.length:E._atom_site_label.length;let x;if(E._cell_length_a!==void 0){const C=parseFloat(E._cell_length_a),S=parseFloat(E._cell_length_b),A=parseFloat(E._cell_length_c),P=parseFloat(E._cell_angle_alpha)||90,O=parseFloat(E._cell_angle_beta)||90,F=parseFloat(E._cell_angle_gamma)||90;x=(0,s.conversionMatrix3)(C,S,A,P,O,F),_[_.length-1].cryst={a:C,b:S,c:A,alpha:P,beta:O,gamma:F}}for(let C=0;C<p;C++){if(E._atom_site_group_pdb!==void 0&&E._atom_site_group_pdb[C]==="TER")continue;const S={};if(E._atom_site_cartn_x!==void 0)S.x=parseFloat(E._atom_site_cartn_x[C]),S.y=parseFloat(E._atom_site_cartn_y[C]),S.z=parseFloat(E._atom_site_cartn_z[C]);else{const P=a(x,parseFloat(E._atom_site_fract_x[C]),parseFloat(E._atom_site_fract_y[C]),parseFloat(E._atom_site_fract_z[C]));S.x=P.x,S.y=P.y,S.z=P.z}S.chain=E._atom_site_auth_asym_id?E._atom_site_auth_asym_id[C]:E._atom_site_label_asym_id?E._atom_site_label_asym_id[C]:void 0,S.lchain=E._atom_site_label_asym_id?E._atom_site_label_asym_id[C]:void 0,S.resi=E._atom_site_auth_seq_id?parseInt(E._atom_site_auth_seq_id[C]):E._atom_site_label_seq_id?E._atom_site_label_seq_id[C]:void 0,S.resn=E._atom_site_auth_comp_id?E._atom_site_auth_comp_id[C].trim():E._atom_site_label_comp_id?E._atom_site_label_comp_id[C].trim():void 0,S.atom=E._atom_site_auth_atom_id?E._atom_site_auth_atom_id[C].replace(/"/gm,""):E._atom_site_label_atom_id?E._atom_site_label_atom_id[C].replace(/"/gm,""):void 0,S.hetflag=!E._atom_site_group_pdb||E._atom_site_group_pdb[C]==="HETA"||E._atom_site_group_pdb[C]==="HETATM",E._atom_site_b_iso_or_equiv&&(S.b=parseFloat(E._atom_site_b_iso_or_equiv[C]));let A="X";E._atom_site_type_symbol?A=E._atom_site_type_symbol[C].replace(/\(?\+?\d+.*/,""):E._atom_site_label&&(A=E._atom_site_label[C].split("_")[0].replace(/\(?\d+.*/,"")),S.elem=A[0].toUpperCase()+A.substring(1,2).toLowerCase(),S.bonds=[],S.ss="c",S.serial=C,S.bondOrder=[],S.properties={},g[g.length-1].push(S)}if(E._pdbx_struct_oper_list_id!==void 0&&!m)for(let C=0;C<E._pdbx_struct_oper_list_id.length;C++){const S=parseFloat(E["_pdbx_struct_oper_list_matrix[1][1]"][C]),A=parseFloat(E["_pdbx_struct_oper_list_matrix[1][2]"][C]),P=parseFloat(E["_pdbx_struct_oper_list_matrix[1][3]"][C]),O=parseFloat(E["_pdbx_struct_oper_list_vector[1]"][C]),F=parseFloat(E["_pdbx_struct_oper_list_matrix[2][1]"][C]),I=parseFloat(E["_pdbx_struct_oper_list_matrix[2][2]"][C]),B=parseFloat(E["_pdbx_struct_oper_list_matrix[2][3]"][C]),k=parseFloat(E["_pdbx_struct_oper_list_vector[2]"][C]),U=parseFloat(E["_pdbx_struct_oper_list_matrix[3][1]"][C]),W=parseFloat(E["_pdbx_struct_oper_list_matrix[3][2]"][C]),R=parseFloat(E["_pdbx_struct_oper_list_matrix[3][3]"][C]),z=parseFloat(E["_pdbx_struct_oper_list_vector[3]"][C]),V=new s.Matrix4(S,A,P,O,F,I,B,k,U,W,R,z);_[_.length-1].symmetries.push(V)}const w=function(C){const S=C.match("-");C=C.replace(/[-xyz]/g,"");const A=C.split("/");let P,O;return A[1]===void 0?O=1:O=parseInt(A[1]),A[0]===""?P=1:P=parseInt(A[0]),P/O*(S?-1:1)};if(E._symmetry_equiv_pos_as_xyz!==void 0&&!m)for(let C=0;C<E._symmetry_equiv_pos_as_xyz.length;C++){const A=E._symmetry_equiv_pos_as_xyz[C].replace(/["' ]/g,"").split(",").map(function(I){return I.replace(/-/g,"+-")});let P=new s.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let I=0;I<3;I++){const B=A[I].split("+");for(let k=0;k<B.length;k++){const U=B[k];if(U==="")continue;const W=w(U);U.match("x")?P.elements[I+0]=W:U.match("y")?P.elements[I+4]=W:U.match("z")?P.elements[I+8]=W:P.elements[I+12]=W}}const O=x.getMatrix4(),F=new s.Matrix4().getInverse(O,!0);P=new s.Matrix4().multiplyMatrices(P,F),P=new s.Matrix4().multiplyMatrices(O,P),_[_.length-1].symmetries.push(P)}}for(let E=0;E<g.length;E++)b&&!(u.duplicateAssemblyAtoms&&!u.dontConnectDuplicatedAtoms)&&(0,o.assignPDBBonds)(g[E],u),(0,i.computeSecondaryStructure)(g[E],u.hbondCutoff),(0,n.processSymmetries)(_[E].symmetries,g[E],u,_[E].cryst),u.duplicateAssemblyAtoms&&!u.dontConnectDuplicatedAtoms&&b&&(0,o.assignPDBBonds)(g[E],u);return g}},"./src/parsers/CUBE.ts":(r,e,t)=>{t.r(e),t.d(e,{CUBE:()=>o});var i=t("./src/WebGL/index.ts"),n=t("./src/parsers/utils/assignBonds.ts"),s=t("./src/parsers/utils/anumToSymbol.ts");function o(a,l){l=l||{};const h=[[]];let u=a.split(/\r?\n/);const g=l.assignBonds===void 0?!0:l.assignBonds;if(u.length<6)return h;let m=u[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const _=Math.abs(parseFloat(m[0]));let b={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const d=b.origin=new i.Vector3(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));m=u[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),m=u[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const c=m[0]>0?.529177:1;d.multiplyScalar(c);const f=Math.abs(m[0]),v=new i.Vector3(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])).multiplyScalar(c);m=u[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const y=Math.abs(m[0]),D=new i.Vector3(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])).multiplyScalar(c);m=u[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const E=Math.abs(m[0]),p=new i.Vector3(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])).multiplyScalar(c);if(b.size={x:f,y,z:E},b.unit=new i.Vector3(v.x,D.y,p.z),v.y!=0||v.z!=0||D.x!=0||D.z!=0||p.x!=0||p.y!=0){b.matrix4=new i.Matrix4(v.x,D.x,p.x,0,v.y,D.y,p.y,0,v.z,D.z,p.z,0,0,0,0,1);let O=new i.Matrix4().makeTranslation(d.x,d.y,d.z);b.matrix4=b.matrix4.multiplyMatrices(O,b.matrix4),b.matrix=b.matrix4.matrix3FromTopLeft(),b.origin=new i.Vector3(0,0,0),b.unit=new i.Vector3(1,1,1)}h.modelData=[{cryst:b}],u=u.splice(6,_);for(var x=h[h.length-1].length,w=x+u.length,C=x;C<w;++C){var S={};S.serial=C;var A=u[C-x],P=A.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");S.elem=s.anumToSymbol[P[0]],S.x=parseFloat(P[2])*c,S.y=parseFloat(P[3])*c,S.z=parseFloat(P[4])*c,S.hetflag=!0,S.bonds=[],S.bondOrder=[],S.properties={},h[h.length-1].push(S)}if(g)for(let O=0;O<h.length;O++)(0,n.assignBonds)(h[O],l);return h}},"./src/parsers/GRO.ts":(r,e,t)=>{t.r(e),t.d(e,{GRO:()=>s});var i=t("./src/parsers/utils/assignPDBBonds.ts"),n=t("./src/parsers/utils/atomNameToElem.ts");function s(o,a){const l=[],h=o.split(/\r?\n|\r/);for(;h.length>0;){const u=parseInt(h[1]);if(h.length<3||isNaN(u)||u<=0||h.length<u+3)break;const m=[];l.push(m);let _=2;const b=m.length,d=b+u;for(let c=b;c<d;c++){const f=h[_++],v={};v.serial=c,v.atom=f.slice(10,15).trim(),v.elem=(0,n.atomNameToElem)(v.atom,!0),v.x=10*parseFloat(f.slice(20,28)),v.y=10*parseFloat(f.slice(28,36)),v.z=10*parseFloat(f.slice(36,44)),v.resi=parseInt(f.slice(0,5)),v.resn=f.slice(5,10).trim(),v.bonds=[],v.bondOrder=[],v.properties={},f.length>44&&(v.dx=10*parseFloat(f.slice(44,52)),v.dy=10*parseFloat(f.slice(52,60)),v.dz=10*parseFloat(f.slice(60,68))),m[c]=v}if(h.length<=_+3){const f=h[_++].trim().split(/\s+/);if(f.length===3){for(let v=0;v<3;v++)f[v]=(parseFloat(f[v])*10).toString();l.box=f}}h.splice(0,++_)}for(let u=0;u<l.length;u++)(0,i.assignPDBBonds)(l[u],a);return l}},"./src/parsers/LAMMPSTRJ.ts":(r,e,t)=>{t.r(e),t.d(e,{LAMMPSTRJ:()=>s});var i=t("./src/parsers/utils/assignBonds.ts");const n={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function s(o,a){const l=[],h=o.split(/\r?\n|\r/);let u=0,g=0,m=0;for(;m<h.length-9;){for(var _=m;_<h.length;_++)if(h[_].match(/ITEM: NUMBER OF ATOMS/)&&(g=parseInt(h[_+1])),h[_].match(/ITEM: ATOMS/)){u=_+1;break}const b=h[u-1].replace("ITEM: ATOMS ","").split(" ");l.push([]);for(let d=u;d<u+g;d++){const c={},f={},v=h[d].split(" ");for(let y=0;y<v.length;y++){const D=n[b[y]];D!==void 0&&(D==="serial"?c[D]=parseInt(v[y]):D==="x"||D==="y"||D==="z"?c[D]=parseFloat(v[y]):D==="charge"||D==="radius"?f[D]=parseFloat(v[y]):c[D]=v[y]),c.properties=f,c.bonds=[],c.bondOrder=[]}l[l.length-1][d-u]=c}m=u+g-1}if(a.assignBonds)for(let b=0;b<l.length;b++)(0,i.assignBonds)(l[b],a);return l}},"./src/parsers/MMTF.ts":(r,e,t)=>{t.r(e),t.d(e,{MMTFparser:()=>g});var i=t("./src/utilities.ts"),n=t("./src/WebGL/index.ts"),s=t("./src/parsers/utils/computeSecondaryStructure.ts"),o=t("./src/parsers/utils/processSymmetries.ts"),a=t("./src/vendor/mmtf.js"),l=function(m){return String.fromCharCode.apply(null,m).replace(/\0/g,"")},h=function(m){return m==0||m==2||m==4?"h":m==3?"s":"c"};let u=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function g(m,_){var b=!_.keepH,d=_.altLoc?_.altLoc:"A",c=!!_.noSecondaryStructure,f=!_.noComputeSecondaryStructure,v=!_.doAssembly,y=_.assemblyIndex?_.assemblyIndex:0;typeof m=="string"?m=(0,i.base64ToArray)(m):m=new Uint8Array(m);var D=a.decode(m),E=[[]],p=E.modelData=[],x=0,w=0,C=0,S=D.secStructList,A=D.bFactorList,P=D.altLocList,O=D.occupancyList,F=D.bondAtomList,I=D.bondOrderList,B=D.numModels;if(B==0)return E;_.multimodel||(B=1);var k,U,W,R,z,V,q=[];if(!v&&D.bioAssemblyList&&D.bioAssemblyList.length>0){var Q=D.bioAssemblyList[y].transformList;for(k=0,V=Q.length;k<V;k++){var re=new n.Matrix4(Q[k].matrix);re.transpose(),q.push(re)}}var te=null;if(D.unitCell){var ae=D.unitCell;te={a:ae[0],b:ae[1],c:ae[2],alpha:ae[3],beta:ae[4],gamma:ae[5]}}let ne=[];D.entityList.forEach(de=>{de.chainIndexList.forEach(j=>{ne[j]=de.type=="polymer"})});var le=0;for(z=0;z<B;z++){var Ee=D.chainsPerModel[z],De=E[E.length-1],Pe=[];for(p.push({symmetries:q,cryst:te}),k=0;k<Ee;++k){var pe=D.groupsPerChain[x],Z=l(D.chainIdList.subarray(x*4,x*4+4));D.chainNameList&&(Z=l(D.chainNameList.subarray(x*4,x*4+4)));var be=w,Ce="";for(U=0;U<pe;++U){var ie=D.groupList[D.groupTypeList[w]],Ne=ie.atomNameList.length,Ve=0,Ue=!1,Fe=!1;if(S){Ve=S[w];var ze=h(Ve);(w==0||ze!=Ce)&&(Ue=!0),Ce=ze;var Re=w+1;(Re>=S.length||h(S[Re]!=ze))&&(Fe=!0)}var Le=D.groupIdList[w],We=ie.groupName;let de=ie.chemCompType;var He=C;let j=u.has(de)||!ne[x];for(W=0;W<Ne;++W){var H=ie.elementList[W];if(b&&H=="H"){C+=1;continue}var K="";A&&(K=A[C]);var X="";P&&P[C]&&(X=String.fromCharCode(P[C]));var _e="";if(O&&(_e=O[C]),X!=""&&X!=d&&d!="*"){C+=1;continue}var ue=D.atomIdList[C],ye=ie.atomNameList[W],Ae=0;ie.atomChargeList&&(Ae=ie.atomChargeList[W]);var G=D.xCoordList[C],ce=D.yCoordList[C],ve=D.zCoordList[C];Pe[C]=De.length,De.push({resn:We,x:G,y:ce,z:ve,elem:H,hetflag:j,chain:Z,resi:Le,icode:X,rescode:Le+(X!=" "?"^"+X:""),serial:ue,altLoc:X,index:C,atom:ye,bonds:[],ss:h(Ve),ssbegin:Ue,ssend:Fe,bondOrder:[],properties:{charge:Ae,occupancy:_e},b:K}),C+=1}var Oe=ie.bondAtomList;for(W=0,R=ie.bondOrderList.length;W<R;++W){var oe=He+Oe[W*2],me=He+Oe[W*2+1],$=ie.bondOrderList[W],Te=Pe[oe],ke=Pe[me],L=De[Te],ge=De[ke];L&&ge&&(L.bonds.push(ke),L.bondOrder.push($),ge.bonds.push(Te),ge.bondOrder.push($))}w+=1}for(w=be,U=0;U<pe;++U)w+=1;x+=1}if(F)for(let de=le,j=F.length;de<j;de+=2){let se=F[de],he=F[de+1],Ie=I?I[de/2]:1;if(se>=C){le=de;break}let Be=Pe[se],we=Pe[he],je=De[Be],Xe=De[we];je&&Xe&&(je.bonds.push(we),je.bondOrder.push(Ie),Xe.bonds.push(Be),Xe.bondOrder.push(Ie))}_.multimodel&&(_.onemol||E.push([]))}if(!v)for(let de=0;de<E.length;de++)(0,o.processSymmetries)(p[de].symmetries,E[de],_,p[de].cryst);return f&&!c&&(0,s.computeSecondaryStructure)(E,_.hbondCutoff),E}},"./src/parsers/MOL2.ts":(r,e,t)=>{t.r(e),t.d(e,{MOL2:()=>n});let i={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function n(s,o){var a=[[]],l=!1;typeof o.keepH<"u"&&(l=!o.keepH);var h=s.search(/@<TRIPOS>MOLECULE/),u=s.search(/@<TRIPOS>ATOM/);if(h==-1||u==-1)return a;for(var g=s.substring(h).split(/\r?\n|\r/);g.length>0;){var m=[],_=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),b=parseInt(_[0]),d=0;_.length>1&&(d=parseInt(_[1]));var c=4,f;for(f=3;f<g.length;f++)if(g[f]=="@<TRIPOS>ATOM"){c=f+1;break}var v=a[a.length-1].length,y=v+b,D;for(f=v;f<y;f++){D=g[c++],_=D.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var E={},p=_[5];if(i[p]!==void 0?p=i[p]:(p=p.split(".")[0],p=p[0].toUpperCase()+p.substring(1).toLowerCase()),E.atom=_[1],E.elem=p,!(E.elem=="H"&&l)){var x=a[a.length-1].length,w=parseInt(_[0]);E.serial=w,E.x=parseFloat(_[2]),E.y=parseFloat(_[3]),E.z=parseFloat(_[4]),E.atom=_[5];var C=parseFloat(_[8]);E.index=x,E.bonds=[],E.bondOrder=[],E.properties={charge:C,partialCharge:C},m[w]=x,a[a.length-1].push(E)}}for(var S=!1;c<g.length;)if(g[c++]=="@<TRIPOS>BOND"){S=!0;break}if(S&&d)for(f=0;f<d;f++){D=g[c++],_=D.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var A=parseInt(_[1]),P=a[a.length-1][m[A]],O=parseInt(_[2]),F=a[a.length-1][m[O]],I=parseInt(_[3]);isNaN(I)&&(I=1),P!==void 0&&F!==void 0&&(P.bonds.push(m[O]),P.bondOrder.push(I),F.bonds.push(m[A]),F.bondOrder.push(I))}if(o.multimodel){o.onemol||a.push([]),g.splice(0,c),s=g.join(`
`);continue}else break}return a}},"./src/parsers/PDB.ts":(r,e,t)=>{t.r(e),t.d(e,{PDB:()=>n});var i=t("./src/parsers/utils/getSinglePDB.ts");function n(s,o){o=o||{};var a=[],l={};a.modelData=[];for(var h=s.split(/\r?\n|\r/);h.length>0;){var u=(0,i.getSinglePDB)(h,o,l),g=u[0],m=u[1];if(h=u[2],g.length!=0){if(o.multimodel&&o.onemol&&a.length>0)for(var _=a[0].length,b=0;b<g.length;b++){var d=g[b];d.index=b;for(var c=0;c<d.bonds.length;c++)d.bonds[c]+=_;a[0].push(d)}else a.modelData.push(m),a.push(g);if(!o.multimodel)break}}return a}},"./src/parsers/PQR.ts":(r,e,t)=>{t.r(e),t.d(e,{PQR:()=>s});var i=t("./src/parsers/utils/assignPDBBonds.ts"),n=t("./src/parsers/utils/computeSecondaryStructure.ts");function s(o,a){var l=[[]],h=!a.noSecondaryStructure;l.modelData=[{symmetries:[]}];var u=[],g=o.split(/\r?\n|\r/),m;for(let S=0;S<g.length;S++){m=g[S].replace(/^\s*/,"");var _=m.substring(0,6);if(_.indexOf("END")==0)if(a.multimodel){a.onemol||l.push([]);continue}else break;else if(_=="ATOM  "||_=="HETATM"){var b;let A=parseInt(m.substring(6,11)),P=m.substring(12,16).replace(/ /g,""),O=m.substring(17,20).trim(),F=m.substring(21,22),I=parseInt(m.substring(22,26));var d=m.substring(30).trim().split(/\s+/),c=parseFloat(d[0]),f=parseFloat(d[1]),v=parseFloat(d[2]),y=parseFloat(d[3]),D=parseFloat(d[4]),E=P[0];P.length>1&&P[1].toUpperCase()!=P[1]&&(E=P.substring(0,2)),m[0]=="H"?b=!0:b=!1,u[A]=l[l.length-1].length,l[l.length-1].push({resn:O,x:c,y:f,z:v,elem:E,hetflag:b,chain:F,resi:I,serial:A,atom:P,bonds:[],ss:"c",bondOrder:[],properties:{charge:y,partialCharge:y,radius:D},pdbline:m})}else if(_=="CONECT"){var p=parseInt(m.substring(6,11)),x=l[l.length-1][u[p]];for(let A=0;A<4;A++){var w=parseInt(m.substring([11,16,21,26][A],[11,16,21,26][A]+5)),C=l[l.length-1][u[w]];x!==void 0&&C!==void 0&&(x.bonds.push(u[w]),x.bondOrder.push(1))}}}for(let S=0;S<l.length;S++)(0,i.assignPDBBonds)(l[S],a),h&&(0,n.computeSecondaryStructure)(l[S],a.hbondCutoff);return l}},"./src/parsers/PRMTOP.ts":(r,e,t)=>{t.r(e),t.d(e,{PRMTOP:()=>i});function i(n){var s=[],o,a=0,l=n.split(/\r?\n|\r/);if(l.length>0&&l[0].includes("VERSION")){var h=l.filter(function(v){return v.includes("POINTERS")||v.includes("ATOM_NAME")||v.includes("CHARGE")||v.includes("RADII")||v.includes("BONDS_INC_HYDROGEN")||v.includes("BONDS_WITHOUT_HYDROGEN")||v.includes("RESIDUE_LABEL")||v.includes("RESIDUE_POINTER")}),u=d("POINTERS");if(u==-1)return[];var g=c(u),m=parseInt(l[u+1].slice(0,g[1]));let f=parseInt(l[u+2].slice(g[1],g[0]+g[1]));if(isNaN(m)||m<=0)return[];if(u=d("ATOM_NAME"),u==-1)return[];g=c(u);var _=g[0];for(let v=0;v<m/g[0];v++){v==parseInt(m/g[0])&&(_=m%g[0]);for(let y=0;y<_;y++){let D={},E={charge:"",radii:""};D.serial=a,D.x=0,D.y=0,D.z=0,D.atom=l[u+1].slice(g[1]*y,g[1]*(y+1)).trim(),D.elem=l[u+1].slice(g[1]*y,g[1]*y+1).trim(),D.properties=E,D.bonds=[],D.bondOrder=[],D.index=s.length,s.push(D),a++}u++}if(u=d("CHARGE"),u!=-1){g=c(u),a=0,_=g[0];for(let v=0;v<m/g[0];v++){v==parseInt(m/g[0])&&(_=m%g[0]);for(let y=0;y<_;y++)s[a].properties.charge=parseFloat(l[u+1].slice(g[1]*y,g[1]*(y+1))),a++;u++}}u=d("RESIDUE_POINTER");var b=[];if(u!=-1){g=c(u),_=g[0],u+=1;for(let v=0;v<f/g[0];v++){v==parseInt(f/g[0])&&(_=f%g[0]);for(let y=0;y<_;y++)b.push(parseInt(l[u].slice(g[1]*y,g[1]*(y+1))));u++}if(u=d("RESIDUE_LABEL"),u!=-1){let v=[];g=c(u),_=g[0],u+=1;for(let p=0;p<f/g[0];p++){p==parseInt(f/g[0])&&(_=f%g[0]);for(let x=0;x<_;x++)v.push(l[u].slice(g[1]*x,g[1]*(x+1)).trim());u++}let y=0,D=0,E="";b.push(s.length+1);for(let p=0;p<s.length;p++)p+1>=b[y]&&(E=v[y],y+=1,D+=1),s[p].resi=D,s[p].resn=E}}if(u=d("RADII"),u!=-1){g=c(u),a=0,_=g[0];for(let v=0;v<m/g[0];v++){v==parseInt(m/g[0])&&(_=m%g[0]);for(let y=0;y<_;y++)s[a].properties.radii=parseFloat(l[u+1].slice(g[1]*y,g[1]*(y+1))),a++;u++}}if(u=d("BONDS_WITHOUT_HYDROGEN"),u!=-1)for(g=c(u),a=0,_=g[0],u=u+1;!l[u].match(/^%FLAG/);){l[u+1].match(/^%FLAG/)&&(_=m%g[0]);for(let v=0;v<_;v++)a%3==0?o=parseInt(l[u].slice(g[1]*v,g[1]*(v+1))/3):a%3==1&&(s[o].bonds.push(parseInt(l[u].slice(g[1]*v,g[1]*(v+1))/3)),s[o].bondOrder.push(1)),a++;u++}if(u=d("BONDS_INC_HYDROGEN"),u!=-1)for(g=c(u),a=0,_=g[0],u=u+1;!l[u].match(/^%FLAG/);){l[u+1].match(/^%FLAG/)&&(_=m%g[0]);for(let v=0;v<_;v++)a%3==0?o=parseInt(l[u].slice(g[1]*v,g[1]*(v+1))/3):a%3==1&&(s[o].bonds.push(parseInt(l[u].slice(g[1]*v,g[1]*(v+1))/3)),s[o].bonds.push(1)),a++;u++}}else return[];function d(f){var v=l.indexOf(h.filter(function(y){return y.includes(f)})[0]);if(Number.isInteger(v)&&v>0){for(;!l[v].includes("FORMAT");)v++;return v}else return-1}function c(f){var v=l[f].match(/\((\d*)\S*/),y=l[f].match(/[a-zA-Z](\d*)\)\s*/);return y==null&&(y=l[f].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(v[1]),parseInt(y[1])]}return[s]}},"./src/parsers/SDF.ts":(r,e,t)=>{t.r(e),t.d(e,{SDF:()=>s});var i=function(o,a){var l=[[]],h=!1;for(typeof a.keepH<"u"&&(h=!a.keepH);o.length>0&&!(o.length<4);){var u=parseInt(o[3].substring(0,3));if(isNaN(u)||u<=0)break;var g=parseInt(o[3].substring(3,6)),m=4;if(o.length<4+u+g)break;var _=[],b=l[l.length-1].length,d=b+u,c,f;for(c=b;c<d;c++,m++){f=o[m];var v={},y=f.substring(31,34).replace(/ /g,"");v.atom=v.elem=y[0].toUpperCase()+y.substring(1).toLowerCase(),(v.elem!=="H"||!h)&&(v.serial=c,_[c]=l[l.length-1].length,v.x=parseFloat(f.substring(0,10)),v.y=parseFloat(f.substring(10,20)),v.z=parseFloat(f.substring(20,30)),v.hetflag=!0,v.bonds=[],v.bondOrder=[],v.properties={},v.index=l[l.length-1].length,l[l.length-1].push(v))}for(c=0;c<g;c++,m++){f=o[m];var D=_[parseInt(f.substring(0,3))-1+b],E=_[parseInt(f.substring(3,6))-1+b],p=parseFloat(f.substring(6));typeof D<"u"&&typeof E<"u"&&(l[l.length-1][D].bonds.push(E),l[l.length-1][D].bondOrder.push(p),l[l.length-1][E].bonds.push(D),l[l.length-1][E].bondOrder.push(p))}if(a.multimodel){for(a.onemol||l.push([]);o[m]!=="$$$$"&&m<o.length;)m++;o.splice(0,++m)}else break}return l},n=function(o,a){var l=[[]],h=!1;for(typeof a.keepH<"u"&&(h=!a.keepH);o.length>0&&!(o.length<8||!o[4].startsWith("M  V30 BEGIN CTAB")||!o[5].startsWith("M  V30 COUNTS")||o[5].length<14);){var u=o[5].substring(13).match(/\S+/g);if(u.length<2)break;var g=parseInt(u[0]);if(isNaN(g)||g<=0)break;var m=parseInt(u[1]),_=7;if(o.length<8+g+m)break;var b=[],d=l[l.length-1].length,c=d+g,f,v;for(f=d;f<c;f++,_++){v=o[_];var y=v.substring(6).match(/\S+/g);if(y.length>4){var D={},E=y[1].replace(/ /g,"");D.atom=D.elem=E[0].toUpperCase()+E.substring(1).toLowerCase(),(D.elem!=="H"||!h)&&(D.serial=f,b[f]=l[l.length-1].length,D.x=parseFloat(y[2]),D.y=parseFloat(y[3]),D.z=parseFloat(y[4]),D.hetflag=!0,D.bonds=[],D.bondOrder=[],D.properties={},D.index=l[l.length-1].length,l[l.length-1].push(D))}}if(o[_]==="M  V30 END ATOM")_++;else break;if(m!==0&&o[_]==="M  V30 BEGIN BOND")_++;else break;for(f=0;f<m;f++,_++){v=o[_];var p=v.substring(6).match(/\S+/g);if(p.length>3){var x=b[parseInt(p[2])-1+d],w=b[parseInt(p[3])-1+d],C=parseFloat(p[1]);typeof x<"u"&&typeof w<"u"&&(l[l.length-1][x].bonds.push(w),l[l.length-1][x].bondOrder.push(C),l[l.length-1][w].bonds.push(x),l[l.length-1][w].bondOrder.push(C))}}if(a.multimodel){for(a.onemol||l.push([]);o[_]!=="$$$$"&&_<o.length;)_++;o.splice(0,++_)}else break}return l};function s(o,a){var l="V2000",h=o.split(/\r?\n|\r/);return h.length>3&&h[3].length>38&&(l=h[3].substring(34,39)),l==="V2000"?i(h,a):l==="V3000"?n(h,a):[[""]]}},"./src/parsers/VASP.ts":(r,e,t)=>{t.r(e),t.d(e,{VASP:()=>s});var i=t("./src/WebGL/index.ts"),n=t("./src/parsers/utils/assignBonds.ts");function s(o,a={}){var l=[[]],h={};const u=a.assignBonds===void 0?!0:a.assignBonds;var g=o.replace(/^\s+/,"").split(/\r?\n/);if(g.length<3)return l;if(g[1].match(/\d+/))h.length=parseFloat(g[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),l;if(h.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),l;h.xVec=new Float32Array(g[2].replace(/^\s+/,"").split(/\s+/)),h.yVec=new Float32Array(g[3].replace(/^\s+/,"").split(/\s+/)),h.zVec=new Float32Array(g[4].replace(/^\s+/,"").split(/\s+/));var m=new i.Matrix3(h.xVec[0],h.xVec[1],h.xVec[2],h.yVec[0],h.yVec[1],h.yVec[2],h.zVec[0],h.zVec[1],h.zVec[2]);m.multiplyScalar(h.length),l.modelData=[{symmetries:[],cryst:{matrix:m}}];var _=g[5].trim().split(/\s+/),b=new Int16Array(g[6].trim().split(/\s+/)),d=g[7].trim(),c=!1;if(d.match(/S/)&&(c=!0,d=g[8].trim()),d.toLowerCase()[0]=="c")d="cartesian";else if(d.toLowerCase()[0]=="d")d="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),l;if(_.length!=b.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(_),console.log(b),l;c?g.splice(0,9):g.splice(0,8);for(var f=0,v=0,y=_.length;v<y;v++){for(var D=_[v],E=0,p=b[v];E<p;E++){var x=new Float32Array(g[f+E].trim().split(/\s+/)),w={};w.elem=D,d=="cartesian"?(w.x=h.length*x[0],w.y=h.length*x[1],w.z=h.length*x[2]):(w.x=h.length*(x[0]*h.xVec[0]+x[1]*h.yVec[0]+x[2]*h.zVec[0]),w.y=h.length*(x[0]*h.xVec[1]+x[1]*h.yVec[1]+x[2]*h.zVec[1]),w.z=h.length*(x[0]*h.xVec[2]+x[1]*h.yVec[2]+x[2]*h.zVec[2])),w.bonds=[],w.bondOrder=[],l[0].push(w)}f+=b[v]}if(u)for(let C=0;C<l.length;C++)(0,n.assignBonds)(l[C],a);return l}},"./src/parsers/XYZ.ts":(r,e,t)=>{t.r(e),t.d(e,{XYZ:()=>s});var i=t("./src/WebGL/index.ts"),n=t("./src/parsers/utils/assignBonds.ts");function s(o,a){a=a||{};for(var l=[[]],h=a.assignBonds===void 0?!0:a.assignBonds,u=o.trimStart().split(/\r?\n|\r/);u.length>0&&!(u.length<3);){var g=parseInt(u[0]);if(isNaN(g)||g<=0||u.length<g+2)break;var m=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,_=m.exec(u[1]);if(_!=null&&_.length>1){var b=new Float32Array(_[1].split(/\s+/)),d=new i.Matrix3(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);l.modelData=[{cryst:{matrix:d}}]}for(var c=2,f=l[l.length-1].length,v=f+g,y=f;y<v;y++){var D=u[c++],E=D.trim().split(/\s+/),p={};p.serial=y;var x=E[0];p.atom=p.elem=x[0].toUpperCase()+x.substring(1,2).toLowerCase(),p.x=parseFloat(E[1]),p.y=parseFloat(E[2]),p.z=parseFloat(E[3]),p.hetflag=!0,p.bonds=[],p.bondOrder=[],p.properties={},l[l.length-1][y]=p,E.length>=7&&(p.dx=parseFloat(E[4]),p.dy=parseFloat(E[5]),p.dz=parseFloat(E[6]))}if(a.multimodel)l.push([]),u.splice(0,c);else break}if(h)for(let C=0;C<l.length;C++)(0,n.assignBonds)(l[C],a);if(a.onemol){var w=l;l=[],l.push(w[0]);for(let C=1;C<w.length;C++){let S=l[0].length;for(let A=0;A<w[C].length;A++){let P=w[C][A];for(let O=0;O<P.bonds.length;O++)P.bonds[O]=P.bonds[O]+S;P.index=l[0].length,P.serial=l[0].length,l[0].push(P)}}}return l}},"./src/parsers/cifutils/category.ts":(r,e,t)=>{t.r(e),t.d(e,{Category:()=>n});var i=t("./src/parsers/cifutils/decoder.ts");function n(s){const o=Object.create(null),a=Object.create(null);for(const l of s.columns)o[l.name]=l;return{rowCount:s.rowCount,name:s.name.substring(1),fieldNames:s.columns.map(l=>l.name),getField(l){const h=o[l];if(h)return a[l]||(a[l]=(0,i.decode)(h.data)),a[l]}}}},"./src/parsers/cifutils/decoder.ts":(r,e,t)=>{t.r(e),t.d(e,{decode:()=>o});var i=t("./src/parsers/cifutils/encoding.ts");const n=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function s(S,A){const P=new ArrayBuffer(S.length),O=new Uint8Array(P);for(let F=0,I=S.length;F<I;F+=A)for(let B=0;B<A;B++)O[F+A-B-1]=S[F+B];return P}function o(S){let A=S.data;for(let P=S.encoding.length-1;P>=0;P--)A=a(A,S.encoding[P]);return A}function a(S,A){switch(A.kind){case"ByteArray":switch(A.type){case i.Encoding.IntDataType.Uint8:return S;case i.Encoding.IntDataType.Int8:return u(S);case i.Encoding.IntDataType.Int16:return m(S);case i.Encoding.IntDataType.Uint16:return _(S);case i.Encoding.IntDataType.Int32:return b(S);case i.Encoding.IntDataType.Uint32:return d(S);case i.Encoding.FloatDataType.Float32:return c(S);case i.Encoding.FloatDataType.Float64:return f(S);default:throw new Error("unreachable")}case"FixedPoint":return v(S,A);case"IntervalQuantization":return y(S,A);case"RunLength":return D(S,A);case"Delta":return E(S,A);case"IntegerPacking":return w(S,A);case"StringArray":return C(S,A)}}function l(S,A){switch(S){case i.Encoding.IntDataType.Int8:return new Int8Array(A);case i.Encoding.IntDataType.Int16:return new Int16Array(A);case i.Encoding.IntDataType.Int32:return new Int32Array(A);case i.Encoding.IntDataType.Uint8:return new Uint8Array(A);case i.Encoding.IntDataType.Uint16:return new Uint16Array(A);case i.Encoding.IntDataType.Uint32:return new Uint32Array(A);default:return new Int32Array(A)}}function h(S,A){switch(S){case i.Encoding.FloatDataType.Float32:return new Float32Array(A);case i.Encoding.FloatDataType.Float64:return new Float64Array(A);default:return new Float64Array(A)}}function u(S){return new Int8Array(S.buffer,S.byteOffset)}function g(S,A,P){return(S.byteOffset!=0||S.byteLength!=S.buffer.byteLength)&&(S=new Uint8Array(S)),n?new P(S.buffer):new P(s(S,A))}function m(S){return g(S,2,Int16Array)}function _(S){return g(S,2,Uint16Array)}function b(S){return g(S,4,Int32Array)}function d(S){return g(S,4,Uint32Array)}function c(S){return g(S,4,Float32Array)}function f(S){return g(S,8,Float64Array)}function v(S,A){const P=S.length,O=h(A.srcType,P),F=1/A.factor;for(let I=0;I<P;I++)O[I]=F*S[I];return O}function y(S,A){const P=S.length,O=h(A.srcType,P),F=(A.max-A.min)/(A.numSteps-1),I=A.min;for(let B=0;B<P;B++)O[B]=I+F*S[B];return O}function D(S,A){const P=l(A.srcType,A.srcSize);let O=0;for(let F=0,I=S.length;F<I;F+=2){const B=S[F],k=S[F+1];for(let U=0;U<k;++U)P[O++]=B}return P}function E(S,A){const P=S.length,O=l(A.srcType,P);if(!P)return S;O[0]=S[0]+(A.origin|0);for(let F=1;F<P;++F)O[F]=S[F]+O[F-1];return O}function p(S,A){const P=A.byteCount===1?127:32767,O=-P-1,F=S.length,I=new Int32Array(A.srcSize);let B=0,k=0;for(;B<F;){let U=0,W=S[B];for(;W===P||W===O;)U+=W,B++,W=S[B];U+=W,I[k]=U,B++,k++}return I}function x(S,A){const P=A.byteCount===1?255:65535,O=S.length,F=new Int32Array(A.srcSize);let I=0,B=0;for(;I<O;){let k=0,U=S[I];for(;U===P;)k+=U,I++,U=S[I];k+=U,F[B]=k,I++,B++}return F}function w(S,A){return S.length===A.srcSize?S:A.isUnsigned?x(S,A):p(S,A)}function C(S,A){const P=o({encoding:A.offsetEncoding,data:A.offsets}),O=o({encoding:A.dataEncoding,data:S}),F=A.stringData,I=new Array(P.length);I[0]="";for(let U=1,W=P.length;U<W;U++)I[U]=F.substring(P[U-1],P[U]);let B=0;const k=new Array(O.length);for(let U=0,W=O.length;U<W;U++)k[B++]=I[O[U]+1];return k}},"./src/parsers/cifutils/encoding.ts":(r,e,t)=>{t.r(e),t.d(e,{Encoding:()=>n,VERSION:()=>i});const i="0.3.0";var n;(function(s){(function(l){l[l.Int8=1]="Int8",l[l.Int16=2]="Int16",l[l.Int32=3]="Int32",l[l.Uint8=4]="Uint8",l[l.Uint16=5]="Uint16",l[l.Uint32=6]="Uint32"})(s.IntDataType||(s.IntDataType={})),function(l){l[l.Float32=32]="Float32",l[l.Float64=33]="Float64"}(s.FloatDataType||(s.FloatDataType={}));function o(l){let h;return l instanceof Int8Array?h=s.IntDataType.Int8:l instanceof Int16Array?h=s.IntDataType.Int16:l instanceof Int32Array?h=s.IntDataType.Int32:l instanceof Uint8Array?h=s.IntDataType.Uint8:l instanceof Uint16Array?h=s.IntDataType.Uint16:l instanceof Uint32Array?h=s.IntDataType.Uint32:l instanceof Float32Array?h=s.FloatDataType.Float32:l instanceof Float64Array?h=s.FloatDataType.Float64:h=s.IntDataType.Int32,h}s.getDataType=o;function a(l){if(l instanceof Int8Array||l instanceof Int16Array||l instanceof Int32Array)return!0;for(let h=0,u=l.length;h<u;h++)if(h<0)return!1;return!0}s.isSignedIntegerDataType=a})(n||(n={}))},"./src/parsers/index.ts":(r,e,t)=>{t.r(e),t.d(e,{Parsers:()=>v,bondLength:()=>f.bondLength,setBondLength:()=>f.setBondLength});var i=t("./src/parsers/VASP.ts"),n=t("./src/parsers/CUBE.ts"),s=t("./src/parsers/XYZ.ts"),o=t("./src/parsers/SDF.ts"),a=t("./src/parsers/CDJSON.ts"),l=t("./src/parsers/CIF.ts"),h=t("./src/parsers/MOL2.ts"),u=t("./src/parsers/PDB.ts"),g=t("./src/parsers/PQR.ts"),m=t("./src/parsers/MMTF.ts"),_=t("./src/parsers/PRMTOP.ts"),b=t("./src/parsers/GRO.ts"),d=t("./src/parsers/LAMMPSTRJ.ts"),c=t("./src/parsers/BCIF.ts"),f=t("./src/parsers/utils/bondLength.ts");const v={vasp:i.VASP,VASP:i.VASP,cube:n.CUBE,CUBE:n.CUBE,xyz:s.XYZ,XYZ:s.XYZ,sdf:o.SDF,SDF:o.SDF,json:a.CDJSON,cdjson:a.CDJSON,CDJSON:a.CDJSON,mcif:l.CIF,cif:l.CIF,CIF:l.CIF,mol2:h.MOL2,MOL2:h.MOL2,pdb:u.PDB,PDB:u.PDB,pdbqt:u.PDB,PDBQT:u.PDB,pqr:g.PQR,PQR:g.PQR,mmtf:m.MMTFparser,MMTF:m.MMTFparser,prmtop:_.PRMTOP,PRMTOP:_.PRMTOP,gro:b.GRO,GRO:b.GRO,lammpstrj:d.LAMMPSTRJ,LAMMPSTRJ:d.LAMMPSTRJ,bcif:c.BCIF,BCIF:c.BCIF}},"./src/parsers/utils/anumToSymbol.ts":(r,e,t)=>{t.r(e),t.d(e,{anumToSymbol:()=>i});const i={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}},"./src/parsers/utils/areConnected.ts":(r,e,t)=>{t.r(e),t.d(e,{areConnected:()=>s});var i=t("./src/parsers/utils/bondLength.ts");const n=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function s(o,a,l){if(l&&l.unboundCations&&(n.has(o.elem)||n.has(a.elem)))return!1;let h=(0,i.bondLength)(o.elem)+(0,i.bondLength)(a.elem);h+=.25,h*=h;let u=o.x-a.x;if(u*=u,u>h)return!1;let g=o.y-a.y;if(g*=g,g>h)return!1;let m=o.z-a.z;if(m*=m,m>h)return!1;const _=u+g+m;return!(isNaN(_)||_<.5||_>h||o.altLoc!==a.altLoc&&o.altLoc.trim()!==""&&a.altLoc.trim()!=="")}},"./src/parsers/utils/assignBackboneHBonds.ts":(r,e,t)=>{t.r(e),t.d(e,{assignBackboneHBonds:()=>i});function i(n,s){const o=s||3.2,a=o*o,l=[];for(let h=0,u=n.length;h<u;h++){n[h].index=h;const g=n[h];!g.hetflag&&(g.atom==="N"||g.atom==="O")&&(l.push(g),g.hbondOther=null,g.hbondDistanceSq=Number.POSITIVE_INFINITY)}l.sort(function(h,u){return h.z-u.z});for(let h=0,u=l.length;h<u;h++){const g=l[h];for(let m=h+1;m<u;m++){const _=l[m],b=_.z-g.z;if(b>o)break;if(_.atom==g.atom)continue;const d=Math.abs(_.y-g.y);if(d>o)continue;const c=Math.abs(_.x-g.x);if(c>o)continue;const f=c*c+d*d+b*b;f>a||_.chain==g.chain&&Math.abs(_.resi-g.resi)<4||(f<g.hbondDistanceSq&&(g.hbondOther=_,g.hbondDistanceSq=f),f<_.hbondDistanceSq&&(_.hbondOther=g,_.hbondDistanceSq=f))}}}},"./src/parsers/utils/assignBonds.ts":(r,e,t)=>{t.r(e),t.d(e,{assignBonds:()=>o});var i=t("./src/parsers/utils/areConnected.ts");const n=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],s=4.95;function o(a,l){for(let g=0,m=a.length;g<m;g++)a[g].index||(a[g].index=g);const h={x:{y:{z:[]}}};for(let g=0;g<a.length;g++){const m=a[g],_=Math.floor(m.x/s),b=Math.floor(m.y/s),d=Math.floor(m.z/s);h[_]||(h[_]={}),h[_][b]||(h[_][b]={}),h[_][b][d]||(h[_][b][d]=[]),h[_][b][d].push(m)}function u(g,m){for(let _=0;_<g.length;_++){const b=g[_];for(let d=0;d<m.length;d++){const c=m[d];if((0,i.areConnected)(b,c,l)){const f=b.bonds.indexOf(c.index),v=c.bonds.indexOf(b.index);f===-1&&v===-1?(b.bonds.push(c.index),b.bondOrder.push(1),c.bonds.push(b.index),c.bondOrder.push(1)):f===-1?(b.bonds.push(c.index),b.bondOrder.push(c.bondOrder[v])):v===-1&&(c.bonds.push(b.index),c.bondOrder.push(b.bondOrder[f]))}}}}for(let g in h){const m=parseInt(g);for(let _ in h[m]){const b=parseInt(_);for(let d in h[m][b]){const c=parseInt(d),f=h[m][b][c];for(let v=0;v<f.length;v++){const y=f[v];for(let D=v+1;D<f.length;D++){const E=f[D];(0,i.areConnected)(y,E,l)&&y.bonds.indexOf(E.index)==-1&&(y.bonds.push(E.index),y.bondOrder.push(1),E.bonds.push(y.index),E.bondOrder.push(1))}}for(let v=0;v<n.length;v++){const y=n[v];if(!h[m+y.x]||!h[m+y.x][b+y.y]||!h[m+y.x][b+y.y][c+y.z])continue;const D=h[m+y.x][b+y.y][c+y.z];u(f,D)}}}}}},"./src/parsers/utils/assignPDBBonds.ts":(r,e,t)=>{t.r(e),t.d(e,{assignPDBBonds:()=>o});var i=t("./src/parsers/utils/areConnected.ts"),n=t("./src/parsers/utils/assignBonds.ts"),s=t("./src/parsers/utils/standardResidues.ts");function o(a,l){const h=[],u=[];for(let b=0,d=a.length;b<d;b++){const c=a[b];c.index=b,c.hetflag||!s.standardResidues.has(c.resn)?u.push(c):h.push(c)}(0,n.assignBonds)(u,l),h.sort(function(b,d){return b.chain!==d.chain?b.chain<d.chain?-1:1:b.resi-d.resi});let g=-1,m=-1,_;for(let b=0,d=h.length;b<d;b++){const c=h[b];c.resi!==g&&(g=c.resi,_||m++,_=!1),c.reschain=m;for(let f=b+1;f<h.length;f++){const v=h[f];if(v.chain!==c.chain||v.resi-c.resi>1)break;(0,i.areConnected)(c,v,l)&&(c.bonds.indexOf(v.index)===-1&&(c.bonds.push(v.index),c.bondOrder.push(1),v.bonds.push(c.index),v.bondOrder.push(1)),c.resi!==v.resi&&(_=!0))}}}},"./src/parsers/utils/atomNameToElem.ts":(r,e,t)=>{t.r(e),t.d(e,{atomNameToElem:()=>n});var i=t("./src/parsers/utils/bondLength.ts");function n(s,o){let a=s.replace(/ /g,"");return a.length>0&&a[0]==="H"&&a!=="Hg"&&a!=="He"&&a!=="Hf"&&a!=="Hs"&&a!=="Ho"&&(a="H"),a.length>1&&(a=a[0].toUpperCase()+a.substring(1).toLowerCase(),i.bondTable[a]===void 0?a=a[0]:o&&(a==="Ca"||a==="Cd")&&(a="C")),a}},"./src/parsers/utils/bondLength.ts":(r,e,t)=>{t.r(e),t.d(e,{bondLength:()=>n,bondTable:()=>i,setBondLength:()=>s});let i={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function n(o){return i[o]||1.6}function s(o,a){a<0&&(a=0),i[o]=a}},"./src/parsers/utils/computeSecondaryStructure.ts":(r,e,t)=>{t.r(e),t.d(e,{computeSecondaryStructure:()=>n});var i=t("./src/parsers/utils/assignBackboneHBonds.ts");function n(s,o){(0,i.assignBackboneHBonds)(s,o);const a={};let l,h,u,g,m,_;for(l=0,h=s.length;l<h;l++)if(m=s[l],a[m.chain]===void 0&&(a[m.chain]=[]),isFinite(m.hbondDistanceSq)){const b=m.hbondOther;a[b.chain]===void 0&&(a[b.chain]=[]),Math.abs(b.resi-m.resi)===4&&(a[m.chain][m.resi]="h")}for(u in a)for(g=1;g<a[u].length-1;g++){const b=a[u][g-1],d=a[u][g+1];_=a[u][g],b=="h"&&b==d&&_!=b&&(a[u][g]=b)}for(l=0,h=s.length;l<h;l++)m=s[l],isFinite(m.hbondDistanceSq)&&a[m.chain][m.resi]!="h"&&m.ss!=="h"&&(a[m.chain][m.resi]="maybesheet");for(let b=0,d=s.length;b<d;b++)if(m=s[b],isFinite(m.hbondDistanceSq)&&a[m.chain][m.resi]=="maybesheet"){let c=m.hbondOther,f=a[c.chain][c.resi];(f=="maybesheet"||f=="s")&&(a[m.chain][m.resi]="s",a[c.chain][c.resi]="s")}for(let b in a){for(let d=1;d<a[b].length-1;d++){const c=a[b][d-1],f=a[b][d+1];_=a[b][d],c=="s"&&c==f&&_!=c&&(a[b][d]=c)}for(let d=0;d<a[b].length;d++){const c=a[b][d];(c=="h"||c=="s")&&a[b][d-1]!=c&&a[b][d+1]!=c&&delete a[b][d]}}for(l=0,h=s.length;l<h;l++)m=s[l],_=a[m.chain][m.resi],delete m.hbondOther,delete m.hbondDistanceSq,!(_===void 0||_==="maybesheet")&&(m.ss=_,a[m.chain][m.resi-1]!=_&&(m.ssbegin=!0),a[m.chain][m.resi+1]!=_&&(m.ssend=!0))}},"./src/parsers/utils/getSinglePDB.ts":(r,e,t)=>{t.r(e),t.d(e,{getSinglePDB:()=>g});var i=t("./src/WebGL/index.ts"),n=t("./src/parsers/utils/atomNameToElem.ts"),s=t("./src/parsers/utils/bondLength.ts"),o=t("./src/parsers/utils/computeSecondaryStructure.ts"),a=t("./src/parsers/utils/isEmpty.ts"),l=t("./src/parsers/utils/processSymmetries.ts"),h=t("./src/parsers/utils/assignPDBBonds.ts"),u=t("./src/parsers/utils/validateBonds.ts");function g(m,_,b){const d=[],c=_.assignBonds===void 0?!0:_.assignBonds,f=!_.keepH,v=!!_.noSecondaryStructure,y=!_.noComputeSecondaryStructure,D=!_.doAssembly,E=_.altLoc?_.altLoc:"A",p={symmetries:[],cryst:void 0};let x,w=[];const C=[];let S;const A={};for(let P=0;P<m.length;P++){S=m[P].replace(/^\s*/,"");const O=S.substring(0,6);let F,I,B;if(O.indexOf("END")===0){if(w=m.slice(P+1),O==="END")for(const k in b)b.hasOwnProperty(k)&&delete b[k];break}else if(O==="ATOM  "||O==="HETATM"){let k,U,W,R,z,V,q,Q,re,te,ae,ne;if(ae=S.substring(16,17),ae!==" "&&ae!==E&&E!=="*"||(te=parseInt(S.substring(6,11)),x=S.substring(12,16).replace(/ /g,""),k=S.substring(17,20).replace(/ /g,""),U=S.substring(21,22),W=parseInt(S.substring(22,26)),R=S.substring(26,27),z=parseFloat(S.substring(30,38)),V=parseFloat(S.substring(38,46)),q=parseFloat(S.substring(46,54)),ne=parseFloat(S.substring(60,68)),re=S.substring(76,78).replace(/ /g,""),re===""||s.bondTable[re]===void 0?re=(0,n.atomNameToElem)(S.substring(12,14),S[0]=="A"):re=re[0].toUpperCase()+re.substring(1).toLowerCase(),re==="H"&&f))continue;O[0]=="H"?Q=!0:Q=!1,C[te]=d.length,d.push({resn:k,x:z,y:V,z:q,elem:re,hetflag:Q,altLoc:ae,chain:U,resi:W,icode:R,rescode:W+(R!==" "?"^"+R:""),serial:te,atom:x,bonds:[],ss:"c",bondOrder:[],properties:{},b:ne,pdbline:S})}else if(O==="SHEET "){F=S.substring(21,22),I=parseInt(S.substring(22,26)),B=parseInt(S.substring(33,37)),F in b||(b[F]={}),b[F][I]="s1";for(let k=I+1;k<B;k++)b[F][k]="s";b[F][B]="s2"}else if(O==="CONECT"){const k=parseInt(S.substring(6,11)),U=C[k],W=d[U],R=[11,16,21,26];for(let z=0;z<4;z++){const V=parseInt(S.substring(R[z],R[z]+5)),q=C[V];let Q=U+":"+q;const re=d[q];if(W!==void 0&&re!==void 0)if(!A[Q])A[Q]=1,(W.bonds.length==0||W.bonds[W.bonds.length-1]!==q)&&(W.bonds.push(q),W.bondOrder.push(1));else{A[Q]+=1;for(let te=0;te<W.bonds.length;te++)if(W.bonds[te]==q){const ae=A[Q];ae>=4?W.bondOrder[te]=1:W.bondOrder[te]=ae}}}}else if(O==="HELIX "){F=S.substring(19,20),I=parseInt(S.substring(21,25)),B=parseInt(S.substring(33,37)),F in b||(b[F]={}),b[F][I]="h1";for(let k=I+1;k<B;k++)b[F][k]="h";b[F][B]="h2"}else if(!D&&O==="REMARK"&&S.substring(13,18)==="BIOMT"){let k,U=new i.Matrix4;for(k=1;k<=3;k++)if(S=m[P].replace(/^\s*/,""),parseInt(S.substring(18,19))==k)U.elements[k-1]=parseFloat(S.substring(23,33)),U.elements[k-1+4]=parseFloat(S.substring(33,43)),U.elements[k-1+8]=parseFloat(S.substring(43,53)),U.elements[k-1+12]=parseFloat(S.substring(53)),P++;else for(;S.substring(13,18)==="BIOMT";)P++,S=m[P].replace(/^\s*/,"");U.elements[3]=0,U.elements[7]=0,U.elements[11]=0,U.elements[15]=1,p.symmetries.push(U),P--}else if(O==="CRYST1"){let k,U,W,R,z,V;k=parseFloat(S.substring(7,15)),U=parseFloat(S.substring(16,24)),W=parseFloat(S.substring(25,33)),R=parseFloat(S.substring(34,40)),z=parseFloat(S.substring(41,47)),V=parseFloat(S.substring(48,54)),p.cryst={a:k,b:U,c:W,alpha:R,beta:z,gamma:V}}else if(O==="ANISOU"){const k=parseInt(S.substring(6,11)),U=C[k],W=d[U];if(W){const R=S.substring(30).trim().split(/\s+/),z={u11:parseInt(R[0]),u22:parseInt(R[1]),u33:parseInt(R[2]),u12:parseInt(R[3]),u13:parseInt(R[4]),u23:parseInt(R[5])};W.uMat=z}}}if((0,u.validateBonds)(d,C),c&&(0,h.assignPDBBonds)(d,_),D||(0,l.processSymmetries)(p.symmetries,d,_,p.cryst),y&&!v&&(0,o.computeSecondaryStructure)(d,_.hbondCutoff),!(0,a.isEmpty)(b))for(let P=0;P<d.length;P++){const O=d[P];if(O!==void 0&&O.chain in b&&O.resi in b[O.chain]){const F=b[O.chain][O.resi];O.ss=F[0],F.length>1&&(F[1]=="1"?O.ssbegin=!0:F[1]=="2"&&(O.ssend=!0))}}return[d,p,w]}},"./src/parsers/utils/isEmpty.ts":(r,e,t)=>{t.r(e),t.d(e,{isEmpty:()=>i});function i(n){for(const s in n)return!1;return!0}},"./src/parsers/utils/processSymmetries.ts":(r,e,t)=>{t.r(e),t.d(e,{processSymmetries:()=>n});var i=t("./src/WebGL/index.ts");function n(s,o,a,l){const h=!a.duplicateAssemblyAtoms,u=o.length;let g=u,m=-1,_=null,b=null;(a.normalizeAssembly||a.wrapAtoms)&&l&&(_=(0,i.conversionMatrix3)(l.a,l.b,l.c,l.alpha,l.beta,l.gamma),b=new i.Matrix3,b.getInverse3(_));let d=function(v){let y=v.clone().applyMatrix3(b);const D=[y.x,y.y,y.z],E=[0,0,0];for(let x=0;x<3;x++){for(;D[x]<-.001;)D[x]+=1,E[x]+=1;for(;D[x]>1.001;)D[x]-=1,E[x]-=1}const p=new i.Vector3(E[0],E[1],E[2]);return p.applyMatrix3(_),p};if(a.normalizeAssembly&&l)for(let v=0;v<s.length;v++){const y=new i.Vector3(0,0,0);for(let E=0;E<u;E++){const p=new i.Vector3(o[E].x,o[E].y,o[E].z);p.applyMatrix4(s[v]),y.add(p)}y.divideScalar(u);const D=d(y);s[v].isNearlyIdentity()&&D.lengthSq()>.001&&(m=v),s[v].translate(D)}if(h){if(s.length>1)for(let v=0;v<o.length;v++){var c=[];for(let y=0;y<s.length;y++)if(!s[y].isNearlyIdentity()){var f=new i.Vector3;f.set(o[v].x,o[v].y,o[v].z),f.applyMatrix4(s[y]),c.push(f)}o[v].symmetries=c}}else{for(let v=0;v<u;v++)o[v].sym=-1;for(let v=0;v<s.length;v++)if(!s[v].isNearlyIdentity()&&m!=v){let y=new i.Vector3;for(let D=0;D<u;D++){const E=[];for(let x=0;x<o[D].bonds.length;x++)E.push(o[D].bonds[x]+g);if(y.set(o[D].x,o[D].y,o[D].z),y.applyMatrix4(s[v]),a.wrapAtoms&&l){let x=d(y);y.add(x)}const p={};for(const x in o[D])p[x]=o[D][x];p.x=y.x,p.y=y.y,p.z=y.z,p.bonds=E,p.sym=v,p.index=o.length,o.push(p)}g=o.length}else for(let y=0;y<u;y++)o[y].sym=v;if(a.wrapAtoms&&l){let v=new i.Vector3;for(let y=0;y<u;y++){v.set(o[y].x,o[y].y,o[y].z);let D=d(v);v.add(D),o[y].x=v.x,o[y].y=v.y,o[y].z=v.z}}if(m>=0){const v=new i.Vector3;for(let y=0;y<u;y++)v.set(o[y].x,o[y].y,o[y].z),v.applyMatrix4(s[m]),o[y].x=v.x,o[y].y=v.y,o[y].z=v.z}s.length=0}}},"./src/parsers/utils/standardResidues.ts":(r,e,t)=>{t.r(e),t.d(e,{standardResidues:()=>i});const i=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])},"./src/parsers/utils/validateBonds.ts":(r,e,t)=>{t.r(e),t.d(e,{validateBonds:()=>i});function i(n,s){for(let o=0,a=n.length;o<a;o++){const l=n[o];for(let h=0;h<l.bonds.length;h++){const u=l.bonds[h],g=n[u],m=s[l.serial];g&&m&&g.bonds.indexOf(m)<0&&(g.bonds.push(m),g.bondOrder.push(l.bondOrder[h]))}}}},"./src/partialCharges.ts":(r,e,t)=>{t.r(e),t.d(e,{applyPartialCharges:()=>n,partialCharges:()=>i});const i={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function n(s,o){if((!o||typeof s.partialCharge>"u")&&s.resn&&s.atom){var a=s.resn+":"+s.atom;s.properties.partialCharge=i[a]}}},"./src/specs.ts":(r,e,t)=>{t.r(e)},"./src/utilities.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(r,e){for(var t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&(r[t]=e[t]);return r}function deepCopy(r){let e,t,i;if(r==null)return{};if(typeof r!="object"||r===null)return r;e=Array.isArray(r)?[]:{};for(i in r)t=r[i],e[i]=deepCopy(t);return e}function isNumeric(r){var e=typeof r;return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))}function isEmptyObject(r){return Object.keys(r).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(r){r&&(r.volformat&&!(r.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(r.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(r.voldata,r.volformat)),r.volscheme&&(r.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(r.volscheme)))}function getExtent(r,e){var t,i,n,s,o,a,l,h,u,g,m=!e;if(t=i=n=9999,s=o=a=-9999,l=h=u=g=0,r.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var _=0;_<r.length;_++){var b=r[_];if(!(typeof b>"u"||!isFinite(b.x)||!isFinite(b.y)||!isFinite(b.z))&&(g++,l+=b.x,h+=b.y,u+=b.z,t=t<b.x?t:b.x,i=i<b.y?i:b.y,n=n<b.z?n:b.z,s=s>b.x?s:b.x,o=o>b.y?o:b.y,a=a>b.z?a:b.z,b.symmetries&&m))for(var d=0;d<b.symmetries.length;d++)g++,l+=b.symmetries[d].x,h+=b.symmetries[d].y,u+=b.symmetries[d].z,t=t<b.symmetries[d].x?t:b.symmetries[d].x,i=i<b.symmetries[d].y?i:b.symmetries[d].y,n=n<b.symmetries[d].z?n:b.symmetries[d].z,s=s>b.symmetries[d].x?s:b.symmetries[d].x,o=o>b.symmetries[d].y?o:b.symmetries[d].y,a=a>b.symmetries[d].z?a:b.symmetries[d].z}return[[t,i,n],[s,o,a],[l/g,h/g,u/g]]}function getPropertyRange(r,e){for(var t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=0,s=r.length;n<s;n++){var o=r[n],a=getAtomProperty(o,e);a!=null&&(a<t&&(t=a),a>i&&(i=a))}return!isFinite(t)&&!isFinite(i)?t=i=0:isFinite(t)?isFinite(i)||(i=t):t=i,[t,i]}class PausableTimer{constructor(e,t,i){this.total_time_run=0,this.fn=e,this.arg=i,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(e,t,i)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(r){for(var e=window.atob(r),t=e.length,i=new Uint8Array(t),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i}function getAtomProperty(r,e){var t=null;return r.properties&&typeof r.properties[e]<"u"?t=r.properties[e]:typeof r[e]<"u"&&(t=r[e]),t}function mergeGeos(r,e){var t=e.geometry;t!==void 0&&r.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(r){if(typeof r=="object")return r;if(typeof r>"u"||r==null)return r;try{return JSON.parse(r)}catch{}r=r.replace(/%7E/g,"~");var e=function(m){return isNumeric(m)?Math.floor(parseFloat(m))==parseInt(m)||m.indexOf(".")>=0?parseFloat(m):parseInt(m):m==="true"?!0:m==="false"?!1:m},t={};if(r==="all")return t;for(var i=r.split(";"),n=0;n<i.length;n++){var s=i[n].split(":"),o=s[0],a={},l=s[1];if(l)if(l=l.replace(/~/g,"="),l.indexOf("=")!==-1)for(var h=l.split(","),u=0;u<h.length;u++){var g=h[u].split("=",2);a[g[0]]=e(g[1])}else l.indexOf(",")!==-1?a=l.split(","):a=e(l);t[o]=a}return t}function checkStatus(r){if(!r.ok)throw new Error(`HTTP ${r.status} - ${r.statusText}`);return r}function get(r,e){var t=fetch(r).then(checkStatus).then(i=>i.text());return e?t.then(e):t}function getbin(r,e,t,i){var n;return t=="POST"?n=fetch(r,{method:"POST",body:i}).then(s=>checkStatus(s)).then(s=>s.arrayBuffer()):n=fetch(r).then(s=>checkStatus(s)).then(s=>s.arrayBuffer()),e?n.then(e):n}function download(r,e,t,i){var n="",s="",o="",a=null,l=e.addModel();if(r.indexOf(":")<0&&(r.length==4?r="pdb:"+r:isNaN(r)?r="url:"+r:r="cid:"+r),r.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),r="bcif:"+r.slice(5)),r.substring(0,5)==="bcif:")r=r.substring(5).toUpperCase(),o="https://models.rcsb.org/"+r+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),a=new Promise(function(u){getbin(o).then(function(g){l.addMolData(g,"bcif.gz",t),e.zoomTo(),e.render(),u(l)},function(){console.error("fetch of "+o+" failed.")})});else{if(r.substring(0,4)==="pdb:"){if(n="bcif",t&&t.format&&(n=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),r=r.substring(4).toUpperCase(),!r.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}n=="bcif"?o="https://models.rcsb.org/"+r.toUpperCase()+".bcif.gz":(s=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",o=s+r+"."+n)}else if(r.substring(0,4)=="cid:"){if(n="sdf",r=r.substring(4),!r.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}o="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+r+"/SDF?record_type=3d"}else r.substring(0,4)=="url:"&&(o=r.substring(4),n=o);var h=function(u){l.addMolData(u,n,t),e.zoomTo(),e.render()};a=new Promise(function(u){n=="bcif"?getbin(o).then(function(g){h(g),u(l)}).catch(function(){s=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",o=s+r+".pdb",n="pdb",console.warn("falling back to pdb format"),get(o).then(function(g){h(g),u(l)}).catch(function(g){h(""),u(l),console.error("fetch of "+o+" failed: "+g.statusText)})}):get(o).then(function(g){h(g),u(l)}).catch(function(g){h(""),u(l),console.error("fetch of "+o+" failed: "+g.statusText)})})}return i?(a.then(function(u){i(u)}),l):a}function getColorFromStyle(r,e){let t=e.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let o=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[o]<"u"){let a=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);a.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[o],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:a},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let i=r.color;if(typeof e.color<"u"&&e.color!="spectrum"&&(i=e.color),typeof t<"u"){let o,a;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[r[t.prop]]<"u"&&(i=t.map[r[t.prop]]);else if(typeof t[r[t.prop]]<"u")i=t.map[r[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){o=t.prop;var n=t.gradient;n instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(n=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let l=n.range()||[-1,1];a=getAtomProperty(r,o),a!=null&&(i=n.valueToHex(a,l))}else typeof t.prop<"u"&&typeof t.map<"u"?(o=t.prop,a=getAtomProperty(r,o),typeof t.map[a]<"u"&&(i=t.map[a])):typeof e.colorscheme[r.elem]<"u"?i=e.colorscheme[r.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof e.colorfunc<"u"&&(i=e.colorfunc(r));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(i)}function getElement(r){let e=r;return typeof r=="string"?e=document.querySelector("#"+r):typeof r=="object"&&r.get&&(e=r.get(0)),e}function inflateString(r,e=!0){let t;return typeof r=="string"?t=new TextEncoder().encode(r):t=new Uint8Array(r),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:e?"string":null})}},"./src/vendor/mmtf.js":function(r,e){(function(t,i){i(e)})(this,function(t){function i(H,K,X){for(var _e=(H.byteLength,0),ue=X.length;ue>_e;_e++){var ye=X.charCodeAt(_e);if(128>ye)H.setUint8(K++,ye>>>0&127|0);else if(2048>ye)H.setUint8(K++,ye>>>6&31|192),H.setUint8(K++,ye>>>0&63|128);else if(65536>ye)H.setUint8(K++,ye>>>12&15|224),H.setUint8(K++,ye>>>6&63|128),H.setUint8(K++,ye>>>0&63|128);else{if(!(1114112>ye))throw new Error("bad codepoint "+ye);H.setUint8(K++,ye>>>18&7|240),H.setUint8(K++,ye>>>12&63|128),H.setUint8(K++,ye>>>6&63|128),H.setUint8(K++,ye>>>0&63|128)}}}function n(H){for(var K=0,X=0,_e=H.length;_e>X;X++){var ue=H.charCodeAt(X);if(128>ue)K+=1;else if(2048>ue)K+=2;else if(65536>ue)K+=3;else{if(!(1114112>ue))throw new Error("bad codepoint "+ue);K+=4}}return K}function s(H,K,X){var _e=typeof H;if(_e==="string"){var ue=n(H);if(32>ue)return K.setUint8(X,160|ue),i(K,X+1,H),1+ue;if(256>ue)return K.setUint8(X,217),K.setUint8(X+1,ue),i(K,X+2,H),2+ue;if(65536>ue)return K.setUint8(X,218),K.setUint16(X+1,ue),i(K,X+3,H),3+ue;if(4294967296>ue)return K.setUint8(X,219),K.setUint32(X+1,ue),i(K,X+5,H),5+ue}if(H instanceof Uint8Array){var ue=H.byteLength,ye=new Uint8Array(K.buffer);if(256>ue)return K.setUint8(X,196),K.setUint8(X+1,ue),ye.set(H,X+2),2+ue;if(65536>ue)return K.setUint8(X,197),K.setUint16(X+1,ue),ye.set(H,X+3),3+ue;if(4294967296>ue)return K.setUint8(X,198),K.setUint32(X+1,ue),ye.set(H,X+5),5+ue}if(_e==="number"){if(!isFinite(H))throw new Error("Number not finite: "+H);if(Math.floor(H)!==H)return K.setUint8(X,203),K.setFloat64(X+1,H),9;if(H>=0){if(128>H)return K.setUint8(X,H),1;if(256>H)return K.setUint8(X,204),K.setUint8(X+1,H),2;if(65536>H)return K.setUint8(X,205),K.setUint16(X+1,H),3;if(4294967296>H)return K.setUint8(X,206),K.setUint32(X+1,H),5;throw new Error("Number too big 0x"+H.toString(16))}if(H>=-32)return K.setInt8(X,H),1;if(H>=-128)return K.setUint8(X,208),K.setInt8(X+1,H),2;if(H>=-32768)return K.setUint8(X,209),K.setInt16(X+1,H),3;if(H>=-2147483648)return K.setUint8(X,210),K.setInt32(X+1,H),5;throw new Error("Number too small -0x"+(-H).toString(16).substr(1))}if(H===null)return K.setUint8(X,192),1;if(_e==="boolean")return K.setUint8(X,H?195:194),1;if(_e==="object"){var ue,ce=0,Ae=Array.isArray(H);if(Ae)ue=H.length;else{var G=Object.keys(H);ue=G.length}var ce;if(16>ue?(K.setUint8(X,ue|(Ae?144:128)),ce=1):65536>ue?(K.setUint8(X,Ae?220:222),K.setUint16(X+1,ue),ce=3):4294967296>ue&&(K.setUint8(X,Ae?221:223),K.setUint32(X+1,ue),ce=5),Ae)for(var ve=0;ue>ve;ve++)ce+=s(H[ve],K,X+ce);else for(var ve=0;ue>ve;ve++){var Oe=G[ve];ce+=s(Oe,K,X+ce),ce+=s(H[Oe],K,X+ce)}return ce}throw new Error("Unknown type "+_e)}function o(H){var K=typeof H;if(K==="string"){var X=n(H);if(32>X)return 1+X;if(256>X)return 2+X;if(65536>X)return 3+X;if(4294967296>X)return 5+X}if(H instanceof Uint8Array){var X=H.byteLength;if(256>X)return 2+X;if(65536>X)return 3+X;if(4294967296>X)return 5+X}if(K==="number"){if(Math.floor(H)!==H)return 9;if(H>=0){if(128>H)return 1;if(256>H)return 2;if(65536>H)return 3;if(4294967296>H)return 5;throw new Error("Number too big 0x"+H.toString(16))}if(H>=-32)return 1;if(H>=-128)return 2;if(H>=-32768)return 3;if(H>=-2147483648)return 5;throw new Error("Number too small -0x"+H.toString(16).substr(1))}if(K==="boolean"||H===null)return 1;if(K==="object"){var X,_e=0;if(Array.isArray(H)){X=H.length;for(var ue=0;X>ue;ue++)_e+=o(H[ue])}else{var ye=Object.keys(H);X=ye.length;for(var ue=0;X>ue;ue++){var Ae=ye[ue];_e+=o(Ae)+o(H[Ae])}}if(16>X)return 1+_e;if(65536>X)return 3+_e;if(4294967296>X)return 5+_e;throw new Error("Array or object too long 0x"+X.toString(16))}throw new Error("Unknown type "+K)}function a(H){var K=new ArrayBuffer(o(H)),X=new DataView(K);return s(H,X,0),new Uint8Array(K)}function l(H,K,X){return K?new H(K.buffer,K.byteOffset,K.byteLength/(X||1)):void 0}function h(H){return l(DataView,H)}function u(H){return l(Uint8Array,H)}function g(H){return l(Int8Array,H)}function m(H){return l(Int32Array,H,4)}function _(H){return l(Float32Array,H,4)}function b(H,K){var X=H.length/2;K||(K=new Int16Array(X));for(var _e=0,ue=0;X>_e;++_e,ue+=2)K[_e]=H[ue]<<8^H[ue+1]<<0;return K}function d(H,K){var X=H.length;K||(K=new Uint8Array(2*X));for(var _e=h(K),ue=0;X>ue;++ue)_e.setInt16(2*ue,H[ue]);return u(K)}function c(H,K){var X=H.length/4;K||(K=new Int32Array(X));for(var _e=0,ue=0;X>_e;++_e,ue+=4)K[_e]=H[ue]<<24^H[ue+1]<<16^H[ue+2]<<8^H[ue+3]<<0;return K}function f(H,K){var X=H.length;K||(K=new Uint8Array(4*X));for(var _e=h(K),ue=0;X>ue;++ue)_e.setInt32(4*ue,H[ue]);return u(K)}function v(H,K){var X=H.length;K||(K=new Float32Array(X/4));for(var _e=h(K),ue=h(H),ye=0,Ae=0,G=X/4;G>ye;++ye,Ae+=4)_e.setFloat32(Ae,ue.getFloat32(Ae),!0);return K}function y(H,K,X){var _e=H.length,ue=1/K;X||(X=new Float32Array(_e));for(var ye=0;_e>ye;++ye)X[ye]=H[ye]*ue;return X}function D(H,K,X){var _e=H.length;X||(X=new Int32Array(_e));for(var ue=0;_e>ue;++ue)X[ue]=Math.round(H[ue]*K);return X}function E(H,K){var X,_e;if(!K){var ue=0;for(X=0,_e=H.length;_e>X;X+=2)ue+=H[X+1];K=new H.constructor(ue)}var ye=0;for(X=0,_e=H.length;_e>X;X+=2)for(var Ae=H[X],G=H[X+1],ce=0;G>ce;++ce)K[ye]=Ae,++ye;return K}function p(H){if(H.length===0)return new Int32Array;var K,X,_e=2;for(K=1,X=H.length;X>K;++K)H[K-1]!==H[K]&&(_e+=2);var ue=new Int32Array(_e),ye=0,Ae=1;for(K=1,X=H.length;X>K;++K)H[K-1]!==H[K]?(ue[ye]=H[K-1],ue[ye+1]=Ae,Ae=1,ye+=2):++Ae;return ue[ye]=H[H.length-1],ue[ye+1]=Ae,ue}function x(H,K){var X=H.length;K||(K=new H.constructor(X)),X&&(K[0]=H[0]);for(var _e=1;X>_e;++_e)K[_e]=H[_e]+K[_e-1];return K}function w(H,K){var X=H.length;K||(K=new H.constructor(X)),K[0]=H[0];for(var _e=1;X>_e;++_e)K[_e]=H[_e]-H[_e-1];return K}function C(H,K){var X,_e,ue=H instanceof Int8Array?127:32767,ye=-ue-1,Ae=H.length;if(!K){var G=0;for(X=0;Ae>X;++X)H[X]<ue&&H[X]>ye&&++G;K=new Int32Array(G)}for(X=0,_e=0;Ae>X;){for(var ce=0;H[X]===ue||H[X]===ye;)ce+=H[X],++X;ce+=H[X],++X,K[_e]=ce,++_e}return K}function S(H,K){var X,_e=32767,ue=-_e-1,ye=H.length,Ae=0;for(X=0;ye>X;++X){var G=H[X];G===0?++Ae:G>0?(Ae+=Math.ceil(G/_e),G%_e===0&&(Ae+=1)):(Ae+=Math.ceil(G/ue),G%ue===0&&(Ae+=1))}var ce=new Int16Array(Ae),ve=0;for(X=0;ye>X;++X){var G=H[X];if(G>=0)for(;G>=_e;)ce[ve]=_e,++ve,G-=_e;else for(;ue>=G;)ce[ve]=ue,++ve,G-=ue;ce[ve]=G,++ve}return ce}function A(H,K){return x(E(H),K)}function P(H){return p(w(H))}function O(H,K,X){return y(E(H,m(X)),K,X)}function F(H,K){return p(D(H,K))}function I(H,K,X){return y(x(H,m(X)),K,X)}function B(H,K,X){return w(D(H,K),X)}function k(H,K,X){return y(C(H,m(X)),K,X)}function U(H,K,X){var _e=C(H,m(X));return I(_e,K,_(_e))}function W(H,K,X){return S(B(H,K))}function R(ye){var K=h(ye),X=K.getInt32(0),_e=K.getInt32(4),ue=ye.subarray(8,12),ye=ye.subarray(12);return[X,ye,_e,ue]}function z(H,K,X,_e){var ue=new ArrayBuffer(12+_e.byteLength),ye=new Uint8Array(ue),Ae=new DataView(ue);return Ae.setInt32(0,H),Ae.setInt32(4,K),X&&ye.set(X,8),ye.set(_e,12),ye}function V(H){var K=H.length,X=u(H);return z(2,K,void 0,X)}function q(H){var K=H.length,X=f(H);return z(4,K,void 0,X)}function Q(H,K){var X=H.length/K,_e=f([K]),ue=u(H);return z(5,X,_e,ue)}function re(H){var K=H.length,X=f(p(H));return z(6,K,void 0,X)}function te(H){var K=H.length,X=f(P(H));return z(8,K,void 0,X)}function ae(H,K){var X=H.length,_e=f([K]),ue=f(F(H,K));return z(9,X,_e,ue)}function ne(H,K){var X=H.length,_e=f([K]),ue=d(W(H,K));return z(10,X,_e,ue)}function le(H){var K={};return Ue.forEach(function(X){H[X]!==void 0&&(K[X]=H[X])}),H.bondAtomList&&(K.bondAtomList=q(H.bondAtomList)),H.bondOrderList&&(K.bondOrderList=V(H.bondOrderList)),K.xCoordList=ne(H.xCoordList,1e3),K.yCoordList=ne(H.yCoordList,1e3),K.zCoordList=ne(H.zCoordList,1e3),H.bFactorList&&(K.bFactorList=ne(H.bFactorList,100)),H.atomIdList&&(K.atomIdList=te(H.atomIdList)),H.altLocList&&(K.altLocList=re(H.altLocList)),H.occupancyList&&(K.occupancyList=ae(H.occupancyList,100)),K.groupIdList=te(H.groupIdList),K.groupTypeList=q(H.groupTypeList),H.secStructList&&(K.secStructList=V(H.secStructList)),H.insCodeList&&(K.insCodeList=re(H.insCodeList)),H.sequenceIndexList&&(K.sequenceIndexList=te(H.sequenceIndexList)),K.chainIdList=Q(H.chainIdList,4),H.chainNameList&&(K.chainNameList=Q(H.chainNameList,4)),K}function Ee(H){function K(ce){for(var ve={},Oe=0;ce>Oe;Oe++){var oe=ye();ve[oe]=ye()}return ve}function X(ce){var ve=H.subarray(Ae,Ae+ce);return Ae+=ce,ve}function _e(ce){var ve=H.subarray(Ae,Ae+ce);Ae+=ce;var Oe=65535;if(ce>Oe){for(var oe=[],me=0;me<ve.length;me+=Oe)oe.push(String.fromCharCode.apply(null,ve.subarray(me,me+Oe)));return oe.join("")}return String.fromCharCode.apply(null,ve)}function ue(ce){for(var ve=new Array(ce),Oe=0;ce>Oe;Oe++)ve[Oe]=ye();return ve}function ye(){var ce,ve,Oe=H[Ae];if((128&Oe)===0)return Ae++,Oe;if((240&Oe)===128)return ve=15&Oe,Ae++,K(ve);if((240&Oe)===144)return ve=15&Oe,Ae++,ue(ve);if((224&Oe)===160)return ve=31&Oe,Ae++,_e(ve);if((224&Oe)===224)return ce=G.getInt8(Ae),Ae++,ce;switch(Oe){case 192:return Ae++,null;case 194:return Ae++,!1;case 195:return Ae++,!0;case 196:return ve=G.getUint8(Ae+1),Ae+=2,X(ve);case 197:return ve=G.getUint16(Ae+1),Ae+=3,X(ve);case 198:return ve=G.getUint32(Ae+1),Ae+=5,X(ve);case 202:return ce=G.getFloat32(Ae+1),Ae+=5,ce;case 203:return ce=G.getFloat64(Ae+1),Ae+=9,ce;case 204:return ce=H[Ae+1],Ae+=2,ce;case 205:return ce=G.getUint16(Ae+1),Ae+=3,ce;case 206:return ce=G.getUint32(Ae+1),Ae+=5,ce;case 208:return ce=G.getInt8(Ae+1),Ae+=2,ce;case 209:return ce=G.getInt16(Ae+1),Ae+=3,ce;case 210:return ce=G.getInt32(Ae+1),Ae+=5,ce;case 217:return ve=G.getUint8(Ae+1),Ae+=2,_e(ve);case 218:return ve=G.getUint16(Ae+1),Ae+=3,_e(ve);case 219:return ve=G.getUint32(Ae+1),Ae+=5,_e(ve);case 220:return ve=G.getUint16(Ae+1),Ae+=3,ue(ve);case 221:return ve=G.getUint32(Ae+1),Ae+=5,ue(ve);case 222:return ve=G.getUint16(Ae+1),Ae+=3,K(ve);case 223:return ve=G.getUint32(Ae+1),Ae+=5,K(ve)}throw new Error("Unknown type 0x"+Oe.toString(16))}var Ae=0,G=new DataView(H.buffer);return ye()}function De(H,K,X,_e){switch(H){case 1:return v(K);case 2:return g(K);case 3:return b(K);case 4:return c(K);case 5:return u(K);case 6:return E(c(K),new Uint8Array(X));case 7:return E(c(K));case 8:return A(c(K));case 9:return O(c(K),c(_e)[0]);case 10:return U(b(K),c(_e)[0]);case 11:return y(b(K),c(_e)[0]);case 12:return k(b(K),c(_e)[0]);case 13:return k(g(K),c(_e)[0]);case 14:return C(b(K));case 15:return C(g(K))}}function Pe(H,K){K=K||{};var X=K.ignoreFields,_e={};return ze.forEach(function(ue){var ye=X?X.indexOf(ue)!==-1:!1,Ae=H[ue];ye||Ae===void 0||(Ae instanceof Uint8Array?_e[ue]=De.apply(null,R(Ae)):_e[ue]=Ae)}),_e}function pe(H){return String.fromCharCode.apply(null,H).replace(/\0/g,"")}function Z(H,K,X){X=X||{};var _e,ue,ye,Ae,G,ce,ve=X.firstModelOnly,Oe=K.onModel,oe=K.onChain,me=K.onGroup,$=K.onAtom,Te=K.onBond,ke=0,L=0,ge=0,de=0,j=0,se=-1,he=H.chainNameList,Ie=H.secStructList,Be=H.insCodeList,we=H.sequenceIndexList,je=H.atomIdList,Xe=H.bFactorList,Ke=H.altLocList,Je=H.occupancyList,Ye=H.bondAtomList,rt=H.bondOrderList;for(_e=0,ue=H.chainsPerModel.length;ue>_e&&!(ve&&ke>0);++_e){var st=H.chainsPerModel[ke];for(Oe&&Oe({chainCount:st,modelIndex:ke}),ye=0;st>ye;++ye){var pt=H.groupsPerChain[L];if(oe){var ut=pe(H.chainIdList.subarray(4*L,4*L+4)),et=null;he&&(et=pe(he.subarray(4*L,4*L+4))),oe({groupCount:pt,chainIndex:L,modelIndex:ke,chainId:ut,chainName:et})}for(Ae=0;pt>Ae;++Ae){var ct=H.groupList[H.groupTypeList[ge]],tt=ct.atomNameList.length;if(me){var xt=null;Ie&&(xt=Ie[ge]);var Dt=null;H.insCodeList&&(Dt=String.fromCharCode(Be[ge]));var wt=null;we&&(wt=we[ge]),me({atomCount:tt,groupIndex:ge,chainIndex:L,modelIndex:ke,groupId:H.groupIdList[ge],groupType:H.groupTypeList[ge],groupName:ct.groupName,singleLetterCode:ct.singleLetterCode,chemCompType:ct.chemCompType,secStruct:xt,insCode:Dt,sequenceIndex:wt})}for(G=0;tt>G;++G){if($){var At=null;je&&(At=je[de]);var Et=null;Xe&&(Et=Xe[de]);var zt=null;Ke&&(zt=String.fromCharCode(Ke[de]));var Nt=null;Je&&(Nt=Je[de]),$({atomIndex:de,groupIndex:ge,chainIndex:L,modelIndex:ke,atomId:At,element:ct.elementList[G],atomName:ct.atomNameList[G],formalCharge:ct.formalChargeList[G],xCoord:H.xCoordList[de],yCoord:H.yCoordList[de],zCoord:H.zCoordList[de],bFactor:Et,altLoc:zt,occupancy:Nt})}de+=1}if(Te){var Tt=ct.bondAtomList;for(G=0,ce=ct.bondOrderList.length;ce>G;++G)Te({atomIndex1:de-tt+Tt[2*G],atomIndex2:de-tt+Tt[2*G+1],bondOrder:ct.bondOrderList[G]})}ge+=1}L+=1}if(j=se+1,se=de-1,Te&&Ye)for(G=0,ce=Ye.length;ce>G;G+=2){var Ct=Ye[G],Lt=Ye[G+1];(Ct>=j&&se>=Ct||Lt>=j&&se>=Lt)&&Te({atomIndex1:Ct,atomIndex2:Lt,bondOrder:rt?rt[G/2]:null})}ke+=1}}function be(H){return a(le(H))}function Ce(H,K){H instanceof ArrayBuffer&&(H=new Uint8Array(H));var X;return X=H instanceof Uint8Array?Ee(H):H,Pe(X,K)}function ie(H,K,X,_e){function ue(){try{var Ae=Ce(ye.response);X(Ae)}catch(G){_e(G)}}var ye=new XMLHttpRequest;ye.addEventListener("load",ue,!0),ye.addEventListener("error",_e,!0),ye.responseType="arraybuffer",ye.open("GET",K+H.toUpperCase()),ye.send()}function Ne(H,K,X){ie(H,We,K,X)}function Ve(H,K,X){ie(H,He,K,X)}var Ue=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],Fe=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],ze=Ue.concat(Fe),Re="v1.0.1",Le="//mmtf.rcsb.org/v1.0/",We=Le+"full/",He=Le+"reduced/";t.encode=be,t.decode=Ce,t.traverse=Z,t.fetch=Ne,t.fetchReduced=Ve,t.version=Re,t.fetchUrl=We,t.fetchReducedUrl=He,t.encodeMsgpack=a,t.encodeMmtf=le,t.decodeMsgpack=Ee,t.decodeMmtf=Pe})}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(r,e)=>{for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),__webpack_require__.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())}(_3Dmol$1)),_3Dmol$1.exports}var _3DmolExports=require_3Dmol();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function round(r){return r+.5|0}const lim=(r,e,t)=>Math.max(Math.min(r,t),e);function p2b(r){return lim(round(r*2.55),0,255)}function n2b(r){return lim(round(r*255),0,255)}function b2n(r){return lim(round(r/2.55)/100,0,1)}function n2p(r){return lim(round(r*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=r=>hex[r&15],h2=r=>hex[(r&240)>>4]+hex[r&15],eq=r=>(r&240)>>4===(r&15),isShort=r=>eq(r.r)&&eq(r.g)&&eq(r.b)&&eq(r.a);function hexParse(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&map$1[r[1]]*17,g:255&map$1[r[2]]*17,b:255&map$1[r[3]]*17,a:e===5?map$1[r[4]]*17:255}:(e===7||e===9)&&(t={r:map$1[r[1]]<<4|map$1[r[2]],g:map$1[r[3]]<<4|map$1[r[4]],b:map$1[r[5]]<<4|map$1[r[6]],a:e===9?map$1[r[7]]<<4|map$1[r[8]]:255})),t}const alpha=(r,e)=>r<255?e(r):"";function hexString(r){var e=isShort(r)?h1:h2;return r?"#"+e(r.r)+e(r.g)+e(r.b)+alpha(r.a,e):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(r,e,t){const i=e*Math.min(t,1-t),n=(s,o=(s+r/30)%12)=>t-i*Math.max(Math.min(o-3,9-o,1),-1);return[n(0),n(8),n(4)]}function hsv2rgbn(r,e,t){const i=(n,s=(n+r/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function hwb2rgbn(r,e,t){const i=hsl2rgbn(r,1,.5);let n;for(e+t>1&&(n=1/(e+t),e*=n,t*=n),n=0;n<3;n++)i[n]*=1-e-t,i[n]+=e;return i}function hueValue(r,e,t,i,n){return r===n?(e-t)/i+(e<t?6:0):e===n?(t-r)/i+2:(r-e)/i+4}function rgb2hsl(r){const t=r.r/255,i=r.g/255,n=r.b/255,s=Math.max(t,i,n),o=Math.min(t,i,n),a=(s+o)/2;let l,h,u;return s!==o&&(u=s-o,h=a>.5?u/(2-s-o):u/(s+o),l=hueValue(t,i,n,u,s),l=l*60+.5),[l|0,h||0,a]}function calln(r,e,t,i){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,i)).map(n2b)}function hsl2rgb(r,e,t){return calln(hsl2rgbn,r,e,t)}function hwb2rgb(r,e,t){return calln(hwb2rgbn,r,e,t)}function hsv2rgb(r,e,t){return calln(hsv2rgbn,r,e,t)}function hue(r){return(r%360+360)%360}function hueParse(r){const e=HUE_RE.exec(r);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?p2b(+e[5]):n2b(+e[5]));const n=hue(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=hwb2rgb(n,s,o):e[1]==="hsv"?i=hsv2rgb(n,s,o):i=hsl2rgb(n,s,o),{r:i[0],g:i[1],b:i[2],a:t}}function rotate(r,e){var t=rgb2hsl(r);t[0]=hue(t[0]+e),t=hsl2rgb(t),r.r=t[0],r.g=t[1],r.b=t[2]}function hslString(r){if(!r)return;const e=rgb2hsl(r),t=e[0],i=n2p(e[1]),n=n2p(e[2]);return r.a<255?`hsla(${t}, ${i}%, ${n}%, ${b2n(r.a)})`:`hsl(${t}, ${i}%, ${n}%)`}const map$2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const r={},e=Object.keys(names$1),t=Object.keys(map$2);let i,n,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],n=0;n<t.length;n++)s=t[n],a=a.replace(s,map$2[s]);s=parseInt(names$1[o],16),r[a]=[s>>16&255,s>>8&255,s&255]}return r}let names;function nameParse(r){names||(names=unpack(),names.transparent=[0,0,0,0]);const e=names[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(r){const e=RGB_RE.exec(r);let t=255,i,n,s;if(e){if(e[7]!==i){const o=+e[7];t=e[8]?p2b(o):lim(o*255,0,255)}return i=+e[1],n=+e[3],s=+e[5],i=255&(e[2]?p2b(i):lim(i,0,255)),n=255&(e[4]?p2b(n):lim(n,0,255)),s=255&(e[6]?p2b(s):lim(s,0,255)),{r:i,g:n,b:s,a:t}}}function rgbString(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${b2n(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const to=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,from=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function interpolate$1(r,e,t){const i=from(b2n(r.r)),n=from(b2n(r.g)),s=from(b2n(r.b));return{r:n2b(to(i+t*(from(b2n(e.r))-i))),g:n2b(to(n+t*(from(b2n(e.g))-n))),b:n2b(to(s+t*(from(b2n(e.b))-s))),a:r.a+t*(e.a-r.a)}}function modHSL(r,e,t){if(r){let i=rgb2hsl(r);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=hsl2rgb(i),r.r=i[0],r.g=i[1],r.b=i[2]}}function clone$1(r,e){return r&&Object.assign(e||{},r)}function fromObject(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=n2b(r[3]))):(e=clone$1(r,{r:0,g:0,b:0,a:1}),e.a=n2b(e.a)),e}function functionParse(r){return r.charAt(0)==="r"?rgbParse(r):hueParse(r)}class Color{constructor(e){if(e instanceof Color)return e;const t=typeof e;let i;t==="object"?i=fromObject(e):t==="string"&&(i=hexParse(e)||nameParse(e)||functionParse(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=clone$1(this._rgb);return e&&(e.a=b2n(e.a)),e}set rgb(e){this._rgb=fromObject(e)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,n=e.rgb;let s;const o=t===s?.5:t,a=2*o-1,l=i.a-n.a,h=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-h,i.r=255&h*i.r+s*n.r+.5,i.g=255&h*i.g+s*n.g+.5,i.b=255&h*i.b+s*n.b+.5,i.a=o*i.a+(1-o)*n.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=interpolate$1(this._rgb,e._rgb,t)),this}clone(){return new Color(this.rgb)}alpha(e){return this._rgb.a=n2b(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=round(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return modHSL(this._rgb,2,e),this}darken(e){return modHSL(this._rgb,2,-e),this}saturate(e){return modHSL(this._rgb,1,e),this}desaturate(e){return modHSL(this._rgb,1,-e),this}rotate(e){return rotate(this._rgb,e),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function noop(){}const uid=(()=>{let r=0;return()=>r++})();function isNullOrUndef(r){return r==null}function isArray(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function isObject(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function isNumberFinite(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function finiteOrDefault(r,e){return isNumberFinite(r)?r:e}function valueOrDefault(r,e){return typeof r>"u"?e:r}const toPercentage=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,toDimension=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function callback(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function each(r,e,t,i){let n,s,o;if(isArray(r))for(s=r.length,n=0;n<s;n++)e.call(t,r[n],n);else if(isObject(r))for(o=Object.keys(r),s=o.length,n=0;n<s;n++)e.call(t,r[o[n]],o[n])}function _elementsEqual(r,e){let t,i,n,s;if(!r||!e||r.length!==e.length)return!1;for(t=0,i=r.length;t<i;++t)if(n=r[t],s=e[t],n.datasetIndex!==s.datasetIndex||n.index!==s.index)return!1;return!0}function clone(r){if(isArray(r))return r.map(clone);if(isObject(r)){const e=Object.create(null),t=Object.keys(r),i=t.length;let n=0;for(;n<i;++n)e[t[n]]=clone(r[t[n]]);return e}return r}function isValidKey(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function _merger(r,e,t,i){if(!isValidKey(r))return;const n=e[r],s=t[r];isObject(n)&&isObject(s)?merge(n,s,i):e[r]=clone(s)}function merge(r,e,t){const i=isArray(e)?e:[e],n=i.length;if(!isObject(r))return r;t=t||{};const s=t.merger||_merger;let o;for(let a=0;a<n;++a){if(o=i[a],!isObject(o))continue;const l=Object.keys(o);for(let h=0,u=l.length;h<u;++h)s(l[h],r,o,t)}return r}function mergeIf(r,e){return merge(r,e,{merger:_mergerIf})}function _mergerIf(r,e,t){if(!isValidKey(r))return;const i=e[r],n=t[r];isObject(i)&&isObject(n)?mergeIf(i,n):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=clone(n))}const keyResolvers={"":r=>r,x:r=>r.x,y:r=>r.y};function _splitKey(r){const e=r.split("."),t=[];let i="";for(const n of e)i+=n,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function _getKeyResolver(r){const e=_splitKey(r);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function resolveObjectKey(r,e){return(keyResolvers[e]||(keyResolvers[e]=_getKeyResolver(e)))(r)}function _capitalize(r){return r.charAt(0).toUpperCase()+r.slice(1)}const defined=r=>typeof r<"u",isFunction=r=>typeof r=="function",setsEqual=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function _isClickEvent(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(r,e,t){return Math.abs(r-e)<t}function niceNum(r){const e=Math.round(r);r=almostEquals(r,e,r/1e3)?e:r;const t=Math.pow(10,Math.floor(log10(r))),i=r/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function _factorize(r){const e=[],t=Math.sqrt(r);let i;for(i=1;i<t;i++)r%i===0&&(e.push(i),e.push(r/i));return t===(t|0)&&e.push(t),e.sort((n,s)=>n-s).pop(),e}function isNonPrimitive(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function isNumber(r){return!isNonPrimitive(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function almostWhole(r,e){const t=Math.round(r);return t-e<=r&&t+e>=r}function _setMinAndMaxByKey(r,e,t){let i,n,s;for(i=0,n=r.length;i<n;i++)s=r[i][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function toRadians(r){return r*(PI/180)}function toDegrees(r){return r*(180/PI)}function _decimalPlaces(r){if(!isNumberFinite(r))return;let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}function getAngleFromPoint(r,e){const t=e.x-r.x,i=e.y-r.y,n=Math.sqrt(t*t+i*i);let s=Math.atan2(i,t);return s<-.5*PI&&(s+=TAU),{angle:s,distance:n}}function distanceBetweenPoints(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function _angleDiff(r,e){return(r-e+PITAU)%TAU-PI}function _normalizeAngle(r){return(r%TAU+TAU)%TAU}function _angleBetween(r,e,t,i){const n=_normalizeAngle(r),s=_normalizeAngle(e),o=_normalizeAngle(t),a=_normalizeAngle(s-n),l=_normalizeAngle(o-n),h=_normalizeAngle(n-s),u=_normalizeAngle(n-o);return n===s||n===o||i&&s===o||a>l&&h<u}function _limitValue(r,e,t){return Math.max(e,Math.min(t,r))}function _int16Range(r){return _limitValue(r,-32768,32767)}function _isBetween(r,e,t,i=1e-6){return r>=Math.min(e,t)-i&&r<=Math.max(e,t)+i}function _lookup(r,e,t){t=t||(o=>r[o]<e);let i=r.length-1,n=0,s;for(;i-n>1;)s=n+i>>1,t(s)?n=s:i=s;return{lo:n,hi:i}}const _lookupByKey=(r,e,t,i)=>_lookup(r,t,i?n=>{const s=r[n][e];return s<t||s===t&&r[n+1][e]===t}:n=>r[n][e]<t),_rlookupByKey=(r,e,t)=>_lookup(r,t,i=>r[i][e]>=t);function _filterBetween(r,e,t){let i=0,n=r.length;for(;i<n&&r[i]<e;)i++;for(;n>i&&r[n-1]>t;)n--;return i>0||n<r.length?r.slice(i,n):r}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),arrayEvents.forEach(t=>{const i="_onData"+_capitalize(t),n=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...s){const o=n.apply(this,s);return r._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function unlistenArrayEvents(r,e){const t=r._chartjs;if(!t)return;const i=t.listeners,n=i.indexOf(e);n!==-1&&i.splice(n,1),!(i.length>0)&&(arrayEvents.forEach(s=>{delete r[s]}),delete r._chartjs)}function _arrayUnique(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const requestAnimFrame=function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame}();function throttled(r,e){let t=[],i=!1;return function(...n){t=n,i||(i=!0,requestAnimFrame.call(window,()=>{i=!1,r.apply(e,t)}))}}function debounce(r,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(r,e,i)):r.apply(this,i),e}}const _toLeftRightCenter=r=>r==="start"?"left":r==="end"?"right":"center",_alignStartEnd=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,_textX=(r,e,t,i)=>r===(i?"left":"right")?t:r==="center"?(e+t)/2:e;function _getStartAndCountOfVisiblePoints(r,e,t){const i=e.length;let n=0,s=i;if(r._sorted){const{iScale:o,vScale:a,_parsed:l}=r,h=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null,u=o.axis,{min:g,max:m,minDefined:_,maxDefined:b}=o.getUserBounds();if(_){if(n=Math.min(_lookupByKey(l,u,g).lo,t?i:_lookupByKey(e,u,o.getPixelForValue(g)).lo),h){const d=l.slice(0,n+1).reverse().findIndex(c=>!isNullOrUndef(c[a.axis]));n-=Math.max(0,d)}n=_limitValue(n,0,i-1)}if(b){let d=Math.max(_lookupByKey(l,o.axis,m,!0).hi+1,t?0:_lookupByKey(e,u,o.getPixelForValue(m),!0).hi+1);if(h){const c=l.slice(d-1).findIndex(f=>!isNullOrUndef(f[a.axis]));d+=Math.max(0,c)}s=_limitValue(d,n,i)-n}else s=i-n}return{start:n,count:s}}function _scaleRangesChanged(r){const{xScale:e,yScale:t,_scaleRanges:i}=r,n={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return r._scaleRanges=n,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,n),s}const atEdge=r=>r===0||r===1,elasticIn=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*TAU/t)),elasticOut=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*TAU/t)+1,effects={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*HALF_PI)+1,easeOutSine:r=>Math.sin(r*HALF_PI),easeInOutSine:r=>-.5*(Math.cos(PI*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>atEdge(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>atEdge(r)?r:elasticIn(r,.075,.3),easeOutElastic:r=>atEdge(r)?r:elasticOut(r,.075,.3),easeInOutElastic(r){return atEdge(r)?r:r<.5?.5*elasticIn(r*2,.1125,.45):.5+.5*elasticOut(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-effects.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?effects.easeInBounce(r*2)*.5:effects.easeOutBounce(r*2-1)*.5+.5};function isPatternOrGradient(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function color(r){return isPatternOrGradient(r)?r:new Color(r)}function getHoverColor(r){return isPatternOrGradient(r)?r:new Color(r).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function applyLayoutsDefaults(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(r,e){e=e||{};const t=r+JSON.stringify(e);let i=intlCache.get(t);return i||(i=new Intl.NumberFormat(r,e),intlCache.set(t,i)),i}function formatNumber(r,e,t){return getNumberFormat(e,t).format(r)}const formatters={values(r){return isArray(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const i=this.chart.options.locale;let n,s=r;if(t.length>1){const h=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(h<1e-4||h>1e15)&&(n="scientific"),s=calculateDelta(r,t)}const o=log10(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:n,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),formatNumber(r,i,l)},logarithmic(r,e,t){if(r===0)return"0";const i=t[e].significand||r/Math.pow(10,Math.floor(log10(r)));return[1,2,3,5,10,15].includes(i)||e>.8*t.length?formatters.numeric.call(this,r,e,t):""}};function calculateDelta(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var Ticks={formatters};function applyScaleDefaults(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(r,e){if(!e)return r;const t=e.split(".");for(let i=0,n=t.length;i<n;++i){const s=t[i];r=r[s]||(r[s]=Object.create(null))}return r}function set(r,e,t){return typeof e=="string"?merge(getScope$1(r,e),t):merge(getScope$1(r,""),e)}class Defaults{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,n)=>getHoverColor(n.backgroundColor),this.hoverBorderColor=(i,n)=>getHoverColor(n.borderColor),this.hoverColor=(i,n)=>getHoverColor(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return set(this,e,t)}get(e){return getScope$1(this,e)}describe(e,t){return set(descriptors,e,t)}override(e,t){return set(overrides,e,t)}route(e,t,i,n){const s=getScope$1(this,e),o=getScope$1(this,i),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],h=o[n];return isObject(l)?Object.assign({},h,l):valueOrDefault(l,h)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var defaults=new Defaults({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(r){return!r||isNullOrUndef(r.size)||isNullOrUndef(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function _measureText(r,e,t,i,n){let s=e[n];return s||(s=e[n]=r.measureText(n).width,t.push(n)),s>i&&(i=s),i}function _longestText(r,e,t,i){i=i||{};let n=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(n=i.data={},s=i.garbageCollect=[],i.font=e),r.save(),r.font=e;let o=0;const a=t.length;let l,h,u,g,m;for(l=0;l<a;l++)if(g=t[l],g!=null&&!isArray(g))o=_measureText(r,n,s,o,g);else if(isArray(g))for(h=0,u=g.length;h<u;h++)m=g[h],m!=null&&!isArray(m)&&(o=_measureText(r,n,s,o,m));r.restore();const _=s.length/2;if(_>t.length){for(l=0;l<_;l++)delete n[s[l]];s.splice(0,_)}return o}function _alignPixel(r,e,t){const i=r.currentDevicePixelRatio,n=t!==0?Math.max(t/2,.5):0;return Math.round((e-n)*i)/i+n}function clearCanvas(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function drawPoint(r,e,t,i){drawPointLegend(r,e,t,i,null)}function drawPointLegend(r,e,t,i,n){let s,o,a,l,h,u,g,m;const _=e.pointStyle,b=e.rotation,d=e.radius;let c=(b||0)*RAD_PER_DEG;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){r.save(),r.translate(t,i),r.rotate(c),r.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),r.restore();return}if(!(isNaN(d)||d<=0)){switch(r.beginPath(),_){default:n?r.ellipse(t,i,n/2,d,0,0,TAU):r.arc(t,i,d,0,TAU),r.closePath();break;case"triangle":u=n?n/2:d,r.moveTo(t+Math.sin(c)*u,i-Math.cos(c)*d),c+=TWO_THIRDS_PI,r.lineTo(t+Math.sin(c)*u,i-Math.cos(c)*d),c+=TWO_THIRDS_PI,r.lineTo(t+Math.sin(c)*u,i-Math.cos(c)*d),r.closePath();break;case"rectRounded":h=d*.516,l=d-h,o=Math.cos(c+QUARTER_PI)*l,g=Math.cos(c+QUARTER_PI)*(n?n/2-h:l),a=Math.sin(c+QUARTER_PI)*l,m=Math.sin(c+QUARTER_PI)*(n?n/2-h:l),r.arc(t-g,i-a,h,c-PI,c-HALF_PI),r.arc(t+m,i-o,h,c-HALF_PI,c),r.arc(t+g,i+a,h,c,c+HALF_PI),r.arc(t-m,i+o,h,c+HALF_PI,c+PI),r.closePath();break;case"rect":if(!b){l=Math.SQRT1_2*d,u=n?n/2:l,r.rect(t-u,i-l,2*u,2*l);break}c+=QUARTER_PI;case"rectRot":g=Math.cos(c)*(n?n/2:d),o=Math.cos(c)*d,a=Math.sin(c)*d,m=Math.sin(c)*(n?n/2:d),r.moveTo(t-g,i-a),r.lineTo(t+m,i-o),r.lineTo(t+g,i+a),r.lineTo(t-m,i+o),r.closePath();break;case"crossRot":c+=QUARTER_PI;case"cross":g=Math.cos(c)*(n?n/2:d),o=Math.cos(c)*d,a=Math.sin(c)*d,m=Math.sin(c)*(n?n/2:d),r.moveTo(t-g,i-a),r.lineTo(t+g,i+a),r.moveTo(t+m,i-o),r.lineTo(t-m,i+o);break;case"star":g=Math.cos(c)*(n?n/2:d),o=Math.cos(c)*d,a=Math.sin(c)*d,m=Math.sin(c)*(n?n/2:d),r.moveTo(t-g,i-a),r.lineTo(t+g,i+a),r.moveTo(t+m,i-o),r.lineTo(t-m,i+o),c+=QUARTER_PI,g=Math.cos(c)*(n?n/2:d),o=Math.cos(c)*d,a=Math.sin(c)*d,m=Math.sin(c)*(n?n/2:d),r.moveTo(t-g,i-a),r.lineTo(t+g,i+a),r.moveTo(t+m,i-o),r.lineTo(t-m,i+o);break;case"line":o=n?n/2:Math.cos(c)*d,a=Math.sin(c)*d,r.moveTo(t-o,i-a),r.lineTo(t+o,i+a);break;case"dash":r.moveTo(t,i),r.lineTo(t+Math.cos(c)*(n?n/2:d),i+Math.sin(c)*d);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function _isPointInArea(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function clipArea(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function unclipArea(r){r.restore()}function _steppedLineTo(r,e,t,i,n){if(!e)return r.lineTo(t.x,t.y);if(n==="middle"){const s=(e.x+t.x)/2;r.lineTo(s,e.y),r.lineTo(s,t.y)}else n==="after"!=!!i?r.lineTo(e.x,t.y):r.lineTo(t.x,e.y);r.lineTo(t.x,t.y)}function _bezierCurveTo(r,e,t,i){if(!e)return r.lineTo(t.x,t.y);r.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function setRenderOpts(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),isNullOrUndef(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function decorateText(r,e,t,i,n){if(n.strikethrough||n.underline){const s=r.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=t-s.actualBoundingBoxAscent,h=t+s.actualBoundingBoxDescent,u=n.strikethrough?(l+h)/2:h;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=n.decorationWidth||2,r.moveTo(o,u),r.lineTo(a,u),r.stroke()}}function drawBackdrop(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function renderText(r,e,t,i,n,s={}){const o=isArray(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,h;for(r.save(),r.font=n.string,setRenderOpts(r,s),l=0;l<o.length;++l)h=o[l],s.backdrop&&drawBackdrop(r,s.backdrop),a&&(s.strokeColor&&(r.strokeStyle=s.strokeColor),isNullOrUndef(s.strokeWidth)||(r.lineWidth=s.strokeWidth),r.strokeText(h,t,i,s.maxWidth)),r.fillText(h,t,i,s.maxWidth),decorateText(r,t,i,h,s),i+=Number(n.lineHeight);r.restore()}function addRoundedRectPath(r,e){const{x:t,y:i,w:n,h:s,radius:o}=e;r.arc(t+o.topLeft,i+o.topLeft,o.topLeft,1.5*PI,PI,!0),r.lineTo(t,i+s-o.bottomLeft),r.arc(t+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,PI,HALF_PI,!0),r.lineTo(t+n-o.bottomRight,i+s),r.arc(t+n-o.bottomRight,i+s-o.bottomRight,o.bottomRight,HALF_PI,0,!0),r.lineTo(t+n,i+o.topRight),r.arc(t+n-o.topRight,i+o.topRight,o.topRight,0,-HALF_PI,!0),r.lineTo(t+o.topLeft,i)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(r,e){const t=(""+r).match(LINE_HEIGHT);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const numberOrZero=r=>+r||0;function _readValueToProps(r,e){const t={},i=isObject(e),n=i?Object.keys(e):e,s=isObject(r)?i?o=>valueOrDefault(r[o],r[e[o]]):o=>r[o]:()=>r;for(const o of n)t[o]=numberOrZero(s(o));return t}function toTRBL(r){return _readValueToProps(r,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(r){return _readValueToProps(r,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(r){const e=toTRBL(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function toFont(r,e){r=r||{},e=e||defaults.font;let t=valueOrDefault(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=valueOrDefault(r.style,e.style);i&&!(""+i).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const n={family:valueOrDefault(r.family,e.family),lineHeight:toLineHeight(valueOrDefault(r.lineHeight,e.lineHeight),t),size:t,style:i,weight:valueOrDefault(r.weight,e.weight),string:""};return n.string=toFontString(n),n}function resolve(r,e,t,i){let n,s,o;for(n=0,s=r.length;n<s;++n)if(o=r[n],o!==void 0&&o!==void 0)return o}function _addGrace(r,e,t){const{min:i,max:n}=r,s=toDimension(e,(n-i)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(i,-Math.abs(s)),max:o(n,s)}}function createContext(r,e){return Object.assign(Object.create(r),e)}function _createResolver(r,e=[""],t,i,n=()=>r[0]){const s=t||r;typeof i>"u"&&(i=_resolve("_fallback",r));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:s,_fallback:i,_getTarget:n,override:a=>_createResolver([a,...r],e,s,i)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete r[0][l],!0},get(a,l){return _cached(a,l,()=>_resolveWithPrefixes(l,e,r,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(a,l){return getKeysFromAllScopes(a).includes(l)},ownKeys(a){return getKeysFromAllScopes(a)},set(a,l,h){const u=a._storage||(a._storage=n());return a[l]=u[l]=h,delete a._keys,!0}})}function _attachContext(r,e,t,i){const n={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:_descriptors(r,i),setContext:s=>_attachContext(r,s,t,i),override:s=>_attachContext(r.override(s),e,t,i)};return new Proxy(n,{deleteProperty(s,o){return delete s[o],delete r[o],!0},get(s,o,a){return _cached(s,o,()=>_resolveWithContext(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(r,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,o)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(s,o){return Reflect.has(r,o)},ownKeys(){return Reflect.ownKeys(r)},set(s,o,a){return r[o]=a,delete s[o],!0}})}function _descriptors(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:n=e.allKeys}=r;return{allKeys:n,scriptable:t,indexable:i,isScriptable:isFunction(t)?t:()=>t,isIndexable:isFunction(i)?i:()=>i}}const readKey=(r,e)=>r?r+_capitalize(e):e,needsSubResolver=(r,e)=>isObject(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _cached(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const i=t();return r[e]=i,i}function _resolveWithContext(r,e,t){const{_proxy:i,_context:n,_subProxy:s,_descriptors:o}=r;let a=i[e];return isFunction(a)&&o.isScriptable(e)&&(a=_resolveScriptable(e,a,r,t)),isArray(a)&&a.length&&(a=_resolveArray(e,a,r,o.isIndexable)),needsSubResolver(e,a)&&(a=_attachContext(a,n,s&&s[e],o)),a}function _resolveScriptable(r,e,t,i){const{_proxy:n,_context:s,_subProxy:o,_stack:a}=t;if(a.has(r))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+r);a.add(r);let l=e(s,o||i);return a.delete(r),needsSubResolver(r,l)&&(l=createSubResolver(n._scopes,n,r,l)),l}function _resolveArray(r,e,t,i){const{_proxy:n,_context:s,_subProxy:o,_descriptors:a}=t;if(typeof s.index<"u"&&i(r))return e[s.index%e.length];if(isObject(e[0])){const l=e,h=n._scopes.filter(u=>u!==l);e=[];for(const u of l){const g=createSubResolver(h,n,r,u);e.push(_attachContext(g,s,o&&o[r],a))}}return e}function resolveFallback(r,e,t){return isFunction(r)?r(e,t):r}const getScope=(r,e)=>r===!0?e:typeof r=="string"?resolveObjectKey(e,r):void 0;function addScopes(r,e,t,i,n){for(const s of e){const o=getScope(t,s);if(o){r.add(o);const a=resolveFallback(o._fallback,t,n);if(typeof a<"u"&&a!==t&&a!==i)return a}else if(o===!1&&typeof i<"u"&&t!==i)return null}return!1}function createSubResolver(r,e,t,i){const n=e._rootScopes,s=resolveFallback(e._fallback,t,i),o=[...r,...n],a=new Set;a.add(i);let l=addScopesFromKey(a,o,t,s||t,i);return l===null||typeof s<"u"&&s!==t&&(l=addScopesFromKey(a,o,s,l,i),l===null)?!1:_createResolver(Array.from(a),[""],n,s,()=>subGetTarget(e,t,i))}function addScopesFromKey(r,e,t,i,n){for(;t;)t=addScopes(r,e,t,i,n);return t}function subGetTarget(r,e,t){const i=r._getTarget();e in i||(i[e]={});const n=i[e];return isArray(n)&&isObject(t)?t:n||{}}function _resolveWithPrefixes(r,e,t,i){let n;for(const s of e)if(n=_resolve(readKey(s,r),t),typeof n<"u")return needsSubResolver(r,n)?createSubResolver(t,i,r,n):n}function _resolve(r,e){for(const t of e){if(!t)continue;const i=t[r];if(typeof i<"u")return i}}function getKeysFromAllScopes(r){let e=r._keys;return e||(e=r._keys=resolveKeysFromAllScopes(r._scopes)),e}function resolveKeysFromAllScopes(r){const e=new Set;for(const t of r)for(const i of Object.keys(t).filter(n=>!n.startsWith("_")))e.add(i);return Array.from(e)}function _parseObjectDataRadialScale(r,e,t,i){const{iScale:n}=r,{key:s="r"}=this._parsing,o=new Array(i);let a,l,h,u;for(a=0,l=i;a<l;++a)h=a+t,u=e[h],o[a]={r:n.parse(resolveObjectKey(u,s),h)};return o}const EPSILON=Number.EPSILON||1e-14,getPoint=(r,e)=>e<r.length&&!r[e].skip&&r[e],getValueAxis=r=>r==="x"?"y":"x";function splineCurve(r,e,t,i){const n=r.skip?e:r,s=e,o=t.skip?e:t,a=distanceBetweenPoints(s,n),l=distanceBetweenPoints(o,s);let h=a/(a+l),u=l/(a+l);h=isNaN(h)?0:h,u=isNaN(u)?0:u;const g=i*h,m=i*u;return{previous:{x:s.x-g*(o.x-n.x),y:s.y-g*(o.y-n.y)},next:{x:s.x+m*(o.x-n.x),y:s.y+m*(o.y-n.y)}}}function monotoneAdjust(r,e,t){const i=r.length;let n,s,o,a,l,h=getPoint(r,0);for(let u=0;u<i-1;++u)if(l=h,h=getPoint(r,u+1),!(!l||!h)){if(almostEquals(e[u],0,EPSILON)){t[u]=t[u+1]=0;continue}n=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(n,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=n*o*e[u],t[u+1]=s*o*e[u])}}function monotoneCompute(r,e,t="x"){const i=getValueAxis(t),n=r.length;let s,o,a,l=getPoint(r,0);for(let h=0;h<n;++h){if(o=a,a=l,l=getPoint(r,h+1),!a)continue;const u=a[t],g=a[i];o&&(s=(u-o[t])/3,a[`cp1${t}`]=u-s,a[`cp1${i}`]=g-s*e[h]),l&&(s=(l[t]-u)/3,a[`cp2${t}`]=u+s,a[`cp2${i}`]=g+s*e[h])}}function splineCurveMonotone(r,e="x"){const t=getValueAxis(e),i=r.length,n=Array(i).fill(0),s=Array(i);let o,a,l,h=getPoint(r,0);for(o=0;o<i;++o)if(a=l,l=h,h=getPoint(r,o+1),!!l){if(h){const u=h[e]-l[e];n[o]=u!==0?(h[t]-l[t])/u:0}s[o]=a?h?sign(n[o-1])!==sign(n[o])?0:(n[o-1]+n[o])/2:n[o-1]:n[o]}monotoneAdjust(r,n,s),monotoneCompute(r,s,e)}function capControlPoint(r,e,t){return Math.max(Math.min(r,t),e)}function capBezierPoints(r,e){let t,i,n,s,o,a=_isPointInArea(r[0],e);for(t=0,i=r.length;t<i;++t)o=s,s=a,a=t<i-1&&_isPointInArea(r[t+1],e),s&&(n=r[t],o&&(n.cp1x=capControlPoint(n.cp1x,e.left,e.right),n.cp1y=capControlPoint(n.cp1y,e.top,e.bottom)),a&&(n.cp2x=capControlPoint(n.cp2x,e.left,e.right),n.cp2y=capControlPoint(n.cp2y,e.top,e.bottom)))}function _updateBezierControlPoints(r,e,t,i,n){let s,o,a,l;if(e.spanGaps&&(r=r.filter(h=>!h.skip)),e.cubicInterpolationMode==="monotone")splineCurveMonotone(r,n);else{let h=i?r[r.length-1]:r[0];for(s=0,o=r.length;s<o;++s)a=r[s],l=splineCurve(h,a,r[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,h=a}e.capBezierPoints&&capBezierPoints(r,t)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function parseMaxStyle(r,e,t){let i;return typeof r=="string"?(i=parseInt(r,10),r.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=r,i}const getComputedStyle$1=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function getStyle(r,e){return getComputedStyle$1(r).getPropertyValue(e)}const positions=["top","right","bottom","left"];function getPositionedStyle(r,e,t){const i={};t=t?"-"+t:"";for(let n=0;n<4;n++){const s=positions[n];i[s]=parseFloat(r[e+"-"+s+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const useOffsetPos=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function getCanvasPosition(r,e){const t=r.touches,i=t&&t.length?t[0]:r,{offsetX:n,offsetY:s}=i;let o=!1,a,l;if(useOffsetPos(n,s,r.target))a=n,l=s;else{const h=e.getBoundingClientRect();a=i.clientX-h.left,l=i.clientY-h.top,o=!0}return{x:a,y:l,box:o}}function getRelativePosition(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:i}=e,n=getComputedStyle$1(t),s=n.boxSizing==="border-box",o=getPositionedStyle(n,"padding"),a=getPositionedStyle(n,"border","width"),{x:l,y:h,box:u}=getCanvasPosition(r,t),g=o.left+(u&&a.left),m=o.top+(u&&a.top);let{width:_,height:b}=e;return s&&(_-=o.width+a.width,b-=o.height+a.height),{x:Math.round((l-g)/_*t.width/i),y:Math.round((h-m)/b*t.height/i)}}function getContainerSize(r,e,t){let i,n;if(e===void 0||t===void 0){const s=r&&_getParentNode(r);if(!s)e=r.clientWidth,t=r.clientHeight;else{const o=s.getBoundingClientRect(),a=getComputedStyle$1(s),l=getPositionedStyle(a,"border","width"),h=getPositionedStyle(a,"padding");e=o.width-h.width-l.width,t=o.height-h.height-l.height,i=parseMaxStyle(a.maxWidth,s,"clientWidth"),n=parseMaxStyle(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:i||INFINITY,maxHeight:n||INFINITY}}const round1=r=>Math.round(r*10)/10;function getMaximumSize(r,e,t,i){const n=getComputedStyle$1(r),s=getPositionedStyle(n,"margin"),o=parseMaxStyle(n.maxWidth,r,"clientWidth")||INFINITY,a=parseMaxStyle(n.maxHeight,r,"clientHeight")||INFINITY,l=getContainerSize(r,e,t);let{width:h,height:u}=l;if(n.boxSizing==="content-box"){const m=getPositionedStyle(n,"border","width"),_=getPositionedStyle(n,"padding");h-=_.width+m.width,u-=_.height+m.height}return h=Math.max(0,h-s.width),u=Math.max(0,i?h/i:u-s.height),h=round1(Math.min(h,o,l.maxWidth)),u=round1(Math.min(u,a,l.maxHeight)),h&&!u&&(u=round1(h/2)),(e!==void 0||t!==void 0)&&i&&l.height&&u>l.height&&(u=l.height,h=round1(Math.floor(u*i))),{width:h,height:u}}function retinaScale(r,e,t){const i=e||1,n=Math.floor(r.height*i),s=Math.floor(r.width*i);r.height=Math.floor(r.height),r.width=Math.floor(r.width);const o=r.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${r.height}px`,o.style.width=`${r.width}px`),r.currentDevicePixelRatio!==i||o.height!==n||o.width!==s?(r.currentDevicePixelRatio=i,o.height=n,o.width=s,r.ctx.setTransform(i,0,0,i,0,0),!0):!1}const supportsEventListenerOptions=function(){let r=!1;try{const e={get passive(){return r=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r}();function readUsedSize(r,e){const t=getStyle(r,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function _pointInLine(r,e,t,i){return{x:r.x+t*(e.x-r.x),y:r.y+t*(e.y-r.y)}}function _steppedInterpolation(r,e,t,i){return{x:r.x+t*(e.x-r.x),y:i==="middle"?t<.5?r.y:e.y:i==="after"?t<1?r.y:e.y:t>0?e.y:r.y}}function _bezierInterpolation(r,e,t,i){const n={x:r.cp2x,y:r.cp2y},s={x:e.cp1x,y:e.cp1y},o=_pointInLine(r,n,t),a=_pointInLine(n,s,t),l=_pointInLine(s,e,t),h=_pointInLine(o,a,t),u=_pointInLine(a,l,t);return _pointInLine(h,u,t)}const getRightToLeftAdapter=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},getLeftToRightAdapter=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function getRtlAdapter(r,e,t){return r?getRightToLeftAdapter(e,t):getLeftToRightAdapter()}function overrideTextDirection(r,e){let t,i;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=i)}function restoreTextDirection(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function propertyFn(r){return r==="angle"?{between:_angleBetween,compare:_angleDiff,normalize:_normalizeAngle}:{between:_isBetween,compare:(e,t)=>e-t,normalize:e=>e}}function normalizeSegment({start:r,end:e,count:t,loop:i,style:n}){return{start:r%t,end:e%t,loop:i&&(e-r+1)%t===0,style:n}}function getSegment(r,e,t){const{property:i,start:n,end:s}=t,{between:o,normalize:a}=propertyFn(i),l=e.length;let{start:h,end:u,loop:g}=r,m,_;if(g){for(h+=l,u+=l,m=0,_=l;m<_&&o(a(e[h%l][i]),n,s);++m)h--,u--;h%=l,u%=l}return u<h&&(u+=l),{start:h,end:u,loop:g,style:r.style}}function _boundSegment(r,e,t){if(!t)return[r];const{property:i,start:n,end:s}=t,o=e.length,{compare:a,between:l,normalize:h}=propertyFn(i),{start:u,end:g,loop:m,style:_}=getSegment(r,e,t),b=[];let d=!1,c=null,f,v,y;const D=()=>l(n,y,f)&&a(n,y)!==0,E=()=>a(s,f)===0||l(s,y,f),p=()=>d||D(),x=()=>!d||E();for(let w=u,C=u;w<=g;++w)v=e[w%o],!v.skip&&(f=h(v[i]),f!==y&&(d=l(f,n,s),c===null&&p()&&(c=a(f,n)===0?w:C),c!==null&&x()&&(b.push(normalizeSegment({start:c,end:w,loop:m,count:o,style:_})),c=null),C=w,y=f));return c!==null&&b.push(normalizeSegment({start:c,end:g,loop:m,count:o,style:_})),b}function _boundSegments(r,e){const t=[],i=r.segments;for(let n=0;n<i.length;n++){const s=_boundSegment(i[n],r.points,e);s.length&&t.push(...s)}return t}function findStartAndEnd(r,e,t,i){let n=0,s=e-1;if(t&&!i)for(;n<e&&!r[n].skip;)n++;for(;n<e&&r[n].skip;)n++;for(n%=e,t&&(s+=n);s>n&&r[s%e].skip;)s--;return s%=e,{start:n,end:s}}function solidSegments(r,e,t,i){const n=r.length,s=[];let o=e,a=r[e],l;for(l=e+1;l<=t;++l){const h=r[l%n];h.skip||h.stop?a.skip||(i=!1,s.push({start:e%n,end:(l-1)%n,loop:i}),e=o=h.stop?l:null):(o=l,a.skip&&(e=l)),a=h}return o!==null&&s.push({start:e%n,end:o%n,loop:i}),s}function _computeSegments(r,e){const t=r.points,i=r.options.spanGaps,n=t.length;if(!n)return[];const s=!!r._loop,{start:o,end:a}=findStartAndEnd(t,n,s,i);if(i===!0)return splitByStyles(r,[{start:o,end:a,loop:s}],t,e);const l=a<o?a+n:a,h=!!r._fullLoop&&o===0&&a===n-1;return splitByStyles(r,solidSegments(t,o,l,h),t,e)}function splitByStyles(r,e,t,i){return!i||!i.setContext||!t?e:doSplitByStyles(r,e,t,i)}function doSplitByStyles(r,e,t,i){const n=r._chart.getContext(),s=readStyle(r.options),{_datasetIndex:o,options:{spanGaps:a}}=r,l=t.length,h=[];let u=s,g=e[0].start,m=g;function _(b,d,c,f){const v=a?-1:1;if(b!==d){for(b+=l;t[b%l].skip;)b-=v;for(;t[d%l].skip;)d+=v;b%l!==d%l&&(h.push({start:b%l,end:d%l,loop:c,style:f}),u=f,g=d%l)}}for(const b of e){g=a?g:b.start;let d=t[g%l],c;for(m=g+1;m<=b.end;m++){const f=t[m%l];c=readStyle(i.setContext(createContext(n,{type:"segment",p0:d,p1:f,p0DataIndex:(m-1)%l,p1DataIndex:m%l,datasetIndex:o}))),styleChanged(c,u)&&_(g,m-1,b.loop,u),d=f,u=c}g<m-1&&_(g,m-1,b.loop,u)}return h}function readStyle(r){return{backgroundColor:r.backgroundColor,borderCapStyle:r.borderCapStyle,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderJoinStyle:r.borderJoinStyle,borderWidth:r.borderWidth,borderColor:r.borderColor}}function styleChanged(r,e){if(!e)return!1;const t=[],i=function(n,s){return isPatternOrGradient(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(r,i)!==JSON.stringify(e,i)}function getSizeForArea(r,e,t){return r.options.clip?r[t]:e[t]}function getDatasetArea(r,e){const{xScale:t,yScale:i}=r;return t&&i?{left:getSizeForArea(t,e,"left"),right:getSizeForArea(t,e,"right"),top:getSizeForArea(i,e,"top"),bottom:getSizeForArea(i,e,"bottom")}:e}function getDatasetClipArea(r,e){const t=e._clip;if(t.disabled)return!1;const i=getDatasetArea(e,r.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,n){const s=t.listeners[n],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(i-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,n)=>{if(!i.running||!i.items.length)return;const s=i.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(n.draw(),this._notify(n,i,e,"progress")),s.length||(i.running=!1,this._notify(n,i,e,"complete"),i.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,n)=>Math.max(i,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const i=color(r||transparent),n=i.valid&&color(e||transparent);return n&&n.valid?n.mix(i,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class Animation{constructor(e,t,i,n){const s=t[i];n=resolve([e.to,n,s,e.from]);const o=resolve([e.from,s,n]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof o],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=o,this._to=n,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const n=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=resolve([e.to,t,n,e.from]),this._from=resolve([e.from,n,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,n=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||t<i),!this._active){this._target[n]=a,this._notify(!0);return}if(t<0){this._target[n]=s;return}l=t/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[n]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let n=0;n<i.length;n++)i[n][t]()}}class Animations{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!isObject(e))return;const t=Object.keys(defaults.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const s=e[n];if(!isObject(s))return;const o={};for(const a of t)o[a]=s[a];(isArray(s.properties)&&s.properties||[n]).forEach(a=>{(a===n||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,t){const i=t.options,n=resolveTargetOptions(e,i);if(!n)return[];const s=this._createAnimations(n,i);return i.$shared&&awaitAll(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,t){const i=this._properties,n=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const h=o[l];if(h.charAt(0)==="$")continue;if(h==="options"){n.push(...this._animateOptions(e,t));continue}const u=t[h];let g=s[h];const m=i.get(h);if(g)if(m&&g.active()){g.update(m,u,a);continue}else g.cancel();if(!m||!m.duration){e[h]=u;continue}s[h]=g=new Animation(m,e,h,u),n.push(g)}return n}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return animator.add(this._chart,i),!0}}function awaitAll(r,e){const t=[],i=Object.keys(e);for(let n=0;n<i.length;n++){const s=r[i[n]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function resolveTargetOptions(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function scaleClip(r,e){const t=r&&r.options||{},i=t.reverse,n=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:i?s:n,end:i?n:s}}function defaultClip(r,e,t){if(t===!1)return!1;const i=scaleClip(r,t),n=scaleClip(e,t);return{top:n.end,right:i.end,bottom:n.start,left:i.start}}function toClip(r){let e,t,i,n;return isObject(r)?(e=r.top,t=r.right,i=r.bottom,n=r.left):e=t=i=n=r,{top:e,right:t,bottom:i,left:n,disabled:r===!1}}function getSortedDatasetIndices(r,e){const t=[],i=r._getSortedDatasetMetas(e);let n,s;for(n=0,s=i.length;n<s;++n)t.push(i[n].index);return t}function applyStack(r,e,t,i={}){const n=r.keys,s=i.mode==="single";let o,a,l,h;if(e===null)return;let u=!1;for(o=0,a=n.length;o<a;++o){if(l=+n[o],l===t){if(u=!0,i.all)continue;break}h=r.values[l],isNumberFinite(h)&&(s||e===0||sign(e)===sign(h))&&(e+=h)}return!u&&!i.all?0:e}function convertObjectDataToArray(r,e){const{iScale:t,vScale:i}=e,n=t.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(r),a=new Array(o.length);let l,h,u;for(l=0,h=o.length;l<h;++l)u=o[l],a[l]={[n]:u,[s]:r[u]};return a}function isStacked(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function getStackKey(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function getUserBounds(r){const{min:e,max:t,minDefined:i,maxDefined:n}=r.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:n?t:Number.POSITIVE_INFINITY}}function getOrCreateStack(r,e,t){const i=r[e]||(r[e]={});return i[t]||(i[t]={})}function getLastIndexInStack(r,e,t,i){for(const n of e.getMatchingVisibleMetas(i).reverse()){const s=r[n.index];if(t&&s>0||!t&&s<0)return n.index}return null}function updateStacks(r,e){const{chart:t,_cachedMeta:i}=r,n=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=i,l=s.axis,h=o.axis,u=getStackKey(s,o,i),g=e.length;let m;for(let _=0;_<g;++_){const b=e[_],{[l]:d,[h]:c}=b,f=b._stacks||(b._stacks={});m=f[h]=getOrCreateStack(n,u,d),m[a]=c,m._top=getLastIndexInStack(m,o,!0,i.type),m._bottom=getLastIndexInStack(m,o,!1,i.type);const v=m._visualValues||(m._visualValues={});v[a]=c}}function getFirstScaleId(r,e){const t=r.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function createDatasetContext(r,e){return createContext(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function createDataContext(r,e,t){return createContext(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function clearStacks(r,e){const t=r.controller.index,i=r.vScale&&r.vScale.axis;if(i){e=e||r._parsed;for(const n of e){const s=n._stacks;if(!s||s[i]===void 0||s[i][t]===void 0)return;delete s[i][t],s[i]._visualValues!==void 0&&s[i]._visualValues[t]!==void 0&&delete s[i]._visualValues[t]}}}const isDirectUpdateMode=r=>r==="reset"||r==="none",cloneIfNotShared=(r,e)=>e?r:Object.assign({},r),createStack=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:getSortedDatasetIndices(t,!0),values:null};class DatasetController{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),n=(g,m,_,b)=>g==="x"?m:g==="r"?b:_,s=t.xAxisID=valueOrDefault(i.xAxisID,getFirstScaleId(e,"x")),o=t.yAxisID=valueOrDefault(i.yAxisID,getFirstScaleId(e,"y")),a=t.rAxisID=valueOrDefault(i.rAxisID,getFirstScaleId(e,"r")),l=t.indexAxis,h=t.iAxisID=n(l,s,o,a),u=t.vAxisID=n(l,o,s,a);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(h),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(isObject(t)){const n=this._cachedMeta;this._data=convertObjectDataToArray(t,n)}else if(i!==t){if(i){unlistenArrayEvents(i,this);const n=this._cachedMeta;clearStacks(n),n._parsed=[]}t&&Object.isExtensible(t)&&listenArrayEvents(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const s=t._stacked;t._stacked=isStacked(t.vScale,t),t.stack!==i.stack&&(n=!0,clearStacks(t),t.stack=i.stack),this._resyncElements(e),(n||s!==t._stacked)&&(updateStacks(this,t._parsed),t._stacked=isStacked(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:n}=this,{iScale:s,_stacked:o}=i,a=s.axis;let l=e===0&&t===n.length?!0:i._sorted,h=e>0&&i._parsed[e-1],u,g,m;if(this._parsing===!1)i._parsed=n,i._sorted=!0,m=n;else{isArray(n[e])?m=this.parseArrayData(i,n,e,t):isObject(n[e])?m=this.parseObjectData(i,n,e,t):m=this.parsePrimitiveData(i,n,e,t);const _=()=>g[a]===null||h&&g[a]<h[a];for(u=0;u<t;++u)i._parsed[u+e]=g=m[u],l&&(_()&&(l=!1),h=g);i._sorted=l}o&&updateStacks(this,m)}parsePrimitiveData(e,t,i,n){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,h=s.getLabels(),u=s===o,g=new Array(n);let m,_,b;for(m=0,_=n;m<_;++m)b=m+i,g[m]={[a]:u||s.parse(h[b],b),[l]:o.parse(t[b],b)};return g}parseArrayData(e,t,i,n){const{xScale:s,yScale:o}=e,a=new Array(n);let l,h,u,g;for(l=0,h=n;l<h;++l)u=l+i,g=t[u],a[l]={x:s.parse(g[0],u),y:o.parse(g[1],u)};return a}parseObjectData(e,t,i,n){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,h=new Array(n);let u,g,m,_;for(u=0,g=n;u<g;++u)m=u+i,_=t[m],h[u]={x:s.parse(resolveObjectKey(_,a),m),y:o.parse(resolveObjectKey(_,l),m)};return h}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const n=this.chart,s=this._cachedMeta,o=t[e.axis],a={keys:getSortedDatasetIndices(n,!0),values:t._stacks[e.axis]._visualValues};return applyStack(a,o,s.index,{mode:i})}updateRangeFromParsed(e,t,i,n){const s=i[t.axis];let o=s===null?NaN:s;const a=n&&i._stacks[t.axis];n&&a&&(n.values=a,o=applyStack(n,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const i=this._cachedMeta,n=i._parsed,s=i._sorted&&e===i.iScale,o=n.length,a=this._getOtherScale(e),l=createStack(t,i,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:g}=getUserBounds(a);let m,_;function b(){_=n[m];const d=_[a.axis];return!isNumberFinite(_[e.axis])||u>d||g<d}for(m=0;m<o&&!(!b()&&(this.updateRangeFromParsed(h,e,_,l),s));++m);if(s){for(m=o-1;m>=0;--m)if(!b()){this.updateRangeFromParsed(h,e,_,l);break}}return h}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let n,s,o;for(n=0,s=t.length;n<s;++n)o=t[n][e.axis],isNumberFinite(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,n=t.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:n?""+n.getLabelForValue(s[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=toClip(valueOrDefault(this.options.clip,defaultClip(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,n=i.data||[],s=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||n.length-a,h=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const g=n[u];g.hidden||(g.active&&h?o.push(g):g.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const n=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=createDataContext(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=n.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),s.dataset=n,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const n=t==="active",s=this._cachedDataOpts,o=e+"-"+t,a=s[o],l=this.enableOptionSharing&&defined(i);if(a)return cloneIfNotShared(a,l);const h=this.chart.config,u=h.datasetElementScopeKeys(this._type,e),g=n?[`${e}Hover`,"hover",e,""]:[e,""],m=h.getOptionScopes(this.getDataset(),u),_=Object.keys(defaults.elements[e]),b=()=>this.getContext(i,n,t),d=h.resolveNamedOptions(m,_,b,g);return d.$shared&&(d.$shared=l,s[o]=Object.freeze(cloneIfNotShared(d,l))),d}_resolveAnimations(e,t,i){const n=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,a=s[o];if(a)return a;let l;if(n.options.animation!==!1){const u=this.chart.config,g=u.datasetAnimationScopeKeys(this._type,t),m=u.getOptionScopes(this.getDataset(),g);l=u.createResolver(m,this.getContext(e,i,t))}const h=new Animations(n,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(h)),h}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),n=this._sharedOptions,s=this.getSharedOptions(i),o=this.includeOptions(t,s)||s!==n;return this.updateSharedOptions(s,t,i),{sharedOptions:s,includeOptions:o}}updateElement(e,t,i,n){isDirectUpdateMode(n)?Object.assign(e,i):this._resolveAnimations(t,n).update(e,i)}updateSharedOptions(e,t,i){e&&!isDirectUpdateMode(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,n){e.active=n;const s=this.getStyle(t,n);this._resolveAnimations(t,i,n).update(e,{options:!n&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[a,l,h]of this._syncList)this[a](l,h);this._syncList=[];const n=i.length,s=t.length,o=Math.min(s,n);o&&this.parse(0,o),s>n?this._insertElements(n,s-n,e):s<n&&this._removeElements(s,n-s)}_insertElements(e,t,i=!0){const n=this._cachedMeta,s=n.data,o=e+t;let a;const l=h=>{for(h.length+=t,a=h.length-1;a>=o;a--)h[a]=h[a-t]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(n._parsed),this.parse(e,t),i&&this.updateElements(s,e,t,"reset")}updateElements(e,t,i,n){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const n=i._parsed.splice(e,t);i._stacked&&clearStacks(i,n)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,n]=e;this[t](i,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}$e(DatasetController,"defaults",{}),$e(DatasetController,"datasetElementType",null),$e(DatasetController,"dataElementType",null);function getAllScaleValues(r,e){if(!r._cache.$bar){const t=r.getMatchingVisibleMetas(e);let i=[];for(let n=0,s=t.length;n<s;n++)i=i.concat(t[n].controller.getAllParsedValues(r));r._cache.$bar=_arrayUnique(i.sort((n,s)=>n-s))}return r._cache.$bar}function computeMinSampleSize(r){const e=r.iScale,t=getAllScaleValues(e,r.type);let i=e._length,n,s,o,a;const l=()=>{o===32767||o===-32768||(defined(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(n=0,s=t.length;n<s;++n)o=e.getPixelForValue(t[n]),l();for(a=void 0,n=0,s=e.ticks.length;n<s;++n)o=e.getPixelForTick(n),l();return i}function computeFitCategoryTraits(r,e,t,i){const n=t.barThickness;let s,o;return isNullOrUndef(n)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=n*i,o=1),{chunk:s/i,ratio:o,start:e.pixels[r]-s/2}}function computeFlexCategoryTraits(r,e,t,i){const n=e.pixels,s=n[r];let o=r>0?n[r-1]:null,a=r<n.length-1?n[r+1]:null;const l=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const h=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:t.barPercentage,start:h}}function parseFloatBar(r,e,t,i){const n=t.parse(r[0],i),s=t.parse(r[1],i),o=Math.min(n,s),a=Math.max(n,s);let l=o,h=a;Math.abs(o)>Math.abs(a)&&(l=a,h=o),e[t.axis]=h,e._custom={barStart:l,barEnd:h,start:n,end:s,min:o,max:a}}function parseValue(r,e,t,i){return isArray(r)?parseFloatBar(r,e,t,i):e[t.axis]=t.parse(r,i),e}function parseArrayOrPrimitive(r,e,t,i){const n=r.iScale,s=r.vScale,o=n.getLabels(),a=n===s,l=[];let h,u,g,m;for(h=t,u=t+i;h<u;++h)m=e[h],g={},g[n.axis]=a||n.parse(o[h],h),l.push(parseValue(m,g,s,h));return l}function isFloatBar(r){return r&&r.barStart!==void 0&&r.barEnd!==void 0}function barSign(r,e,t){return r!==0?sign(r):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function borderProps(r){let e,t,i,n,s;return r.horizontal?(e=r.base>r.x,t="left",i="right"):(e=r.base<r.y,t="bottom",i="top"),e?(n="end",s="start"):(n="start",s="end"),{start:t,end:i,reverse:e,top:n,bottom:s}}function setBorderSkipped(r,e,t,i){let n=e.borderSkipped;const s={};if(!n){r.borderSkipped=s;return}if(n===!0){r.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:h,bottom:u}=borderProps(r);n==="middle"&&t&&(r.enableBorderRadius=!0,(t._top||0)===i?n=h:(t._bottom||0)===i?n=u:(s[parseEdge(u,o,a,l)]=!0,n=h)),s[parseEdge(n,o,a,l)]=!0,r.borderSkipped=s}function parseEdge(r,e,t,i){return i?(r=swap(r,e,t),r=startEnd(r,t,e)):r=startEnd(r,e,t),r}function swap(r,e,t){return r===e?t:r===t?e:r}function startEnd(r,e,t){return r==="start"?e:r==="end"?t:r}function setInflateAmount(r,{inflateAmount:e},t){r.inflateAmount=e==="auto"?t===1?.33:0:e}class BarController extends DatasetController{parsePrimitiveData(e,t,i,n){return parseArrayOrPrimitive(e,t,i,n)}parseArrayData(e,t,i,n){return parseArrayOrPrimitive(e,t,i,n)}parseObjectData(e,t,i,n){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,h=s.axis==="x"?a:l,u=o.axis==="x"?a:l,g=[];let m,_,b,d;for(m=i,_=i+n;m<_;++m)d=t[m],b={},b[s.axis]=s.parse(resolveObjectKey(d,h),m),g.push(parseValue(resolveObjectKey(d,u),b,o,m));return g}updateRangeFromParsed(e,t,i,n){super.updateRangeFromParsed(e,t,i,n);const s=i._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:n}=t,s=this.getParsed(e),o=s._custom,a=isFloatBar(o)?"["+o.start+", "+o.end+"]":""+n.getLabelForValue(s[n.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,n){const s=n==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),h=a.isHorizontal(),u=this._getRuler(),{sharedOptions:g,includeOptions:m}=this._getSharedOptions(t,n);for(let _=t;_<t+i;_++){const b=this.getParsed(_),d=s||isNullOrUndef(b[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(_),c=this._calculateBarIndexPixels(_,u),f=(b._stacks||{})[a.axis],v={horizontal:h,base:d.base,enableBorderRadius:!f||isFloatBar(b._custom)||o===f._top||o===f._bottom,x:h?d.head:c.center,y:h?c.center:d.head,height:h?c.size:Math.abs(d.size),width:h?Math.abs(d.size):c.size};m&&(v.options=g||this.resolveDataElementOptions(_,e[_].active?"active":n));const y=v.options||e[_].options;setBorderSkipped(v,y,f,o),setInflateAmount(v,y,u.ratio),this.updateElement(e[_],_,v,n)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,n=i.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),l=a&&a[i.axis],h=u=>{const g=u._parsed.find(_=>_[i.axis]===l),m=g&&g[u.vScale.axis];if(isNullOrUndef(m)||isNaN(m))return!0};for(const u of n)if(!(t!==void 0&&h(u))&&((s===!1||o.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const n=this._getStacks(e,i),s=t!==void 0?n.indexOf(t):-1;return s===-1?n.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,n=[];let s,o;for(s=0,o=t.data.length;s<o;++s)n.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const a=e.barThickness;return{min:a||computeMinSampleSize(t),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:n},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),h=l._custom,u=isFloatBar(h);let g=l[t.axis],m=0,_=i?this.applyStack(t,l,i):g,b,d;_!==g&&(m=_-g,_=g),u&&(g=h.barStart,_=h.barEnd-h.barStart,g!==0&&sign(g)!==sign(h.barEnd)&&(m=0),m+=g);const c=!isNullOrUndef(s)&&!u?s:m;let f=t.getPixelForValue(c);if(this.chart.getDataVisibility(e)?b=t.getPixelForValue(m+_):b=f,d=b-f,Math.abs(d)<o){d=barSign(d,t,a)*o,g===a&&(f-=d/2);const v=t.getPixelForDecimal(0),y=t.getPixelForDecimal(1),D=Math.min(v,y),E=Math.max(v,y);f=Math.max(Math.min(f,E),D),b=f+d,i&&!u&&(l._stacks[t.axis]._visualValues[n]=t.getValueForPixel(b)-t.getValueForPixel(f))}if(f===t.getPixelForValue(a)){const v=sign(d)*t.getLineWidthForValue(a)/2;f+=v,d-=v}return{size:d,base:f,head:b,center:b+d/2}}_calculateBarIndexPixels(e,t){const i=t.scale,n=this.options,s=n.skipNull,o=valueOrDefault(n.maxBarThickness,1/0);let a,l;if(t.grouped){const h=s?this._getStackCount(e):t.stackCount,u=n.barThickness==="flex"?computeFlexCategoryTraits(e,t,n,h):computeFitCategoryTraits(e,t,n,h),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=u.start+u.chunk*g+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=i.getPixelForValue(this.getParsed(e)[i.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,n=i.length;let s=0;for(;s<n;++s)this.getParsed(s)[t.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}$e(BarController,"id","bar"),$e(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),$e(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class BubbleController extends DatasetController{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,n){const s=super.parsePrimitiveData(e,t,i,n);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+i).radius;return s}parseArrayData(e,t,i,n){const s=super.parseArrayData(e,t,i,n);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=valueOrDefault(a[2],this.resolveDataElementOptions(o+i).radius)}return s}parseObjectData(e,t,i,n){const s=super.parseObjectData(e,t,i,n);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=valueOrDefault(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:s}=t,o=this.getParsed(e),a=n.getLabelForValue(o.x),l=s.getLabelForValue(o.y),h=o._custom;return{label:i[e]||"",value:"("+a+", "+l+(h?", "+h:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,i,n){const s=n==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:h}=this._getSharedOptions(t,n),u=o.axis,g=a.axis;for(let m=t;m<t+i;m++){const _=e[m],b=!s&&this.getParsed(m),d={},c=d[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(b[u]),f=d[g]=s?a.getBasePixel():a.getPixelForValue(b[g]);d.skip=isNaN(c)||isNaN(f),h&&(d.options=l||this.resolveDataElementOptions(m,_.active?"active":n),s&&(d.options.radius=0)),this.updateElement(_,m,d,n)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const s=n.radius;return t!=="active"&&(n.radius=0),n.radius+=valueOrDefault(i&&i._custom,s),n}}$e(BubbleController,"id","bubble"),$e(BubbleController,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),$e(BubbleController,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function getRatioAndOffset(r,e,t){let i=1,n=1,s=0,o=0;if(e<TAU){const a=r,l=a+e,h=Math.cos(a),u=Math.sin(a),g=Math.cos(l),m=Math.sin(l),_=(y,D,E)=>_angleBetween(y,a,l,!0)?1:Math.max(D,D*t,E,E*t),b=(y,D,E)=>_angleBetween(y,a,l,!0)?-1:Math.min(D,D*t,E,E*t),d=_(0,h,g),c=_(HALF_PI,u,m),f=b(PI,h,g),v=b(PI+HALF_PI,u,m);i=(d-f)/2,n=(c-v)/2,s=-(d+f)/2,o=-(c+v)/2}return{ratioX:i,ratioY:n,offsetX:s,offsetY:o}}class DoughnutController extends DatasetController{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=i;else{let s=l=>+i[l];if(isObject(i[e])){const{key:l="value"}=this._parsing;s=h=>+resolveObjectKey(i[h],l)}let o,a;for(o=e,a=e+t;o<a;++o)n._parsed[o]=s(o)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let e=TAU,t=-TAU;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const n=this.chart.getDatasetMeta(i).controller,s=n._getRotation(),o=n._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,n=this._cachedMeta,s=n.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),l=Math.min(toPercentage(this.options.cutout,a),1),h=this._getRingWeight(this.index),{circumference:u,rotation:g}=this._getRotationExtents(),{ratioX:m,ratioY:_,offsetX:b,offsetY:d}=getRatioAndOffset(g,u,l),c=(i.width-o)/m,f=(i.height-o)/_,v=Math.max(Math.min(c,f)/2,0),y=toDimension(this.options.radius,v),D=Math.max(y*l,0),E=(y-D)/this._getVisibleDatasetWeightTotal();this.offsetX=b*y,this.offsetY=d*y,n.total=this.calculateTotal(),this.outerRadius=y-E*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-E*h,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const i=this.options,n=this._cachedMeta,s=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||n._parsed[e]===null||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*s/TAU)}updateElements(e,t,i,n){const s=n==="reset",o=this.chart,a=o.chartArea,h=o.options.animation,u=(a.left+a.right)/2,g=(a.top+a.bottom)/2,m=s&&h.animateScale,_=m?0:this.innerRadius,b=m?0:this.outerRadius,{sharedOptions:d,includeOptions:c}=this._getSharedOptions(t,n);let f=this._getRotation(),v;for(v=0;v<t;++v)f+=this._circumference(v,s);for(v=t;v<t+i;++v){const y=this._circumference(v,s),D=e[v],E={x:u+this.offsetX,y:g+this.offsetY,startAngle:f,endAngle:f+y,circumference:y,outerRadius:b,innerRadius:_};c&&(E.options=d||this.resolveDataElementOptions(v,D.active?"active":n)),f+=y,this.updateElement(D,v,E,n)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,n;for(n=0;n<t.length;n++){const s=e._parsed[n];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(n)&&!t[n].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?TAU*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],s=formatNumber(t._parsed[e],i.options.locale);return{label:n[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const i=this.chart;let n,s,o,a,l;if(!e){for(n=0,s=i.data.datasets.length;n<s;++n)if(i.isDatasetVisible(n)){o=i.getDatasetMeta(n),e=o.data,a=o.controller;break}}if(!e)return 0;for(n=0,s=e.length;n<s;++n)l=a.resolveDataElementOptions(n),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,n=e.length;i<n;++i){const s=this.resolveDataElementOptions(i);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(valueOrDefault(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}$e(DoughnutController,"id","doughnut"),$e(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),$e(DoughnutController,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),$e(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:n}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}});class LineController extends DatasetController{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:n=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:a,count:l}=_getStartAndCountOfVisiblePoints(t,n,o);this._drawStart=a,this._drawCount=l,_scaleRangesChanged(t)&&(a=0,l=n.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=n;const h=this.resolveDatasetElementOptions(e);this.options.showLine||(h.borderWidth=0),h.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:h},e),this.updateElements(n,a,l,e)}updateElements(e,t,i,n){const s=n==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:h}=this._cachedMeta,{sharedOptions:u,includeOptions:g}=this._getSharedOptions(t,n),m=o.axis,_=a.axis,{spanGaps:b,segment:d}=this.options,c=isNumber(b)?b:Number.POSITIVE_INFINITY,f=this.chart._animationsDisabled||s||n==="none",v=t+i,y=e.length;let D=t>0&&this.getParsed(t-1);for(let E=0;E<y;++E){const p=e[E],x=f?p:{};if(E<t||E>=v){x.skip=!0;continue}const w=this.getParsed(E),C=isNullOrUndef(w[_]),S=x[m]=o.getPixelForValue(w[m],E),A=x[_]=s||C?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,w,l):w[_],E);x.skip=isNaN(S)||isNaN(A)||C,x.stop=E>0&&Math.abs(w[m]-D[m])>c,d&&(x.parsed=w,x.raw=h.data[E]),g&&(x.options=u||this.resolveDataElementOptions(E,p.active?"active":n)),f||this.updateElement(p,E,x,n),D=w}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return i;const s=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}$e(LineController,"id","line"),$e(LineController,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),$e(LineController,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class PolarAreaController extends DatasetController{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],s=formatNumber(t._parsed[e].r,i.options.locale);return{label:n[e]||"",value:s}}parseObjectData(e,t,i,n){return _parseObjectDataRadialScale.bind(this)(e,t,i,n)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,n)=>{const s=this.getParsed(n).r;!isNaN(s)&&this.chart.getDataVisibility(n)&&(s<t.min&&(t.min=s),s>t.max&&(t.max=s))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,n=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(n/2,0),o=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,i,n){const s=n==="reset",o=this.chart,l=o.options.animation,h=this._cachedMeta.rScale,u=h.xCenter,g=h.yCenter,m=h.getIndexAngle(0)-.5*PI;let _=m,b;const d=360/this.countVisibleElements();for(b=0;b<t;++b)_+=this._computeAngle(b,n,d);for(b=t;b<t+i;b++){const c=e[b];let f=_,v=_+this._computeAngle(b,n,d),y=o.getDataVisibility(b)?h.getDistanceFromCenterForValue(this.getParsed(b).r):0;_=v,s&&(l.animateScale&&(y=0),l.animateRotate&&(f=v=m));const D={x:u,y:g,innerRadius:0,outerRadius:y,startAngle:f,endAngle:v,options:this.resolveDataElementOptions(b,c.active?"active":n)};this.updateElement(c,b,D,n)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((i,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++}),t}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?toRadians(this.resolveDataElementOptions(e,t).angle||i):0}}$e(PolarAreaController,"id","polarArea"),$e(PolarAreaController,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),$e(PolarAreaController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:n}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class PieController extends DoughnutController{}$e(PieController,"id","pie"),$e(PieController,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class RadarController extends DatasetController{getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,n){return _parseObjectDataRadialScale.bind(this)(e,t,i,n)}update(e){const t=this._cachedMeta,i=t.dataset,n=t.data||[],s=t.iScale.getLabels();if(i.points=n,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===n.length,options:o};this.updateElement(i,void 0,a,e)}this.updateElements(n,0,n.length,e)}updateElements(e,t,i,n){const s=this._cachedMeta.rScale,o=n==="reset";for(let a=t;a<t+i;a++){const l=e[a],h=this.resolveDataElementOptions(a,l.active?"active":n),u=s.getPointPositionForValue(a,this.getParsed(a).r),g=o?s.xCenter:u.x,m=o?s.yCenter:u.y,_={x:g,y:m,angle:u.angle,skip:isNaN(g)||isNaN(m),options:h};this.updateElement(l,a,_,n)}}}$e(RadarController,"id","radar"),$e(RadarController,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),$e(RadarController,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class ScatterController extends DatasetController{getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:s}=t,o=this.getParsed(e),a=n.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:i[e]||"",value:"("+a+", "+l+")"}}update(e){const t=this._cachedMeta,{data:i=[]}=t,n=this.chart._animationsDisabled;let{start:s,count:o}=_getStartAndCountOfVisiblePoints(t,i,n);if(this._drawStart=s,this._drawCount=o,_scaleRangesChanged(t)&&(s=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=i;const h=this.resolveDatasetElementOptions(e);h.segment=this.options.segment,this.updateElement(a,void 0,{animated:!n,options:h},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(i,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,i,n){const s=n==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:h}=this._cachedMeta,u=this.resolveDataElementOptions(t,n),g=this.getSharedOptions(u),m=this.includeOptions(n,g),_=o.axis,b=a.axis,{spanGaps:d,segment:c}=this.options,f=isNumber(d)?d:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||s||n==="none";let y=t>0&&this.getParsed(t-1);for(let D=t;D<t+i;++D){const E=e[D],p=this.getParsed(D),x=v?E:{},w=isNullOrUndef(p[b]),C=x[_]=o.getPixelForValue(p[_],D),S=x[b]=s||w?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,p,l):p[b],D);x.skip=isNaN(C)||isNaN(S)||w,x.stop=D>0&&Math.abs(p[_]-y[_])>f,c&&(x.parsed=p,x.raw=h.data[D]),m&&(x.options=g||this.resolveDataElementOptions(D,E.active?"active":n)),v||this.updateElement(E,D,x,n),y=p}this.updateSharedOptions(g,n,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let a=0;for(let l=t.length-1;l>=0;--l)a=Math.max(a,t[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const i=e.dataset,n=i.options&&i.options.borderWidth||0;if(!t.length)return n;const s=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(n,s,o)/2}}$e(ScatterController,"id","scatter"),$e(ScatterController,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),$e(ScatterController,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var controllers=Object.freeze({__proto__:null,BarController,BubbleController,DoughnutController,LineController,PieController,PolarAreaController,RadarController,ScatterController});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(e){$e(this,"options");this.options=e||{}}static override(e){Object.assign(DateAdapterBase.prototype,e)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(r,e,t,i){const{controller:n,data:s,_sorted:o}=r,a=n._cachedMeta.iScale,l=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const h=a._reversePixels?_rlookupByKey:_lookupByKey;if(i){if(n._sharedOptions){const u=s[0],g=typeof u.getRange=="function"&&u.getRange(e);if(g){const m=h(s,e,t-g),_=h(s,e,t+g);return{lo:m.lo,hi:_.hi}}}}else{const u=h(s,e,t);if(l){const{vScale:g}=n._cachedMeta,{_parsed:m}=r,_=m.slice(0,u.lo+1).reverse().findIndex(d=>!isNullOrUndef(d[g.axis]));u.lo-=Math.max(0,_);const b=m.slice(u.hi).findIndex(d=>!isNullOrUndef(d[g.axis]));u.hi+=Math.max(0,b)}return u}}return{lo:0,hi:s.length-1}}function evaluateInteractionItems(r,e,t,i,n){const s=r.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=s.length;a<l;++a){const{index:h,data:u}=s[a],{lo:g,hi:m}=binarySearch(s[a],e,o,n);for(let _=g;_<=m;++_){const b=u[_];b.skip||i(b,h,_)}}}function getDistanceMetricForAxis(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(i,n){const s=e?Math.abs(i.x-n.x):0,o=t?Math.abs(i.y-n.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function getIntersectItems(r,e,t,i,n){const s=[];return!n&&!r.isPointInArea(e)||evaluateInteractionItems(r,t,e,function(a,l,h){!n&&!_isPointInArea(a,r.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:l,index:h})},!0),s}function getNearestRadialItems(r,e,t,i){let n=[];function s(o,a,l){const{startAngle:h,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:g}=getAngleFromPoint(o,{x:e.x,y:e.y});_angleBetween(g,h,u)&&n.push({element:o,datasetIndex:a,index:l})}return evaluateInteractionItems(r,t,e,s),n}function getNearestCartesianItems(r,e,t,i,n,s){let o=[];const a=getDistanceMetricForAxis(t);let l=Number.POSITIVE_INFINITY;function h(u,g,m){const _=u.inRange(e.x,e.y,n);if(i&&!_)return;const b=u.getCenterPoint(n);if(!(!!s||r.isPointInArea(b))&&!_)return;const c=a(e,b);c<l?(o=[{element:u,datasetIndex:g,index:m}],l=c):c===l&&o.push({element:u,datasetIndex:g,index:m})}return evaluateInteractionItems(r,t,e,h),o}function getNearestItems(r,e,t,i,n,s){return!s&&!r.isPointInArea(e)?[]:t==="r"&&!i?getNearestRadialItems(r,e,t,n):getNearestCartesianItems(r,e,t,i,n,s)}function getAxisItems(r,e,t,i,n){const s=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return evaluateInteractionItems(r,t,e,(l,h,u)=>{l[o]&&l[o](e[t],n)&&(s.push({element:l,datasetIndex:h,index:u}),a=a||l.inRange(e.x,e.y,n))}),i&&!a?[]:s}var Interaction={modes:{index(r,e,t,i){const n=getRelativePosition(e,r),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?getIntersectItems(r,n,s,i,o):getNearestItems(r,n,s,!1,i,o),l=[];return a.length?(r.getSortedVisibleDatasetMetas().forEach(h=>{const u=a[0].index,g=h.data[u];g&&!g.skip&&l.push({element:g,datasetIndex:h.index,index:u})}),l):[]},dataset(r,e,t,i){const n=getRelativePosition(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?getIntersectItems(r,n,s,i,o):getNearestItems(r,n,s,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,h=r.getDatasetMeta(l).data;a=[];for(let u=0;u<h.length;++u)a.push({element:h[u],datasetIndex:l,index:u})}return a},point(r,e,t,i){const n=getRelativePosition(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return getIntersectItems(r,n,s,i,o)},nearest(r,e,t,i){const n=getRelativePosition(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return getNearestItems(r,n,s,t.intersect,i,o)},x(r,e,t,i){const n=getRelativePosition(e,r);return getAxisItems(r,n,"x",t.intersect,i)},y(r,e,t,i){const n=getRelativePosition(e,r);return getAxisItems(r,n,"y",t.intersect,i)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(r,e){return r.filter(t=>t.pos===e)}function filterDynamicPositionByAxis(r,e){return r.filter(t=>STATIC_POSITIONS.indexOf(t.pos)===-1&&t.box.axis===e)}function sortByWeight(r,e){return r.sort((t,i)=>{const n=e?i:t,s=e?t:i;return n.weight===s.weight?n.index-s.index:n.weight-s.weight})}function wrapBoxes(r){const e=[];let t,i,n,s,o,a;for(t=0,i=(r||[]).length;t<i;++t)n=r[t],{position:s,options:{stack:o,stackWeight:a=1}}=n,e.push({index:t,box:n,pos:s,horizontal:n.isHorizontal(),weight:n.weight,stack:o&&s+o,stackWeight:a});return e}function buildStacks(r){const e={};for(const t of r){const{stack:i,pos:n,stackWeight:s}=t;if(!i||!STATIC_POSITIONS.includes(n))continue;const o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function setLayoutDims(r,e){const t=buildStacks(r),{vBoxMaxWidth:i,hBoxMaxHeight:n}=e;let s,o,a;for(s=0,o=r.length;s<o;++s){a=r[s];const{fullSize:l}=a.box,h=t[a.stack],u=h&&a.stackWeight/h.weight;a.horizontal?(a.width=u?u*i:l&&e.availableWidth,a.height=n):(a.width=i,a.height=u?u*n:l&&e.availableHeight)}return t}function buildLayoutBoxes(r){const e=wrapBoxes(r),t=sortByWeight(e.filter(h=>h.box.fullSize),!0),i=sortByWeight(filterByPosition(e,"left"),!0),n=sortByWeight(filterByPosition(e,"right")),s=sortByWeight(filterByPosition(e,"top"),!0),o=sortByWeight(filterByPosition(e,"bottom")),a=filterDynamicPositionByAxis(e,"x"),l=filterDynamicPositionByAxis(e,"y");return{fullSize:t,leftAndTop:i.concat(s),rightAndBottom:n.concat(l).concat(o).concat(a),chartArea:filterByPosition(e,"chartArea"),vertical:i.concat(n).concat(l),horizontal:s.concat(o).concat(a)}}function getCombinedMax(r,e,t,i){return Math.max(r[t],e[t])+Math.max(r[i],e[i])}function updateMaxPadding(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function updateDims(r,e,t,i){const{pos:n,box:s}=t,o=r.maxPadding;if(!isObject(n)){t.size&&(r[n]-=t.size);const g=i[t.stack]||{size:0,count:1};g.size=Math.max(g.size,t.horizontal?s.height:s.width),t.size=g.size/g.count,r[n]+=t.size}s.getPadding&&updateMaxPadding(o,s.getPadding());const a=Math.max(0,e.outerWidth-getCombinedMax(o,r,"left","right")),l=Math.max(0,e.outerHeight-getCombinedMax(o,r,"top","bottom")),h=a!==r.w,u=l!==r.h;return r.w=a,r.h=l,t.horizontal?{same:h,other:u}:{same:u,other:h}}function handleMaxPadding(r){const e=r.maxPadding;function t(i){const n=Math.max(e[i]-r[i],0);return r[i]+=n,n}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function getMargins(r,e){const t=e.maxPadding;function i(n){const s={left:0,top:0,right:0,bottom:0};return n.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return i(r?["left","right"]:["top","bottom"])}function fitBoxes(r,e,t,i){const n=[];let s,o,a,l,h,u;for(s=0,o=r.length,h=0;s<o;++s){a=r[s],l=a.box,l.update(a.width||e.w,a.height||e.h,getMargins(a.horizontal,e));const{same:g,other:m}=updateDims(e,t,a,i);h|=g&&n.length,u=u||m,l.fullSize||n.push(a)}return h&&fitBoxes(n,e,t,i)||u}function setBoxDims(r,e,t,i,n){r.top=t,r.left=e,r.right=e+i,r.bottom=t+n,r.width=i,r.height=n}function placeBoxes(r,e,t,i){const n=t.padding;let{x:s,y:o}=e;for(const a of r){const l=a.box,h=i[a.stack]||{placed:0,weight:1},u=a.stackWeight/h.weight||1;if(a.horizontal){const g=e.w*u,m=h.size||l.height;defined(h.start)&&(o=h.start),l.fullSize?setBoxDims(l,n.left,o,t.outerWidth-n.right-n.left,m):setBoxDims(l,e.left+h.placed,o,g,m),h.start=o,h.placed+=g,o=l.bottom}else{const g=e.h*u,m=h.size||l.width;defined(h.start)&&(s=h.start),l.fullSize?setBoxDims(l,s,n.top,m,t.outerHeight-n.bottom-n.top):setBoxDims(l,s,e.top+h.placed,m,g),h.start=s,h.placed+=g,s=l.right}}e.x=s,e.y=o}var layouts={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,i){if(!r)return;const n=toPadding(r.options.layout.padding),s=Math.max(e-n.width,0),o=Math.max(t-n.height,0),a=buildLayoutBoxes(r.boxes),l=a.vertical,h=a.horizontal;each(r.boxes,d=>{typeof d.beforeLayout=="function"&&d.beforeLayout()});const u=l.reduce((d,c)=>c.box.options&&c.box.options.display===!1?d:d+1,0)||1,g=Object.freeze({outerWidth:e,outerHeight:t,padding:n,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),m=Object.assign({},n);updateMaxPadding(m,toPadding(i));const _=Object.assign({maxPadding:m,w:s,h:o,x:n.left,y:n.top},n),b=setLayoutDims(l.concat(h),g);fitBoxes(a.fullSize,_,g,b),fitBoxes(l,_,g,b),fitBoxes(h,_,g,b)&&fitBoxes(l,_,g,b),handleMaxPadding(_),placeBoxes(a.leftAndTop,_,g,b),_.x+=_.w,_.y+=_.h,placeBoxes(a.rightAndBottom,_,g,b),r.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},each(a.chartArea,d=>{const c=d.box;Object.assign(c,r.chartArea),c.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,n){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):i)}}isAttached(e){return!0}updateConfig(e){}}class BasicPlatform extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=r=>r===null||r==="";function initCanvas(r,e){const t=r.style,i=r.getAttribute("height"),n=r.getAttribute("width");if(r[EXPANDO_KEY]={initial:{height:i,width:n,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",isNullOrEmpty(n)){const s=readUsedSize(r,"width");s!==void 0&&(r.width=s)}if(isNullOrEmpty(i))if(r.style.height==="")r.height=r.width/(e||2);else{const s=readUsedSize(r,"height");s!==void 0&&(r.height=s)}return r}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(r,e,t){r&&r.addEventListener(e,t,eventListenerOptions)}function removeListener(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,eventListenerOptions)}function fromNativeEvent(r,e){const t=EVENT_TYPES[r.type]||r.type,{x:i,y:n}=getRelativePosition(r,e);return{type:t,chart:e,native:r,x:i!==void 0?i:null,y:n!==void 0?n:null}}function nodeListContains(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function createAttachObserver(r,e,t){const i=r.canvas,n=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||nodeListContains(a.addedNodes,i),o=o&&!nodeListContains(a.removedNodes,i);o&&t()});return n.observe(document,{childList:!0,subtree:!0}),n}function createDetachObserver(r,e,t){const i=r.canvas,n=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||nodeListContains(a.removedNodes,i),o=o&&!nodeListContains(a.addedNodes,i);o&&t()});return n.observe(document,{childList:!0,subtree:!0}),n}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const r=window.devicePixelRatio;r!==oldDevicePixelRatio&&(oldDevicePixelRatio=r,drpListeningCharts.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function listenDevicePixelRatioChanges(r,e){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(r,e)}function unlistenDevicePixelRatioChanges(r){drpListeningCharts.delete(r),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(r,e,t){const i=r.canvas,n=i&&_getParentNode(i);if(!n)return;const s=throttled((a,l)=>{const h=n.clientWidth;t(a,l),h<n.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],h=l.contentRect.width,u=l.contentRect.height;h===0&&u===0||s(h,u)});return o.observe(n),listenDevicePixelRatioChanges(r,s),o}function releaseObserver(r,e,t){t&&t.disconnect(),e==="resize"&&unlistenDevicePixelRatioChanges(r)}function createProxyAndListen(r,e,t){const i=r.canvas,n=throttled(s=>{r.ctx!==null&&t(fromNativeEvent(s,r))},r);return addListener(i,e,n),n}class DomPlatform extends BasePlatform{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(initCanvas(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[EXPANDO_KEY])return!1;const i=t[EXPANDO_KEY].initial;["height","width"].forEach(s=>{const o=i[s];isNullOrUndef(o)?t.removeAttribute(s):t.setAttribute(s,o)});const n=i.style||{};return Object.keys(n).forEach(s=>{t.style[s]=n[s]}),t.width=t.width,delete t[EXPANDO_KEY],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),o={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[t]||createProxyAndListen;n[t]=o(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),n=i[t];if(!n)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[t]||removeListener)(e,t,n),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,n){return getMaximumSize(e,t,i,n)}isAttached(e){const t=e&&_getParentNode(e);return!!(t&&t.isConnected)}}function _detectPlatform(r){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){$e(this,"x");$e(this,"y");$e(this,"active",!1);$e(this,"options");$e(this,"$animations")}tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const n={};return e.forEach(s=>{n[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),n}}$e(Element,"defaults",{}),$e(Element,"defaultRoutes");function autoSkip(r,e){const t=r.options.ticks,i=determineMaxTicks(r),n=Math.min(t.maxTicksLimit||i,i),s=t.major.enabled?getMajorIndices(e):[],o=s.length,a=s[0],l=s[o-1],h=[];if(o>n)return skipMajors(e,h,s,o/n),h;const u=calculateSpacing(s,e,n);if(o>0){let g,m;const _=o>1?Math.round((l-a)/(o-1)):null;for(skip(e,h,u,isNullOrUndef(_)?0:a-_,a),g=0,m=o-1;g<m;g++)skip(e,h,u,s[g],s[g+1]);return skip(e,h,u,l,isNullOrUndef(_)?e.length:l+_),h}return skip(e,h,u),h}function determineMaxTicks(r){const e=r.options.offset,t=r._tickSize(),i=r._length/t+(e?0:1),n=r._maxLength/t;return Math.floor(Math.min(i,n))}function calculateSpacing(r,e,t){const i=getEvenSpacing(r),n=e.length/t;if(!i)return Math.max(n,1);const s=_factorize(i);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>n)return l}return Math.max(n,1)}function getMajorIndices(r){const e=[];let t,i;for(t=0,i=r.length;t<i;t++)r[t].major&&e.push(t);return e}function skipMajors(r,e,t,i){let n=0,s=t[0],o;for(i=Math.ceil(i),o=0;o<r.length;o++)o===s&&(e.push(r[o]),n++,s=t[n*i])}function skip(r,e,t,i,n){const s=valueOrDefault(i,0),o=Math.min(valueOrDefault(n,r.length),r.length);let a=0,l,h,u;for(t=Math.ceil(t),n&&(l=n-i,t=l/Math.floor(l/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(h=Math.max(s,0);h<o;h++)h===u&&(e.push(r[h]),a++,u=Math.round(s+a*t))}function getEvenSpacing(r){const e=r.length;let t,i;if(e<2)return!1;for(i=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==i)return!1;return i}const reverseAlign=r=>r==="left"?"right":r==="right"?"left":r,offsetFromEdge=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,getTicksLimit=(r,e)=>Math.min(e||r,r);function sample(r,e){const t=[],i=r.length/e,n=r.length;let s=0;for(;s<n;s+=i)t.push(r[Math.floor(s)]);return t}function getPixelForGridLine(r,e,t){const i=r.ticks.length,n=Math.min(e,i-1),s=r._startPixel,o=r._endPixel,a=1e-6;let l=r.getPixelForTick(n),h;if(!(t&&(i===1?h=Math.max(l-s,o-l):e===0?h=(r.getPixelForTick(1)-l)/2:h=(l-r.getPixelForTick(n-1))/2,l+=n<e?h:-h,l<s-a||l>o+a)))return l}function garbageCollect(r,e){each(r,t=>{const i=t.gc,n=i.length/2;let s;if(n>e){for(s=0;s<n;++s)delete t.data[i[s]];i.splice(0,n)}})}function getTickMarkLength(r){return r.drawTicks?r.tickLength:0}function getTitleHeight(r,e){if(!r.display)return 0;const t=toFont(r.font,e),i=toPadding(r.padding);return(isArray(r.text)?r.text.length:1)*t.lineHeight+i.height}function createScaleContext(r,e){return createContext(r,{scale:e,type:"scale"})}function createTickContext(r,e,t){return createContext(r,{tick:t,index:e,type:"tick"})}function titleAlign(r,e,t){let i=_toLeftRightCenter(r);return(t&&e!=="right"||!t&&e==="right")&&(i=reverseAlign(i)),i}function titleArgs(r,e,t,i){const{top:n,left:s,bottom:o,right:a,chart:l}=r,{chartArea:h,scales:u}=l;let g=0,m,_,b;const d=o-n,c=a-s;if(r.isHorizontal()){if(_=_alignStartEnd(i,s,a),isObject(t)){const f=Object.keys(t)[0],v=t[f];b=u[f].getPixelForValue(v)+d-e}else t==="center"?b=(h.bottom+h.top)/2+d-e:b=offsetFromEdge(r,t,e);m=a-s}else{if(isObject(t)){const f=Object.keys(t)[0],v=t[f];_=u[f].getPixelForValue(v)-c+e}else t==="center"?_=(h.left+h.right)/2-c+e:_=offsetFromEdge(r,t,e);b=_alignStartEnd(i,o,n),g=t==="left"?-HALF_PI:HALF_PI}return{titleX:_,titleY:b,maxWidth:m,rotation:g}}class Scale extends Element{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:n}=this;return e=finiteOrDefault(e,Number.POSITIVE_INFINITY),t=finiteOrDefault(t,Number.NEGATIVE_INFINITY),i=finiteOrDefault(i,Number.POSITIVE_INFINITY),n=finiteOrDefault(n,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(e,i),max:finiteOrDefault(t,n),minDefined:isNumberFinite(e),maxDefined:isNumberFinite(t)}}getMinMax(e){let{min:t,max:i,minDefined:n,maxDefined:s}=this.getUserBounds(),o;if(n&&s)return{min:t,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,h=a.length;l<h;++l)o=a[l].controller.getMinMax(this,e),n||(t=Math.min(t,o.min)),s||(i=Math.max(i,o.max));return t=s&&t>i?i:t,i=n&&t>i?t:i,{min:finiteOrDefault(t,finiteOrDefault(i,t)),max:finiteOrDefault(i,finiteOrDefault(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:n,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,s,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?sample(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),callback(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,n,s;for(i=0,n=e.length;i<n;i++)s=e[i],s.label=callback(t.callback,[s.value,i,e],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=getTicksLimit(this.ticks.length,e.ticks.maxTicksLimit),n=t.minRotation||0,s=t.maxRotation;let o=n,a,l,h;if(!this._isVisible()||!t.display||n>=s||i<=1||!this.isHorizontal()){this.labelRotation=n;return}const u=this._getLabelSizes(),g=u.widest.width,m=u.highest.height,_=_limitValue(this.chart.width-g,0,this.maxWidth);a=e.offset?this.maxWidth/i:_/(i-1),g+6>a&&(a=_/(i-(e.offset?.5:1)),l=this.maxHeight-getTickMarkLength(e.grid)-t.padding-getTitleHeight(e.title,this.chart.options.font),h=Math.sqrt(g*g+m*m),o=toDegrees(Math.min(Math.asin(_limitValue((u.highest.height+6)/a,-1,1)),Math.asin(_limitValue(l/h,-1,1))-Math.asin(_limitValue(m/h,-1,1)))),o=Math.max(n,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:n,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=getTitleHeight(n,t.options.font);if(a?(e.width=this.maxWidth,e.height=getTickMarkLength(s)+l):(e.height=this.maxHeight,e.width=getTickMarkLength(s)+l),i.display&&this.ticks.length){const{first:h,last:u,widest:g,highest:m}=this._getLabelSizes(),_=i.padding*2,b=toRadians(this.labelRotation),d=Math.cos(b),c=Math.sin(b);if(a){const f=i.mirror?0:c*g.width+d*m.height;e.height=Math.min(this.maxHeight,e.height+f+_)}else{const f=i.mirror?0:d*g.width+c*m.height;e.width=Math.min(this.maxWidth,e.width+f+_)}this._calculatePadding(h,u,c,d)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,n){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,h=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,_=0;l?h?(m=n*e.width,_=i*t.height):(m=i*e.height,_=n*t.width):s==="start"?_=t.width:s==="end"?m=e.width:s!=="inner"&&(m=e.width/2,_=t.width/2),this.paddingLeft=Math.max((m-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((_-g+o)*this.width/(this.width-g),0)}else{let u=t.height/2,g=e.height/2;s==="start"?(u=0,g=e.height):s==="end"&&(u=t.height,g=0),this.paddingTop=u+o,this.paddingBottom=g+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)isNullOrUndef(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=sample(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:n,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(t/getTicksLimit(t,i));let h=0,u=0,g,m,_,b,d,c,f,v,y,D,E;for(g=0;g<t;g+=l){if(b=e[g].label,d=this._resolveTickFontOptions(g),n.font=c=d.string,f=s[c]=s[c]||{data:{},gc:[]},v=d.lineHeight,y=D=0,!isNullOrUndef(b)&&!isArray(b))y=_measureText(n,f.data,f.gc,y,b),D=v;else if(isArray(b))for(m=0,_=b.length;m<_;++m)E=b[m],!isNullOrUndef(E)&&!isArray(E)&&(y=_measureText(n,f.data,f.gc,y,E),D+=v);o.push(y),a.push(D),h=Math.max(y,h),u=Math.max(D,u)}garbageCollect(s,t);const p=o.indexOf(h),x=a.indexOf(u),w=C=>({width:o[C]||0,height:a[C]||0});return{first:w(0),last:w(t-1),widest:w(p),highest:w(x),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=createTickContext(this.getContext(),e,i))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=toRadians(this.labelRotation),i=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*i>a*n?a/i:l/n:l*n<a*i?l/i:a/n}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,n=this.options,{grid:s,position:o,border:a}=n,l=s.offset,h=this.isHorizontal(),g=this.ticks.length+(l?1:0),m=getTickMarkLength(s),_=[],b=a.setContext(this.getContext()),d=b.display?b.width:0,c=d/2,f=function(B){return _alignPixel(i,B,d)};let v,y,D,E,p,x,w,C,S,A,P,O;if(o==="top")v=f(this.bottom),x=this.bottom-m,C=v-c,A=f(e.top)+c,O=e.bottom;else if(o==="bottom")v=f(this.top),A=e.top,O=f(e.bottom)-c,x=v+c,C=this.top+m;else if(o==="left")v=f(this.right),p=this.right-m,w=v-c,S=f(e.left)+c,P=e.right;else if(o==="right")v=f(this.left),S=e.left,P=f(e.right)-c,p=v+c,w=this.left+m;else if(t==="x"){if(o==="center")v=f((e.top+e.bottom)/2+.5);else if(isObject(o)){const B=Object.keys(o)[0],k=o[B];v=f(this.chart.scales[B].getPixelForValue(k))}A=e.top,O=e.bottom,x=v+c,C=x+m}else if(t==="y"){if(o==="center")v=f((e.left+e.right)/2);else if(isObject(o)){const B=Object.keys(o)[0],k=o[B];v=f(this.chart.scales[B].getPixelForValue(k))}p=v-c,w=p-m,S=e.left,P=e.right}const F=valueOrDefault(n.ticks.maxTicksLimit,g),I=Math.max(1,Math.ceil(g/F));for(y=0;y<g;y+=I){const B=this.getContext(y),k=s.setContext(B),U=a.setContext(B),W=k.lineWidth,R=k.color,z=U.dash||[],V=U.dashOffset,q=k.tickWidth,Q=k.tickColor,re=k.tickBorderDash||[],te=k.tickBorderDashOffset;D=getPixelForGridLine(this,y,l),D!==void 0&&(E=_alignPixel(i,D,W),h?p=w=S=P=E:x=C=A=O=E,_.push({tx1:p,ty1:x,tx2:w,ty2:C,x1:S,y1:A,x2:P,y2:O,width:W,color:R,borderDash:z,borderDashOffset:V,tickWidth:q,tickColor:Q,tickBorderDash:re,tickBorderDashOffset:te}))}return this._ticksLength=g,this._borderValue=v,_}_computeLabelItems(e){const t=this.axis,i=this.options,{position:n,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:h,padding:u,mirror:g}=s,m=getTickMarkLength(i.grid),_=m+u,b=g?-u:_,d=-toRadians(this.labelRotation),c=[];let f,v,y,D,E,p,x,w,C,S,A,P,O="middle";if(n==="top")p=this.bottom-b,x=this._getXAxisLabelAlignment();else if(n==="bottom")p=this.top+b,x=this._getXAxisLabelAlignment();else if(n==="left"){const I=this._getYAxisLabelAlignment(m);x=I.textAlign,E=I.x}else if(n==="right"){const I=this._getYAxisLabelAlignment(m);x=I.textAlign,E=I.x}else if(t==="x"){if(n==="center")p=(e.top+e.bottom)/2+_;else if(isObject(n)){const I=Object.keys(n)[0],B=n[I];p=this.chart.scales[I].getPixelForValue(B)+_}x=this._getXAxisLabelAlignment()}else if(t==="y"){if(n==="center")E=(e.left+e.right)/2-_;else if(isObject(n)){const I=Object.keys(n)[0],B=n[I];E=this.chart.scales[I].getPixelForValue(B)}x=this._getYAxisLabelAlignment(m).textAlign}t==="y"&&(l==="start"?O="top":l==="end"&&(O="bottom"));const F=this._getLabelSizes();for(f=0,v=a.length;f<v;++f){y=a[f],D=y.label;const I=s.setContext(this.getContext(f));w=this.getPixelForTick(f)+s.labelOffset,C=this._resolveTickFontOptions(f),S=C.lineHeight,A=isArray(D)?D.length:1;const B=A/2,k=I.color,U=I.textStrokeColor,W=I.textStrokeWidth;let R=x;o?(E=w,x==="inner"&&(f===v-1?R=this.options.reverse?"left":"right":f===0?R=this.options.reverse?"right":"left":R="center"),n==="top"?h==="near"||d!==0?P=-A*S+S/2:h==="center"?P=-F.highest.height/2-B*S+S:P=-F.highest.height+S/2:h==="near"||d!==0?P=S/2:h==="center"?P=F.highest.height/2-B*S:P=F.highest.height-A*S,g&&(P*=-1),d!==0&&!I.showLabelBackdrop&&(E+=S/2*Math.sin(d))):(p=w,P=(1-A)*S/2);let z;if(I.showLabelBackdrop){const V=toPadding(I.backdropPadding),q=F.heights[f],Q=F.widths[f];let re=P-V.top,te=0-V.left;switch(O){case"middle":re-=q/2;break;case"bottom":re-=q;break}switch(x){case"center":te-=Q/2;break;case"right":te-=Q;break;case"inner":f===v-1?te-=Q:f>0&&(te-=Q/2);break}z={left:te,top:re,width:Q+V.width,height:q+V.height,color:I.backdropColor}}c.push({label:D,font:C,textOffset:P,options:{rotation:d,color:k,strokeColor:U,strokeWidth:W,textAlign:R,textBaseline:O,translation:[E,p],backdrop:z}})}return c}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-toRadians(this.labelRotation))return e==="top"?"left":"right";let n="center";return t.align==="start"?n="left":t.align==="end"?n="right":t.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:n,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let h,u;return t==="left"?n?(u=this.right+s,i==="near"?h="left":i==="center"?(h="center",u+=l/2):(h="right",u+=l)):(u=this.right-a,i==="near"?h="right":i==="center"?(h="center",u-=l/2):(h="left",u=this.left)):t==="right"?n?(u=this.left+s,i==="near"?h="right":i==="center"?(h="center",u-=l/2):(h="left",u-=l)):(u=this.left+a,i==="near"?h="left":i==="center"?(h="center",u+=l/2):(h="right",u=this.right)):h="right",{textAlign:h,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:n,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,n,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex(s=>s.value===e);return n>=0?t.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,h,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(h.x,h.y),i.stroke(),i.restore())};if(t.display)for(s=0,o=n.length;s<o;++s){const l=n[s];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:n}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=n.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let h,u,g,m;this.isHorizontal()?(h=_alignPixel(e,this.left,o)-o/2,u=_alignPixel(e,this.right,a)+a/2,g=m=l):(g=_alignPixel(e,this.top,o)-o/2,m=_alignPixel(e,this.bottom,a)+a/2,h=u=l),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(h,g),t.lineTo(u,m),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,n=this._computeLabelArea();n&&clipArea(i,n);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,h=o.label,u=o.textOffset;renderText(i,h,0,u,l,a)}n&&unclipArea(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:n}}=this;if(!i.display)return;const s=toFont(i.font),o=toPadding(i.padding),a=i.align;let l=s.lineHeight/2;t==="bottom"||t==="center"||isObject(t)?(l+=o.bottom,isArray(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:h,titleY:u,maxWidth:g,rotation:m}=titleArgs(this,l,t,a);renderText(e,i.text,0,0,s,{color:i.color,maxWidth:g,rotation:m,textAlign:titleAlign(a,t,n),textBaseline:"middle",translation:[h,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=valueOrDefault(e.grid&&e.grid.z,-1),n=valueOrDefault(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let s,o;for(s=0,o=t.length;s<o;++s){const a=t[s];a[i]===this.id&&(!e||a.type===e)&&n.push(a)}return n}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return toFont(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class TypedRegistry{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;isIChartComponent(t)&&(i=this.register(t));const n=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in n||(n[s]=e,registerDefaults(e,o,i),this.override&&defaults.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,n=this.scope;i in t&&delete t[i],n&&i in defaults[n]&&(delete defaults[n][i],this.override&&delete overrides[i])}}function registerDefaults(r,e,t){const i=merge(Object.create(null),[t?defaults.get(t):{},defaults.get(e),r.defaults]);defaults.set(e,i),r.defaultRoutes&&routeDefaults(e,r.defaultRoutes),r.descriptors&&defaults.describe(e,r.descriptors)}function routeDefaults(r,e){Object.keys(e).forEach(t=>{const i=t.split("."),n=i.pop(),s=[r].concat(i).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");defaults.route(s,n,l,a)})}function isIChartComponent(r){return"id"in r&&"defaults"in r}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(n=>{const s=i||this._getRegistryForType(n);i||s.isForType(n)||s===this.plugins&&n.id?this._exec(e,s,n):each(n,o=>{const a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,i){const n=_capitalize(e);callback(i["before"+n],[],i),t[e](i),callback(i["after"+n],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const n=t.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return n}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(e,t,i,n){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=n?this._descriptors(e).filter(n):this._descriptors(e),o=this._notify(s,e,t,i);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,i,n){n=n||{};for(const s of e){const o=s.plugin,a=o[i],l=[t,n,s.options];if(callback(a,l,o)===!1&&n.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,n=valueOrDefault(i.options&&i.options.plugins,{}),s=allPlugins(i);return n===!1&&!t?[]:createDescriptors(e,s,n,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,n=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(n(t,i),e,"stop"),this._notify(n(i,t),e,"start")}}function allPlugins(r){const e={},t=[],i=Object.keys(registry.plugins.items);for(let s=0;s<i.length;s++)t.push(registry.getPlugin(i[s]));const n=r.plugins||[];for(let s=0;s<n.length;s++){const o=n[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function getOpts(r,e){return!e&&r===!1?null:r===!0?{}:r}function createDescriptors(r,{plugins:e,localIds:t},i,n){const s=[],o=r.getContext();for(const a of e){const l=a.id,h=getOpts(i[l],n);h!==null&&s.push({plugin:a,options:pluginOpts(r.config,{plugin:a,local:t[l]},h,o)})}return s}function pluginOpts(r,{plugin:e,local:t},i,n){const s=r.pluginScopeKeys(e),o=r.getOptionScopes(i,s);return t&&e.defaults&&o.push(e.defaults),r.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(r,e){const t=defaults.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function getAxisFromDefaultScaleID(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function getDefaultScaleIDFromAxis(r,e){return r===e?"_index_":"_value_"}function idMatchesAxis(r){if(r==="x"||r==="y"||r==="r")return r}function axisFromPosition(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function determineAxis(r,...e){if(idMatchesAxis(r))return r;for(const t of e){const i=t.axis||axisFromPosition(t.position)||r.length>1&&idMatchesAxis(r[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function retrieveAxisFromDatasets(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===r||i.yAxisID===r);if(t.length)return getAxisFromDataset(r,"x",t[0])||getAxisFromDataset(r,"y",t[0])}return{}}function mergeScaleConfig(r,e){const t=overrides[r.type]||{scales:{}},i=e.scales||{},n=getIndexAxis(r.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!isObject(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=determineAxis(o,a,retrieveAxisFromDatasets(o,r),defaults.scales[a.type]),h=getDefaultScaleIDFromAxis(l,n),u=t.scales||{};s[o]=mergeIf(Object.create(null),[{axis:l},a,u[l],u[h]])}),r.data.datasets.forEach(o=>{const a=o.type||r.type,l=o.indexAxis||getIndexAxis(a,e),u=(overrides[a]||{}).scales||{};Object.keys(u).forEach(g=>{const m=getAxisFromDefaultScaleID(g,l),_=o[m+"AxisID"]||m;s[_]=s[_]||Object.create(null),mergeIf(s[_],[{axis:m},i[_],u[g]])})}),Object.keys(s).forEach(o=>{const a=s[o];mergeIf(a,[defaults.scales[a.type],defaults.scale])}),s}function initOptions(r){const e=r.options||(r.options={});e.plugins=valueOrDefault(e.plugins,{}),e.scales=mergeScaleConfig(r,e)}function initData(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function initConfig(r){return r=r||{},r.data=initData(r.data),initOptions(r),r}const keyCache=new Map,keysCached=new Set;function cachedKeys(r,e){let t=keyCache.get(r);return t||(t=e(),keyCache.set(r,t),keysCached.add(t)),t}const addIfFound=(r,e,t)=>{const i=resolveObjectKey(e,t);i!==void 0&&r.add(i)};class Config{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return cachedKeys(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return cachedKeys(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return cachedKeys(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let n=i.get(e);return(!n||t)&&(n=new Map,i.set(e,n)),n}getOptionScopes(e,t,i){const{options:n,type:s}=this,o=this._cachedScopes(e,i),a=o.get(t);if(a)return a;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(g=>addIfFound(l,e,g))),u.forEach(g=>addIfFound(l,n,g)),u.forEach(g=>addIfFound(l,overrides[s]||{},g)),u.forEach(g=>addIfFound(l,defaults,g)),u.forEach(g=>addIfFound(l,descriptors,g))});const h=Array.from(l);return h.length===0&&h.push(Object.create(null)),keysCached.has(t)&&o.set(t,h),h}chartOptionScopes(){const{options:e,type:t}=this;return[e,overrides[t]||{},defaults.datasets[t]||{},{type:t},defaults,descriptors]}resolveNamedOptions(e,t,i,n=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=getResolver(this._resolverCache,e,n);let l=o;if(needContext(o,t)){s.$shared=!1,i=isFunction(i)?i():i;const h=this.createResolver(e,i,a);l=_attachContext(o,i,h)}for(const h of t)s[h]=l[h];return s}createResolver(e,t,i=[""],n){const{resolver:s}=getResolver(this._resolverCache,e,i);return isObject(t)?_attachContext(s,t,void 0,n):s}}function getResolver(r,e,t){let i=r.get(e);i||(i=new Map,r.set(e,i));const n=t.join();let s=i.get(n);return s||(s={resolver:_createResolver(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},i.set(n,s)),s}const hasFunction=r=>isObject(r)&&Object.getOwnPropertyNames(r).some(e=>isFunction(r[e]));function needContext(r,e){const{isScriptable:t,isIndexable:i}=_descriptors(r);for(const n of e){const s=t(n),o=i(n),a=(o||s)&&r[n];if(s&&(isFunction(a)||hasFunction(a))||o&&isArray(a))return!0}return!1}var version="4.4.9";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(r,e){return r==="top"||r==="bottom"||KNOWN_POSITIONS.indexOf(r)===-1&&e==="x"}function compare2Level(r,e){return function(t,i){return t[r]===i[r]?t[e]-i[e]:t[r]-i[r]}}function onAnimationsComplete(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),callback(t&&t.onComplete,[r],e)}function onAnimationProgress(r){const e=r.chart,t=e.options.animation;callback(t&&t.onProgress,[r],e)}function getCanvas(r){return _isDomSupported()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const instances={},getChart=r=>{const e=getCanvas(r);return Object.values(instances).filter(t=>t.canvas===e).pop()};function moveNumericKeys(r,e,t){const i=Object.keys(r);for(const n of i){const s=+n;if(s>=e){const o=r[n];delete r[n],(t>0||s>e)&&(r[s+t]=o)}}}function determineLastEvent(r,e,t,i){return!t||r.type==="mouseout"?null:i?e:r}class Chart{static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,t){const i=this.config=new Config(t),n=getCanvas(e),s=getChart(n);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||_detectPlatform(n)),this.platform.updateConfig(i);const a=this.platform.acquireContext(n,o.aspectRatio),l=a&&a.canvas,h=l&&l.height,u=l&&l.width;if(this.id=uid(),this.ctx=a,this.canvas=l,this.width=u,this.height=h,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(g=>this.update(g),o.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:n,_aspectRatio:s}=this;return isNullOrUndef(e)?t&&s?s:n?i/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,t){animator.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,n=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(n,e,t,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,retinaScale(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),callback(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};each(t,(i,n)=>{i.id=n})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,n=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const a=t[o],l=determineAxis(o,a),h=l==="r",u=l==="x";return{options:a,dposition:h?"chartArea":u?"bottom":"left",dtype:h?"radialLinear":u?"category":"linear"}}))),each(s,o=>{const a=o.options,l=a.id,h=determineAxis(l,a),u=valueOrDefault(a.type,o.dtype);(a.position===void 0||positionIsHorizontal(a.position,h)!==positionIsHorizontal(o.dposition))&&(a.position=o.dposition),n[l]=!0;let g=null;if(l in i&&i[l].type===u)g=i[l];else{const m=registry.getScale(u);g=new m({id:l,type:u,ctx:this.ctx,chart:this}),i[g.id]=g}g.init(a,e)}),each(n,(o,a)=>{o||delete i[a]}),each(i,o=>{layouts.configure(this,o,o.options),layouts.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((n,s)=>n.index-s.index),i>t){for(let n=t;n<i;++n)this._destroyDatasetMeta(n);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,n)=>{t.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,n;for(this._removeUnreferencedMetasets(),i=0,n=t.length;i<n;i++){const s=t[i];let o=this.getDatasetMeta(i);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=s.indexAxis||getIndexAxis(a,this.options),o.order=s.order||0,o.index=i,o.label=""+s.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const l=registry.getController(a),{datasetElementType:h,dataElementType:u}=defaults.datasets[a];Object.assign(l,{dataElementType:registry.getElement(u),datasetElementType:h&&registry.getElement(h)}),o.controller=new l(this,i),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let h=0,u=this.data.datasets.length;h<u;h++){const{controller:g}=this.getDatasetMeta(h),m=!n&&s.indexOf(g)===-1;g.buildOrUpdateElements(m),o=Math.max(+g.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),n||each(s,h=>{h.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!setsEqual(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:n,count:s}of t){const o=i==="_removeElements"?-s:s;moveNumericKeys(e,n,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),n=i(0);for(let s=1;s<t;s++)if(!setsEqual(n,i(s)))return;return Array.from(n).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],each(this.boxes,n=>{i&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,s)=>{n._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,isFunction(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),n={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(i.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let n,s;for(n=0,s=t.length;n<s;++n){const o=t[n];(!e||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},n=getDatasetClipArea(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(n&&clipArea(t,n),e.controller.draw(),n&&unclipArea(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,n){const s=Interaction.modes[t];return typeof s=="function"?s(this,e,i,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let n=i.filter(s=>s&&s._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const n=i?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,n);defined(t)?(s.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),o.update(s,{visible:i}),this.update(a=>a.datasetIndex===e?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),animator.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},n=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};each(this.options.events,s=>i(s,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(l,h)=>{t.addEventListener(this,l,h),e[l]=h},n=(l,h)=>{e[l]&&(t.removeEventListener(this,l,h),delete e[l])},s=(l,h)=>{this.canvas&&this.resize(l,h)};let o;const a=()=>{n("attach",a),this.attached=!0,this.resize(),i("resize",s),i("detach",o)};o=()=>{this.attached=!1,n("resize",s),this._stop(),this._resize(0,0),i("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){each(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},each(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const n=i?"set":"remove";let s,o,a,l;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+n+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const h=o&&this.getDatasetMeta(o.datasetIndex).controller;h&&h[n+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!_elementsEqual(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const n=this.options.hover,s=(l,h)=>l.filter(u=>!h.some(g=>u.datasetIndex===g.datasetIndex&&u.index===g.index)),o=s(t,e),a=i?e:s(e,t);o.length&&this.updateHoverStyle(o,n.mode,!1),a.length&&n.mode&&this.updateHoverStyle(a,n.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},n=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,n)===!1)return;const s=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(s||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:n=[],options:s}=this,o=t,a=this._getActiveElements(e,n,i,o),l=_isClickEvent(e),h=determineLastEvent(e,this._lastEvent,i,l);i&&(this._lastEvent=null,callback(s.onHover,[e,a,this],this),l&&callback(s.onClick,[e,a,this],this));const u=!_elementsEqual(a,n);return(u||t)&&(this._active=a,this._updateHoverStyles(a,n,t)),this._lastEvent=h,u}_getActiveElements(e,t,i,n){if(e.type==="mouseout")return[];if(!i)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,n)}}$e(Chart,"defaults",defaults),$e(Chart,"instances",instances),$e(Chart,"overrides",overrides),$e(Chart,"registry",registry),$e(Chart,"version",version),$e(Chart,"getChart",getChart);function invalidatePlugins(){return each(Chart.instances,r=>r._plugins.invalidate())}function clipArc(r,e,t){const{startAngle:i,pixelMargin:n,x:s,y:o,outerRadius:a,innerRadius:l}=e;let h=n/a;r.beginPath(),r.arc(s,o,a,i-h,t+h),l>n?(h=n/l,r.arc(s,o,l,t+h,i-h,!0)):r.arc(s,o,n,t+HALF_PI,i-HALF_PI),r.closePath(),r.clip()}function toRadiusCorners(r){return _readValueToProps(r,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(r,e,t,i){const n=toRadiusCorners(r.options.borderRadius),s=(t-e)/2,o=Math.min(s,i*e/2),a=l=>{const h=(t-Math.min(s,l))*i/2;return _limitValue(l,0,Math.min(s,h))};return{outerStart:a(n.outerStart),outerEnd:a(n.outerEnd),innerStart:_limitValue(n.innerStart,0,o),innerEnd:_limitValue(n.innerEnd,0,o)}}function rThetaToXY(r,e,t,i){return{x:t+r*Math.cos(e),y:i+r*Math.sin(e)}}function pathArc(r,e,t,i,n,s){const{x:o,y:a,startAngle:l,pixelMargin:h,innerRadius:u}=e,g=Math.max(e.outerRadius+i+t-h,0),m=u>0?u+i+t+h:0;let _=0;const b=n-l;if(i){const I=u>0?u-i:0,B=g>0?g-i:0,k=(I+B)/2,U=k!==0?b*k/(k+i):b;_=(b-U)/2}const d=Math.max(.001,b*g-t/PI)/g,c=(b-d)/2,f=l+c+_,v=n-c-_,{outerStart:y,outerEnd:D,innerStart:E,innerEnd:p}=parseBorderRadius$1(e,m,g,v-f),x=g-y,w=g-D,C=f+y/x,S=v-D/w,A=m+E,P=m+p,O=f+E/A,F=v-p/P;if(r.beginPath(),s){const I=(C+S)/2;if(r.arc(o,a,g,C,I),r.arc(o,a,g,I,S),D>0){const W=rThetaToXY(w,S,o,a);r.arc(W.x,W.y,D,S,v+HALF_PI)}const B=rThetaToXY(P,v,o,a);if(r.lineTo(B.x,B.y),p>0){const W=rThetaToXY(P,F,o,a);r.arc(W.x,W.y,p,v+HALF_PI,F+Math.PI)}const k=(v-p/m+(f+E/m))/2;if(r.arc(o,a,m,v-p/m,k,!0),r.arc(o,a,m,k,f+E/m,!0),E>0){const W=rThetaToXY(A,O,o,a);r.arc(W.x,W.y,E,O+Math.PI,f-HALF_PI)}const U=rThetaToXY(x,f,o,a);if(r.lineTo(U.x,U.y),y>0){const W=rThetaToXY(x,C,o,a);r.arc(W.x,W.y,y,f-HALF_PI,C)}}else{r.moveTo(o,a);const I=Math.cos(C)*g+o,B=Math.sin(C)*g+a;r.lineTo(I,B);const k=Math.cos(S)*g+o,U=Math.sin(S)*g+a;r.lineTo(k,U)}r.closePath()}function drawArc(r,e,t,i,n){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){pathArc(r,e,t,i,l,n);for(let h=0;h<s;++h)r.fill();isNaN(a)||(l=o+(a%TAU||TAU))}return pathArc(r,e,t,i,l,n),r.fill(),l}function drawBorder(r,e,t,i,n){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:h,borderJoinStyle:u,borderDash:g,borderDashOffset:m}=l,_=l.borderAlign==="inner";if(!h)return;r.setLineDash(g||[]),r.lineDashOffset=m,_?(r.lineWidth=h*2,r.lineJoin=u||"round"):(r.lineWidth=h,r.lineJoin=u||"bevel");let b=e.endAngle;if(s){pathArc(r,e,t,i,b,n);for(let d=0;d<s;++d)r.stroke();isNaN(a)||(b=o+(a%TAU||TAU))}_&&clipArc(r,e,b),s||(pathArc(r,e,t,i,b,n),r.stroke())}class ArcElement extends Element{constructor(t){super();$e(this,"circumference");$e(this,"endAngle");$e(this,"fullCircles");$e(this,"innerRadius");$e(this,"outerRadius");$e(this,"pixelMargin");$e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,i,n){const s=this.getProps(["x","y"],n),{angle:o,distance:a}=getAngleFromPoint(s,{x:t,y:i}),{startAngle:l,endAngle:h,innerRadius:u,outerRadius:g,circumference:m}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),_=(this.options.spacing+this.options.borderWidth)/2,b=valueOrDefault(m,h-l),d=_angleBetween(o,l,h)&&l!==h,c=b>=TAU||d,f=_isBetween(a,u+_,g+_);return c&&f}getCenterPoint(t){const{x:i,y:n,startAngle:s,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:h,spacing:u}=this.options,g=(s+o)/2,m=(a+l+u+h)/2;return{x:i+Math.cos(g)*m,y:n+Math.sin(g)*m}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:i,circumference:n}=this,s=(i.offset||0)/4,o=(i.spacing||0)/2,a=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=n>TAU?Math.floor(n/TAU):0,n===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*s,Math.sin(l)*s);const h=1-Math.sin(Math.min(PI,n||0)),u=s*h;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,drawArc(t,this,u,o,a),drawBorder(t,this,u,o,a),t.restore()}}$e(ArcElement,"id","arc"),$e(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),$e(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),$e(ArcElement,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function setStyle(r,e,t=e){r.lineCap=valueOrDefault(t.borderCapStyle,e.borderCapStyle),r.setLineDash(valueOrDefault(t.borderDash,e.borderDash)),r.lineDashOffset=valueOrDefault(t.borderDashOffset,e.borderDashOffset),r.lineJoin=valueOrDefault(t.borderJoinStyle,e.borderJoinStyle),r.lineWidth=valueOrDefault(t.borderWidth,e.borderWidth),r.strokeStyle=valueOrDefault(t.borderColor,e.borderColor)}function lineTo(r,e,t){r.lineTo(t.x,t.y)}function getLineMethod(r){return r.stepped?_steppedLineTo:r.tension||r.cubicInterpolationMode==="monotone"?_bezierCurveTo:lineTo}function pathVars(r,e,t={}){const i=r.length,{start:n=0,end:s=i-1}=t,{start:o,end:a}=e,l=Math.max(n,o),h=Math.min(s,a),u=n<o&&s<o||n>a&&s>a;return{count:i,start:l,loop:e.loop,ilen:h<l&&!u?i+h-l:h-l}}function pathSegment(r,e,t,i){const{points:n,options:s}=e,{count:o,start:a,loop:l,ilen:h}=pathVars(n,t,i),u=getLineMethod(s);let{move:g=!0,reverse:m}=i||{},_,b,d;for(_=0;_<=h;++_)b=n[(a+(m?h-_:_))%o],!b.skip&&(g?(r.moveTo(b.x,b.y),g=!1):u(r,d,b,m,s.stepped),d=b);return l&&(b=n[(a+(m?h:0))%o],u(r,d,b,m,s.stepped)),!!l}function fastPathSegment(r,e,t,i){const n=e.points,{count:s,start:o,ilen:a}=pathVars(n,t,i),{move:l=!0,reverse:h}=i||{};let u=0,g=0,m,_,b,d,c,f;const v=D=>(o+(h?a-D:D))%s,y=()=>{d!==c&&(r.lineTo(u,c),r.lineTo(u,d),r.lineTo(u,f))};for(l&&(_=n[v(0)],r.moveTo(_.x,_.y)),m=0;m<=a;++m){if(_=n[v(m)],_.skip)continue;const D=_.x,E=_.y,p=D|0;p===b?(E<d?d=E:E>c&&(c=E),u=(g*u+D)/++g):(y(),r.lineTo(D,E),b=p,g=0,d=c=E),f=E}y()}function _getSegmentMethod(r){const e=r.options,t=e.borderDash&&e.borderDash.length;return!r._decimated&&!r._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?fastPathSegment:pathSegment}function _getInterpolationMethod(r){return r.stepped?_steppedInterpolation:r.tension||r.cubicInterpolationMode==="monotone"?_bezierInterpolation:_pointInLine}function strokePathWithCache(r,e,t,i){let n=e._path;n||(n=e._path=new Path2D,e.path(n,t,i)&&n.closePath()),setStyle(r,e.options),r.stroke(n)}function strokePathDirect(r,e,t,i){const{segments:n,options:s}=e,o=_getSegmentMethod(e);for(const a of n)setStyle(r,s,a.style),r.beginPath(),o(r,e,a,{start:t,end:t+i-1})&&r.closePath(),r.stroke()}const usePath2D=typeof Path2D=="function";function draw(r,e,t,i){usePath2D&&!e.options.segment?strokePathWithCache(r,e,t,i):strokePathDirect(r,e,t,i)}class LineElement extends Element{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const n=i.spanGaps?this._loop:this._fullLoop;_updateBezierControlPoints(this._points,i,e,n,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_computeSegments(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,n=e[t],s=this.points,o=_boundSegments(this,{property:t,start:n,end:n});if(!o.length)return;const a=[],l=_getInterpolationMethod(i);let h,u;for(h=0,u=o.length;h<u;++h){const{start:g,end:m}=o[h],_=s[g],b=s[m];if(_===b){a.push(_);continue}const d=Math.abs((n-_[t])/(b[t]-_[t])),c=l(_,b,d,i.stepped);c[t]=e[t],a.push(c)}return a.length===1?a[0]:a}pathSegment(e,t,i){return _getSegmentMethod(this)(e,this,t,i)}path(e,t,i){const n=this.segments,s=_getSegmentMethod(this);let o=this._loop;t=t||0,i=i||this.points.length-t;for(const a of n)o&=s(e,this,a,{start:t,end:t+i-1});return!!o}draw(e,t,i,n){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),draw(e,this,i,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}$e(LineElement,"id","line"),$e(LineElement,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),$e(LineElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),$e(LineElement,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function inRange$1(r,e,t,i){const n=r.options,{[t]:s}=r.getProps([t],i);return Math.abs(e-s)<n.radius+n.hitRadius}class PointElement extends Element{constructor(t){super();$e(this,"parsed");$e(this,"skip");$e(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,i,n){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],n);return Math.pow(t-o,2)+Math.pow(i-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,i){return inRange$1(this,t,"x",i)}inYRange(t,i){return inRange$1(this,t,"y",i)}getCenterPoint(t){const{x:i,y:n}=this.getProps(["x","y"],t);return{x:i,y:n}}size(t){t=t||this.options||{};let i=t.radius||0;i=Math.max(i,i&&t.hoverRadius||0);const n=i&&t.borderWidth||0;return(i+n)*2}draw(t,i){const n=this.options;this.skip||n.radius<.1||!_isPointInArea(this,i,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,drawPoint(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}$e(PointElement,"id","point"),$e(PointElement,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),$e(PointElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function getBarBounds(r,e){const{x:t,y:i,base:n,width:s,height:o}=r.getProps(["x","y","base","width","height"],e);let a,l,h,u,g;return r.horizontal?(g=o/2,a=Math.min(t,n),l=Math.max(t,n),h=i-g,u=i+g):(g=s/2,a=t-g,l=t+g,h=Math.min(i,n),u=Math.max(i,n)),{left:a,top:h,right:l,bottom:u}}function skipOrLimit(r,e,t,i){return r?0:_limitValue(e,t,i)}function parseBorderWidth(r,e,t){const i=r.options.borderWidth,n=r.borderSkipped,s=toTRBL(i);return{t:skipOrLimit(n.top,s.top,0,t),r:skipOrLimit(n.right,s.right,0,e),b:skipOrLimit(n.bottom,s.bottom,0,t),l:skipOrLimit(n.left,s.left,0,e)}}function parseBorderRadius(r,e,t){const{enableBorderRadius:i}=r.getProps(["enableBorderRadius"]),n=r.options.borderRadius,s=toTRBLCorners(n),o=Math.min(e,t),a=r.borderSkipped,l=i||isObject(n);return{topLeft:skipOrLimit(!l||a.top||a.left,s.topLeft,0,o),topRight:skipOrLimit(!l||a.top||a.right,s.topRight,0,o),bottomLeft:skipOrLimit(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:skipOrLimit(!l||a.bottom||a.right,s.bottomRight,0,o)}}function boundingRects(r){const e=getBarBounds(r),t=e.right-e.left,i=e.bottom-e.top,n=parseBorderWidth(r,t/2,i/2),s=parseBorderRadius(r,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:s},inner:{x:e.left+n.l,y:e.top+n.t,w:t-n.l-n.r,h:i-n.t-n.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,s.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(n.b,n.r))}}}}function inRange(r,e,t,i){const n=e===null,s=t===null,a=r&&!(n&&s)&&getBarBounds(r,i);return a&&(n||_isBetween(e,a.left,a.right))&&(s||_isBetween(t,a.top,a.bottom))}function hasRadius(r){return r.topLeft||r.topRight||r.bottomLeft||r.bottomRight}function addNormalRectPath(r,e){r.rect(e.x,e.y,e.w,e.h)}function inflateRect(r,e,t={}){const i=r.x!==t.x?-e:0,n=r.y!==t.y?-e:0,s=(r.x+r.w!==t.x+t.w?e:0)-i,o=(r.y+r.h!==t.y+t.h?e:0)-n;return{x:r.x+i,y:r.y+n,w:r.w+s,h:r.h+o,radius:r.radius}}class BarElement extends Element{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:n}}=this,{inner:s,outer:o}=boundingRects(this),a=hasRadius(o.radius)?addRoundedRectPath:addNormalRectPath;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,inflateRect(o,t,s)),e.clip(),a(e,inflateRect(s,-t,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),a(e,inflateRect(s,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,i){return inRange(this,e,t,i)}inXRange(e,t){return inRange(this,e,null,t)}inYRange(e,t){return inRange(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:n,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+n)/2:t,y:s?i:(i+n)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}$e(BarElement,"id","bar"),$e(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),$e(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var elements=Object.freeze({__proto__:null,ArcElement,BarElement,LineElement,PointElement});const BORDER_COLORS=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],BACKGROUND_COLORS=BORDER_COLORS.map(r=>r.replace("rgb(","rgba(").replace(")",", 0.5)"));function getBorderColor(r){return BORDER_COLORS[r%BORDER_COLORS.length]}function getBackgroundColor(r){return BACKGROUND_COLORS[r%BACKGROUND_COLORS.length]}function colorizeDefaultDataset(r,e){return r.borderColor=getBorderColor(e),r.backgroundColor=getBackgroundColor(e),++e}function colorizeDoughnutDataset(r,e){return r.backgroundColor=r.data.map(()=>getBorderColor(e++)),e}function colorizePolarAreaDataset(r,e){return r.backgroundColor=r.data.map(()=>getBackgroundColor(e++)),e}function getColorizer(r){let e=0;return(t,i)=>{const n=r.getDatasetMeta(i).controller;n instanceof DoughnutController?e=colorizeDoughnutDataset(t,e):n instanceof PolarAreaController?e=colorizePolarAreaDataset(t,e):n&&(e=colorizeDefaultDataset(t,e))}}function containsColorsDefinitions(r){let e;for(e in r)if(r[e].borderColor||r[e].backgroundColor)return!0;return!1}function containsColorsDefinition(r){return r&&(r.borderColor||r.backgroundColor)}function containsDefaultColorsDefenitions(){return defaults.borderColor!=="rgba(0,0,0,0.1)"||defaults.backgroundColor!=="rgba(0,0,0,0.1)"}var plugin_colors={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(r,e,t){if(!t.enabled)return;const{data:{datasets:i},options:n}=r.config,{elements:s}=n,o=containsColorsDefinitions(i)||containsColorsDefinition(n)||s&&containsColorsDefinitions(s)||containsDefaultColorsDefenitions();if(!t.forceOverride&&o)return;const a=getColorizer(r);i.forEach(a)}};function lttbDecimation(r,e,t,i,n){const s=n.samples||i;if(s>=t)return r.slice(e,e+t);const o=[],a=(t-2)/(s-2);let l=0;const h=e+t-1;let u=e,g,m,_,b,d;for(o[l++]=r[u],g=0;g<s-2;g++){let c=0,f=0,v;const y=Math.floor((g+1)*a)+1+e,D=Math.min(Math.floor((g+2)*a)+1,t)+e,E=D-y;for(v=y;v<D;v++)c+=r[v].x,f+=r[v].y;c/=E,f/=E;const p=Math.floor(g*a)+1+e,x=Math.min(Math.floor((g+1)*a)+1,t)+e,{x:w,y:C}=r[u];for(_=b=-1,v=p;v<x;v++)b=.5*Math.abs((w-c)*(r[v].y-C)-(w-r[v].x)*(f-C)),b>_&&(_=b,m=r[v],d=v);o[l++]=m,u=d}return o[l++]=r[h],o}function minMaxDecimation(r,e,t,i){let n=0,s=0,o,a,l,h,u,g,m,_,b,d;const c=[],f=e+t-1,v=r[e].x,D=r[f].x-v;for(o=e;o<e+t;++o){a=r[o],l=(a.x-v)/D*i,h=a.y;const E=l|0;if(E===u)h<b?(b=h,g=o):h>d&&(d=h,m=o),n=(s*n+a.x)/++s;else{const p=o-1;if(!isNullOrUndef(g)&&!isNullOrUndef(m)){const x=Math.min(g,m),w=Math.max(g,m);x!==_&&x!==p&&c.push({...r[x],x:n}),w!==_&&w!==p&&c.push({...r[w],x:n})}o>0&&p!==_&&c.push(r[p]),c.push(a),u=E,s=0,b=d=h,g=m=_=o}}return c}function cleanDecimatedDataset(r){if(r._decimated){const e=r._data;delete r._decimated,delete r._data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function cleanDecimatedData(r){r.data.datasets.forEach(e=>{cleanDecimatedDataset(e)})}function getStartAndCountOfVisiblePointsSimplified(r,e){const t=e.length;let i=0,n;const{iScale:s}=r,{min:o,max:a,minDefined:l,maxDefined:h}=s.getUserBounds();return l&&(i=_limitValue(_lookupByKey(e,s.axis,o).lo,0,t-1)),h?n=_limitValue(_lookupByKey(e,s.axis,a).hi+1,i,t)-i:n=t-i,{start:i,count:n}}var plugin_decimation={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(r,e,t)=>{if(!t.enabled){cleanDecimatedData(r);return}const i=r.width;r.data.datasets.forEach((n,s)=>{const{_data:o,indexAxis:a}=n,l=r.getDatasetMeta(s),h=o||n.data;if(resolve([a,r.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=r.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||r.options.parsing)return;let{start:g,count:m}=getStartAndCountOfVisiblePointsSimplified(l,h);const _=t.threshold||4*i;if(m<=_){cleanDecimatedDataset(n);return}isNullOrUndef(o)&&(n._data=h,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(d){this._data=d}}));let b;switch(t.algorithm){case"lttb":b=lttbDecimation(h,g,m,i,t);break;case"min-max":b=minMaxDecimation(h,g,m,i);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}n._decimated=b})},destroy(r){cleanDecimatedData(r)}};function _segments(r,e,t){const i=r.segments,n=r.points,s=e.points,o=[];for(const a of i){let{start:l,end:h}=a;h=_findSegmentEnd(l,h,n);const u=_getBounds(t,n[l],n[h],a.loop);if(!e.segments){o.push({source:a,target:u,start:n[l],end:n[h]});continue}const g=_boundSegments(e,u);for(const m of g){const _=_getBounds(t,s[m.start],s[m.end],m.loop),b=_boundSegment(a,n,_);for(const d of b)o.push({source:d,target:m,start:{[t]:_getEdge(u,_,"start",Math.max)},end:{[t]:_getEdge(u,_,"end",Math.min)}})}}return o}function _getBounds(r,e,t,i){if(i)return;let n=e[r],s=t[r];return r==="angle"&&(n=_normalizeAngle(n),s=_normalizeAngle(s)),{property:r,start:n,end:s}}function _pointsFromSegments(r,e){const{x:t=null,y:i=null}=r||{},n=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=_findSegmentEnd(o,a,n);const l=n[o],h=n[a];i!==null?(s.push({x:l.x,y:i}),s.push({x:h.x,y:i})):t!==null&&(s.push({x:t,y:l.y}),s.push({x:t,y:h.y}))}),s}function _findSegmentEnd(r,e,t){for(;e>r;e--){const i=t[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function _getEdge(r,e,t,i){return r&&e?i(r[t],e[t]):r?r[t]:e?e[t]:0}function _createBoundaryLine(r,e){let t=[],i=!1;return isArray(r)?(i=!0,t=r):t=_pointsFromSegments(r,e),t.length?new LineElement({points:t,options:{tension:0},_loop:i,_fullLoop:i}):null}function _shouldApplyFill(r){return r&&r.fill!==!1}function _resolveTarget(r,e,t){let n=r[e].fill;const s=[e];let o;if(!t)return n;for(;n!==!1&&s.indexOf(n)===-1;){if(!isNumberFinite(n))return n;if(o=r[n],!o)return!1;if(o.visible)return n;s.push(n),n=o.fill}return!1}function _decodeFill(r,e,t){const i=parseFillOption(r);if(isObject(i))return isNaN(i.value)?!1:i;let n=parseFloat(i);return isNumberFinite(n)&&Math.floor(n)===n?decodeTargetIndex(i[0],e,n,t):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function decodeTargetIndex(r,e,t,i){return(r==="-"||r==="+")&&(t=e+t),t===e||t<0||t>=i?!1:t}function _getTargetPixel(r,e){let t=null;return r==="start"?t=e.bottom:r==="end"?t=e.top:isObject(r)?t=e.getPixelForValue(r.value):e.getBasePixel&&(t=e.getBasePixel()),t}function _getTargetValue(r,e,t){let i;return r==="start"?i=t:r==="end"?i=e.options.reverse?e.min:e.max:isObject(r)?i=r.value:i=e.getBaseValue(),i}function parseFillOption(r){const e=r.options,t=e.fill;let i=valueOrDefault(t&&t.target,t);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function _buildStackLine(r){const{scale:e,index:t,line:i}=r,n=[],s=i.segments,o=i.points,a=getLinesBelow(e,t);a.push(_createBoundaryLine({x:null,y:e.bottom},i));for(let l=0;l<s.length;l++){const h=s[l];for(let u=h.start;u<=h.end;u++)addPointsBelow(n,o[u],a)}return new LineElement({points:n,options:{}})}function getLinesBelow(r,e){const t=[],i=r.getMatchingVisibleMetas("line");for(let n=0;n<i.length;n++){const s=i[n];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function addPointsBelow(r,e,t){const i=[];for(let n=0;n<t.length;n++){const s=t[n],{first:o,last:a,point:l}=findPoint(s,e,"x");if(!(!l||o&&a)){if(o)i.unshift(l);else if(r.push(l),!a)break}}r.push(...i)}function findPoint(r,e,t){const i=r.interpolate(e,t);if(!i)return{};const n=i[t],s=r.segments,o=r.points;let a=!1,l=!1;for(let h=0;h<s.length;h++){const u=s[h],g=o[u.start][t],m=o[u.end][t];if(_isBetween(n,g,m)){a=n===g,l=n===m;break}}return{first:a,last:l,point:i}}class simpleArc{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:n,y:s,radius:o}=this;return t=t||{start:0,end:TAU},e.arc(n,s,o,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:n}=this,s=e.angle;return{x:t+Math.cos(s)*n,y:i+Math.sin(s)*n,angle:s}}}function _getTarget(r){const{chart:e,fill:t,line:i}=r;if(isNumberFinite(t))return getLineByIndex(e,t);if(t==="stack")return _buildStackLine(r);if(t==="shape")return!0;const n=computeBoundary(r);return n instanceof simpleArc?n:_createBoundaryLine(n,i)}function getLineByIndex(r,e){const t=r.getDatasetMeta(e);return t&&r.isDatasetVisible(e)?t.dataset:null}function computeBoundary(r){return(r.scale||{}).getPointPositionForValue?computeCircularBoundary(r):computeLinearBoundary(r)}function computeLinearBoundary(r){const{scale:e={},fill:t}=r,i=_getTargetPixel(t,e);if(isNumberFinite(i)){const n=e.isHorizontal();return{x:n?i:null,y:n?null:i}}return null}function computeCircularBoundary(r){const{scale:e,fill:t}=r,i=e.options,n=e.getLabels().length,s=i.reverse?e.max:e.min,o=_getTargetValue(t,e,s),a=[];if(i.grid.circular){const l=e.getPointPositionForValue(0,s);return new simpleArc({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<n;++l)a.push(e.getPointPositionForValue(l,o));return a}function _drawfill(r,e,t){const i=_getTarget(e),{chart:n,index:s,line:o,scale:a,axis:l}=e,h=o.options,u=h.fill,g=h.backgroundColor,{above:m=g,below:_=g}=u||{},b=n.getDatasetMeta(s),d=getDatasetClipArea(n,b);i&&o.points.length&&(clipArea(r,t),doFill(r,{line:o,target:i,above:m,below:_,area:t,scale:a,axis:l,clip:d}),unclipArea(r))}function doFill(r,e){const{line:t,target:i,above:n,below:s,area:o,scale:a,clip:l}=e,h=t._loop?"angle":e.axis;r.save(),h==="x"&&s!==n&&(clipVertical(r,i,o.top),fill(r,{line:t,target:i,color:n,scale:a,property:h,clip:l}),r.restore(),r.save(),clipVertical(r,i,o.bottom)),fill(r,{line:t,target:i,color:s,scale:a,property:h,clip:l}),r.restore()}function clipVertical(r,e,t){const{segments:i,points:n}=e;let s=!0,o=!1;r.beginPath();for(const a of i){const{start:l,end:h}=a,u=n[l],g=n[_findSegmentEnd(l,h,n)];s?(r.moveTo(u.x,u.y),s=!1):(r.lineTo(u.x,t),r.lineTo(u.x,u.y)),o=!!e.pathSegment(r,a,{move:o}),o?r.closePath():r.lineTo(g.x,t)}r.lineTo(e.first().x,t),r.closePath(),r.clip()}function fill(r,e){const{line:t,target:i,property:n,color:s,scale:o,clip:a}=e,l=_segments(t,i,n);for(const{source:h,target:u,start:g,end:m}of l){const{style:{backgroundColor:_=s}={}}=h,b=i!==!0;r.save(),r.fillStyle=_,clipBounds(r,o,a,b&&_getBounds(n,g,m)),r.beginPath();const d=!!t.pathSegment(r,h);let c;if(b){d?r.closePath():interpolatedLineTo(r,i,m,n);const f=!!i.pathSegment(r,u,{move:d,reverse:!0});c=d&&f,c||interpolatedLineTo(r,i,g,n)}r.closePath(),r.fill(c?"evenodd":"nonzero"),r.restore()}}function clipBounds(r,e,t,i){const n=e.chart.chartArea,{property:s,start:o,end:a}=i||{};if(s==="x"||s==="y"){let l,h,u,g;s==="x"?(l=o,h=n.top,u=a,g=n.bottom):(l=n.left,h=o,u=n.right,g=a),r.beginPath(),t&&(l=Math.max(l,t.left),u=Math.min(u,t.right),h=Math.max(h,t.top),g=Math.min(g,t.bottom)),r.rect(l,h,u-l,g-h),r.clip()}}function interpolatedLineTo(r,e,t,i){const n=e.interpolate(t,i);n&&r.lineTo(n.x,n.y)}var index={id:"filler",afterDatasetsUpdate(r,e,t){const i=(r.data.datasets||[]).length,n=[];let s,o,a,l;for(o=0;o<i;++o)s=r.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof LineElement&&(l={visible:r.isDatasetVisible(o),index:o,fill:_decodeFill(a,o,i),chart:r,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,n.push(l);for(o=0;o<i;++o)l=n[o],!(!l||l.fill===!1)&&(l.fill=_resolveTarget(n,o,t.propagate))},beforeDraw(r,e,t){const i=t.drawTime==="beforeDraw",n=r.getSortedVisibleDatasetMetas(),s=r.chartArea;for(let o=n.length-1;o>=0;--o){const a=n[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&_drawfill(r.ctx,a,s))}},beforeDatasetsDraw(r,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const i=r.getSortedVisibleDatasetMetas();for(let n=i.length-1;n>=0;--n){const s=i[n].$filler;_shouldApplyFill(s)&&_drawfill(r.ctx,s,r.chartArea)}},beforeDatasetDraw(r,e,t){const i=e.meta.$filler;!_shouldApplyFill(i)||t.drawTime!=="beforeDatasetDraw"||_drawfill(r.ctx,i,r.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const getBoxSize=(r,e)=>{let{boxHeight:t=e,boxWidth:i=e}=r;return r.usePointStyle&&(t=Math.min(t,e),i=r.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},itemsEqual=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class Legend extends Element{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=callback(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,n)=>e.sort(i,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,n=toFont(i.font),s=n.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=getBoxSize(i,s);let h,u;t.font=n.string,this.isHorizontal()?(h=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,h=this._fitCols(o,n,a,l)+10),this.width=Math.min(h,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,n){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],h=this.lineWidths=[0],u=n+a;let g=e;s.textAlign="left",s.textBaseline="middle";let m=-1,_=-u;return this.legendItems.forEach((b,d)=>{const c=i+t/2+s.measureText(b.text).width;(d===0||h[h.length-1]+c+2*a>o)&&(g+=u,h[h.length-(d>0?0:1)]=0,_+=u,m++),l[d]={left:0,top:_,row:m,width:c,height:n},h[h.length-1]+=c+a}),g}_fitCols(e,t,i,n){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],h=this.columnSizes=[],u=o-e;let g=a,m=0,_=0,b=0,d=0;return this.legendItems.forEach((c,f)=>{const{itemWidth:v,itemHeight:y}=calculateItemSize(i,t,s,c,n);f>0&&_+y+2*a>u&&(g+=m+a,h.push({width:m,height:_}),b+=m+a,d++,m=_=0),l[f]={left:b,top:_,col:d,width:v,height:y},m=Math.max(m,v),_+=y+a}),g+=m,h.push({width:m,height:_}),g}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:n},rtl:s}}=this,o=getRtlAdapter(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=_alignStartEnd(i,this.left+n,this.right-this.lineWidths[a]);for(const h of t)a!==h.row&&(a=h.row,l=_alignStartEnd(i,this.left+n,this.right-this.lineWidths[a])),h.top+=this.top+e+n,h.left=o.leftForLtr(o.x(l),h.width),l+=h.width+n}else{let a=0,l=_alignStartEnd(i,this.top+e+n,this.bottom-this.columnSizes[a].height);for(const h of t)h.col!==a&&(a=h.col,l=_alignStartEnd(i,this.top+e+n,this.bottom-this.columnSizes[a].height)),h.top=l,h.left+=this.left+n,h.left=o.leftForLtr(o.x(h.left),h.width),l+=h.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;clipArea(e,this),this._draw(),unclipArea(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:n}=this,{align:s,labels:o}=e,a=defaults.color,l=getRtlAdapter(e.rtl,this.left,this.width),h=toFont(o.font),{padding:u}=o,g=h.size,m=g/2;let _;this.drawTitle(),n.textAlign=l.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=h.string;const{boxWidth:b,boxHeight:d,itemHeight:c}=getBoxSize(o,g),f=function(p,x,w){if(isNaN(b)||b<=0||isNaN(d)||d<0)return;n.save();const C=valueOrDefault(w.lineWidth,1);if(n.fillStyle=valueOrDefault(w.fillStyle,a),n.lineCap=valueOrDefault(w.lineCap,"butt"),n.lineDashOffset=valueOrDefault(w.lineDashOffset,0),n.lineJoin=valueOrDefault(w.lineJoin,"miter"),n.lineWidth=C,n.strokeStyle=valueOrDefault(w.strokeStyle,a),n.setLineDash(valueOrDefault(w.lineDash,[])),o.usePointStyle){const S={radius:d*Math.SQRT2/2,pointStyle:w.pointStyle,rotation:w.rotation,borderWidth:C},A=l.xPlus(p,b/2),P=x+m;drawPointLegend(n,S,A,P,o.pointStyleWidth&&b)}else{const S=x+Math.max((g-d)/2,0),A=l.leftForLtr(p,b),P=toTRBLCorners(w.borderRadius);n.beginPath(),Object.values(P).some(O=>O!==0)?addRoundedRectPath(n,{x:A,y:S,w:b,h:d,radius:P}):n.rect(A,S,b,d),n.fill(),C!==0&&n.stroke()}n.restore()},v=function(p,x,w){renderText(n,w.text,p,x+c/2,h,{strikethrough:w.hidden,textAlign:l.textAlign(w.textAlign)})},y=this.isHorizontal(),D=this._computeTitleHeight();y?_={x:_alignStartEnd(s,this.left+u,this.right-i[0]),y:this.top+u+D,line:0}:_={x:this.left+u,y:_alignStartEnd(s,this.top+D+u,this.bottom-t[0].height),line:0},overrideTextDirection(this.ctx,e.textDirection);const E=c+u;this.legendItems.forEach((p,x)=>{n.strokeStyle=p.fontColor,n.fillStyle=p.fontColor;const w=n.measureText(p.text).width,C=l.textAlign(p.textAlign||(p.textAlign=o.textAlign)),S=b+m+w;let A=_.x,P=_.y;l.setWidth(this.width),y?x>0&&A+S+u>this.right&&(P=_.y+=E,_.line++,A=_.x=_alignStartEnd(s,this.left+u,this.right-i[_.line])):x>0&&P+E>this.bottom&&(A=_.x=A+t[_.line].width+u,_.line++,P=_.y=_alignStartEnd(s,this.top+D+u,this.bottom-t[_.line].height));const O=l.x(A);if(f(O,P,p),A=_textX(C,A+b+m,y?A+S:this.right,e.rtl),v(l.x(A),P,p),y)_.x+=S+u;else if(typeof p.text!="string"){const F=h.lineHeight;_.y+=calculateLegendItemHeight(p,F)+u}else _.y+=E}),restoreTextDirection(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=toFont(t.font),n=toPadding(t.padding);if(!t.display)return;const s=getRtlAdapter(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=i.size/2,h=n.top+l;let u,g=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),u=this.top+h,g=_alignStartEnd(e.align,g,this.right-m);else{const b=this.columnSizes.reduce((d,c)=>Math.max(d,c.height),0);u=h+_alignStartEnd(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const _=_alignStartEnd(a,g,g+m);o.textAlign=s.textAlign(_toLeftRightCenter(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=i.string,renderText(o,t.text,_,u,i)}_computeTitleHeight(){const e=this.options.title,t=toFont(e.font),i=toPadding(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,n,s;if(_isBetween(e,this.left,this.right)&&_isBetween(t,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(n=s[i],_isBetween(e,n.left,n.left+n.width)&&_isBetween(t,n.top,n.top+n.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!isListened(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const n=this._hoveredItem,s=itemsEqual(n,i);n&&!s&&callback(t.onLeave,[e,n,this],this),this._hoveredItem=i,i&&!s&&callback(t.onHover,[e,i,this],this)}else i&&callback(t.onClick,[e,i,this],this)}}function calculateItemSize(r,e,t,i,n){const s=calculateItemWidth(i,r,e,t),o=calculateItemHeight(n,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function calculateItemWidth(r,e,t,i){let n=r.text;return n&&typeof n!="string"&&(n=n.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+i.measureText(n).width}function calculateItemHeight(r,e,t){let i=r;return typeof e.text!="string"&&(i=calculateLegendItemHeight(e,t)),i}function calculateLegendItemHeight(r,e){const t=r.text?r.text.length:0;return e*t}function isListened(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(r,e,t){const i=r.legend=new Legend({ctx:r.ctx,options:t,chart:r});layouts.configure(r,i,t),layouts.addBox(r,i)},stop(r){layouts.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const i=r.legend;layouts.configure(r,i,t),i.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const i=e.datasetIndex,n=t.chart;n.isDatasetVisible(i)?(n.hide(i),e.hidden=!0):(n.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:n,color:s,useBorderRadius:o,borderRadius:a}}=r.legend.options;return r._getSortedDatasetMetas().map(l=>{const h=l.controller.getStyle(t?0:void 0),u=toPadding(h.borderWidth);return{text:e[l.index].label,fillStyle:h.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:h.borderCapStyle,lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:h.borderColor,pointStyle:i||h.pointStyle,rotation:h.rotation,textAlign:n||h.textAlign,borderRadius:o&&(a||h.borderRadius),datasetIndex:l.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};class Title extends Element{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const n=isArray(i.text)?i.text.length:1;this._padding=toPadding(i.padding);const s=n*toFont(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:n,right:s,options:o}=this,a=o.align;let l=0,h,u,g;return this.isHorizontal()?(u=_alignStartEnd(a,i,s),g=t+e,h=s-i):(o.position==="left"?(u=i+e,g=_alignStartEnd(a,n,t),l=PI*-.5):(u=s-e,g=_alignStartEnd(a,t,n),l=PI*.5),h=n-t),{titleX:u,titleY:g,maxWidth:h,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=toFont(t.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:h}=this._drawArgs(s);renderText(e,t.text,0,0,i,{color:t.color,maxWidth:l,rotation:h,textAlign:_toLeftRightCenter(t.align),textBaseline:"middle",translation:[o,a]})}}function createTitle(r,e){const t=new Title({ctx:r.ctx,options:e,chart:r});layouts.configure(r,t,e),layouts.addBox(r,t),r.titleBlock=t}var plugin_title={id:"title",_element:Title,start(r,e,t){createTitle(r,t)},stop(r){const e=r.titleBlock;layouts.removeBox(r,e),delete r.titleBlock},beforeUpdate(r,e,t){const i=r.titleBlock;layouts.configure(r,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const map=new WeakMap;var plugin_subtitle={id:"subtitle",start(r,e,t){const i=new Title({ctx:r.ctx,options:t,chart:r});layouts.configure(r,i,t),layouts.addBox(r,i),map.set(r,i)},stop(r){layouts.removeBox(r,map.get(r)),map.delete(r)},beforeUpdate(r,e,t){const i=map.get(r);layouts.configure(r,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(r){if(!r.length)return!1;let e,t,i=new Set,n=0,s=0;for(e=0,t=r.length;e<t;++e){const a=r[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();i.add(l.x),n+=l.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,l)=>a+l)/i.size,y:n/s}},nearest(r,e){if(!r.length)return!1;let t=e.x,i=e.y,n=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=r.length;s<o;++s){const l=r[s].element;if(l&&l.hasValue()){const h=l.getCenterPoint(),u=distanceBetweenPoints(e,h);u<n&&(n=u,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,i=l.y}return{x:t,y:i}}};function pushOrConcat(r,e){return e&&(isArray(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function splitNewlines(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function createTooltipItem(r,e){const{element:t,datasetIndex:i,index:n}=e,s=r.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(n);return{chart:r,label:o,parsed:s.getParsed(n),raw:r.data.datasets[i].data[n],formattedValue:a,dataset:s.getDataset(),dataIndex:n,datasetIndex:i,element:t}}function getTooltipSize(r,e){const t=r.chart.ctx,{body:i,footer:n,title:s}=r,{boxWidth:o,boxHeight:a}=e,l=toFont(e.bodyFont),h=toFont(e.titleFont),u=toFont(e.footerFont),g=s.length,m=n.length,_=i.length,b=toPadding(e.padding);let d=b.height,c=0,f=i.reduce((D,E)=>D+E.before.length+E.lines.length+E.after.length,0);if(f+=r.beforeBody.length+r.afterBody.length,g&&(d+=g*h.lineHeight+(g-1)*e.titleSpacing+e.titleMarginBottom),f){const D=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;d+=_*D+(f-_)*l.lineHeight+(f-1)*e.bodySpacing}m&&(d+=e.footerMarginTop+m*u.lineHeight+(m-1)*e.footerSpacing);let v=0;const y=function(D){c=Math.max(c,t.measureText(D).width+v)};return t.save(),t.font=h.string,each(r.title,y),t.font=l.string,each(r.beforeBody.concat(r.afterBody),y),v=e.displayColors?o+2+e.boxPadding:0,each(i,D=>{each(D.before,y),each(D.lines,y),each(D.after,y)}),v=0,t.font=u.string,each(r.footer,y),t.restore(),c+=b.width,{width:c,height:d}}function determineYAlign(r,e){const{y:t,height:i}=e;return t<i/2?"top":t>r.height-i/2?"bottom":"center"}function doesNotFitWithAlign(r,e,t,i){const{x:n,width:s}=i,o=t.caretSize+t.caretPadding;if(r==="left"&&n+s+o>e.width||r==="right"&&n-s-o<0)return!0}function determineXAlign(r,e,t,i){const{x:n,width:s}=t,{width:o,chartArea:{left:a,right:l}}=r;let h="center";return i==="center"?h=n<=(a+l)/2?"left":"right":n<=s/2?h="left":n>=o-s/2&&(h="right"),doesNotFitWithAlign(h,r,e,t)&&(h="center"),h}function determineAlignment(r,e,t){const i=t.yAlign||e.yAlign||determineYAlign(r,t);return{xAlign:t.xAlign||e.xAlign||determineXAlign(r,e,t,i),yAlign:i}}function alignX(r,e){let{x:t,width:i}=r;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function alignY(r,e,t){let{y:i,height:n}=r;return e==="top"?i+=t:e==="bottom"?i-=n+t:i-=n/2,i}function getBackgroundPoint(r,e,t,i){const{caretSize:n,caretPadding:s,cornerRadius:o}=r,{xAlign:a,yAlign:l}=t,h=n+s,{topLeft:u,topRight:g,bottomLeft:m,bottomRight:_}=toTRBLCorners(o);let b=alignX(e,a);const d=alignY(e,l,h);return l==="center"?a==="left"?b+=h:a==="right"&&(b-=h):a==="left"?b-=Math.max(u,m)+n:a==="right"&&(b+=Math.max(g,_)+n),{x:_limitValue(b,0,i.width-e.width),y:_limitValue(d,0,i.height-e.height)}}function getAlignedX(r,e,t){const i=toPadding(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-i.right:r.x+i.left}function getBeforeAfterBodyLines(r){return pushOrConcat([],splitNewlines(r))}function createTooltipContext(r,e,t){return createContext(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function overrideCallbacks(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const defaultCallbacks={beforeTitle:noop,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return isNullOrUndef(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop};function invokeCallbackWithFallback(r,e,t,i){const n=r[e].call(t,i);return typeof n>"u"?defaultCallbacks[e].call(t,i):n}class Tooltip extends Element{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&t.options.animation&&i.animations,s=new Animations(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,n=invokeCallbackWithFallback(i,"beforeTitle",this,e),s=invokeCallbackWithFallback(i,"title",this,e),o=invokeCallbackWithFallback(i,"afterTitle",this,e);let a=[];return a=pushOrConcat(a,splitNewlines(n)),a=pushOrConcat(a,splitNewlines(s)),a=pushOrConcat(a,splitNewlines(o)),a}getBeforeBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,n=[];return each(e,s=>{const o={before:[],lines:[],after:[]},a=overrideCallbacks(i,s);pushOrConcat(o.before,splitNewlines(invokeCallbackWithFallback(a,"beforeLabel",this,s))),pushOrConcat(o.lines,invokeCallbackWithFallback(a,"label",this,s)),pushOrConcat(o.after,splitNewlines(invokeCallbackWithFallback(a,"afterLabel",this,s))),n.push(o)}),n}getAfterBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,n=invokeCallbackWithFallback(i,"beforeFooter",this,e),s=invokeCallbackWithFallback(i,"footer",this,e),o=invokeCallbackWithFallback(i,"afterFooter",this,e);let a=[];return a=pushOrConcat(a,splitNewlines(n)),a=pushOrConcat(a,splitNewlines(s)),a=pushOrConcat(a,splitNewlines(o)),a}_createItems(e){const t=this._active,i=this.chart.data,n=[],s=[],o=[];let a=[],l,h;for(l=0,h=t.length;l<h;++l)a.push(createTooltipItem(this.chart,t[l]));return e.filter&&(a=a.filter((u,g,m)=>e.filter(u,g,m,i))),e.itemSort&&(a=a.sort((u,g)=>e.itemSort(u,g,i))),each(a,u=>{const g=overrideCallbacks(e.callbacks,u);n.push(invokeCallbackWithFallback(g,"labelColor",this,u)),s.push(invokeCallbackWithFallback(g,"labelPointStyle",this,u)),o.push(invokeCallbackWithFallback(g,"labelTextColor",this,u))}),this.labelColors=n,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const i=this.options.setContext(this.getContext()),n=this._active;let s,o=[];if(!n.length)this.opacity!==0&&(s={opacity:0});else{const a=positioners[i.position].call(this,n,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const l=this._size=getTooltipSize(this,i),h=Object.assign({},a,l),u=determineAlignment(this.chart,i,h),g=getBackgroundPoint(i,h,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:g.x,y:g.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,n){const s=this.getCaretPosition(e,i,n);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,i){const{xAlign:n,yAlign:s}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:l,topRight:h,bottomLeft:u,bottomRight:g}=toTRBLCorners(a),{x:m,y:_}=e,{width:b,height:d}=t;let c,f,v,y,D,E;return s==="center"?(D=_+d/2,n==="left"?(c=m,f=c-o,y=D+o,E=D-o):(c=m+b,f=c+o,y=D-o,E=D+o),v=c):(n==="left"?f=m+Math.max(l,u)+o:n==="right"?f=m+b-Math.max(h,g)-o:f=this.caretX,s==="top"?(y=_,D=y-o,c=f-o,v=f+o):(y=_+d,D=y+o,c=f+o,v=f-o),E=y),{x1:c,x2:f,x3:v,y1:y,y2:D,y3:E}}drawTitle(e,t,i){const n=this.title,s=n.length;let o,a,l;if(s){const h=getRtlAdapter(i.rtl,this.x,this.width);for(e.x=getAlignedX(this,i.titleAlign,i),t.textAlign=h.textAlign(i.titleAlign),t.textBaseline="middle",o=toFont(i.titleFont),a=i.titleSpacing,t.fillStyle=i.titleColor,t.font=o.string,l=0;l<s;++l)t.fillText(n[l],h.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=i.titleMarginBottom-a)}}_drawColorBox(e,t,i,n,s){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:h}=s,u=toFont(s.bodyFont),g=getAlignedX(this,"left",s),m=n.x(g),_=l<u.lineHeight?(u.lineHeight-l)/2:0,b=t.y+_;if(s.usePointStyle){const d={radius:Math.min(h,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},c=n.leftForLtr(m,h)+h/2,f=b+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,drawPoint(e,d,c,f),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,drawPoint(e,d,c,f)}else{e.lineWidth=isObject(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const d=n.leftForLtr(m,h),c=n.leftForLtr(n.xPlus(m,1),h-2),f=toTRBLCorners(o.borderRadius);Object.values(f).some(v=>v!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,addRoundedRectPath(e,{x:d,y:b,w:h,h:l,radius:f}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),addRoundedRectPath(e,{x:c,y:b+1,w:h-2,h:l-2,radius:f}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(d,b,h,l),e.strokeRect(d,b,h,l),e.fillStyle=o.backgroundColor,e.fillRect(c,b+1,h-2,l-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:n}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:h,boxPadding:u}=i,g=toFont(i.bodyFont);let m=g.lineHeight,_=0;const b=getRtlAdapter(i.rtl,this.x,this.width),d=function(w){t.fillText(w,b.x(e.x+_),e.y+m/2),e.y+=m+s},c=b.textAlign(o);let f,v,y,D,E,p,x;for(t.textAlign=o,t.textBaseline="middle",t.font=g.string,e.x=getAlignedX(this,c,i),t.fillStyle=i.bodyColor,each(this.beforeBody,d),_=a&&c!=="right"?o==="center"?h/2+u:h+2+u:0,D=0,p=n.length;D<p;++D){for(f=n[D],v=this.labelTextColors[D],t.fillStyle=v,each(f.before,d),y=f.lines,a&&y.length&&(this._drawColorBox(t,e,D,b,i),m=Math.max(g.lineHeight,l)),E=0,x=y.length;E<x;++E)d(y[E]),m=g.lineHeight;each(f.after,d)}_=0,m=g.lineHeight,each(this.afterBody,d),e.y-=s}drawFooter(e,t,i){const n=this.footer,s=n.length;let o,a;if(s){const l=getRtlAdapter(i.rtl,this.x,this.width);for(e.x=getAlignedX(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=l.textAlign(i.footerAlign),t.textBaseline="middle",o=toFont(i.footerFont),t.fillStyle=i.footerColor,t.font=o.string,a=0;a<s;++a)t.fillText(n[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+i.footerSpacing}}drawBackground(e,t,i,n){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:h,height:u}=i,{topLeft:g,topRight:m,bottomLeft:_,bottomRight:b}=toTRBLCorners(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(a+g,l),o==="top"&&this.drawCaret(e,t,i,n),t.lineTo(a+h-m,l),t.quadraticCurveTo(a+h,l,a+h,l+m),o==="center"&&s==="right"&&this.drawCaret(e,t,i,n),t.lineTo(a+h,l+u-b),t.quadraticCurveTo(a+h,l+u,a+h-b,l+u),o==="bottom"&&this.drawCaret(e,t,i,n),t.lineTo(a+_,l+u),t.quadraticCurveTo(a,l+u,a,l+u-_),o==="center"&&s==="left"&&this.drawCaret(e,t,i,n),t.lineTo(a,l+g),t.quadraticCurveTo(a,l,a+g,l),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,n=i&&i.x,s=i&&i.y;if(n||s){const o=positioners[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=getTooltipSize(this,e),l=Object.assign({},o,this._size),h=determineAlignment(t,e,l),u=getBackgroundPoint(e,l,h,t);(n._to!==u.x||s._to!==u.y)&&(this.xAlign=h.xAlign,this.yAlign=h.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=toPadding(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=i,this.drawBackground(s,e,n,t),overrideTextDirection(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),restoreTextDirection(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,n=e.map(({datasetIndex:a,index:l})=>{const h=this.chart.getDatasetMeta(a);if(!h)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:h.data[l],index:l}}),s=!_elementsEqual(i,n),o=this._positionChanged(n,t);(s||o)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,i),a=this._positionChanged(o,e),l=t||!_elementsEqual(o,s)||a;return l&&(this._active=o,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,i,n){const s=this.options;if(e.type==="mouseout")return[];if(!n)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,i);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:i,caretY:n,options:s}=this,o=positioners[s.position].call(this,e,t);return o!==!1&&(i!==o.x||n!==o.y)}}$e(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(r,e,t){t&&(r.tooltip=new Tooltip({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},plugins=Object.freeze({__proto__:null,Colors:plugin_colors,Decimation:plugin_decimation,Filler:index,Legend:plugin_legend,SubTitle:plugin_subtitle,Title:plugin_title,Tooltip:plugin_tooltip});const addIfString=(r,e,t,i)=>(typeof e=="string"?(t=r.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function findOrAddLabel(r,e,t,i){const n=r.indexOf(e);if(n===-1)return addIfString(r,e,t,i);const s=r.lastIndexOf(e);return n!==s?t:n}const validIndex=(r,e)=>r===null?null:_limitValue(Math.round(r),0,e);function _getLabelForValue(r){const e=this.getLabels();return r>=0&&r<e.length?e[r]:r}class CategoryScale extends Scale{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:n,label:s}of t)i[n]===s&&i.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(isNullOrUndef(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:findOrAddLabel(i,e,valueOrDefault(t,e),this._addedLabels),validIndex(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,n=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=e;o<=t;o++)n.push({value:o});return n}getLabelForValue(e){return _getLabelForValue.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}$e(CategoryScale,"id","category"),$e(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(r,e){const t=[],{bounds:n,step:s,min:o,max:a,precision:l,count:h,maxTicks:u,maxDigits:g,includeBounds:m}=r,_=s||1,b=u-1,{min:d,max:c}=e,f=!isNullOrUndef(o),v=!isNullOrUndef(a),y=!isNullOrUndef(h),D=(c-d)/(g+1);let E=niceNum((c-d)/b/_)*_,p,x,w,C;if(E<1e-14&&!f&&!v)return[{value:d},{value:c}];C=Math.ceil(c/E)-Math.floor(d/E),C>b&&(E=niceNum(C*E/b/_)*_),isNullOrUndef(l)||(p=Math.pow(10,l),E=Math.ceil(E*p)/p),n==="ticks"?(x=Math.floor(d/E)*E,w=Math.ceil(c/E)*E):(x=d,w=c),f&&v&&s&&almostWhole((a-o)/s,E/1e3)?(C=Math.round(Math.min((a-o)/E,u)),E=(a-o)/C,x=o,w=a):y?(x=f?o:x,w=v?a:w,C=h-1,E=(w-x)/C):(C=(w-x)/E,almostEquals(C,Math.round(C),E/1e3)?C=Math.round(C):C=Math.ceil(C));const S=Math.max(_decimalPlaces(E),_decimalPlaces(x));p=Math.pow(10,isNullOrUndef(l)?S:l),x=Math.round(x*p)/p,w=Math.round(w*p)/p;let A=0;for(f&&(m&&x!==o?(t.push({value:o}),x<o&&A++,almostEquals(Math.round((x+A*E)*p)/p,o,relativeLabelSize(o,D,r))&&A++):x<o&&A++);A<C;++A){const P=Math.round((x+A*E)*p)/p;if(v&&P>a)break;t.push({value:P})}return v&&m&&w!==a?t.length&&almostEquals(t[t.length-1].value,a,relativeLabelSize(a,D,r))?t[t.length-1].value=a:t.push({value:a}):(!v||w===a)&&t.push({value:w}),t}function relativeLabelSize(r,e,{horizontal:t,minRotation:i}){const n=toRadians(i),s=(t?Math.sin(n):Math.cos(n))||.001,o=.75*e*(""+r).length;return Math.min(e/s,o)}class LinearScaleBase extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:n,max:s}=this;const o=l=>n=t?n:l,a=l=>s=i?s:l;if(e){const l=sign(n),h=sign(s);l<0&&h<0?a(0):l>0&&h>0&&o(0)}if(n===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(n-l)}this.min=n,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,n;return i?(n=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),t=t||11),t&&(n=Math.min(t,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const n={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=generateTicks$1(n,s);return e.bounds==="ticks"&&_setMinAndMaxByKey(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const n=(i-t)/Math.max(e.length-1,1)/2;t-=n,i+=n}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=toRadians(this.options.ticks.minRotation),n=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/n))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}$e(LinearScale,"id","linear"),$e(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const log10Floor=r=>Math.floor(log10(r)),changeExponent=(r,e)=>Math.pow(10,log10Floor(r)+e);function isMajor(r){return r/Math.pow(10,log10Floor(r))===1}function steps(r,e,t){const i=Math.pow(10,t),n=Math.floor(r/i);return Math.ceil(e/i)-n}function startExp(r,e){const t=e-r;let i=log10Floor(t);for(;steps(r,e,i)>10;)i++;for(;steps(r,e,i)<10;)i--;return Math.min(i,log10Floor(r))}function generateTicks(r,{min:e,max:t}){e=finiteOrDefault(r.min,e);const i=[],n=log10Floor(e);let s=startExp(e,t),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=n>s?Math.pow(10,n):0,h=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let g=Math.floor((h-u)/Math.pow(10,s)),m=finiteOrDefault(r.min,Math.round((l+u+g*Math.pow(10,s))*o)/o);for(;m<t;)i.push({value:m,major:isMajor(m),significand:g}),g>=10?g=g<15?15:20:g++,g>=20&&(s++,g=2,o=s>=0?1:o),m=Math.round((l+u+g*Math.pow(10,s))*o)/o;const _=finiteOrDefault(r.max,m);return i.push({value:_,major:isMajor(_),significand:g}),i}class LogarithmicScale extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=LinearScaleBase.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return isNumberFinite(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?Math.max(0,e):null,this.max=isNumberFinite(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!isNumberFinite(this._userMin)&&(this.min=e===changeExponent(this.min,0)?changeExponent(this.min,-1):changeExponent(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,n=this.max;const s=a=>i=e?i:a,o=a=>n=t?n:a;i===n&&(i<=0?(s(1),o(10)):(s(changeExponent(i,-1)),o(changeExponent(n,1)))),i<=0&&s(changeExponent(n,-1)),n<=0&&o(changeExponent(i,1)),this.min=i,this.max=n}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=generateTicks(t,this);return e.bounds==="ticks"&&_setMinAndMaxByKey(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":formatNumber(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=log10(e),this._valueRange=log10(this.max)-log10(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(log10(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}$e(LogarithmicScale,"id","logarithmic"),$e(LogarithmicScale,"defaults",{ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}});function getTickBackdropHeight(r){const e=r.ticks;if(e.display&&r.display){const t=toPadding(e.backdropPadding);return valueOrDefault(e.font&&e.font.size,defaults.font.size)+t.height}return 0}function measureLabelSize(r,e,t){return t=isArray(t)?t:[t],{w:_longestText(r,e.string,t),h:t.length*e.lineHeight}}function determineLimits(r,e,t,i,n){return r===i||r===n?{start:e-t/2,end:e+t/2}:r<i||r>n?{start:e-t,end:e}:{start:e,end:e+t}}function fitWithPointLabels(r){const e={l:r.left+r._padding.left,r:r.right-r._padding.right,t:r.top+r._padding.top,b:r.bottom-r._padding.bottom},t=Object.assign({},e),i=[],n=[],s=r._pointLabels.length,o=r.options.pointLabels,a=o.centerPointLabels?PI/s:0;for(let l=0;l<s;l++){const h=o.setContext(r.getPointLabelContext(l));n[l]=h.padding;const u=r.getPointPosition(l,r.drawingArea+n[l],a),g=toFont(h.font),m=measureLabelSize(r.ctx,g,r._pointLabels[l]);i[l]=m;const _=_normalizeAngle(r.getIndexAngle(l)+a),b=Math.round(toDegrees(_)),d=determineLimits(b,u.x,m.w,0,180),c=determineLimits(b,u.y,m.h,90,270);updateLimits(t,e,_,d,c)}r.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),r._pointLabelItems=buildPointLabelItems(r,i,n)}function updateLimits(r,e,t,i,n){const s=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t));let a=0,l=0;i.start<e.l?(a=(e.l-i.start)/s,r.l=Math.min(r.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/s,r.r=Math.max(r.r,e.r+a)),n.start<e.t?(l=(e.t-n.start)/o,r.t=Math.min(r.t,e.t-l)):n.end>e.b&&(l=(n.end-e.b)/o,r.b=Math.max(r.b,e.b+l))}function createPointLabelItem(r,e,t){const i=r.drawingArea,{extra:n,additionalAngle:s,padding:o,size:a}=t,l=r.getPointPosition(e,i+n+o,s),h=Math.round(toDegrees(_normalizeAngle(l.angle+HALF_PI))),u=yForAngle(l.y,a.h,h),g=getTextAlignForAngle(h),m=leftForTextAlign(l.x,a.w,g);return{visible:!0,x:l.x,y:u,textAlign:g,left:m,top:u,right:m+a.w,bottom:u+a.h}}function isNotOverlapped(r,e){if(!e)return!0;const{left:t,top:i,right:n,bottom:s}=r;return!(_isPointInArea({x:t,y:i},e)||_isPointInArea({x:t,y:s},e)||_isPointInArea({x:n,y:i},e)||_isPointInArea({x:n,y:s},e))}function buildPointLabelItems(r,e,t){const i=[],n=r._pointLabels.length,s=r.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:getTickBackdropHeight(s)/2,additionalAngle:o?PI/n:0};let h;for(let u=0;u<n;u++){l.padding=t[u],l.size=e[u];const g=createPointLabelItem(r,u,l);i.push(g),a==="auto"&&(g.visible=isNotOverlapped(g,h),g.visible&&(h=g))}return i}function getTextAlignForAngle(r){return r===0||r===180?"center":r<180?"left":"right"}function leftForTextAlign(r,e,t){return t==="right"?r-=e:t==="center"&&(r-=e/2),r}function yForAngle(r,e,t){return t===90||t===270?r-=e/2:(t>270||t<90)&&(r-=e),r}function drawPointLabelBox(r,e,t){const{left:i,top:n,right:s,bottom:o}=t,{backdropColor:a}=e;if(!isNullOrUndef(a)){const l=toTRBLCorners(e.borderRadius),h=toPadding(e.backdropPadding);r.fillStyle=a;const u=i-h.left,g=n-h.top,m=s-i+h.width,_=o-n+h.height;Object.values(l).some(b=>b!==0)?(r.beginPath(),addRoundedRectPath(r,{x:u,y:g,w:m,h:_,radius:l}),r.fill()):r.fillRect(u,g,m,_)}}function drawPointLabels(r,e){const{ctx:t,options:{pointLabels:i}}=r;for(let n=e-1;n>=0;n--){const s=r._pointLabelItems[n];if(!s.visible)continue;const o=i.setContext(r.getPointLabelContext(n));drawPointLabelBox(t,o,s);const a=toFont(o.font),{x:l,y:h,textAlign:u}=s;renderText(t,r._pointLabels[n],l,h+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function pathRadiusLine(r,e,t,i){const{ctx:n}=r;if(t)n.arc(r.xCenter,r.yCenter,e,0,TAU);else{let s=r.getPointPosition(0,e);n.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=r.getPointPosition(o,e),n.lineTo(s.x,s.y)}}function drawRadiusLine(r,e,t,i,n){const s=r.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!i||!a||!l||t<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(n.dash||[]),s.lineDashOffset=n.dashOffset,s.beginPath(),pathRadiusLine(r,t,o,i),s.closePath(),s.stroke(),s.restore())}function createPointLabelContext(r,e,t){return createContext(r,{label:t,index:e,type:"pointLabel"})}class RadialLinearScale extends LinearScaleBase{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=toPadding(getTickBackdropHeight(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=isNumberFinite(e)&&!isNaN(e)?e:0,this.max=isNumberFinite(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(e){LinearScaleBase.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const n=callback(this.options.pointLabels.callback,[t,i],this);return n||n===0?n:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?fitWithPointLabels(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,n))}getIndexAngle(e){const t=TAU/(this._pointLabels.length||1),i=this.options.startAngle||0;return _normalizeAngle(e*t+toRadians(i))}getDistanceFromCenterForValue(e){if(isNullOrUndef(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(isNullOrUndef(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return createPointLabelContext(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const n=this.getIndexAngle(e)-HALF_PI+i;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:n,bottom:s}=this._pointLabelItems[e];return{left:t,top:i,right:n,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),pathRadiusLine(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:n,border:s}=t,o=this._pointLabels.length;let a,l,h;if(t.pointLabels.display&&drawPointLabels(this,o),n.display&&this.ticks.forEach((u,g)=>{if(g!==0||g===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const m=this.getContext(g),_=n.setContext(m),b=s.setContext(m);drawRadiusLine(this,_,l,o,b)}}),i.display){for(e.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:g,lineWidth:m}=u;!m||!g||(e.lineWidth=m,e.strokeStyle=g,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),h=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(h.x,h.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const n=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!t.reverse)return;const h=i.setContext(this.getContext(l)),u=toFont(h.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),h.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=h.backdropColor;const g=toPadding(h.backdropPadding);e.fillRect(-o/2-g.left,-s-u.size/2-g.top,o+g.width,u.size+g.height)}renderText(e,a.label,0,-s,u,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),e.restore()}drawTitle(){}}$e(RadialLinearScale,"id","radialLinear"),$e(RadialLinearScale,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),$e(RadialLinearScale,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),$e(RadialLinearScale,"descriptors",{angleLines:{_fallback:"grid"}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(r,e){return r-e}function parse(r,e){if(isNullOrUndef(e))return null;const t=r._adapter,{parser:i,round:n,isoWeekday:s}=r._parseOpts;let o=e;return typeof i=="function"&&(o=i(o)),isNumberFinite(o)||(o=typeof i=="string"?t.parse(o,i):t.parse(o)),o===null?null:(n&&(o=n==="week"&&(isNumber(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,n)),+o)}function determineUnitForAutoTicks(r,e,t,i){const n=UNITS.length;for(let s=UNITS.indexOf(r);s<n-1;++s){const o=INTERVALS[UNITS[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=i)return UNITS[s]}return UNITS[n-1]}function determineUnitForFormatting(r,e,t,i,n){for(let s=UNITS.length-1;s>=UNITS.indexOf(t);s--){const o=UNITS[s];if(INTERVALS[o].common&&r._adapter.diff(n,i,o)>=e-1)return o}return UNITS[t?UNITS.indexOf(t):0]}function determineMajorUnit(r){for(let e=UNITS.indexOf(r)+1,t=UNITS.length;e<t;++e)if(INTERVALS[UNITS[e]].common)return UNITS[e]}function addTick(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:i,hi:n}=_lookup(t,e),s=t[i]>=e?t[i]:t[n];r[s]=!0}}function setMajorTicks(r,e,t,i){const n=r._adapter,s=+n.startOf(e[0].value,i),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+n.add(a,1,i))l=t[a],l>=0&&(e[l].major=!0);return e}function ticksFromTimestamps(r,e,t){const i=[],n={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],n[a]=o,i.push({value:a,major:!1});return s===0||!t?i:setMajorTicks(r,i,n,t)}class TimeScale extends Scale{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),n=this._adapter=new adapters._date(e.adapters.date);n.init(t),mergeIf(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:parse(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:n,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(h){!o&&!isNaN(h.min)&&(n=Math.min(n,h.min)),!a&&!isNaN(h.max)&&(s=Math.max(s,h.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),n=isNumberFinite(n)&&!isNaN(n)?n:+t.startOf(Date.now(),i),s=isNumberFinite(s)&&!isNaN(s)?s:+t.endOf(Date.now(),i)+1,this.min=Math.min(n,s-1),this.max=Math.max(n+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,n=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const s=this.min,o=this.max,a=_filterBetween(n,s,o);return this._unit=t.unit||(i.autoSkip?determineUnitForAutoTicks(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):determineUnitForFormatting(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(n),e.reverse&&a.reverse(),ticksFromTimestamps(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,n,s;this.options.offset&&e.length&&(n=this.getDecimalForValue(e[0]),e.length===1?t=1-n:t=(this.getDecimalForValue(e[1])-n)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=_limitValue(t,0,o),i=_limitValue(i,0,o),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,n=this.options,s=n.time,o=s.unit||determineUnitForAutoTicks(s.minUnit,t,i,this._getLabelCapacity(t)),a=valueOrDefault(n.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,h=isNumber(l)||l===!0,u={};let g=t,m,_;if(h&&(g=+e.startOf(g,"isoWeek",l)),g=+e.startOf(g,h?"day":o),e.diff(i,t,o)>1e5*a)throw new Error(t+" and "+i+" are too far apart with stepSize of "+a+" "+o);const b=n.ticks.source==="data"&&this.getDataTimestamps();for(m=g,_=0;m<i;m=+e.add(m,a,o),_++)addTick(u,m,b);return(m===i||n.bounds==="ticks"||_===1)&&addTick(u,m,b),Object.keys(u).sort(sorter).map(d=>+d)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,s=this._unit,o=t||n[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,i,n){const s=this.options,o=s.ticks.callback;if(o)return callback(o,[e,t,i],this);const a=s.time.displayFormats,l=this._unit,h=this._majorUnit,u=l&&a[l],g=h&&a[h],m=i[t],_=h&&g&&m&&m.major;return this._adapter.format(e,n||(_?g:u))}generateTickLabels(e){let t,i,n;for(t=0,i=e.length;t<i;++t)n=e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,n=toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(n),o=Math.sin(n),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,n=i[t.unit]||i.millisecond,s=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),n),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(t=0,i=n.length;t<i;++t)e=e.concat(n[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const n=this.getLabels();for(t=0,i=n.length;t<i;++t)e.push(parse(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}}$e(TimeScale,"id","time"),$e(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(r,e,t){let i=0,n=r.length-1,s,o,a,l;t?(e>=r[i].pos&&e<=r[n].pos&&({lo:i,hi:n}=_lookupByKey(r,"pos",e)),{pos:s,time:a}=r[i],{pos:o,time:l}=r[n]):(e>=r[i].time&&e<=r[n].time&&({lo:i,hi:n}=_lookupByKey(r,"time",e)),{time:s,pos:a}=r[i],{time:o,pos:l}=r[n]);const h=o-s;return h?a+(l-a)*(e-s)/h:a}class TimeSeriesScale extends TimeScale{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=interpolate(t,this.min),this._tableRange=interpolate(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,n=[],s=[];let o,a,l,h,u;for(o=0,a=e.length;o<a;++o)h=e[o],h>=t&&h<=i&&n.push(h);if(n.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(o=0,a=n.length;o<a;++o)u=n[o+1],l=n[o-1],h=n[o],Math.round((u+l)/2)!==h&&s.push({time:h,pos:o/(a-1)});return s}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((n,s)=>n-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return interpolate(this._table,i*this._tableRange+this._minPos,!0)}}$e(TimeSeriesScale,"id","timeseries"),$e(TimeSeriesScale,"defaults",TimeScale.defaults);var scales=Object.freeze({__proto__:null,CategoryScale,LinearScale,LogarithmicScale,RadialLinearScale,TimeScale,TimeSeriesScale});const registerables=[controllers,elements,plugins,scales];gsapWithCSS.registerPlugin(ScrollTrigger,TextPlugin);Chart.register(...registerables);const GENE_TARGETS=["APOE4","PSEN1","APP","TREM2"],SELECTED_TARGET="APOE4",PROTOCOL_TEXT=`[BEGIN PROTOCOL: CANDIDATE_A7-22_SYNTHESIS]<br>
-------------------------------------------- <br>
1.  Prepare Reagents:<br>
    - Thaw Candidate #A7-22 plasmid (50 ng/μL).<br>
    - Prepare 500 mL of LB media. <br>
2.  Transformation:<br>
    - Add 2 μL of plasmid to 50 μL of E. coli cells.<br>
    - Heat shock at 42°C for 45 seconds.<br>
3.  Expression:<br>
    - Inoculate 100 mL of LB media.<br>
    - Grow at 37°C until OD600 reaches 0.6.<br>
    - Induce with 1 mM IPTG.<br>
4.  Purification:<br>
    - Harvest cells via centrifugation.<br>
    - Purify using Ni-NTA chromatography.<br>
5.  Validation:<br>
    - Confirm via SDS-PAGE.<br>
    - Store at -80°C.<br>
--------------------------------------------<br>
[END PROTOCOL]`;let validationChart=null,viewerInstance=null;function create3DViewer(){if(viewerInstance){viewerInstance.spin(!0);return}try{const r=document.querySelector("#protein-viewer");if(!r)return;r.innerHTML="";const e=_3DmolExports.createViewer(r,{backgroundColor:"black"});fetch("../public/models/1b68.pdb").then(t=>t.text()).then(t=>{e.addModel(t,"pdb"),e.setStyle({},{cartoon:{color:"spectrum"}}),e.zoomTo(),e.render(),e.zoom(1.2,1e3),e.spin(!0),viewerInstance=e}).catch(t=>console.error("PDB loading failed:",t))}catch(r){console.error("3D viewer init failed:",r)}}function stop3DViewer(){viewerInstance&&viewerInstance.spin(!1)}function createValidationChart(){const r=document.getElementById("validation-chart");if(!r)return;validationChart&&validationChart.destroy();const e={labels:["Binding Affinity","Stability","Specificity","Solubility","Novelty"],datasets:[{label:"Score",data:[95,88,75,92,85],backgroundColor:"rgba(0, 255, 255, 0.2)",borderColor:"rgba(0, 255, 255, 1)",pointBackgroundColor:"rgba(0, 255, 255, 1)"}]},t={scales:{r:{angleLines:{color:"rgba(255, 255, 255, 0.2)"},grid:{color:"rgba(255, 255, 255, 0.2)"},pointLabels:{color:"#e0e0e0",font:{size:14,family:"'Space Grotesk', sans-serif"}},ticks:{display:!1},suggestedMin:0,suggestedMax:100}},plugins:{legend:{display:!1}},animation:{duration:1500}};validationChart=new Chart(r,{type:"radar",data:e,options:t})}function typeProtocol(){const r=document.querySelector(".protocol-body code");r&&(r.classList.remove("typing-complete"),gsapWithCSS.to(r,{duration:8,text:PROTOCOL_TEXT,ease:"none"}))}async function main(){await loadSlim(tsParticles),await tsParticles.load({id:"tsparticles",options:{background:{color:{value:"#0d0d1a"}},fpsLimit:60,interactivity:{events:{onHover:{enable:!0,mode:"grab"},onClick:{enable:!0,mode:"push"}},modes:{grab:{distance:140,links:{opacity:1}},push:{quantity:4}}},particles:{color:{value:"#ffffff"},links:{color:"#ffffff",distance:150,enable:!0,opacity:.1,width:1},collisions:{enable:!0},move:{direction:"none",enable:!0,outModes:"out",random:!1,speed:.5,straight:!1},number:{density:{enable:!0},value:80},opacity:{value:.2},shape:{type:"circle"},size:{value:{min:1,max:3}}},detectRetina:!0}}),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-1",start:"top bottom",end:"top top",scrub:1}}).to([".title",".subtitle",".scroll-down-indicator",".genesis-particle"],{opacity:0,y:-30,stagger:.1}).to(".terminal-window",{opacity:1,scale:1,duration:1},">-0.5"),ScrollTrigger.create({trigger:"#section-1",start:"top center",once:!0,onEnter:()=>{gsapWithCSS.to("#terminal-text",{duration:3,text:"> Please identify therapeutic targets associated with Alzheimer's disease and propose potential drug candidates aimed at addressing these targets. <br>><br>>Initializing query...<br>> Found 4 potential targets. <br>> APOE4 seems the best one between them",ease:"none",onComplete:()=>{const r=document.querySelector(".targets-container");r.innerHTML="",GENE_TARGETS.forEach(e=>{const t=document.createElement("div");t.className="gene-target",t.innerText=e,e===SELECTED_TARGET&&t.classList.add("selected"),r.appendChild(t)}),gsapWithCSS.to(".gene-target",{opacity:1,y:0,duration:.5,stagger:.2,onComplete:()=>{gsapWithCSS.to(".gene-target.selected",{repeat:-1,yoyo:!0,scale:1.1,duration:.8,borderColor:"#ff00ff",color:"#ff00ff"})}})}})}}),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-2",start:"top bottom",end:"top top",scrub:1,onEnter:()=>create3DViewer(),onLeave:()=>stop3DViewer(),onEnterBack:()=>create3DViewer(),onLeaveBack:()=>stop3DViewer()}}).to([".terminal-window",".targets-container"],{opacity:0,scale:.9}).to(".viewer-container",{opacity:1,scale:1,duration:1},">-0.5"),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-3",start:"top bottom",end:"top top",scrub:1}}).to(".viewer-container",{opacity:0,scale:.9}).to(".validation-container",{opacity:1,y:0,duration:1},">-0.5").call(createValidationChart,[],">"),gsapWithCSS.timeline({scrollTrigger:{trigger:"#section-4",start:"top center",once:!0}}).to(".validation-container",{opacity:0,y:-50,duration:.5}).to(".protocol-container",{opacity:1,scale:1,duration:1,ease:"power2.out"},">-0.5").call(typeProtocol,[],">-0.5")}document.addEventListener("DOMContentLoaded",main);
